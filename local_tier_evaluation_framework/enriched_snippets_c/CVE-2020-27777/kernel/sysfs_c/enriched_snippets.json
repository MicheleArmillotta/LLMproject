[
  {
    "function_name": "topology_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1153-1190",
    "snippet": "static int __init topology_init(void)\n{\n\tint cpu, r;\n\n\tregister_nodes();\n\n\tfor_each_possible_cpu(cpu) {\n\t\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\n#ifdef CONFIG_HOTPLUG_CPU\n\t\t/*\n\t\t * For now, we just see if the system supports making\n\t\t * the RTAS calls for CPU hotplug.  But, there may be a\n\t\t * more comprehensive way to do this for an individual\n\t\t * CPU.  For instance, the boot cpu might never be valid\n\t\t * for hotplugging.\n\t\t */\n\t\tif (smp_ops->cpu_offline_self)\n\t\t\tc->hotpluggable = 1;\n#endif\n\n\t\tif (cpu_online(cpu) || c->hotpluggable) {\n\t\t\tregister_cpu(c, cpu);\n\n\t\t\tdevice_create_file(&c->dev, &dev_attr_physical_id);\n\t\t}\n\t}\n\tr = cpuhp_setup_state(CPUHP_AP_ONLINE_DYN, \"powerpc/topology:online\",\n\t\t\t      register_cpu_online, unregister_cpu_online);\n\tWARN_ON(r < 0);\n#ifdef CONFIG_PPC64\n\tsysfs_create_dscr_default();\n#endif /* CONFIG_PPC64 */\n\n\tcreate_svm_file();\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define unregister_cpu_online NULL"
    ],
    "globals_used": [
      "static DEFINE_PER_CPU(struct cpu, cpu_devices);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "create_svm_file",
          "args": [],
          "line": 1187
        },
        "resolved": true,
        "details": {
          "function_name": "create_svm_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "752-754",
          "snippet": "static void create_svm_file(void)\n{\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void create_svm_file(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_create_dscr_default",
          "args": [],
          "line": 1184
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_create_dscr_default",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "217-228",
          "snippet": "static void sysfs_create_dscr_default(void)\n{\n\tif (cpu_has_feature(CPU_FTR_DSCR)) {\n\t\tint cpu;\n\n\t\tdscr_default = spr_default_dscr;\n\t\tfor_each_possible_cpu(cpu)\n\t\t\tpaca_ptrs[cpu]->dscr_default = dscr_default;\n\n\t\tdevice_create_file(cpu_subsys.dev_root, &dev_attr_dscr_default);\n\t}\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void sysfs_create_dscr_default(void)\n{\n\tif (cpu_has_feature(CPU_FTR_DSCR)) {\n\t\tint cpu;\n\n\t\tdscr_default = spr_default_dscr;\n\t\tfor_each_possible_cpu(cpu)\n\t\t\tpaca_ptrs[cpu]->dscr_default = dscr_default;\n\n\t\tdevice_create_file(cpu_subsys.dev_root, &dev_attr_dscr_default);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "r < 0"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpuhp_setup_state",
          "args": [
            "CPUHP_AP_ONLINE_DYN",
            "\"powerpc/topology:online\"",
            "register_cpu_online",
            "unregister_cpu_online"
          ],
          "line": 1180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "&c->dev",
            "&dev_attr_physical_id"
          ],
          "line": 1177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_cpu",
          "args": [
            "c",
            "cpu"
          ],
          "line": 1175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "cpu"
          ],
          "line": 1174
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_cpu_online",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "924-1018",
          "snippet": "static int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [
            "#define unregister_cpu_online NULL",
            "#define HAS_PPC_PA6T",
            "#define HAS_PPC_PMC_G4\t\t1",
            "#define HAS_PPC_PMC_PA6T\t1",
            "#define HAS_PPC_PMC_IBM\t\t1"
          ],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cpu, cpu_devices);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define unregister_cpu_online NULL\n#define HAS_PPC_PA6T\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\n\nstatic int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_devices",
            "cpu"
          ],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_nodes",
          "args": [],
          "line": 1157
        },
        "resolved": true,
        "details": {
          "function_name": "register_nodes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "1136-1139",
          "snippet": "static void register_nodes(void)\n{\n\treturn;\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void register_nodes(void)\n{\n\treturn;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define unregister_cpu_online NULL\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\n\nstatic int __init topology_init(void)\n{\n\tint cpu, r;\n\n\tregister_nodes();\n\n\tfor_each_possible_cpu(cpu) {\n\t\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\n#ifdef CONFIG_HOTPLUG_CPU\n\t\t/*\n\t\t * For now, we just see if the system supports making\n\t\t * the RTAS calls for CPU hotplug.  But, there may be a\n\t\t * more comprehensive way to do this for an individual\n\t\t * CPU.  For instance, the boot cpu might never be valid\n\t\t * for hotplugging.\n\t\t */\n\t\tif (smp_ops->cpu_offline_self)\n\t\t\tc->hotpluggable = 1;\n#endif\n\n\t\tif (cpu_online(cpu) || c->hotpluggable) {\n\t\t\tregister_cpu(c, cpu);\n\n\t\t\tdevice_create_file(&c->dev, &dev_attr_physical_id);\n\t\t}\n\t}\n\tr = cpuhp_setup_state(CPUHP_AP_ONLINE_DYN, \"powerpc/topology:online\",\n\t\t\t      register_cpu_online, unregister_cpu_online);\n\tWARN_ON(r < 0);\n#ifdef CONFIG_PPC64\n\tsysfs_create_dscr_default();\n#endif /* CONFIG_PPC64 */\n\n\tcreate_svm_file();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "show_physical_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1144-1150",
    "snippet": "static ssize_t show_physical_id(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tstruct cpu *cpu = container_of(dev, struct cpu, dev);\n\n\treturn sprintf(buf, \"%d\\n\", get_hard_smp_processor_id(cpu->dev.id));\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "get_hard_smp_processor_id(cpu->dev.id)"
          ],
          "line": 1149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_hard_smp_processor_id",
          "args": [
            "cpu->dev.id"
          ],
          "line": 1149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "dev",
            "structcpu",
            "dev"
          ],
          "line": 1147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t show_physical_id(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tstruct cpu *cpu = container_of(dev, struct cpu, dev);\n\n\treturn sprintf(buf, \"%d\\n\", get_hard_smp_processor_id(cpu->dev.id));\n}"
  },
  {
    "function_name": "register_nodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1136-1139",
    "snippet": "static void register_nodes(void)\n{\n\treturn;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void register_nodes(void)\n{\n\treturn;\n}"
  },
  {
    "function_name": "sysfs_remove_device_from_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1128-1132",
    "snippet": "void sysfs_remove_device_from_node(struct device *dev, int nid)\n{\n\tstruct node *node = node_devices[nid];\n\tsysfs_remove_link(&node->dev.kobj, kobject_name(&dev->kobj));\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysfs_remove_link",
          "args": [
            "&node->dev.kobj",
            "kobject_name(&dev->kobj)"
          ],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_name",
          "args": [
            "&dev->kobj"
          ],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nvoid sysfs_remove_device_from_node(struct device *dev, int nid)\n{\n\tstruct node *node = node_devices[nid];\n\tsysfs_remove_link(&node->dev.kobj, kobject_name(&dev->kobj));\n}"
  },
  {
    "function_name": "sysfs_add_device_to_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1120-1125",
    "snippet": "int sysfs_add_device_to_node(struct device *dev, int nid)\n{\n\tstruct node *node = node_devices[nid];\n\treturn sysfs_create_link(&node->dev.kobj, &dev->kobj,\n\t\t\tkobject_name(&dev->kobj));\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysfs_create_link",
          "args": [
            "&node->dev.kobj",
            "&dev->kobj",
            "kobject_name(&dev->kobj)"
          ],
          "line": 1123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_name",
          "args": [
            "&dev->kobj"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nint sysfs_add_device_to_node(struct device *dev, int nid)\n{\n\tstruct node *node = node_devices[nid];\n\treturn sysfs_create_link(&node->dev.kobj, &dev->kobj,\n\t\t\tkobject_name(&dev->kobj));\n}"
  },
  {
    "function_name": "register_nodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1112-1118",
    "snippet": "static void register_nodes(void)\n{\n\tint i;\n\n\tfor (i = 0; i < MAX_NUMNODES; i++)\n\t\tregister_one_node(i);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_one_node",
          "args": [
            "i"
          ],
          "line": 1117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void register_nodes(void)\n{\n\tint i;\n\n\tfor (i = 0; i < MAX_NUMNODES; i++)\n\t\tregister_one_node(i);\n}"
  },
  {
    "function_name": "cpu_remove_dev_attr_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1092-1105",
    "snippet": "void cpu_remove_dev_attr_group(struct attribute_group *attrs)\n{\n\tint cpu;\n\tstruct device *dev;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdev = get_cpu_device(cpu);\n\t\tsysfs_remove_group(&dev->kobj, attrs);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_remove_group",
          "args": [
            "&dev->kobj",
            "attrs"
          ],
          "line": 1101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_device",
          "args": [
            "cpu"
          ],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 1097
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nvoid cpu_remove_dev_attr_group(struct attribute_group *attrs)\n{\n\tint cpu;\n\tstruct device *dev;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdev = get_cpu_device(cpu);\n\t\tsysfs_remove_group(&dev->kobj, attrs);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n}"
  },
  {
    "function_name": "cpu_remove_dev_attr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1078-1089",
    "snippet": "void cpu_remove_dev_attr(struct device_attribute *attr)\n{\n\tint cpu;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdevice_remove_file(get_cpu_device(cpu), attr);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 1088
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "get_cpu_device(cpu)",
            "attr"
          ],
          "line": 1085
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_device",
          "args": [
            "cpu"
          ],
          "line": 1085
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 1082
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nvoid cpu_remove_dev_attr(struct device_attribute *attr)\n{\n\tint cpu;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdevice_remove_file(get_cpu_device(cpu), attr);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n}"
  },
  {
    "function_name": "cpu_add_dev_attr_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1058-1074",
    "snippet": "int cpu_add_dev_attr_group(struct attribute_group *attrs)\n{\n\tint cpu;\n\tstruct device *dev;\n\tint ret;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdev = get_cpu_device(cpu);\n\t\tret = sysfs_create_group(&dev->kobj, attrs);\n\t\tWARN_ON(ret != 0);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 1072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ret != 0"
          ],
          "line": 1069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_create_group",
          "args": [
            "&dev->kobj",
            "attrs"
          ],
          "line": 1068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_device",
          "args": [
            "cpu"
          ],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nint cpu_add_dev_attr_group(struct attribute_group *attrs)\n{\n\tint cpu;\n\tstruct device *dev;\n\tint ret;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdev = get_cpu_device(cpu);\n\t\tret = sysfs_create_group(&dev->kobj, attrs);\n\t\tWARN_ON(ret != 0);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n\treturn 0;\n}"
  },
  {
    "function_name": "cpu_add_dev_attr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1043-1055",
    "snippet": "int cpu_add_dev_attr(struct device_attribute *attr)\n{\n\tint cpu;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdevice_create_file(get_cpu_device(cpu), attr);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 1053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "get_cpu_device(cpu)",
            "attr"
          ],
          "line": 1050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_device",
          "args": [
            "cpu"
          ],
          "line": 1050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nint cpu_add_dev_attr(struct device_attribute *attr)\n{\n\tint cpu;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdevice_create_file(get_cpu_device(cpu), attr);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n\treturn 0;\n}"
  },
  {
    "function_name": "arch_cpu_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1032-1038",
    "snippet": "ssize_t arch_cpu_release(const char *buf, size_t count)\n{\n\tif (ppc_md.cpu_release)\n\t\treturn ppc_md.cpu_release(buf, count);\n\n\treturn -EINVAL;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.cpu_release",
          "args": [
            "buf",
            "count"
          ],
          "line": 1035
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nssize_t arch_cpu_release(const char *buf, size_t count)\n{\n\tif (ppc_md.cpu_release)\n\t\treturn ppc_md.cpu_release(buf, count);\n\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "arch_cpu_probe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1024-1030",
    "snippet": "ssize_t arch_cpu_probe(const char *buf, size_t count)\n{\n\tif (ppc_md.cpu_probe)\n\t\treturn ppc_md.cpu_probe(buf, count);\n\n\treturn -EINVAL;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.cpu_probe",
          "args": [
            "buf",
            "count"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nssize_t arch_cpu_probe(const char *buf, size_t count)\n{\n\tif (ppc_md.cpu_probe)\n\t\treturn ppc_md.cpu_probe(buf, count);\n\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "unregister_cpu_online",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "924-1018",
    "snippet": "static int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define unregister_cpu_online NULL",
      "#define HAS_PPC_PA6T",
      "#define HAS_PPC_PMC_G4\t\t1",
      "#define HAS_PPC_PMC_PA6T\t1",
      "#define HAS_PPC_PMC_IBM\t\t1"
    ],
    "globals_used": [
      "static DEFINE_PER_CPU(struct cpu, cpu_devices);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "s->of_node"
          ],
          "line": 1015
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cacheinfo_cpu_offline",
          "args": [
            "cpu"
          ],
          "line": 1014
        },
        "resolved": true,
        "details": {
          "function_name": "cacheinfo_cpu_offline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "901-921",
          "snippet": "void cacheinfo_cpu_offline(unsigned int cpu_id)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct cache *cache;\n\n\t/* Prevent userspace from seeing inconsistent state - remove\n\t * the sysfs hierarchy first */\n\tcache_dir = per_cpu(cache_dir_pcpu, cpu_id);\n\n\t/* careful, sysfs population may have failed */\n\tif (cache_dir)\n\t\tremove_cache_dir(cache_dir);\n\n\tper_cpu(cache_dir_pcpu, cpu_id) = NULL;\n\n\t/* clear the CPU's bit in its cache chain, possibly freeing\n\t * cache objects */\n\tcache = cache_lookup_by_cpu(cpu_id);\n\tif (cache)\n\t\tcache_cpu_clear(cache, cpu_id);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cache_dir *, cache_dir_pcpu);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic DEFINE_PER_CPU(struct cache_dir *, cache_dir_pcpu);\n\nvoid cacheinfo_cpu_offline(unsigned int cpu_id)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct cache *cache;\n\n\t/* Prevent userspace from seeing inconsistent state - remove\n\t * the sysfs hierarchy first */\n\tcache_dir = per_cpu(cache_dir_pcpu, cpu_id);\n\n\t/* careful, sysfs population may have failed */\n\tif (cache_dir)\n\t\tremove_cache_dir(cache_dir);\n\n\tper_cpu(cache_dir_pcpu, cpu_id) = NULL;\n\n\t/* clear the CPU's bit in its cache chain, possibly freeing\n\t * cache objects */\n\tcache = cache_lookup_by_cpu(cpu_id);\n\tif (cache)\n\t\tcache_cpu_clear(cache, cpu_id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_altivec_idle_wait_time"
          ],
          "line": 1011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_altivec_idle"
          ],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_pw20_wait_time"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_pw20_state"
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "cur_cpu_spec->pvr_value"
          ],
          "line": 1006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_tscr"
          ],
          "line": 1002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 1001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_206"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_pir"
          ],
          "line": 998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_PPCAS_ARCH_V2"
          ],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_dscr"
          ],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_DSCR"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "remove_idle_spurr_file",
          "args": [
            "s"
          ],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "remove_idle_spurr_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "812-816",
          "snippet": "static void remove_idle_spurr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_idle_spurr);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void remove_idle_spurr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_idle_spurr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_spurr"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SPURR"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "remove_idle_purr_file",
          "args": [
            "s"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "remove_idle_purr_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "782-786",
          "snippet": "static void remove_idle_purr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_idle_purr);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void remove_idle_purr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_idle_purr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_purr"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_PURR"
          ],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_mmcr3"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_31"
          ],
          "line": 980
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_mmcra"
          ],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_MMCRA"
          ],
          "line": 977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&pmc_attrs[i]"
          ],
          "line": 973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&attrs[i]"
          ],
          "line": 969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_smt_snooze_delay"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SMT"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!c->hotpluggable"
          ],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_devices",
            "cpu"
          ],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define unregister_cpu_online NULL\n#define HAS_PPC_PA6T\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\n\nstatic int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}"
  },
  {
    "function_name": "register_cpu_online",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "825-921",
    "snippet": "static int register_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\t/* For cpus present at boot a reference was already grabbed in register_cpu() */\n\tif (!s->of_node)\n\t\ts->of_node = of_get_cpu_node(cpu, NULL);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_create_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_create_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_create_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef\tCONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_create_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_create_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tif (!firmware_has_feature(FW_FEATURE_LPAR))\n\t\t\tadd_write_permission_dev_attr(&dev_attr_purr);\n\t\tdevice_create_file(s, &dev_attr_purr);\n\t\tcreate_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_create_file(s, &dev_attr_spurr);\n\t\tcreate_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_create_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_create_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_create_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_create_file(s, &dev_attr_pw20_state);\n\t\tdevice_create_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_create_file(s, &dev_attr_altivec_idle);\n\t\tdevice_create_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_online(cpu);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define HAS_PPC_PA6T",
      "#define HAS_PPC_PMC_G4\t\t1",
      "#define HAS_PPC_PMC_PA6T\t1",
      "#define HAS_PPC_PMC_IBM\t\t1"
    ],
    "globals_used": [
      "static DEFINE_PER_CPU(struct cpu, cpu_devices);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cacheinfo_cpu_online",
          "args": [
            "cpu"
          ],
          "line": 919
        },
        "resolved": true,
        "details": {
          "function_name": "cacheinfo_cpu_online",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "821-830",
          "snippet": "void cacheinfo_cpu_online(unsigned int cpu_id)\n{\n\tstruct cache *cache;\n\n\tcache = cache_chain_instantiate(cpu_id);\n\tif (!cache)\n\t\treturn;\n\n\tcacheinfo_sysfs_populate(cpu_id, cache);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nvoid cacheinfo_cpu_online(unsigned int cpu_id)\n{\n\tstruct cache *cache;\n\n\tcache = cache_chain_instantiate(cpu_id);\n\tif (!cache)\n\t\treturn;\n\n\tcacheinfo_sysfs_populate(cpu_id, cache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_altivec_idle_wait_time"
          ],
          "line": 916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_altivec_idle"
          ],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_pw20_wait_time"
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_pw20_state"
          ],
          "line": 912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "cur_cpu_spec->pvr_value"
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_tscr"
          ],
          "line": 907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_206"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_pir"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_PPCAS_ARCH_V2"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_dscr"
          ],
          "line": 900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_DSCR"
          ],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_idle_spurr_file",
          "args": [
            "s"
          ],
          "line": 896
        },
        "resolved": true,
        "details": {
          "function_name": "create_idle_spurr_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "806-810",
          "snippet": "static void create_idle_spurr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_create_file(s, &dev_attr_idle_spurr);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void create_idle_spurr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_create_file(s, &dev_attr_idle_spurr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_spurr"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SPURR"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_idle_purr_file",
          "args": [
            "s"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "create_idle_purr_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "776-780",
          "snippet": "static void create_idle_purr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_create_file(s, &dev_attr_idle_purr);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void create_idle_purr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_create_file(s, &dev_attr_idle_purr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_purr"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_write_permission_dev_attr",
          "args": [
            "&dev_attr_purr"
          ],
          "line": 889
        },
        "resolved": true,
        "details": {
          "function_name": "add_write_permission_dev_attr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "169-172",
          "snippet": "static void add_write_permission_dev_attr(struct device_attribute *attr)\n{\n\tattr->attr.mode |= 0200;\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void add_write_permission_dev_attr(struct device_attribute *attr)\n{\n\tattr->attr.mode |= 0200;\n}"
        }
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_PURR"
          ],
          "line": 887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_mmcr3"
          ],
          "line": 884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_31"
          ],
          "line": 883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_mmcra"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_MMCRA"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&pmc_attrs[i]"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&attrs[i]"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_smt_snooze_delay"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SMT"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_cpu_node",
          "args": [
            "cpu",
            "NULL"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_devices",
            "cpu"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define HAS_PPC_PA6T\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\n\nstatic int register_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\t/* For cpus present at boot a reference was already grabbed in register_cpu() */\n\tif (!s->of_node)\n\t\ts->of_node = of_get_cpu_node(cpu, NULL);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_create_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_create_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_create_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef\tCONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_create_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_create_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tif (!firmware_has_feature(FW_FEATURE_LPAR))\n\t\t\tadd_write_permission_dev_attr(&dev_attr_purr);\n\t\tdevice_create_file(s, &dev_attr_purr);\n\t\tcreate_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_create_file(s, &dev_attr_spurr);\n\t\tcreate_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_create_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_create_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_create_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_create_file(s, &dev_attr_pw20_state);\n\t\tdevice_create_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_create_file(s, &dev_attr_altivec_idle);\n\t\tdevice_create_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_online(cpu);\n\treturn 0;\n}"
  },
  {
    "function_name": "remove_idle_spurr_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "812-816",
    "snippet": "static void remove_idle_spurr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_idle_spurr);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_idle_spurr"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void remove_idle_spurr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_idle_spurr);\n}"
  },
  {
    "function_name": "create_idle_spurr_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "806-810",
    "snippet": "static void create_idle_spurr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_create_file(s, &dev_attr_idle_spurr);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_idle_spurr"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void create_idle_spurr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_create_file(s, &dev_attr_idle_spurr);\n}"
  },
  {
    "function_name": "idle_spurr_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "795-803",
    "snippet": "static ssize_t idle_spurr_show(struct device *dev,\n\t\t\t       struct device_attribute *attr, char *buf)\n{\n\tstruct cpu *cpu = container_of(dev, struct cpu, dev);\n\tu64 val;\n\n\tsmp_call_function_single(cpu->dev.id, read_idle_spurr, &val, 1);\n\treturn sprintf(buf, \"%llx\\n\", val);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%llx\\n\"",
            "val"
          ],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu->dev.id",
            "read_idle_spurr",
            "&val",
            "1"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "dev",
            "structcpu",
            "dev"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t idle_spurr_show(struct device *dev,\n\t\t\t       struct device_attribute *attr, char *buf)\n{\n\tstruct cpu *cpu = container_of(dev, struct cpu, dev);\n\tu64 val;\n\n\tsmp_call_function_single(cpu->dev.id, read_idle_spurr, &val, 1);\n\treturn sprintf(buf, \"%llx\\n\", val);\n}"
  },
  {
    "function_name": "read_idle_spurr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "788-793",
    "snippet": "static void read_idle_spurr(void *val)\n{\n\tu64 *ret = val;\n\n\t*ret = read_this_idle_spurr();\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "read_this_idle_spurr",
          "args": [],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void read_idle_spurr(void *val)\n{\n\tu64 *ret = val;\n\n\t*ret = read_this_idle_spurr();\n}"
  },
  {
    "function_name": "remove_idle_purr_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "782-786",
    "snippet": "static void remove_idle_purr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_idle_purr);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_idle_purr"
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void remove_idle_purr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_idle_purr);\n}"
  },
  {
    "function_name": "create_idle_purr_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "776-780",
    "snippet": "static void create_idle_purr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_create_file(s, &dev_attr_idle_purr);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_idle_purr"
          ],
          "line": 779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void create_idle_purr_file(struct device *s)\n{\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_create_file(s, &dev_attr_idle_purr);\n}"
  },
  {
    "function_name": "idle_purr_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "765-773",
    "snippet": "static ssize_t idle_purr_show(struct device *dev,\n\t\t\t      struct device_attribute *attr, char *buf)\n{\n\tstruct cpu *cpu = container_of(dev, struct cpu, dev);\n\tu64 val;\n\n\tsmp_call_function_single(cpu->dev.id, read_idle_purr, &val, 1);\n\treturn sprintf(buf, \"%llx\\n\", val);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%llx\\n\"",
            "val"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu->dev.id",
            "read_idle_purr",
            "&val",
            "1"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "dev",
            "structcpu",
            "dev"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t idle_purr_show(struct device *dev,\n\t\t\t      struct device_attribute *attr, char *buf)\n{\n\tstruct cpu *cpu = container_of(dev, struct cpu, dev);\n\tu64 val;\n\n\tsmp_call_function_single(cpu->dev.id, read_idle_purr, &val, 1);\n\treturn sprintf(buf, \"%llx\\n\", val);\n}"
  },
  {
    "function_name": "read_idle_purr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "758-763",
    "snippet": "static void read_idle_purr(void *val)\n{\n\tu64 *ret = val;\n\n\t*ret = read_this_idle_purr();\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "read_this_idle_purr",
          "args": [],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void read_idle_purr(void *val)\n{\n\tu64 *ret = val;\n\n\t*ret = read_this_idle_purr();\n}"
  },
  {
    "function_name": "create_svm_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "752-754",
    "snippet": "static void create_svm_file(void)\n{\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void create_svm_file(void)\n{\n}"
  },
  {
    "function_name": "create_svm_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "747-750",
    "snippet": "static void create_svm_file(void)\n{\n\tdevice_create_file(cpu_subsys.dev_root, &dev_attr_svm);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "cpu_subsys.dev_root",
            "&dev_attr_svm"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void create_svm_file(void)\n{\n\tdevice_create_file(cpu_subsys.dev_root, &dev_attr_svm);\n}"
  },
  {
    "function_name": "show_svm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "741-744",
    "snippet": "static ssize_t show_svm(struct device *dev, struct device_attribute *attr, char *buf)\n{\n\treturn sprintf(buf, \"%u\\n\", is_secure_guest());\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%u\\n\"",
            "is_secure_guest()"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_secure_guest",
          "args": [],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t show_svm(struct device *dev, struct device_attribute *attr, char *buf)\n{\n\treturn sprintf(buf, \"%u\\n\", is_secure_guest());\n}"
  },
  {
    "function_name": "ppc_enable_pmcs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "536-548",
    "snippet": "void ppc_enable_pmcs(void)\n{\n\tppc_set_pmu_inuse(1);\n\n\t/* Only need to enable them once */\n\tif (__this_cpu_read(pmcs_enabled))\n\t\treturn;\n\n\t__this_cpu_write(pmcs_enabled, 1);\n\n\tif (ppc_md.enable_pmcs)\n\t\tppc_md.enable_pmcs();\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(char, pmcs_enabled);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.enable_pmcs",
          "args": [],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__this_cpu_write",
          "args": [
            "pmcs_enabled",
            "1"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__this_cpu_read",
          "args": [
            "pmcs_enabled"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_set_pmu_inuse",
          "args": [
            "1"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic DEFINE_PER_CPU(char, pmcs_enabled);\n\nvoid ppc_enable_pmcs(void)\n{\n\tppc_set_pmu_inuse(1);\n\n\t/* Only need to enable them once */\n\tif (__this_cpu_read(pmcs_enabled))\n\t\treturn;\n\n\t__this_cpu_write(pmcs_enabled, 1);\n\n\tif (ppc_md.enable_pmcs)\n\t\tppc_md.enable_pmcs();\n}"
  },
  {
    "function_name": "store_altivec_idle_wait_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "476-501",
    "snippet": "static ssize_t store_altivec_idle_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 entry_bit;\n\tu64 value;\n\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou64(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (!value)\n\t\treturn -EINVAL;\n\n\tentry_bit = get_idle_ticks_bit(value);\n\tif (entry_bit > MAX_BIT)\n\t\treturn -EINVAL;\n\n\taltivec_idle_wt = value;\n\n\tsmp_call_function_single(cpu, set_altivec_idle_wait_entry_bit,\n\t\t\t\t&entry_bit, 1);\n\n\treturn count;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define MAX_BIT\t\t\t\t63"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "set_altivec_idle_wait_entry_bit",
            "&entry_bit",
            "1"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_idle_ticks_bit",
          "args": [
            "value"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "get_idle_ticks_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "237-250",
          "snippet": "static unsigned int get_idle_ticks_bit(u64 ns)\n{\n\tu64 cycle;\n\n\tif (ns >= 10000)\n\t\tcycle = div_u64(ns + 500, 1000) * tb_ticks_per_usec;\n\telse\n\t\tcycle = div_u64(ns * tb_ticks_per_usec, 1000);\n\n\tif (!cycle)\n\t\treturn 0;\n\n\treturn ilog2(cycle);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic unsigned int get_idle_ticks_bit(u64 ns)\n{\n\tu64 cycle;\n\n\tif (ns >= 10000)\n\t\tcycle = div_u64(ns + 500, 1000) * tb_ticks_per_usec;\n\telse\n\t\tcycle = div_u64(ns * tb_ticks_per_usec, 1000);\n\n\tif (!cycle)\n\t\treturn 0;\n\n\treturn ilog2(cycle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrtou64",
          "args": [
            "buf",
            "0",
            "&value"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define MAX_BIT\t\t\t\t63\n\nstatic ssize_t store_altivec_idle_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 entry_bit;\n\tu64 value;\n\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou64(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (!value)\n\t\treturn -EINVAL;\n\n\tentry_bit = get_idle_ticks_bit(value);\n\tif (entry_bit > MAX_BIT)\n\t\treturn -EINVAL;\n\n\taltivec_idle_wt = value;\n\n\tsmp_call_function_single(cpu, set_altivec_idle_wait_entry_bit,\n\t\t\t\t&entry_bit, 1);\n\n\treturn count;\n}"
  },
  {
    "function_name": "set_altivec_idle_wait_entry_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "459-474",
    "snippet": "static void set_altivec_idle_wait_entry_bit(void *val)\n{\n\tu32 *value = val;\n\tu32 altivec_idle;\n\n\taltivec_idle = mfspr(SPRN_PWRMGTCR0);\n\n\t/* Set Automatic AltiVec Idle Count */\n\t/* clear count */\n\taltivec_idle &= ~PWRMGTCR0_AV_IDLE_CNT;\n\n\t/* set count */\n\taltivec_idle |= ((MAX_BIT - *value) << PWRMGTCR0_AV_IDLE_CNT_SHIFT);\n\n\tmtspr(SPRN_PWRMGTCR0, altivec_idle);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define MAX_BIT\t\t\t\t63"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_PWRMGTCR0",
            "altivec_idle"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PWRMGTCR0"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define MAX_BIT\t\t\t\t63\n\nstatic void set_altivec_idle_wait_entry_bit(void *val)\n{\n\tu32 *value = val;\n\tu32 altivec_idle;\n\n\taltivec_idle = mfspr(SPRN_PWRMGTCR0);\n\n\t/* Set Automatic AltiVec Idle Count */\n\t/* clear count */\n\taltivec_idle &= ~PWRMGTCR0_AV_IDLE_CNT;\n\n\t/* set count */\n\taltivec_idle |= ((MAX_BIT - *value) << PWRMGTCR0_AV_IDLE_CNT_SHIFT);\n\n\tmtspr(SPRN_PWRMGTCR0, altivec_idle);\n}"
  },
  {
    "function_name": "show_altivec_idle_wait_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "427-457",
    "snippet": "static ssize_t show_altivec_idle_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tu64 tb_cycle = 1;\n\tu64 time;\n\n\tunsigned int cpu = dev->id;\n\n\tif (!altivec_idle_wt) {\n\t\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\t\tvalue = (value & PWRMGTCR0_AV_IDLE_CNT) >>\n\t\t\t\t\tPWRMGTCR0_AV_IDLE_CNT_SHIFT;\n\n\t\ttb_cycle = (tb_cycle << (MAX_BIT - value + 1));\n\t\t/* convert ms to ns */\n\t\tif (tb_ticks_per_usec > 1000) {\n\t\t\ttime = div_u64(tb_cycle, tb_ticks_per_usec / 1000);\n\t\t} else {\n\t\t\tu32 rem_us;\n\n\t\t\ttime = div_u64_rem(tb_cycle, tb_ticks_per_usec,\n\t\t\t\t\t\t&rem_us);\n\t\t\ttime = time * 1000 + rem_us * 1000 / tb_ticks_per_usec;\n\t\t}\n\t} else {\n\t\ttime = altivec_idle_wt;\n\t}\n\n\treturn sprintf(buf, \"%llu\\n\", time > 0 ? time : 0);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define MAX_BIT\t\t\t\t63"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%llu\\n\"",
            "time > 0 ? time : 0"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64_rem",
          "args": [
            "tb_cycle",
            "tb_ticks_per_usec",
            "&rem_us"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "tb_cycle",
            "tb_ticks_per_usec / 1000"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "do_show_pwrmgtcr0",
            "&value",
            "1"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define MAX_BIT\t\t\t\t63\n\nstatic ssize_t show_altivec_idle_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tu64 tb_cycle = 1;\n\tu64 time;\n\n\tunsigned int cpu = dev->id;\n\n\tif (!altivec_idle_wt) {\n\t\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\t\tvalue = (value & PWRMGTCR0_AV_IDLE_CNT) >>\n\t\t\t\t\tPWRMGTCR0_AV_IDLE_CNT_SHIFT;\n\n\t\ttb_cycle = (tb_cycle << (MAX_BIT - value + 1));\n\t\t/* convert ms to ns */\n\t\tif (tb_ticks_per_usec > 1000) {\n\t\t\ttime = div_u64(tb_cycle, tb_ticks_per_usec / 1000);\n\t\t} else {\n\t\t\tu32 rem_us;\n\n\t\t\ttime = div_u64_rem(tb_cycle, tb_ticks_per_usec,\n\t\t\t\t\t\t&rem_us);\n\t\t\ttime = time * 1000 + rem_us * 1000 / tb_ticks_per_usec;\n\t\t}\n\t} else {\n\t\ttime = altivec_idle_wt;\n\t}\n\n\treturn sprintf(buf, \"%llu\\n\", time > 0 ? time : 0);\n}"
  },
  {
    "function_name": "store_altivec_idle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "409-425",
    "snippet": "static ssize_t store_altivec_idle(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou32(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (value > 1)\n\t\treturn -EINVAL;\n\n\tsmp_call_function_single(cpu, do_store_altivec_idle, &value, 1);\n\n\treturn count;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "do_store_altivec_idle",
            "&value",
            "1"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstrtou32",
          "args": [
            "buf",
            "0",
            "&value"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t store_altivec_idle(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou32(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (value > 1)\n\t\treturn -EINVAL;\n\n\tsmp_call_function_single(cpu, do_store_altivec_idle, &value, 1);\n\n\treturn count;\n}"
  },
  {
    "function_name": "do_store_altivec_idle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "394-407",
    "snippet": "static void do_store_altivec_idle(void *val)\n{\n\tu32 *value = val;\n\tu32 altivec_idle;\n\n\taltivec_idle = mfspr(SPRN_PWRMGTCR0);\n\n\tif (*value)\n\t\taltivec_idle |= PWRMGTCR0_AV_IDLE_PD_EN;\n\telse\n\t\taltivec_idle &= ~PWRMGTCR0_AV_IDLE_PD_EN;\n\n\tmtspr(SPRN_PWRMGTCR0, altivec_idle);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_PWRMGTCR0",
            "altivec_idle"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PWRMGTCR0"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void do_store_altivec_idle(void *val)\n{\n\tu32 *value = val;\n\tu32 altivec_idle;\n\n\taltivec_idle = mfspr(SPRN_PWRMGTCR0);\n\n\tif (*value)\n\t\taltivec_idle |= PWRMGTCR0_AV_IDLE_PD_EN;\n\telse\n\t\taltivec_idle &= ~PWRMGTCR0_AV_IDLE_PD_EN;\n\n\tmtspr(SPRN_PWRMGTCR0, altivec_idle);\n}"
  },
  {
    "function_name": "show_altivec_idle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "381-392",
    "snippet": "static ssize_t show_altivec_idle(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\n\tvalue &= PWRMGTCR0_AV_IDLE_PD_EN;\n\n\treturn sprintf(buf, \"%u\\n\", value ? 1 : 0);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%u\\n\"",
            "value ? 1 : 0"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "do_show_pwrmgtcr0",
            "&value",
            "1"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t show_altivec_idle(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\n\tvalue &= PWRMGTCR0_AV_IDLE_PD_EN;\n\n\treturn sprintf(buf, \"%u\\n\", value ? 1 : 0);\n}"
  },
  {
    "function_name": "store_pw20_wait_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "354-379",
    "snippet": "static ssize_t store_pw20_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 entry_bit;\n\tu64 value;\n\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou64(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (!value)\n\t\treturn -EINVAL;\n\n\tentry_bit = get_idle_ticks_bit(value);\n\tif (entry_bit > MAX_BIT)\n\t\treturn -EINVAL;\n\n\tpw20_wt = value;\n\n\tsmp_call_function_single(cpu, set_pw20_wait_entry_bit,\n\t\t\t\t&entry_bit, 1);\n\n\treturn count;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define MAX_BIT\t\t\t\t63"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "set_pw20_wait_entry_bit",
            "&entry_bit",
            "1"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_idle_ticks_bit",
          "args": [
            "value"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "get_idle_ticks_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "237-250",
          "snippet": "static unsigned int get_idle_ticks_bit(u64 ns)\n{\n\tu64 cycle;\n\n\tif (ns >= 10000)\n\t\tcycle = div_u64(ns + 500, 1000) * tb_ticks_per_usec;\n\telse\n\t\tcycle = div_u64(ns * tb_ticks_per_usec, 1000);\n\n\tif (!cycle)\n\t\treturn 0;\n\n\treturn ilog2(cycle);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic unsigned int get_idle_ticks_bit(u64 ns)\n{\n\tu64 cycle;\n\n\tif (ns >= 10000)\n\t\tcycle = div_u64(ns + 500, 1000) * tb_ticks_per_usec;\n\telse\n\t\tcycle = div_u64(ns * tb_ticks_per_usec, 1000);\n\n\tif (!cycle)\n\t\treturn 0;\n\n\treturn ilog2(cycle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrtou64",
          "args": [
            "buf",
            "0",
            "&value"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define MAX_BIT\t\t\t\t63\n\nstatic ssize_t store_pw20_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 entry_bit;\n\tu64 value;\n\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou64(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (!value)\n\t\treturn -EINVAL;\n\n\tentry_bit = get_idle_ticks_bit(value);\n\tif (entry_bit > MAX_BIT)\n\t\treturn -EINVAL;\n\n\tpw20_wt = value;\n\n\tsmp_call_function_single(cpu, set_pw20_wait_entry_bit,\n\t\t\t\t&entry_bit, 1);\n\n\treturn count;\n}"
  },
  {
    "function_name": "set_pw20_wait_entry_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "337-352",
    "snippet": "static void set_pw20_wait_entry_bit(void *val)\n{\n\tu32 *value = val;\n\tu32 pw20_idle;\n\n\tpw20_idle = mfspr(SPRN_PWRMGTCR0);\n\n\t/* Set Automatic PW20 Core Idle Count */\n\t/* clear count */\n\tpw20_idle &= ~PWRMGTCR0_PW20_ENT;\n\n\t/* set count */\n\tpw20_idle |= ((MAX_BIT - *value) << PWRMGTCR0_PW20_ENT_SHIFT);\n\n\tmtspr(SPRN_PWRMGTCR0, pw20_idle);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define MAX_BIT\t\t\t\t63"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_PWRMGTCR0",
            "pw20_idle"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PWRMGTCR0"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define MAX_BIT\t\t\t\t63\n\nstatic void set_pw20_wait_entry_bit(void *val)\n{\n\tu32 *value = val;\n\tu32 pw20_idle;\n\n\tpw20_idle = mfspr(SPRN_PWRMGTCR0);\n\n\t/* Set Automatic PW20 Core Idle Count */\n\t/* clear count */\n\tpw20_idle &= ~PWRMGTCR0_PW20_ENT;\n\n\t/* set count */\n\tpw20_idle |= ((MAX_BIT - *value) << PWRMGTCR0_PW20_ENT_SHIFT);\n\n\tmtspr(SPRN_PWRMGTCR0, pw20_idle);\n}"
  },
  {
    "function_name": "show_pw20_wait_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "305-335",
    "snippet": "static ssize_t show_pw20_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tu64 tb_cycle = 1;\n\tu64 time;\n\n\tunsigned int cpu = dev->id;\n\n\tif (!pw20_wt) {\n\t\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\t\tvalue = (value & PWRMGTCR0_PW20_ENT) >>\n\t\t\t\t\tPWRMGTCR0_PW20_ENT_SHIFT;\n\n\t\ttb_cycle = (tb_cycle << (MAX_BIT - value + 1));\n\t\t/* convert ms to ns */\n\t\tif (tb_ticks_per_usec > 1000) {\n\t\t\ttime = div_u64(tb_cycle, tb_ticks_per_usec / 1000);\n\t\t} else {\n\t\t\tu32 rem_us;\n\n\t\t\ttime = div_u64_rem(tb_cycle, tb_ticks_per_usec,\n\t\t\t\t\t\t&rem_us);\n\t\t\ttime = time * 1000 + rem_us * 1000 / tb_ticks_per_usec;\n\t\t}\n\t} else {\n\t\ttime = pw20_wt;\n\t}\n\n\treturn sprintf(buf, \"%llu\\n\", time > 0 ? time : 0);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define MAX_BIT\t\t\t\t63"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%llu\\n\"",
            "time > 0 ? time : 0"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64_rem",
          "args": [
            "tb_cycle",
            "tb_ticks_per_usec",
            "&rem_us"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "tb_cycle",
            "tb_ticks_per_usec / 1000"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "do_show_pwrmgtcr0",
            "&value",
            "1"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define MAX_BIT\t\t\t\t63\n\nstatic ssize_t show_pw20_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tu64 tb_cycle = 1;\n\tu64 time;\n\n\tunsigned int cpu = dev->id;\n\n\tif (!pw20_wt) {\n\t\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\t\tvalue = (value & PWRMGTCR0_PW20_ENT) >>\n\t\t\t\t\tPWRMGTCR0_PW20_ENT_SHIFT;\n\n\t\ttb_cycle = (tb_cycle << (MAX_BIT - value + 1));\n\t\t/* convert ms to ns */\n\t\tif (tb_ticks_per_usec > 1000) {\n\t\t\ttime = div_u64(tb_cycle, tb_ticks_per_usec / 1000);\n\t\t} else {\n\t\t\tu32 rem_us;\n\n\t\t\ttime = div_u64_rem(tb_cycle, tb_ticks_per_usec,\n\t\t\t\t\t\t&rem_us);\n\t\t\ttime = time * 1000 + rem_us * 1000 / tb_ticks_per_usec;\n\t\t}\n\t} else {\n\t\ttime = pw20_wt;\n\t}\n\n\treturn sprintf(buf, \"%llu\\n\", time > 0 ? time : 0);\n}"
  },
  {
    "function_name": "store_pw20_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "287-303",
    "snippet": "static ssize_t store_pw20_state(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou32(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (value > 1)\n\t\treturn -EINVAL;\n\n\tsmp_call_function_single(cpu, do_store_pw20_state, &value, 1);\n\n\treturn count;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "do_store_pw20_state",
            "&value",
            "1"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstrtou32",
          "args": [
            "buf",
            "0",
            "&value"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t store_pw20_state(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou32(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (value > 1)\n\t\treturn -EINVAL;\n\n\tsmp_call_function_single(cpu, do_store_pw20_state, &value, 1);\n\n\treturn count;\n}"
  },
  {
    "function_name": "do_store_pw20_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "272-285",
    "snippet": "static void do_store_pw20_state(void *val)\n{\n\tu32 *value = val;\n\tu32 pw20_state;\n\n\tpw20_state = mfspr(SPRN_PWRMGTCR0);\n\n\tif (*value)\n\t\tpw20_state |= PWRMGTCR0_PW20_WAIT;\n\telse\n\t\tpw20_state &= ~PWRMGTCR0_PW20_WAIT;\n\n\tmtspr(SPRN_PWRMGTCR0, pw20_state);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_PWRMGTCR0",
            "pw20_state"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PWRMGTCR0"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void do_store_pw20_state(void *val)\n{\n\tu32 *value = val;\n\tu32 pw20_state;\n\n\tpw20_state = mfspr(SPRN_PWRMGTCR0);\n\n\tif (*value)\n\t\tpw20_state |= PWRMGTCR0_PW20_WAIT;\n\telse\n\t\tpw20_state &= ~PWRMGTCR0_PW20_WAIT;\n\n\tmtspr(SPRN_PWRMGTCR0, pw20_state);\n}"
  },
  {
    "function_name": "show_pw20_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "259-270",
    "snippet": "static ssize_t show_pw20_state(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\n\tvalue &= PWRMGTCR0_PW20_WAIT;\n\n\treturn sprintf(buf, \"%u\\n\", value ? 1 : 0);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%u\\n\"",
            "value ? 1 : 0"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "do_show_pwrmgtcr0",
            "&value",
            "1"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t show_pw20_state(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\n\tvalue &= PWRMGTCR0_PW20_WAIT;\n\n\treturn sprintf(buf, \"%u\\n\", value ? 1 : 0);\n}"
  },
  {
    "function_name": "do_show_pwrmgtcr0",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "252-257",
    "snippet": "static void do_show_pwrmgtcr0(void *val)\n{\n\tu32 *value = val;\n\n\t*value = mfspr(SPRN_PWRMGTCR0);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PWRMGTCR0"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void do_show_pwrmgtcr0(void *val)\n{\n\tu32 *value = val;\n\n\t*value = mfspr(SPRN_PWRMGTCR0);\n}"
  },
  {
    "function_name": "get_idle_ticks_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "237-250",
    "snippet": "static unsigned int get_idle_ticks_bit(u64 ns)\n{\n\tu64 cycle;\n\n\tif (ns >= 10000)\n\t\tcycle = div_u64(ns + 500, 1000) * tb_ticks_per_usec;\n\telse\n\t\tcycle = div_u64(ns * tb_ticks_per_usec, 1000);\n\n\tif (!cycle)\n\t\treturn 0;\n\n\treturn ilog2(cycle);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ilog2",
          "args": [
            "cycle"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "ns * tb_ticks_per_usec",
            "1000"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "ns + 500",
            "1000"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic unsigned int get_idle_ticks_bit(u64 ns)\n{\n\tu64 cycle;\n\n\tif (ns >= 10000)\n\t\tcycle = div_u64(ns + 500, 1000) * tb_ticks_per_usec;\n\telse\n\t\tcycle = div_u64(ns * tb_ticks_per_usec, 1000);\n\n\tif (!cycle)\n\t\treturn 0;\n\n\treturn ilog2(cycle);\n}"
  },
  {
    "function_name": "sysfs_create_dscr_default",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "217-228",
    "snippet": "static void sysfs_create_dscr_default(void)\n{\n\tif (cpu_has_feature(CPU_FTR_DSCR)) {\n\t\tint cpu;\n\n\t\tdscr_default = spr_default_dscr;\n\t\tfor_each_possible_cpu(cpu)\n\t\t\tpaca_ptrs[cpu]->dscr_default = dscr_default;\n\n\t\tdevice_create_file(cpu_subsys.dev_root, &dev_attr_dscr_default);\n\t}\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "cpu_subsys.dev_root",
            "&dev_attr_dscr_default"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_DSCR"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void sysfs_create_dscr_default(void)\n{\n\tif (cpu_has_feature(CPU_FTR_DSCR)) {\n\t\tint cpu;\n\n\t\tdscr_default = spr_default_dscr;\n\t\tfor_each_possible_cpu(cpu)\n\t\t\tpaca_ptrs[cpu]->dscr_default = dscr_default;\n\n\t\tdevice_create_file(cpu_subsys.dev_root, &dev_attr_dscr_default);\n\t}\n}"
  },
  {
    "function_name": "store_dscr_default",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "197-212",
    "snippet": "static ssize_t __used store_dscr_default(struct device *dev,\n\t\tstruct device_attribute *attr, const char *buf,\n\t\tsize_t count)\n{\n\tunsigned long val;\n\tint ret = 0;\n\n\tret = sscanf(buf, \"%lx\", &val);\n\tif (ret != 1)\n\t\treturn -EINVAL;\n\tdscr_default = val;\n\n\ton_each_cpu(write_dscr, &val, 1);\n\n\treturn count;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "on_each_cpu",
          "args": [
            "write_dscr",
            "&val",
            "1"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "buf",
            "\"%lx\"",
            "&val"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t __used store_dscr_default(struct device *dev,\n\t\tstruct device_attribute *attr, const char *buf,\n\t\tsize_t count)\n{\n\tunsigned long val;\n\tint ret = 0;\n\n\tret = sscanf(buf, \"%lx\", &val);\n\tif (ret != 1)\n\t\treturn -EINVAL;\n\tdscr_default = val;\n\n\ton_each_cpu(write_dscr, &val, 1);\n\n\treturn count;\n}"
  },
  {
    "function_name": "show_dscr_default",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "182-186",
    "snippet": "static ssize_t show_dscr_default(struct device *dev,\n\t\tstruct device_attribute *attr, char *buf)\n{\n\treturn sprintf(buf, \"%lx\\n\", dscr_default);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%lx\\n\"",
            "dscr_default"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t show_dscr_default(struct device *dev,\n\t\tstruct device_attribute *attr, char *buf)\n{\n\treturn sprintf(buf, \"%lx\\n\", dscr_default);\n}"
  },
  {
    "function_name": "add_write_permission_dev_attr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "169-172",
    "snippet": "static void add_write_permission_dev_attr(struct device_attribute *attr)\n{\n\tattr->attr.mode |= 0200;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void add_write_permission_dev_attr(struct device_attribute *attr)\n{\n\tattr->attr.mode |= 0200;\n}"
  },
  {
    "function_name": "write_dscr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "157-164",
    "snippet": "static void write_dscr(void *val)\n{\n\tget_paca()->dscr_default = *(unsigned long *)val;\n\tif (!current->thread.dscr_inherit) {\n\t\tcurrent->thread.dscr = *(unsigned long *)val;\n\t\tmtspr(SPRN_DSCR, *(unsigned long *)val);\n\t}\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_DSCR",
            "*(unsigned long *)val"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void write_dscr(void *val)\n{\n\tget_paca()->dscr_default = *(unsigned long *)val;\n\tif (!current->thread.dscr_inherit) {\n\t\tcurrent->thread.dscr = *(unsigned long *)val;\n\t\tmtspr(SPRN_DSCR, *(unsigned long *)val);\n\t}\n}"
  },
  {
    "function_name": "read_dscr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "144-147",
    "snippet": "static void read_dscr(void *val)\n{\n\t*(unsigned long *)val = get_paca()->dscr_default;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void read_dscr(void *val)\n{\n\t*(unsigned long *)val = get_paca()->dscr_default;\n}"
  },
  {
    "function_name": "setup_smt_snooze_delay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "71-78",
    "snippet": "static int __init setup_smt_snooze_delay(char *str)\n{\n\tif (!cpu_has_feature(CPU_FTR_SMT))\n\t\treturn 1;\n\n\tpr_warn(\"smt-snooze-delay command line option has no effect\\n\");\n\treturn 1;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"smt-snooze-delay command line option has no effect\\n\""
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SMT"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic int __init setup_smt_snooze_delay(char *str)\n{\n\tif (!cpu_has_feature(CPU_FTR_SMT))\n\t\treturn 1;\n\n\tpr_warn(\"smt-snooze-delay command line option has no effect\\n\");\n\treturn 1;\n}"
  },
  {
    "function_name": "show_smt_snooze_delay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "59-66",
    "snippet": "static ssize_t show_smt_snooze_delay(struct device *dev,\n\t\t\t\t     struct device_attribute *attr,\n\t\t\t\t     char *buf)\n{\n\tpr_warn_once(\"%s (%d) read from unsupported smt_snooze_delay\\n\",\n\t\t     current->comm, current->pid);\n\treturn sprintf(buf, \"100\\n\");\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"100\\n\""
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn_once",
          "args": [
            "\"%s (%d) read from unsupported smt_snooze_delay\\n\"",
            "current->comm",
            "current->pid"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t show_smt_snooze_delay(struct device *dev,\n\t\t\t\t     struct device_attribute *attr,\n\t\t\t\t     char *buf)\n{\n\tpr_warn_once(\"%s (%d) read from unsupported smt_snooze_delay\\n\",\n\t\t     current->comm, current->pid);\n\treturn sprintf(buf, \"100\\n\");\n}"
  },
  {
    "function_name": "store_smt_snooze_delay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "49-57",
    "snippet": "static ssize_t store_smt_snooze_delay(struct device *dev,\n\t\t\t\t      struct device_attribute *attr,\n\t\t\t\t      const char *buf,\n\t\t\t\t      size_t count)\n{\n\tpr_warn_once(\"%s (%d) stored to unsupported smt_snooze_delay, which has no effect.\\n\",\n\t\t     current->comm, current->pid);\n\treturn count;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"setup.h\"",
      "#include \"cacheinfo.h\"",
      "#include <asm/svm.h>",
      "#include <asm/idle.h>",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_warn_once",
          "args": [
            "\"%s (%d) stored to unsupported smt_snooze_delay, which has no effect.\\n\"",
            "current->comm",
            "current->pid"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t store_smt_snooze_delay(struct device *dev,\n\t\t\t\t      struct device_attribute *attr,\n\t\t\t\t      const char *buf,\n\t\t\t\t      size_t count)\n{\n\tpr_warn_once(\"%s (%d) stored to unsupported smt_snooze_delay, which has no effect.\\n\",\n\t\t     current->comm, current->pid);\n\treturn count;\n}"
  }
]