[
  {
    "function_name": "module_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/module.c",
    "lines": "91-98",
    "snippet": "void *module_alloc(unsigned long size)\n{\n\tBUILD_BUG_ON(TASK_SIZE > MODULES_VADDR);\n\n\treturn __vmalloc_node_range(size, 1, MODULES_VADDR, MODULES_END, GFP_KERNEL,\n\t\t\t\t    PAGE_KERNEL_EXEC, VM_FLUSH_RESET_PERMS, NUMA_NO_NODE,\n\t\t\t\t    __builtin_return_address(0));\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <linux/sort.h>",
      "#include <asm/firmware.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/module.h>",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/err.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/elf.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__vmalloc_node_range",
          "args": [
            "size",
            "1",
            "MODULES_VADDR",
            "MODULES_END",
            "GFP_KERNEL",
            "PAGE_KERNEL_EXEC",
            "VM_FLUSH_RESET_PERMS",
            "NUMA_NO_NODE",
            "__builtin_return_address(0)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__builtin_return_address",
          "args": [
            "0"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "TASK_SIZE > MODULES_VADDR"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <linux/sort.h>\n#include <asm/firmware.h>\n#include <linux/uaccess.h>\n#include <asm/module.h>\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/err.h>\n#include <linux/moduleloader.h>\n#include <linux/elf.h>\n\nvoid *module_alloc(unsigned long size)\n{\n\tBUILD_BUG_ON(TASK_SIZE > MODULES_VADDR);\n\n\treturn __vmalloc_node_range(size, 1, MODULES_VADDR, MODULES_END, GFP_KERNEL,\n\t\t\t\t    PAGE_KERNEL_EXEC, VM_FLUSH_RESET_PERMS, NUMA_NO_NODE,\n\t\t\t\t    __builtin_return_address(0));\n}"
  },
  {
    "function_name": "module_finalize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/module.c",
    "lines": "34-88",
    "snippet": "int module_finalize(const Elf_Ehdr *hdr,\n\t\tconst Elf_Shdr *sechdrs, struct module *me)\n{\n\tconst Elf_Shdr *sect;\n\tint rc;\n\n\trc = module_finalize_ftrace(me, sechdrs);\n\tif (rc)\n\t\treturn rc;\n\n\t/* Apply feature fixups */\n\tsect = find_section(hdr, sechdrs, \"__ftr_fixup\");\n\tif (sect != NULL)\n\t\tdo_feature_fixups(cur_cpu_spec->cpu_features,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n\n\tsect = find_section(hdr, sechdrs, \"__mmu_ftr_fixup\");\n\tif (sect != NULL)\n\t\tdo_feature_fixups(cur_cpu_spec->mmu_features,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n\n#ifdef CONFIG_PPC64\n\tsect = find_section(hdr, sechdrs, \"__fw_ftr_fixup\");\n\tif (sect != NULL)\n\t\tdo_feature_fixups(powerpc_firmware_features,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n#endif /* CONFIG_PPC64 */\n\n#ifdef PPC64_ELF_ABI_v1\n\tsect = find_section(hdr, sechdrs, \".opd\");\n\tif (sect != NULL) {\n\t\tme->arch.start_opd = sect->sh_addr;\n\t\tme->arch.end_opd = sect->sh_addr + sect->sh_size;\n\t}\n#endif /* PPC64_ELF_ABI_v1 */\n\n#ifdef CONFIG_PPC_BARRIER_NOSPEC\n\tsect = find_section(hdr, sechdrs, \"__spec_barrier_fixup\");\n\tif (sect != NULL)\n\t\tdo_barrier_nospec_fixups_range(barrier_nospec_enabled,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n#endif /* CONFIG_PPC_BARRIER_NOSPEC */\n\n\tsect = find_section(hdr, sechdrs, \"__lwsync_fixup\");\n\tif (sect != NULL)\n\t\tdo_lwsync_fixups(cur_cpu_spec->cpu_features,\n\t\t\t\t (void *)sect->sh_addr,\n\t\t\t\t (void *)sect->sh_addr + sect->sh_size);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <linux/sort.h>",
      "#include <asm/firmware.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/module.h>",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/err.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/elf.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_lwsync_fixups",
          "args": [
            "cur_cpu_spec->cpu_features",
            "(void *)sect->sh_addr",
            "(void *)sect->sh_addr + sect->sh_size"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_section",
          "args": [
            "hdr",
            "sechdrs",
            "\"__lwsync_fixup\""
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "find_section",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/module.c",
          "lines": "20-32",
          "snippet": "static const Elf_Shdr *find_section(const Elf_Ehdr *hdr,\n\t\t\t\t    const Elf_Shdr *sechdrs,\n\t\t\t\t    const char *name)\n{\n\tchar *secstrings;\n\tunsigned int i;\n\n\tsecstrings = (char *)hdr + sechdrs[hdr->e_shstrndx].sh_offset;\n\tfor (i = 1; i < hdr->e_shnum; i++)\n\t\tif (strcmp(secstrings+sechdrs[i].sh_name, name) == 0)\n\t\t\treturn &sechdrs[i];\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <linux/sort.h>",
            "#include <asm/firmware.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/module.h>",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/err.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/elf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <linux/sort.h>\n#include <asm/firmware.h>\n#include <linux/uaccess.h>\n#include <asm/module.h>\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/err.h>\n#include <linux/moduleloader.h>\n#include <linux/elf.h>\n\nstatic const Elf_Shdr *find_section(const Elf_Ehdr *hdr,\n\t\t\t\t    const Elf_Shdr *sechdrs,\n\t\t\t\t    const char *name)\n{\n\tchar *secstrings;\n\tunsigned int i;\n\n\tsecstrings = (char *)hdr + sechdrs[hdr->e_shstrndx].sh_offset;\n\tfor (i = 1; i < hdr->e_shnum; i++)\n\t\tif (strcmp(secstrings+sechdrs[i].sh_name, name) == 0)\n\t\t\treturn &sechdrs[i];\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_barrier_nospec_fixups_range",
          "args": [
            "barrier_nospec_enabled",
            "(void *)sect->sh_addr",
            "(void *)sect->sh_addr + sect->sh_size"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_feature_fixups",
          "args": [
            "powerpc_firmware_features",
            "(void *)sect->sh_addr",
            "(void *)sect->sh_addr + sect->sh_size"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_feature_fixups",
          "args": [
            "cur_cpu_spec->mmu_features",
            "(void *)sect->sh_addr",
            "(void *)sect->sh_addr + sect->sh_size"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_feature_fixups",
          "args": [
            "cur_cpu_spec->cpu_features",
            "(void *)sect->sh_addr",
            "(void *)sect->sh_addr + sect->sh_size"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_finalize_ftrace",
          "args": [
            "me",
            "sechdrs"
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "module_finalize_ftrace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/module_32.c",
          "lines": "283-292",
          "snippet": "int module_finalize_ftrace(struct module *module, const Elf_Shdr *sechdrs)\n{\n\tmodule->arch.tramp = do_plt_call(module->core_layout.base,\n\t\t\t\t\t (unsigned long)ftrace_caller,\n\t\t\t\t\t sechdrs, module);\n\tif (!module->arch.tramp)\n\t\treturn -ENOENT;\n\n\treturn 0;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <linux/sort.h>",
            "#include <linux/bug.h>",
            "#include <linux/cache.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/kernel.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/elf.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <linux/sort.h>\n#include <linux/bug.h>\n#include <linux/cache.h>\n#include <linux/ftrace.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n#include <linux/vmalloc.h>\n#include <linux/elf.h>\n#include <linux/moduleloader.h>\n#include <linux/module.h>\n\nint module_finalize_ftrace(struct module *module, const Elf_Shdr *sechdrs)\n{\n\tmodule->arch.tramp = do_plt_call(module->core_layout.base,\n\t\t\t\t\t (unsigned long)ftrace_caller,\n\t\t\t\t\t sechdrs, module);\n\tif (!module->arch.tramp)\n\t\treturn -ENOENT;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <linux/sort.h>\n#include <asm/firmware.h>\n#include <linux/uaccess.h>\n#include <asm/module.h>\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/err.h>\n#include <linux/moduleloader.h>\n#include <linux/elf.h>\n\nint module_finalize(const Elf_Ehdr *hdr,\n\t\tconst Elf_Shdr *sechdrs, struct module *me)\n{\n\tconst Elf_Shdr *sect;\n\tint rc;\n\n\trc = module_finalize_ftrace(me, sechdrs);\n\tif (rc)\n\t\treturn rc;\n\n\t/* Apply feature fixups */\n\tsect = find_section(hdr, sechdrs, \"__ftr_fixup\");\n\tif (sect != NULL)\n\t\tdo_feature_fixups(cur_cpu_spec->cpu_features,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n\n\tsect = find_section(hdr, sechdrs, \"__mmu_ftr_fixup\");\n\tif (sect != NULL)\n\t\tdo_feature_fixups(cur_cpu_spec->mmu_features,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n\n#ifdef CONFIG_PPC64\n\tsect = find_section(hdr, sechdrs, \"__fw_ftr_fixup\");\n\tif (sect != NULL)\n\t\tdo_feature_fixups(powerpc_firmware_features,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n#endif /* CONFIG_PPC64 */\n\n#ifdef PPC64_ELF_ABI_v1\n\tsect = find_section(hdr, sechdrs, \".opd\");\n\tif (sect != NULL) {\n\t\tme->arch.start_opd = sect->sh_addr;\n\t\tme->arch.end_opd = sect->sh_addr + sect->sh_size;\n\t}\n#endif /* PPC64_ELF_ABI_v1 */\n\n#ifdef CONFIG_PPC_BARRIER_NOSPEC\n\tsect = find_section(hdr, sechdrs, \"__spec_barrier_fixup\");\n\tif (sect != NULL)\n\t\tdo_barrier_nospec_fixups_range(barrier_nospec_enabled,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n#endif /* CONFIG_PPC_BARRIER_NOSPEC */\n\n\tsect = find_section(hdr, sechdrs, \"__lwsync_fixup\");\n\tif (sect != NULL)\n\t\tdo_lwsync_fixups(cur_cpu_spec->cpu_features,\n\t\t\t\t (void *)sect->sh_addr,\n\t\t\t\t (void *)sect->sh_addr + sect->sh_size);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "find_section",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/module.c",
    "lines": "20-32",
    "snippet": "static const Elf_Shdr *find_section(const Elf_Ehdr *hdr,\n\t\t\t\t    const Elf_Shdr *sechdrs,\n\t\t\t\t    const char *name)\n{\n\tchar *secstrings;\n\tunsigned int i;\n\n\tsecstrings = (char *)hdr + sechdrs[hdr->e_shstrndx].sh_offset;\n\tfor (i = 1; i < hdr->e_shnum; i++)\n\t\tif (strcmp(secstrings+sechdrs[i].sh_name, name) == 0)\n\t\t\treturn &sechdrs[i];\n\treturn NULL;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <linux/sort.h>",
      "#include <asm/firmware.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/module.h>",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/err.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/elf.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "secstrings+sechdrs[i].sh_name",
            "name"
          ],
          "line": 29
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <linux/sort.h>\n#include <asm/firmware.h>\n#include <linux/uaccess.h>\n#include <asm/module.h>\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/err.h>\n#include <linux/moduleloader.h>\n#include <linux/elf.h>\n\nstatic const Elf_Shdr *find_section(const Elf_Ehdr *hdr,\n\t\t\t\t    const Elf_Shdr *sechdrs,\n\t\t\t\t    const char *name)\n{\n\tchar *secstrings;\n\tunsigned int i;\n\n\tsecstrings = (char *)hdr + sechdrs[hdr->e_shstrndx].sh_offset;\n\tfor (i = 1; i < hdr->e_shnum; i++)\n\t\tif (strcmp(secstrings+sechdrs[i].sh_name, name) == 0)\n\t\t\treturn &sechdrs[i];\n\treturn NULL;\n}"
  }
]