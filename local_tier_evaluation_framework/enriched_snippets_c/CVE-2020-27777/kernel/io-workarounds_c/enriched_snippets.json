[
  {
    "function_name": "iowa_register_bus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io-workarounds.c",
    "lines": "180-206",
    "snippet": "void iowa_register_bus(struct pci_controller *phb, struct ppc_pci_io *ops,\n\t\t       int (*initfunc)(struct iowa_bus *, void *), void *data)\n{\n\tstruct iowa_bus *bus;\n\tstruct device_node *np = phb->dn;\n\n\tio_workaround_init();\n\n\tif (iowa_bus_count >= IOWA_MAX_BUS) {\n\t\tpr_err(\"IOWA:Too many pci bridges, \"\n\t\t       \"workarounds disabled for %pOF\\n\", np);\n\t\treturn;\n\t}\n\n\tbus = &iowa_busses[iowa_bus_count];\n\tbus->phb = phb;\n\tbus->ops = ops;\n\tbus->private = data;\n\n\tif (initfunc)\n\t\tif ((*initfunc)(bus, data))\n\t\t\treturn;\n\n\tiowa_bus_count++;\n\n\tpr_debug(\"IOWA:[%d]Add bus, %pOF.\\n\", iowa_bus_count-1, np);\n}",
    "includes": [
      "#include <asm/io-defs.h>",
      "#include <asm/io-defs.h>",
      "#include <asm/pte-walk.h>",
      "#include <asm/io-workarounds.h>",
      "#include <asm/ppc-pci.h>",
      "#include <asm/machdep.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/sched/mm.h>\t/* for init_mm */",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define IOWA_MAX_BUS\t8"
    ],
    "globals_used": [
      "static struct iowa_bus iowa_busses[IOWA_MAX_BUS];",
      "static unsigned int iowa_bus_count;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"IOWA:[%d]Add bus, %pOF.\\n\"",
            "iowa_bus_count-1",
            "np"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "bus",
            "data"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"IOWA:Too many pci bridges, \"\n\t\t       \"workarounds disabled for %pOF\\n\"",
            "np"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "io_workaround_init",
          "args": [],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "io_workaround_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io-workarounds.c",
          "lines": "171-177",
          "snippet": "static void io_workaround_init(void)\n{\n\tif (io_workaround_inited)\n\t\treturn;\n\tppc_pci_io = iowa_pci_io;\n\tio_workaround_inited = true;\n}",
          "includes": [
            "#include <asm/io-defs.h>",
            "#include <asm/io-defs.h>",
            "#include <asm/pte-walk.h>",
            "#include <asm/io-workarounds.h>",
            "#include <asm/ppc-pci.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/sched/mm.h>\t/* for init_mm */",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool io_workaround_inited;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/io-defs.h>\n#include <asm/io-defs.h>\n#include <asm/pte-walk.h>\n#include <asm/io-workarounds.h>\n#include <asm/ppc-pci.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/sched/mm.h>\t/* for init_mm */\n#include <linux/kernel.h>\n\nbool io_workaround_inited;\n\nstatic void io_workaround_init(void)\n{\n\tif (io_workaround_inited)\n\t\treturn;\n\tppc_pci_io = iowa_pci_io;\n\tio_workaround_inited = true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/io-defs.h>\n#include <asm/io-defs.h>\n#include <asm/pte-walk.h>\n#include <asm/io-workarounds.h>\n#include <asm/ppc-pci.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/sched/mm.h>\t/* for init_mm */\n#include <linux/kernel.h>\n\n#define IOWA_MAX_BUS\t8\n\nstatic struct iowa_bus iowa_busses[IOWA_MAX_BUS];\nstatic unsigned int iowa_bus_count;\n\nvoid iowa_register_bus(struct pci_controller *phb, struct ppc_pci_io *ops,\n\t\t       int (*initfunc)(struct iowa_bus *, void *), void *data)\n{\n\tstruct iowa_bus *bus;\n\tstruct device_node *np = phb->dn;\n\n\tio_workaround_init();\n\n\tif (iowa_bus_count >= IOWA_MAX_BUS) {\n\t\tpr_err(\"IOWA:Too many pci bridges, \"\n\t\t       \"workarounds disabled for %pOF\\n\", np);\n\t\treturn;\n\t}\n\n\tbus = &iowa_busses[iowa_bus_count];\n\tbus->phb = phb;\n\tbus->ops = ops;\n\tbus->private = data;\n\n\tif (initfunc)\n\t\tif ((*initfunc)(bus, data))\n\t\t\treturn;\n\n\tiowa_bus_count++;\n\n\tpr_debug(\"IOWA:[%d]Add bus, %pOF.\\n\", iowa_bus_count-1, np);\n}"
  },
  {
    "function_name": "io_workaround_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io-workarounds.c",
    "lines": "171-177",
    "snippet": "static void io_workaround_init(void)\n{\n\tif (io_workaround_inited)\n\t\treturn;\n\tppc_pci_io = iowa_pci_io;\n\tio_workaround_inited = true;\n}",
    "includes": [
      "#include <asm/io-defs.h>",
      "#include <asm/io-defs.h>",
      "#include <asm/pte-walk.h>",
      "#include <asm/io-workarounds.h>",
      "#include <asm/ppc-pci.h>",
      "#include <asm/machdep.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/sched/mm.h>\t/* for init_mm */",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool io_workaround_inited;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <asm/io-defs.h>\n#include <asm/io-defs.h>\n#include <asm/pte-walk.h>\n#include <asm/io-workarounds.h>\n#include <asm/ppc-pci.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/sched/mm.h>\t/* for init_mm */\n#include <linux/kernel.h>\n\nbool io_workaround_inited;\n\nstatic void io_workaround_init(void)\n{\n\tif (io_workaround_inited)\n\t\treturn;\n\tppc_pci_io = iowa_pci_io;\n\tio_workaround_inited = true;\n}"
  },
  {
    "function_name": "iowa_ioremap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io-workarounds.c",
    "lines": "152-165",
    "snippet": "void __iomem *iowa_ioremap(phys_addr_t addr, unsigned long size,\n\t\t\t   pgprot_t prot, void *caller)\n{\n\tstruct iowa_bus *bus;\n\tvoid __iomem *res = __ioremap_caller(addr, size, prot, caller);\n\tint busno;\n\n\tbus = iowa_pci_find(0, (unsigned long)addr);\n\tif (bus != NULL) {\n\t\tbusno = bus - iowa_busses;\n\t\tPCI_SET_ADDR_TOKEN(res, busno + 1);\n\t}\n\treturn res;\n}",
    "includes": [
      "#include <asm/io-defs.h>",
      "#include <asm/io-defs.h>",
      "#include <asm/pte-walk.h>",
      "#include <asm/io-workarounds.h>",
      "#include <asm/ppc-pci.h>",
      "#include <asm/machdep.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/sched/mm.h>\t/* for init_mm */",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct iowa_bus iowa_busses[IOWA_MAX_BUS];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PCI_SET_ADDR_TOKEN",
          "args": [
            "res",
            "busno + 1"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iowa_pci_find",
          "args": [
            "0",
            "(unsigned long)addr"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "iowa_pci_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io-workarounds.c",
          "lines": "27-53",
          "snippet": "static struct iowa_bus *iowa_pci_find(unsigned long vaddr, unsigned long paddr)\n{\n\tint i, j;\n\tstruct resource *res;\n\tunsigned long vstart, vend;\n\n\tfor (i = 0; i < iowa_bus_count; i++) {\n\t\tstruct iowa_bus *bus = &iowa_busses[i];\n\t\tstruct pci_controller *phb = bus->phb;\n\n\t\tif (vaddr) {\n\t\t\tvstart = (unsigned long)phb->io_base_virt;\n\t\t\tvend = vstart + phb->pci_io_size - 1;\n\t\t\tif ((vaddr >= vstart) && (vaddr <= vend))\n\t\t\t\treturn bus;\n\t\t}\n\n\t\tif (paddr)\n\t\t\tfor (j = 0; j < 3; j++) {\n\t\t\t\tres = &phb->mem_resources[j];\n\t\t\t\tif (paddr >= res->start && paddr <= res->end)\n\t\t\t\t\treturn bus;\n\t\t\t}\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/io-defs.h>",
            "#include <asm/io-defs.h>",
            "#include <asm/pte-walk.h>",
            "#include <asm/io-workarounds.h>",
            "#include <asm/ppc-pci.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/sched/mm.h>\t/* for init_mm */",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct iowa_bus iowa_busses[IOWA_MAX_BUS];",
            "static unsigned int iowa_bus_count;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/io-defs.h>\n#include <asm/io-defs.h>\n#include <asm/pte-walk.h>\n#include <asm/io-workarounds.h>\n#include <asm/ppc-pci.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/sched/mm.h>\t/* for init_mm */\n#include <linux/kernel.h>\n\nstatic struct iowa_bus iowa_busses[IOWA_MAX_BUS];\nstatic unsigned int iowa_bus_count;\n\nstatic struct iowa_bus *iowa_pci_find(unsigned long vaddr, unsigned long paddr)\n{\n\tint i, j;\n\tstruct resource *res;\n\tunsigned long vstart, vend;\n\n\tfor (i = 0; i < iowa_bus_count; i++) {\n\t\tstruct iowa_bus *bus = &iowa_busses[i];\n\t\tstruct pci_controller *phb = bus->phb;\n\n\t\tif (vaddr) {\n\t\t\tvstart = (unsigned long)phb->io_base_virt;\n\t\t\tvend = vstart + phb->pci_io_size - 1;\n\t\t\tif ((vaddr >= vstart) && (vaddr <= vend))\n\t\t\t\treturn bus;\n\t\t}\n\n\t\tif (paddr)\n\t\t\tfor (j = 0; j < 3; j++) {\n\t\t\t\tres = &phb->mem_resources[j];\n\t\t\t\tif (paddr >= res->start && paddr <= res->end)\n\t\t\t\t\treturn bus;\n\t\t\t}\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__ioremap_caller",
          "args": [
            "addr",
            "size",
            "prot",
            "caller"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/io-defs.h>\n#include <asm/io-defs.h>\n#include <asm/pte-walk.h>\n#include <asm/io-workarounds.h>\n#include <asm/ppc-pci.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/sched/mm.h>\t/* for init_mm */\n#include <linux/kernel.h>\n\nstatic struct iowa_bus iowa_busses[IOWA_MAX_BUS];\n\nvoid __iomem *iowa_ioremap(phys_addr_t addr, unsigned long size,\n\t\t\t   pgprot_t prot, void *caller)\n{\n\tstruct iowa_bus *bus;\n\tvoid __iomem *res = __ioremap_caller(addr, size, prot, caller);\n\tint busno;\n\n\tbus = iowa_pci_find(0, (unsigned long)addr);\n\tif (bus != NULL) {\n\t\tbusno = bus - iowa_busses;\n\t\tPCI_SET_ADDR_TOKEN(res, busno + 1);\n\t}\n\treturn res;\n}"
  },
  {
    "function_name": "iowa_pio_find_bus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io-workarounds.c",
    "lines": "106-109",
    "snippet": "struct iowa_bus *iowa_pio_find_bus(unsigned long port)\n{\n\treturn NULL;\n}",
    "includes": [
      "#include <asm/io-defs.h>",
      "#include <asm/io-defs.h>",
      "#include <asm/pte-walk.h>",
      "#include <asm/io-workarounds.h>",
      "#include <asm/ppc-pci.h>",
      "#include <asm/machdep.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/sched/mm.h>\t/* for init_mm */",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/io-defs.h>\n#include <asm/io-defs.h>\n#include <asm/pte-walk.h>\n#include <asm/io-workarounds.h>\n#include <asm/ppc-pci.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/sched/mm.h>\t/* for init_mm */\n#include <linux/kernel.h>\n\nstruct iowa_bus *iowa_pio_find_bus(unsigned long port)\n{\n\treturn NULL;\n}"
  },
  {
    "function_name": "iowa_pio_find_bus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io-workarounds.c",
    "lines": "100-104",
    "snippet": "struct iowa_bus *iowa_pio_find_bus(unsigned long port)\n{\n\tunsigned long vaddr = (unsigned long)pci_io_base + port;\n\treturn iowa_pci_find(vaddr, 0);\n}",
    "includes": [
      "#include <asm/io-defs.h>",
      "#include <asm/io-defs.h>",
      "#include <asm/pte-walk.h>",
      "#include <asm/io-workarounds.h>",
      "#include <asm/ppc-pci.h>",
      "#include <asm/machdep.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/sched/mm.h>\t/* for init_mm */",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iowa_pci_find",
          "args": [
            "vaddr",
            "0"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "iowa_pci_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io-workarounds.c",
          "lines": "27-53",
          "snippet": "static struct iowa_bus *iowa_pci_find(unsigned long vaddr, unsigned long paddr)\n{\n\tint i, j;\n\tstruct resource *res;\n\tunsigned long vstart, vend;\n\n\tfor (i = 0; i < iowa_bus_count; i++) {\n\t\tstruct iowa_bus *bus = &iowa_busses[i];\n\t\tstruct pci_controller *phb = bus->phb;\n\n\t\tif (vaddr) {\n\t\t\tvstart = (unsigned long)phb->io_base_virt;\n\t\t\tvend = vstart + phb->pci_io_size - 1;\n\t\t\tif ((vaddr >= vstart) && (vaddr <= vend))\n\t\t\t\treturn bus;\n\t\t}\n\n\t\tif (paddr)\n\t\t\tfor (j = 0; j < 3; j++) {\n\t\t\t\tres = &phb->mem_resources[j];\n\t\t\t\tif (paddr >= res->start && paddr <= res->end)\n\t\t\t\t\treturn bus;\n\t\t\t}\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/io-defs.h>",
            "#include <asm/io-defs.h>",
            "#include <asm/pte-walk.h>",
            "#include <asm/io-workarounds.h>",
            "#include <asm/ppc-pci.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/sched/mm.h>\t/* for init_mm */",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct iowa_bus iowa_busses[IOWA_MAX_BUS];",
            "static unsigned int iowa_bus_count;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/io-defs.h>\n#include <asm/io-defs.h>\n#include <asm/pte-walk.h>\n#include <asm/io-workarounds.h>\n#include <asm/ppc-pci.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/sched/mm.h>\t/* for init_mm */\n#include <linux/kernel.h>\n\nstatic struct iowa_bus iowa_busses[IOWA_MAX_BUS];\nstatic unsigned int iowa_bus_count;\n\nstatic struct iowa_bus *iowa_pci_find(unsigned long vaddr, unsigned long paddr)\n{\n\tint i, j;\n\tstruct resource *res;\n\tunsigned long vstart, vend;\n\n\tfor (i = 0; i < iowa_bus_count; i++) {\n\t\tstruct iowa_bus *bus = &iowa_busses[i];\n\t\tstruct pci_controller *phb = bus->phb;\n\n\t\tif (vaddr) {\n\t\t\tvstart = (unsigned long)phb->io_base_virt;\n\t\t\tvend = vstart + phb->pci_io_size - 1;\n\t\t\tif ((vaddr >= vstart) && (vaddr <= vend))\n\t\t\t\treturn bus;\n\t\t}\n\n\t\tif (paddr)\n\t\t\tfor (j = 0; j < 3; j++) {\n\t\t\t\tres = &phb->mem_resources[j];\n\t\t\t\tif (paddr >= res->start && paddr <= res->end)\n\t\t\t\t\treturn bus;\n\t\t\t}\n\t}\n\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/io-defs.h>\n#include <asm/io-defs.h>\n#include <asm/pte-walk.h>\n#include <asm/io-workarounds.h>\n#include <asm/ppc-pci.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/sched/mm.h>\t/* for init_mm */\n#include <linux/kernel.h>\n\nstruct iowa_bus *iowa_pio_find_bus(unsigned long port)\n{\n\tunsigned long vaddr = (unsigned long)pci_io_base + port;\n\treturn iowa_pci_find(vaddr, 0);\n}"
  },
  {
    "function_name": "iowa_mem_find_bus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io-workarounds.c",
    "lines": "93-96",
    "snippet": "struct iowa_bus *iowa_mem_find_bus(const PCI_IO_ADDR addr)\n{\n\treturn NULL;\n}",
    "includes": [
      "#include <asm/io-defs.h>",
      "#include <asm/io-defs.h>",
      "#include <asm/pte-walk.h>",
      "#include <asm/io-workarounds.h>",
      "#include <asm/ppc-pci.h>",
      "#include <asm/machdep.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/sched/mm.h>\t/* for init_mm */",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/io-defs.h>\n#include <asm/io-defs.h>\n#include <asm/pte-walk.h>\n#include <asm/io-workarounds.h>\n#include <asm/ppc-pci.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/sched/mm.h>\t/* for init_mm */\n#include <linux/kernel.h>\n\nstruct iowa_bus *iowa_mem_find_bus(const PCI_IO_ADDR addr)\n{\n\treturn NULL;\n}"
  },
  {
    "function_name": "iowa_mem_find_bus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io-workarounds.c",
    "lines": "56-91",
    "snippet": "struct iowa_bus *iowa_mem_find_bus(const PCI_IO_ADDR addr)\n{\n\tunsigned hugepage_shift;\n\tstruct iowa_bus *bus;\n\tint token;\n\n\ttoken = PCI_GET_ADDR_TOKEN(addr);\n\n\tif (token && token <= iowa_bus_count)\n\t\tbus = &iowa_busses[token - 1];\n\telse {\n\t\tunsigned long vaddr, paddr;\n\t\tpte_t *ptep;\n\n\t\tvaddr = (unsigned long)PCI_FIX_ADDR(addr);\n\t\tif (vaddr < PHB_IO_BASE || vaddr >= PHB_IO_END)\n\t\t\treturn NULL;\n\t\t/*\n\t\t * We won't find huge pages here (iomem). Also can't hit\n\t\t * a page table free due to init_mm\n\t\t */\n\t\tptep = find_init_mm_pte(vaddr, &hugepage_shift);\n\t\tif (ptep == NULL)\n\t\t\tpaddr = 0;\n\t\telse {\n\t\t\tWARN_ON(hugepage_shift);\n\t\t\tpaddr = pte_pfn(*ptep) << PAGE_SHIFT;\n\t\t}\n\t\tbus = iowa_pci_find(vaddr, paddr);\n\n\t\tif (bus == NULL)\n\t\t\treturn NULL;\n\t}\n\n\treturn bus;\n}",
    "includes": [
      "#include <asm/io-defs.h>",
      "#include <asm/io-defs.h>",
      "#include <asm/pte-walk.h>",
      "#include <asm/io-workarounds.h>",
      "#include <asm/ppc-pci.h>",
      "#include <asm/machdep.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/sched/mm.h>\t/* for init_mm */",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct iowa_bus iowa_busses[IOWA_MAX_BUS];",
      "static unsigned int iowa_bus_count;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iowa_pci_find",
          "args": [
            "vaddr",
            "paddr"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "iowa_pci_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io-workarounds.c",
          "lines": "27-53",
          "snippet": "static struct iowa_bus *iowa_pci_find(unsigned long vaddr, unsigned long paddr)\n{\n\tint i, j;\n\tstruct resource *res;\n\tunsigned long vstart, vend;\n\n\tfor (i = 0; i < iowa_bus_count; i++) {\n\t\tstruct iowa_bus *bus = &iowa_busses[i];\n\t\tstruct pci_controller *phb = bus->phb;\n\n\t\tif (vaddr) {\n\t\t\tvstart = (unsigned long)phb->io_base_virt;\n\t\t\tvend = vstart + phb->pci_io_size - 1;\n\t\t\tif ((vaddr >= vstart) && (vaddr <= vend))\n\t\t\t\treturn bus;\n\t\t}\n\n\t\tif (paddr)\n\t\t\tfor (j = 0; j < 3; j++) {\n\t\t\t\tres = &phb->mem_resources[j];\n\t\t\t\tif (paddr >= res->start && paddr <= res->end)\n\t\t\t\t\treturn bus;\n\t\t\t}\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/io-defs.h>",
            "#include <asm/io-defs.h>",
            "#include <asm/pte-walk.h>",
            "#include <asm/io-workarounds.h>",
            "#include <asm/ppc-pci.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/sched/mm.h>\t/* for init_mm */",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct iowa_bus iowa_busses[IOWA_MAX_BUS];",
            "static unsigned int iowa_bus_count;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/io-defs.h>\n#include <asm/io-defs.h>\n#include <asm/pte-walk.h>\n#include <asm/io-workarounds.h>\n#include <asm/ppc-pci.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/sched/mm.h>\t/* for init_mm */\n#include <linux/kernel.h>\n\nstatic struct iowa_bus iowa_busses[IOWA_MAX_BUS];\nstatic unsigned int iowa_bus_count;\n\nstatic struct iowa_bus *iowa_pci_find(unsigned long vaddr, unsigned long paddr)\n{\n\tint i, j;\n\tstruct resource *res;\n\tunsigned long vstart, vend;\n\n\tfor (i = 0; i < iowa_bus_count; i++) {\n\t\tstruct iowa_bus *bus = &iowa_busses[i];\n\t\tstruct pci_controller *phb = bus->phb;\n\n\t\tif (vaddr) {\n\t\t\tvstart = (unsigned long)phb->io_base_virt;\n\t\t\tvend = vstart + phb->pci_io_size - 1;\n\t\t\tif ((vaddr >= vstart) && (vaddr <= vend))\n\t\t\t\treturn bus;\n\t\t}\n\n\t\tif (paddr)\n\t\t\tfor (j = 0; j < 3; j++) {\n\t\t\t\tres = &phb->mem_resources[j];\n\t\t\t\tif (paddr >= res->start && paddr <= res->end)\n\t\t\t\t\treturn bus;\n\t\t\t}\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pte_pfn",
          "args": [
            "*ptep"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "hugepage_shift"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_init_mm_pte",
          "args": [
            "vaddr",
            "&hugepage_shift"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PCI_FIX_ADDR",
          "args": [
            "addr"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PCI_GET_ADDR_TOKEN",
          "args": [
            "addr"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/io-defs.h>\n#include <asm/io-defs.h>\n#include <asm/pte-walk.h>\n#include <asm/io-workarounds.h>\n#include <asm/ppc-pci.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/sched/mm.h>\t/* for init_mm */\n#include <linux/kernel.h>\n\nstatic struct iowa_bus iowa_busses[IOWA_MAX_BUS];\nstatic unsigned int iowa_bus_count;\n\nstruct iowa_bus *iowa_mem_find_bus(const PCI_IO_ADDR addr)\n{\n\tunsigned hugepage_shift;\n\tstruct iowa_bus *bus;\n\tint token;\n\n\ttoken = PCI_GET_ADDR_TOKEN(addr);\n\n\tif (token && token <= iowa_bus_count)\n\t\tbus = &iowa_busses[token - 1];\n\telse {\n\t\tunsigned long vaddr, paddr;\n\t\tpte_t *ptep;\n\n\t\tvaddr = (unsigned long)PCI_FIX_ADDR(addr);\n\t\tif (vaddr < PHB_IO_BASE || vaddr >= PHB_IO_END)\n\t\t\treturn NULL;\n\t\t/*\n\t\t * We won't find huge pages here (iomem). Also can't hit\n\t\t * a page table free due to init_mm\n\t\t */\n\t\tptep = find_init_mm_pte(vaddr, &hugepage_shift);\n\t\tif (ptep == NULL)\n\t\t\tpaddr = 0;\n\t\telse {\n\t\t\tWARN_ON(hugepage_shift);\n\t\t\tpaddr = pte_pfn(*ptep) << PAGE_SHIFT;\n\t\t}\n\t\tbus = iowa_pci_find(vaddr, paddr);\n\n\t\tif (bus == NULL)\n\t\t\treturn NULL;\n\t}\n\n\treturn bus;\n}"
  },
  {
    "function_name": "iowa_pci_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io-workarounds.c",
    "lines": "27-53",
    "snippet": "static struct iowa_bus *iowa_pci_find(unsigned long vaddr, unsigned long paddr)\n{\n\tint i, j;\n\tstruct resource *res;\n\tunsigned long vstart, vend;\n\n\tfor (i = 0; i < iowa_bus_count; i++) {\n\t\tstruct iowa_bus *bus = &iowa_busses[i];\n\t\tstruct pci_controller *phb = bus->phb;\n\n\t\tif (vaddr) {\n\t\t\tvstart = (unsigned long)phb->io_base_virt;\n\t\t\tvend = vstart + phb->pci_io_size - 1;\n\t\t\tif ((vaddr >= vstart) && (vaddr <= vend))\n\t\t\t\treturn bus;\n\t\t}\n\n\t\tif (paddr)\n\t\t\tfor (j = 0; j < 3; j++) {\n\t\t\t\tres = &phb->mem_resources[j];\n\t\t\t\tif (paddr >= res->start && paddr <= res->end)\n\t\t\t\t\treturn bus;\n\t\t\t}\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "#include <asm/io-defs.h>",
      "#include <asm/io-defs.h>",
      "#include <asm/pte-walk.h>",
      "#include <asm/io-workarounds.h>",
      "#include <asm/ppc-pci.h>",
      "#include <asm/machdep.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/sched/mm.h>\t/* for init_mm */",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct iowa_bus iowa_busses[IOWA_MAX_BUS];",
      "static unsigned int iowa_bus_count;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <asm/io-defs.h>\n#include <asm/io-defs.h>\n#include <asm/pte-walk.h>\n#include <asm/io-workarounds.h>\n#include <asm/ppc-pci.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/sched/mm.h>\t/* for init_mm */\n#include <linux/kernel.h>\n\nstatic struct iowa_bus iowa_busses[IOWA_MAX_BUS];\nstatic unsigned int iowa_bus_count;\n\nstatic struct iowa_bus *iowa_pci_find(unsigned long vaddr, unsigned long paddr)\n{\n\tint i, j;\n\tstruct resource *res;\n\tunsigned long vstart, vend;\n\n\tfor (i = 0; i < iowa_bus_count; i++) {\n\t\tstruct iowa_bus *bus = &iowa_busses[i];\n\t\tstruct pci_controller *phb = bus->phb;\n\n\t\tif (vaddr) {\n\t\t\tvstart = (unsigned long)phb->io_base_virt;\n\t\t\tvend = vstart + phb->pci_io_size - 1;\n\t\t\tif ((vaddr >= vstart) && (vaddr <= vend))\n\t\t\t\treturn bus;\n\t\t}\n\n\t\tif (paddr)\n\t\t\tfor (j = 0; j < 3; j++) {\n\t\t\t\tres = &phb->mem_resources[j];\n\t\t\t\tif (paddr >= res->start && paddr <= res->end)\n\t\t\t\t\treturn bus;\n\t\t\t}\n\t}\n\n\treturn NULL;\n}"
  }
]