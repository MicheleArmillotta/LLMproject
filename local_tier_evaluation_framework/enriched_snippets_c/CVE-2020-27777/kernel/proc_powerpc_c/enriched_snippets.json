[
  {
    "function_name": "proc_ppc64_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/proc_powerpc.c",
    "lines": "69-92",
    "snippet": "static int __init proc_ppc64_create(void)\n{\n\tstruct proc_dir_entry *root;\n\n\troot = proc_mkdir(\"powerpc\", NULL);\n\tif (!root)\n\t\treturn 1;\n\n#ifdef CONFIG_PPC64\n\tif (!proc_symlink(\"ppc64\", NULL, \"powerpc\"))\n\t\tpr_err(\"Failed to create link /proc/ppc64 -> /proc/powerpc\\n\");\n#endif\n\n\tif (!of_find_node_by_path(\"/rtas\"))\n\t\treturn 0;\n\n\tif (!proc_mkdir(\"rtas\", root))\n\t\treturn 1;\n\n\tif (!proc_symlink(\"rtas\", NULL, \"powerpc/rtas\"))\n\t\treturn 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/prom.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/rtas.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/machdep.h>",
      "#include <linux/kernel.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/mm.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_symlink",
          "args": [
            "\"rtas\"",
            "NULL",
            "\"powerpc/rtas\""
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_mkdir",
          "args": [
            "\"rtas\"",
            "root"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_path",
          "args": [
            "\"/rtas\""
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Failed to create link /proc/ppc64 -> /proc/powerpc\\n\""
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_symlink",
          "args": [
            "\"ppc64\"",
            "NULL",
            "\"powerpc\""
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_mkdir",
          "args": [
            "\"powerpc\"",
            "NULL"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/prom.h>\n#include <linux/uaccess.h>\n#include <asm/rtas.h>\n#include <asm/vdso_datapage.h>\n#include <asm/machdep.h>\n#include <linux/kernel.h>\n#include <linux/proc_fs.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nstatic int __init proc_ppc64_create(void)\n{\n\tstruct proc_dir_entry *root;\n\n\troot = proc_mkdir(\"powerpc\", NULL);\n\tif (!root)\n\t\treturn 1;\n\n#ifdef CONFIG_PPC64\n\tif (!proc_symlink(\"ppc64\", NULL, \"powerpc\"))\n\t\tpr_err(\"Failed to create link /proc/ppc64 -> /proc/powerpc\\n\");\n#endif\n\n\tif (!of_find_node_by_path(\"/rtas\"))\n\t\treturn 0;\n\n\tif (!proc_mkdir(\"rtas\", root))\n\t\treturn 1;\n\n\tif (!proc_symlink(\"rtas\", NULL, \"powerpc/rtas\"))\n\t\treturn 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "proc_ppc64_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/proc_powerpc.c",
    "lines": "49-60",
    "snippet": "static int __init proc_ppc64_init(void)\n{\n\tstruct proc_dir_entry *pde;\n\n\tpde = proc_create_data(\"powerpc/systemcfg\", S_IFREG | 0444, NULL,\n\t\t\t       &page_map_proc_ops, vdso_data);\n\tif (!pde)\n\t\treturn 1;\n\tproc_set_size(pde, PAGE_SIZE);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/prom.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/rtas.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/machdep.h>",
      "#include <linux/kernel.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/mm.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_set_size",
          "args": [
            "pde",
            "PAGE_SIZE"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_create_data",
          "args": [
            "\"powerpc/systemcfg\"",
            "S_IFREG | 0444",
            "NULL",
            "&page_map_proc_ops",
            "vdso_data"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/prom.h>\n#include <linux/uaccess.h>\n#include <asm/rtas.h>\n#include <asm/vdso_datapage.h>\n#include <asm/machdep.h>\n#include <linux/kernel.h>\n#include <linux/proc_fs.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nstatic int __init proc_ppc64_init(void)\n{\n\tstruct proc_dir_entry *pde;\n\n\tpde = proc_create_data(\"powerpc/systemcfg\", S_IFREG | 0444, NULL,\n\t\t\t       &page_map_proc_ops, vdso_data);\n\tif (!pde)\n\t\treturn 1;\n\tproc_set_size(pde, PAGE_SIZE);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "page_map_mmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/proc_powerpc.c",
    "lines": "31-40",
    "snippet": "static int page_map_mmap( struct file *file, struct vm_area_struct *vma )\n{\n\tif ((vma->vm_end - vma->vm_start) > PAGE_SIZE)\n\t\treturn -EINVAL;\n\n\tremap_pfn_range(vma, vma->vm_start,\n\t\t\t__pa(PDE_DATA(file_inode(file))) >> PAGE_SHIFT,\n\t\t\tPAGE_SIZE, vma->vm_page_prot);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/prom.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/rtas.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/machdep.h>",
      "#include <linux/kernel.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/mm.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "remap_pfn_range",
          "args": [
            "vma",
            "vma->vm_start",
            "__pa(PDE_DATA(file_inode(file))) >> PAGE_SHIFT",
            "PAGE_SIZE",
            "vma->vm_page_prot"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__pa",
          "args": [
            "PDE_DATA(file_inode(file))"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "__parse_fpscr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/traps.c",
          "lines": "1164-1189",
          "snippet": "static inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/nmi.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/kprobes.h>",
            "#include <sysdev/fsl_pci.h>",
            "#include <asm/hmi.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/fadump.h>",
            "#include <asm/rio.h>",
            "#include <asm/ppc-opcode.h>",
            "#include <asm/kexec.h>",
            "#include <asm/tm.h>",
            "#include <asm/processor.h>",
            "#include <asm/firmware.h>",
            "#include <asm/backlight.h>",
            "#include <asm/reg.h>",
            "#include <asm/pmc.h>",
            "#include <asm/rtas.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/emulated_ops.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/console.h>",
            "#include <linux/smp.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/bug.h>",
            "#include <linux/backlight.h>",
            "#include <linux/kexec.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/delay.h>",
            "#include <linux/prctl.h>",
            "#include <linux/module.h>\t/* print_modules */",
            "#include <linux/extable.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/user.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/nmi.h>\n#include <asm/stacktrace.h>\n#include <asm/kprobes.h>\n#include <sysdev/fsl_pci.h>\n#include <asm/hmi.h>\n#include <asm/asm-prototypes.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/fadump.h>\n#include <asm/rio.h>\n#include <asm/ppc-opcode.h>\n#include <asm/kexec.h>\n#include <asm/tm.h>\n#include <asm/processor.h>\n#include <asm/firmware.h>\n#include <asm/backlight.h>\n#include <asm/reg.h>\n#include <asm/pmc.h>\n#include <asm/rtas.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/uaccess.h>\n#include <asm/emulated_ops.h>\n#include <linux/kmsg_dump.h>\n#include <linux/console.h>\n#include <linux/smp.h>\n#include <linux/context_tracking.h>\n#include <linux/ratelimit.h>\n#include <linux/kdebug.h>\n#include <linux/bug.h>\n#include <linux/backlight.h>\n#include <linux/kexec.h>\n#include <linux/kprobes.h>\n#include <linux/delay.h>\n#include <linux/prctl.h>\n#include <linux/module.h>\t/* print_modules */\n#include <linux/extable.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/user.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/pkeys.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PDE_DATA",
          "args": [
            "file_inode(file)"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "file"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/prom.h>\n#include <linux/uaccess.h>\n#include <asm/rtas.h>\n#include <asm/vdso_datapage.h>\n#include <asm/machdep.h>\n#include <linux/kernel.h>\n#include <linux/proc_fs.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nstatic int page_map_mmap( struct file *file, struct vm_area_struct *vma )\n{\n\tif ((vma->vm_end - vma->vm_start) > PAGE_SIZE)\n\t\treturn -EINVAL;\n\n\tremap_pfn_range(vma, vma->vm_start,\n\t\t\t__pa(PDE_DATA(file_inode(file))) >> PAGE_SHIFT,\n\t\t\tPAGE_SIZE, vma->vm_page_prot);\n\treturn 0;\n}"
  },
  {
    "function_name": "page_map_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/proc_powerpc.c",
    "lines": "24-29",
    "snippet": "static ssize_t page_map_read( struct file *file, char __user *buf, size_t nbytes,\n\t\t\t      loff_t *ppos)\n{\n\treturn simple_read_from_buffer(buf, nbytes, ppos,\n\t\t\tPDE_DATA(file_inode(file)), PAGE_SIZE);\n}",
    "includes": [
      "#include <asm/prom.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/rtas.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/machdep.h>",
      "#include <linux/kernel.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/mm.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_read_from_buffer",
          "args": [
            "buf",
            "nbytes",
            "ppos",
            "PDE_DATA(file_inode(file))",
            "PAGE_SIZE"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PDE_DATA",
          "args": [
            "file_inode(file)"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "file"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/prom.h>\n#include <linux/uaccess.h>\n#include <asm/rtas.h>\n#include <asm/vdso_datapage.h>\n#include <asm/machdep.h>\n#include <linux/kernel.h>\n#include <linux/proc_fs.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nstatic ssize_t page_map_read( struct file *file, char __user *buf, size_t nbytes,\n\t\t\t      loff_t *ppos)\n{\n\treturn simple_read_from_buffer(buf, nbytes, ppos,\n\t\t\tPDE_DATA(file_inode(file)), PAGE_SIZE);\n}"
  },
  {
    "function_name": "page_map_seek",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/proc_powerpc.c",
    "lines": "19-22",
    "snippet": "static loff_t page_map_seek(struct file *file, loff_t off, int whence)\n{\n\treturn fixed_size_llseek(file, off, whence, PAGE_SIZE);\n}",
    "includes": [
      "#include <asm/prom.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/rtas.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/machdep.h>",
      "#include <linux/kernel.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/mm.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fixed_size_llseek",
          "args": [
            "file",
            "off",
            "whence",
            "PAGE_SIZE"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/prom.h>\n#include <linux/uaccess.h>\n#include <asm/rtas.h>\n#include <asm/vdso_datapage.h>\n#include <asm/machdep.h>\n#include <linux/kernel.h>\n#include <linux/proc_fs.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nstatic loff_t page_map_seek(struct file *file, loff_t off, int whence)\n{\n\treturn fixed_size_llseek(file, off, whence, PAGE_SIZE);\n}"
  }
]