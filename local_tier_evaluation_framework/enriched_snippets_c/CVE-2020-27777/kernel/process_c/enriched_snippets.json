[
  {
    "function_name": "arch_randomize_brk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "2257-2281",
    "snippet": "unsigned long arch_randomize_brk(struct mm_struct *mm)\n{\n\tunsigned long base = mm->brk;\n\tunsigned long ret;\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\t/*\n\t * If we are using 1TB segments and we are allowed to randomise\n\t * the heap, we can put it above 1TB so it is backed by a 1TB\n\t * segment. Otherwise the heap will be in the bottom 1TB\n\t * which always uses 256MB segments and this may result in a\n\t * performance penalty. We don't need to worry about radix. For\n\t * radix, mmu_highuser_ssize remains unchanged from 256MB.\n\t */\n\tif (!is_32bit_task() && (mmu_highuser_ssize == MMU_SEGSIZE_1T))\n\t\tbase = max_t(unsigned long, mm->brk, 1UL << SID_SHIFT_1T);\n#endif\n\n\tret = PAGE_ALIGN(base + brk_rnd());\n\n\tif (ret < mm->brk)\n\t\treturn mm->brk;\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PAGE_ALIGN",
          "args": [
            "base + brk_rnd()"
          ],
          "line": 2275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "brk_rnd",
          "args": [],
          "line": 2275
        },
        "resolved": true,
        "details": {
          "function_name": "brk_rnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "2244-2255",
          "snippet": "static inline unsigned long brk_rnd(void)\n{\n        unsigned long rnd = 0;\n\n\t/* 8MB for 32bit, 1GB for 64bit */\n\tif (is_32bit_task())\n\t\trnd = (get_random_long() % (1UL<<(23-PAGE_SHIFT)));\n\telse\n\t\trnd = (get_random_long() % (1UL<<(30-PAGE_SHIFT)));\n\n\treturn rnd << PAGE_SHIFT;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline unsigned long brk_rnd(void)\n{\n        unsigned long rnd = 0;\n\n\t/* 8MB for 32bit, 1GB for 64bit */\n\tif (is_32bit_task())\n\t\trnd = (get_random_long() % (1UL<<(23-PAGE_SHIFT)));\n\telse\n\t\trnd = (get_random_long() % (1UL<<(30-PAGE_SHIFT)));\n\n\treturn rnd << PAGE_SHIFT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "max_t",
          "args": [
            "unsignedlong",
            "mm->brk",
            "1UL << SID_SHIFT_1T"
          ],
          "line": 2272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_32bit_task",
          "args": [],
          "line": 2271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long arch_randomize_brk(struct mm_struct *mm)\n{\n\tunsigned long base = mm->brk;\n\tunsigned long ret;\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\t/*\n\t * If we are using 1TB segments and we are allowed to randomise\n\t * the heap, we can put it above 1TB so it is backed by a 1TB\n\t * segment. Otherwise the heap will be in the bottom 1TB\n\t * which always uses 256MB segments and this may result in a\n\t * performance penalty. We don't need to worry about radix. For\n\t * radix, mmu_highuser_ssize remains unchanged from 256MB.\n\t */\n\tif (!is_32bit_task() && (mmu_highuser_ssize == MMU_SEGSIZE_1T))\n\t\tbase = max_t(unsigned long, mm->brk, 1UL << SID_SHIFT_1T);\n#endif\n\n\tret = PAGE_ALIGN(base + brk_rnd());\n\n\tif (ret < mm->brk)\n\t\treturn mm->brk;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "brk_rnd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "2244-2255",
    "snippet": "static inline unsigned long brk_rnd(void)\n{\n        unsigned long rnd = 0;\n\n\t/* 8MB for 32bit, 1GB for 64bit */\n\tif (is_32bit_task())\n\t\trnd = (get_random_long() % (1UL<<(23-PAGE_SHIFT)));\n\telse\n\t\trnd = (get_random_long() % (1UL<<(30-PAGE_SHIFT)));\n\n\treturn rnd << PAGE_SHIFT;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_random_long",
          "args": [],
          "line": 2252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_random_long",
          "args": [],
          "line": 2250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_32bit_task",
          "args": [],
          "line": 2249
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline unsigned long brk_rnd(void)\n{\n        unsigned long rnd = 0;\n\n\t/* 8MB for 32bit, 1GB for 64bit */\n\tif (is_32bit_task())\n\t\trnd = (get_random_long() % (1UL<<(23-PAGE_SHIFT)));\n\telse\n\t\trnd = (get_random_long() % (1UL<<(30-PAGE_SHIFT)));\n\n\treturn rnd << PAGE_SHIFT;\n}"
  },
  {
    "function_name": "arch_align_stack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "2237-2242",
    "snippet": "unsigned long arch_align_stack(unsigned long sp)\n{\n\tif (!(current->personality & ADDR_NO_RANDOMIZE) && randomize_va_space)\n\t\tsp -= get_random_int() & ~PAGE_MASK;\n\treturn sp & ~0xf;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_random_int",
          "args": [],
          "line": 2240
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long arch_align_stack(unsigned long sp)\n{\n\tif (!(current->personality & ADDR_NO_RANDOMIZE) && randomize_va_space)\n\t\tsp -= get_random_int() & ~PAGE_MASK;\n\treturn sp & ~0xf;\n}"
  },
  {
    "function_name": "__ppc64_runlatch_off",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "2219-2234",
    "snippet": "void notrace __ppc64_runlatch_off(void)\n{\n\tstruct thread_info *ti = current_thread_info();\n\n\tti->local_flags &= ~_TLF_RUNLATCH;\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206)) {\n\t\tmtspr(SPRN_CTRLT, 0);\n\t} else {\n\t\tunsigned long ctrl;\n\n\t\tctrl = mfspr(SPRN_CTRLF);\n\t\tctrl &= ~CTRL_RUNLATCH;\n\t\tmtspr(SPRN_CTRLT, ctrl);\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_CTRLT",
            "ctrl"
          ],
          "line": 2232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_CTRLF"
          ],
          "line": 2230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_CTRLT",
            "0"
          ],
          "line": 2226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_206"
          ],
          "line": 2225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_thread_info",
          "args": [],
          "line": 2221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __ppc64_runlatch_off(void)\n{\n\tstruct thread_info *ti = current_thread_info();\n\n\tti->local_flags &= ~_TLF_RUNLATCH;\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206)) {\n\t\tmtspr(SPRN_CTRLT, 0);\n\t} else {\n\t\tunsigned long ctrl;\n\n\t\tctrl = mfspr(SPRN_CTRLF);\n\t\tctrl &= ~CTRL_RUNLATCH;\n\t\tmtspr(SPRN_CTRLT, ctrl);\n\t}\n}"
  },
  {
    "function_name": "__ppc64_runlatch_on",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "2192-2216",
    "snippet": "void notrace __ppc64_runlatch_on(void)\n{\n\tstruct thread_info *ti = current_thread_info();\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206)) {\n\t\t/*\n\t\t * Least significant bit (RUN) is the only writable bit of\n\t\t * the CTRL register, so we can avoid mfspr. 2.06 is not the\n\t\t * earliest ISA where this is the case, but it's convenient.\n\t\t */\n\t\tmtspr(SPRN_CTRLT, CTRL_RUNLATCH);\n\t} else {\n\t\tunsigned long ctrl;\n\n\t\t/*\n\t\t * Some architectures (e.g., Cell) have writable fields other\n\t\t * than RUN, so do the read-modify-write.\n\t\t */\n\t\tctrl = mfspr(SPRN_CTRLF);\n\t\tctrl |= CTRL_RUNLATCH;\n\t\tmtspr(SPRN_CTRLT, ctrl);\n\t}\n\n\tti->local_flags |= _TLF_RUNLATCH;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_CTRLT",
            "ctrl"
          ],
          "line": 2212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_CTRLF"
          ],
          "line": 2210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_CTRLT",
            "CTRL_RUNLATCH"
          ],
          "line": 2202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_206"
          ],
          "line": 2196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_thread_info",
          "args": [],
          "line": 2194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __ppc64_runlatch_on(void)\n{\n\tstruct thread_info *ti = current_thread_info();\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206)) {\n\t\t/*\n\t\t * Least significant bit (RUN) is the only writable bit of\n\t\t * the CTRL register, so we can avoid mfspr. 2.06 is not the\n\t\t * earliest ISA where this is the case, but it's convenient.\n\t\t */\n\t\tmtspr(SPRN_CTRLT, CTRL_RUNLATCH);\n\t} else {\n\t\tunsigned long ctrl;\n\n\t\t/*\n\t\t * Some architectures (e.g., Cell) have writable fields other\n\t\t * than RUN, so do the read-modify-write.\n\t\t */\n\t\tctrl = mfspr(SPRN_CTRLF);\n\t\tctrl |= CTRL_RUNLATCH;\n\t\tmtspr(SPRN_CTRLT, ctrl);\n\t}\n\n\tti->local_flags |= _TLF_RUNLATCH;\n}"
  },
  {
    "function_name": "show_stack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "2124-2188",
    "snippet": "void show_stack(struct task_struct *tsk, unsigned long *stack,\n\t\tconst char *loglvl)\n{\n\tunsigned long sp, ip, lr, newsp;\n\tint count = 0;\n\tint firstframe = 1;\n\tunsigned long ret_addr;\n\tint ftrace_idx = 0;\n\n\tif (tsk == NULL)\n\t\ttsk = current;\n\n\tif (!try_get_task_stack(tsk))\n\t\treturn;\n\n\tsp = (unsigned long) stack;\n\tif (sp == 0) {\n\t\tif (tsk == current)\n\t\t\tsp = current_stack_frame();\n\t\telse\n\t\t\tsp = tsk->thread.ksp;\n\t}\n\n\tlr = 0;\n\tprintk(\"%sCall Trace:\\n\", loglvl);\n\tdo {\n\t\tif (!validate_sp(sp, tsk, STACK_FRAME_OVERHEAD))\n\t\t\tbreak;\n\n\t\tstack = (unsigned long *) sp;\n\t\tnewsp = stack[0];\n\t\tip = stack[STACK_FRAME_LR_SAVE];\n\t\tif (!firstframe || ip != lr) {\n\t\t\tprintk(\"%s[\"REG\"] [\"REG\"] %pS\",\n\t\t\t\tloglvl, sp, ip, (void *)ip);\n\t\t\tret_addr = ftrace_graph_ret_addr(current,\n\t\t\t\t\t\t&ftrace_idx, ip, stack);\n\t\t\tif (ret_addr != ip)\n\t\t\t\tpr_cont(\" (%pS)\", (void *)ret_addr);\n\t\t\tif (firstframe)\n\t\t\t\tpr_cont(\" (unreliable)\");\n\t\t\tpr_cont(\"\\n\");\n\t\t}\n\t\tfirstframe = 0;\n\n\t\t/*\n\t\t * See if this is an exception frame.\n\t\t * We look for the \"regshere\" marker in the current frame.\n\t\t */\n\t\tif (validate_sp(sp, tsk, STACK_INT_FRAME_SIZE)\n\t\t    && stack[STACK_FRAME_MARKER] == STACK_FRAME_REGS_MARKER) {\n\t\t\tstruct pt_regs *regs = (struct pt_regs *)\n\t\t\t\t(sp + STACK_FRAME_OVERHEAD);\n\t\t\tlr = regs->link;\n\t\t\tprintk(\"%s--- interrupt: %lx at %pS\\n    LR = %pS\\n\",\n\t\t\t       loglvl, regs->trap,\n\t\t\t       (void *)regs->nip, (void *)lr);\n\t\t\tfirstframe = 1;\n\t\t}\n\n\t\tsp = newsp;\n\t} while (count++ < kstack_depth_to_print);\n\n\tput_task_stack(tsk);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define REG\t\t\"%08lx\"",
      "#define REG\t\t\"%016lx\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_task_stack",
          "args": [
            "tsk"
          ],
          "line": 2187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"%s--- interrupt: %lx at %pS\\n    LR = %pS\\n\"",
            "loglvl",
            "regs->trap",
            "(void *)regs->nip",
            "(void *)lr"
          ],
          "line": 2178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "validate_sp",
          "args": [
            "sp",
            "tsk",
            "STACK_INT_FRAME_SIZE"
          ],
          "line": 2173
        },
        "resolved": true,
        "details": {
          "function_name": "validate_sp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "2063-2078",
          "snippet": "int validate_sp(unsigned long sp, struct task_struct *p,\n\t\t       unsigned long nbytes)\n{\n\tunsigned long stack_page = (unsigned long)task_stack_page(p);\n\n\tif (sp < THREAD_SIZE)\n\t\treturn 0;\n\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tif (valid_irq_stack(sp, p, nbytes))\n\t\treturn 1;\n\n\treturn valid_emergency_stack(sp, p, nbytes);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint validate_sp(unsigned long sp, struct task_struct *p,\n\t\t       unsigned long nbytes)\n{\n\tunsigned long stack_page = (unsigned long)task_stack_page(p);\n\n\tif (sp < THREAD_SIZE)\n\t\treturn 0;\n\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tif (valid_irq_stack(sp, p, nbytes))\n\t\treturn 1;\n\n\treturn valid_emergency_stack(sp, p, nbytes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"\\n\""
          ],
          "line": 2165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\" (unreliable)\""
          ],
          "line": 2164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\" (%pS)\"",
            "(void *)ret_addr"
          ],
          "line": 2162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ftrace_graph_ret_addr",
          "args": [
            "current",
            "&ftrace_idx",
            "ip",
            "stack"
          ],
          "line": 2159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"%s[\"REG\"] [\"REG\"] %pS\"",
            "loglvl",
            "sp",
            "ip",
            "(void *)ip"
          ],
          "line": 2157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"%sCall Trace:\\n\"",
            "loglvl"
          ],
          "line": 2148
        },
        "resolved": true,
        "details": {
          "function_name": "printk_log_rtas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/rtasd.c",
          "lines": "110-157",
          "snippet": "static void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}",
          "includes": [
            "#include <asm/topology.h>",
            "#include <asm/machdep.h>",
            "#include <linux/atomic.h>",
            "#include <asm/nvram.h>",
            "#include <asm/prom.h>",
            "#include <asm/rtas.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/topology.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/cpu.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool full_rtas_msgs;",
            "static int error_log_cnt;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/topology.h>\n#include <asm/machdep.h>\n#include <linux/atomic.h>\n#include <asm/nvram.h>\n#include <asm/prom.h>\n#include <asm/rtas.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <linux/topology.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/cpu.h>\n#include <linux/spinlock.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic bool full_rtas_msgs;\nstatic int error_log_cnt;\n\nstatic void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_stack_frame",
          "args": [],
          "line": 2142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "try_get_task_stack",
          "args": [
            "tsk"
          ],
          "line": 2136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define REG\t\t\"%08lx\"\n#define REG\t\t\"%016lx\"\n\nvoid show_stack(struct task_struct *tsk, unsigned long *stack,\n\t\tconst char *loglvl)\n{\n\tunsigned long sp, ip, lr, newsp;\n\tint count = 0;\n\tint firstframe = 1;\n\tunsigned long ret_addr;\n\tint ftrace_idx = 0;\n\n\tif (tsk == NULL)\n\t\ttsk = current;\n\n\tif (!try_get_task_stack(tsk))\n\t\treturn;\n\n\tsp = (unsigned long) stack;\n\tif (sp == 0) {\n\t\tif (tsk == current)\n\t\t\tsp = current_stack_frame();\n\t\telse\n\t\t\tsp = tsk->thread.ksp;\n\t}\n\n\tlr = 0;\n\tprintk(\"%sCall Trace:\\n\", loglvl);\n\tdo {\n\t\tif (!validate_sp(sp, tsk, STACK_FRAME_OVERHEAD))\n\t\t\tbreak;\n\n\t\tstack = (unsigned long *) sp;\n\t\tnewsp = stack[0];\n\t\tip = stack[STACK_FRAME_LR_SAVE];\n\t\tif (!firstframe || ip != lr) {\n\t\t\tprintk(\"%s[\"REG\"] [\"REG\"] %pS\",\n\t\t\t\tloglvl, sp, ip, (void *)ip);\n\t\t\tret_addr = ftrace_graph_ret_addr(current,\n\t\t\t\t\t\t&ftrace_idx, ip, stack);\n\t\t\tif (ret_addr != ip)\n\t\t\t\tpr_cont(\" (%pS)\", (void *)ret_addr);\n\t\t\tif (firstframe)\n\t\t\t\tpr_cont(\" (unreliable)\");\n\t\t\tpr_cont(\"\\n\");\n\t\t}\n\t\tfirstframe = 0;\n\n\t\t/*\n\t\t * See if this is an exception frame.\n\t\t * We look for the \"regshere\" marker in the current frame.\n\t\t */\n\t\tif (validate_sp(sp, tsk, STACK_INT_FRAME_SIZE)\n\t\t    && stack[STACK_FRAME_MARKER] == STACK_FRAME_REGS_MARKER) {\n\t\t\tstruct pt_regs *regs = (struct pt_regs *)\n\t\t\t\t(sp + STACK_FRAME_OVERHEAD);\n\t\t\tlr = regs->link;\n\t\t\tprintk(\"%s--- interrupt: %lx at %pS\\n    LR = %pS\\n\",\n\t\t\t       loglvl, regs->trap,\n\t\t\t       (void *)regs->nip, (void *)lr);\n\t\t\tfirstframe = 1;\n\t\t}\n\n\t\tsp = newsp;\n\t} while (count++ < kstack_depth_to_print);\n\n\tput_task_stack(tsk);\n}"
  },
  {
    "function_name": "get_wchan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "2108-2120",
    "snippet": "unsigned long get_wchan(struct task_struct *p)\n{\n\tunsigned long ret;\n\n\tif (!try_get_task_stack(p))\n\t\treturn 0;\n\n\tret = __get_wchan(p);\n\n\tput_task_stack(p);\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_task_stack",
          "args": [
            "p"
          ],
          "line": 2117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_wchan",
          "args": [
            "p"
          ],
          "line": 2115
        },
        "resolved": true,
        "details": {
          "function_name": "__get_wchan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "2082-2106",
          "snippet": "static unsigned long __get_wchan(struct task_struct *p)\n{\n\tunsigned long ip, sp;\n\tint count = 0;\n\n\tif (!p || p == current || p->state == TASK_RUNNING)\n\t\treturn 0;\n\n\tsp = p->thread.ksp;\n\tif (!validate_sp(sp, p, STACK_FRAME_OVERHEAD))\n\t\treturn 0;\n\n\tdo {\n\t\tsp = *(unsigned long *)sp;\n\t\tif (!validate_sp(sp, p, STACK_FRAME_OVERHEAD) ||\n\t\t    p->state == TASK_RUNNING)\n\t\t\treturn 0;\n\t\tif (count > 0) {\n\t\t\tip = ((unsigned long *)sp)[STACK_FRAME_LR_SAVE];\n\t\t\tif (!in_sched_functions(ip))\n\t\t\t\treturn ip;\n\t\t}\n\t} while (count++ < 16);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic unsigned long __get_wchan(struct task_struct *p)\n{\n\tunsigned long ip, sp;\n\tint count = 0;\n\n\tif (!p || p == current || p->state == TASK_RUNNING)\n\t\treturn 0;\n\n\tsp = p->thread.ksp;\n\tif (!validate_sp(sp, p, STACK_FRAME_OVERHEAD))\n\t\treturn 0;\n\n\tdo {\n\t\tsp = *(unsigned long *)sp;\n\t\tif (!validate_sp(sp, p, STACK_FRAME_OVERHEAD) ||\n\t\t    p->state == TASK_RUNNING)\n\t\t\treturn 0;\n\t\tif (count > 0) {\n\t\t\tip = ((unsigned long *)sp)[STACK_FRAME_LR_SAVE];\n\t\t\tif (!in_sched_functions(ip))\n\t\t\t\treturn ip;\n\t\t}\n\t} while (count++ < 16);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "try_get_task_stack",
          "args": [
            "p"
          ],
          "line": 2112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long get_wchan(struct task_struct *p)\n{\n\tunsigned long ret;\n\n\tif (!try_get_task_stack(p))\n\t\treturn 0;\n\n\tret = __get_wchan(p);\n\n\tput_task_stack(p);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "__get_wchan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "2082-2106",
    "snippet": "static unsigned long __get_wchan(struct task_struct *p)\n{\n\tunsigned long ip, sp;\n\tint count = 0;\n\n\tif (!p || p == current || p->state == TASK_RUNNING)\n\t\treturn 0;\n\n\tsp = p->thread.ksp;\n\tif (!validate_sp(sp, p, STACK_FRAME_OVERHEAD))\n\t\treturn 0;\n\n\tdo {\n\t\tsp = *(unsigned long *)sp;\n\t\tif (!validate_sp(sp, p, STACK_FRAME_OVERHEAD) ||\n\t\t    p->state == TASK_RUNNING)\n\t\t\treturn 0;\n\t\tif (count > 0) {\n\t\t\tip = ((unsigned long *)sp)[STACK_FRAME_LR_SAVE];\n\t\t\tif (!in_sched_functions(ip))\n\t\t\t\treturn ip;\n\t\t}\n\t} while (count++ < 16);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_sched_functions",
          "args": [
            "ip"
          ],
          "line": 2101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "validate_sp",
          "args": [
            "sp",
            "p",
            "STACK_FRAME_OVERHEAD"
          ],
          "line": 2096
        },
        "resolved": true,
        "details": {
          "function_name": "validate_sp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "2063-2078",
          "snippet": "int validate_sp(unsigned long sp, struct task_struct *p,\n\t\t       unsigned long nbytes)\n{\n\tunsigned long stack_page = (unsigned long)task_stack_page(p);\n\n\tif (sp < THREAD_SIZE)\n\t\treturn 0;\n\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tif (valid_irq_stack(sp, p, nbytes))\n\t\treturn 1;\n\n\treturn valid_emergency_stack(sp, p, nbytes);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint validate_sp(unsigned long sp, struct task_struct *p,\n\t\t       unsigned long nbytes)\n{\n\tunsigned long stack_page = (unsigned long)task_stack_page(p);\n\n\tif (sp < THREAD_SIZE)\n\t\treturn 0;\n\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tif (valid_irq_stack(sp, p, nbytes))\n\t\treturn 1;\n\n\treturn valid_emergency_stack(sp, p, nbytes);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic unsigned long __get_wchan(struct task_struct *p)\n{\n\tunsigned long ip, sp;\n\tint count = 0;\n\n\tif (!p || p == current || p->state == TASK_RUNNING)\n\t\treturn 0;\n\n\tsp = p->thread.ksp;\n\tif (!validate_sp(sp, p, STACK_FRAME_OVERHEAD))\n\t\treturn 0;\n\n\tdo {\n\t\tsp = *(unsigned long *)sp;\n\t\tif (!validate_sp(sp, p, STACK_FRAME_OVERHEAD) ||\n\t\t    p->state == TASK_RUNNING)\n\t\t\treturn 0;\n\t\tif (count > 0) {\n\t\t\tip = ((unsigned long *)sp)[STACK_FRAME_LR_SAVE];\n\t\t\tif (!in_sched_functions(ip))\n\t\t\t\treturn ip;\n\t\t}\n\t} while (count++ < 16);\n\treturn 0;\n}"
  },
  {
    "function_name": "validate_sp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "2063-2078",
    "snippet": "int validate_sp(unsigned long sp, struct task_struct *p,\n\t\t       unsigned long nbytes)\n{\n\tunsigned long stack_page = (unsigned long)task_stack_page(p);\n\n\tif (sp < THREAD_SIZE)\n\t\treturn 0;\n\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tif (valid_irq_stack(sp, p, nbytes))\n\t\treturn 1;\n\n\treturn valid_emergency_stack(sp, p, nbytes);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "valid_emergency_stack",
          "args": [
            "sp",
            "p",
            "nbytes"
          ],
          "line": 2077
        },
        "resolved": true,
        "details": {
          "function_name": "valid_emergency_stack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "2037-2060",
          "snippet": "static inline int valid_emergency_stack(unsigned long sp, struct task_struct *p,\n\t\t\t\t\tunsigned long nbytes)\n{\n#ifdef CONFIG_PPC64\n\tunsigned long stack_page;\n\tunsigned long cpu = task_cpu(p);\n\n\tstack_page = (unsigned long)paca_ptrs[cpu]->emergency_sp - THREAD_SIZE;\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n# ifdef CONFIG_PPC_BOOK3S_64\n\tstack_page = (unsigned long)paca_ptrs[cpu]->nmi_emergency_sp - THREAD_SIZE;\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tstack_page = (unsigned long)paca_ptrs[cpu]->mc_emergency_sp - THREAD_SIZE;\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n# endif\n#endif\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int valid_emergency_stack(unsigned long sp, struct task_struct *p,\n\t\t\t\t\tunsigned long nbytes)\n{\n#ifdef CONFIG_PPC64\n\tunsigned long stack_page;\n\tunsigned long cpu = task_cpu(p);\n\n\tstack_page = (unsigned long)paca_ptrs[cpu]->emergency_sp - THREAD_SIZE;\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n# ifdef CONFIG_PPC_BOOK3S_64\n\tstack_page = (unsigned long)paca_ptrs[cpu]->nmi_emergency_sp - THREAD_SIZE;\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tstack_page = (unsigned long)paca_ptrs[cpu]->mc_emergency_sp - THREAD_SIZE;\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n# endif\n#endif\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "valid_irq_stack",
          "args": [
            "sp",
            "p",
            "nbytes"
          ],
          "line": 2074
        },
        "resolved": true,
        "details": {
          "function_name": "valid_irq_stack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "2020-2035",
          "snippet": "static inline int valid_irq_stack(unsigned long sp, struct task_struct *p,\n\t\t\t\t  unsigned long nbytes)\n{\n\tunsigned long stack_page;\n\tunsigned long cpu = task_cpu(p);\n\n\tstack_page = (unsigned long)hardirq_ctx[cpu];\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tstack_page = (unsigned long)softirq_ctx[cpu];\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int valid_irq_stack(unsigned long sp, struct task_struct *p,\n\t\t\t\t  unsigned long nbytes)\n{\n\tunsigned long stack_page;\n\tunsigned long cpu = task_cpu(p);\n\n\tstack_page = (unsigned long)hardirq_ctx[cpu];\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tstack_page = (unsigned long)softirq_ctx[cpu];\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_stack_page",
          "args": [
            "p"
          ],
          "line": 2066
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint validate_sp(unsigned long sp, struct task_struct *p,\n\t\t       unsigned long nbytes)\n{\n\tunsigned long stack_page = (unsigned long)task_stack_page(p);\n\n\tif (sp < THREAD_SIZE)\n\t\treturn 0;\n\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tif (valid_irq_stack(sp, p, nbytes))\n\t\treturn 1;\n\n\treturn valid_emergency_stack(sp, p, nbytes);\n}"
  },
  {
    "function_name": "valid_emergency_stack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "2037-2060",
    "snippet": "static inline int valid_emergency_stack(unsigned long sp, struct task_struct *p,\n\t\t\t\t\tunsigned long nbytes)\n{\n#ifdef CONFIG_PPC64\n\tunsigned long stack_page;\n\tunsigned long cpu = task_cpu(p);\n\n\tstack_page = (unsigned long)paca_ptrs[cpu]->emergency_sp - THREAD_SIZE;\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n# ifdef CONFIG_PPC_BOOK3S_64\n\tstack_page = (unsigned long)paca_ptrs[cpu]->nmi_emergency_sp - THREAD_SIZE;\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tstack_page = (unsigned long)paca_ptrs[cpu]->mc_emergency_sp - THREAD_SIZE;\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n# endif\n#endif\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "task_cpu",
          "args": [
            "p"
          ],
          "line": 2042
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int valid_emergency_stack(unsigned long sp, struct task_struct *p,\n\t\t\t\t\tunsigned long nbytes)\n{\n#ifdef CONFIG_PPC64\n\tunsigned long stack_page;\n\tunsigned long cpu = task_cpu(p);\n\n\tstack_page = (unsigned long)paca_ptrs[cpu]->emergency_sp - THREAD_SIZE;\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n# ifdef CONFIG_PPC_BOOK3S_64\n\tstack_page = (unsigned long)paca_ptrs[cpu]->nmi_emergency_sp - THREAD_SIZE;\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tstack_page = (unsigned long)paca_ptrs[cpu]->mc_emergency_sp - THREAD_SIZE;\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n# endif\n#endif\n\n\treturn 0;\n}"
  },
  {
    "function_name": "valid_irq_stack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "2020-2035",
    "snippet": "static inline int valid_irq_stack(unsigned long sp, struct task_struct *p,\n\t\t\t\t  unsigned long nbytes)\n{\n\tunsigned long stack_page;\n\tunsigned long cpu = task_cpu(p);\n\n\tstack_page = (unsigned long)hardirq_ctx[cpu];\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tstack_page = (unsigned long)softirq_ctx[cpu];\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "task_cpu",
          "args": [
            "p"
          ],
          "line": 2024
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int valid_irq_stack(unsigned long sp, struct task_struct *p,\n\t\t\t\t  unsigned long nbytes)\n{\n\tunsigned long stack_page;\n\tunsigned long cpu = task_cpu(p);\n\n\tstack_page = (unsigned long)hardirq_ctx[cpu];\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\tstack_page = (unsigned long)softirq_ctx[cpu];\n\tif (sp >= stack_page && sp <= stack_page + THREAD_SIZE - nbytes)\n\t\treturn 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "get_unalign_ctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "2015-2018",
    "snippet": "int get_unalign_ctl(struct task_struct *tsk, unsigned long adr)\n{\n\treturn put_user(tsk->thread.align_ctl, (unsigned int __user *)adr);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "tsk->thread.align_ctl",
            "(unsigned int __user *)adr"
          ],
          "line": 2017
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint get_unalign_ctl(struct task_struct *tsk, unsigned long adr)\n{\n\treturn put_user(tsk->thread.align_ctl, (unsigned int __user *)adr);\n}"
  },
  {
    "function_name": "set_unalign_ctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "2009-2013",
    "snippet": "int set_unalign_ctl(struct task_struct *tsk, unsigned int val)\n{\n\ttsk->thread.align_ctl = val;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint set_unalign_ctl(struct task_struct *tsk, unsigned int val)\n{\n\ttsk->thread.align_ctl = val;\n\treturn 0;\n}"
  },
  {
    "function_name": "get_endian",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1986-2007",
    "snippet": "int get_endian(struct task_struct *tsk, unsigned long adr)\n{\n\tstruct pt_regs *regs = tsk->thread.regs;\n\tunsigned int val;\n\n\tif (!cpu_has_feature(CPU_FTR_PPC_LE) &&\n\t    !cpu_has_feature(CPU_FTR_REAL_LE))\n\t\treturn -EINVAL;\n\n\tif (regs == NULL)\n\t\treturn -EINVAL;\n\n\tif (regs->msr & MSR_LE) {\n\t\tif (cpu_has_feature(CPU_FTR_REAL_LE))\n\t\t\tval = PR_ENDIAN_LITTLE;\n\t\telse\n\t\t\tval = PR_ENDIAN_PPC_LITTLE;\n\t} else\n\t\tval = PR_ENDIAN_BIG;\n\n\treturn put_user(val, (unsigned int __user *)adr);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "val",
            "(unsigned int __user *)adr"
          ],
          "line": 2006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_REAL_LE"
          ],
          "line": 1999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_REAL_LE"
          ],
          "line": 1992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_PPC_LE"
          ],
          "line": 1991
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint get_endian(struct task_struct *tsk, unsigned long adr)\n{\n\tstruct pt_regs *regs = tsk->thread.regs;\n\tunsigned int val;\n\n\tif (!cpu_has_feature(CPU_FTR_PPC_LE) &&\n\t    !cpu_has_feature(CPU_FTR_REAL_LE))\n\t\treturn -EINVAL;\n\n\tif (regs == NULL)\n\t\treturn -EINVAL;\n\n\tif (regs->msr & MSR_LE) {\n\t\tif (cpu_has_feature(CPU_FTR_REAL_LE))\n\t\t\tval = PR_ENDIAN_LITTLE;\n\t\telse\n\t\t\tval = PR_ENDIAN_PPC_LITTLE;\n\t} else\n\t\tval = PR_ENDIAN_BIG;\n\n\treturn put_user(val, (unsigned int __user *)adr);\n}"
  },
  {
    "function_name": "set_endian",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1965-1984",
    "snippet": "int set_endian(struct task_struct *tsk, unsigned int val)\n{\n\tstruct pt_regs *regs = tsk->thread.regs;\n\n\tif ((val == PR_ENDIAN_LITTLE && !cpu_has_feature(CPU_FTR_REAL_LE)) ||\n\t    (val == PR_ENDIAN_PPC_LITTLE && !cpu_has_feature(CPU_FTR_PPC_LE)))\n\t\treturn -EINVAL;\n\n\tif (regs == NULL)\n\t\treturn -EINVAL;\n\n\tif (val == PR_ENDIAN_BIG)\n\t\tregs->msr &= ~MSR_LE;\n\telse if (val == PR_ENDIAN_LITTLE || val == PR_ENDIAN_PPC_LITTLE)\n\t\tregs->msr |= MSR_LE;\n\telse\n\t\treturn -EINVAL;\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_PPC_LE"
          ],
          "line": 1970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_REAL_LE"
          ],
          "line": 1969
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint set_endian(struct task_struct *tsk, unsigned int val)\n{\n\tstruct pt_regs *regs = tsk->thread.regs;\n\n\tif ((val == PR_ENDIAN_LITTLE && !cpu_has_feature(CPU_FTR_REAL_LE)) ||\n\t    (val == PR_ENDIAN_PPC_LITTLE && !cpu_has_feature(CPU_FTR_PPC_LE)))\n\t\treturn -EINVAL;\n\n\tif (regs == NULL)\n\t\treturn -EINVAL;\n\n\tif (val == PR_ENDIAN_BIG)\n\t\tregs->msr &= ~MSR_LE;\n\telse if (val == PR_ENDIAN_LITTLE || val == PR_ENDIAN_PPC_LITTLE)\n\t\tregs->msr |= MSR_LE;\n\telse\n\t\treturn -EINVAL;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "get_fpexc_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1935-1963",
    "snippet": "int get_fpexc_mode(struct task_struct *tsk, unsigned long adr)\n{\n\tunsigned int val = 0;\n\n\tif (tsk->thread.fpexc_mode & PR_FP_EXC_SW_ENABLE) {\n\t\tif (cpu_has_feature(CPU_FTR_SPE)) {\n\t\t\t/*\n\t\t\t * When the sticky exception bits are set\n\t\t\t * directly by userspace, it must call prctl\n\t\t\t * with PR_GET_FPEXC (with PR_FP_EXC_SW_ENABLE\n\t\t\t * in the existing prctl settings) or\n\t\t\t * PR_SET_FPEXC (with PR_FP_EXC_SW_ENABLE in\n\t\t\t * the bits being set).  <fenv.h> functions\n\t\t\t * saving and restoring the whole\n\t\t\t * floating-point environment need to do so\n\t\t\t * anyway to restore the prctl settings from\n\t\t\t * the saved environment.\n\t\t\t */\n#ifdef CONFIG_SPE\n\t\t\ttsk->thread.spefscr_last = mfspr(SPRN_SPEFSCR);\n\t\t\tval = tsk->thread.fpexc_mode;\n#endif\n\t\t} else\n\t\t\treturn -EINVAL;\n\t} else {\n\t\tval = __unpack_fe01(tsk->thread.fpexc_mode);\n\t}\n\treturn put_user(val, (unsigned int __user *) adr);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "val",
            "(unsigned int __user *) adr"
          ],
          "line": 1962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__unpack_fe01",
          "args": [
            "tsk->thread.fpexc_mode"
          ],
          "line": 1960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_SPEFSCR"
          ],
          "line": 1954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SPE"
          ],
          "line": 1940
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint get_fpexc_mode(struct task_struct *tsk, unsigned long adr)\n{\n\tunsigned int val = 0;\n\n\tif (tsk->thread.fpexc_mode & PR_FP_EXC_SW_ENABLE) {\n\t\tif (cpu_has_feature(CPU_FTR_SPE)) {\n\t\t\t/*\n\t\t\t * When the sticky exception bits are set\n\t\t\t * directly by userspace, it must call prctl\n\t\t\t * with PR_GET_FPEXC (with PR_FP_EXC_SW_ENABLE\n\t\t\t * in the existing prctl settings) or\n\t\t\t * PR_SET_FPEXC (with PR_FP_EXC_SW_ENABLE in\n\t\t\t * the bits being set).  <fenv.h> functions\n\t\t\t * saving and restoring the whole\n\t\t\t * floating-point environment need to do so\n\t\t\t * anyway to restore the prctl settings from\n\t\t\t * the saved environment.\n\t\t\t */\n#ifdef CONFIG_SPE\n\t\t\ttsk->thread.spefscr_last = mfspr(SPRN_SPEFSCR);\n\t\t\tval = tsk->thread.fpexc_mode;\n#endif\n\t\t} else\n\t\t\treturn -EINVAL;\n\t} else {\n\t\tval = __unpack_fe01(tsk->thread.fpexc_mode);\n\t}\n\treturn put_user(val, (unsigned int __user *) adr);\n}"
  },
  {
    "function_name": "set_fpexc_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1888-1933",
    "snippet": "int set_fpexc_mode(struct task_struct *tsk, unsigned int val)\n{\n\tstruct pt_regs *regs = tsk->thread.regs;\n\n\t/* This is a bit hairy.  If we are an SPE enabled  processor\n\t * (have embedded fp) we store the IEEE exception enable flags in\n\t * fpexc_mode.  fpexc_mode is also used for setting FP exception\n\t * mode (asyn, precise, disabled) for 'Classic' FP. */\n\tif (val & PR_FP_EXC_SW_ENABLE) {\n\t\tif (cpu_has_feature(CPU_FTR_SPE)) {\n\t\t\t/*\n\t\t\t * When the sticky exception bits are set\n\t\t\t * directly by userspace, it must call prctl\n\t\t\t * with PR_GET_FPEXC (with PR_FP_EXC_SW_ENABLE\n\t\t\t * in the existing prctl settings) or\n\t\t\t * PR_SET_FPEXC (with PR_FP_EXC_SW_ENABLE in\n\t\t\t * the bits being set).  <fenv.h> functions\n\t\t\t * saving and restoring the whole\n\t\t\t * floating-point environment need to do so\n\t\t\t * anyway to restore the prctl settings from\n\t\t\t * the saved environment.\n\t\t\t */\n#ifdef CONFIG_SPE\n\t\t\ttsk->thread.spefscr_last = mfspr(SPRN_SPEFSCR);\n\t\t\ttsk->thread.fpexc_mode = val &\n\t\t\t\t(PR_FP_EXC_SW_ENABLE | PR_FP_ALL_EXCEPT);\n#endif\n\t\t\treturn 0;\n\t\t} else {\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\t/* on a CONFIG_SPE this does not hurt us.  The bits that\n\t * __pack_fe01 use do not overlap with bits used for\n\t * PR_FP_EXC_SW_ENABLE.  Additionally, the MSR[FE0,FE1] bits\n\t * on CONFIG_SPE implementations are reserved so writing to\n\t * them does not change anything */\n\tif (val > PR_FP_EXC_PRECISE)\n\t\treturn -EINVAL;\n\ttsk->thread.fpexc_mode = __pack_fe01(val);\n\tif (regs != NULL && (regs->msr & MSR_FP) != 0)\n\t\tregs->msr = (regs->msr & ~(MSR_FE0|MSR_FE1))\n\t\t\t| tsk->thread.fpexc_mode;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define PR_FP_ALL_EXCEPT (PR_FP_EXC_DIV | PR_FP_EXC_OVF | PR_FP_EXC_UND \\\n\t\t| PR_FP_EXC_RES | PR_FP_EXC_INV)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__pack_fe01",
          "args": [
            "val"
          ],
          "line": 1928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_SPEFSCR"
          ],
          "line": 1911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SPE"
          ],
          "line": 1897
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define PR_FP_ALL_EXCEPT (PR_FP_EXC_DIV | PR_FP_EXC_OVF | PR_FP_EXC_UND \\\n\t\t| PR_FP_EXC_RES | PR_FP_EXC_INV)\n\nint set_fpexc_mode(struct task_struct *tsk, unsigned int val)\n{\n\tstruct pt_regs *regs = tsk->thread.regs;\n\n\t/* This is a bit hairy.  If we are an SPE enabled  processor\n\t * (have embedded fp) we store the IEEE exception enable flags in\n\t * fpexc_mode.  fpexc_mode is also used for setting FP exception\n\t * mode (asyn, precise, disabled) for 'Classic' FP. */\n\tif (val & PR_FP_EXC_SW_ENABLE) {\n\t\tif (cpu_has_feature(CPU_FTR_SPE)) {\n\t\t\t/*\n\t\t\t * When the sticky exception bits are set\n\t\t\t * directly by userspace, it must call prctl\n\t\t\t * with PR_GET_FPEXC (with PR_FP_EXC_SW_ENABLE\n\t\t\t * in the existing prctl settings) or\n\t\t\t * PR_SET_FPEXC (with PR_FP_EXC_SW_ENABLE in\n\t\t\t * the bits being set).  <fenv.h> functions\n\t\t\t * saving and restoring the whole\n\t\t\t * floating-point environment need to do so\n\t\t\t * anyway to restore the prctl settings from\n\t\t\t * the saved environment.\n\t\t\t */\n#ifdef CONFIG_SPE\n\t\t\ttsk->thread.spefscr_last = mfspr(SPRN_SPEFSCR);\n\t\t\ttsk->thread.fpexc_mode = val &\n\t\t\t\t(PR_FP_EXC_SW_ENABLE | PR_FP_ALL_EXCEPT);\n#endif\n\t\t\treturn 0;\n\t\t} else {\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\t/* on a CONFIG_SPE this does not hurt us.  The bits that\n\t * __pack_fe01 use do not overlap with bits used for\n\t * PR_FP_EXC_SW_ENABLE.  Additionally, the MSR[FE0,FE1] bits\n\t * on CONFIG_SPE implementations are reserved so writing to\n\t * them does not change anything */\n\tif (val > PR_FP_EXC_PRECISE)\n\t\treturn -EINVAL;\n\ttsk->thread.fpexc_mode = __pack_fe01(val);\n\tif (regs != NULL && (regs->msr & MSR_FP) != 0)\n\t\tregs->msr = (regs->msr & ~(MSR_FE0|MSR_FE1))\n\t\t\t| tsk->thread.fpexc_mode;\n\treturn 0;\n}"
  },
  {
    "function_name": "start_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1759-1882",
    "snippet": "void start_thread(struct pt_regs *regs, unsigned long start, unsigned long sp)\n{\n#ifdef CONFIG_PPC64\n\tunsigned long load_addr = regs->gpr[2];\t/* saved by ELF_PLAT_INIT */\n\n\tif (IS_ENABLED(CONFIG_PPC_BOOK3S_64) && !radix_enabled())\n\t\tpreload_new_slb_context(start, sp);\n#endif\n\n\t/*\n\t * If we exec out of a kernel thread then thread.regs will not be\n\t * set.  Do it now.\n\t */\n\tif (!current->thread.regs) {\n\t\tstruct pt_regs *regs = task_stack_page(current) + THREAD_SIZE;\n\t\tcurrent->thread.regs = regs - 1;\n\t}\n\n#ifdef CONFIG_PPC_TRANSACTIONAL_MEM\n\t/*\n\t * Clear any transactional state, we're exec()ing. The cause is\n\t * not important as there will never be a recheckpoint so it's not\n\t * user visible.\n\t */\n\tif (MSR_TM_SUSPENDED(mfmsr()))\n\t\ttm_reclaim_current(0);\n#endif\n\n\tmemset(regs->gpr, 0, sizeof(regs->gpr));\n\tregs->ctr = 0;\n\tregs->link = 0;\n\tregs->xer = 0;\n\tregs->ccr = 0;\n\tregs->gpr[1] = sp;\n\n\t/*\n\t * We have just cleared all the nonvolatile GPRs, so make\n\t * FULL_REGS(regs) return true.  This is necessary to allow\n\t * ptrace to examine the thread immediately after exec.\n\t */\n\tSET_FULL_REGS(regs);\n\n#ifdef CONFIG_PPC32\n\tregs->mq = 0;\n\tregs->nip = start;\n\tregs->msr = MSR_USER;\n#else\n\tif (!is_32bit_task()) {\n\t\tunsigned long entry;\n\n\t\tif (is_elf2_task()) {\n\t\t\t/* Look ma, no function descriptors! */\n\t\t\tentry = start;\n\n\t\t\t/*\n\t\t\t * Ulrich says:\n\t\t\t *   The latest iteration of the ABI requires that when\n\t\t\t *   calling a function (at its global entry point),\n\t\t\t *   the caller must ensure r12 holds the entry point\n\t\t\t *   address (so that the function can quickly\n\t\t\t *   establish addressability).\n\t\t\t */\n\t\t\tregs->gpr[12] = start;\n\t\t\t/* Make sure that's restored on entry to userspace. */\n\t\t\tset_thread_flag(TIF_RESTOREALL);\n\t\t} else {\n\t\t\tunsigned long toc;\n\n\t\t\t/* start is a relocated pointer to the function\n\t\t\t * descriptor for the elf _start routine.  The first\n\t\t\t * entry in the function descriptor is the entry\n\t\t\t * address of _start and the second entry is the TOC\n\t\t\t * value we need to use.\n\t\t\t */\n\t\t\t__get_user(entry, (unsigned long __user *)start);\n\t\t\t__get_user(toc, (unsigned long __user *)start+1);\n\n\t\t\t/* Check whether the e_entry function descriptor entries\n\t\t\t * need to be relocated before we can use them.\n\t\t\t */\n\t\t\tif (load_addr != 0) {\n\t\t\t\tentry += load_addr;\n\t\t\t\ttoc   += load_addr;\n\t\t\t}\n\t\t\tregs->gpr[2] = toc;\n\t\t}\n\t\tregs->nip = entry;\n\t\tregs->msr = MSR_USER64;\n\t} else {\n\t\tregs->nip = start;\n\t\tregs->gpr[2] = 0;\n\t\tregs->msr = MSR_USER32;\n\t}\n#endif\n#ifdef CONFIG_VSX\n\tcurrent->thread.used_vsr = 0;\n#endif\n\tcurrent->thread.load_slb = 0;\n\tcurrent->thread.load_fp = 0;\n\tmemset(&current->thread.fp_state, 0, sizeof(current->thread.fp_state));\n\tcurrent->thread.fp_save_area = NULL;\n#ifdef CONFIG_ALTIVEC\n\tmemset(&current->thread.vr_state, 0, sizeof(current->thread.vr_state));\n\tcurrent->thread.vr_state.vscr.u[3] = 0x00010000; /* Java mode disabled */\n\tcurrent->thread.vr_save_area = NULL;\n\tcurrent->thread.vrsave = 0;\n\tcurrent->thread.used_vr = 0;\n\tcurrent->thread.load_vec = 0;\n#endif /* CONFIG_ALTIVEC */\n#ifdef CONFIG_SPE\n\tmemset(current->thread.evr, 0, sizeof(current->thread.evr));\n\tcurrent->thread.acc = 0;\n\tcurrent->thread.spefscr = 0;\n\tcurrent->thread.used_spe = 0;\n#endif /* CONFIG_SPE */\n#ifdef CONFIG_PPC_TRANSACTIONAL_MEM\n\tcurrent->thread.tm_tfhar = 0;\n\tcurrent->thread.tm_texasr = 0;\n\tcurrent->thread.tm_tfiar = 0;\n\tcurrent->thread.load_tm = 0;\n#endif /* CONFIG_PPC_TRANSACTIONAL_MEM */\n\n\tthread_pkey_regs_init(&current->thread);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "thread_pkey_regs_init",
          "args": [
            "&current->thread"
          ],
          "line": 1881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "current->thread.evr",
            "0",
            "sizeof(current->thread.evr)"
          ],
          "line": 1869
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "122-147",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "toc",
            "(unsigned long __user *)start+1"
          ],
          "line": 1834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "entry",
            "(unsigned long __user *)start"
          ],
          "line": 1833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_thread_flag",
          "args": [
            "TIF_RESTOREALL"
          ],
          "line": 1823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_elf2_task",
          "args": [],
          "line": 1809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_32bit_task",
          "args": [],
          "line": 1806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_FULL_REGS",
          "args": [
            "regs"
          ],
          "line": 1799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tm_reclaim_current",
          "args": [
            "0"
          ],
          "line": 1784
        },
        "resolved": true,
        "details": {
          "function_name": "tm_reclaim_current",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "959-963",
          "snippet": "void tm_reclaim_current(uint8_t cause)\n{\n\ttm_enable();\n\ttm_reclaim_thread(&current->thread, cause);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid tm_reclaim_current(uint8_t cause)\n{\n\ttm_enable();\n\ttm_reclaim_thread(&current->thread, cause);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MSR_TM_SUSPENDED",
          "args": [
            "mfmsr()"
          ],
          "line": 1783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfmsr",
          "args": [],
          "line": 1783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_stack_page",
          "args": [
            "current"
          ],
          "line": 1773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preload_new_slb_context",
          "args": [
            "start",
            "sp"
          ],
          "line": 1765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "radix_enabled",
          "args": [],
          "line": 1764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC_BOOK3S_64"
          ],
          "line": 1764
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid start_thread(struct pt_regs *regs, unsigned long start, unsigned long sp)\n{\n#ifdef CONFIG_PPC64\n\tunsigned long load_addr = regs->gpr[2];\t/* saved by ELF_PLAT_INIT */\n\n\tif (IS_ENABLED(CONFIG_PPC_BOOK3S_64) && !radix_enabled())\n\t\tpreload_new_slb_context(start, sp);\n#endif\n\n\t/*\n\t * If we exec out of a kernel thread then thread.regs will not be\n\t * set.  Do it now.\n\t */\n\tif (!current->thread.regs) {\n\t\tstruct pt_regs *regs = task_stack_page(current) + THREAD_SIZE;\n\t\tcurrent->thread.regs = regs - 1;\n\t}\n\n#ifdef CONFIG_PPC_TRANSACTIONAL_MEM\n\t/*\n\t * Clear any transactional state, we're exec()ing. The cause is\n\t * not important as there will never be a recheckpoint so it's not\n\t * user visible.\n\t */\n\tif (MSR_TM_SUSPENDED(mfmsr()))\n\t\ttm_reclaim_current(0);\n#endif\n\n\tmemset(regs->gpr, 0, sizeof(regs->gpr));\n\tregs->ctr = 0;\n\tregs->link = 0;\n\tregs->xer = 0;\n\tregs->ccr = 0;\n\tregs->gpr[1] = sp;\n\n\t/*\n\t * We have just cleared all the nonvolatile GPRs, so make\n\t * FULL_REGS(regs) return true.  This is necessary to allow\n\t * ptrace to examine the thread immediately after exec.\n\t */\n\tSET_FULL_REGS(regs);\n\n#ifdef CONFIG_PPC32\n\tregs->mq = 0;\n\tregs->nip = start;\n\tregs->msr = MSR_USER;\n#else\n\tif (!is_32bit_task()) {\n\t\tunsigned long entry;\n\n\t\tif (is_elf2_task()) {\n\t\t\t/* Look ma, no function descriptors! */\n\t\t\tentry = start;\n\n\t\t\t/*\n\t\t\t * Ulrich says:\n\t\t\t *   The latest iteration of the ABI requires that when\n\t\t\t *   calling a function (at its global entry point),\n\t\t\t *   the caller must ensure r12 holds the entry point\n\t\t\t *   address (so that the function can quickly\n\t\t\t *   establish addressability).\n\t\t\t */\n\t\t\tregs->gpr[12] = start;\n\t\t\t/* Make sure that's restored on entry to userspace. */\n\t\t\tset_thread_flag(TIF_RESTOREALL);\n\t\t} else {\n\t\t\tunsigned long toc;\n\n\t\t\t/* start is a relocated pointer to the function\n\t\t\t * descriptor for the elf _start routine.  The first\n\t\t\t * entry in the function descriptor is the entry\n\t\t\t * address of _start and the second entry is the TOC\n\t\t\t * value we need to use.\n\t\t\t */\n\t\t\t__get_user(entry, (unsigned long __user *)start);\n\t\t\t__get_user(toc, (unsigned long __user *)start+1);\n\n\t\t\t/* Check whether the e_entry function descriptor entries\n\t\t\t * need to be relocated before we can use them.\n\t\t\t */\n\t\t\tif (load_addr != 0) {\n\t\t\t\tentry += load_addr;\n\t\t\t\ttoc   += load_addr;\n\t\t\t}\n\t\t\tregs->gpr[2] = toc;\n\t\t}\n\t\tregs->nip = entry;\n\t\tregs->msr = MSR_USER64;\n\t} else {\n\t\tregs->nip = start;\n\t\tregs->gpr[2] = 0;\n\t\tregs->msr = MSR_USER32;\n\t}\n#endif\n#ifdef CONFIG_VSX\n\tcurrent->thread.used_vsr = 0;\n#endif\n\tcurrent->thread.load_slb = 0;\n\tcurrent->thread.load_fp = 0;\n\tmemset(&current->thread.fp_state, 0, sizeof(current->thread.fp_state));\n\tcurrent->thread.fp_save_area = NULL;\n#ifdef CONFIG_ALTIVEC\n\tmemset(&current->thread.vr_state, 0, sizeof(current->thread.vr_state));\n\tcurrent->thread.vr_state.vscr.u[3] = 0x00010000; /* Java mode disabled */\n\tcurrent->thread.vr_save_area = NULL;\n\tcurrent->thread.vrsave = 0;\n\tcurrent->thread.used_vr = 0;\n\tcurrent->thread.load_vec = 0;\n#endif /* CONFIG_ALTIVEC */\n#ifdef CONFIG_SPE\n\tmemset(current->thread.evr, 0, sizeof(current->thread.evr));\n\tcurrent->thread.acc = 0;\n\tcurrent->thread.spefscr = 0;\n\tcurrent->thread.used_spe = 0;\n#endif /* CONFIG_SPE */\n#ifdef CONFIG_PPC_TRANSACTIONAL_MEM\n\tcurrent->thread.tm_tfhar = 0;\n\tcurrent->thread.tm_texasr = 0;\n\tcurrent->thread.tm_tfiar = 0;\n\tcurrent->thread.load_tm = 0;\n#endif /* CONFIG_PPC_TRANSACTIONAL_MEM */\n\n\tthread_pkey_regs_init(&current->thread);\n}"
  },
  {
    "function_name": "copy_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1651-1752",
    "snippet": "int copy_thread(unsigned long clone_flags, unsigned long usp,\n\t\tunsigned long kthread_arg, struct task_struct *p,\n\t\tunsigned long tls)\n{\n\tstruct pt_regs *childregs, *kregs;\n\textern void ret_from_fork(void);\n\textern void ret_from_fork_scv(void);\n\textern void ret_from_kernel_thread(void);\n\tvoid (*f)(void);\n\tunsigned long sp = (unsigned long)task_stack_page(p) + THREAD_SIZE;\n\tstruct thread_info *ti = task_thread_info(p);\n#ifdef CONFIG_HAVE_HW_BREAKPOINT\n\tint i;\n#endif\n\n\tklp_init_thread_info(p);\n\n\t/* Copy registers */\n\tsp -= sizeof(struct pt_regs);\n\tchildregs = (struct pt_regs *) sp;\n\tif (unlikely(p->flags & PF_KTHREAD)) {\n\t\t/* kernel thread */\n\t\tmemset(childregs, 0, sizeof(struct pt_regs));\n\t\tchildregs->gpr[1] = sp + sizeof(struct pt_regs);\n\t\t/* function */\n\t\tif (usp)\n\t\t\tchildregs->gpr[14] = ppc_function_entry((void *)usp);\n#ifdef CONFIG_PPC64\n\t\tclear_tsk_thread_flag(p, TIF_32BIT);\n\t\tchildregs->softe = IRQS_ENABLED;\n#endif\n\t\tchildregs->gpr[15] = kthread_arg;\n\t\tp->thread.regs = NULL;\t/* no user register state */\n\t\tti->flags |= _TIF_RESTOREALL;\n\t\tf = ret_from_kernel_thread;\n\t} else {\n\t\t/* user thread */\n\t\tstruct pt_regs *regs = current_pt_regs();\n\t\tCHECK_FULL_REGS(regs);\n\t\t*childregs = *regs;\n\t\tif (usp)\n\t\t\tchildregs->gpr[1] = usp;\n\t\tp->thread.regs = childregs;\n\t\t/* 64s sets this in ret_from_fork */\n\t\tif (!IS_ENABLED(CONFIG_PPC_BOOK3S_64))\n\t\t\tchildregs->gpr[3] = 0;  /* Result from fork() */\n\t\tif (clone_flags & CLONE_SETTLS) {\n\t\t\tif (!is_32bit_task())\n\t\t\t\tchildregs->gpr[13] = tls;\n\t\t\telse\n\t\t\t\tchildregs->gpr[2] = tls;\n\t\t}\n\n\t\tif (trap_is_scv(regs))\n\t\t\tf = ret_from_fork_scv;\n\t\telse\n\t\t\tf = ret_from_fork;\n\t}\n\tchildregs->msr &= ~(MSR_FP|MSR_VEC|MSR_VSX);\n\tsp -= STACK_FRAME_OVERHEAD;\n\n\t/*\n\t * The way this works is that at some point in the future\n\t * some task will call _switch to switch to the new task.\n\t * That will pop off the stack frame created below and start\n\t * the new task running at ret_from_fork.  The new task will\n\t * do some house keeping and then return from the fork or clone\n\t * system call, using the stack frame created above.\n\t */\n\t((unsigned long *)sp)[0] = 0;\n\tsp -= sizeof(struct pt_regs);\n\tkregs = (struct pt_regs *) sp;\n\tsp -= STACK_FRAME_OVERHEAD;\n\tp->thread.ksp = sp;\n#ifdef CONFIG_PPC32\n\tp->thread.ksp_limit = (unsigned long)end_of_stack(p);\n#endif\n#ifdef CONFIG_HAVE_HW_BREAKPOINT\n\tfor (i = 0; i < nr_wp_slots(); i++)\n\t\tp->thread.ptrace_bps[i] = NULL;\n#endif\n\n\tp->thread.fp_save_area = NULL;\n#ifdef CONFIG_ALTIVEC\n\tp->thread.vr_save_area = NULL;\n#endif\n\n\tsetup_ksp_vsid(p, sp);\n\n#ifdef CONFIG_PPC64 \n\tif (cpu_has_feature(CPU_FTR_DSCR)) {\n\t\tp->thread.dscr_inherit = current->thread.dscr_inherit;\n\t\tp->thread.dscr = mfspr(SPRN_DSCR);\n\t}\n\tif (cpu_has_feature(CPU_FTR_HAS_PPR))\n\t\tchildregs->ppr = DEFAULT_PPR;\n\n\tp->thread.tidr = 0;\n#endif\n\tkregs->nip = ppc_function_entry(f);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_function_entry",
          "args": [
            "f"
          ],
          "line": 1750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_HAS_PPR"
          ],
          "line": 1745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_DSCR"
          ],
          "line": 1743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_DSCR"
          ],
          "line": 1741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup_ksp_vsid",
          "args": [
            "p",
            "sp"
          ],
          "line": 1738
        },
        "resolved": true,
        "details": {
          "function_name": "setup_ksp_vsid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "1624-1642",
          "snippet": "static void setup_ksp_vsid(struct task_struct *p, unsigned long sp)\n{\n#ifdef CONFIG_PPC_BOOK3S_64\n\tunsigned long sp_vsid;\n\tunsigned long llp = mmu_psize_defs[mmu_linear_psize].sllp;\n\n\tif (radix_enabled())\n\t\treturn;\n\n\tif (mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\tsp_vsid = get_kernel_vsid(sp, MMU_SEGSIZE_1T)\n\t\t\t<< SLB_VSID_SHIFT_1T;\n\telse\n\t\tsp_vsid = get_kernel_vsid(sp, MMU_SEGSIZE_256M)\n\t\t\t<< SLB_VSID_SHIFT;\n\tsp_vsid |= SLB_VSID_KERNEL | llp;\n\tp->thread.ksp_vsid = sp_vsid;\n#endif\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void setup_ksp_vsid(struct task_struct *p, unsigned long sp)\n{\n#ifdef CONFIG_PPC_BOOK3S_64\n\tunsigned long sp_vsid;\n\tunsigned long llp = mmu_psize_defs[mmu_linear_psize].sllp;\n\n\tif (radix_enabled())\n\t\treturn;\n\n\tif (mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\tsp_vsid = get_kernel_vsid(sp, MMU_SEGSIZE_1T)\n\t\t\t<< SLB_VSID_SHIFT_1T;\n\telse\n\t\tsp_vsid = get_kernel_vsid(sp, MMU_SEGSIZE_256M)\n\t\t\t<< SLB_VSID_SHIFT;\n\tsp_vsid |= SLB_VSID_KERNEL | llp;\n\tp->thread.ksp_vsid = sp_vsid;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "nr_wp_slots",
          "args": [],
          "line": 1729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "end_of_stack",
          "args": [
            "p"
          ],
          "line": 1726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trap_is_scv",
          "args": [
            "regs"
          ],
          "line": 1704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_32bit_task",
          "args": [],
          "line": 1698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC_BOOK3S_64"
          ],
          "line": 1695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FULL_REGS",
          "args": [
            "regs"
          ],
          "line": 1689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_pt_regs",
          "args": [],
          "line": 1688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_tsk_thread_flag",
          "args": [
            "p",
            "TIF_32BIT"
          ],
          "line": 1679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_function_entry",
          "args": [
            "(void *)usp"
          ],
          "line": 1677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "childregs",
            "0",
            "sizeof(struct pt_regs)"
          ],
          "line": 1673
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "122-147",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p->flags & PF_KTHREAD"
          ],
          "line": 1671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "klp_init_thread_info",
          "args": [
            "p"
          ],
          "line": 1666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_thread_info",
          "args": [
            "p"
          ],
          "line": 1661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_stack_page",
          "args": [
            "p"
          ],
          "line": 1660
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint copy_thread(unsigned long clone_flags, unsigned long usp,\n\t\tunsigned long kthread_arg, struct task_struct *p,\n\t\tunsigned long tls)\n{\n\tstruct pt_regs *childregs, *kregs;\n\textern void ret_from_fork(void);\n\textern void ret_from_fork_scv(void);\n\textern void ret_from_kernel_thread(void);\n\tvoid (*f)(void);\n\tunsigned long sp = (unsigned long)task_stack_page(p) + THREAD_SIZE;\n\tstruct thread_info *ti = task_thread_info(p);\n#ifdef CONFIG_HAVE_HW_BREAKPOINT\n\tint i;\n#endif\n\n\tklp_init_thread_info(p);\n\n\t/* Copy registers */\n\tsp -= sizeof(struct pt_regs);\n\tchildregs = (struct pt_regs *) sp;\n\tif (unlikely(p->flags & PF_KTHREAD)) {\n\t\t/* kernel thread */\n\t\tmemset(childregs, 0, sizeof(struct pt_regs));\n\t\tchildregs->gpr[1] = sp + sizeof(struct pt_regs);\n\t\t/* function */\n\t\tif (usp)\n\t\t\tchildregs->gpr[14] = ppc_function_entry((void *)usp);\n#ifdef CONFIG_PPC64\n\t\tclear_tsk_thread_flag(p, TIF_32BIT);\n\t\tchildregs->softe = IRQS_ENABLED;\n#endif\n\t\tchildregs->gpr[15] = kthread_arg;\n\t\tp->thread.regs = NULL;\t/* no user register state */\n\t\tti->flags |= _TIF_RESTOREALL;\n\t\tf = ret_from_kernel_thread;\n\t} else {\n\t\t/* user thread */\n\t\tstruct pt_regs *regs = current_pt_regs();\n\t\tCHECK_FULL_REGS(regs);\n\t\t*childregs = *regs;\n\t\tif (usp)\n\t\t\tchildregs->gpr[1] = usp;\n\t\tp->thread.regs = childregs;\n\t\t/* 64s sets this in ret_from_fork */\n\t\tif (!IS_ENABLED(CONFIG_PPC_BOOK3S_64))\n\t\t\tchildregs->gpr[3] = 0;  /* Result from fork() */\n\t\tif (clone_flags & CLONE_SETTLS) {\n\t\t\tif (!is_32bit_task())\n\t\t\t\tchildregs->gpr[13] = tls;\n\t\t\telse\n\t\t\t\tchildregs->gpr[2] = tls;\n\t\t}\n\n\t\tif (trap_is_scv(regs))\n\t\t\tf = ret_from_fork_scv;\n\t\telse\n\t\t\tf = ret_from_fork;\n\t}\n\tchildregs->msr &= ~(MSR_FP|MSR_VEC|MSR_VSX);\n\tsp -= STACK_FRAME_OVERHEAD;\n\n\t/*\n\t * The way this works is that at some point in the future\n\t * some task will call _switch to switch to the new task.\n\t * That will pop off the stack frame created below and start\n\t * the new task running at ret_from_fork.  The new task will\n\t * do some house keeping and then return from the fork or clone\n\t * system call, using the stack frame created above.\n\t */\n\t((unsigned long *)sp)[0] = 0;\n\tsp -= sizeof(struct pt_regs);\n\tkregs = (struct pt_regs *) sp;\n\tsp -= STACK_FRAME_OVERHEAD;\n\tp->thread.ksp = sp;\n#ifdef CONFIG_PPC32\n\tp->thread.ksp_limit = (unsigned long)end_of_stack(p);\n#endif\n#ifdef CONFIG_HAVE_HW_BREAKPOINT\n\tfor (i = 0; i < nr_wp_slots(); i++)\n\t\tp->thread.ptrace_bps[i] = NULL;\n#endif\n\n\tp->thread.fp_save_area = NULL;\n#ifdef CONFIG_ALTIVEC\n\tp->thread.vr_save_area = NULL;\n#endif\n\n\tsetup_ksp_vsid(p, sp);\n\n#ifdef CONFIG_PPC64 \n\tif (cpu_has_feature(CPU_FTR_DSCR)) {\n\t\tp->thread.dscr_inherit = current->thread.dscr_inherit;\n\t\tp->thread.dscr = mfspr(SPRN_DSCR);\n\t}\n\tif (cpu_has_feature(CPU_FTR_HAS_PPR))\n\t\tchildregs->ppr = DEFAULT_PPR;\n\n\tp->thread.tidr = 0;\n#endif\n\tkregs->nip = ppc_function_entry(f);\n\treturn 0;\n}"
  },
  {
    "function_name": "setup_ksp_vsid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1624-1642",
    "snippet": "static void setup_ksp_vsid(struct task_struct *p, unsigned long sp)\n{\n#ifdef CONFIG_PPC_BOOK3S_64\n\tunsigned long sp_vsid;\n\tunsigned long llp = mmu_psize_defs[mmu_linear_psize].sllp;\n\n\tif (radix_enabled())\n\t\treturn;\n\n\tif (mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\tsp_vsid = get_kernel_vsid(sp, MMU_SEGSIZE_1T)\n\t\t\t<< SLB_VSID_SHIFT_1T;\n\telse\n\t\tsp_vsid = get_kernel_vsid(sp, MMU_SEGSIZE_256M)\n\t\t\t<< SLB_VSID_SHIFT;\n\tsp_vsid |= SLB_VSID_KERNEL | llp;\n\tp->thread.ksp_vsid = sp_vsid;\n#endif\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_kernel_vsid",
          "args": [
            "sp",
            "MMU_SEGSIZE_256M"
          ],
          "line": 1637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_kernel_vsid",
          "args": [
            "sp",
            "MMU_SEGSIZE_1T"
          ],
          "line": 1634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mmu_has_feature",
          "args": [
            "MMU_FTR_1T_SEGMENT"
          ],
          "line": 1633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "radix_enabled",
          "args": [],
          "line": 1630
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void setup_ksp_vsid(struct task_struct *p, unsigned long sp)\n{\n#ifdef CONFIG_PPC_BOOK3S_64\n\tunsigned long sp_vsid;\n\tunsigned long llp = mmu_psize_defs[mmu_linear_psize].sllp;\n\n\tif (radix_enabled())\n\t\treturn;\n\n\tif (mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\tsp_vsid = get_kernel_vsid(sp, MMU_SEGSIZE_1T)\n\t\t\t<< SLB_VSID_SHIFT_1T;\n\telse\n\t\tsp_vsid = get_kernel_vsid(sp, MMU_SEGSIZE_256M)\n\t\t\t<< SLB_VSID_SHIFT;\n\tsp_vsid |= SLB_VSID_KERNEL | llp;\n\tp->thread.ksp_vsid = sp_vsid;\n#endif\n}"
  },
  {
    "function_name": "arch_dup_task_struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1602-1622",
    "snippet": "int arch_dup_task_struct(struct task_struct *dst, struct task_struct *src)\n{\n\tflush_all_to_thread(src);\n\t/*\n\t * Flush TM state out so we can copy it.  __switch_to_tm() does this\n\t * flush but it removes the checkpointed state from the current CPU and\n\t * transitions the CPU out of TM mode.  Hence we need to call\n\t * tm_recheckpoint_new_task() (on the same task) to restore the\n\t * checkpointed state back and the TM mode.\n\t *\n\t * Can't pass dst because it isn't ready. Doesn't matter, passing\n\t * dst is only important for __switch_to()\n\t */\n\t__switch_to_tm(src, src);\n\n\t*dst = *src;\n\n\tclear_task_ebb(dst);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear_task_ebb",
          "args": [
            "dst"
          ],
          "line": 1619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__switch_to_tm",
          "args": [
            "src",
            "src"
          ],
          "line": 1615
        },
        "resolved": true,
        "details": {
          "function_name": "__switch_to_tm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "1071-1087",
          "snippet": "static inline void __switch_to_tm(struct task_struct *prev,\n\t\tstruct task_struct *new)\n{\n\tif (cpu_has_feature(CPU_FTR_TM)) {\n\t\tif (tm_enabled(prev) || tm_enabled(new))\n\t\t\ttm_enable();\n\n\t\tif (tm_enabled(prev)) {\n\t\t\tprev->thread.load_tm++;\n\t\t\ttm_reclaim_task(prev);\n\t\t\tif (!MSR_TM_ACTIVE(prev->thread.regs->msr) && prev->thread.load_tm == 0)\n\t\t\t\tprev->thread.regs->msr &= ~MSR_TM;\n\t\t}\n\n\t\ttm_recheckpoint_new_task(new);\n\t}\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void __switch_to_tm(struct task_struct *prev,\n\t\tstruct task_struct *new)\n{\n\tif (cpu_has_feature(CPU_FTR_TM)) {\n\t\tif (tm_enabled(prev) || tm_enabled(new))\n\t\t\ttm_enable();\n\n\t\tif (tm_enabled(prev)) {\n\t\t\tprev->thread.load_tm++;\n\t\t\ttm_reclaim_task(prev);\n\t\t\tif (!MSR_TM_ACTIVE(prev->thread.regs->msr) && prev->thread.load_tm == 0)\n\t\t\t\tprev->thread.regs->msr &= ~MSR_TM;\n\t\t}\n\n\t\ttm_recheckpoint_new_task(new);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "flush_all_to_thread",
          "args": [
            "src"
          ],
          "line": 1604
        },
        "resolved": true,
        "details": {
          "function_name": "flush_all_to_thread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "595-608",
          "snippet": "void flush_all_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\tpreempt_disable();\n\t\tBUG_ON(tsk != current);\n#ifdef CONFIG_SPE\n\t\tif (tsk->thread.regs->msr & MSR_SPE)\n\t\t\ttsk->thread.spefscr = mfspr(SPRN_SPEFSCR);\n#endif\n\t\tsave_all(tsk);\n\n\t\tpreempt_enable();\n\t}\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid flush_all_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\tpreempt_disable();\n\t\tBUG_ON(tsk != current);\n#ifdef CONFIG_SPE\n\t\tif (tsk->thread.regs->msr & MSR_SPE)\n\t\t\ttsk->thread.spefscr = mfspr(SPRN_SPEFSCR);\n#endif\n\t\tsave_all(tsk);\n\n\t\tpreempt_enable();\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint arch_dup_task_struct(struct task_struct *dst, struct task_struct *src)\n{\n\tflush_all_to_thread(src);\n\t/*\n\t * Flush TM state out so we can copy it.  __switch_to_tm() does this\n\t * flush but it removes the checkpointed state from the current CPU and\n\t * transitions the CPU out of TM mode.  Hence we need to call\n\t * tm_recheckpoint_new_task() (on the same task) to restore the\n\t * checkpointed state back and the TM mode.\n\t *\n\t * Can't pass dst because it isn't ready. Doesn't matter, passing\n\t * dst is only important for __switch_to()\n\t */\n\t__switch_to_tm(src, src);\n\n\t*dst = *src;\n\n\tclear_task_ebb(dst);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "release_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1593-1596",
    "snippet": "void\nrelease_thread(struct task_struct *t)\n{\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid\nrelease_thread(struct task_struct *t)\n{\n}"
  },
  {
    "function_name": "set_thread_tidr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1573-1588",
    "snippet": "int set_thread_tidr(struct task_struct *t)\n{\n\tif (!cpu_has_feature(CPU_FTR_P9_TIDR))\n\t\treturn -EINVAL;\n\n\tif (t != current)\n\t\treturn -EINVAL;\n\n\tif (t->thread.tidr)\n\t\treturn 0;\n\n\tt->thread.tidr = (u16)task_pid_nr(t);\n\tmtspr(SPRN_TIDR, t->thread.tidr);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_TIDR",
            "t->thread.tidr"
          ],
          "line": 1585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_pid_nr",
          "args": [
            "t"
          ],
          "line": 1584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_P9_TIDR"
          ],
          "line": 1575
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint set_thread_tidr(struct task_struct *t)\n{\n\tif (!cpu_has_feature(CPU_FTR_P9_TIDR))\n\t\treturn -EINVAL;\n\n\tif (t != current)\n\t\treturn -EINVAL;\n\n\tif (t->thread.tidr)\n\t\treturn 0;\n\n\tt->thread.tidr = (u16)task_pid_nr(t);\n\tmtspr(SPRN_TIDR, t->thread.tidr);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "arch_setup_new_exec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1531-1536",
    "snippet": "void arch_setup_new_exec(void)\n{\n\tif (radix_enabled())\n\t\treturn;\n\thash__setup_new_exec();\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash__setup_new_exec",
          "args": [],
          "line": 1535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "radix_enabled",
          "args": [],
          "line": 1533
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid arch_setup_new_exec(void)\n{\n\tif (radix_enabled())\n\t\treturn;\n\thash__setup_new_exec();\n}"
  },
  {
    "function_name": "flush_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1521-1528",
    "snippet": "void flush_thread(void)\n{\n#ifdef CONFIG_HAVE_HW_BREAKPOINT\n\tflush_ptrace_hw_breakpoint(current);\n#else /* CONFIG_HAVE_HW_BREAKPOINT */\n\tset_debug_reg_defaults(&current->thread);\n#endif /* CONFIG_HAVE_HW_BREAKPOINT */\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_debug_reg_defaults",
          "args": [
            "&current->thread"
          ],
          "line": 1526
        },
        "resolved": true,
        "details": {
          "function_name": "set_debug_reg_defaults",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "770-780",
          "snippet": "static void set_debug_reg_defaults(struct thread_struct *thread)\n{\n\tint i;\n\tstruct arch_hw_breakpoint null_brk = {0};\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tthread->hw_brk[i] = null_brk;\n\t\tif (ppc_breakpoint_available())\n\t\t\tset_breakpoint(i, &thread->hw_brk[i]);\n\t}\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void set_debug_reg_defaults(struct thread_struct *thread)\n{\n\tint i;\n\tstruct arch_hw_breakpoint null_brk = {0};\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tthread->hw_brk[i] = null_brk;\n\t\tif (ppc_breakpoint_available())\n\t\t\tset_breakpoint(i, &thread->hw_brk[i]);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "flush_ptrace_hw_breakpoint",
          "args": [
            "current"
          ],
          "line": 1524
        },
        "resolved": true,
        "details": {
          "function_name": "flush_ptrace_hw_breakpoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/hw_breakpoint.c",
          "lines": "751-760",
          "snippet": "void flush_ptrace_hw_breakpoint(struct task_struct *tsk)\n{\n\tint i;\n\tstruct thread_struct *t = &tsk->thread;\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tunregister_hw_breakpoint(t->ptrace_bps[i]);\n\t\tt->ptrace_bps[i] = NULL;\n\t}\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <asm/inst.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/debugfs.h>",
            "#include <asm/debug.h>",
            "#include <asm/sstep.h>",
            "#include <asm/processor.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <linux/init.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/percpu.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/notifier.h>",
            "#include <linux/hw_breakpoint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/inst.h>\n#include <asm/hvcall.h>\n#include <asm/debugfs.h>\n#include <asm/debug.h>\n#include <asm/sstep.h>\n#include <asm/processor.h>\n#include <asm/hw_breakpoint.h>\n#include <linux/init.h>\n#include <linux/debugfs.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/percpu.h>\n#include <linux/kprobes.h>\n#include <linux/notifier.h>\n#include <linux/hw_breakpoint.h>\n\nvoid flush_ptrace_hw_breakpoint(struct task_struct *tsk)\n{\n\tint i;\n\tstruct thread_struct *t = &tsk->thread;\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tunregister_hw_breakpoint(t->ptrace_bps[i]);\n\t\tt->ptrace_bps[i] = NULL;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid flush_thread(void)\n{\n#ifdef CONFIG_HAVE_HW_BREAKPOINT\n\tflush_ptrace_hw_breakpoint(current);\n#else /* CONFIG_HAVE_HW_BREAKPOINT */\n\tset_debug_reg_defaults(&current->thread);\n#endif /* CONFIG_HAVE_HW_BREAKPOINT */\n}"
  },
  {
    "function_name": "show_regs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1469-1519",
    "snippet": "void show_regs(struct pt_regs * regs)\n{\n\tint i, trap;\n\n\tshow_regs_print_info(KERN_DEFAULT);\n\n\tprintk(\"NIP:  \"REG\" LR: \"REG\" CTR: \"REG\"\\n\",\n\t       regs->nip, regs->link, regs->ctr);\n\tprintk(\"REGS: %px TRAP: %04lx   %s  (%s)\\n\",\n\t       regs, regs->trap, print_tainted(), init_utsname()->release);\n\tprintk(\"MSR:  \"REG\" \", regs->msr);\n\tprint_msr_bits(regs->msr);\n\tpr_cont(\"  CR: %08lx  XER: %08lx\\n\", regs->ccr, regs->xer);\n\ttrap = TRAP(regs);\n\tif (!trap_is_syscall(regs) && cpu_has_feature(CPU_FTR_CFAR))\n\t\tpr_cont(\"CFAR: \"REG\" \", regs->orig_gpr3);\n\tif (trap == 0x200 || trap == 0x300 || trap == 0x600) {\n\t\tif (IS_ENABLED(CONFIG_4xx) || IS_ENABLED(CONFIG_BOOKE))\n\t\t\tpr_cont(\"DEAR: \"REG\" ESR: \"REG\" \", regs->dar, regs->dsisr);\n\t\telse\n\t\t\tpr_cont(\"DAR: \"REG\" DSISR: %08lx \", regs->dar, regs->dsisr);\n\t}\n\n#ifdef CONFIG_PPC64\n\tpr_cont(\"IRQMASK: %lx \", regs->softe);\n#endif\n#ifdef CONFIG_PPC_TRANSACTIONAL_MEM\n\tif (MSR_TM_ACTIVE(regs->msr))\n\t\tpr_cont(\"\\nPACATMSCRATCH: %016llx \", get_paca()->tm_scratch);\n#endif\n\n\tfor (i = 0;  i < 32;  i++) {\n\t\tif ((i % REGS_PER_LINE) == 0)\n\t\t\tpr_cont(\"\\nGPR%02d: \", i);\n\t\tpr_cont(REG \" \", regs->gpr[i]);\n\t\tif (i == LAST_VOLATILE && !FULL_REGS(regs))\n\t\t\tbreak;\n\t}\n\tpr_cont(\"\\n\");\n\t/*\n\t * Lookup NIP late so we have the best change of getting the\n\t * above info out without failing\n\t */\n\tif (IS_ENABLED(CONFIG_KALLSYMS)) {\n\t\tprintk(\"NIP [\"REG\"] %pS\\n\", regs->nip, (void *)regs->nip);\n\t\tprintk(\"LR [\"REG\"] %pS\\n\", regs->link, (void *)regs->link);\n\t}\n\tshow_stack(current, (unsigned long *) regs->gpr[1], KERN_DEFAULT);\n\tif (!user_mode(regs))\n\t\tshow_instructions(regs);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define LAST_VOLATILE\t12",
      "#define REGS_PER_LINE\t8",
      "#define REG\t\t\"%08lx\"",
      "#define LAST_VOLATILE\t13",
      "#define REGS_PER_LINE\t4",
      "#define REG\t\t\"%016lx\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "show_instructions",
          "args": [
            "regs"
          ],
          "line": 1518
        },
        "resolved": true,
        "details": {
          "function_name": "show_instructions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "1306-1343",
          "snippet": "static void show_instructions(struct pt_regs *regs)\n{\n\tint i;\n\tunsigned long nip = regs->nip;\n\tunsigned long pc = regs->nip - (NR_INSN_TO_PRINT * 3 / 4 * sizeof(int));\n\n\tprintk(\"Instruction dump:\");\n\n\t/*\n\t * If we were executing with the MMU off for instructions, adjust pc\n\t * rather than printing XXXXXXXX.\n\t */\n\tif (!IS_ENABLED(CONFIG_BOOKE) && !(regs->msr & MSR_IR)) {\n\t\tpc = (unsigned long)phys_to_virt(pc);\n\t\tnip = (unsigned long)phys_to_virt(regs->nip);\n\t}\n\n\tfor (i = 0; i < NR_INSN_TO_PRINT; i++) {\n\t\tint instr;\n\n\t\tif (!(i % 8))\n\t\t\tpr_cont(\"\\n\");\n\n\t\tif (!__kernel_text_address(pc) ||\n\t\t    get_kernel_nofault(instr, (const void *)pc)) {\n\t\t\tpr_cont(\"XXXXXXXX \");\n\t\t} else {\n\t\t\tif (nip == pc)\n\t\t\t\tpr_cont(\"<%08x> \", instr);\n\t\t\telse\n\t\t\t\tpr_cont(\"%08x \", instr);\n\t\t}\n\n\t\tpc += sizeof(int);\n\t}\n\n\tpr_cont(\"\\n\");\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define NR_INSN_TO_PRINT\t16"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define NR_INSN_TO_PRINT\t16\n\nstatic void show_instructions(struct pt_regs *regs)\n{\n\tint i;\n\tunsigned long nip = regs->nip;\n\tunsigned long pc = regs->nip - (NR_INSN_TO_PRINT * 3 / 4 * sizeof(int));\n\n\tprintk(\"Instruction dump:\");\n\n\t/*\n\t * If we were executing with the MMU off for instructions, adjust pc\n\t * rather than printing XXXXXXXX.\n\t */\n\tif (!IS_ENABLED(CONFIG_BOOKE) && !(regs->msr & MSR_IR)) {\n\t\tpc = (unsigned long)phys_to_virt(pc);\n\t\tnip = (unsigned long)phys_to_virt(regs->nip);\n\t}\n\n\tfor (i = 0; i < NR_INSN_TO_PRINT; i++) {\n\t\tint instr;\n\n\t\tif (!(i % 8))\n\t\t\tpr_cont(\"\\n\");\n\n\t\tif (!__kernel_text_address(pc) ||\n\t\t    get_kernel_nofault(instr, (const void *)pc)) {\n\t\t\tpr_cont(\"XXXXXXXX \");\n\t\t} else {\n\t\t\tif (nip == pc)\n\t\t\t\tpr_cont(\"<%08x> \", instr);\n\t\t\telse\n\t\t\t\tpr_cont(\"%08x \", instr);\n\t\t}\n\n\t\tpc += sizeof(int);\n\t}\n\n\tpr_cont(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "user_mode",
          "args": [
            "regs"
          ],
          "line": 1517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "show_stack",
          "args": [
            "current",
            "(unsigned long *) regs->gpr[1]",
            "KERN_DEFAULT"
          ],
          "line": 1516
        },
        "resolved": true,
        "details": {
          "function_name": "show_stack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "2124-2188",
          "snippet": "void show_stack(struct task_struct *tsk, unsigned long *stack,\n\t\tconst char *loglvl)\n{\n\tunsigned long sp, ip, lr, newsp;\n\tint count = 0;\n\tint firstframe = 1;\n\tunsigned long ret_addr;\n\tint ftrace_idx = 0;\n\n\tif (tsk == NULL)\n\t\ttsk = current;\n\n\tif (!try_get_task_stack(tsk))\n\t\treturn;\n\n\tsp = (unsigned long) stack;\n\tif (sp == 0) {\n\t\tif (tsk == current)\n\t\t\tsp = current_stack_frame();\n\t\telse\n\t\t\tsp = tsk->thread.ksp;\n\t}\n\n\tlr = 0;\n\tprintk(\"%sCall Trace:\\n\", loglvl);\n\tdo {\n\t\tif (!validate_sp(sp, tsk, STACK_FRAME_OVERHEAD))\n\t\t\tbreak;\n\n\t\tstack = (unsigned long *) sp;\n\t\tnewsp = stack[0];\n\t\tip = stack[STACK_FRAME_LR_SAVE];\n\t\tif (!firstframe || ip != lr) {\n\t\t\tprintk(\"%s[\"REG\"] [\"REG\"] %pS\",\n\t\t\t\tloglvl, sp, ip, (void *)ip);\n\t\t\tret_addr = ftrace_graph_ret_addr(current,\n\t\t\t\t\t\t&ftrace_idx, ip, stack);\n\t\t\tif (ret_addr != ip)\n\t\t\t\tpr_cont(\" (%pS)\", (void *)ret_addr);\n\t\t\tif (firstframe)\n\t\t\t\tpr_cont(\" (unreliable)\");\n\t\t\tpr_cont(\"\\n\");\n\t\t}\n\t\tfirstframe = 0;\n\n\t\t/*\n\t\t * See if this is an exception frame.\n\t\t * We look for the \"regshere\" marker in the current frame.\n\t\t */\n\t\tif (validate_sp(sp, tsk, STACK_INT_FRAME_SIZE)\n\t\t    && stack[STACK_FRAME_MARKER] == STACK_FRAME_REGS_MARKER) {\n\t\t\tstruct pt_regs *regs = (struct pt_regs *)\n\t\t\t\t(sp + STACK_FRAME_OVERHEAD);\n\t\t\tlr = regs->link;\n\t\t\tprintk(\"%s--- interrupt: %lx at %pS\\n    LR = %pS\\n\",\n\t\t\t       loglvl, regs->trap,\n\t\t\t       (void *)regs->nip, (void *)lr);\n\t\t\tfirstframe = 1;\n\t\t}\n\n\t\tsp = newsp;\n\t} while (count++ < kstack_depth_to_print);\n\n\tput_task_stack(tsk);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define REG\t\t\"%08lx\"",
            "#define REG\t\t\"%016lx\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define REG\t\t\"%08lx\"\n#define REG\t\t\"%016lx\"\n\nvoid show_stack(struct task_struct *tsk, unsigned long *stack,\n\t\tconst char *loglvl)\n{\n\tunsigned long sp, ip, lr, newsp;\n\tint count = 0;\n\tint firstframe = 1;\n\tunsigned long ret_addr;\n\tint ftrace_idx = 0;\n\n\tif (tsk == NULL)\n\t\ttsk = current;\n\n\tif (!try_get_task_stack(tsk))\n\t\treturn;\n\n\tsp = (unsigned long) stack;\n\tif (sp == 0) {\n\t\tif (tsk == current)\n\t\t\tsp = current_stack_frame();\n\t\telse\n\t\t\tsp = tsk->thread.ksp;\n\t}\n\n\tlr = 0;\n\tprintk(\"%sCall Trace:\\n\", loglvl);\n\tdo {\n\t\tif (!validate_sp(sp, tsk, STACK_FRAME_OVERHEAD))\n\t\t\tbreak;\n\n\t\tstack = (unsigned long *) sp;\n\t\tnewsp = stack[0];\n\t\tip = stack[STACK_FRAME_LR_SAVE];\n\t\tif (!firstframe || ip != lr) {\n\t\t\tprintk(\"%s[\"REG\"] [\"REG\"] %pS\",\n\t\t\t\tloglvl, sp, ip, (void *)ip);\n\t\t\tret_addr = ftrace_graph_ret_addr(current,\n\t\t\t\t\t\t&ftrace_idx, ip, stack);\n\t\t\tif (ret_addr != ip)\n\t\t\t\tpr_cont(\" (%pS)\", (void *)ret_addr);\n\t\t\tif (firstframe)\n\t\t\t\tpr_cont(\" (unreliable)\");\n\t\t\tpr_cont(\"\\n\");\n\t\t}\n\t\tfirstframe = 0;\n\n\t\t/*\n\t\t * See if this is an exception frame.\n\t\t * We look for the \"regshere\" marker in the current frame.\n\t\t */\n\t\tif (validate_sp(sp, tsk, STACK_INT_FRAME_SIZE)\n\t\t    && stack[STACK_FRAME_MARKER] == STACK_FRAME_REGS_MARKER) {\n\t\t\tstruct pt_regs *regs = (struct pt_regs *)\n\t\t\t\t(sp + STACK_FRAME_OVERHEAD);\n\t\t\tlr = regs->link;\n\t\t\tprintk(\"%s--- interrupt: %lx at %pS\\n    LR = %pS\\n\",\n\t\t\t       loglvl, regs->trap,\n\t\t\t       (void *)regs->nip, (void *)lr);\n\t\t\tfirstframe = 1;\n\t\t}\n\n\t\tsp = newsp;\n\t} while (count++ < kstack_depth_to_print);\n\n\tput_task_stack(tsk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"LR [\"REG\"] %pS\\n\"",
            "regs->link",
            "(void *)regs->link"
          ],
          "line": 1514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"NIP [\"REG\"] %pS\\n\"",
            "regs->nip",
            "(void *)regs->nip"
          ],
          "line": 1513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_KALLSYMS"
          ],
          "line": 1512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"\\n\""
          ],
          "line": 1507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FULL_REGS",
          "args": [
            "regs"
          ],
          "line": 1504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "REG \" \"",
            "regs->gpr[i]"
          ],
          "line": 1503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"\\nGPR%02d: \"",
            "i"
          ],
          "line": 1502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"\\nPACATMSCRATCH: %016llx \"",
            "get_paca()->tm_scratch"
          ],
          "line": 1497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 1497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MSR_TM_ACTIVE",
          "args": [
            "regs->msr"
          ],
          "line": 1496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"IRQMASK: %lx \"",
            "regs->softe"
          ],
          "line": 1493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"DAR: \"REG\" DSISR: %08lx \"",
            "regs->dar",
            "regs->dsisr"
          ],
          "line": 1489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"DEAR: \"REG\" ESR: \"REG\" \"",
            "regs->dar",
            "regs->dsisr"
          ],
          "line": 1487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_BOOKE"
          ],
          "line": 1486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_4xx"
          ],
          "line": 1486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"CFAR: \"REG\" \"",
            "regs->orig_gpr3"
          ],
          "line": 1484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_CFAR"
          ],
          "line": 1483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trap_is_syscall",
          "args": [
            "regs"
          ],
          "line": 1483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TRAP",
          "args": [
            "regs"
          ],
          "line": 1482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"  CR: %08lx  XER: %08lx\\n\"",
            "regs->ccr",
            "regs->xer"
          ],
          "line": 1481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_msr_bits",
          "args": [
            "regs->msr"
          ],
          "line": 1480
        },
        "resolved": true,
        "details": {
          "function_name": "print_msr_bits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "1451-1457",
          "snippet": "static void print_msr_bits(unsigned long val)\n{\n\tpr_cont(\"<\");\n\tprint_bits(val, msr_bits, \",\");\n\tprint_tm_bits(val);\n\tpr_cont(\">\");\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void print_msr_bits(unsigned long val)\n{\n\tpr_cont(\"<\");\n\tprint_bits(val, msr_bits, \",\");\n\tprint_tm_bits(val);\n\tpr_cont(\">\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"MSR:  \"REG\" \"",
            "regs->msr"
          ],
          "line": 1479
        },
        "resolved": true,
        "details": {
          "function_name": "printk_log_rtas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/rtasd.c",
          "lines": "110-157",
          "snippet": "static void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}",
          "includes": [
            "#include <asm/topology.h>",
            "#include <asm/machdep.h>",
            "#include <linux/atomic.h>",
            "#include <asm/nvram.h>",
            "#include <asm/prom.h>",
            "#include <asm/rtas.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/topology.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/cpu.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool full_rtas_msgs;",
            "static int error_log_cnt;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/topology.h>\n#include <asm/machdep.h>\n#include <linux/atomic.h>\n#include <asm/nvram.h>\n#include <asm/prom.h>\n#include <asm/rtas.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <linux/topology.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/cpu.h>\n#include <linux/spinlock.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic bool full_rtas_msgs;\nstatic int error_log_cnt;\n\nstatic void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"REGS: %px TRAP: %04lx   %s  (%s)\\n\"",
            "regs",
            "regs->trap",
            "print_tainted()",
            "init_utsname()->release"
          ],
          "line": 1477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_utsname",
          "args": [],
          "line": 1478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_tainted",
          "args": [],
          "line": 1478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"NIP:  \"REG\" LR: \"REG\" CTR: \"REG\"\\n\"",
            "regs->nip",
            "regs->link",
            "regs->ctr"
          ],
          "line": 1475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "show_regs_print_info",
          "args": [
            "KERN_DEFAULT"
          ],
          "line": 1473
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define LAST_VOLATILE\t12\n#define REGS_PER_LINE\t8\n#define REG\t\t\"%08lx\"\n#define LAST_VOLATILE\t13\n#define REGS_PER_LINE\t4\n#define REG\t\t\"%016lx\"\n\nvoid show_regs(struct pt_regs * regs)\n{\n\tint i, trap;\n\n\tshow_regs_print_info(KERN_DEFAULT);\n\n\tprintk(\"NIP:  \"REG\" LR: \"REG\" CTR: \"REG\"\\n\",\n\t       regs->nip, regs->link, regs->ctr);\n\tprintk(\"REGS: %px TRAP: %04lx   %s  (%s)\\n\",\n\t       regs, regs->trap, print_tainted(), init_utsname()->release);\n\tprintk(\"MSR:  \"REG\" \", regs->msr);\n\tprint_msr_bits(regs->msr);\n\tpr_cont(\"  CR: %08lx  XER: %08lx\\n\", regs->ccr, regs->xer);\n\ttrap = TRAP(regs);\n\tif (!trap_is_syscall(regs) && cpu_has_feature(CPU_FTR_CFAR))\n\t\tpr_cont(\"CFAR: \"REG\" \", regs->orig_gpr3);\n\tif (trap == 0x200 || trap == 0x300 || trap == 0x600) {\n\t\tif (IS_ENABLED(CONFIG_4xx) || IS_ENABLED(CONFIG_BOOKE))\n\t\t\tpr_cont(\"DEAR: \"REG\" ESR: \"REG\" \", regs->dar, regs->dsisr);\n\t\telse\n\t\t\tpr_cont(\"DAR: \"REG\" DSISR: %08lx \", regs->dar, regs->dsisr);\n\t}\n\n#ifdef CONFIG_PPC64\n\tpr_cont(\"IRQMASK: %lx \", regs->softe);\n#endif\n#ifdef CONFIG_PPC_TRANSACTIONAL_MEM\n\tif (MSR_TM_ACTIVE(regs->msr))\n\t\tpr_cont(\"\\nPACATMSCRATCH: %016llx \", get_paca()->tm_scratch);\n#endif\n\n\tfor (i = 0;  i < 32;  i++) {\n\t\tif ((i % REGS_PER_LINE) == 0)\n\t\t\tpr_cont(\"\\nGPR%02d: \", i);\n\t\tpr_cont(REG \" \", regs->gpr[i]);\n\t\tif (i == LAST_VOLATILE && !FULL_REGS(regs))\n\t\t\tbreak;\n\t}\n\tpr_cont(\"\\n\");\n\t/*\n\t * Lookup NIP late so we have the best change of getting the\n\t * above info out without failing\n\t */\n\tif (IS_ENABLED(CONFIG_KALLSYMS)) {\n\t\tprintk(\"NIP [\"REG\"] %pS\\n\", regs->nip, (void *)regs->nip);\n\t\tprintk(\"LR [\"REG\"] %pS\\n\", regs->link, (void *)regs->link);\n\t}\n\tshow_stack(current, (unsigned long *) regs->gpr[1], KERN_DEFAULT);\n\tif (!user_mode(regs))\n\t\tshow_instructions(regs);\n}"
  },
  {
    "function_name": "print_msr_bits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1451-1457",
    "snippet": "static void print_msr_bits(unsigned long val)\n{\n\tpr_cont(\"<\");\n\tprint_bits(val, msr_bits, \",\");\n\tprint_tm_bits(val);\n\tpr_cont(\">\");\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\">\""
          ],
          "line": 1456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_tm_bits",
          "args": [
            "val"
          ],
          "line": 1455
        },
        "resolved": true,
        "details": {
          "function_name": "print_tm_bits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "1448-1448",
          "snippet": "static void print_tm_bits(unsigned long val) {}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void print_tm_bits(unsigned long val) {}"
        }
      },
      {
        "call_info": {
          "callee": "print_bits",
          "args": [
            "val",
            "msr_bits",
            "\",\""
          ],
          "line": 1454
        },
        "resolved": true,
        "details": {
          "function_name": "print_bits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "1413-1422",
          "snippet": "static void print_bits(unsigned long val, struct regbit *bits, const char *sep)\n{\n\tconst char *s = \"\";\n\n\tfor (; bits->bit; ++bits)\n\t\tif (val & bits->bit) {\n\t\t\tpr_cont(\"%s%s\", s, bits->name);\n\t\t\ts = sep;\n\t\t}\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void print_bits(unsigned long val, struct regbit *bits, const char *sep)\n{\n\tconst char *s = \"\";\n\n\tfor (; bits->bit; ++bits)\n\t\tif (val & bits->bit) {\n\t\t\tpr_cont(\"%s%s\", s, bits->name);\n\t\t\ts = sep;\n\t\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"<\""
          ],
          "line": 1453
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void print_msr_bits(unsigned long val)\n{\n\tpr_cont(\"<\");\n\tprint_bits(val, msr_bits, \",\");\n\tprint_tm_bits(val);\n\tpr_cont(\">\");\n}"
  },
  {
    "function_name": "print_tm_bits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1448-1448",
    "snippet": "static void print_tm_bits(unsigned long val) {}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void print_tm_bits(unsigned long val) {}"
  },
  {
    "function_name": "print_tm_bits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1432-1446",
    "snippet": "static void print_tm_bits(unsigned long val)\n{\n/*\n * This only prints something if at least one of the TM bit is set.\n * Inside the TM[], the output means:\n *   E: Enabled\t\t(bit 32)\n *   S: Suspended\t(bit 33)\n *   T: Transactional\t(bit 34)\n */\n\tif (val & (MSR_TM | MSR_TS_S | MSR_TS_T)) {\n\t\tpr_cont(\",TM[\");\n\t\tprint_bits(val, msr_tm_bits, \"\");\n\t\tpr_cont(\"]\");\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"]\""
          ],
          "line": 1444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_bits",
          "args": [
            "val",
            "msr_tm_bits",
            "\"\""
          ],
          "line": 1443
        },
        "resolved": true,
        "details": {
          "function_name": "print_bits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "1413-1422",
          "snippet": "static void print_bits(unsigned long val, struct regbit *bits, const char *sep)\n{\n\tconst char *s = \"\";\n\n\tfor (; bits->bit; ++bits)\n\t\tif (val & bits->bit) {\n\t\t\tpr_cont(\"%s%s\", s, bits->name);\n\t\t\ts = sep;\n\t\t}\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void print_bits(unsigned long val, struct regbit *bits, const char *sep)\n{\n\tconst char *s = \"\";\n\n\tfor (; bits->bit; ++bits)\n\t\tif (val & bits->bit) {\n\t\t\tpr_cont(\"%s%s\", s, bits->name);\n\t\t\ts = sep;\n\t\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\",TM[\""
          ],
          "line": 1442
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void print_tm_bits(unsigned long val)\n{\n/*\n * This only prints something if at least one of the TM bit is set.\n * Inside the TM[], the output means:\n *   E: Enabled\t\t(bit 32)\n *   S: Suspended\t(bit 33)\n *   T: Transactional\t(bit 34)\n */\n\tif (val & (MSR_TM | MSR_TS_S | MSR_TS_T)) {\n\t\tpr_cont(\",TM[\");\n\t\tprint_bits(val, msr_tm_bits, \"\");\n\t\tpr_cont(\"]\");\n\t}\n}"
  },
  {
    "function_name": "print_bits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1413-1422",
    "snippet": "static void print_bits(unsigned long val, struct regbit *bits, const char *sep)\n{\n\tconst char *s = \"\";\n\n\tfor (; bits->bit; ++bits)\n\t\tif (val & bits->bit) {\n\t\t\tpr_cont(\"%s%s\", s, bits->name);\n\t\t\ts = sep;\n\t\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"%s%s\"",
            "s",
            "bits->name"
          ],
          "line": 1419
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void print_bits(unsigned long val, struct regbit *bits, const char *sep)\n{\n\tconst char *s = \"\";\n\n\tfor (; bits->bit; ++bits)\n\t\tif (val & bits->bit) {\n\t\t\tpr_cont(\"%s%s\", s, bits->name);\n\t\t\ts = sep;\n\t\t}\n}"
  },
  {
    "function_name": "show_user_instructions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1345-1376",
    "snippet": "void show_user_instructions(struct pt_regs *regs)\n{\n\tunsigned long pc;\n\tint n = NR_INSN_TO_PRINT;\n\tstruct seq_buf s;\n\tchar buf[96]; /* enough for 8 times 9 + 2 chars */\n\n\tpc = regs->nip - (NR_INSN_TO_PRINT * 3 / 4 * sizeof(int));\n\n\tseq_buf_init(&s, buf, sizeof(buf));\n\n\twhile (n) {\n\t\tint i;\n\n\t\tseq_buf_clear(&s);\n\n\t\tfor (i = 0; i < 8 && n; i++, n--, pc += sizeof(int)) {\n\t\t\tint instr;\n\n\t\t\tif (copy_from_user_nofault(&instr, (void __user *)pc,\n\t\t\t\t\tsizeof(instr))) {\n\t\t\t\tseq_buf_printf(&s, \"XXXXXXXX \");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tseq_buf_printf(&s, regs->nip == pc ? \"<%08x> \" : \"%08x \", instr);\n\t\t}\n\n\t\tif (!seq_buf_has_overflowed(&s))\n\t\t\tpr_info(\"%s[%d]: code: %s\\n\", current->comm,\n\t\t\t\tcurrent->pid, s.buffer);\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define NR_INSN_TO_PRINT\t16"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"%s[%d]: code: %s\\n\"",
            "current->comm",
            "current->pid",
            "s.buffer"
          ],
          "line": 1373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_buf_has_overflowed",
          "args": [
            "&s"
          ],
          "line": 1372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_buf_printf",
          "args": [
            "&s",
            "regs->nip == pc ? \"<%08x> \" : \"%08x \"",
            "instr"
          ],
          "line": 1369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_buf_printf",
          "args": [
            "&s",
            "\"XXXXXXXX \""
          ],
          "line": 1366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user_nofault",
          "args": [
            "&instr",
            "(void __user *)pc",
            "sizeof(instr)"
          ],
          "line": 1364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_buf_clear",
          "args": [
            "&s"
          ],
          "line": 1359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_buf_init",
          "args": [
            "&s",
            "buf",
            "sizeof(buf)"
          ],
          "line": 1354
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define NR_INSN_TO_PRINT\t16\n\nvoid show_user_instructions(struct pt_regs *regs)\n{\n\tunsigned long pc;\n\tint n = NR_INSN_TO_PRINT;\n\tstruct seq_buf s;\n\tchar buf[96]; /* enough for 8 times 9 + 2 chars */\n\n\tpc = regs->nip - (NR_INSN_TO_PRINT * 3 / 4 * sizeof(int));\n\n\tseq_buf_init(&s, buf, sizeof(buf));\n\n\twhile (n) {\n\t\tint i;\n\n\t\tseq_buf_clear(&s);\n\n\t\tfor (i = 0; i < 8 && n; i++, n--, pc += sizeof(int)) {\n\t\t\tint instr;\n\n\t\t\tif (copy_from_user_nofault(&instr, (void __user *)pc,\n\t\t\t\t\tsizeof(instr))) {\n\t\t\t\tseq_buf_printf(&s, \"XXXXXXXX \");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tseq_buf_printf(&s, regs->nip == pc ? \"<%08x> \" : \"%08x \", instr);\n\t\t}\n\n\t\tif (!seq_buf_has_overflowed(&s))\n\t\t\tpr_info(\"%s[%d]: code: %s\\n\", current->comm,\n\t\t\t\tcurrent->pid, s.buffer);\n\t}\n}"
  },
  {
    "function_name": "show_instructions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1306-1343",
    "snippet": "static void show_instructions(struct pt_regs *regs)\n{\n\tint i;\n\tunsigned long nip = regs->nip;\n\tunsigned long pc = regs->nip - (NR_INSN_TO_PRINT * 3 / 4 * sizeof(int));\n\n\tprintk(\"Instruction dump:\");\n\n\t/*\n\t * If we were executing with the MMU off for instructions, adjust pc\n\t * rather than printing XXXXXXXX.\n\t */\n\tif (!IS_ENABLED(CONFIG_BOOKE) && !(regs->msr & MSR_IR)) {\n\t\tpc = (unsigned long)phys_to_virt(pc);\n\t\tnip = (unsigned long)phys_to_virt(regs->nip);\n\t}\n\n\tfor (i = 0; i < NR_INSN_TO_PRINT; i++) {\n\t\tint instr;\n\n\t\tif (!(i % 8))\n\t\t\tpr_cont(\"\\n\");\n\n\t\tif (!__kernel_text_address(pc) ||\n\t\t    get_kernel_nofault(instr, (const void *)pc)) {\n\t\t\tpr_cont(\"XXXXXXXX \");\n\t\t} else {\n\t\t\tif (nip == pc)\n\t\t\t\tpr_cont(\"<%08x> \", instr);\n\t\t\telse\n\t\t\t\tpr_cont(\"%08x \", instr);\n\t\t}\n\n\t\tpc += sizeof(int);\n\t}\n\n\tpr_cont(\"\\n\");\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define NR_INSN_TO_PRINT\t16"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"\\n\""
          ],
          "line": 1342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"%08x \"",
            "instr"
          ],
          "line": 1336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"<%08x> \"",
            "instr"
          ],
          "line": 1334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"XXXXXXXX \""
          ],
          "line": 1331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_kernel_nofault",
          "args": [
            "instr",
            "(const void *)pc"
          ],
          "line": 1330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__kernel_text_address",
          "args": [
            "pc"
          ],
          "line": 1329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"\\n\""
          ],
          "line": 1327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "phys_to_virt",
          "args": [
            "regs->nip"
          ],
          "line": 1320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "phys_to_virt",
          "args": [
            "pc"
          ],
          "line": 1319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_BOOKE"
          ],
          "line": 1318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"Instruction dump:\""
          ],
          "line": 1312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define NR_INSN_TO_PRINT\t16\n\nstatic void show_instructions(struct pt_regs *regs)\n{\n\tint i;\n\tunsigned long nip = regs->nip;\n\tunsigned long pc = regs->nip - (NR_INSN_TO_PRINT * 3 / 4 * sizeof(int));\n\n\tprintk(\"Instruction dump:\");\n\n\t/*\n\t * If we were executing with the MMU off for instructions, adjust pc\n\t * rather than printing XXXXXXXX.\n\t */\n\tif (!IS_ENABLED(CONFIG_BOOKE) && !(regs->msr & MSR_IR)) {\n\t\tpc = (unsigned long)phys_to_virt(pc);\n\t\tnip = (unsigned long)phys_to_virt(regs->nip);\n\t}\n\n\tfor (i = 0; i < NR_INSN_TO_PRINT; i++) {\n\t\tint instr;\n\n\t\tif (!(i % 8))\n\t\t\tpr_cont(\"\\n\");\n\n\t\tif (!__kernel_text_address(pc) ||\n\t\t    get_kernel_nofault(instr, (const void *)pc)) {\n\t\t\tpr_cont(\"XXXXXXXX \");\n\t\t} else {\n\t\t\tif (nip == pc)\n\t\t\t\tpr_cont(\"<%08x> \", instr);\n\t\t\telse\n\t\t\t\tpr_cont(\"%08x \", instr);\n\t\t}\n\n\t\tpc += sizeof(int);\n\t}\n\n\tpr_cont(\"\\n\");\n}"
  },
  {
    "function_name": "__switch_to",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1208-1302",
    "snippet": "struct task_struct *__switch_to(struct task_struct *prev,\n\tstruct task_struct *new)\n{\n\tstruct thread_struct *new_thread, *old_thread;\n\tstruct task_struct *last;\n#ifdef CONFIG_PPC_BOOK3S_64\n\tstruct ppc64_tlb_batch *batch;\n#endif\n\n\tnew_thread = &new->thread;\n\told_thread = &current->thread;\n\n\tWARN_ON(!irqs_disabled());\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\tbatch = this_cpu_ptr(&ppc64_tlb_batch);\n\tif (batch->active) {\n\t\tcurrent_thread_info()->local_flags |= _TLF_LAZY_MMU;\n\t\tif (batch->index)\n\t\t\t__flush_tlb_pending(batch);\n\t\tbatch->active = 0;\n\t}\n#endif /* CONFIG_PPC_BOOK3S_64 */\n\n#ifdef CONFIG_PPC_ADV_DEBUG_REGS\n\tswitch_booke_debug_regs(&new->thread.debug);\n#else\n/*\n * For PPC_BOOK3S_64, we use the hw-breakpoint interfaces that would\n * schedule DABR\n */\n#ifndef CONFIG_HAVE_HW_BREAKPOINT\n\tswitch_hw_breakpoint(new);\n#endif /* CONFIG_HAVE_HW_BREAKPOINT */\n#endif\n\n\t/*\n\t * We need to save SPRs before treclaim/trecheckpoint as these will\n\t * change a number of them.\n\t */\n\tsave_sprs(&prev->thread);\n\n\t/* Save FPU, Altivec, VSX and SPE state */\n\tgiveup_all(prev);\n\n\t__switch_to_tm(prev, new);\n\n\tif (!radix_enabled()) {\n\t\t/*\n\t\t * We can't take a PMU exception inside _switch() since there\n\t\t * is a window where the kernel stack SLB and the kernel stack\n\t\t * are out of sync. Hard disable here.\n\t\t */\n\t\thard_irq_disable();\n\t}\n\n\t/*\n\t * Call restore_sprs() before calling _switch(). If we move it after\n\t * _switch() then we miss out on calling it for new tasks. The reason\n\t * for this is we manually create a stack frame for new tasks that\n\t * directly returns through ret_from_fork() or\n\t * ret_from_kernel_thread(). See copy_thread() for details.\n\t */\n\trestore_sprs(old_thread, new_thread);\n\n\tlast = _switch(old_thread, new_thread);\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\tif (current_thread_info()->local_flags & _TLF_LAZY_MMU) {\n\t\tcurrent_thread_info()->local_flags &= ~_TLF_LAZY_MMU;\n\t\tbatch = this_cpu_ptr(&ppc64_tlb_batch);\n\t\tbatch->active = 1;\n\t}\n\n\tif (current->thread.regs) {\n\t\trestore_math(current->thread.regs);\n\n\t\t/*\n\t\t * On POWER9 the copy-paste buffer can only paste into\n\t\t * foreign real addresses, so unprivileged processes can not\n\t\t * see the data or use it in any way unless they have\n\t\t * foreign real mappings. If the new process has the foreign\n\t\t * real address mappings, we must issue a cp_abort to clear\n\t\t * any state and prevent snooping, corruption or a covert\n\t\t * channel. ISA v3.1 supports paste into local memory.\n\t\t */\n\t\tif (current->mm &&\n\t\t\t(cpu_has_feature(CPU_FTR_ARCH_31) ||\n\t\t\tatomic_read(&current->mm->context.vas_windows)))\n\t\t\tasm volatile(PPC_CP_ABORT);\n\t}\n#endif /* CONFIG_PPC_BOOK3S_64 */\n\n\treturn last;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&current->mm->context.vas_windows"
          ],
          "line": 1296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_31"
          ],
          "line": 1295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "restore_math",
          "args": [
            "current->thread.regs"
          ],
          "line": 1283
        },
        "resolved": true,
        "details": {
          "function_name": "restore_math",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "518-563",
          "snippet": "void notrace restore_math(struct pt_regs *regs)\n{\n\tunsigned long msr;\n\tunsigned long new_msr = 0;\n\n\tmsr = regs->msr;\n\n\t/*\n\t * new_msr tracks the facilities that are to be restored. Only reload\n\t * if the bit is not set in the user MSR (if it is set, the registers\n\t * are live for the user thread).\n\t */\n\tif ((!(msr & MSR_FP)) && should_restore_fp())\n\t\tnew_msr |= MSR_FP;\n\n\tif ((!(msr & MSR_VEC)) && should_restore_altivec())\n\t\tnew_msr |= MSR_VEC;\n\n\tif ((!(msr & MSR_VSX)) && should_restore_vsx()) {\n\t\tif (((msr | new_msr) & (MSR_FP | MSR_VEC)) == (MSR_FP | MSR_VEC))\n\t\t\tnew_msr |= MSR_VSX;\n\t}\n\n\tif (new_msr) {\n\t\tunsigned long fpexc_mode = 0;\n\n\t\tmsr_check_and_set(new_msr);\n\n\t\tif (new_msr & MSR_FP) {\n\t\t\tdo_restore_fp();\n\n\t\t\t// This also covers VSX, because VSX implies FP\n\t\t\tfpexc_mode = current->thread.fpexc_mode;\n\t\t}\n\n\t\tif (new_msr & MSR_VEC)\n\t\t\tdo_restore_altivec();\n\n\t\tif (new_msr & MSR_VSX)\n\t\t\tdo_restore_vsx();\n\n\t\tmsr_check_and_clear(new_msr);\n\n\t\tregs->msr |= new_msr | fpexc_mode;\n\t}\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace restore_math(struct pt_regs *regs)\n{\n\tunsigned long msr;\n\tunsigned long new_msr = 0;\n\n\tmsr = regs->msr;\n\n\t/*\n\t * new_msr tracks the facilities that are to be restored. Only reload\n\t * if the bit is not set in the user MSR (if it is set, the registers\n\t * are live for the user thread).\n\t */\n\tif ((!(msr & MSR_FP)) && should_restore_fp())\n\t\tnew_msr |= MSR_FP;\n\n\tif ((!(msr & MSR_VEC)) && should_restore_altivec())\n\t\tnew_msr |= MSR_VEC;\n\n\tif ((!(msr & MSR_VSX)) && should_restore_vsx()) {\n\t\tif (((msr | new_msr) & (MSR_FP | MSR_VEC)) == (MSR_FP | MSR_VEC))\n\t\t\tnew_msr |= MSR_VSX;\n\t}\n\n\tif (new_msr) {\n\t\tunsigned long fpexc_mode = 0;\n\n\t\tmsr_check_and_set(new_msr);\n\n\t\tif (new_msr & MSR_FP) {\n\t\t\tdo_restore_fp();\n\n\t\t\t// This also covers VSX, because VSX implies FP\n\t\t\tfpexc_mode = current->thread.fpexc_mode;\n\t\t}\n\n\t\tif (new_msr & MSR_VEC)\n\t\t\tdo_restore_altivec();\n\n\t\tif (new_msr & MSR_VSX)\n\t\t\tdo_restore_vsx();\n\n\t\tmsr_check_and_clear(new_msr);\n\n\t\tregs->msr |= new_msr | fpexc_mode;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&ppc64_tlb_batch"
          ],
          "line": 1278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_thread_info",
          "args": [],
          "line": 1277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_thread_info",
          "args": [],
          "line": 1276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_switch",
          "args": [
            "old_thread",
            "new_thread"
          ],
          "line": 1273
        },
        "resolved": true,
        "details": {
          "function_name": "__switch_to",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "1208-1302",
          "snippet": "struct task_struct *__switch_to(struct task_struct *prev,\n\tstruct task_struct *new)\n{\n\tstruct thread_struct *new_thread, *old_thread;\n\tstruct task_struct *last;\n#ifdef CONFIG_PPC_BOOK3S_64\n\tstruct ppc64_tlb_batch *batch;\n#endif\n\n\tnew_thread = &new->thread;\n\told_thread = &current->thread;\n\n\tWARN_ON(!irqs_disabled());\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\tbatch = this_cpu_ptr(&ppc64_tlb_batch);\n\tif (batch->active) {\n\t\tcurrent_thread_info()->local_flags |= _TLF_LAZY_MMU;\n\t\tif (batch->index)\n\t\t\t__flush_tlb_pending(batch);\n\t\tbatch->active = 0;\n\t}\n#endif /* CONFIG_PPC_BOOK3S_64 */\n\n#ifdef CONFIG_PPC_ADV_DEBUG_REGS\n\tswitch_booke_debug_regs(&new->thread.debug);\n#else\n/*\n * For PPC_BOOK3S_64, we use the hw-breakpoint interfaces that would\n * schedule DABR\n */\n#ifndef CONFIG_HAVE_HW_BREAKPOINT\n\tswitch_hw_breakpoint(new);\n#endif /* CONFIG_HAVE_HW_BREAKPOINT */\n#endif\n\n\t/*\n\t * We need to save SPRs before treclaim/trecheckpoint as these will\n\t * change a number of them.\n\t */\n\tsave_sprs(&prev->thread);\n\n\t/* Save FPU, Altivec, VSX and SPE state */\n\tgiveup_all(prev);\n\n\t__switch_to_tm(prev, new);\n\n\tif (!radix_enabled()) {\n\t\t/*\n\t\t * We can't take a PMU exception inside _switch() since there\n\t\t * is a window where the kernel stack SLB and the kernel stack\n\t\t * are out of sync. Hard disable here.\n\t\t */\n\t\thard_irq_disable();\n\t}\n\n\t/*\n\t * Call restore_sprs() before calling _switch(). If we move it after\n\t * _switch() then we miss out on calling it for new tasks. The reason\n\t * for this is we manually create a stack frame for new tasks that\n\t * directly returns through ret_from_fork() or\n\t * ret_from_kernel_thread(). See copy_thread() for details.\n\t */\n\trestore_sprs(old_thread, new_thread);\n\n\tlast = _switch(old_thread, new_thread);\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\tif (current_thread_info()->local_flags & _TLF_LAZY_MMU) {\n\t\tcurrent_thread_info()->local_flags &= ~_TLF_LAZY_MMU;\n\t\tbatch = this_cpu_ptr(&ppc64_tlb_batch);\n\t\tbatch->active = 1;\n\t}\n\n\tif (current->thread.regs) {\n\t\trestore_math(current->thread.regs);\n\n\t\t/*\n\t\t * On POWER9 the copy-paste buffer can only paste into\n\t\t * foreign real addresses, so unprivileged processes can not\n\t\t * see the data or use it in any way unless they have\n\t\t * foreign real mappings. If the new process has the foreign\n\t\t * real address mappings, we must issue a cp_abort to clear\n\t\t * any state and prevent snooping, corruption or a covert\n\t\t * channel. ISA v3.1 supports paste into local memory.\n\t\t */\n\t\tif (current->mm &&\n\t\t\t(cpu_has_feature(CPU_FTR_ARCH_31) ||\n\t\t\tatomic_read(&current->mm->context.vas_windows)))\n\t\t\tasm volatile(PPC_CP_ABORT);\n\t}\n#endif /* CONFIG_PPC_BOOK3S_64 */\n\n\treturn last;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "restore_sprs",
          "args": [
            "old_thread",
            "new_thread"
          ],
          "line": 1271
        },
        "resolved": true,
        "details": {
          "function_name": "restore_sprs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "1167-1206",
          "snippet": "static inline void restore_sprs(struct thread_struct *old_thread,\n\t\t\t\tstruct thread_struct *new_thread)\n{\n#ifdef CONFIG_ALTIVEC\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC) &&\n\t    old_thread->vrsave != new_thread->vrsave)\n\t\tmtspr(SPRN_VRSAVE, new_thread->vrsave);\n#endif\n#ifdef CONFIG_PPC_BOOK3S_64\n\tif (cpu_has_feature(CPU_FTR_DSCR)) {\n\t\tu64 dscr = get_paca()->dscr_default;\n\t\tif (new_thread->dscr_inherit)\n\t\t\tdscr = new_thread->dscr;\n\n\t\tif (old_thread->dscr != dscr)\n\t\t\tmtspr(SPRN_DSCR, dscr);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tif (old_thread->bescr != new_thread->bescr)\n\t\t\tmtspr(SPRN_BESCR, new_thread->bescr);\n\t\tif (old_thread->ebbhr != new_thread->ebbhr)\n\t\t\tmtspr(SPRN_EBBHR, new_thread->ebbhr);\n\t\tif (old_thread->ebbrr != new_thread->ebbrr)\n\t\t\tmtspr(SPRN_EBBRR, new_thread->ebbrr);\n\n\t\tif (old_thread->fscr != new_thread->fscr)\n\t\t\tmtspr(SPRN_FSCR, new_thread->fscr);\n\n\t\tif (old_thread->tar != new_thread->tar)\n\t\t\tmtspr(SPRN_TAR, new_thread->tar);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_P9_TIDR) &&\n\t    old_thread->tidr != new_thread->tidr)\n\t\tmtspr(SPRN_TIDR, new_thread->tidr);\n#endif\n\n\tthread_pkey_regs_restore(new_thread, old_thread);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void restore_sprs(struct thread_struct *old_thread,\n\t\t\t\tstruct thread_struct *new_thread)\n{\n#ifdef CONFIG_ALTIVEC\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC) &&\n\t    old_thread->vrsave != new_thread->vrsave)\n\t\tmtspr(SPRN_VRSAVE, new_thread->vrsave);\n#endif\n#ifdef CONFIG_PPC_BOOK3S_64\n\tif (cpu_has_feature(CPU_FTR_DSCR)) {\n\t\tu64 dscr = get_paca()->dscr_default;\n\t\tif (new_thread->dscr_inherit)\n\t\t\tdscr = new_thread->dscr;\n\n\t\tif (old_thread->dscr != dscr)\n\t\t\tmtspr(SPRN_DSCR, dscr);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tif (old_thread->bescr != new_thread->bescr)\n\t\t\tmtspr(SPRN_BESCR, new_thread->bescr);\n\t\tif (old_thread->ebbhr != new_thread->ebbhr)\n\t\t\tmtspr(SPRN_EBBHR, new_thread->ebbhr);\n\t\tif (old_thread->ebbrr != new_thread->ebbrr)\n\t\t\tmtspr(SPRN_EBBRR, new_thread->ebbrr);\n\n\t\tif (old_thread->fscr != new_thread->fscr)\n\t\t\tmtspr(SPRN_FSCR, new_thread->fscr);\n\n\t\tif (old_thread->tar != new_thread->tar)\n\t\t\tmtspr(SPRN_TAR, new_thread->tar);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_P9_TIDR) &&\n\t    old_thread->tidr != new_thread->tidr)\n\t\tmtspr(SPRN_TIDR, new_thread->tidr);\n#endif\n\n\tthread_pkey_regs_restore(new_thread, old_thread);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hard_irq_disable",
          "args": [],
          "line": 1261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "radix_enabled",
          "args": [],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__switch_to_tm",
          "args": [
            "prev",
            "new"
          ],
          "line": 1253
        },
        "resolved": true,
        "details": {
          "function_name": "__switch_to_tm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "1071-1087",
          "snippet": "static inline void __switch_to_tm(struct task_struct *prev,\n\t\tstruct task_struct *new)\n{\n\tif (cpu_has_feature(CPU_FTR_TM)) {\n\t\tif (tm_enabled(prev) || tm_enabled(new))\n\t\t\ttm_enable();\n\n\t\tif (tm_enabled(prev)) {\n\t\t\tprev->thread.load_tm++;\n\t\t\ttm_reclaim_task(prev);\n\t\t\tif (!MSR_TM_ACTIVE(prev->thread.regs->msr) && prev->thread.load_tm == 0)\n\t\t\t\tprev->thread.regs->msr &= ~MSR_TM;\n\t\t}\n\n\t\ttm_recheckpoint_new_task(new);\n\t}\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void __switch_to_tm(struct task_struct *prev,\n\t\tstruct task_struct *new)\n{\n\tif (cpu_has_feature(CPU_FTR_TM)) {\n\t\tif (tm_enabled(prev) || tm_enabled(new))\n\t\t\ttm_enable();\n\n\t\tif (tm_enabled(prev)) {\n\t\t\tprev->thread.load_tm++;\n\t\t\ttm_reclaim_task(prev);\n\t\t\tif (!MSR_TM_ACTIVE(prev->thread.regs->msr) && prev->thread.load_tm == 0)\n\t\t\t\tprev->thread.regs->msr &= ~MSR_TM;\n\t\t}\n\n\t\ttm_recheckpoint_new_task(new);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "giveup_all",
          "args": [
            "prev"
          ],
          "line": 1251
        },
        "resolved": true,
        "details": {
          "function_name": "giveup_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "424-450",
          "snippet": "void giveup_all(struct task_struct *tsk)\n{\n\tunsigned long usermsr;\n\n\tif (!tsk->thread.regs)\n\t\treturn;\n\n\tcheck_if_tm_restore_required(tsk);\n\n\tusermsr = tsk->thread.regs->msr;\n\n\tif ((usermsr & msr_all_available) == 0)\n\t\treturn;\n\n\tmsr_check_and_set(msr_all_available);\n\n\tWARN_ON((usermsr & MSR_VSX) && !((usermsr & MSR_FP) && (usermsr & MSR_VEC)));\n\n\tif (usermsr & MSR_FP)\n\t\t__giveup_fpu(tsk);\n\tif (usermsr & MSR_VEC)\n\t\t__giveup_altivec(tsk);\n\tif (usermsr & MSR_SPE)\n\t\t__giveup_spe(tsk);\n\n\tmsr_check_and_clear(msr_all_available);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long msr_all_available;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic unsigned long msr_all_available;\n\nvoid giveup_all(struct task_struct *tsk)\n{\n\tunsigned long usermsr;\n\n\tif (!tsk->thread.regs)\n\t\treturn;\n\n\tcheck_if_tm_restore_required(tsk);\n\n\tusermsr = tsk->thread.regs->msr;\n\n\tif ((usermsr & msr_all_available) == 0)\n\t\treturn;\n\n\tmsr_check_and_set(msr_all_available);\n\n\tWARN_ON((usermsr & MSR_VSX) && !((usermsr & MSR_FP) && (usermsr & MSR_VEC)));\n\n\tif (usermsr & MSR_FP)\n\t\t__giveup_fpu(tsk);\n\tif (usermsr & MSR_VEC)\n\t\t__giveup_altivec(tsk);\n\tif (usermsr & MSR_SPE)\n\t\t__giveup_spe(tsk);\n\n\tmsr_check_and_clear(msr_all_available);\n}"
        }
      },
      {
        "call_info": {
          "callee": "save_sprs",
          "args": [
            "&prev->thread"
          ],
          "line": 1248
        },
        "resolved": true,
        "details": {
          "function_name": "save_sprs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "1137-1165",
          "snippet": "static inline void save_sprs(struct thread_struct *t)\n{\n#ifdef CONFIG_ALTIVEC\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC))\n\t\tt->vrsave = mfspr(SPRN_VRSAVE);\n#endif\n#ifdef CONFIG_PPC_BOOK3S_64\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tt->dscr = mfspr(SPRN_DSCR);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tt->bescr = mfspr(SPRN_BESCR);\n\t\tt->ebbhr = mfspr(SPRN_EBBHR);\n\t\tt->ebbrr = mfspr(SPRN_EBBRR);\n\n\t\tt->fscr = mfspr(SPRN_FSCR);\n\n\t\t/*\n\t\t * Note that the TAR is not available for use in the kernel.\n\t\t * (To provide this, the TAR should be backed up/restored on\n\t\t * exception entry/exit instead, and be in pt_regs.  FIXME,\n\t\t * this should be in pt_regs anyway (for debug).)\n\t\t */\n\t\tt->tar = mfspr(SPRN_TAR);\n\t}\n#endif\n\n\tthread_pkey_regs_save(t);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void save_sprs(struct thread_struct *t)\n{\n#ifdef CONFIG_ALTIVEC\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC))\n\t\tt->vrsave = mfspr(SPRN_VRSAVE);\n#endif\n#ifdef CONFIG_PPC_BOOK3S_64\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tt->dscr = mfspr(SPRN_DSCR);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tt->bescr = mfspr(SPRN_BESCR);\n\t\tt->ebbhr = mfspr(SPRN_EBBHR);\n\t\tt->ebbrr = mfspr(SPRN_EBBRR);\n\n\t\tt->fscr = mfspr(SPRN_FSCR);\n\n\t\t/*\n\t\t * Note that the TAR is not available for use in the kernel.\n\t\t * (To provide this, the TAR should be backed up/restored on\n\t\t * exception entry/exit instead, and be in pt_regs.  FIXME,\n\t\t * this should be in pt_regs anyway (for debug).)\n\t\t */\n\t\tt->tar = mfspr(SPRN_TAR);\n\t}\n#endif\n\n\tthread_pkey_regs_save(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "switch_hw_breakpoint",
          "args": [
            "new"
          ],
          "line": 1240
        },
        "resolved": true,
        "details": {
          "function_name": "switch_hw_breakpoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "795-806",
          "snippet": "static void switch_hw_breakpoint(struct task_struct *new)\n{\n\tint i;\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tif (likely(hw_brk_match(this_cpu_ptr(&current_brk[i]),\n\t\t\t\t\t&new->thread.hw_brk[i])))\n\t\t\tcontinue;\n\n\t\t__set_breakpoint(i, &new->thread.hw_brk[i]);\n\t}\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);\n\nstatic void switch_hw_breakpoint(struct task_struct *new)\n{\n\tint i;\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tif (likely(hw_brk_match(this_cpu_ptr(&current_brk[i]),\n\t\t\t\t\t&new->thread.hw_brk[i])))\n\t\t\tcontinue;\n\n\t\t__set_breakpoint(i, &new->thread.hw_brk[i]);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "switch_booke_debug_regs",
          "args": [
            "&new->thread.debug"
          ],
          "line": 1233
        },
        "resolved": true,
        "details": {
          "function_name": "switch_booke_debug_regs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "754-759",
          "snippet": "void switch_booke_debug_regs(struct debug_reg *new_debug)\n{\n\tif ((current->thread.debug.dbcr0 & DBCR0_IDM)\n\t\t|| (new_debug->dbcr0 & DBCR0_IDM))\n\t\t\tprime_debug_regs(new_debug);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid switch_booke_debug_regs(struct debug_reg *new_debug)\n{\n\tif ((current->thread.debug.dbcr0 & DBCR0_IDM)\n\t\t|| (new_debug->dbcr0 & DBCR0_IDM))\n\t\t\tprime_debug_regs(new_debug);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__flush_tlb_pending",
          "args": [
            "batch"
          ],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_thread_info",
          "args": [],
          "line": 1225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&ppc64_tlb_batch"
          ],
          "line": 1223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!irqs_disabled()"
          ],
          "line": 1220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irqs_disabled",
          "args": [],
          "line": 1220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstruct task_struct *__switch_to(struct task_struct *prev,\n\tstruct task_struct *new)\n{\n\tstruct thread_struct *new_thread, *old_thread;\n\tstruct task_struct *last;\n#ifdef CONFIG_PPC_BOOK3S_64\n\tstruct ppc64_tlb_batch *batch;\n#endif\n\n\tnew_thread = &new->thread;\n\told_thread = &current->thread;\n\n\tWARN_ON(!irqs_disabled());\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\tbatch = this_cpu_ptr(&ppc64_tlb_batch);\n\tif (batch->active) {\n\t\tcurrent_thread_info()->local_flags |= _TLF_LAZY_MMU;\n\t\tif (batch->index)\n\t\t\t__flush_tlb_pending(batch);\n\t\tbatch->active = 0;\n\t}\n#endif /* CONFIG_PPC_BOOK3S_64 */\n\n#ifdef CONFIG_PPC_ADV_DEBUG_REGS\n\tswitch_booke_debug_regs(&new->thread.debug);\n#else\n/*\n * For PPC_BOOK3S_64, we use the hw-breakpoint interfaces that would\n * schedule DABR\n */\n#ifndef CONFIG_HAVE_HW_BREAKPOINT\n\tswitch_hw_breakpoint(new);\n#endif /* CONFIG_HAVE_HW_BREAKPOINT */\n#endif\n\n\t/*\n\t * We need to save SPRs before treclaim/trecheckpoint as these will\n\t * change a number of them.\n\t */\n\tsave_sprs(&prev->thread);\n\n\t/* Save FPU, Altivec, VSX and SPE state */\n\tgiveup_all(prev);\n\n\t__switch_to_tm(prev, new);\n\n\tif (!radix_enabled()) {\n\t\t/*\n\t\t * We can't take a PMU exception inside _switch() since there\n\t\t * is a window where the kernel stack SLB and the kernel stack\n\t\t * are out of sync. Hard disable here.\n\t\t */\n\t\thard_irq_disable();\n\t}\n\n\t/*\n\t * Call restore_sprs() before calling _switch(). If we move it after\n\t * _switch() then we miss out on calling it for new tasks. The reason\n\t * for this is we manually create a stack frame for new tasks that\n\t * directly returns through ret_from_fork() or\n\t * ret_from_kernel_thread(). See copy_thread() for details.\n\t */\n\trestore_sprs(old_thread, new_thread);\n\n\tlast = _switch(old_thread, new_thread);\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\tif (current_thread_info()->local_flags & _TLF_LAZY_MMU) {\n\t\tcurrent_thread_info()->local_flags &= ~_TLF_LAZY_MMU;\n\t\tbatch = this_cpu_ptr(&ppc64_tlb_batch);\n\t\tbatch->active = 1;\n\t}\n\n\tif (current->thread.regs) {\n\t\trestore_math(current->thread.regs);\n\n\t\t/*\n\t\t * On POWER9 the copy-paste buffer can only paste into\n\t\t * foreign real addresses, so unprivileged processes can not\n\t\t * see the data or use it in any way unless they have\n\t\t * foreign real mappings. If the new process has the foreign\n\t\t * real address mappings, we must issue a cp_abort to clear\n\t\t * any state and prevent snooping, corruption or a covert\n\t\t * channel. ISA v3.1 supports paste into local memory.\n\t\t */\n\t\tif (current->mm &&\n\t\t\t(cpu_has_feature(CPU_FTR_ARCH_31) ||\n\t\t\tatomic_read(&current->mm->context.vas_windows)))\n\t\t\tasm volatile(PPC_CP_ABORT);\n\t}\n#endif /* CONFIG_PPC_BOOK3S_64 */\n\n\treturn last;\n}"
  },
  {
    "function_name": "restore_sprs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1167-1206",
    "snippet": "static inline void restore_sprs(struct thread_struct *old_thread,\n\t\t\t\tstruct thread_struct *new_thread)\n{\n#ifdef CONFIG_ALTIVEC\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC) &&\n\t    old_thread->vrsave != new_thread->vrsave)\n\t\tmtspr(SPRN_VRSAVE, new_thread->vrsave);\n#endif\n#ifdef CONFIG_PPC_BOOK3S_64\n\tif (cpu_has_feature(CPU_FTR_DSCR)) {\n\t\tu64 dscr = get_paca()->dscr_default;\n\t\tif (new_thread->dscr_inherit)\n\t\t\tdscr = new_thread->dscr;\n\n\t\tif (old_thread->dscr != dscr)\n\t\t\tmtspr(SPRN_DSCR, dscr);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tif (old_thread->bescr != new_thread->bescr)\n\t\t\tmtspr(SPRN_BESCR, new_thread->bescr);\n\t\tif (old_thread->ebbhr != new_thread->ebbhr)\n\t\t\tmtspr(SPRN_EBBHR, new_thread->ebbhr);\n\t\tif (old_thread->ebbrr != new_thread->ebbrr)\n\t\t\tmtspr(SPRN_EBBRR, new_thread->ebbrr);\n\n\t\tif (old_thread->fscr != new_thread->fscr)\n\t\t\tmtspr(SPRN_FSCR, new_thread->fscr);\n\n\t\tif (old_thread->tar != new_thread->tar)\n\t\t\tmtspr(SPRN_TAR, new_thread->tar);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_P9_TIDR) &&\n\t    old_thread->tidr != new_thread->tidr)\n\t\tmtspr(SPRN_TIDR, new_thread->tidr);\n#endif\n\n\tthread_pkey_regs_restore(new_thread, old_thread);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "thread_pkey_regs_restore",
          "args": [
            "new_thread",
            "old_thread"
          ],
          "line": 1205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_TIDR",
            "new_thread->tidr"
          ],
          "line": 1202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_P9_TIDR"
          ],
          "line": 1200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_TAR",
            "new_thread->tar"
          ],
          "line": 1197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_FSCR",
            "new_thread->fscr"
          ],
          "line": 1194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_EBBRR",
            "new_thread->ebbrr"
          ],
          "line": 1191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_EBBHR",
            "new_thread->ebbhr"
          ],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_BESCR",
            "new_thread->bescr"
          ],
          "line": 1187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_207S"
          ],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_DSCR",
            "dscr"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 1177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_DSCR"
          ],
          "line": 1176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_VRSAVE",
            "new_thread->vrsave"
          ],
          "line": 1173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ALTIVEC"
          ],
          "line": 1171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void restore_sprs(struct thread_struct *old_thread,\n\t\t\t\tstruct thread_struct *new_thread)\n{\n#ifdef CONFIG_ALTIVEC\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC) &&\n\t    old_thread->vrsave != new_thread->vrsave)\n\t\tmtspr(SPRN_VRSAVE, new_thread->vrsave);\n#endif\n#ifdef CONFIG_PPC_BOOK3S_64\n\tif (cpu_has_feature(CPU_FTR_DSCR)) {\n\t\tu64 dscr = get_paca()->dscr_default;\n\t\tif (new_thread->dscr_inherit)\n\t\t\tdscr = new_thread->dscr;\n\n\t\tif (old_thread->dscr != dscr)\n\t\t\tmtspr(SPRN_DSCR, dscr);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tif (old_thread->bescr != new_thread->bescr)\n\t\t\tmtspr(SPRN_BESCR, new_thread->bescr);\n\t\tif (old_thread->ebbhr != new_thread->ebbhr)\n\t\t\tmtspr(SPRN_EBBHR, new_thread->ebbhr);\n\t\tif (old_thread->ebbrr != new_thread->ebbrr)\n\t\t\tmtspr(SPRN_EBBRR, new_thread->ebbrr);\n\n\t\tif (old_thread->fscr != new_thread->fscr)\n\t\t\tmtspr(SPRN_FSCR, new_thread->fscr);\n\n\t\tif (old_thread->tar != new_thread->tar)\n\t\t\tmtspr(SPRN_TAR, new_thread->tar);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_P9_TIDR) &&\n\t    old_thread->tidr != new_thread->tidr)\n\t\tmtspr(SPRN_TIDR, new_thread->tidr);\n#endif\n\n\tthread_pkey_regs_restore(new_thread, old_thread);\n}"
  },
  {
    "function_name": "save_sprs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1137-1165",
    "snippet": "static inline void save_sprs(struct thread_struct *t)\n{\n#ifdef CONFIG_ALTIVEC\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC))\n\t\tt->vrsave = mfspr(SPRN_VRSAVE);\n#endif\n#ifdef CONFIG_PPC_BOOK3S_64\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tt->dscr = mfspr(SPRN_DSCR);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tt->bescr = mfspr(SPRN_BESCR);\n\t\tt->ebbhr = mfspr(SPRN_EBBHR);\n\t\tt->ebbrr = mfspr(SPRN_EBBRR);\n\n\t\tt->fscr = mfspr(SPRN_FSCR);\n\n\t\t/*\n\t\t * Note that the TAR is not available for use in the kernel.\n\t\t * (To provide this, the TAR should be backed up/restored on\n\t\t * exception entry/exit instead, and be in pt_regs.  FIXME,\n\t\t * this should be in pt_regs anyway (for debug).)\n\t\t */\n\t\tt->tar = mfspr(SPRN_TAR);\n\t}\n#endif\n\n\tthread_pkey_regs_save(t);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "thread_pkey_regs_save",
          "args": [
            "t"
          ],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_TAR"
          ],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_FSCR"
          ],
          "line": 1152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_EBBRR"
          ],
          "line": 1150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_EBBHR"
          ],
          "line": 1149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_BESCR"
          ],
          "line": 1148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_207S"
          ],
          "line": 1147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_DSCR"
          ],
          "line": 1145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_DSCR"
          ],
          "line": 1144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_VRSAVE"
          ],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ALTIVEC"
          ],
          "line": 1140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void save_sprs(struct thread_struct *t)\n{\n#ifdef CONFIG_ALTIVEC\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC))\n\t\tt->vrsave = mfspr(SPRN_VRSAVE);\n#endif\n#ifdef CONFIG_PPC_BOOK3S_64\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tt->dscr = mfspr(SPRN_DSCR);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tt->bescr = mfspr(SPRN_BESCR);\n\t\tt->ebbhr = mfspr(SPRN_EBBHR);\n\t\tt->ebbrr = mfspr(SPRN_EBBRR);\n\n\t\tt->fscr = mfspr(SPRN_FSCR);\n\n\t\t/*\n\t\t * Note that the TAR is not available for use in the kernel.\n\t\t * (To provide this, the TAR should be backed up/restored on\n\t\t * exception entry/exit instead, and be in pt_regs.  FIXME,\n\t\t * this should be in pt_regs anyway (for debug).)\n\t\t */\n\t\tt->tar = mfspr(SPRN_TAR);\n\t}\n#endif\n\n\tthread_pkey_regs_save(t);\n}"
  },
  {
    "function_name": "restore_tm_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1103-1130",
    "snippet": "void restore_tm_state(struct pt_regs *regs)\n{\n\tunsigned long msr_diff;\n\n\t/*\n\t * This is the only moment we should clear TIF_RESTORE_TM as\n\t * it is here that ckpt_regs.msr and pt_regs.msr become the same\n\t * again, anything else could lead to an incorrect ckpt_msr being\n\t * saved and therefore incorrect signal contexts.\n\t */\n\tclear_thread_flag(TIF_RESTORE_TM);\n\tif (!MSR_TM_ACTIVE(regs->msr))\n\t\treturn;\n\n\tmsr_diff = current->thread.ckpt_regs.msr & ~regs->msr;\n\tmsr_diff &= MSR_FP | MSR_VEC | MSR_VSX;\n\n\t/* Ensure that restore_math() will restore */\n\tif (msr_diff & MSR_FP)\n\t\tcurrent->thread.load_fp = 1;\n#ifdef CONFIG_ALTIVEC\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC) && msr_diff & MSR_VEC)\n\t\tcurrent->thread.load_vec = 1;\n#endif\n\trestore_math(regs);\n\n\tregs->msr |= msr_diff;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "restore_math",
          "args": [
            "regs"
          ],
          "line": 1127
        },
        "resolved": true,
        "details": {
          "function_name": "restore_math",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "518-563",
          "snippet": "void notrace restore_math(struct pt_regs *regs)\n{\n\tunsigned long msr;\n\tunsigned long new_msr = 0;\n\n\tmsr = regs->msr;\n\n\t/*\n\t * new_msr tracks the facilities that are to be restored. Only reload\n\t * if the bit is not set in the user MSR (if it is set, the registers\n\t * are live for the user thread).\n\t */\n\tif ((!(msr & MSR_FP)) && should_restore_fp())\n\t\tnew_msr |= MSR_FP;\n\n\tif ((!(msr & MSR_VEC)) && should_restore_altivec())\n\t\tnew_msr |= MSR_VEC;\n\n\tif ((!(msr & MSR_VSX)) && should_restore_vsx()) {\n\t\tif (((msr | new_msr) & (MSR_FP | MSR_VEC)) == (MSR_FP | MSR_VEC))\n\t\t\tnew_msr |= MSR_VSX;\n\t}\n\n\tif (new_msr) {\n\t\tunsigned long fpexc_mode = 0;\n\n\t\tmsr_check_and_set(new_msr);\n\n\t\tif (new_msr & MSR_FP) {\n\t\t\tdo_restore_fp();\n\n\t\t\t// This also covers VSX, because VSX implies FP\n\t\t\tfpexc_mode = current->thread.fpexc_mode;\n\t\t}\n\n\t\tif (new_msr & MSR_VEC)\n\t\t\tdo_restore_altivec();\n\n\t\tif (new_msr & MSR_VSX)\n\t\t\tdo_restore_vsx();\n\n\t\tmsr_check_and_clear(new_msr);\n\n\t\tregs->msr |= new_msr | fpexc_mode;\n\t}\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace restore_math(struct pt_regs *regs)\n{\n\tunsigned long msr;\n\tunsigned long new_msr = 0;\n\n\tmsr = regs->msr;\n\n\t/*\n\t * new_msr tracks the facilities that are to be restored. Only reload\n\t * if the bit is not set in the user MSR (if it is set, the registers\n\t * are live for the user thread).\n\t */\n\tif ((!(msr & MSR_FP)) && should_restore_fp())\n\t\tnew_msr |= MSR_FP;\n\n\tif ((!(msr & MSR_VEC)) && should_restore_altivec())\n\t\tnew_msr |= MSR_VEC;\n\n\tif ((!(msr & MSR_VSX)) && should_restore_vsx()) {\n\t\tif (((msr | new_msr) & (MSR_FP | MSR_VEC)) == (MSR_FP | MSR_VEC))\n\t\t\tnew_msr |= MSR_VSX;\n\t}\n\n\tif (new_msr) {\n\t\tunsigned long fpexc_mode = 0;\n\n\t\tmsr_check_and_set(new_msr);\n\n\t\tif (new_msr & MSR_FP) {\n\t\t\tdo_restore_fp();\n\n\t\t\t// This also covers VSX, because VSX implies FP\n\t\t\tfpexc_mode = current->thread.fpexc_mode;\n\t\t}\n\n\t\tif (new_msr & MSR_VEC)\n\t\t\tdo_restore_altivec();\n\n\t\tif (new_msr & MSR_VSX)\n\t\t\tdo_restore_vsx();\n\n\t\tmsr_check_and_clear(new_msr);\n\n\t\tregs->msr |= new_msr | fpexc_mode;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ALTIVEC"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MSR_TM_ACTIVE",
          "args": [
            "regs->msr"
          ],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_thread_flag",
          "args": [
            "TIF_RESTORE_TM"
          ],
          "line": 1113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid restore_tm_state(struct pt_regs *regs)\n{\n\tunsigned long msr_diff;\n\n\t/*\n\t * This is the only moment we should clear TIF_RESTORE_TM as\n\t * it is here that ckpt_regs.msr and pt_regs.msr become the same\n\t * again, anything else could lead to an incorrect ckpt_msr being\n\t * saved and therefore incorrect signal contexts.\n\t */\n\tclear_thread_flag(TIF_RESTORE_TM);\n\tif (!MSR_TM_ACTIVE(regs->msr))\n\t\treturn;\n\n\tmsr_diff = current->thread.ckpt_regs.msr & ~regs->msr;\n\tmsr_diff &= MSR_FP | MSR_VEC | MSR_VSX;\n\n\t/* Ensure that restore_math() will restore */\n\tif (msr_diff & MSR_FP)\n\t\tcurrent->thread.load_fp = 1;\n#ifdef CONFIG_ALTIVEC\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC) && msr_diff & MSR_VEC)\n\t\tcurrent->thread.load_vec = 1;\n#endif\n\trestore_math(regs);\n\n\tregs->msr |= msr_diff;\n}"
  },
  {
    "function_name": "__switch_to_tm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1071-1087",
    "snippet": "static inline void __switch_to_tm(struct task_struct *prev,\n\t\tstruct task_struct *new)\n{\n\tif (cpu_has_feature(CPU_FTR_TM)) {\n\t\tif (tm_enabled(prev) || tm_enabled(new))\n\t\t\ttm_enable();\n\n\t\tif (tm_enabled(prev)) {\n\t\t\tprev->thread.load_tm++;\n\t\t\ttm_reclaim_task(prev);\n\t\t\tif (!MSR_TM_ACTIVE(prev->thread.regs->msr) && prev->thread.load_tm == 0)\n\t\t\t\tprev->thread.regs->msr &= ~MSR_TM;\n\t\t}\n\n\t\ttm_recheckpoint_new_task(new);\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tm_recheckpoint_new_task",
          "args": [
            "new"
          ],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "tm_recheckpoint_new_task",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "1033-1069",
          "snippet": "static inline void tm_recheckpoint_new_task(struct task_struct *new)\n{\n\tif (!cpu_has_feature(CPU_FTR_TM))\n\t\treturn;\n\n\t/* Recheckpoint the registers of the thread we're about to switch to.\n\t *\n\t * If the task was using FP, we non-lazily reload both the original and\n\t * the speculative FP register states.  This is because the kernel\n\t * doesn't see if/when a TM rollback occurs, so if we take an FP\n\t * unavailable later, we are unable to determine which set of FP regs\n\t * need to be restored.\n\t */\n\tif (!tm_enabled(new))\n\t\treturn;\n\n\tif (!MSR_TM_ACTIVE(new->thread.regs->msr)){\n\t\ttm_restore_sprs(&new->thread);\n\t\treturn;\n\t}\n\t/* Recheckpoint to restore original checkpointed register state. */\n\tTM_DEBUG(\"*** tm_recheckpoint of pid %d (new->msr 0x%lx)\\n\",\n\t\t new->pid, new->thread.regs->msr);\n\n\ttm_recheckpoint(&new->thread);\n\n\t/*\n\t * The checkpointed state has been restored but the live state has\n\t * not, ensure all the math functionality is turned off to trigger\n\t * restore_math() to reload.\n\t */\n\tnew->thread.regs->msr &= ~(MSR_FP | MSR_VEC | MSR_VSX);\n\n\tTM_DEBUG(\"*** tm_recheckpoint of pid %d complete \"\n\t\t \"(kernel msr 0x%lx)\\n\",\n\t\t new->pid, mfmsr());\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void tm_recheckpoint_new_task(struct task_struct *new)\n{\n\tif (!cpu_has_feature(CPU_FTR_TM))\n\t\treturn;\n\n\t/* Recheckpoint the registers of the thread we're about to switch to.\n\t *\n\t * If the task was using FP, we non-lazily reload both the original and\n\t * the speculative FP register states.  This is because the kernel\n\t * doesn't see if/when a TM rollback occurs, so if we take an FP\n\t * unavailable later, we are unable to determine which set of FP regs\n\t * need to be restored.\n\t */\n\tif (!tm_enabled(new))\n\t\treturn;\n\n\tif (!MSR_TM_ACTIVE(new->thread.regs->msr)){\n\t\ttm_restore_sprs(&new->thread);\n\t\treturn;\n\t}\n\t/* Recheckpoint to restore original checkpointed register state. */\n\tTM_DEBUG(\"*** tm_recheckpoint of pid %d (new->msr 0x%lx)\\n\",\n\t\t new->pid, new->thread.regs->msr);\n\n\ttm_recheckpoint(&new->thread);\n\n\t/*\n\t * The checkpointed state has been restored but the live state has\n\t * not, ensure all the math functionality is turned off to trigger\n\t * restore_math() to reload.\n\t */\n\tnew->thread.regs->msr &= ~(MSR_FP | MSR_VEC | MSR_VSX);\n\n\tTM_DEBUG(\"*** tm_recheckpoint of pid %d complete \"\n\t\t \"(kernel msr 0x%lx)\\n\",\n\t\t new->pid, mfmsr());\n}"
        }
      },
      {
        "call_info": {
          "callee": "MSR_TM_ACTIVE",
          "args": [
            "prev->thread.regs->msr"
          ],
          "line": 1081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tm_reclaim_task",
          "args": [
            "prev"
          ],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "tm_reclaim_task",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "965-1005",
          "snippet": "static inline void tm_reclaim_task(struct task_struct *tsk)\n{\n\t/* We have to work out if we're switching from/to a task that's in the\n\t * middle of a transaction.\n\t *\n\t * In switching we need to maintain a 2nd register state as\n\t * oldtask->thread.ckpt_regs.  We tm_reclaim(oldproc); this saves the\n\t * checkpointed (tbegin) state in ckpt_regs, ckfp_state and\n\t * ckvr_state\n\t *\n\t * We also context switch (save) TFHAR/TEXASR/TFIAR in here.\n\t */\n\tstruct thread_struct *thr = &tsk->thread;\n\n\tif (!thr->regs)\n\t\treturn;\n\n\tif (!MSR_TM_ACTIVE(thr->regs->msr))\n\t\tgoto out_and_saveregs;\n\n\tWARN_ON(tm_suspend_disabled);\n\n\tTM_DEBUG(\"--- tm_reclaim on pid %d (NIP=%lx, \"\n\t\t \"ccr=%lx, msr=%lx, trap=%lx)\\n\",\n\t\t tsk->pid, thr->regs->nip,\n\t\t thr->regs->ccr, thr->regs->msr,\n\t\t thr->regs->trap);\n\n\ttm_reclaim_thread(thr, TM_CAUSE_RESCHED);\n\n\tTM_DEBUG(\"--- tm_reclaim on pid %d complete\\n\",\n\t\t tsk->pid);\n\nout_and_saveregs:\n\t/* Always save the regs here, even if a transaction's not active.\n\t * This context-switches a thread's TM info SPRs.  We do it here to\n\t * be consistent with the restore path (in recheckpoint) which\n\t * cannot happen later in _switch().\n\t */\n\ttm_save_sprs(thr);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void tm_reclaim_task(struct task_struct *tsk)\n{\n\t/* We have to work out if we're switching from/to a task that's in the\n\t * middle of a transaction.\n\t *\n\t * In switching we need to maintain a 2nd register state as\n\t * oldtask->thread.ckpt_regs.  We tm_reclaim(oldproc); this saves the\n\t * checkpointed (tbegin) state in ckpt_regs, ckfp_state and\n\t * ckvr_state\n\t *\n\t * We also context switch (save) TFHAR/TEXASR/TFIAR in here.\n\t */\n\tstruct thread_struct *thr = &tsk->thread;\n\n\tif (!thr->regs)\n\t\treturn;\n\n\tif (!MSR_TM_ACTIVE(thr->regs->msr))\n\t\tgoto out_and_saveregs;\n\n\tWARN_ON(tm_suspend_disabled);\n\n\tTM_DEBUG(\"--- tm_reclaim on pid %d (NIP=%lx, \"\n\t\t \"ccr=%lx, msr=%lx, trap=%lx)\\n\",\n\t\t tsk->pid, thr->regs->nip,\n\t\t thr->regs->ccr, thr->regs->msr,\n\t\t thr->regs->trap);\n\n\ttm_reclaim_thread(thr, TM_CAUSE_RESCHED);\n\n\tTM_DEBUG(\"--- tm_reclaim on pid %d complete\\n\",\n\t\t tsk->pid);\n\nout_and_saveregs:\n\t/* Always save the regs here, even if a transaction's not active.\n\t * This context-switches a thread's TM info SPRs.  We do it here to\n\t * be consistent with the restore path (in recheckpoint) which\n\t * cannot happen later in _switch().\n\t */\n\ttm_save_sprs(thr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tm_enabled",
          "args": [
            "prev"
          ],
          "line": 1078
        },
        "resolved": true,
        "details": {
          "function_name": "tm_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "910-913",
          "snippet": "static inline bool tm_enabled(struct task_struct *tsk)\n{\n\treturn tsk && tsk->thread.regs && (tsk->thread.regs->msr & MSR_TM);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline bool tm_enabled(struct task_struct *tsk)\n{\n\treturn tsk && tsk->thread.regs && (tsk->thread.regs->msr & MSR_TM);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tm_enable",
          "args": [],
          "line": 1076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_TM"
          ],
          "line": 1074
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void __switch_to_tm(struct task_struct *prev,\n\t\tstruct task_struct *new)\n{\n\tif (cpu_has_feature(CPU_FTR_TM)) {\n\t\tif (tm_enabled(prev) || tm_enabled(new))\n\t\t\ttm_enable();\n\n\t\tif (tm_enabled(prev)) {\n\t\t\tprev->thread.load_tm++;\n\t\t\ttm_reclaim_task(prev);\n\t\t\tif (!MSR_TM_ACTIVE(prev->thread.regs->msr) && prev->thread.load_tm == 0)\n\t\t\t\tprev->thread.regs->msr &= ~MSR_TM;\n\t\t}\n\n\t\ttm_recheckpoint_new_task(new);\n\t}\n}"
  },
  {
    "function_name": "tm_recheckpoint_new_task",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1033-1069",
    "snippet": "static inline void tm_recheckpoint_new_task(struct task_struct *new)\n{\n\tif (!cpu_has_feature(CPU_FTR_TM))\n\t\treturn;\n\n\t/* Recheckpoint the registers of the thread we're about to switch to.\n\t *\n\t * If the task was using FP, we non-lazily reload both the original and\n\t * the speculative FP register states.  This is because the kernel\n\t * doesn't see if/when a TM rollback occurs, so if we take an FP\n\t * unavailable later, we are unable to determine which set of FP regs\n\t * need to be restored.\n\t */\n\tif (!tm_enabled(new))\n\t\treturn;\n\n\tif (!MSR_TM_ACTIVE(new->thread.regs->msr)){\n\t\ttm_restore_sprs(&new->thread);\n\t\treturn;\n\t}\n\t/* Recheckpoint to restore original checkpointed register state. */\n\tTM_DEBUG(\"*** tm_recheckpoint of pid %d (new->msr 0x%lx)\\n\",\n\t\t new->pid, new->thread.regs->msr);\n\n\ttm_recheckpoint(&new->thread);\n\n\t/*\n\t * The checkpointed state has been restored but the live state has\n\t * not, ensure all the math functionality is turned off to trigger\n\t * restore_math() to reload.\n\t */\n\tnew->thread.regs->msr &= ~(MSR_FP | MSR_VEC | MSR_VSX);\n\n\tTM_DEBUG(\"*** tm_recheckpoint of pid %d complete \"\n\t\t \"(kernel msr 0x%lx)\\n\",\n\t\t new->pid, mfmsr());\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TM_DEBUG",
          "args": [
            "\"*** tm_recheckpoint of pid %d complete \"\n\t\t \"(kernel msr 0x%lx)\\n\"",
            "new->pid",
            "mfmsr()"
          ],
          "line": 1066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfmsr",
          "args": [],
          "line": 1068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tm_recheckpoint",
          "args": [
            "&new->thread"
          ],
          "line": 1057
        },
        "resolved": true,
        "details": {
          "function_name": "tm_recheckpoint_new_task",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "1033-1069",
          "snippet": "static inline void tm_recheckpoint_new_task(struct task_struct *new)\n{\n\tif (!cpu_has_feature(CPU_FTR_TM))\n\t\treturn;\n\n\t/* Recheckpoint the registers of the thread we're about to switch to.\n\t *\n\t * If the task was using FP, we non-lazily reload both the original and\n\t * the speculative FP register states.  This is because the kernel\n\t * doesn't see if/when a TM rollback occurs, so if we take an FP\n\t * unavailable later, we are unable to determine which set of FP regs\n\t * need to be restored.\n\t */\n\tif (!tm_enabled(new))\n\t\treturn;\n\n\tif (!MSR_TM_ACTIVE(new->thread.regs->msr)){\n\t\ttm_restore_sprs(&new->thread);\n\t\treturn;\n\t}\n\t/* Recheckpoint to restore original checkpointed register state. */\n\tTM_DEBUG(\"*** tm_recheckpoint of pid %d (new->msr 0x%lx)\\n\",\n\t\t new->pid, new->thread.regs->msr);\n\n\ttm_recheckpoint(&new->thread);\n\n\t/*\n\t * The checkpointed state has been restored but the live state has\n\t * not, ensure all the math functionality is turned off to trigger\n\t * restore_math() to reload.\n\t */\n\tnew->thread.regs->msr &= ~(MSR_FP | MSR_VEC | MSR_VSX);\n\n\tTM_DEBUG(\"*** tm_recheckpoint of pid %d complete \"\n\t\t \"(kernel msr 0x%lx)\\n\",\n\t\t new->pid, mfmsr());\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "TM_DEBUG",
          "args": [
            "\"*** tm_recheckpoint of pid %d (new->msr 0x%lx)\\n\"",
            "new->pid",
            "new->thread.regs->msr"
          ],
          "line": 1054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tm_restore_sprs",
          "args": [
            "&new->thread"
          ],
          "line": 1050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MSR_TM_ACTIVE",
          "args": [
            "new->thread.regs->msr"
          ],
          "line": 1049
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tm_enabled",
          "args": [
            "new"
          ],
          "line": 1046
        },
        "resolved": true,
        "details": {
          "function_name": "tm_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "910-913",
          "snippet": "static inline bool tm_enabled(struct task_struct *tsk)\n{\n\treturn tsk && tsk->thread.regs && (tsk->thread.regs->msr & MSR_TM);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline bool tm_enabled(struct task_struct *tsk)\n{\n\treturn tsk && tsk->thread.regs && (tsk->thread.regs->msr & MSR_TM);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_TM"
          ],
          "line": 1035
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void tm_recheckpoint_new_task(struct task_struct *new)\n{\n\tif (!cpu_has_feature(CPU_FTR_TM))\n\t\treturn;\n\n\t/* Recheckpoint the registers of the thread we're about to switch to.\n\t *\n\t * If the task was using FP, we non-lazily reload both the original and\n\t * the speculative FP register states.  This is because the kernel\n\t * doesn't see if/when a TM rollback occurs, so if we take an FP\n\t * unavailable later, we are unable to determine which set of FP regs\n\t * need to be restored.\n\t */\n\tif (!tm_enabled(new))\n\t\treturn;\n\n\tif (!MSR_TM_ACTIVE(new->thread.regs->msr)){\n\t\ttm_restore_sprs(&new->thread);\n\t\treturn;\n\t}\n\t/* Recheckpoint to restore original checkpointed register state. */\n\tTM_DEBUG(\"*** tm_recheckpoint of pid %d (new->msr 0x%lx)\\n\",\n\t\t new->pid, new->thread.regs->msr);\n\n\ttm_recheckpoint(&new->thread);\n\n\t/*\n\t * The checkpointed state has been restored but the live state has\n\t * not, ensure all the math functionality is turned off to trigger\n\t * restore_math() to reload.\n\t */\n\tnew->thread.regs->msr &= ~(MSR_FP | MSR_VEC | MSR_VSX);\n\n\tTM_DEBUG(\"*** tm_recheckpoint of pid %d complete \"\n\t\t \"(kernel msr 0x%lx)\\n\",\n\t\t new->pid, mfmsr());\n}"
  },
  {
    "function_name": "tm_recheckpoint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "1009-1031",
    "snippet": "void tm_recheckpoint(struct thread_struct *thread)\n{\n\tunsigned long flags;\n\n\tif (!(thread->regs->msr & MSR_TM))\n\t\treturn;\n\n\t/* We really can't be interrupted here as the TEXASR registers can't\n\t * change and later in the trecheckpoint code, we have a userspace R1.\n\t * So let's hard disable over this region.\n\t */\n\tlocal_irq_save(flags);\n\thard_irq_disable();\n\n\t/* The TM SPRs are restored here, so that TEXASR.FS can be set\n\t * before the trecheckpoint and no explosion occurs.\n\t */\n\ttm_restore_sprs(thread);\n\n\t__tm_recheckpoint(thread);\n\n\tlocal_irq_restore(flags);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 1030
        },
        "resolved": true,
        "details": {
          "function_name": "arch_local_irq_restore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/irq.c",
          "lines": "314-383",
          "snippet": "notrace void arch_local_irq_restore(unsigned long mask)\n{\n\tunsigned char irq_happened;\n\n\t/* Write the new soft-enabled value */\n\tirq_soft_mask_set(mask);\n\tif (mask)\n\t\treturn;\n\n\t/*\n\t * From this point onward, we can take interrupts, preempt,\n\t * etc... unless we got hard-disabled. We check if an event\n\t * happened. If none happened, we know we can just return.\n\t *\n\t * We may have preempted before the check below, in which case\n\t * we are checking the \"new\" CPU instead of the old one. This\n\t * is only a problem if an event happened on the \"old\" CPU.\n\t *\n\t * External interrupt events will have caused interrupts to\n\t * be hard-disabled, so there is no problem, we\n\t * cannot have preempted.\n\t */\n\tirq_happened = get_irq_happened();\n\tif (!irq_happened) {\n\t\tif (IS_ENABLED(CONFIG_PPC_IRQ_SOFT_MASK_DEBUG))\n\t\t\tWARN_ON_ONCE(!(mfmsr() & MSR_EE));\n\t\treturn;\n\t}\n\n\t/* We need to hard disable to replay. */\n\tif (!(irq_happened & PACA_IRQ_HARD_DIS)) {\n\t\tif (IS_ENABLED(CONFIG_PPC_IRQ_SOFT_MASK_DEBUG))\n\t\t\tWARN_ON_ONCE(!(mfmsr() & MSR_EE));\n\t\t__hard_irq_disable();\n\t} else {\n\t\t/*\n\t\t * We should already be hard disabled here. We had bugs\n\t\t * where that wasn't the case so let's dbl check it and\n\t\t * warn if we are wrong. Only do that when IRQ tracing\n\t\t * is enabled as mfmsr() can be costly.\n\t\t */\n\t\tif (IS_ENABLED(CONFIG_PPC_IRQ_SOFT_MASK_DEBUG)) {\n\t\t\tif (WARN_ON_ONCE(mfmsr() & MSR_EE))\n\t\t\t\t__hard_irq_disable();\n\t\t}\n\n\t\tif (irq_happened == PACA_IRQ_HARD_DIS) {\n\t\t\tlocal_paca->irq_happened = 0;\n\t\t\t__hard_irq_enable();\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/*\n\t * Disable preempt here, so that the below preempt_enable will\n\t * perform resched if required (a replayed interrupt may set\n\t * need_resched).\n\t */\n\tpreempt_disable();\n\tirq_soft_mask_set(IRQS_ALL_DISABLED);\n\ttrace_hardirqs_off();\n\n\treplay_soft_interrupts();\n\tlocal_paca->irq_happened = 0;\n\n\ttrace_hardirqs_on();\n\tirq_soft_mask_set(IRQS_ENABLED);\n\t__hard_irq_enable();\n\tpreempt_enable();\n}",
          "includes": [
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/trace.h>",
            "#include <asm/dbell.h>",
            "#include <asm/lv1call.h>",
            "#include <asm/firmware.h>",
            "#include <asm/paca.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/smp.h>",
            "#include <asm/udbg.h>",
            "#include <asm/machdep.h>",
            "#include <asm/ptrace.h>",
            "#include <asm/prom.h>",
            "#include <asm/cache.h>",
            "#include <asm/irq.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/pci.h>",
            "#include <linux/mutex.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/list.h>",
            "#include <linux/bitops.h>",
            "#include <linux/profile.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/irq.h>",
            "#include <linux/delay.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/ioport.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/sched.h>",
            "#include <linux/signal.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/threads.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cpu_has_feature.h>\n#include <asm/trace.h>\n#include <asm/dbell.h>\n#include <asm/lv1call.h>\n#include <asm/firmware.h>\n#include <asm/paca.h>\n#include <asm/hw_irq.h>\n#include <asm/asm-prototypes.h>\n#include <asm/livepatch.h>\n#include <asm/smp.h>\n#include <asm/udbg.h>\n#include <asm/machdep.h>\n#include <asm/ptrace.h>\n#include <asm/prom.h>\n#include <asm/cache.h>\n#include <asm/irq.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <linux/pgtable.h>\n#include <linux/vmalloc.h>\n#include <linux/of_irq.h>\n#include <linux/of.h>\n#include <linux/debugfs.h>\n#include <linux/pci.h>\n#include <linux/mutex.h>\n#include <linux/radix-tree.h>\n#include <linux/list.h>\n#include <linux/bitops.h>\n#include <linux/profile.h>\n#include <linux/cpumask.h>\n#include <linux/seq_file.h>\n#include <linux/irq.h>\n#include <linux/delay.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/ioport.h>\n#include <linux/ptrace.h>\n#include <linux/sched.h>\n#include <linux/signal.h>\n#include <linux/kernel_stat.h>\n#include <linux/threads.h>\n#include <linux/export.h>\n\nnotrace void arch_local_irq_restore(unsigned long mask)\n{\n\tunsigned char irq_happened;\n\n\t/* Write the new soft-enabled value */\n\tirq_soft_mask_set(mask);\n\tif (mask)\n\t\treturn;\n\n\t/*\n\t * From this point onward, we can take interrupts, preempt,\n\t * etc... unless we got hard-disabled. We check if an event\n\t * happened. If none happened, we know we can just return.\n\t *\n\t * We may have preempted before the check below, in which case\n\t * we are checking the \"new\" CPU instead of the old one. This\n\t * is only a problem if an event happened on the \"old\" CPU.\n\t *\n\t * External interrupt events will have caused interrupts to\n\t * be hard-disabled, so there is no problem, we\n\t * cannot have preempted.\n\t */\n\tirq_happened = get_irq_happened();\n\tif (!irq_happened) {\n\t\tif (IS_ENABLED(CONFIG_PPC_IRQ_SOFT_MASK_DEBUG))\n\t\t\tWARN_ON_ONCE(!(mfmsr() & MSR_EE));\n\t\treturn;\n\t}\n\n\t/* We need to hard disable to replay. */\n\tif (!(irq_happened & PACA_IRQ_HARD_DIS)) {\n\t\tif (IS_ENABLED(CONFIG_PPC_IRQ_SOFT_MASK_DEBUG))\n\t\t\tWARN_ON_ONCE(!(mfmsr() & MSR_EE));\n\t\t__hard_irq_disable();\n\t} else {\n\t\t/*\n\t\t * We should already be hard disabled here. We had bugs\n\t\t * where that wasn't the case so let's dbl check it and\n\t\t * warn if we are wrong. Only do that when IRQ tracing\n\t\t * is enabled as mfmsr() can be costly.\n\t\t */\n\t\tif (IS_ENABLED(CONFIG_PPC_IRQ_SOFT_MASK_DEBUG)) {\n\t\t\tif (WARN_ON_ONCE(mfmsr() & MSR_EE))\n\t\t\t\t__hard_irq_disable();\n\t\t}\n\n\t\tif (irq_happened == PACA_IRQ_HARD_DIS) {\n\t\t\tlocal_paca->irq_happened = 0;\n\t\t\t__hard_irq_enable();\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/*\n\t * Disable preempt here, so that the below preempt_enable will\n\t * perform resched if required (a replayed interrupt may set\n\t * need_resched).\n\t */\n\tpreempt_disable();\n\tirq_soft_mask_set(IRQS_ALL_DISABLED);\n\ttrace_hardirqs_off();\n\n\treplay_soft_interrupts();\n\tlocal_paca->irq_happened = 0;\n\n\ttrace_hardirqs_on();\n\tirq_soft_mask_set(IRQS_ENABLED);\n\t__hard_irq_enable();\n\tpreempt_enable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "__tm_recheckpoint",
          "args": [
            "thread"
          ],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tm_restore_sprs",
          "args": [
            "thread"
          ],
          "line": 1026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hard_irq_disable",
          "args": [],
          "line": 1021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_save",
          "args": [
            "flags"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid tm_recheckpoint(struct thread_struct *thread)\n{\n\tunsigned long flags;\n\n\tif (!(thread->regs->msr & MSR_TM))\n\t\treturn;\n\n\t/* We really can't be interrupted here as the TEXASR registers can't\n\t * change and later in the trecheckpoint code, we have a userspace R1.\n\t * So let's hard disable over this region.\n\t */\n\tlocal_irq_save(flags);\n\thard_irq_disable();\n\n\t/* The TM SPRs are restored here, so that TEXASR.FS can be set\n\t * before the trecheckpoint and no explosion occurs.\n\t */\n\ttm_restore_sprs(thread);\n\n\t__tm_recheckpoint(thread);\n\n\tlocal_irq_restore(flags);\n}"
  },
  {
    "function_name": "tm_reclaim_task",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "965-1005",
    "snippet": "static inline void tm_reclaim_task(struct task_struct *tsk)\n{\n\t/* We have to work out if we're switching from/to a task that's in the\n\t * middle of a transaction.\n\t *\n\t * In switching we need to maintain a 2nd register state as\n\t * oldtask->thread.ckpt_regs.  We tm_reclaim(oldproc); this saves the\n\t * checkpointed (tbegin) state in ckpt_regs, ckfp_state and\n\t * ckvr_state\n\t *\n\t * We also context switch (save) TFHAR/TEXASR/TFIAR in here.\n\t */\n\tstruct thread_struct *thr = &tsk->thread;\n\n\tif (!thr->regs)\n\t\treturn;\n\n\tif (!MSR_TM_ACTIVE(thr->regs->msr))\n\t\tgoto out_and_saveregs;\n\n\tWARN_ON(tm_suspend_disabled);\n\n\tTM_DEBUG(\"--- tm_reclaim on pid %d (NIP=%lx, \"\n\t\t \"ccr=%lx, msr=%lx, trap=%lx)\\n\",\n\t\t tsk->pid, thr->regs->nip,\n\t\t thr->regs->ccr, thr->regs->msr,\n\t\t thr->regs->trap);\n\n\ttm_reclaim_thread(thr, TM_CAUSE_RESCHED);\n\n\tTM_DEBUG(\"--- tm_reclaim on pid %d complete\\n\",\n\t\t tsk->pid);\n\nout_and_saveregs:\n\t/* Always save the regs here, even if a transaction's not active.\n\t * This context-switches a thread's TM info SPRs.  We do it here to\n\t * be consistent with the restore path (in recheckpoint) which\n\t * cannot happen later in _switch().\n\t */\n\ttm_save_sprs(thr);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tm_save_sprs",
          "args": [
            "thr"
          ],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TM_DEBUG",
          "args": [
            "\"--- tm_reclaim on pid %d complete\\n\"",
            "tsk->pid"
          ],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tm_reclaim_thread",
          "args": [
            "thr",
            "TM_CAUSE_RESCHED"
          ],
          "line": 993
        },
        "resolved": true,
        "details": {
          "function_name": "tm_reclaim_thread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "915-957",
          "snippet": "static void tm_reclaim_thread(struct thread_struct *thr, uint8_t cause)\n{\n\t/*\n\t * Use the current MSR TM suspended bit to track if we have\n\t * checkpointed state outstanding.\n\t * On signal delivery, we'd normally reclaim the checkpointed\n\t * state to obtain stack pointer (see:get_tm_stackpointer()).\n\t * This will then directly return to userspace without going\n\t * through __switch_to(). However, if the stack frame is bad,\n\t * we need to exit this thread which calls __switch_to() which\n\t * will again attempt to reclaim the already saved tm state.\n\t * Hence we need to check that we've not already reclaimed\n\t * this state.\n\t * We do this using the current MSR, rather tracking it in\n\t * some specific thread_struct bit, as it has the additional\n\t * benefit of checking for a potential TM bad thing exception.\n\t */\n\tif (!MSR_TM_SUSPENDED(mfmsr()))\n\t\treturn;\n\n\tgiveup_all(container_of(thr, struct task_struct, thread));\n\n\ttm_reclaim(thr, cause);\n\n\t/*\n\t * If we are in a transaction and FP is off then we can't have\n\t * used FP inside that transaction. Hence the checkpointed\n\t * state is the same as the live state. We need to copy the\n\t * live state to the checkpointed state so that when the\n\t * transaction is restored, the checkpointed state is correct\n\t * and the aborted transaction sees the correct state. We use\n\t * ckpt_regs.msr here as that's what tm_reclaim will use to\n\t * determine if it's going to write the checkpointed state or\n\t * not. So either this will write the checkpointed registers,\n\t * or reclaim will. Similarly for VMX.\n\t */\n\tif ((thr->ckpt_regs.msr & MSR_FP) == 0)\n\t\tmemcpy(&thr->ckfp_state, &thr->fp_state,\n\t\t       sizeof(struct thread_fp_state));\n\tif ((thr->ckpt_regs.msr & MSR_VEC) == 0)\n\t\tmemcpy(&thr->ckvr_state, &thr->vr_state,\n\t\t       sizeof(struct thread_vr_state));\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void tm_reclaim_thread(struct thread_struct *thr, uint8_t cause)\n{\n\t/*\n\t * Use the current MSR TM suspended bit to track if we have\n\t * checkpointed state outstanding.\n\t * On signal delivery, we'd normally reclaim the checkpointed\n\t * state to obtain stack pointer (see:get_tm_stackpointer()).\n\t * This will then directly return to userspace without going\n\t * through __switch_to(). However, if the stack frame is bad,\n\t * we need to exit this thread which calls __switch_to() which\n\t * will again attempt to reclaim the already saved tm state.\n\t * Hence we need to check that we've not already reclaimed\n\t * this state.\n\t * We do this using the current MSR, rather tracking it in\n\t * some specific thread_struct bit, as it has the additional\n\t * benefit of checking for a potential TM bad thing exception.\n\t */\n\tif (!MSR_TM_SUSPENDED(mfmsr()))\n\t\treturn;\n\n\tgiveup_all(container_of(thr, struct task_struct, thread));\n\n\ttm_reclaim(thr, cause);\n\n\t/*\n\t * If we are in a transaction and FP is off then we can't have\n\t * used FP inside that transaction. Hence the checkpointed\n\t * state is the same as the live state. We need to copy the\n\t * live state to the checkpointed state so that when the\n\t * transaction is restored, the checkpointed state is correct\n\t * and the aborted transaction sees the correct state. We use\n\t * ckpt_regs.msr here as that's what tm_reclaim will use to\n\t * determine if it's going to write the checkpointed state or\n\t * not. So either this will write the checkpointed registers,\n\t * or reclaim will. Similarly for VMX.\n\t */\n\tif ((thr->ckpt_regs.msr & MSR_FP) == 0)\n\t\tmemcpy(&thr->ckfp_state, &thr->fp_state,\n\t\t       sizeof(struct thread_fp_state));\n\tif ((thr->ckpt_regs.msr & MSR_VEC) == 0)\n\t\tmemcpy(&thr->ckvr_state, &thr->vr_state,\n\t\t       sizeof(struct thread_vr_state));\n}"
        }
      },
      {
        "call_info": {
          "callee": "TM_DEBUG",
          "args": [
            "\"--- tm_reclaim on pid %d (NIP=%lx, \"\n\t\t \"ccr=%lx, msr=%lx, trap=%lx)\\n\"",
            "tsk->pid",
            "thr->regs->nip",
            "thr->regs->ccr",
            "thr->regs->msr",
            "thr->regs->trap"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "tm_suspend_disabled"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MSR_TM_ACTIVE",
          "args": [
            "thr->regs->msr"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void tm_reclaim_task(struct task_struct *tsk)\n{\n\t/* We have to work out if we're switching from/to a task that's in the\n\t * middle of a transaction.\n\t *\n\t * In switching we need to maintain a 2nd register state as\n\t * oldtask->thread.ckpt_regs.  We tm_reclaim(oldproc); this saves the\n\t * checkpointed (tbegin) state in ckpt_regs, ckfp_state and\n\t * ckvr_state\n\t *\n\t * We also context switch (save) TFHAR/TEXASR/TFIAR in here.\n\t */\n\tstruct thread_struct *thr = &tsk->thread;\n\n\tif (!thr->regs)\n\t\treturn;\n\n\tif (!MSR_TM_ACTIVE(thr->regs->msr))\n\t\tgoto out_and_saveregs;\n\n\tWARN_ON(tm_suspend_disabled);\n\n\tTM_DEBUG(\"--- tm_reclaim on pid %d (NIP=%lx, \"\n\t\t \"ccr=%lx, msr=%lx, trap=%lx)\\n\",\n\t\t tsk->pid, thr->regs->nip,\n\t\t thr->regs->ccr, thr->regs->msr,\n\t\t thr->regs->trap);\n\n\ttm_reclaim_thread(thr, TM_CAUSE_RESCHED);\n\n\tTM_DEBUG(\"--- tm_reclaim on pid %d complete\\n\",\n\t\t tsk->pid);\n\nout_and_saveregs:\n\t/* Always save the regs here, even if a transaction's not active.\n\t * This context-switches a thread's TM info SPRs.  We do it here to\n\t * be consistent with the restore path (in recheckpoint) which\n\t * cannot happen later in _switch().\n\t */\n\ttm_save_sprs(thr);\n}"
  },
  {
    "function_name": "tm_reclaim_current",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "959-963",
    "snippet": "void tm_reclaim_current(uint8_t cause)\n{\n\ttm_enable();\n\ttm_reclaim_thread(&current->thread, cause);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tm_reclaim_thread",
          "args": [
            "&current->thread",
            "cause"
          ],
          "line": 962
        },
        "resolved": true,
        "details": {
          "function_name": "tm_reclaim_thread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "915-957",
          "snippet": "static void tm_reclaim_thread(struct thread_struct *thr, uint8_t cause)\n{\n\t/*\n\t * Use the current MSR TM suspended bit to track if we have\n\t * checkpointed state outstanding.\n\t * On signal delivery, we'd normally reclaim the checkpointed\n\t * state to obtain stack pointer (see:get_tm_stackpointer()).\n\t * This will then directly return to userspace without going\n\t * through __switch_to(). However, if the stack frame is bad,\n\t * we need to exit this thread which calls __switch_to() which\n\t * will again attempt to reclaim the already saved tm state.\n\t * Hence we need to check that we've not already reclaimed\n\t * this state.\n\t * We do this using the current MSR, rather tracking it in\n\t * some specific thread_struct bit, as it has the additional\n\t * benefit of checking for a potential TM bad thing exception.\n\t */\n\tif (!MSR_TM_SUSPENDED(mfmsr()))\n\t\treturn;\n\n\tgiveup_all(container_of(thr, struct task_struct, thread));\n\n\ttm_reclaim(thr, cause);\n\n\t/*\n\t * If we are in a transaction and FP is off then we can't have\n\t * used FP inside that transaction. Hence the checkpointed\n\t * state is the same as the live state. We need to copy the\n\t * live state to the checkpointed state so that when the\n\t * transaction is restored, the checkpointed state is correct\n\t * and the aborted transaction sees the correct state. We use\n\t * ckpt_regs.msr here as that's what tm_reclaim will use to\n\t * determine if it's going to write the checkpointed state or\n\t * not. So either this will write the checkpointed registers,\n\t * or reclaim will. Similarly for VMX.\n\t */\n\tif ((thr->ckpt_regs.msr & MSR_FP) == 0)\n\t\tmemcpy(&thr->ckfp_state, &thr->fp_state,\n\t\t       sizeof(struct thread_fp_state));\n\tif ((thr->ckpt_regs.msr & MSR_VEC) == 0)\n\t\tmemcpy(&thr->ckvr_state, &thr->vr_state,\n\t\t       sizeof(struct thread_vr_state));\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void tm_reclaim_thread(struct thread_struct *thr, uint8_t cause)\n{\n\t/*\n\t * Use the current MSR TM suspended bit to track if we have\n\t * checkpointed state outstanding.\n\t * On signal delivery, we'd normally reclaim the checkpointed\n\t * state to obtain stack pointer (see:get_tm_stackpointer()).\n\t * This will then directly return to userspace without going\n\t * through __switch_to(). However, if the stack frame is bad,\n\t * we need to exit this thread which calls __switch_to() which\n\t * will again attempt to reclaim the already saved tm state.\n\t * Hence we need to check that we've not already reclaimed\n\t * this state.\n\t * We do this using the current MSR, rather tracking it in\n\t * some specific thread_struct bit, as it has the additional\n\t * benefit of checking for a potential TM bad thing exception.\n\t */\n\tif (!MSR_TM_SUSPENDED(mfmsr()))\n\t\treturn;\n\n\tgiveup_all(container_of(thr, struct task_struct, thread));\n\n\ttm_reclaim(thr, cause);\n\n\t/*\n\t * If we are in a transaction and FP is off then we can't have\n\t * used FP inside that transaction. Hence the checkpointed\n\t * state is the same as the live state. We need to copy the\n\t * live state to the checkpointed state so that when the\n\t * transaction is restored, the checkpointed state is correct\n\t * and the aborted transaction sees the correct state. We use\n\t * ckpt_regs.msr here as that's what tm_reclaim will use to\n\t * determine if it's going to write the checkpointed state or\n\t * not. So either this will write the checkpointed registers,\n\t * or reclaim will. Similarly for VMX.\n\t */\n\tif ((thr->ckpt_regs.msr & MSR_FP) == 0)\n\t\tmemcpy(&thr->ckfp_state, &thr->fp_state,\n\t\t       sizeof(struct thread_fp_state));\n\tif ((thr->ckpt_regs.msr & MSR_VEC) == 0)\n\t\tmemcpy(&thr->ckvr_state, &thr->vr_state,\n\t\t       sizeof(struct thread_vr_state));\n}"
        }
      },
      {
        "call_info": {
          "callee": "tm_enable",
          "args": [],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid tm_reclaim_current(uint8_t cause)\n{\n\ttm_enable();\n\ttm_reclaim_thread(&current->thread, cause);\n}"
  },
  {
    "function_name": "tm_reclaim_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "915-957",
    "snippet": "static void tm_reclaim_thread(struct thread_struct *thr, uint8_t cause)\n{\n\t/*\n\t * Use the current MSR TM suspended bit to track if we have\n\t * checkpointed state outstanding.\n\t * On signal delivery, we'd normally reclaim the checkpointed\n\t * state to obtain stack pointer (see:get_tm_stackpointer()).\n\t * This will then directly return to userspace without going\n\t * through __switch_to(). However, if the stack frame is bad,\n\t * we need to exit this thread which calls __switch_to() which\n\t * will again attempt to reclaim the already saved tm state.\n\t * Hence we need to check that we've not already reclaimed\n\t * this state.\n\t * We do this using the current MSR, rather tracking it in\n\t * some specific thread_struct bit, as it has the additional\n\t * benefit of checking for a potential TM bad thing exception.\n\t */\n\tif (!MSR_TM_SUSPENDED(mfmsr()))\n\t\treturn;\n\n\tgiveup_all(container_of(thr, struct task_struct, thread));\n\n\ttm_reclaim(thr, cause);\n\n\t/*\n\t * If we are in a transaction and FP is off then we can't have\n\t * used FP inside that transaction. Hence the checkpointed\n\t * state is the same as the live state. We need to copy the\n\t * live state to the checkpointed state so that when the\n\t * transaction is restored, the checkpointed state is correct\n\t * and the aborted transaction sees the correct state. We use\n\t * ckpt_regs.msr here as that's what tm_reclaim will use to\n\t * determine if it's going to write the checkpointed state or\n\t * not. So either this will write the checkpointed registers,\n\t * or reclaim will. Similarly for VMX.\n\t */\n\tif ((thr->ckpt_regs.msr & MSR_FP) == 0)\n\t\tmemcpy(&thr->ckfp_state, &thr->fp_state,\n\t\t       sizeof(struct thread_fp_state));\n\tif ((thr->ckpt_regs.msr & MSR_VEC) == 0)\n\t\tmemcpy(&thr->ckvr_state, &thr->vr_state,\n\t\t       sizeof(struct thread_vr_state));\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&thr->ckvr_state",
            "&thr->vr_state",
            "sizeof(struct thread_vr_state)"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "_memcpy_toio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "181-205",
          "snippet": "void _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "tm_reclaim",
          "args": [
            "thr",
            "cause"
          ],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "tm_reclaim_thread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "915-957",
          "snippet": "static void tm_reclaim_thread(struct thread_struct *thr, uint8_t cause)\n{\n\t/*\n\t * Use the current MSR TM suspended bit to track if we have\n\t * checkpointed state outstanding.\n\t * On signal delivery, we'd normally reclaim the checkpointed\n\t * state to obtain stack pointer (see:get_tm_stackpointer()).\n\t * This will then directly return to userspace without going\n\t * through __switch_to(). However, if the stack frame is bad,\n\t * we need to exit this thread which calls __switch_to() which\n\t * will again attempt to reclaim the already saved tm state.\n\t * Hence we need to check that we've not already reclaimed\n\t * this state.\n\t * We do this using the current MSR, rather tracking it in\n\t * some specific thread_struct bit, as it has the additional\n\t * benefit of checking for a potential TM bad thing exception.\n\t */\n\tif (!MSR_TM_SUSPENDED(mfmsr()))\n\t\treturn;\n\n\tgiveup_all(container_of(thr, struct task_struct, thread));\n\n\ttm_reclaim(thr, cause);\n\n\t/*\n\t * If we are in a transaction and FP is off then we can't have\n\t * used FP inside that transaction. Hence the checkpointed\n\t * state is the same as the live state. We need to copy the\n\t * live state to the checkpointed state so that when the\n\t * transaction is restored, the checkpointed state is correct\n\t * and the aborted transaction sees the correct state. We use\n\t * ckpt_regs.msr here as that's what tm_reclaim will use to\n\t * determine if it's going to write the checkpointed state or\n\t * not. So either this will write the checkpointed registers,\n\t * or reclaim will. Similarly for VMX.\n\t */\n\tif ((thr->ckpt_regs.msr & MSR_FP) == 0)\n\t\tmemcpy(&thr->ckfp_state, &thr->fp_state,\n\t\t       sizeof(struct thread_fp_state));\n\tif ((thr->ckpt_regs.msr & MSR_VEC) == 0)\n\t\tmemcpy(&thr->ckvr_state, &thr->vr_state,\n\t\t       sizeof(struct thread_vr_state));\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "MSR_TM_SUSPENDED",
          "args": [
            "mfmsr()"
          ],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfmsr",
          "args": [],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void tm_reclaim_thread(struct thread_struct *thr, uint8_t cause)\n{\n\t/*\n\t * Use the current MSR TM suspended bit to track if we have\n\t * checkpointed state outstanding.\n\t * On signal delivery, we'd normally reclaim the checkpointed\n\t * state to obtain stack pointer (see:get_tm_stackpointer()).\n\t * This will then directly return to userspace without going\n\t * through __switch_to(). However, if the stack frame is bad,\n\t * we need to exit this thread which calls __switch_to() which\n\t * will again attempt to reclaim the already saved tm state.\n\t * Hence we need to check that we've not already reclaimed\n\t * this state.\n\t * We do this using the current MSR, rather tracking it in\n\t * some specific thread_struct bit, as it has the additional\n\t * benefit of checking for a potential TM bad thing exception.\n\t */\n\tif (!MSR_TM_SUSPENDED(mfmsr()))\n\t\treturn;\n\n\tgiveup_all(container_of(thr, struct task_struct, thread));\n\n\ttm_reclaim(thr, cause);\n\n\t/*\n\t * If we are in a transaction and FP is off then we can't have\n\t * used FP inside that transaction. Hence the checkpointed\n\t * state is the same as the live state. We need to copy the\n\t * live state to the checkpointed state so that when the\n\t * transaction is restored, the checkpointed state is correct\n\t * and the aborted transaction sees the correct state. We use\n\t * ckpt_regs.msr here as that's what tm_reclaim will use to\n\t * determine if it's going to write the checkpointed state or\n\t * not. So either this will write the checkpointed registers,\n\t * or reclaim will. Similarly for VMX.\n\t */\n\tif ((thr->ckpt_regs.msr & MSR_FP) == 0)\n\t\tmemcpy(&thr->ckfp_state, &thr->fp_state,\n\t\t       sizeof(struct thread_fp_state));\n\tif ((thr->ckpt_regs.msr & MSR_VEC) == 0)\n\t\tmemcpy(&thr->ckvr_state, &thr->vr_state,\n\t\t       sizeof(struct thread_vr_state));\n}"
  },
  {
    "function_name": "tm_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "910-913",
    "snippet": "static inline bool tm_enabled(struct task_struct *tsk)\n{\n\treturn tsk && tsk->thread.regs && (tsk->thread.regs->msr & MSR_TM);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline bool tm_enabled(struct task_struct *tsk)\n{\n\treturn tsk && tsk->thread.regs && (tsk->thread.regs->msr & MSR_TM);\n}"
  },
  {
    "function_name": "ppc_breakpoint_available",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "897-905",
    "snippet": "bool ppc_breakpoint_available(void)\n{\n\tif (dawr_enabled())\n\t\treturn true; /* POWER8 DAWR or POWER9 forced DAWR */\n\tif (cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\treturn false; /* POWER9 with DAWR disabled */\n\t/* DABR: Everything but POWER8 and POWER9 */\n\treturn true;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_207S"
          ],
          "line": 901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dawr_enabled",
          "args": [],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nbool ppc_breakpoint_available(void)\n{\n\tif (dawr_enabled())\n\t\treturn true; /* POWER8 DAWR or POWER9 forced DAWR */\n\tif (cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\treturn false; /* POWER9 with DAWR disabled */\n\t/* DABR: Everything but POWER8 and POWER9 */\n\treturn true;\n}"
  },
  {
    "function_name": "__set_breakpoint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "879-894",
    "snippet": "void __set_breakpoint(int nr, struct arch_hw_breakpoint *brk)\n{\n\tmemcpy(this_cpu_ptr(&current_brk[nr]), brk, sizeof(*brk));\n\n\tif (dawr_enabled())\n\t\t// Power8 or later\n\t\tset_dawr(nr, brk);\n\telse if (IS_ENABLED(CONFIG_PPC_8xx))\n\t\tset_breakpoint_8xx(brk);\n\telse if (!cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\t// Power7 or earlier\n\t\tset_dabr(brk);\n\telse\n\t\t// Shouldn't happen due to higher level checks\n\t\tWARN_ON_ONCE(1);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dabr",
          "args": [
            "brk"
          ],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "set_dabr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "833-844",
          "snippet": "static inline int set_dabr(struct arch_hw_breakpoint *brk)\n{\n\tunsigned long dabr, dabrx;\n\n\tdabr = brk->address | (brk->type & HW_BRK_TYPE_DABR);\n\tdabrx = ((brk->type >> 3) & 0x7);\n\n\tif (ppc_md.set_dabr)\n\t\treturn ppc_md.set_dabr(dabr, dabrx);\n\n\treturn __set_dabr(dabr, dabrx);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int set_dabr(struct arch_hw_breakpoint *brk)\n{\n\tunsigned long dabr, dabrx;\n\n\tdabr = brk->address | (brk->type & HW_BRK_TYPE_DABR);\n\tdabrx = ((brk->type >> 3) & 0x7);\n\n\tif (ppc_md.set_dabr)\n\t\treturn ppc_md.set_dabr(dabr, dabrx);\n\n\treturn __set_dabr(dabr, dabrx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_207S"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_breakpoint_8xx",
          "args": [
            "brk"
          ],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "set_breakpoint_8xx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "846-877",
          "snippet": "static inline int set_breakpoint_8xx(struct arch_hw_breakpoint *brk)\n{\n\tunsigned long lctrl1 = LCTRL1_CTE_GT | LCTRL1_CTF_LT | LCTRL1_CRWE_RW |\n\t\t\t       LCTRL1_CRWF_RW;\n\tunsigned long lctrl2 = LCTRL2_LW0EN | LCTRL2_LW0LADC | LCTRL2_SLW0EN;\n\tunsigned long start_addr = ALIGN_DOWN(brk->address, HW_BREAKPOINT_SIZE);\n\tunsigned long end_addr = ALIGN(brk->address + brk->len, HW_BREAKPOINT_SIZE);\n\n\tif (start_addr == 0)\n\t\tlctrl2 |= LCTRL2_LW0LA_F;\n\telse if (end_addr == 0)\n\t\tlctrl2 |= LCTRL2_LW0LA_E;\n\telse\n\t\tlctrl2 |= LCTRL2_LW0LA_EandF;\n\n\tmtspr(SPRN_LCTRL2, 0);\n\n\tif ((brk->type & HW_BRK_TYPE_RDWR) == 0)\n\t\treturn 0;\n\n\tif ((brk->type & HW_BRK_TYPE_RDWR) == HW_BRK_TYPE_READ)\n\t\tlctrl1 |= LCTRL1_CRWE_RO | LCTRL1_CRWF_RO;\n\tif ((brk->type & HW_BRK_TYPE_RDWR) == HW_BRK_TYPE_WRITE)\n\t\tlctrl1 |= LCTRL1_CRWE_WO | LCTRL1_CRWF_WO;\n\n\tmtspr(SPRN_CMPE, start_addr - 1);\n\tmtspr(SPRN_CMPF, end_addr);\n\tmtspr(SPRN_LCTRL1, lctrl1);\n\tmtspr(SPRN_LCTRL2, lctrl2);\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int set_breakpoint_8xx(struct arch_hw_breakpoint *brk)\n{\n\tunsigned long lctrl1 = LCTRL1_CTE_GT | LCTRL1_CTF_LT | LCTRL1_CRWE_RW |\n\t\t\t       LCTRL1_CRWF_RW;\n\tunsigned long lctrl2 = LCTRL2_LW0EN | LCTRL2_LW0LADC | LCTRL2_SLW0EN;\n\tunsigned long start_addr = ALIGN_DOWN(brk->address, HW_BREAKPOINT_SIZE);\n\tunsigned long end_addr = ALIGN(brk->address + brk->len, HW_BREAKPOINT_SIZE);\n\n\tif (start_addr == 0)\n\t\tlctrl2 |= LCTRL2_LW0LA_F;\n\telse if (end_addr == 0)\n\t\tlctrl2 |= LCTRL2_LW0LA_E;\n\telse\n\t\tlctrl2 |= LCTRL2_LW0LA_EandF;\n\n\tmtspr(SPRN_LCTRL2, 0);\n\n\tif ((brk->type & HW_BRK_TYPE_RDWR) == 0)\n\t\treturn 0;\n\n\tif ((brk->type & HW_BRK_TYPE_RDWR) == HW_BRK_TYPE_READ)\n\t\tlctrl1 |= LCTRL1_CRWE_RO | LCTRL1_CRWF_RO;\n\tif ((brk->type & HW_BRK_TYPE_RDWR) == HW_BRK_TYPE_WRITE)\n\t\tlctrl1 |= LCTRL1_CRWE_WO | LCTRL1_CRWF_WO;\n\n\tmtspr(SPRN_CMPE, start_addr - 1);\n\tmtspr(SPRN_CMPF, end_addr);\n\tmtspr(SPRN_LCTRL1, lctrl1);\n\tmtspr(SPRN_LCTRL2, lctrl2);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC_8xx"
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dawr",
          "args": [
            "nr",
            "brk"
          ],
          "line": 885
        },
        "resolved": true,
        "details": {
          "function_name": "set_dawr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dawr.c",
          "lines": "19-51",
          "snippet": "int set_dawr(int nr, struct arch_hw_breakpoint *brk)\n{\n\tunsigned long dawr, dawrx, mrd;\n\n\tdawr = brk->address;\n\n\tdawrx  = (brk->type & (HW_BRK_TYPE_READ | HW_BRK_TYPE_WRITE))\n\t\t<< (63 - 58);\n\tdawrx |= ((brk->type & (HW_BRK_TYPE_TRANSLATE)) >> 2) << (63 - 59);\n\tdawrx |= (brk->type & (HW_BRK_TYPE_PRIV_ALL)) >> 3;\n\t/*\n\t * DAWR length is stored in field MDR bits 48:53.  Matches range in\n\t * doublewords (64 bits) baised by -1 eg. 0b000000=1DW and\n\t * 0b111111=64DW.\n\t * brk->hw_len is in bytes.\n\t * This aligns up to double word size, shifts and does the bias.\n\t */\n\tmrd = ((brk->hw_len + 7) >> 3) - 1;\n\tdawrx |= (mrd & 0x3f) << (63 - 53);\n\n\tif (ppc_md.set_dawr)\n\t\treturn ppc_md.set_dawr(nr, dawr, dawrx);\n\n\tif (nr == 0) {\n\t\tmtspr(SPRN_DAWR0, dawr);\n\t\tmtspr(SPRN_DAWRX0, dawrx);\n\t} else {\n\t\tmtspr(SPRN_DAWR1, dawr);\n\t\tmtspr(SPRN_DAWRX1, dawrx);\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <asm/hvcall.h>",
            "#include <asm/machdep.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/hvcall.h>\n#include <asm/machdep.h>\n#include <asm/debugfs.h>\n#include <linux/debugfs.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/types.h>\n\nint set_dawr(int nr, struct arch_hw_breakpoint *brk)\n{\n\tunsigned long dawr, dawrx, mrd;\n\n\tdawr = brk->address;\n\n\tdawrx  = (brk->type & (HW_BRK_TYPE_READ | HW_BRK_TYPE_WRITE))\n\t\t<< (63 - 58);\n\tdawrx |= ((brk->type & (HW_BRK_TYPE_TRANSLATE)) >> 2) << (63 - 59);\n\tdawrx |= (brk->type & (HW_BRK_TYPE_PRIV_ALL)) >> 3;\n\t/*\n\t * DAWR length is stored in field MDR bits 48:53.  Matches range in\n\t * doublewords (64 bits) baised by -1 eg. 0b000000=1DW and\n\t * 0b111111=64DW.\n\t * brk->hw_len is in bytes.\n\t * This aligns up to double word size, shifts and does the bias.\n\t */\n\tmrd = ((brk->hw_len + 7) >> 3) - 1;\n\tdawrx |= (mrd & 0x3f) << (63 - 53);\n\n\tif (ppc_md.set_dawr)\n\t\treturn ppc_md.set_dawr(nr, dawr, dawrx);\n\n\tif (nr == 0) {\n\t\tmtspr(SPRN_DAWR0, dawr);\n\t\tmtspr(SPRN_DAWRX0, dawrx);\n\t} else {\n\t\tmtspr(SPRN_DAWR1, dawr);\n\t\tmtspr(SPRN_DAWRX1, dawrx);\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dawr_enabled",
          "args": [],
          "line": 883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "this_cpu_ptr(&current_brk[nr])",
            "brk",
            "sizeof(*brk)"
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "_memcpy_toio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "181-205",
          "snippet": "void _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&current_brk[nr]"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);\n\nvoid __set_breakpoint(int nr, struct arch_hw_breakpoint *brk)\n{\n\tmemcpy(this_cpu_ptr(&current_brk[nr]), brk, sizeof(*brk));\n\n\tif (dawr_enabled())\n\t\t// Power8 or later\n\t\tset_dawr(nr, brk);\n\telse if (IS_ENABLED(CONFIG_PPC_8xx))\n\t\tset_breakpoint_8xx(brk);\n\telse if (!cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\t// Power7 or earlier\n\t\tset_dabr(brk);\n\telse\n\t\t// Shouldn't happen due to higher level checks\n\t\tWARN_ON_ONCE(1);\n}"
  },
  {
    "function_name": "set_breakpoint_8xx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "846-877",
    "snippet": "static inline int set_breakpoint_8xx(struct arch_hw_breakpoint *brk)\n{\n\tunsigned long lctrl1 = LCTRL1_CTE_GT | LCTRL1_CTF_LT | LCTRL1_CRWE_RW |\n\t\t\t       LCTRL1_CRWF_RW;\n\tunsigned long lctrl2 = LCTRL2_LW0EN | LCTRL2_LW0LADC | LCTRL2_SLW0EN;\n\tunsigned long start_addr = ALIGN_DOWN(brk->address, HW_BREAKPOINT_SIZE);\n\tunsigned long end_addr = ALIGN(brk->address + brk->len, HW_BREAKPOINT_SIZE);\n\n\tif (start_addr == 0)\n\t\tlctrl2 |= LCTRL2_LW0LA_F;\n\telse if (end_addr == 0)\n\t\tlctrl2 |= LCTRL2_LW0LA_E;\n\telse\n\t\tlctrl2 |= LCTRL2_LW0LA_EandF;\n\n\tmtspr(SPRN_LCTRL2, 0);\n\n\tif ((brk->type & HW_BRK_TYPE_RDWR) == 0)\n\t\treturn 0;\n\n\tif ((brk->type & HW_BRK_TYPE_RDWR) == HW_BRK_TYPE_READ)\n\t\tlctrl1 |= LCTRL1_CRWE_RO | LCTRL1_CRWF_RO;\n\tif ((brk->type & HW_BRK_TYPE_RDWR) == HW_BRK_TYPE_WRITE)\n\t\tlctrl1 |= LCTRL1_CRWE_WO | LCTRL1_CRWF_WO;\n\n\tmtspr(SPRN_CMPE, start_addr - 1);\n\tmtspr(SPRN_CMPF, end_addr);\n\tmtspr(SPRN_LCTRL1, lctrl1);\n\tmtspr(SPRN_LCTRL2, lctrl2);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LCTRL2",
            "lctrl2"
          ],
          "line": 874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LCTRL1",
            "lctrl1"
          ],
          "line": 873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_CMPF",
            "end_addr"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_CMPE",
            "start_addr - 1"
          ],
          "line": 871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LCTRL2",
            "0"
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "brk->address + brk->len",
            "HW_BREAKPOINT_SIZE"
          ],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN_DOWN",
          "args": [
            "brk->address",
            "HW_BREAKPOINT_SIZE"
          ],
          "line": 851
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int set_breakpoint_8xx(struct arch_hw_breakpoint *brk)\n{\n\tunsigned long lctrl1 = LCTRL1_CTE_GT | LCTRL1_CTF_LT | LCTRL1_CRWE_RW |\n\t\t\t       LCTRL1_CRWF_RW;\n\tunsigned long lctrl2 = LCTRL2_LW0EN | LCTRL2_LW0LADC | LCTRL2_SLW0EN;\n\tunsigned long start_addr = ALIGN_DOWN(brk->address, HW_BREAKPOINT_SIZE);\n\tunsigned long end_addr = ALIGN(brk->address + brk->len, HW_BREAKPOINT_SIZE);\n\n\tif (start_addr == 0)\n\t\tlctrl2 |= LCTRL2_LW0LA_F;\n\telse if (end_addr == 0)\n\t\tlctrl2 |= LCTRL2_LW0LA_E;\n\telse\n\t\tlctrl2 |= LCTRL2_LW0LA_EandF;\n\n\tmtspr(SPRN_LCTRL2, 0);\n\n\tif ((brk->type & HW_BRK_TYPE_RDWR) == 0)\n\t\treturn 0;\n\n\tif ((brk->type & HW_BRK_TYPE_RDWR) == HW_BRK_TYPE_READ)\n\t\tlctrl1 |= LCTRL1_CRWE_RO | LCTRL1_CRWF_RO;\n\tif ((brk->type & HW_BRK_TYPE_RDWR) == HW_BRK_TYPE_WRITE)\n\t\tlctrl1 |= LCTRL1_CRWE_WO | LCTRL1_CRWF_WO;\n\n\tmtspr(SPRN_CMPE, start_addr - 1);\n\tmtspr(SPRN_CMPF, end_addr);\n\tmtspr(SPRN_LCTRL1, lctrl1);\n\tmtspr(SPRN_LCTRL2, lctrl2);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "set_dabr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "833-844",
    "snippet": "static inline int set_dabr(struct arch_hw_breakpoint *brk)\n{\n\tunsigned long dabr, dabrx;\n\n\tdabr = brk->address | (brk->type & HW_BRK_TYPE_DABR);\n\tdabrx = ((brk->type >> 3) & 0x7);\n\n\tif (ppc_md.set_dabr)\n\t\treturn ppc_md.set_dabr(dabr, dabrx);\n\n\treturn __set_dabr(dabr, dabrx);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__set_dabr",
          "args": [
            "dabr",
            "dabrx"
          ],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "__set_dabr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "827-830",
          "snippet": "static inline int __set_dabr(unsigned long dabr, unsigned long dabrx)\n{\n\treturn -EINVAL;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __set_dabr(unsigned long dabr, unsigned long dabrx)\n{\n\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppc_md.set_dabr",
          "args": [
            "dabr",
            "dabrx"
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int set_dabr(struct arch_hw_breakpoint *brk)\n{\n\tunsigned long dabr, dabrx;\n\n\tdabr = brk->address | (brk->type & HW_BRK_TYPE_DABR);\n\tdabrx = ((brk->type >> 3) & 0x7);\n\n\tif (ppc_md.set_dabr)\n\t\treturn ppc_md.set_dabr(dabr, dabrx);\n\n\treturn __set_dabr(dabr, dabrx);\n}"
  },
  {
    "function_name": "__set_dabr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "827-830",
    "snippet": "static inline int __set_dabr(unsigned long dabr, unsigned long dabrx)\n{\n\treturn -EINVAL;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __set_dabr(unsigned long dabr, unsigned long dabrx)\n{\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "__set_dabr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "819-825",
    "snippet": "static inline int __set_dabr(unsigned long dabr, unsigned long dabrx)\n{\n\tmtspr(SPRN_DABR, dabr);\n\tif (cpu_has_feature(CPU_FTR_DABRX))\n\t\tmtspr(SPRN_DABRX, dabrx);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_DABRX",
            "dabrx"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_DABRX"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_DABR",
            "dabr"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __set_dabr(unsigned long dabr, unsigned long dabrx)\n{\n\tmtspr(SPRN_DABR, dabr);\n\tif (cpu_has_feature(CPU_FTR_DABRX))\n\t\tmtspr(SPRN_DABRX, dabrx);\n\treturn 0;\n}"
  },
  {
    "function_name": "__set_dabr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "811-817",
    "snippet": "static inline int __set_dabr(unsigned long dabr, unsigned long dabrx)\n{\n\tmtspr(SPRN_DAC1, dabr);\n\tif (IS_ENABLED(CONFIG_PPC_47x))\n\t\tisync();\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "isync",
          "args": [],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC_47x"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_DAC1",
            "dabr"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __set_dabr(unsigned long dabr, unsigned long dabrx)\n{\n\tmtspr(SPRN_DAC1, dabr);\n\tif (IS_ENABLED(CONFIG_PPC_47x))\n\t\tisync();\n\treturn 0;\n}"
  },
  {
    "function_name": "switch_hw_breakpoint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "795-806",
    "snippet": "static void switch_hw_breakpoint(struct task_struct *new)\n{\n\tint i;\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tif (likely(hw_brk_match(this_cpu_ptr(&current_brk[i]),\n\t\t\t\t\t&new->thread.hw_brk[i])))\n\t\t\tcontinue;\n\n\t\t__set_breakpoint(i, &new->thread.hw_brk[i]);\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__set_breakpoint",
          "args": [
            "i",
            "&new->thread.hw_brk[i]"
          ],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "__set_breakpoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "879-894",
          "snippet": "void __set_breakpoint(int nr, struct arch_hw_breakpoint *brk)\n{\n\tmemcpy(this_cpu_ptr(&current_brk[nr]), brk, sizeof(*brk));\n\n\tif (dawr_enabled())\n\t\t// Power8 or later\n\t\tset_dawr(nr, brk);\n\telse if (IS_ENABLED(CONFIG_PPC_8xx))\n\t\tset_breakpoint_8xx(brk);\n\telse if (!cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\t// Power7 or earlier\n\t\tset_dabr(brk);\n\telse\n\t\t// Shouldn't happen due to higher level checks\n\t\tWARN_ON_ONCE(1);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);\n\nvoid __set_breakpoint(int nr, struct arch_hw_breakpoint *brk)\n{\n\tmemcpy(this_cpu_ptr(&current_brk[nr]), brk, sizeof(*brk));\n\n\tif (dawr_enabled())\n\t\t// Power8 or later\n\t\tset_dawr(nr, brk);\n\telse if (IS_ENABLED(CONFIG_PPC_8xx))\n\t\tset_breakpoint_8xx(brk);\n\telse if (!cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\t// Power7 or earlier\n\t\tset_dabr(brk);\n\telse\n\t\t// Shouldn't happen due to higher level checks\n\t\tWARN_ON_ONCE(1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "hw_brk_match(this_cpu_ptr(&current_brk[i]),\n\t\t\t\t\t&new->thread.hw_brk[i])"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hw_brk_match",
          "args": [
            "this_cpu_ptr(&current_brk[i])",
            "&new->thread.hw_brk[i]"
          ],
          "line": 800
        },
        "resolved": true,
        "details": {
          "function_name": "hw_brk_match",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "782-793",
          "snippet": "static inline bool hw_brk_match(struct arch_hw_breakpoint *a,\n\t\t\t\tstruct arch_hw_breakpoint *b)\n{\n\tif (a->address != b->address)\n\t\treturn false;\n\tif (a->type != b->type)\n\t\treturn false;\n\tif (a->len != b->len)\n\t\treturn false;\n\t/* no need to check hw_len. it's calculated from address and len */\n\treturn true;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline bool hw_brk_match(struct arch_hw_breakpoint *a,\n\t\t\t\tstruct arch_hw_breakpoint *b)\n{\n\tif (a->address != b->address)\n\t\treturn false;\n\tif (a->type != b->type)\n\t\treturn false;\n\tif (a->len != b->len)\n\t\treturn false;\n\t/* no need to check hw_len. it's calculated from address and len */\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&current_brk[i]"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nr_wp_slots",
          "args": [],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);\n\nstatic void switch_hw_breakpoint(struct task_struct *new)\n{\n\tint i;\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tif (likely(hw_brk_match(this_cpu_ptr(&current_brk[i]),\n\t\t\t\t\t&new->thread.hw_brk[i])))\n\t\t\tcontinue;\n\n\t\t__set_breakpoint(i, &new->thread.hw_brk[i]);\n\t}\n}"
  },
  {
    "function_name": "hw_brk_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "782-793",
    "snippet": "static inline bool hw_brk_match(struct arch_hw_breakpoint *a,\n\t\t\t\tstruct arch_hw_breakpoint *b)\n{\n\tif (a->address != b->address)\n\t\treturn false;\n\tif (a->type != b->type)\n\t\treturn false;\n\tif (a->len != b->len)\n\t\treturn false;\n\t/* no need to check hw_len. it's calculated from address and len */\n\treturn true;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline bool hw_brk_match(struct arch_hw_breakpoint *a,\n\t\t\t\tstruct arch_hw_breakpoint *b)\n{\n\tif (a->address != b->address)\n\t\treturn false;\n\tif (a->type != b->type)\n\t\treturn false;\n\tif (a->len != b->len)\n\t\treturn false;\n\t/* no need to check hw_len. it's calculated from address and len */\n\treturn true;\n}"
  },
  {
    "function_name": "set_debug_reg_defaults",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "770-780",
    "snippet": "static void set_debug_reg_defaults(struct thread_struct *thread)\n{\n\tint i;\n\tstruct arch_hw_breakpoint null_brk = {0};\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tthread->hw_brk[i] = null_brk;\n\t\tif (ppc_breakpoint_available())\n\t\t\tset_breakpoint(i, &thread->hw_brk[i]);\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_breakpoint",
          "args": [
            "i",
            "&thread->hw_brk[i]"
          ],
          "line": 778
        },
        "resolved": true,
        "details": {
          "function_name": "__set_breakpoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "879-894",
          "snippet": "void __set_breakpoint(int nr, struct arch_hw_breakpoint *brk)\n{\n\tmemcpy(this_cpu_ptr(&current_brk[nr]), brk, sizeof(*brk));\n\n\tif (dawr_enabled())\n\t\t// Power8 or later\n\t\tset_dawr(nr, brk);\n\telse if (IS_ENABLED(CONFIG_PPC_8xx))\n\t\tset_breakpoint_8xx(brk);\n\telse if (!cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\t// Power7 or earlier\n\t\tset_dabr(brk);\n\telse\n\t\t// Shouldn't happen due to higher level checks\n\t\tWARN_ON_ONCE(1);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);\n\nvoid __set_breakpoint(int nr, struct arch_hw_breakpoint *brk)\n{\n\tmemcpy(this_cpu_ptr(&current_brk[nr]), brk, sizeof(*brk));\n\n\tif (dawr_enabled())\n\t\t// Power8 or later\n\t\tset_dawr(nr, brk);\n\telse if (IS_ENABLED(CONFIG_PPC_8xx))\n\t\tset_breakpoint_8xx(brk);\n\telse if (!cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\t// Power7 or earlier\n\t\tset_dabr(brk);\n\telse\n\t\t// Shouldn't happen due to higher level checks\n\t\tWARN_ON_ONCE(1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppc_breakpoint_available",
          "args": [],
          "line": 777
        },
        "resolved": true,
        "details": {
          "function_name": "ppc_breakpoint_available",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "897-905",
          "snippet": "bool ppc_breakpoint_available(void)\n{\n\tif (dawr_enabled())\n\t\treturn true; /* POWER8 DAWR or POWER9 forced DAWR */\n\tif (cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\treturn false; /* POWER9 with DAWR disabled */\n\t/* DABR: Everything but POWER8 and POWER9 */\n\treturn true;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nbool ppc_breakpoint_available(void)\n{\n\tif (dawr_enabled())\n\t\treturn true; /* POWER8 DAWR or POWER9 forced DAWR */\n\tif (cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\treturn false; /* POWER9 with DAWR disabled */\n\t/* DABR: Everything but POWER8 and POWER9 */\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nr_wp_slots",
          "args": [],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void set_debug_reg_defaults(struct thread_struct *thread)\n{\n\tint i;\n\tstruct arch_hw_breakpoint null_brk = {0};\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tthread->hw_brk[i] = null_brk;\n\t\tif (ppc_breakpoint_available())\n\t\t\tset_breakpoint(i, &thread->hw_brk[i]);\n\t}\n}"
  },
  {
    "function_name": "set_breakpoint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "763-768",
    "snippet": "static void set_breakpoint(int i, struct arch_hw_breakpoint *brk)\n{\n\tpreempt_disable();\n\t__set_breakpoint(i, brk);\n\tpreempt_enable();\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__set_breakpoint",
          "args": [
            "i",
            "brk"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "__set_breakpoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "879-894",
          "snippet": "void __set_breakpoint(int nr, struct arch_hw_breakpoint *brk)\n{\n\tmemcpy(this_cpu_ptr(&current_brk[nr]), brk, sizeof(*brk));\n\n\tif (dawr_enabled())\n\t\t// Power8 or later\n\t\tset_dawr(nr, brk);\n\telse if (IS_ENABLED(CONFIG_PPC_8xx))\n\t\tset_breakpoint_8xx(brk);\n\telse if (!cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\t// Power7 or earlier\n\t\tset_dabr(brk);\n\telse\n\t\t// Shouldn't happen due to higher level checks\n\t\tWARN_ON_ONCE(1);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);\n\nvoid __set_breakpoint(int nr, struct arch_hw_breakpoint *brk)\n{\n\tmemcpy(this_cpu_ptr(&current_brk[nr]), brk, sizeof(*brk));\n\n\tif (dawr_enabled())\n\t\t// Power8 or later\n\t\tset_dawr(nr, brk);\n\telse if (IS_ENABLED(CONFIG_PPC_8xx))\n\t\tset_breakpoint_8xx(brk);\n\telse if (!cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\t// Power7 or earlier\n\t\tset_dabr(brk);\n\telse\n\t\t// Shouldn't happen due to higher level checks\n\t\tWARN_ON_ONCE(1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 765
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void set_breakpoint(int i, struct arch_hw_breakpoint *brk)\n{\n\tpreempt_disable();\n\t__set_breakpoint(i, brk);\n\tpreempt_enable();\n}"
  },
  {
    "function_name": "switch_booke_debug_regs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "754-759",
    "snippet": "void switch_booke_debug_regs(struct debug_reg *new_debug)\n{\n\tif ((current->thread.debug.dbcr0 & DBCR0_IDM)\n\t\t|| (new_debug->dbcr0 & DBCR0_IDM))\n\t\t\tprime_debug_regs(new_debug);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prime_debug_regs",
          "args": [
            "new_debug"
          ],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "prime_debug_regs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "722-748",
          "snippet": "static void prime_debug_regs(struct debug_reg *debug)\n{\n\t/*\n\t * We could have inherited MSR_DE from userspace, since\n\t * it doesn't get cleared on exception entry.  Make sure\n\t * MSR_DE is clear before we enable any debug events.\n\t */\n\tmtmsr(mfmsr() & ~MSR_DE);\n\n\tmtspr(SPRN_IAC1, debug->iac1);\n\tmtspr(SPRN_IAC2, debug->iac2);\n#if CONFIG_PPC_ADV_DEBUG_IACS > 2\n\tmtspr(SPRN_IAC3, debug->iac3);\n\tmtspr(SPRN_IAC4, debug->iac4);\n#endif\n\tmtspr(SPRN_DAC1, debug->dac1);\n\tmtspr(SPRN_DAC2, debug->dac2);\n#if CONFIG_PPC_ADV_DEBUG_DVCS > 0\n\tmtspr(SPRN_DVC1, debug->dvc1);\n\tmtspr(SPRN_DVC2, debug->dvc2);\n#endif\n\tmtspr(SPRN_DBCR0, debug->dbcr0);\n\tmtspr(SPRN_DBCR1, debug->dbcr1);\n#ifdef CONFIG_BOOKE\n\tmtspr(SPRN_DBCR2, debug->dbcr2);\n#endif\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void prime_debug_regs(struct debug_reg *debug)\n{\n\t/*\n\t * We could have inherited MSR_DE from userspace, since\n\t * it doesn't get cleared on exception entry.  Make sure\n\t * MSR_DE is clear before we enable any debug events.\n\t */\n\tmtmsr(mfmsr() & ~MSR_DE);\n\n\tmtspr(SPRN_IAC1, debug->iac1);\n\tmtspr(SPRN_IAC2, debug->iac2);\n#if CONFIG_PPC_ADV_DEBUG_IACS > 2\n\tmtspr(SPRN_IAC3, debug->iac3);\n\tmtspr(SPRN_IAC4, debug->iac4);\n#endif\n\tmtspr(SPRN_DAC1, debug->dac1);\n\tmtspr(SPRN_DAC2, debug->dac2);\n#if CONFIG_PPC_ADV_DEBUG_DVCS > 0\n\tmtspr(SPRN_DVC1, debug->dvc1);\n\tmtspr(SPRN_DVC2, debug->dvc2);\n#endif\n\tmtspr(SPRN_DBCR0, debug->dbcr0);\n\tmtspr(SPRN_DBCR1, debug->dbcr1);\n#ifdef CONFIG_BOOKE\n\tmtspr(SPRN_DBCR2, debug->dbcr2);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid switch_booke_debug_regs(struct debug_reg *new_debug)\n{\n\tif ((current->thread.debug.dbcr0 & DBCR0_IDM)\n\t\t|| (new_debug->dbcr0 & DBCR0_IDM))\n\t\t\tprime_debug_regs(new_debug);\n}"
  },
  {
    "function_name": "prime_debug_regs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "722-748",
    "snippet": "static void prime_debug_regs(struct debug_reg *debug)\n{\n\t/*\n\t * We could have inherited MSR_DE from userspace, since\n\t * it doesn't get cleared on exception entry.  Make sure\n\t * MSR_DE is clear before we enable any debug events.\n\t */\n\tmtmsr(mfmsr() & ~MSR_DE);\n\n\tmtspr(SPRN_IAC1, debug->iac1);\n\tmtspr(SPRN_IAC2, debug->iac2);\n#if CONFIG_PPC_ADV_DEBUG_IACS > 2\n\tmtspr(SPRN_IAC3, debug->iac3);\n\tmtspr(SPRN_IAC4, debug->iac4);\n#endif\n\tmtspr(SPRN_DAC1, debug->dac1);\n\tmtspr(SPRN_DAC2, debug->dac2);\n#if CONFIG_PPC_ADV_DEBUG_DVCS > 0\n\tmtspr(SPRN_DVC1, debug->dvc1);\n\tmtspr(SPRN_DVC2, debug->dvc2);\n#endif\n\tmtspr(SPRN_DBCR0, debug->dbcr0);\n\tmtspr(SPRN_DBCR1, debug->dbcr1);\n#ifdef CONFIG_BOOKE\n\tmtspr(SPRN_DBCR2, debug->dbcr2);\n#endif\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_DBCR2",
            "debug->dbcr2"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_DBCR1",
            "debug->dbcr1"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_DBCR0",
            "debug->dbcr0"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_DVC2",
            "debug->dvc2"
          ],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_DVC1",
            "debug->dvc1"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_DAC2",
            "debug->dac2"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_DAC1",
            "debug->dac1"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_IAC4",
            "debug->iac4"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_IAC3",
            "debug->iac3"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_IAC2",
            "debug->iac2"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_IAC1",
            "debug->iac1"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtmsr",
          "args": [
            "mfmsr() & ~MSR_DE"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfmsr",
          "args": [],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void prime_debug_regs(struct debug_reg *debug)\n{\n\t/*\n\t * We could have inherited MSR_DE from userspace, since\n\t * it doesn't get cleared on exception entry.  Make sure\n\t * MSR_DE is clear before we enable any debug events.\n\t */\n\tmtmsr(mfmsr() & ~MSR_DE);\n\n\tmtspr(SPRN_IAC1, debug->iac1);\n\tmtspr(SPRN_IAC2, debug->iac2);\n#if CONFIG_PPC_ADV_DEBUG_IACS > 2\n\tmtspr(SPRN_IAC3, debug->iac3);\n\tmtspr(SPRN_IAC4, debug->iac4);\n#endif\n\tmtspr(SPRN_DAC1, debug->dac1);\n\tmtspr(SPRN_DAC2, debug->dac2);\n#if CONFIG_PPC_ADV_DEBUG_DVCS > 0\n\tmtspr(SPRN_DVC1, debug->dvc1);\n\tmtspr(SPRN_DVC2, debug->dvc2);\n#endif\n\tmtspr(SPRN_DBCR0, debug->dbcr0);\n\tmtspr(SPRN_DBCR1, debug->dbcr1);\n#ifdef CONFIG_BOOKE\n\tmtspr(SPRN_DBCR2, debug->dbcr2);\n#endif\n}"
  },
  {
    "function_name": "set_debug_reg_defaults",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "695-720",
    "snippet": "static void set_debug_reg_defaults(struct thread_struct *thread)\n{\n\tthread->debug.iac1 = thread->debug.iac2 = 0;\n#if CONFIG_PPC_ADV_DEBUG_IACS > 2\n\tthread->debug.iac3 = thread->debug.iac4 = 0;\n#endif\n\tthread->debug.dac1 = thread->debug.dac2 = 0;\n#if CONFIG_PPC_ADV_DEBUG_DVCS > 0\n\tthread->debug.dvc1 = thread->debug.dvc2 = 0;\n#endif\n\tthread->debug.dbcr0 = 0;\n#ifdef CONFIG_BOOKE\n\t/*\n\t * Force User/Supervisor bits to b11 (user-only MSR[PR]=1)\n\t */\n\tthread->debug.dbcr1 = DBCR1_IAC1US | DBCR1_IAC2US |\n\t\t\tDBCR1_IAC3US | DBCR1_IAC4US;\n\t/*\n\t * Force Data Address Compare User/Supervisor bits to be User-only\n\t * (0b11 MSR[PR]=1) and set all other bits in DBCR2 register to be 0.\n\t */\n\tthread->debug.dbcr2 = DBCR2_DAC1US | DBCR2_DAC2US;\n#else\n\tthread->debug.dbcr1 = 0;\n#endif\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void set_debug_reg_defaults(struct thread_struct *thread)\n{\n\tthread->debug.iac1 = thread->debug.iac2 = 0;\n#if CONFIG_PPC_ADV_DEBUG_IACS > 2\n\tthread->debug.iac3 = thread->debug.iac4 = 0;\n#endif\n\tthread->debug.dac1 = thread->debug.dac2 = 0;\n#if CONFIG_PPC_ADV_DEBUG_DVCS > 0\n\tthread->debug.dvc1 = thread->debug.dvc2 = 0;\n#endif\n\tthread->debug.dbcr0 = 0;\n#ifdef CONFIG_BOOKE\n\t/*\n\t * Force User/Supervisor bits to b11 (user-only MSR[PR]=1)\n\t */\n\tthread->debug.dbcr1 = DBCR1_IAC1US | DBCR1_IAC2US |\n\t\t\tDBCR1_IAC3US | DBCR1_IAC4US;\n\t/*\n\t * Force Data Address Compare User/Supervisor bits to be User-only\n\t * (0b11 MSR[PR]=1) and set all other bits in DBCR2 register to be 0.\n\t */\n\tthread->debug.dbcr2 = DBCR2_DAC1US | DBCR2_DAC2US;\n#else\n\tthread->debug.dbcr1 = 0;\n#endif\n}"
  },
  {
    "function_name": "do_break",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "663-686",
    "snippet": "void do_break (struct pt_regs *regs, unsigned long address,\n\t\t    unsigned long error_code)\n{\n\tcurrent->thread.trap_nr = TRAP_HWBKPT;\n\tif (notify_die(DIE_DABR_MATCH, \"dabr_match\", regs, error_code,\n\t\t\t11, SIGSEGV) == NOTIFY_STOP)\n\t\treturn;\n\n\tif (debugger_break_match(regs))\n\t\treturn;\n\n\t/*\n\t * We reach here only when watchpoint exception is generated by ptrace\n\t * event (or hw is buggy!). Now if CONFIG_HAVE_HW_BREAKPOINT is set,\n\t * watchpoint is already handled by hw_breakpoint_handler() so we don't\n\t * have to do anything. But when CONFIG_HAVE_HW_BREAKPOINT is not set,\n\t * we need to manually handle the watchpoint here.\n\t */\n\tif (!IS_ENABLED(CONFIG_HAVE_HW_BREAKPOINT))\n\t\tdo_break_handler(regs);\n\n\t/* Deliver the signal to userspace */\n\tforce_sig_fault(SIGTRAP, TRAP_HWBKPT, (void __user *)address);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "force_sig_fault",
          "args": [
            "SIGTRAP",
            "TRAP_HWBKPT",
            "(void __user *)address"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_break_handler",
          "args": [
            "regs"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "do_break_handler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "626-661",
          "snippet": "static void do_break_handler(struct pt_regs *regs)\n{\n\tstruct arch_hw_breakpoint null_brk = {0};\n\tstruct arch_hw_breakpoint *info;\n\tstruct ppc_inst instr = ppc_inst(0);\n\tint type = 0;\n\tint size = 0;\n\tunsigned long ea;\n\tint i;\n\n\t/*\n\t * If underneath hw supports only one watchpoint, we know it\n\t * caused exception. 8xx also falls into this category.\n\t */\n\tif (nr_wp_slots() == 1) {\n\t\t__set_breakpoint(0, &null_brk);\n\t\tcurrent->thread.hw_brk[0] = null_brk;\n\t\tcurrent->thread.hw_brk[0].flags |= HW_BRK_FLAG_DISABLED;\n\t\treturn;\n\t}\n\n\t/* Otherwise findout which DAWR caused exception and disable it. */\n\twp_get_instr_detail(regs, &instr, &type, &size, &ea);\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tinfo = &current->thread.hw_brk[i];\n\t\tif (!info->address)\n\t\t\tcontinue;\n\n\t\tif (wp_check_constraints(regs, instr, ea, type, size, info)) {\n\t\t\t__set_breakpoint(i, &null_brk);\n\t\t\tcurrent->thread.hw_brk[i] = null_brk;\n\t\t\tcurrent->thread.hw_brk[i].flags |= HW_BRK_FLAG_DISABLED;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void do_break_handler(struct pt_regs *regs)\n{\n\tstruct arch_hw_breakpoint null_brk = {0};\n\tstruct arch_hw_breakpoint *info;\n\tstruct ppc_inst instr = ppc_inst(0);\n\tint type = 0;\n\tint size = 0;\n\tunsigned long ea;\n\tint i;\n\n\t/*\n\t * If underneath hw supports only one watchpoint, we know it\n\t * caused exception. 8xx also falls into this category.\n\t */\n\tif (nr_wp_slots() == 1) {\n\t\t__set_breakpoint(0, &null_brk);\n\t\tcurrent->thread.hw_brk[0] = null_brk;\n\t\tcurrent->thread.hw_brk[0].flags |= HW_BRK_FLAG_DISABLED;\n\t\treturn;\n\t}\n\n\t/* Otherwise findout which DAWR caused exception and disable it. */\n\twp_get_instr_detail(regs, &instr, &type, &size, &ea);\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tinfo = &current->thread.hw_brk[i];\n\t\tif (!info->address)\n\t\t\tcontinue;\n\n\t\tif (wp_check_constraints(regs, instr, ea, type, size, info)) {\n\t\t\t__set_breakpoint(i, &null_brk);\n\t\t\tcurrent->thread.hw_brk[i] = null_brk;\n\t\t\tcurrent->thread.hw_brk[i].flags |= HW_BRK_FLAG_DISABLED;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_HAVE_HW_BREAKPOINT"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugger_break_match",
          "args": [
            "regs"
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notify_die",
          "args": [
            "DIE_DABR_MATCH",
            "\"dabr_match\"",
            "regs",
            "error_code",
            "11",
            "SIGSEGV"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid do_break (struct pt_regs *regs, unsigned long address,\n\t\t    unsigned long error_code)\n{\n\tcurrent->thread.trap_nr = TRAP_HWBKPT;\n\tif (notify_die(DIE_DABR_MATCH, \"dabr_match\", regs, error_code,\n\t\t\t11, SIGSEGV) == NOTIFY_STOP)\n\t\treturn;\n\n\tif (debugger_break_match(regs))\n\t\treturn;\n\n\t/*\n\t * We reach here only when watchpoint exception is generated by ptrace\n\t * event (or hw is buggy!). Now if CONFIG_HAVE_HW_BREAKPOINT is set,\n\t * watchpoint is already handled by hw_breakpoint_handler() so we don't\n\t * have to do anything. But when CONFIG_HAVE_HW_BREAKPOINT is not set,\n\t * we need to manually handle the watchpoint here.\n\t */\n\tif (!IS_ENABLED(CONFIG_HAVE_HW_BREAKPOINT))\n\t\tdo_break_handler(regs);\n\n\t/* Deliver the signal to userspace */\n\tforce_sig_fault(SIGTRAP, TRAP_HWBKPT, (void __user *)address);\n}"
  },
  {
    "function_name": "do_break_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "626-661",
    "snippet": "static void do_break_handler(struct pt_regs *regs)\n{\n\tstruct arch_hw_breakpoint null_brk = {0};\n\tstruct arch_hw_breakpoint *info;\n\tstruct ppc_inst instr = ppc_inst(0);\n\tint type = 0;\n\tint size = 0;\n\tunsigned long ea;\n\tint i;\n\n\t/*\n\t * If underneath hw supports only one watchpoint, we know it\n\t * caused exception. 8xx also falls into this category.\n\t */\n\tif (nr_wp_slots() == 1) {\n\t\t__set_breakpoint(0, &null_brk);\n\t\tcurrent->thread.hw_brk[0] = null_brk;\n\t\tcurrent->thread.hw_brk[0].flags |= HW_BRK_FLAG_DISABLED;\n\t\treturn;\n\t}\n\n\t/* Otherwise findout which DAWR caused exception and disable it. */\n\twp_get_instr_detail(regs, &instr, &type, &size, &ea);\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tinfo = &current->thread.hw_brk[i];\n\t\tif (!info->address)\n\t\t\tcontinue;\n\n\t\tif (wp_check_constraints(regs, instr, ea, type, size, info)) {\n\t\t\t__set_breakpoint(i, &null_brk);\n\t\t\tcurrent->thread.hw_brk[i] = null_brk;\n\t\t\tcurrent->thread.hw_brk[i].flags |= HW_BRK_FLAG_DISABLED;\n\t\t}\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__set_breakpoint",
          "args": [
            "i",
            "&null_brk"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "__set_breakpoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "879-894",
          "snippet": "void __set_breakpoint(int nr, struct arch_hw_breakpoint *brk)\n{\n\tmemcpy(this_cpu_ptr(&current_brk[nr]), brk, sizeof(*brk));\n\n\tif (dawr_enabled())\n\t\t// Power8 or later\n\t\tset_dawr(nr, brk);\n\telse if (IS_ENABLED(CONFIG_PPC_8xx))\n\t\tset_breakpoint_8xx(brk);\n\telse if (!cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\t// Power7 or earlier\n\t\tset_dabr(brk);\n\telse\n\t\t// Shouldn't happen due to higher level checks\n\t\tWARN_ON_ONCE(1);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic DEFINE_PER_CPU(struct arch_hw_breakpoint, current_brk[HBP_NUM_MAX]);\n\nvoid __set_breakpoint(int nr, struct arch_hw_breakpoint *brk)\n{\n\tmemcpy(this_cpu_ptr(&current_brk[nr]), brk, sizeof(*brk));\n\n\tif (dawr_enabled())\n\t\t// Power8 or later\n\t\tset_dawr(nr, brk);\n\telse if (IS_ENABLED(CONFIG_PPC_8xx))\n\t\tset_breakpoint_8xx(brk);\n\telse if (!cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\t// Power7 or earlier\n\t\tset_dabr(brk);\n\telse\n\t\t// Shouldn't happen due to higher level checks\n\t\tWARN_ON_ONCE(1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wp_check_constraints",
          "args": [
            "regs",
            "instr",
            "ea",
            "type",
            "size",
            "info"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "wp_check_constraints",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/hw_breakpoint_constraints.c",
          "lines": "83-128",
          "snippet": "bool wp_check_constraints(struct pt_regs *regs, struct ppc_inst instr,\n\t\t\t  unsigned long ea, int type, int size,\n\t\t\t  struct arch_hw_breakpoint *info)\n{\n\tbool in_user_range = dar_in_user_range(regs->dar, info);\n\tbool dawrx_constraints;\n\n\t/*\n\t * 8xx supports only one breakpoint and thus we can\n\t * unconditionally return true.\n\t */\n\tif (IS_ENABLED(CONFIG_PPC_8xx)) {\n\t\tif (!in_user_range)\n\t\t\tinfo->type |= HW_BRK_TYPE_EXTRANEOUS_IRQ;\n\t\treturn true;\n\t}\n\n\tif (unlikely(ppc_inst_equal(instr, ppc_inst(0)))) {\n\t\tif (cpu_has_feature(CPU_FTR_ARCH_31) &&\n\t\t    !dar_in_hw_range(regs->dar, info))\n\t\t\treturn false;\n\n\t\treturn true;\n\t}\n\n\tdawrx_constraints = check_dawrx_constraints(regs, type, info);\n\n\tif (type == UNKNOWN) {\n\t\tif (cpu_has_feature(CPU_FTR_ARCH_31) &&\n\t\t    !dar_in_hw_range(regs->dar, info))\n\t\t\treturn false;\n\n\t\treturn dawrx_constraints;\n\t}\n\n\tif (ea_user_range_overlaps(ea, size, info))\n\t\treturn dawrx_constraints;\n\n\tif (ea_hw_range_overlaps(ea, size, info)) {\n\t\tif (dawrx_constraints) {\n\t\t\tinfo->type |= HW_BRK_TYPE_EXTRANEOUS_IRQ;\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}",
          "includes": [
            "#include <asm/cache.h>",
            "#include <asm/sstep.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <linux/sched.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cache.h>\n#include <asm/sstep.h>\n#include <asm/hw_breakpoint.h>\n#include <linux/sched.h>\n#include <linux/uaccess.h>\n#include <linux/kernel.h>\n\nbool wp_check_constraints(struct pt_regs *regs, struct ppc_inst instr,\n\t\t\t  unsigned long ea, int type, int size,\n\t\t\t  struct arch_hw_breakpoint *info)\n{\n\tbool in_user_range = dar_in_user_range(regs->dar, info);\n\tbool dawrx_constraints;\n\n\t/*\n\t * 8xx supports only one breakpoint and thus we can\n\t * unconditionally return true.\n\t */\n\tif (IS_ENABLED(CONFIG_PPC_8xx)) {\n\t\tif (!in_user_range)\n\t\t\tinfo->type |= HW_BRK_TYPE_EXTRANEOUS_IRQ;\n\t\treturn true;\n\t}\n\n\tif (unlikely(ppc_inst_equal(instr, ppc_inst(0)))) {\n\t\tif (cpu_has_feature(CPU_FTR_ARCH_31) &&\n\t\t    !dar_in_hw_range(regs->dar, info))\n\t\t\treturn false;\n\n\t\treturn true;\n\t}\n\n\tdawrx_constraints = check_dawrx_constraints(regs, type, info);\n\n\tif (type == UNKNOWN) {\n\t\tif (cpu_has_feature(CPU_FTR_ARCH_31) &&\n\t\t    !dar_in_hw_range(regs->dar, info))\n\t\t\treturn false;\n\n\t\treturn dawrx_constraints;\n\t}\n\n\tif (ea_user_range_overlaps(ea, size, info))\n\t\treturn dawrx_constraints;\n\n\tif (ea_hw_range_overlaps(ea, size, info)) {\n\t\tif (dawrx_constraints) {\n\t\t\tinfo->type |= HW_BRK_TYPE_EXTRANEOUS_IRQ;\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nr_wp_slots",
          "args": [],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wp_get_instr_detail",
          "args": [
            "regs",
            "&instr",
            "&type",
            "&size",
            "&ea"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "wp_get_instr_detail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/hw_breakpoint_constraints.c",
          "lines": "139-162",
          "snippet": "void wp_get_instr_detail(struct pt_regs *regs, struct ppc_inst *instr,\n\t\t\t int *type, int *size, unsigned long *ea)\n{\n\tstruct instruction_op op;\n\n\tif (__get_user_instr_inatomic(*instr, (void __user *)regs->nip))\n\t\treturn;\n\n\tanalyse_instr(&op, regs, *instr);\n\t*type = GETTYPE(op.type);\n\t*ea = op.ea;\n#ifdef __powerpc64__\n\tif (!(regs->msr & MSR_64BIT))\n\t\t*ea &= 0xffffffffUL;\n#endif\n\n\t*size = GETSIZE(op.type);\n\tif (*type == CACHEOP) {\n\t\t*size = cache_op_size();\n\t\t*ea &= ~(*size - 1);\n\t} else if (*type == LOAD_VMX || *type == STORE_VMX) {\n\t\t*ea &= ~(*size - 1);\n\t}\n}",
          "includes": [
            "#include <asm/cache.h>",
            "#include <asm/sstep.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <linux/sched.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cache.h>\n#include <asm/sstep.h>\n#include <asm/hw_breakpoint.h>\n#include <linux/sched.h>\n#include <linux/uaccess.h>\n#include <linux/kernel.h>\n\nvoid wp_get_instr_detail(struct pt_regs *regs, struct ppc_inst *instr,\n\t\t\t int *type, int *size, unsigned long *ea)\n{\n\tstruct instruction_op op;\n\n\tif (__get_user_instr_inatomic(*instr, (void __user *)regs->nip))\n\t\treturn;\n\n\tanalyse_instr(&op, regs, *instr);\n\t*type = GETTYPE(op.type);\n\t*ea = op.ea;\n#ifdef __powerpc64__\n\tif (!(regs->msr & MSR_64BIT))\n\t\t*ea &= 0xffffffffUL;\n#endif\n\n\t*size = GETSIZE(op.type);\n\tif (*type == CACHEOP) {\n\t\t*size = cache_op_size();\n\t\t*ea &= ~(*size - 1);\n\t} else if (*type == LOAD_VMX || *type == STORE_VMX) {\n\t\t*ea &= ~(*size - 1);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nr_wp_slots",
          "args": [],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_inst",
          "args": [
            "0"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void do_break_handler(struct pt_regs *regs)\n{\n\tstruct arch_hw_breakpoint null_brk = {0};\n\tstruct arch_hw_breakpoint *info;\n\tstruct ppc_inst instr = ppc_inst(0);\n\tint type = 0;\n\tint size = 0;\n\tunsigned long ea;\n\tint i;\n\n\t/*\n\t * If underneath hw supports only one watchpoint, we know it\n\t * caused exception. 8xx also falls into this category.\n\t */\n\tif (nr_wp_slots() == 1) {\n\t\t__set_breakpoint(0, &null_brk);\n\t\tcurrent->thread.hw_brk[0] = null_brk;\n\t\tcurrent->thread.hw_brk[0].flags |= HW_BRK_FLAG_DISABLED;\n\t\treturn;\n\t}\n\n\t/* Otherwise findout which DAWR caused exception and disable it. */\n\twp_get_instr_detail(regs, &instr, &type, &size, &ea);\n\n\tfor (i = 0; i < nr_wp_slots(); i++) {\n\t\tinfo = &current->thread.hw_brk[i];\n\t\tif (!info->address)\n\t\t\tcontinue;\n\n\t\tif (wp_check_constraints(regs, instr, ea, type, size, info)) {\n\t\t\t__set_breakpoint(i, &null_brk);\n\t\t\tcurrent->thread.hw_brk[i] = null_brk;\n\t\t\tcurrent->thread.hw_brk[i].flags |= HW_BRK_FLAG_DISABLED;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "do_send_trap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "612-623",
    "snippet": "void do_send_trap(struct pt_regs *regs, unsigned long address,\n\t\t  unsigned long error_code, int breakpt)\n{\n\tcurrent->thread.trap_nr = TRAP_HWBKPT;\n\tif (notify_die(DIE_DABR_MATCH, \"dabr_match\", regs, error_code,\n\t\t\t11, SIGSEGV) == NOTIFY_STOP)\n\t\treturn;\n\n\t/* Deliver the signal to userspace */\n\tforce_sig_ptrace_errno_trap(breakpt, /* breakpoint or watchpoint id */\n\t\t\t\t    (void __user *)address);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "force_sig_ptrace_errno_trap",
          "args": [
            "breakpt",
            "/* breakpoint or watchpoint id */(void __user *)address"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notify_die",
          "args": [
            "DIE_DABR_MATCH",
            "\"dabr_match\"",
            "regs",
            "error_code",
            "11",
            "SIGSEGV"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid do_send_trap(struct pt_regs *regs, unsigned long address,\n\t\t  unsigned long error_code, int breakpt)\n{\n\tcurrent->thread.trap_nr = TRAP_HWBKPT;\n\tif (notify_die(DIE_DABR_MATCH, \"dabr_match\", regs, error_code,\n\t\t\t11, SIGSEGV) == NOTIFY_STOP)\n\t\treturn;\n\n\t/* Deliver the signal to userspace */\n\tforce_sig_ptrace_errno_trap(breakpt, /* breakpoint or watchpoint id */\n\t\t\t\t    (void __user *)address);\n}"
  },
  {
    "function_name": "flush_all_to_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "595-608",
    "snippet": "void flush_all_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\tpreempt_disable();\n\t\tBUG_ON(tsk != current);\n#ifdef CONFIG_SPE\n\t\tif (tsk->thread.regs->msr & MSR_SPE)\n\t\t\ttsk->thread.spefscr = mfspr(SPRN_SPEFSCR);\n#endif\n\t\tsave_all(tsk);\n\n\t\tpreempt_enable();\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "save_all",
          "args": [
            "tsk"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "save_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "566-593",
          "snippet": "static void save_all(struct task_struct *tsk)\n{\n\tunsigned long usermsr;\n\n\tif (!tsk->thread.regs)\n\t\treturn;\n\n\tusermsr = tsk->thread.regs->msr;\n\n\tif ((usermsr & msr_all_available) == 0)\n\t\treturn;\n\n\tmsr_check_and_set(msr_all_available);\n\n\tWARN_ON((usermsr & MSR_VSX) && !((usermsr & MSR_FP) && (usermsr & MSR_VEC)));\n\n\tif (usermsr & MSR_FP)\n\t\tsave_fpu(tsk);\n\n\tif (usermsr & MSR_VEC)\n\t\tsave_altivec(tsk);\n\n\tif (usermsr & MSR_SPE)\n\t\t__giveup_spe(tsk);\n\n\tmsr_check_and_clear(msr_all_available);\n\tthread_pkey_regs_save(&tsk->thread);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long msr_all_available;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic unsigned long msr_all_available;\n\nstatic void save_all(struct task_struct *tsk)\n{\n\tunsigned long usermsr;\n\n\tif (!tsk->thread.regs)\n\t\treturn;\n\n\tusermsr = tsk->thread.regs->msr;\n\n\tif ((usermsr & msr_all_available) == 0)\n\t\treturn;\n\n\tmsr_check_and_set(msr_all_available);\n\n\tWARN_ON((usermsr & MSR_VSX) && !((usermsr & MSR_FP) && (usermsr & MSR_VEC)));\n\n\tif (usermsr & MSR_FP)\n\t\tsave_fpu(tsk);\n\n\tif (usermsr & MSR_VEC)\n\t\tsave_altivec(tsk);\n\n\tif (usermsr & MSR_SPE)\n\t\t__giveup_spe(tsk);\n\n\tmsr_check_and_clear(msr_all_available);\n\tthread_pkey_regs_save(&tsk->thread);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_SPEFSCR"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "tsk != current"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid flush_all_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\tpreempt_disable();\n\t\tBUG_ON(tsk != current);\n#ifdef CONFIG_SPE\n\t\tif (tsk->thread.regs->msr & MSR_SPE)\n\t\t\ttsk->thread.spefscr = mfspr(SPRN_SPEFSCR);\n#endif\n\t\tsave_all(tsk);\n\n\t\tpreempt_enable();\n\t}\n}"
  },
  {
    "function_name": "save_all",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "566-593",
    "snippet": "static void save_all(struct task_struct *tsk)\n{\n\tunsigned long usermsr;\n\n\tif (!tsk->thread.regs)\n\t\treturn;\n\n\tusermsr = tsk->thread.regs->msr;\n\n\tif ((usermsr & msr_all_available) == 0)\n\t\treturn;\n\n\tmsr_check_and_set(msr_all_available);\n\n\tWARN_ON((usermsr & MSR_VSX) && !((usermsr & MSR_FP) && (usermsr & MSR_VEC)));\n\n\tif (usermsr & MSR_FP)\n\t\tsave_fpu(tsk);\n\n\tif (usermsr & MSR_VEC)\n\t\tsave_altivec(tsk);\n\n\tif (usermsr & MSR_SPE)\n\t\t__giveup_spe(tsk);\n\n\tmsr_check_and_clear(msr_all_available);\n\tthread_pkey_regs_save(&tsk->thread);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned long msr_all_available;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "thread_pkey_regs_save",
          "args": [
            "&tsk->thread"
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msr_check_and_clear",
          "args": [
            "msr_all_available"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "__msr_check_and_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "138-150",
          "snippet": "void notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__giveup_spe",
          "args": [
            "tsk"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "save_altivec",
          "args": [
            "tsk"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "save_fpu",
          "args": [
            "tsk"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "(usermsr & MSR_VSX) && !((usermsr & MSR_FP) && (usermsr & MSR_VEC))"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msr_check_and_set",
          "args": [
            "msr_all_available"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "msr_check_and_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "120-134",
          "snippet": "unsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic unsigned long msr_all_available;\n\nstatic void save_all(struct task_struct *tsk)\n{\n\tunsigned long usermsr;\n\n\tif (!tsk->thread.regs)\n\t\treturn;\n\n\tusermsr = tsk->thread.regs->msr;\n\n\tif ((usermsr & msr_all_available) == 0)\n\t\treturn;\n\n\tmsr_check_and_set(msr_all_available);\n\n\tWARN_ON((usermsr & MSR_VSX) && !((usermsr & MSR_FP) && (usermsr & MSR_VEC)));\n\n\tif (usermsr & MSR_FP)\n\t\tsave_fpu(tsk);\n\n\tif (usermsr & MSR_VEC)\n\t\tsave_altivec(tsk);\n\n\tif (usermsr & MSR_SPE)\n\t\t__giveup_spe(tsk);\n\n\tmsr_check_and_clear(msr_all_available);\n\tthread_pkey_regs_save(&tsk->thread);\n}"
  },
  {
    "function_name": "restore_math",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "518-563",
    "snippet": "void notrace restore_math(struct pt_regs *regs)\n{\n\tunsigned long msr;\n\tunsigned long new_msr = 0;\n\n\tmsr = regs->msr;\n\n\t/*\n\t * new_msr tracks the facilities that are to be restored. Only reload\n\t * if the bit is not set in the user MSR (if it is set, the registers\n\t * are live for the user thread).\n\t */\n\tif ((!(msr & MSR_FP)) && should_restore_fp())\n\t\tnew_msr |= MSR_FP;\n\n\tif ((!(msr & MSR_VEC)) && should_restore_altivec())\n\t\tnew_msr |= MSR_VEC;\n\n\tif ((!(msr & MSR_VSX)) && should_restore_vsx()) {\n\t\tif (((msr | new_msr) & (MSR_FP | MSR_VEC)) == (MSR_FP | MSR_VEC))\n\t\t\tnew_msr |= MSR_VSX;\n\t}\n\n\tif (new_msr) {\n\t\tunsigned long fpexc_mode = 0;\n\n\t\tmsr_check_and_set(new_msr);\n\n\t\tif (new_msr & MSR_FP) {\n\t\t\tdo_restore_fp();\n\n\t\t\t// This also covers VSX, because VSX implies FP\n\t\t\tfpexc_mode = current->thread.fpexc_mode;\n\t\t}\n\n\t\tif (new_msr & MSR_VEC)\n\t\t\tdo_restore_altivec();\n\n\t\tif (new_msr & MSR_VSX)\n\t\t\tdo_restore_vsx();\n\n\t\tmsr_check_and_clear(new_msr);\n\n\t\tregs->msr |= new_msr | fpexc_mode;\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "msr_check_and_clear",
          "args": [
            "new_msr"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "__msr_check_and_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "138-150",
          "snippet": "void notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_restore_vsx",
          "args": [],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "do_restore_vsx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "505-505",
          "snippet": "static void do_restore_vsx(void) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void do_restore_vsx(void) { }"
        }
      },
      {
        "call_info": {
          "callee": "do_restore_altivec",
          "args": [],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "do_restore_altivec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "490-490",
          "snippet": "static void do_restore_altivec(void) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void do_restore_altivec(void) { }"
        }
      },
      {
        "call_info": {
          "callee": "do_restore_fp",
          "args": [],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "do_restore_fp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "470-470",
          "snippet": "static void do_restore_fp(void) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void do_restore_fp(void) { }"
        }
      },
      {
        "call_info": {
          "callee": "msr_check_and_set",
          "args": [
            "new_msr"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "msr_check_and_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "120-134",
          "snippet": "unsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "should_restore_vsx",
          "args": [],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "should_restore_vsx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "493-498",
          "snippet": "static bool should_restore_vsx(void)\n{\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic bool should_restore_vsx(void)\n{\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "should_restore_altivec",
          "args": [],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "should_restore_altivec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "489-489",
          "snippet": "static bool should_restore_altivec(void) { return false; }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic bool should_restore_altivec(void) { return false; }"
        }
      },
      {
        "call_info": {
          "callee": "should_restore_fp",
          "args": [],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "should_restore_fp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "469-469",
          "snippet": "static bool should_restore_fp(void) { return false; }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic bool should_restore_fp(void) { return false; }"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace restore_math(struct pt_regs *regs)\n{\n\tunsigned long msr;\n\tunsigned long new_msr = 0;\n\n\tmsr = regs->msr;\n\n\t/*\n\t * new_msr tracks the facilities that are to be restored. Only reload\n\t * if the bit is not set in the user MSR (if it is set, the registers\n\t * are live for the user thread).\n\t */\n\tif ((!(msr & MSR_FP)) && should_restore_fp())\n\t\tnew_msr |= MSR_FP;\n\n\tif ((!(msr & MSR_VEC)) && should_restore_altivec())\n\t\tnew_msr |= MSR_VEC;\n\n\tif ((!(msr & MSR_VSX)) && should_restore_vsx()) {\n\t\tif (((msr | new_msr) & (MSR_FP | MSR_VEC)) == (MSR_FP | MSR_VEC))\n\t\t\tnew_msr |= MSR_VSX;\n\t}\n\n\tif (new_msr) {\n\t\tunsigned long fpexc_mode = 0;\n\n\t\tmsr_check_and_set(new_msr);\n\n\t\tif (new_msr & MSR_FP) {\n\t\t\tdo_restore_fp();\n\n\t\t\t// This also covers VSX, because VSX implies FP\n\t\t\tfpexc_mode = current->thread.fpexc_mode;\n\t\t}\n\n\t\tif (new_msr & MSR_VEC)\n\t\t\tdo_restore_altivec();\n\n\t\tif (new_msr & MSR_VSX)\n\t\t\tdo_restore_vsx();\n\n\t\tmsr_check_and_clear(new_msr);\n\n\t\tregs->msr |= new_msr | fpexc_mode;\n\t}\n}"
  },
  {
    "function_name": "do_restore_vsx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "505-505",
    "snippet": "static void do_restore_vsx(void) { }",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void do_restore_vsx(void) { }"
  },
  {
    "function_name": "do_restore_vsx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "500-503",
    "snippet": "static void do_restore_vsx(void)\n{\n\tcurrent->thread.used_vsr = 1;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void do_restore_vsx(void)\n{\n\tcurrent->thread.used_vsr = 1;\n}"
  },
  {
    "function_name": "should_restore_vsx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "493-498",
    "snippet": "static bool should_restore_vsx(void)\n{\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\treturn true;\n\treturn false;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_VSX"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic bool should_restore_vsx(void)\n{\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\treturn true;\n\treturn false;\n}"
  },
  {
    "function_name": "do_restore_altivec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "490-490",
    "snippet": "static void do_restore_altivec(void) { }",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void do_restore_altivec(void) { }"
  },
  {
    "function_name": "should_restore_altivec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "489-489",
    "snippet": "static bool should_restore_altivec(void) { return false; }",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic bool should_restore_altivec(void) { return false; }"
  },
  {
    "function_name": "do_restore_altivec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "483-487",
    "snippet": "static void do_restore_altivec(void)\n{\n\tload_vr_state(&current->thread.vr_state);\n\tcurrent->thread.used_vr = 1;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "load_vr_state",
          "args": [
            "&current->thread.vr_state"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void do_restore_altivec(void)\n{\n\tload_vr_state(&current->thread.vr_state);\n\tcurrent->thread.used_vr = 1;\n}"
  },
  {
    "function_name": "should_restore_altivec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "474-481",
    "snippet": "static bool should_restore_altivec(void)\n{\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC) && (current->thread.load_vec)) {\n\t\tcurrent->thread.load_vec++;\n\t\treturn true;\n\t}\n\treturn false;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ALTIVEC"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic bool should_restore_altivec(void)\n{\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC) && (current->thread.load_vec)) {\n\t\tcurrent->thread.load_vec++;\n\t\treturn true;\n\t}\n\treturn false;\n}"
  },
  {
    "function_name": "do_restore_fp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "470-470",
    "snippet": "static void do_restore_fp(void) { }",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void do_restore_fp(void) { }"
  },
  {
    "function_name": "should_restore_fp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "469-469",
    "snippet": "static bool should_restore_fp(void) { return false; }",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic bool should_restore_fp(void) { return false; }"
  },
  {
    "function_name": "do_restore_fp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "464-467",
    "snippet": "static void do_restore_fp(void)\n{\n\tload_fp_state(&current->thread.fp_state);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "load_fp_state",
          "args": [
            "&current->thread.fp_state"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void do_restore_fp(void)\n{\n\tload_fp_state(&current->thread.fp_state);\n}"
  },
  {
    "function_name": "should_restore_fp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "455-462",
    "snippet": "static bool should_restore_fp(void)\n{\n\tif (current->thread.load_fp) {\n\t\tcurrent->thread.load_fp++;\n\t\treturn true;\n\t}\n\treturn false;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic bool should_restore_fp(void)\n{\n\tif (current->thread.load_fp) {\n\t\tcurrent->thread.load_fp++;\n\t\treturn true;\n\t}\n\treturn false;\n}"
  },
  {
    "function_name": "giveup_all",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "424-450",
    "snippet": "void giveup_all(struct task_struct *tsk)\n{\n\tunsigned long usermsr;\n\n\tif (!tsk->thread.regs)\n\t\treturn;\n\n\tcheck_if_tm_restore_required(tsk);\n\n\tusermsr = tsk->thread.regs->msr;\n\n\tif ((usermsr & msr_all_available) == 0)\n\t\treturn;\n\n\tmsr_check_and_set(msr_all_available);\n\n\tWARN_ON((usermsr & MSR_VSX) && !((usermsr & MSR_FP) && (usermsr & MSR_VEC)));\n\n\tif (usermsr & MSR_FP)\n\t\t__giveup_fpu(tsk);\n\tif (usermsr & MSR_VEC)\n\t\t__giveup_altivec(tsk);\n\tif (usermsr & MSR_SPE)\n\t\t__giveup_spe(tsk);\n\n\tmsr_check_and_clear(msr_all_available);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned long msr_all_available;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msr_check_and_clear",
          "args": [
            "msr_all_available"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "__msr_check_and_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "138-150",
          "snippet": "void notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__giveup_spe",
          "args": [
            "tsk"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__giveup_altivec",
          "args": [
            "tsk"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "__giveup_altivec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "237-247",
          "snippet": "static void __giveup_altivec(struct task_struct *tsk)\n{\n\tunsigned long msr;\n\n\tsave_altivec(tsk);\n\tmsr = tsk->thread.regs->msr;\n\tmsr &= ~MSR_VEC;\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr &= ~MSR_VSX;\n\ttsk->thread.regs->msr = msr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void __giveup_altivec(struct task_struct *tsk)\n{\n\tunsigned long msr;\n\n\tsave_altivec(tsk);\n\tmsr = tsk->thread.regs->msr;\n\tmsr &= ~MSR_VEC;\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr &= ~MSR_VSX;\n\ttsk->thread.regs->msr = msr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__giveup_fpu",
          "args": [
            "tsk"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "__giveup_fpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "233-233",
          "snippet": "static inline void __giveup_fpu(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void __giveup_fpu(struct task_struct *tsk) { }"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "(usermsr & MSR_VSX) && !((usermsr & MSR_FP) && (usermsr & MSR_VEC))"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msr_check_and_set",
          "args": [
            "msr_all_available"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "msr_check_and_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "120-134",
          "snippet": "unsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_if_tm_restore_required",
          "args": [
            "tsk"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "check_if_tm_restore_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "104-104",
          "snippet": "static inline void check_if_tm_restore_required(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void check_if_tm_restore_required(struct task_struct *tsk) { }"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic unsigned long msr_all_available;\n\nvoid giveup_all(struct task_struct *tsk)\n{\n\tunsigned long usermsr;\n\n\tif (!tsk->thread.regs)\n\t\treturn;\n\n\tcheck_if_tm_restore_required(tsk);\n\n\tusermsr = tsk->thread.regs->msr;\n\n\tif ((usermsr & msr_all_available) == 0)\n\t\treturn;\n\n\tmsr_check_and_set(msr_all_available);\n\n\tWARN_ON((usermsr & MSR_VSX) && !((usermsr & MSR_FP) && (usermsr & MSR_VEC)));\n\n\tif (usermsr & MSR_FP)\n\t\t__giveup_fpu(tsk);\n\tif (usermsr & MSR_VEC)\n\t\t__giveup_altivec(tsk);\n\tif (usermsr & MSR_SPE)\n\t\t__giveup_spe(tsk);\n\n\tmsr_check_and_clear(msr_all_available);\n}"
  },
  {
    "function_name": "init_msr_all_available",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "409-421",
    "snippet": "static int __init init_msr_all_available(void)\n{\n\tif (IS_ENABLED(CONFIG_PPC_FPU))\n\t\tmsr_all_available |= MSR_FP;\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC))\n\t\tmsr_all_available |= MSR_VEC;\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr_all_available |= MSR_VSX;\n\tif (cpu_has_feature(CPU_FTR_SPE))\n\t\tmsr_all_available |= MSR_SPE;\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned long msr_all_available;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SPE"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_VSX"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ALTIVEC"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC_FPU"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic unsigned long msr_all_available;\n\nstatic int __init init_msr_all_available(void)\n{\n\tif (IS_ENABLED(CONFIG_PPC_FPU))\n\t\tmsr_all_available |= MSR_FP;\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC))\n\t\tmsr_all_available |= MSR_VEC;\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr_all_available |= MSR_VSX;\n\tif (cpu_has_feature(CPU_FTR_SPE))\n\t\tmsr_all_available |= MSR_SPE;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "flush_spe_to_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "393-404",
    "snippet": "void flush_spe_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\tpreempt_disable();\n\t\tif (tsk->thread.regs->msr & MSR_SPE) {\n\t\t\tBUG_ON(tsk != current);\n\t\t\ttsk->thread.spefscr = mfspr(SPRN_SPEFSCR);\n\t\t\tgiveup_spe(tsk);\n\t\t}\n\t\tpreempt_enable();\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giveup_spe",
          "args": [
            "tsk"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "giveup_spe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "370-377",
          "snippet": "void giveup_spe(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_SPE);\n\t__giveup_spe(tsk);\n\tmsr_check_and_clear(MSR_SPE);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid giveup_spe(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_SPE);\n\t__giveup_spe(tsk);\n\tmsr_check_and_clear(MSR_SPE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_SPEFSCR"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "tsk != current"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid flush_spe_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\tpreempt_disable();\n\t\tif (tsk->thread.regs->msr & MSR_SPE) {\n\t\t\tBUG_ON(tsk != current);\n\t\t\ttsk->thread.spefscr = mfspr(SPRN_SPEFSCR);\n\t\t\tgiveup_spe(tsk);\n\t\t}\n\t\tpreempt_enable();\n\t}\n}"
  },
  {
    "function_name": "enable_kernel_spe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "380-390",
    "snippet": "void enable_kernel_spe(void)\n{\n\tWARN_ON(preemptible());\n\n\tmsr_check_and_set(MSR_SPE);\n\n\tif (current->thread.regs && (current->thread.regs->msr & MSR_SPE)) {\n\t\tcheck_if_tm_restore_required(current);\n\t\t__giveup_spe(current);\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__giveup_spe",
          "args": [
            "current"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_if_tm_restore_required",
          "args": [
            "current"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "check_if_tm_restore_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "104-104",
          "snippet": "static inline void check_if_tm_restore_required(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void check_if_tm_restore_required(struct task_struct *tsk) { }"
        }
      },
      {
        "call_info": {
          "callee": "msr_check_and_set",
          "args": [
            "MSR_SPE"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "msr_check_and_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "120-134",
          "snippet": "unsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "preemptible()"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preemptible",
          "args": [],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid enable_kernel_spe(void)\n{\n\tWARN_ON(preemptible());\n\n\tmsr_check_and_set(MSR_SPE);\n\n\tif (current->thread.regs && (current->thread.regs->msr & MSR_SPE)) {\n\t\tcheck_if_tm_restore_required(current);\n\t\t__giveup_spe(current);\n\t}\n}"
  },
  {
    "function_name": "giveup_spe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "370-377",
    "snippet": "void giveup_spe(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_SPE);\n\t__giveup_spe(tsk);\n\tmsr_check_and_clear(MSR_SPE);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "msr_check_and_clear",
          "args": [
            "MSR_SPE"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "__msr_check_and_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "138-150",
          "snippet": "void notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__giveup_spe",
          "args": [
            "tsk"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msr_check_and_set",
          "args": [
            "MSR_SPE"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "msr_check_and_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "120-134",
          "snippet": "unsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_if_tm_restore_required",
          "args": [
            "tsk"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "check_if_tm_restore_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "104-104",
          "snippet": "static inline void check_if_tm_restore_required(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void check_if_tm_restore_required(struct task_struct *tsk) { }"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid giveup_spe(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_SPE);\n\t__giveup_spe(tsk);\n\tmsr_check_and_clear(MSR_SPE);\n}"
  },
  {
    "function_name": "flush_vsx_to_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "355-365",
    "snippet": "void flush_vsx_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\tpreempt_disable();\n\t\tif (tsk->thread.regs->msr & (MSR_VSX|MSR_VEC|MSR_FP)) {\n\t\t\tBUG_ON(tsk != current);\n\t\t\tgiveup_vsx(tsk);\n\t\t}\n\t\tpreempt_enable();\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giveup_vsx",
          "args": [
            "tsk"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "giveup_vsx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "320-327",
          "snippet": "static void giveup_vsx(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_FP|MSR_VEC|MSR_VSX);\n\t__giveup_vsx(tsk);\n\tmsr_check_and_clear(MSR_FP|MSR_VEC|MSR_VSX);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void giveup_vsx(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_FP|MSR_VEC|MSR_VSX);\n\t__giveup_vsx(tsk);\n\tmsr_check_and_clear(MSR_FP|MSR_VEC|MSR_VSX);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "tsk != current"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid flush_vsx_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\tpreempt_disable();\n\t\tif (tsk->thread.regs->msr & (MSR_VSX|MSR_VEC|MSR_FP)) {\n\t\t\tBUG_ON(tsk != current);\n\t\t\tgiveup_vsx(tsk);\n\t\t}\n\t\tpreempt_enable();\n\t}\n}"
  },
  {
    "function_name": "enable_kernel_vsx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "329-352",
    "snippet": "void enable_kernel_vsx(void)\n{\n\tunsigned long cpumsr;\n\n\tWARN_ON(preemptible());\n\n\tcpumsr = msr_check_and_set(MSR_FP|MSR_VEC|MSR_VSX);\n\n\tif (current->thread.regs &&\n\t    (current->thread.regs->msr & (MSR_VSX|MSR_VEC|MSR_FP))) {\n\t\tcheck_if_tm_restore_required(current);\n\t\t/*\n\t\t * If a thread has already been reclaimed then the\n\t\t * checkpointed registers are on the CPU but have definitely\n\t\t * been saved by the reclaim code. Don't need to and *cannot*\n\t\t * giveup as this would save  to the 'live' structure not the\n\t\t * checkpointed structure.\n\t\t */\n\t\tif (!MSR_TM_ACTIVE(cpumsr) &&\n\t\t     MSR_TM_ACTIVE(current->thread.regs->msr))\n\t\t\treturn;\n\t\t__giveup_vsx(current);\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__giveup_vsx",
          "args": [
            "current"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "__giveup_vsx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "303-318",
          "snippet": "static void __giveup_vsx(struct task_struct *tsk)\n{\n\tunsigned long msr = tsk->thread.regs->msr;\n\n\t/*\n\t * We should never be ssetting MSR_VSX without also setting\n\t * MSR_FP and MSR_VEC\n\t */\n\tWARN_ON((msr & MSR_VSX) && !((msr & MSR_FP) && (msr & MSR_VEC)));\n\n\t/* __giveup_fpu will clear MSR_VSX */\n\tif (msr & MSR_FP)\n\t\t__giveup_fpu(tsk);\n\tif (msr & MSR_VEC)\n\t\t__giveup_altivec(tsk);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void __giveup_vsx(struct task_struct *tsk)\n{\n\tunsigned long msr = tsk->thread.regs->msr;\n\n\t/*\n\t * We should never be ssetting MSR_VSX without also setting\n\t * MSR_FP and MSR_VEC\n\t */\n\tWARN_ON((msr & MSR_VSX) && !((msr & MSR_FP) && (msr & MSR_VEC)));\n\n\t/* __giveup_fpu will clear MSR_VSX */\n\tif (msr & MSR_FP)\n\t\t__giveup_fpu(tsk);\n\tif (msr & MSR_VEC)\n\t\t__giveup_altivec(tsk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MSR_TM_ACTIVE",
          "args": [
            "current->thread.regs->msr"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MSR_TM_ACTIVE",
          "args": [
            "cpumsr"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_if_tm_restore_required",
          "args": [
            "current"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "check_if_tm_restore_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "104-104",
          "snippet": "static inline void check_if_tm_restore_required(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void check_if_tm_restore_required(struct task_struct *tsk) { }"
        }
      },
      {
        "call_info": {
          "callee": "msr_check_and_set",
          "args": [
            "MSR_FP|MSR_VEC|MSR_VSX"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "msr_check_and_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "120-134",
          "snippet": "unsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "preemptible()"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preemptible",
          "args": [],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid enable_kernel_vsx(void)\n{\n\tunsigned long cpumsr;\n\n\tWARN_ON(preemptible());\n\n\tcpumsr = msr_check_and_set(MSR_FP|MSR_VEC|MSR_VSX);\n\n\tif (current->thread.regs &&\n\t    (current->thread.regs->msr & (MSR_VSX|MSR_VEC|MSR_FP))) {\n\t\tcheck_if_tm_restore_required(current);\n\t\t/*\n\t\t * If a thread has already been reclaimed then the\n\t\t * checkpointed registers are on the CPU but have definitely\n\t\t * been saved by the reclaim code. Don't need to and *cannot*\n\t\t * giveup as this would save  to the 'live' structure not the\n\t\t * checkpointed structure.\n\t\t */\n\t\tif (!MSR_TM_ACTIVE(cpumsr) &&\n\t\t     MSR_TM_ACTIVE(current->thread.regs->msr))\n\t\t\treturn;\n\t\t__giveup_vsx(current);\n\t}\n}"
  },
  {
    "function_name": "giveup_vsx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "320-327",
    "snippet": "static void giveup_vsx(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_FP|MSR_VEC|MSR_VSX);\n\t__giveup_vsx(tsk);\n\tmsr_check_and_clear(MSR_FP|MSR_VEC|MSR_VSX);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "msr_check_and_clear",
          "args": [
            "MSR_FP|MSR_VEC|MSR_VSX"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "__msr_check_and_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "138-150",
          "snippet": "void notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__giveup_vsx",
          "args": [
            "tsk"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "__giveup_vsx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "303-318",
          "snippet": "static void __giveup_vsx(struct task_struct *tsk)\n{\n\tunsigned long msr = tsk->thread.regs->msr;\n\n\t/*\n\t * We should never be ssetting MSR_VSX without also setting\n\t * MSR_FP and MSR_VEC\n\t */\n\tWARN_ON((msr & MSR_VSX) && !((msr & MSR_FP) && (msr & MSR_VEC)));\n\n\t/* __giveup_fpu will clear MSR_VSX */\n\tif (msr & MSR_FP)\n\t\t__giveup_fpu(tsk);\n\tif (msr & MSR_VEC)\n\t\t__giveup_altivec(tsk);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void __giveup_vsx(struct task_struct *tsk)\n{\n\tunsigned long msr = tsk->thread.regs->msr;\n\n\t/*\n\t * We should never be ssetting MSR_VSX without also setting\n\t * MSR_FP and MSR_VEC\n\t */\n\tWARN_ON((msr & MSR_VSX) && !((msr & MSR_FP) && (msr & MSR_VEC)));\n\n\t/* __giveup_fpu will clear MSR_VSX */\n\tif (msr & MSR_FP)\n\t\t__giveup_fpu(tsk);\n\tif (msr & MSR_VEC)\n\t\t__giveup_altivec(tsk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "msr_check_and_set",
          "args": [
            "MSR_FP|MSR_VEC|MSR_VSX"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "msr_check_and_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "120-134",
          "snippet": "unsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_if_tm_restore_required",
          "args": [
            "tsk"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "check_if_tm_restore_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "104-104",
          "snippet": "static inline void check_if_tm_restore_required(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void check_if_tm_restore_required(struct task_struct *tsk) { }"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void giveup_vsx(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_FP|MSR_VEC|MSR_VSX);\n\t__giveup_vsx(tsk);\n\tmsr_check_and_clear(MSR_FP|MSR_VEC|MSR_VSX);\n}"
  },
  {
    "function_name": "__giveup_vsx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "303-318",
    "snippet": "static void __giveup_vsx(struct task_struct *tsk)\n{\n\tunsigned long msr = tsk->thread.regs->msr;\n\n\t/*\n\t * We should never be ssetting MSR_VSX without also setting\n\t * MSR_FP and MSR_VEC\n\t */\n\tWARN_ON((msr & MSR_VSX) && !((msr & MSR_FP) && (msr & MSR_VEC)));\n\n\t/* __giveup_fpu will clear MSR_VSX */\n\tif (msr & MSR_FP)\n\t\t__giveup_fpu(tsk);\n\tif (msr & MSR_VEC)\n\t\t__giveup_altivec(tsk);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__giveup_altivec",
          "args": [
            "tsk"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "__giveup_altivec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "237-247",
          "snippet": "static void __giveup_altivec(struct task_struct *tsk)\n{\n\tunsigned long msr;\n\n\tsave_altivec(tsk);\n\tmsr = tsk->thread.regs->msr;\n\tmsr &= ~MSR_VEC;\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr &= ~MSR_VSX;\n\ttsk->thread.regs->msr = msr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void __giveup_altivec(struct task_struct *tsk)\n{\n\tunsigned long msr;\n\n\tsave_altivec(tsk);\n\tmsr = tsk->thread.regs->msr;\n\tmsr &= ~MSR_VEC;\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr &= ~MSR_VSX;\n\ttsk->thread.regs->msr = msr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__giveup_fpu",
          "args": [
            "tsk"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "__giveup_fpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "233-233",
          "snippet": "static inline void __giveup_fpu(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void __giveup_fpu(struct task_struct *tsk) { }"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "(msr & MSR_VSX) && !((msr & MSR_FP) && (msr & MSR_VEC))"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void __giveup_vsx(struct task_struct *tsk)\n{\n\tunsigned long msr = tsk->thread.regs->msr;\n\n\t/*\n\t * We should never be ssetting MSR_VSX without also setting\n\t * MSR_FP and MSR_VEC\n\t */\n\tWARN_ON((msr & MSR_VSX) && !((msr & MSR_FP) && (msr & MSR_VEC)));\n\n\t/* __giveup_fpu will clear MSR_VSX */\n\tif (msr & MSR_FP)\n\t\t__giveup_fpu(tsk);\n\tif (msr & MSR_VEC)\n\t\t__giveup_altivec(tsk);\n}"
  },
  {
    "function_name": "flush_altivec_to_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "288-298",
    "snippet": "void flush_altivec_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\tpreempt_disable();\n\t\tif (tsk->thread.regs->msr & MSR_VEC) {\n\t\t\tBUG_ON(tsk != current);\n\t\t\tgiveup_altivec(tsk);\n\t\t}\n\t\tpreempt_enable();\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giveup_altivec",
          "args": [
            "tsk"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "giveup_altivec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "249-256",
          "snippet": "void giveup_altivec(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_VEC);\n\t__giveup_altivec(tsk);\n\tmsr_check_and_clear(MSR_VEC);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid giveup_altivec(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_VEC);\n\t__giveup_altivec(tsk);\n\tmsr_check_and_clear(MSR_VEC);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "tsk != current"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid flush_altivec_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\tpreempt_disable();\n\t\tif (tsk->thread.regs->msr & MSR_VEC) {\n\t\t\tBUG_ON(tsk != current);\n\t\t\tgiveup_altivec(tsk);\n\t\t}\n\t\tpreempt_enable();\n\t}\n}"
  },
  {
    "function_name": "enable_kernel_altivec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "259-281",
    "snippet": "void enable_kernel_altivec(void)\n{\n\tunsigned long cpumsr;\n\n\tWARN_ON(preemptible());\n\n\tcpumsr = msr_check_and_set(MSR_VEC);\n\n\tif (current->thread.regs && (current->thread.regs->msr & MSR_VEC)) {\n\t\tcheck_if_tm_restore_required(current);\n\t\t/*\n\t\t * If a thread has already been reclaimed then the\n\t\t * checkpointed registers are on the CPU but have definitely\n\t\t * been saved by the reclaim code. Don't need to and *cannot*\n\t\t * giveup as this would save  to the 'live' structure not the\n\t\t * checkpointed structure.\n\t\t */\n\t\tif (!MSR_TM_ACTIVE(cpumsr) &&\n\t\t     MSR_TM_ACTIVE(current->thread.regs->msr))\n\t\t\treturn;\n\t\t__giveup_altivec(current);\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__giveup_altivec",
          "args": [
            "current"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "__giveup_altivec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "237-247",
          "snippet": "static void __giveup_altivec(struct task_struct *tsk)\n{\n\tunsigned long msr;\n\n\tsave_altivec(tsk);\n\tmsr = tsk->thread.regs->msr;\n\tmsr &= ~MSR_VEC;\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr &= ~MSR_VSX;\n\ttsk->thread.regs->msr = msr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void __giveup_altivec(struct task_struct *tsk)\n{\n\tunsigned long msr;\n\n\tsave_altivec(tsk);\n\tmsr = tsk->thread.regs->msr;\n\tmsr &= ~MSR_VEC;\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr &= ~MSR_VSX;\n\ttsk->thread.regs->msr = msr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MSR_TM_ACTIVE",
          "args": [
            "current->thread.regs->msr"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MSR_TM_ACTIVE",
          "args": [
            "cpumsr"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_if_tm_restore_required",
          "args": [
            "current"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "check_if_tm_restore_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "104-104",
          "snippet": "static inline void check_if_tm_restore_required(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void check_if_tm_restore_required(struct task_struct *tsk) { }"
        }
      },
      {
        "call_info": {
          "callee": "msr_check_and_set",
          "args": [
            "MSR_VEC"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "msr_check_and_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "120-134",
          "snippet": "unsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "preemptible()"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preemptible",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid enable_kernel_altivec(void)\n{\n\tunsigned long cpumsr;\n\n\tWARN_ON(preemptible());\n\n\tcpumsr = msr_check_and_set(MSR_VEC);\n\n\tif (current->thread.regs && (current->thread.regs->msr & MSR_VEC)) {\n\t\tcheck_if_tm_restore_required(current);\n\t\t/*\n\t\t * If a thread has already been reclaimed then the\n\t\t * checkpointed registers are on the CPU but have definitely\n\t\t * been saved by the reclaim code. Don't need to and *cannot*\n\t\t * giveup as this would save  to the 'live' structure not the\n\t\t * checkpointed structure.\n\t\t */\n\t\tif (!MSR_TM_ACTIVE(cpumsr) &&\n\t\t     MSR_TM_ACTIVE(current->thread.regs->msr))\n\t\t\treturn;\n\t\t__giveup_altivec(current);\n\t}\n}"
  },
  {
    "function_name": "giveup_altivec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "249-256",
    "snippet": "void giveup_altivec(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_VEC);\n\t__giveup_altivec(tsk);\n\tmsr_check_and_clear(MSR_VEC);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "msr_check_and_clear",
          "args": [
            "MSR_VEC"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "__msr_check_and_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "138-150",
          "snippet": "void notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__giveup_altivec",
          "args": [
            "tsk"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "__giveup_altivec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "237-247",
          "snippet": "static void __giveup_altivec(struct task_struct *tsk)\n{\n\tunsigned long msr;\n\n\tsave_altivec(tsk);\n\tmsr = tsk->thread.regs->msr;\n\tmsr &= ~MSR_VEC;\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr &= ~MSR_VSX;\n\ttsk->thread.regs->msr = msr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void __giveup_altivec(struct task_struct *tsk)\n{\n\tunsigned long msr;\n\n\tsave_altivec(tsk);\n\tmsr = tsk->thread.regs->msr;\n\tmsr &= ~MSR_VEC;\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr &= ~MSR_VSX;\n\ttsk->thread.regs->msr = msr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "msr_check_and_set",
          "args": [
            "MSR_VEC"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "msr_check_and_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "120-134",
          "snippet": "unsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_if_tm_restore_required",
          "args": [
            "tsk"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "check_if_tm_restore_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "104-104",
          "snippet": "static inline void check_if_tm_restore_required(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void check_if_tm_restore_required(struct task_struct *tsk) { }"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid giveup_altivec(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_VEC);\n\t__giveup_altivec(tsk);\n\tmsr_check_and_clear(MSR_VEC);\n}"
  },
  {
    "function_name": "__giveup_altivec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "237-247",
    "snippet": "static void __giveup_altivec(struct task_struct *tsk)\n{\n\tunsigned long msr;\n\n\tsave_altivec(tsk);\n\tmsr = tsk->thread.regs->msr;\n\tmsr &= ~MSR_VEC;\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr &= ~MSR_VSX;\n\ttsk->thread.regs->msr = msr;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_VSX"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "save_altivec",
          "args": [
            "tsk"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void __giveup_altivec(struct task_struct *tsk)\n{\n\tunsigned long msr;\n\n\tsave_altivec(tsk);\n\tmsr = tsk->thread.regs->msr;\n\tmsr &= ~MSR_VEC;\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr &= ~MSR_VSX;\n\ttsk->thread.regs->msr = msr;\n}"
  },
  {
    "function_name": "__giveup_fpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "233-233",
    "snippet": "static inline void __giveup_fpu(struct task_struct *tsk) { }",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void __giveup_fpu(struct task_struct *tsk) { }"
  },
  {
    "function_name": "enable_kernel_fp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "208-230",
    "snippet": "void enable_kernel_fp(void)\n{\n\tunsigned long cpumsr;\n\n\tWARN_ON(preemptible());\n\n\tcpumsr = msr_check_and_set(MSR_FP);\n\n\tif (current->thread.regs && (current->thread.regs->msr & MSR_FP)) {\n\t\tcheck_if_tm_restore_required(current);\n\t\t/*\n\t\t * If a thread has already been reclaimed then the\n\t\t * checkpointed registers are on the CPU but have definitely\n\t\t * been saved by the reclaim code. Don't need to and *cannot*\n\t\t * giveup as this would save  to the 'live' structure not the\n\t\t * checkpointed structure.\n\t\t */\n\t\tif (!MSR_TM_ACTIVE(cpumsr) &&\n\t\t     MSR_TM_ACTIVE(current->thread.regs->msr))\n\t\t\treturn;\n\t\t__giveup_fpu(current);\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__giveup_fpu",
          "args": [
            "current"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "__giveup_fpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "233-233",
          "snippet": "static inline void __giveup_fpu(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void __giveup_fpu(struct task_struct *tsk) { }"
        }
      },
      {
        "call_info": {
          "callee": "MSR_TM_ACTIVE",
          "args": [
            "current->thread.regs->msr"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MSR_TM_ACTIVE",
          "args": [
            "cpumsr"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_if_tm_restore_required",
          "args": [
            "current"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "check_if_tm_restore_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "104-104",
          "snippet": "static inline void check_if_tm_restore_required(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void check_if_tm_restore_required(struct task_struct *tsk) { }"
        }
      },
      {
        "call_info": {
          "callee": "msr_check_and_set",
          "args": [
            "MSR_FP"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "msr_check_and_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "120-134",
          "snippet": "unsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "preemptible()"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preemptible",
          "args": [],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid enable_kernel_fp(void)\n{\n\tunsigned long cpumsr;\n\n\tWARN_ON(preemptible());\n\n\tcpumsr = msr_check_and_set(MSR_FP);\n\n\tif (current->thread.regs && (current->thread.regs->msr & MSR_FP)) {\n\t\tcheck_if_tm_restore_required(current);\n\t\t/*\n\t\t * If a thread has already been reclaimed then the\n\t\t * checkpointed registers are on the CPU but have definitely\n\t\t * been saved by the reclaim code. Don't need to and *cannot*\n\t\t * giveup as this would save  to the 'live' structure not the\n\t\t * checkpointed structure.\n\t\t */\n\t\tif (!MSR_TM_ACTIVE(cpumsr) &&\n\t\t     MSR_TM_ACTIVE(current->thread.regs->msr))\n\t\t\treturn;\n\t\t__giveup_fpu(current);\n\t}\n}"
  },
  {
    "function_name": "flush_fp_to_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "180-205",
    "snippet": "void flush_fp_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\t/*\n\t\t * We need to disable preemption here because if we didn't,\n\t\t * another process could get scheduled after the regs->msr\n\t\t * test but before we have finished saving the FP registers\n\t\t * to the thread_struct.  That process could take over the\n\t\t * FPU, and then when we get scheduled again we would store\n\t\t * bogus values for the remaining FP registers.\n\t\t */\n\t\tpreempt_disable();\n\t\tif (tsk->thread.regs->msr & MSR_FP) {\n\t\t\t/*\n\t\t\t * This should only ever be called for current or\n\t\t\t * for a stopped child process.  Since we save away\n\t\t\t * the FP register state on context switch,\n\t\t\t * there is something wrong if a stopped child appears\n\t\t\t * to still have its FP state in the CPU registers.\n\t\t\t */\n\t\t\tBUG_ON(tsk != current);\n\t\t\tgiveup_fpu(tsk);\n\t\t}\n\t\tpreempt_enable();\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "giveup_fpu",
          "args": [
            "tsk"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "__giveup_fpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "233-233",
          "snippet": "static inline void __giveup_fpu(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void __giveup_fpu(struct task_struct *tsk) { }"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "tsk != current"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid flush_fp_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\t/*\n\t\t * We need to disable preemption here because if we didn't,\n\t\t * another process could get scheduled after the regs->msr\n\t\t * test but before we have finished saving the FP registers\n\t\t * to the thread_struct.  That process could take over the\n\t\t * FPU, and then when we get scheduled again we would store\n\t\t * bogus values for the remaining FP registers.\n\t\t */\n\t\tpreempt_disable();\n\t\tif (tsk->thread.regs->msr & MSR_FP) {\n\t\t\t/*\n\t\t\t * This should only ever be called for current or\n\t\t\t * for a stopped child process.  Since we save away\n\t\t\t * the FP register state on context switch,\n\t\t\t * there is something wrong if a stopped child appears\n\t\t\t * to still have its FP state in the CPU registers.\n\t\t\t */\n\t\t\tBUG_ON(tsk != current);\n\t\t\tgiveup_fpu(tsk);\n\t\t}\n\t\tpreempt_enable();\n\t}\n}"
  },
  {
    "function_name": "giveup_fpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "166-173",
    "snippet": "void giveup_fpu(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_FP);\n\t__giveup_fpu(tsk);\n\tmsr_check_and_clear(MSR_FP);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "msr_check_and_clear",
          "args": [
            "MSR_FP"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "__msr_check_and_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "138-150",
          "snippet": "void notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__giveup_fpu",
          "args": [
            "tsk"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "__giveup_fpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "233-233",
          "snippet": "static inline void __giveup_fpu(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void __giveup_fpu(struct task_struct *tsk) { }"
        }
      },
      {
        "call_info": {
          "callee": "msr_check_and_set",
          "args": [
            "MSR_FP"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "msr_check_and_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "120-134",
          "snippet": "unsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_if_tm_restore_required",
          "args": [
            "tsk"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "check_if_tm_restore_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "104-104",
          "snippet": "static inline void check_if_tm_restore_required(struct task_struct *tsk) { }",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void check_if_tm_restore_required(struct task_struct *tsk) { }"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid giveup_fpu(struct task_struct *tsk)\n{\n\tcheck_if_tm_restore_required(tsk);\n\n\tmsr_check_and_set(MSR_FP);\n\t__giveup_fpu(tsk);\n\tmsr_check_and_clear(MSR_FP);\n}"
  },
  {
    "function_name": "__giveup_fpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "154-164",
    "snippet": "static void __giveup_fpu(struct task_struct *tsk)\n{\n\tunsigned long msr;\n\n\tsave_fpu(tsk);\n\tmsr = tsk->thread.regs->msr;\n\tmsr &= ~(MSR_FP|MSR_FE0|MSR_FE1);\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr &= ~MSR_VSX;\n\ttsk->thread.regs->msr = msr;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_VSX"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "save_fpu",
          "args": [
            "tsk"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void __giveup_fpu(struct task_struct *tsk)\n{\n\tunsigned long msr;\n\n\tsave_fpu(tsk);\n\tmsr = tsk->thread.regs->msr;\n\tmsr &= ~(MSR_FP|MSR_FE0|MSR_FE1);\n\tif (cpu_has_feature(CPU_FTR_VSX))\n\t\tmsr &= ~MSR_VSX;\n\ttsk->thread.regs->msr = msr;\n}"
  },
  {
    "function_name": "__msr_check_and_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "138-150",
    "snippet": "void notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtmsr_isync",
          "args": [
            "newmsr"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_VSX"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfmsr",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __msr_check_and_clear(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr & ~bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr &= ~MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n}"
  },
  {
    "function_name": "msr_check_and_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "120-134",
    "snippet": "unsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtmsr_isync",
          "args": [
            "newmsr"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_VSX"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfmsr",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nunsigned long notrace msr_check_and_set(unsigned long bits)\n{\n\tunsigned long oldmsr = mfmsr();\n\tunsigned long newmsr;\n\n\tnewmsr = oldmsr | bits;\n\n\tif (cpu_has_feature(CPU_FTR_VSX) && (bits & MSR_FP))\n\t\tnewmsr |= MSR_VSX;\n\n\tif (oldmsr != newmsr)\n\t\tmtmsr_isync(newmsr);\n\n\treturn newmsr;\n}"
  },
  {
    "function_name": "enable_strict_msr_control",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "110-116",
    "snippet": "static int __init enable_strict_msr_control(char *str)\n{\n\tstrict_msr_control = true;\n\tpr_info(\"Enabling strict facility control\\n\");\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool strict_msr_control;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Enabling strict facility control\\n\""
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nbool strict_msr_control;\n\nstatic int __init enable_strict_msr_control(char *str)\n{\n\tstrict_msr_control = true;\n\tpr_info(\"Enabling strict facility control\\n\");\n\n\treturn 0;\n}"
  },
  {
    "function_name": "check_if_tm_restore_required",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "104-104",
    "snippet": "static inline void check_if_tm_restore_required(struct task_struct *tsk) { }",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline void check_if_tm_restore_required(struct task_struct *tsk) { }"
  },
  {
    "function_name": "check_if_tm_restore_required",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
    "lines": "87-101",
    "snippet": "static void check_if_tm_restore_required(struct task_struct *tsk)\n{\n\t/*\n\t * If we are saving the current thread's registers, and the\n\t * thread is in a transactional state, set the TIF_RESTORE_TM\n\t * bit so that we know to restore the registers before\n\t * returning to userspace.\n\t */\n\tif (tsk == current && tsk->thread.regs &&\n\t    MSR_TM_ACTIVE(tsk->thread.regs->msr) &&\n\t    !test_thread_flag(TIF_RESTORE_TM)) {\n\t\ttsk->thread.ckpt_regs.msr = tsk->thread.regs->msr;\n\t\tset_thread_flag(TIF_RESTORE_TM);\n\t}\n}",
    "includes": [
      "#include <linux/kdebug.h>",
      "#include <linux/kprobes.h>",
      "#include <asm/hw_breakpoint.h>",
      "#include <asm/stacktrace.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/exec.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/firmware.h>",
      "#include <asm/debug.h>",
      "#include <asm/tm.h>",
      "#include <asm/switch_to.h>",
      "#include <asm/syscalls.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/mmu.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <linux/seq_buf.h>",
      "#include <linux/pkeys.h>",
      "#include <linux/elf-randomize.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/hw_breakpoint.h>",
      "#include <linux/random.h>",
      "#include <linux/personality.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/mqueue.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/init_task.h>",
      "#include <linux/prctl.h>",
      "#include <linux/elf.h>",
      "#include <linux/user.h>",
      "#include <linux/slab.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/unistd.h>",
      "#include <linux/stddef.h>",
      "#include <linux/smp.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_thread_flag",
          "args": [
            "TIF_RESTORE_TM"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_thread_flag",
          "args": [
            "TIF_RESTORE_TM"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MSR_TM_ACTIVE",
          "args": [
            "tsk->thread.regs->msr"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic void check_if_tm_restore_required(struct task_struct *tsk)\n{\n\t/*\n\t * If we are saving the current thread's registers, and the\n\t * thread is in a transactional state, set the TIF_RESTORE_TM\n\t * bit so that we know to restore the registers before\n\t * returning to userspace.\n\t */\n\tif (tsk == current && tsk->thread.regs &&\n\t    MSR_TM_ACTIVE(tsk->thread.regs->msr) &&\n\t    !test_thread_flag(TIF_RESTORE_TM)) {\n\t\ttsk->thread.ckpt_regs.msr = tsk->thread.regs->msr;\n\t\tset_thread_flag(TIF_RESTORE_TM);\n\t}\n}"
  }
]