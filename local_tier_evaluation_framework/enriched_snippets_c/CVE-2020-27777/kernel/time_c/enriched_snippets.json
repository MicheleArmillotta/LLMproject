[
  {
    "function_name": "rtc_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "1204-1216",
    "snippet": "static int __init rtc_init(void)\n{\n\tstruct platform_device *pdev;\n\n\tif (!ppc_md.get_rtc_time)\n\t\treturn -ENODEV;\n\n\tpdev = platform_device_register_data(NULL, \"rtc-generic\", -1,\n\t\t\t\t\t     &rtc_generic_ops,\n\t\t\t\t\t     sizeof(rtc_generic_ops));\n\n\treturn PTR_ERR_OR_ZERO(pdev);\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PTR_ERR_OR_ZERO",
          "args": [
            "pdev"
          ],
          "line": 1215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "platform_device_register_data",
          "args": [
            "NULL",
            "\"rtc-generic\"",
            "-1",
            "&rtc_generic_ops",
            "sizeof(rtc_generic_ops)"
          ],
          "line": 1211
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic int __init rtc_init(void)\n{\n\tstruct platform_device *pdev;\n\n\tif (!ppc_md.get_rtc_time)\n\t\treturn -ENODEV;\n\n\tpdev = platform_device_register_data(NULL, \"rtc-generic\", -1,\n\t\t\t\t\t     &rtc_generic_ops,\n\t\t\t\t\t     sizeof(rtc_generic_ops));\n\n\treturn PTR_ERR_OR_ZERO(pdev);\n}"
  },
  {
    "function_name": "rtc_generic_set_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "1188-1197",
    "snippet": "static int rtc_generic_set_time(struct device *dev, struct rtc_time *tm)\n{\n\tif (!ppc_md.set_rtc_time)\n\t\treturn -EOPNOTSUPP;\n\n\tif (ppc_md.set_rtc_time(tm) < 0)\n\t\treturn -EOPNOTSUPP;\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.set_rtc_time",
          "args": [
            "tm"
          ],
          "line": 1193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);\n\nstatic int rtc_generic_set_time(struct device *dev, struct rtc_time *tm)\n{\n\tif (!ppc_md.set_rtc_time)\n\t\treturn -EOPNOTSUPP;\n\n\tif (ppc_md.set_rtc_time(tm) < 0)\n\t\treturn -EOPNOTSUPP;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "rtc_generic_get_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "1182-1186",
    "snippet": "static int rtc_generic_get_time(struct device *dev, struct rtc_time *tm)\n{\n\tppc_md.get_rtc_time(tm);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.get_rtc_time",
          "args": [
            "tm"
          ],
          "line": 1184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);\n\nstatic int rtc_generic_get_time(struct device *dev, struct rtc_time *tm)\n{\n\tppc_md.get_rtc_time(tm);\n\treturn 0;\n}"
  },
  {
    "function_name": "calibrate_delay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "1173-1179",
    "snippet": "void calibrate_delay(void)\n{\n\t/* Some generic code (such as spinlock debug) use loops_per_jiffy\n\t * as the number of __delay(1) in a jiffy, so make it so\n\t */\n\tloops_per_jiffy = tb_ticks_per_jiffy;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long tb_ticks_per_jiffy;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long tb_ticks_per_jiffy;\n\nvoid calibrate_delay(void)\n{\n\t/* Some generic code (such as spinlock debug) use loops_per_jiffy\n\t * as the number of __delay(1) in a jiffy, so make it so\n\t */\n\tloops_per_jiffy = tb_ticks_per_jiffy;\n}"
  },
  {
    "function_name": "div128_by_32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "1143-1170",
    "snippet": "void div128_by_32(u64 dividend_high, u64 dividend_low,\n\t\t  unsigned divisor, struct div_result *dr)\n{\n\tunsigned long a, b, c, d;\n\tunsigned long w, x, y, z;\n\tu64 ra, rb, rc;\n\n\ta = dividend_high >> 32;\n\tb = dividend_high & 0xffffffff;\n\tc = dividend_low >> 32;\n\td = dividend_low & 0xffffffff;\n\n\tw = a / divisor;\n\tra = ((u64)(a - (w * divisor)) << 32) + b;\n\n\trb = ((u64) do_div(ra, divisor) << 32) + c;\n\tx = ra;\n\n\trc = ((u64) do_div(rb, divisor) << 32) + d;\n\ty = rb;\n\n\tdo_div(rc, divisor);\n\tz = rc;\n\n\tdr->result_high = ((u64)w << 32) + x;\n\tdr->result_low  = ((u64)y << 32) + z;\n\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "rc",
            "divisor"
          ],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "rb",
            "divisor"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "ra",
            "divisor"
          ],
          "line": 1158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "a - (w * divisor)"
          ],
          "line": 1156
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid div128_by_32(u64 dividend_high, u64 dividend_low,\n\t\t  unsigned divisor, struct div_result *dr)\n{\n\tunsigned long a, b, c, d;\n\tunsigned long w, x, y, z;\n\tu64 ra, rb, rc;\n\n\ta = dividend_high >> 32;\n\tb = dividend_high & 0xffffffff;\n\tc = dividend_low >> 32;\n\td = dividend_low & 0xffffffff;\n\n\tw = a / divisor;\n\tra = ((u64)(a - (w * divisor)) << 32) + b;\n\n\trb = ((u64) do_div(ra, divisor) << 32) + c;\n\tx = ra;\n\n\trc = ((u64) do_div(rb, divisor) << 32) + d;\n\ty = rb;\n\n\tdo_div(rc, divisor);\n\tz = rc;\n\n\tdr->result_high = ((u64)w << 32) + x;\n\tdr->result_low  = ((u64)y << 32) + z;\n\n}"
  },
  {
    "function_name": "time_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "1068-1137",
    "snippet": "void __init time_init(void)\n{\n\tstruct div_result res;\n\tu64 scale;\n\tunsigned shift;\n\n\tif (__USE_RTC()) {\n\t\t/* 601 processor: dec counts down by 128 every 128ns */\n\t\tppc_tb_freq = 1000000000;\n\t} else {\n\t\t/* Normal PowerPC with timebase register */\n\t\tppc_md.calibrate_decr();\n\t\tprintk(KERN_DEBUG \"time_init: decrementer frequency = %lu.%.6lu MHz\\n\",\n\t\t       ppc_tb_freq / 1000000, ppc_tb_freq % 1000000);\n\t\tprintk(KERN_DEBUG \"time_init: processor frequency   = %lu.%.6lu MHz\\n\",\n\t\t       ppc_proc_freq / 1000000, ppc_proc_freq % 1000000);\n\t}\n\n\ttb_ticks_per_jiffy = ppc_tb_freq / HZ;\n\ttb_ticks_per_sec = ppc_tb_freq;\n\ttb_ticks_per_usec = ppc_tb_freq / 1000000;\n\tcalc_cputime_factors();\n\n\t/*\n\t * Compute scale factor for sched_clock.\n\t * The calibrate_decr() function has set tb_ticks_per_sec,\n\t * which is the timebase frequency.\n\t * We compute 1e9 * 2^64 / tb_ticks_per_sec and interpret\n\t * the 128-bit result as a 64.64 fixed-point number.\n\t * We then shift that number right until it is less than 1.0,\n\t * giving us the scale factor and shift count to use in\n\t * sched_clock().\n\t */\n\tdiv128_by_32(1000000000, 0, tb_ticks_per_sec, &res);\n\tscale = res.result_low;\n\tfor (shift = 0; res.result_high != 0; ++shift) {\n\t\tscale = (scale >> 1) | (res.result_high << 63);\n\t\tres.result_high >>= 1;\n\t}\n\ttb_to_ns_scale = scale;\n\ttb_to_ns_shift = shift;\n\t/* Save the current timebase to pretty up CONFIG_PRINTK_TIME */\n\tboot_tb = get_tb_or_rtc();\n\n\t/* If platform provided a timezone (pmac), we correct the time */\n\tif (timezone_offset) {\n\t\tsys_tz.tz_minuteswest = -timezone_offset / 60;\n\t\tsys_tz.tz_dsttime = 0;\n\t}\n\n\tvdso_data->tb_update_count = 0;\n\tvdso_data->tb_ticks_per_sec = tb_ticks_per_sec;\n\n\t/* initialise and enable the large decrementer (if we have one) */\n\tset_decrementer_max();\n\tenable_large_decrementer();\n\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* Register the clocksource */\n\tclocksource_init();\n\n\tinit_decrementer_clockevent();\n\ttick_setup_hrtimer_broadcast();\n\n\tof_clk_init(NULL);\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 rtc_read(struct clocksource *);",
      "static u64 timebase_read(struct clocksource *);",
      "unsigned long tb_ticks_per_jiffy;",
      "unsigned long tb_ticks_per_usec = 100;",
      "unsigned long tb_ticks_per_sec;",
      "static u64 tb_to_ns_scale",
      "extern struct timezone sys_tz;",
      "static long timezone_offset;",
      "unsigned long ppc_proc_freq;",
      "unsigned long ppc_tb_freq;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_clk_init",
          "args": [
            "NULL"
          ],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tick_setup_hrtimer_broadcast",
          "args": [],
          "line": 1134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_decrementer_clockevent",
          "args": [],
          "line": 1133
        },
        "resolved": true,
        "details": {
          "function_name": "init_decrementer_clockevent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "1047-1050",
          "snippet": "static void __init init_decrementer_clockevent(void)\n{\n\tregister_decrementer_clockevent(smp_processor_id());\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void __init init_decrementer_clockevent(void)\n{\n\tregister_decrementer_clockevent(smp_processor_id());\n}"
        }
      },
      {
        "call_info": {
          "callee": "clocksource_init",
          "args": [],
          "line": 1131
        },
        "resolved": true,
        "details": {
          "function_name": "clocksource_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "949-966",
          "snippet": "static void __init clocksource_init(void)\n{\n\tstruct clocksource *clock;\n\n\tif (__USE_RTC())\n\t\tclock = &clocksource_rtc;\n\telse\n\t\tclock = &clocksource_timebase;\n\n\tif (clocksource_register_hz(clock, tb_ticks_per_sec)) {\n\t\tprintk(KERN_ERR \"clocksource: %s is already registered\\n\",\n\t\t       clock->name);\n\t\treturn;\n\t}\n\n\tprintk(KERN_INFO \"clocksource: %s mult[%x] shift[%d] registered\\n\",\n\t       clock->name, clock->mult, clock->shift);\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u64 rtc_read(struct clocksource *);",
            "static struct clocksource clocksource_rtc = {\n\t.name         = \"rtc\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = rtc_read,\n};",
            "static u64 timebase_read(struct clocksource *);",
            "static struct clocksource clocksource_timebase = {\n\t.name         = \"timebase\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = timebase_read,\n};",
            "unsigned long tb_ticks_per_sec;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 rtc_read(struct clocksource *);\nstatic struct clocksource clocksource_rtc = {\n\t.name         = \"rtc\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = rtc_read,\n};\nstatic u64 timebase_read(struct clocksource *);\nstatic struct clocksource clocksource_timebase = {\n\t.name         = \"timebase\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = timebase_read,\n};\nunsigned long tb_ticks_per_sec;\n\nstatic void __init clocksource_init(void)\n{\n\tstruct clocksource *clock;\n\n\tif (__USE_RTC())\n\t\tclock = &clocksource_rtc;\n\telse\n\t\tclock = &clocksource_timebase;\n\n\tif (clocksource_register_hz(clock, tb_ticks_per_sec)) {\n\t\tprintk(KERN_ERR \"clocksource: %s is already registered\\n\",\n\t\t       clock->name);\n\t\treturn;\n\t}\n\n\tprintk(KERN_INFO \"clocksource: %s mult[%x] shift[%d] registered\\n\",\n\t       clock->name, clock->mult, clock->shift);\n}"
        }
      },
      {
        "call_info": {
          "callee": "start_cpu_decrementer",
          "args": [],
          "line": 1128
        },
        "resolved": true,
        "details": {
          "function_name": "start_cpu_decrementer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "758-775",
          "snippet": "static void start_cpu_decrementer(void)\n{\n#if defined(CONFIG_BOOKE) || defined(CONFIG_40x)\n\tunsigned int tcr;\n\n\t/* Clear any pending timer interrupts */\n\tmtspr(SPRN_TSR, TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS);\n\n\ttcr = mfspr(SPRN_TCR);\n\t/*\n\t * The watchdog may have already been enabled by u-boot. So leave\n\t * TRC[WP] (Watchdog Period) alone.\n\t */\n\ttcr &= TCR_WP_MASK;\t/* Clear all bits except for TCR[WP] */\n\ttcr |= TCR_DIE;\t\t/* Enable decrementer */\n\tmtspr(SPRN_TCR, tcr);\n#endif\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void start_cpu_decrementer(void)\n{\n#if defined(CONFIG_BOOKE) || defined(CONFIG_40x)\n\tunsigned int tcr;\n\n\t/* Clear any pending timer interrupts */\n\tmtspr(SPRN_TSR, TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS);\n\n\ttcr = mfspr(SPRN_TCR);\n\t/*\n\t * The watchdog may have already been enabled by u-boot. So leave\n\t * TRC[WP] (Watchdog Period) alone.\n\t */\n\ttcr &= TCR_WP_MASK;\t/* Clear all bits except for TCR[WP] */\n\ttcr |= TCR_DIE;\t\t/* Enable decrementer */\n\tmtspr(SPRN_TCR, tcr);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "enable_large_decrementer",
          "args": [],
          "line": 1123
        },
        "resolved": true,
        "details": {
          "function_name": "enable_large_decrementer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "1004-1018",
          "snippet": "static void enable_large_decrementer(void)\n{\n\tif (!cpu_has_feature(CPU_FTR_ARCH_300))\n\t\treturn;\n\n\tif (decrementer_max <= DECREMENTER_DEFAULT_MAX)\n\t\treturn;\n\n\t/*\n\t * If we're running as the hypervisor we need to enable the LD manually\n\t * otherwise firmware should have done it for us.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE))\n\t\tmtspr(SPRN_LPCR, mfspr(SPRN_LPCR) | LPCR_LD);\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define DECREMENTER_DEFAULT_MAX 0x7FFFFFFF"
          ],
          "globals_used": [
            "u64 decrementer_max = DECREMENTER_DEFAULT_MAX;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define DECREMENTER_DEFAULT_MAX 0x7FFFFFFF\n\nu64 decrementer_max = DECREMENTER_DEFAULT_MAX;\n\nstatic void enable_large_decrementer(void)\n{\n\tif (!cpu_has_feature(CPU_FTR_ARCH_300))\n\t\treturn;\n\n\tif (decrementer_max <= DECREMENTER_DEFAULT_MAX)\n\t\treturn;\n\n\t/*\n\t * If we're running as the hypervisor we need to enable the LD manually\n\t * otherwise firmware should have done it for us.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE))\n\t\tmtspr(SPRN_LPCR, mfspr(SPRN_LPCR) | LPCR_LD);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_decrementer_max",
          "args": [],
          "line": 1122
        },
        "resolved": true,
        "details": {
          "function_name": "set_decrementer_max",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "1020-1045",
          "snippet": "static void __init set_decrementer_max(void)\n{\n\tstruct device_node *cpu;\n\tu32 bits = 32;\n\n\t/* Prior to ISAv3 the decrementer is always 32 bit */\n\tif (!cpu_has_feature(CPU_FTR_ARCH_300))\n\t\treturn;\n\n\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\tif (of_property_read_u32(cpu, \"ibm,dec-bits\", &bits) == 0) {\n\t\tif (bits > 64 || bits < 32) {\n\t\t\tpr_warn(\"time_init: firmware supplied invalid ibm,dec-bits\");\n\t\t\tbits = 32;\n\t\t}\n\n\t\t/* calculate the signed maximum given this many bits */\n\t\tdecrementer_max = (1ul << (bits - 1)) - 1;\n\t}\n\n\tof_node_put(cpu);\n\n\tpr_info(\"time_init: %u bit decrementer (max: %llx)\\n\",\n\t\tbits, decrementer_max);\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "u64 decrementer_max = DECREMENTER_DEFAULT_MAX;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nu64 decrementer_max = DECREMENTER_DEFAULT_MAX;\n\nstatic void __init set_decrementer_max(void)\n{\n\tstruct device_node *cpu;\n\tu32 bits = 32;\n\n\t/* Prior to ISAv3 the decrementer is always 32 bit */\n\tif (!cpu_has_feature(CPU_FTR_ARCH_300))\n\t\treturn;\n\n\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\tif (of_property_read_u32(cpu, \"ibm,dec-bits\", &bits) == 0) {\n\t\tif (bits > 64 || bits < 32) {\n\t\t\tpr_warn(\"time_init: firmware supplied invalid ibm,dec-bits\");\n\t\t\tbits = 32;\n\t\t}\n\n\t\t/* calculate the signed maximum given this many bits */\n\t\tdecrementer_max = (1ul << (bits - 1)) - 1;\n\t}\n\n\tof_node_put(cpu);\n\n\tpr_info(\"time_init: %u bit decrementer (max: %llx)\\n\",\n\t\tbits, decrementer_max);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_tb_or_rtc",
          "args": [],
          "line": 1110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div128_by_32",
          "args": [
            "1000000000",
            "0",
            "tb_ticks_per_sec",
            "&res"
          ],
          "line": 1101
        },
        "resolved": true,
        "details": {
          "function_name": "div128_by_32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "1143-1170",
          "snippet": "void div128_by_32(u64 dividend_high, u64 dividend_low,\n\t\t  unsigned divisor, struct div_result *dr)\n{\n\tunsigned long a, b, c, d;\n\tunsigned long w, x, y, z;\n\tu64 ra, rb, rc;\n\n\ta = dividend_high >> 32;\n\tb = dividend_high & 0xffffffff;\n\tc = dividend_low >> 32;\n\td = dividend_low & 0xffffffff;\n\n\tw = a / divisor;\n\tra = ((u64)(a - (w * divisor)) << 32) + b;\n\n\trb = ((u64) do_div(ra, divisor) << 32) + c;\n\tx = ra;\n\n\trc = ((u64) do_div(rb, divisor) << 32) + d;\n\ty = rb;\n\n\tdo_div(rc, divisor);\n\tz = rc;\n\n\tdr->result_high = ((u64)w << 32) + x;\n\tdr->result_low  = ((u64)y << 32) + z;\n\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid div128_by_32(u64 dividend_high, u64 dividend_low,\n\t\t  unsigned divisor, struct div_result *dr)\n{\n\tunsigned long a, b, c, d;\n\tunsigned long w, x, y, z;\n\tu64 ra, rb, rc;\n\n\ta = dividend_high >> 32;\n\tb = dividend_high & 0xffffffff;\n\tc = dividend_low >> 32;\n\td = dividend_low & 0xffffffff;\n\n\tw = a / divisor;\n\tra = ((u64)(a - (w * divisor)) << 32) + b;\n\n\trb = ((u64) do_div(ra, divisor) << 32) + c;\n\tx = ra;\n\n\trc = ((u64) do_div(rb, divisor) << 32) + d;\n\ty = rb;\n\n\tdo_div(rc, divisor);\n\tz = rc;\n\n\tdr->result_high = ((u64)w << 32) + x;\n\tdr->result_low  = ((u64)y << 32) + z;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "calc_cputime_factors",
          "args": [],
          "line": 1089
        },
        "resolved": true,
        "details": {
          "function_name": "calc_cputime_factors",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "163-169",
          "snippet": "static void calc_cputime_factors(void)\n{\n\tstruct div_result res;\n\n\tdiv128_by_32(1000000, 0, tb_ticks_per_sec, &res);\n\t__cputime_usec_factor = res.result_low;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned long tb_ticks_per_sec;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long tb_ticks_per_sec;\n\nstatic void calc_cputime_factors(void)\n{\n\tstruct div_result res;\n\n\tdiv128_by_32(1000000, 0, tb_ticks_per_sec, &res);\n\t__cputime_usec_factor = res.result_low;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_DEBUG \"time_init: processor frequency   = %lu.%.6lu MHz\\n\"",
            "ppc_proc_freq / 1000000",
            "ppc_proc_freq % 1000000"
          ],
          "line": 1082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_DEBUG \"time_init: decrementer frequency = %lu.%.6lu MHz\\n\"",
            "ppc_tb_freq / 1000000",
            "ppc_tb_freq % 1000000"
          ],
          "line": 1080
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.calibrate_decr",
          "args": [],
          "line": 1079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__USE_RTC",
          "args": [],
          "line": 1074
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 rtc_read(struct clocksource *);\nstatic u64 timebase_read(struct clocksource *);\nunsigned long tb_ticks_per_jiffy;\nunsigned long tb_ticks_per_usec = 100;\nunsigned long tb_ticks_per_sec;\nstatic u64 tb_to_ns_scale;\nextern struct timezone sys_tz;\nstatic long timezone_offset;\nunsigned long ppc_proc_freq;\nunsigned long ppc_tb_freq;\n\nvoid __init time_init(void)\n{\n\tstruct div_result res;\n\tu64 scale;\n\tunsigned shift;\n\n\tif (__USE_RTC()) {\n\t\t/* 601 processor: dec counts down by 128 every 128ns */\n\t\tppc_tb_freq = 1000000000;\n\t} else {\n\t\t/* Normal PowerPC with timebase register */\n\t\tppc_md.calibrate_decr();\n\t\tprintk(KERN_DEBUG \"time_init: decrementer frequency = %lu.%.6lu MHz\\n\",\n\t\t       ppc_tb_freq / 1000000, ppc_tb_freq % 1000000);\n\t\tprintk(KERN_DEBUG \"time_init: processor frequency   = %lu.%.6lu MHz\\n\",\n\t\t       ppc_proc_freq / 1000000, ppc_proc_freq % 1000000);\n\t}\n\n\ttb_ticks_per_jiffy = ppc_tb_freq / HZ;\n\ttb_ticks_per_sec = ppc_tb_freq;\n\ttb_ticks_per_usec = ppc_tb_freq / 1000000;\n\tcalc_cputime_factors();\n\n\t/*\n\t * Compute scale factor for sched_clock.\n\t * The calibrate_decr() function has set tb_ticks_per_sec,\n\t * which is the timebase frequency.\n\t * We compute 1e9 * 2^64 / tb_ticks_per_sec and interpret\n\t * the 128-bit result as a 64.64 fixed-point number.\n\t * We then shift that number right until it is less than 1.0,\n\t * giving us the scale factor and shift count to use in\n\t * sched_clock().\n\t */\n\tdiv128_by_32(1000000000, 0, tb_ticks_per_sec, &res);\n\tscale = res.result_low;\n\tfor (shift = 0; res.result_high != 0; ++shift) {\n\t\tscale = (scale >> 1) | (res.result_high << 63);\n\t\tres.result_high >>= 1;\n\t}\n\ttb_to_ns_scale = scale;\n\ttb_to_ns_shift = shift;\n\t/* Save the current timebase to pretty up CONFIG_PRINTK_TIME */\n\tboot_tb = get_tb_or_rtc();\n\n\t/* If platform provided a timezone (pmac), we correct the time */\n\tif (timezone_offset) {\n\t\tsys_tz.tz_minuteswest = -timezone_offset / 60;\n\t\tsys_tz.tz_dsttime = 0;\n\t}\n\n\tvdso_data->tb_update_count = 0;\n\tvdso_data->tb_ticks_per_sec = tb_ticks_per_sec;\n\n\t/* initialise and enable the large decrementer (if we have one) */\n\tset_decrementer_max();\n\tenable_large_decrementer();\n\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* Register the clocksource */\n\tclocksource_init();\n\n\tinit_decrementer_clockevent();\n\ttick_setup_hrtimer_broadcast();\n\n\tof_clk_init(NULL);\n}"
  },
  {
    "function_name": "secondary_cpu_time_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "1052-1065",
    "snippet": "void secondary_cpu_time_init(void)\n{\n\t/* Enable and test the large decrementer for this cpu */\n\tenable_large_decrementer();\n\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* FIME: Should make unrelatred change to move snapshot_timebase\n\t * call here ! */\n\tregister_decrementer_clockevent(smp_processor_id());\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_decrementer_clockevent",
          "args": [
            "smp_processor_id()"
          ],
          "line": 1064
        },
        "resolved": true,
        "details": {
          "function_name": "register_decrementer_clockevent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "987-1002",
          "snippet": "static void register_decrementer_clockevent(int cpu)\n{\n\tstruct clock_event_device *dec = &per_cpu(decrementers, cpu);\n\n\t*dec = decrementer_clockevent;\n\tdec->cpumask = cpumask_of(cpu);\n\n\tclockevents_config_and_register(dec, ppc_tb_freq, 2, decrementer_max);\n\n\tprintk_once(KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\",\n\t\t    dec->name, dec->mult, dec->shift, cpu);\n\n\t/* Set values for KVM, see kvm_emulate_dec() */\n\tdecrementer_clockevent.mult = dec->mult;\n\tdecrementer_clockevent.shift = dec->shift;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "u64 decrementer_max = DECREMENTER_DEFAULT_MAX;",
            "struct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_oneshot_stopped = decrementer_shutdown,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};",
            "static DEFINE_PER_CPU(struct clock_event_device, decrementers);",
            "unsigned long ppc_tb_freq;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nu64 decrementer_max = DECREMENTER_DEFAULT_MAX;\nstruct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_oneshot_stopped = decrementer_shutdown,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};\nstatic DEFINE_PER_CPU(struct clock_event_device, decrementers);\nunsigned long ppc_tb_freq;\n\nstatic void register_decrementer_clockevent(int cpu)\n{\n\tstruct clock_event_device *dec = &per_cpu(decrementers, cpu);\n\n\t*dec = decrementer_clockevent;\n\tdec->cpumask = cpumask_of(cpu);\n\n\tclockevents_config_and_register(dec, ppc_tb_freq, 2, decrementer_max);\n\n\tprintk_once(KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\",\n\t\t    dec->name, dec->mult, dec->shift, cpu);\n\n\t/* Set values for KVM, see kvm_emulate_dec() */\n\tdecrementer_clockevent.mult = dec->mult;\n\tdecrementer_clockevent.shift = dec->shift;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "start_cpu_decrementer",
          "args": [],
          "line": 1060
        },
        "resolved": true,
        "details": {
          "function_name": "start_cpu_decrementer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "758-775",
          "snippet": "static void start_cpu_decrementer(void)\n{\n#if defined(CONFIG_BOOKE) || defined(CONFIG_40x)\n\tunsigned int tcr;\n\n\t/* Clear any pending timer interrupts */\n\tmtspr(SPRN_TSR, TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS);\n\n\ttcr = mfspr(SPRN_TCR);\n\t/*\n\t * The watchdog may have already been enabled by u-boot. So leave\n\t * TRC[WP] (Watchdog Period) alone.\n\t */\n\ttcr &= TCR_WP_MASK;\t/* Clear all bits except for TCR[WP] */\n\ttcr |= TCR_DIE;\t\t/* Enable decrementer */\n\tmtspr(SPRN_TCR, tcr);\n#endif\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void start_cpu_decrementer(void)\n{\n#if defined(CONFIG_BOOKE) || defined(CONFIG_40x)\n\tunsigned int tcr;\n\n\t/* Clear any pending timer interrupts */\n\tmtspr(SPRN_TSR, TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS);\n\n\ttcr = mfspr(SPRN_TCR);\n\t/*\n\t * The watchdog may have already been enabled by u-boot. So leave\n\t * TRC[WP] (Watchdog Period) alone.\n\t */\n\ttcr &= TCR_WP_MASK;\t/* Clear all bits except for TCR[WP] */\n\ttcr |= TCR_DIE;\t\t/* Enable decrementer */\n\tmtspr(SPRN_TCR, tcr);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "enable_large_decrementer",
          "args": [],
          "line": 1055
        },
        "resolved": true,
        "details": {
          "function_name": "enable_large_decrementer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "1004-1018",
          "snippet": "static void enable_large_decrementer(void)\n{\n\tif (!cpu_has_feature(CPU_FTR_ARCH_300))\n\t\treturn;\n\n\tif (decrementer_max <= DECREMENTER_DEFAULT_MAX)\n\t\treturn;\n\n\t/*\n\t * If we're running as the hypervisor we need to enable the LD manually\n\t * otherwise firmware should have done it for us.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE))\n\t\tmtspr(SPRN_LPCR, mfspr(SPRN_LPCR) | LPCR_LD);\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define DECREMENTER_DEFAULT_MAX 0x7FFFFFFF"
          ],
          "globals_used": [
            "u64 decrementer_max = DECREMENTER_DEFAULT_MAX;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define DECREMENTER_DEFAULT_MAX 0x7FFFFFFF\n\nu64 decrementer_max = DECREMENTER_DEFAULT_MAX;\n\nstatic void enable_large_decrementer(void)\n{\n\tif (!cpu_has_feature(CPU_FTR_ARCH_300))\n\t\treturn;\n\n\tif (decrementer_max <= DECREMENTER_DEFAULT_MAX)\n\t\treturn;\n\n\t/*\n\t * If we're running as the hypervisor we need to enable the LD manually\n\t * otherwise firmware should have done it for us.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE))\n\t\tmtspr(SPRN_LPCR, mfspr(SPRN_LPCR) | LPCR_LD);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid secondary_cpu_time_init(void)\n{\n\t/* Enable and test the large decrementer for this cpu */\n\tenable_large_decrementer();\n\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* FIME: Should make unrelatred change to move snapshot_timebase\n\t * call here ! */\n\tregister_decrementer_clockevent(smp_processor_id());\n}"
  },
  {
    "function_name": "init_decrementer_clockevent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "1047-1050",
    "snippet": "static void __init init_decrementer_clockevent(void)\n{\n\tregister_decrementer_clockevent(smp_processor_id());\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_decrementer_clockevent",
          "args": [
            "smp_processor_id()"
          ],
          "line": 1049
        },
        "resolved": true,
        "details": {
          "function_name": "register_decrementer_clockevent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "987-1002",
          "snippet": "static void register_decrementer_clockevent(int cpu)\n{\n\tstruct clock_event_device *dec = &per_cpu(decrementers, cpu);\n\n\t*dec = decrementer_clockevent;\n\tdec->cpumask = cpumask_of(cpu);\n\n\tclockevents_config_and_register(dec, ppc_tb_freq, 2, decrementer_max);\n\n\tprintk_once(KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\",\n\t\t    dec->name, dec->mult, dec->shift, cpu);\n\n\t/* Set values for KVM, see kvm_emulate_dec() */\n\tdecrementer_clockevent.mult = dec->mult;\n\tdecrementer_clockevent.shift = dec->shift;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "u64 decrementer_max = DECREMENTER_DEFAULT_MAX;",
            "struct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_oneshot_stopped = decrementer_shutdown,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};",
            "static DEFINE_PER_CPU(struct clock_event_device, decrementers);",
            "unsigned long ppc_tb_freq;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nu64 decrementer_max = DECREMENTER_DEFAULT_MAX;\nstruct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_oneshot_stopped = decrementer_shutdown,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};\nstatic DEFINE_PER_CPU(struct clock_event_device, decrementers);\nunsigned long ppc_tb_freq;\n\nstatic void register_decrementer_clockevent(int cpu)\n{\n\tstruct clock_event_device *dec = &per_cpu(decrementers, cpu);\n\n\t*dec = decrementer_clockevent;\n\tdec->cpumask = cpumask_of(cpu);\n\n\tclockevents_config_and_register(dec, ppc_tb_freq, 2, decrementer_max);\n\n\tprintk_once(KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\",\n\t\t    dec->name, dec->mult, dec->shift, cpu);\n\n\t/* Set values for KVM, see kvm_emulate_dec() */\n\tdecrementer_clockevent.mult = dec->mult;\n\tdecrementer_clockevent.shift = dec->shift;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 1049
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void __init init_decrementer_clockevent(void)\n{\n\tregister_decrementer_clockevent(smp_processor_id());\n}"
  },
  {
    "function_name": "set_decrementer_max",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "1020-1045",
    "snippet": "static void __init set_decrementer_max(void)\n{\n\tstruct device_node *cpu;\n\tu32 bits = 32;\n\n\t/* Prior to ISAv3 the decrementer is always 32 bit */\n\tif (!cpu_has_feature(CPU_FTR_ARCH_300))\n\t\treturn;\n\n\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\tif (of_property_read_u32(cpu, \"ibm,dec-bits\", &bits) == 0) {\n\t\tif (bits > 64 || bits < 32) {\n\t\t\tpr_warn(\"time_init: firmware supplied invalid ibm,dec-bits\");\n\t\t\tbits = 32;\n\t\t}\n\n\t\t/* calculate the signed maximum given this many bits */\n\t\tdecrementer_max = (1ul << (bits - 1)) - 1;\n\t}\n\n\tof_node_put(cpu);\n\n\tpr_info(\"time_init: %u bit decrementer (max: %llx)\\n\",\n\t\tbits, decrementer_max);\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "u64 decrementer_max = DECREMENTER_DEFAULT_MAX;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"time_init: %u bit decrementer (max: %llx)\\n\"",
            "bits",
            "decrementer_max"
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "cpu"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"time_init: firmware supplied invalid ibm,dec-bits\""
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_property_read_u32",
          "args": [
            "cpu",
            "\"ibm,dec-bits\"",
            "&bits"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_type",
          "args": [
            "NULL",
            "\"cpu\""
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_300"
          ],
          "line": 1026
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nu64 decrementer_max = DECREMENTER_DEFAULT_MAX;\n\nstatic void __init set_decrementer_max(void)\n{\n\tstruct device_node *cpu;\n\tu32 bits = 32;\n\n\t/* Prior to ISAv3 the decrementer is always 32 bit */\n\tif (!cpu_has_feature(CPU_FTR_ARCH_300))\n\t\treturn;\n\n\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\tif (of_property_read_u32(cpu, \"ibm,dec-bits\", &bits) == 0) {\n\t\tif (bits > 64 || bits < 32) {\n\t\t\tpr_warn(\"time_init: firmware supplied invalid ibm,dec-bits\");\n\t\t\tbits = 32;\n\t\t}\n\n\t\t/* calculate the signed maximum given this many bits */\n\t\tdecrementer_max = (1ul << (bits - 1)) - 1;\n\t}\n\n\tof_node_put(cpu);\n\n\tpr_info(\"time_init: %u bit decrementer (max: %llx)\\n\",\n\t\tbits, decrementer_max);\n}"
  },
  {
    "function_name": "enable_large_decrementer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "1004-1018",
    "snippet": "static void enable_large_decrementer(void)\n{\n\tif (!cpu_has_feature(CPU_FTR_ARCH_300))\n\t\treturn;\n\n\tif (decrementer_max <= DECREMENTER_DEFAULT_MAX)\n\t\treturn;\n\n\t/*\n\t * If we're running as the hypervisor we need to enable the LD manually\n\t * otherwise firmware should have done it for us.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE))\n\t\tmtspr(SPRN_LPCR, mfspr(SPRN_LPCR) | LPCR_LD);\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define DECREMENTER_DEFAULT_MAX 0x7FFFFFFF"
    ],
    "globals_used": [
      "u64 decrementer_max = DECREMENTER_DEFAULT_MAX;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPCR",
            "mfspr(SPRN_LPCR) | LPCR_LD"
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_LPCR"
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_HVMODE"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_300"
          ],
          "line": 1006
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define DECREMENTER_DEFAULT_MAX 0x7FFFFFFF\n\nu64 decrementer_max = DECREMENTER_DEFAULT_MAX;\n\nstatic void enable_large_decrementer(void)\n{\n\tif (!cpu_has_feature(CPU_FTR_ARCH_300))\n\t\treturn;\n\n\tif (decrementer_max <= DECREMENTER_DEFAULT_MAX)\n\t\treturn;\n\n\t/*\n\t * If we're running as the hypervisor we need to enable the LD manually\n\t * otherwise firmware should have done it for us.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE))\n\t\tmtspr(SPRN_LPCR, mfspr(SPRN_LPCR) | LPCR_LD);\n}"
  },
  {
    "function_name": "register_decrementer_clockevent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "987-1002",
    "snippet": "static void register_decrementer_clockevent(int cpu)\n{\n\tstruct clock_event_device *dec = &per_cpu(decrementers, cpu);\n\n\t*dec = decrementer_clockevent;\n\tdec->cpumask = cpumask_of(cpu);\n\n\tclockevents_config_and_register(dec, ppc_tb_freq, 2, decrementer_max);\n\n\tprintk_once(KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\",\n\t\t    dec->name, dec->mult, dec->shift, cpu);\n\n\t/* Set values for KVM, see kvm_emulate_dec() */\n\tdecrementer_clockevent.mult = dec->mult;\n\tdecrementer_clockevent.shift = dec->shift;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "u64 decrementer_max = DECREMENTER_DEFAULT_MAX;",
      "struct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_oneshot_stopped = decrementer_shutdown,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};",
      "static DEFINE_PER_CPU(struct clock_event_device, decrementers);",
      "unsigned long ppc_tb_freq;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk_once",
          "args": [
            "KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\"",
            "dec->name",
            "dec->mult",
            "dec->shift",
            "cpu"
          ],
          "line": 996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clockevents_config_and_register",
          "args": [
            "dec",
            "ppc_tb_freq",
            "2",
            "decrementer_max"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_of",
          "args": [
            "cpu"
          ],
          "line": 992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "decrementers",
            "cpu"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nu64 decrementer_max = DECREMENTER_DEFAULT_MAX;\nstruct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_oneshot_stopped = decrementer_shutdown,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};\nstatic DEFINE_PER_CPU(struct clock_event_device, decrementers);\nunsigned long ppc_tb_freq;\n\nstatic void register_decrementer_clockevent(int cpu)\n{\n\tstruct clock_event_device *dec = &per_cpu(decrementers, cpu);\n\n\t*dec = decrementer_clockevent;\n\tdec->cpumask = cpumask_of(cpu);\n\n\tclockevents_config_and_register(dec, ppc_tb_freq, 2, decrementer_max);\n\n\tprintk_once(KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\",\n\t\t    dec->name, dec->mult, dec->shift, cpu);\n\n\t/* Set values for KVM, see kvm_emulate_dec() */\n\tdecrementer_clockevent.mult = dec->mult;\n\tdecrementer_clockevent.shift = dec->shift;\n}"
  },
  {
    "function_name": "decrementer_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "981-985",
    "snippet": "static int decrementer_shutdown(struct clock_event_device *dev)\n{\n\tdecrementer_set_next_event(decrementer_max, dev);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "u64 decrementer_max = DECREMENTER_DEFAULT_MAX;",
      "static int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "decrementer_set_next_event",
          "args": [
            "decrementer_max",
            "dev"
          ],
          "line": 983
        },
        "resolved": true,
        "details": {
          "function_name": "decrementer_set_next_event",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "968-979",
          "snippet": "static int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev)\n{\n\t__this_cpu_write(decrementers_next_tb, get_tb_or_rtc() + evt);\n\tset_dec(evt);\n\n\t/* We may have raced with new irq work */\n\tif (test_irq_work_pending())\n\t\tset_dec(1);\n\n\treturn 0;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);",
            "static int decrementer_shutdown(struct clock_event_device *evt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);\nstatic int decrementer_shutdown(struct clock_event_device *evt);\n\nstatic int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev)\n{\n\t__this_cpu_write(decrementers_next_tb, get_tb_or_rtc() + evt);\n\tset_dec(evt);\n\n\t/* We may have raced with new irq work */\n\tif (test_irq_work_pending())\n\t\tset_dec(1);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nu64 decrementer_max = DECREMENTER_DEFAULT_MAX;\nstatic int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);\n\nstatic int decrementer_shutdown(struct clock_event_device *dev)\n{\n\tdecrementer_set_next_event(decrementer_max, dev);\n\treturn 0;\n}"
  },
  {
    "function_name": "decrementer_set_next_event",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "968-979",
    "snippet": "static int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev)\n{\n\t__this_cpu_write(decrementers_next_tb, get_tb_or_rtc() + evt);\n\tset_dec(evt);\n\n\t/* We may have raced with new irq work */\n\tif (test_irq_work_pending())\n\t\tset_dec(1);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);",
      "static int decrementer_shutdown(struct clock_event_device *evt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "1"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_irq_work_pending",
          "args": [],
          "line": 975
        },
        "resolved": true,
        "details": {
          "function_name": "test_irq_work_pending",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "503-511",
          "snippet": "static inline unsigned long test_irq_work_pending(void)\n{\n\tunsigned long x;\n\n\tasm volatile(\"lbz %0,%1(13)\"\n\t\t: \"=r\" (x)\n\t\t: \"i\" (offsetof(struct paca_struct, irq_work_pending)));\n\treturn x;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline unsigned long test_irq_work_pending(void)\n{\n\tunsigned long x;\n\n\tasm volatile(\"lbz %0,%1(13)\"\n\t\t: \"=r\" (x)\n\t\t: \"i\" (offsetof(struct paca_struct, irq_work_pending)));\n\treturn x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "evt"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__this_cpu_write",
          "args": [
            "decrementers_next_tb",
            "get_tb_or_rtc() + evt"
          ],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_tb_or_rtc",
          "args": [],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);\nstatic int decrementer_shutdown(struct clock_event_device *evt);\n\nstatic int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev)\n{\n\t__this_cpu_write(decrementers_next_tb, get_tb_or_rtc() + evt);\n\tset_dec(evt);\n\n\t/* We may have raced with new irq work */\n\tif (test_irq_work_pending())\n\t\tset_dec(1);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "clocksource_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "949-966",
    "snippet": "static void __init clocksource_init(void)\n{\n\tstruct clocksource *clock;\n\n\tif (__USE_RTC())\n\t\tclock = &clocksource_rtc;\n\telse\n\t\tclock = &clocksource_timebase;\n\n\tif (clocksource_register_hz(clock, tb_ticks_per_sec)) {\n\t\tprintk(KERN_ERR \"clocksource: %s is already registered\\n\",\n\t\t       clock->name);\n\t\treturn;\n\t}\n\n\tprintk(KERN_INFO \"clocksource: %s mult[%x] shift[%d] registered\\n\",\n\t       clock->name, clock->mult, clock->shift);\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 rtc_read(struct clocksource *);",
      "static struct clocksource clocksource_rtc = {\n\t.name         = \"rtc\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = rtc_read,\n};",
      "static u64 timebase_read(struct clocksource *);",
      "static struct clocksource clocksource_timebase = {\n\t.name         = \"timebase\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = timebase_read,\n};",
      "unsigned long tb_ticks_per_sec;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"clocksource: %s mult[%x] shift[%d] registered\\n\"",
            "clock->name",
            "clock->mult",
            "clock->shift"
          ],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"clocksource: %s is already registered\\n\"",
            "clock->name"
          ],
          "line": 959
        },
        "resolved": true,
        "details": {
          "function_name": "printk_log_rtas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/rtasd.c",
          "lines": "110-157",
          "snippet": "static void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}",
          "includes": [
            "#include <asm/topology.h>",
            "#include <asm/machdep.h>",
            "#include <linux/atomic.h>",
            "#include <asm/nvram.h>",
            "#include <asm/prom.h>",
            "#include <asm/rtas.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/topology.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/cpu.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool full_rtas_msgs;",
            "static int error_log_cnt;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/topology.h>\n#include <asm/machdep.h>\n#include <linux/atomic.h>\n#include <asm/nvram.h>\n#include <asm/prom.h>\n#include <asm/rtas.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <linux/topology.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/cpu.h>\n#include <linux/spinlock.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic bool full_rtas_msgs;\nstatic int error_log_cnt;\n\nstatic void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "clocksource_register_hz",
          "args": [
            "clock",
            "tb_ticks_per_sec"
          ],
          "line": 958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__USE_RTC",
          "args": [],
          "line": 953
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 rtc_read(struct clocksource *);\nstatic struct clocksource clocksource_rtc = {\n\t.name         = \"rtc\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = rtc_read,\n};\nstatic u64 timebase_read(struct clocksource *);\nstatic struct clocksource clocksource_timebase = {\n\t.name         = \"timebase\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = timebase_read,\n};\nunsigned long tb_ticks_per_sec;\n\nstatic void __init clocksource_init(void)\n{\n\tstruct clocksource *clock;\n\n\tif (__USE_RTC())\n\t\tclock = &clocksource_rtc;\n\telse\n\t\tclock = &clocksource_timebase;\n\n\tif (clocksource_register_hz(clock, tb_ticks_per_sec)) {\n\t\tprintk(KERN_ERR \"clocksource: %s is already registered\\n\",\n\t\t       clock->name);\n\t\treturn;\n\t}\n\n\tprintk(KERN_INFO \"clocksource: %s mult[%x] shift[%d] registered\\n\",\n\t       clock->name, clock->mult, clock->shift);\n}"
  },
  {
    "function_name": "update_vsyscall_tz",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "943-947",
    "snippet": "void update_vsyscall_tz(void)\n{\n\tvdso_data->tz_minuteswest = sys_tz.tz_minuteswest;\n\tvdso_data->tz_dsttime = sys_tz.tz_dsttime;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct timezone sys_tz;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nextern struct timezone sys_tz;\n\nvoid update_vsyscall_tz(void)\n{\n\tvdso_data->tz_minuteswest = sys_tz.tz_minuteswest;\n\tvdso_data->tz_dsttime = sys_tz.tz_dsttime;\n}"
  },
  {
    "function_name": "update_vsyscall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "861-941",
    "snippet": "void update_vsyscall(struct timekeeper *tk)\n{\n\tstruct timespec64 xt;\n\tstruct clocksource *clock = tk->tkr_mono.clock;\n\tu32 mult = tk->tkr_mono.mult;\n\tu32 shift = tk->tkr_mono.shift;\n\tu64 cycle_last = tk->tkr_mono.cycle_last;\n\tu64 new_tb_to_xs, new_stamp_xsec;\n\tu64 frac_sec;\n\n\tif (clock != &clocksource_timebase)\n\t\treturn;\n\n\txt.tv_sec = tk->xtime_sec;\n\txt.tv_nsec = (long)(tk->tkr_mono.xtime_nsec >> tk->tkr_mono.shift);\n\n\t/* Make userspace gettimeofday spin until we're done. */\n\t++vdso_data->tb_update_count;\n\tsmp_mb();\n\n\t/*\n\t * This computes ((2^20 / 1e9) * mult) >> shift as a\n\t * 0.64 fixed-point fraction.\n\t * The computation in the else clause below won't overflow\n\t * (as long as the timebase frequency is >= 1.049 MHz)\n\t * but loses precision because we lose the low bits of the constant\n\t * in the shift.  Note that 19342813113834067 ~= 2^(20+64) / 1e9.\n\t * For a shift of 24 the error is about 0.5e-9, or about 0.5ns\n\t * over a second.  (Shift values are usually 22, 23 or 24.)\n\t * For high frequency clocks such as the 512MHz timebase clock\n\t * on POWER[6789], the mult value is small (e.g. 32768000)\n\t * and so we can shift the constant by 16 initially\n\t * (295147905179 ~= 2^(20+64-16) / 1e9) and then do the\n\t * remaining shifts after the multiplication, which gives a\n\t * more accurate result (e.g. with mult = 32768000, shift = 24,\n\t * the error is only about 1.2e-12, or 0.7ns over 10 minutes).\n\t */\n\tif (mult <= 62500000 && clock->shift >= 16)\n\t\tnew_tb_to_xs = ((u64) mult * 295147905179ULL) >> (clock->shift - 16);\n\telse\n\t\tnew_tb_to_xs = (u64) mult * (19342813113834067ULL >> clock->shift);\n\n\t/*\n\t * Compute the fractional second in units of 2^-32 seconds.\n\t * The fractional second is tk->tkr_mono.xtime_nsec >> tk->tkr_mono.shift\n\t * in nanoseconds, so multiplying that by 2^32 / 1e9 gives\n\t * it in units of 2^-32 seconds.\n\t * We assume shift <= 32 because clocks_calc_mult_shift()\n\t * generates shift values in the range 0 - 32.\n\t */\n\tfrac_sec = tk->tkr_mono.xtime_nsec << (32 - shift);\n\tdo_div(frac_sec, NSEC_PER_SEC);\n\n\t/*\n\t * Work out new stamp_xsec value for any legacy users of systemcfg.\n\t * stamp_xsec is in units of 2^-20 seconds.\n\t */\n\tnew_stamp_xsec = frac_sec >> 12;\n\tnew_stamp_xsec += tk->xtime_sec * XSEC_PER_SEC;\n\n\t/*\n\t * tb_update_count is used to allow the userspace gettimeofday code\n\t * to assure itself that it sees a consistent view of the tb_to_xs and\n\t * stamp_xsec variables.  It reads the tb_update_count, then reads\n\t * tb_to_xs and stamp_xsec and then reads tb_update_count again.  If\n\t * the two values of tb_update_count match and are even then the\n\t * tb_to_xs and stamp_xsec values are consistent.  If not, then it\n\t * loops back and reads them again until this criteria is met.\n\t */\n\tvdso_data->tb_orig_stamp = cycle_last;\n\tvdso_data->stamp_xsec = new_stamp_xsec;\n\tvdso_data->tb_to_xs = new_tb_to_xs;\n\tvdso_data->wtom_clock_sec = tk->wall_to_monotonic.tv_sec;\n\tvdso_data->wtom_clock_nsec = tk->wall_to_monotonic.tv_nsec;\n\tvdso_data->stamp_xtime_sec = xt.tv_sec;\n\tvdso_data->stamp_xtime_nsec = xt.tv_nsec;\n\tvdso_data->stamp_sec_fraction = frac_sec;\n\tvdso_data->hrtimer_res = hrtimer_resolution;\n\tsmp_wmb();\n\t++(vdso_data->tb_update_count);\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define XSEC_PER_SEC (1024*1024)"
    ],
    "globals_used": [
      "static u64 rtc_read(struct clocksource *);",
      "static u64 timebase_read(struct clocksource *);",
      "static struct clocksource clocksource_timebase = {\n\t.name         = \"timebase\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = timebase_read,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_wmb",
          "args": [],
          "line": 939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "frac_sec",
            "NSEC_PER_SEC"
          ],
          "line": 912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define XSEC_PER_SEC (1024*1024)\n\nstatic u64 rtc_read(struct clocksource *);\nstatic u64 timebase_read(struct clocksource *);\nstatic struct clocksource clocksource_timebase = {\n\t.name         = \"timebase\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = timebase_read,\n};\n\nvoid update_vsyscall(struct timekeeper *tk)\n{\n\tstruct timespec64 xt;\n\tstruct clocksource *clock = tk->tkr_mono.clock;\n\tu32 mult = tk->tkr_mono.mult;\n\tu32 shift = tk->tkr_mono.shift;\n\tu64 cycle_last = tk->tkr_mono.cycle_last;\n\tu64 new_tb_to_xs, new_stamp_xsec;\n\tu64 frac_sec;\n\n\tif (clock != &clocksource_timebase)\n\t\treturn;\n\n\txt.tv_sec = tk->xtime_sec;\n\txt.tv_nsec = (long)(tk->tkr_mono.xtime_nsec >> tk->tkr_mono.shift);\n\n\t/* Make userspace gettimeofday spin until we're done. */\n\t++vdso_data->tb_update_count;\n\tsmp_mb();\n\n\t/*\n\t * This computes ((2^20 / 1e9) * mult) >> shift as a\n\t * 0.64 fixed-point fraction.\n\t * The computation in the else clause below won't overflow\n\t * (as long as the timebase frequency is >= 1.049 MHz)\n\t * but loses precision because we lose the low bits of the constant\n\t * in the shift.  Note that 19342813113834067 ~= 2^(20+64) / 1e9.\n\t * For a shift of 24 the error is about 0.5e-9, or about 0.5ns\n\t * over a second.  (Shift values are usually 22, 23 or 24.)\n\t * For high frequency clocks such as the 512MHz timebase clock\n\t * on POWER[6789], the mult value is small (e.g. 32768000)\n\t * and so we can shift the constant by 16 initially\n\t * (295147905179 ~= 2^(20+64-16) / 1e9) and then do the\n\t * remaining shifts after the multiplication, which gives a\n\t * more accurate result (e.g. with mult = 32768000, shift = 24,\n\t * the error is only about 1.2e-12, or 0.7ns over 10 minutes).\n\t */\n\tif (mult <= 62500000 && clock->shift >= 16)\n\t\tnew_tb_to_xs = ((u64) mult * 295147905179ULL) >> (clock->shift - 16);\n\telse\n\t\tnew_tb_to_xs = (u64) mult * (19342813113834067ULL >> clock->shift);\n\n\t/*\n\t * Compute the fractional second in units of 2^-32 seconds.\n\t * The fractional second is tk->tkr_mono.xtime_nsec >> tk->tkr_mono.shift\n\t * in nanoseconds, so multiplying that by 2^32 / 1e9 gives\n\t * it in units of 2^-32 seconds.\n\t * We assume shift <= 32 because clocks_calc_mult_shift()\n\t * generates shift values in the range 0 - 32.\n\t */\n\tfrac_sec = tk->tkr_mono.xtime_nsec << (32 - shift);\n\tdo_div(frac_sec, NSEC_PER_SEC);\n\n\t/*\n\t * Work out new stamp_xsec value for any legacy users of systemcfg.\n\t * stamp_xsec is in units of 2^-20 seconds.\n\t */\n\tnew_stamp_xsec = frac_sec >> 12;\n\tnew_stamp_xsec += tk->xtime_sec * XSEC_PER_SEC;\n\n\t/*\n\t * tb_update_count is used to allow the userspace gettimeofday code\n\t * to assure itself that it sees a consistent view of the tb_to_xs and\n\t * stamp_xsec variables.  It reads the tb_update_count, then reads\n\t * tb_to_xs and stamp_xsec and then reads tb_update_count again.  If\n\t * the two values of tb_update_count match and are even then the\n\t * tb_to_xs and stamp_xsec values are consistent.  If not, then it\n\t * loops back and reads them again until this criteria is met.\n\t */\n\tvdso_data->tb_orig_stamp = cycle_last;\n\tvdso_data->stamp_xsec = new_stamp_xsec;\n\tvdso_data->tb_to_xs = new_tb_to_xs;\n\tvdso_data->wtom_clock_sec = tk->wall_to_monotonic.tv_sec;\n\tvdso_data->wtom_clock_nsec = tk->wall_to_monotonic.tv_nsec;\n\tvdso_data->stamp_xtime_sec = xt.tv_sec;\n\tvdso_data->stamp_xtime_nsec = xt.tv_nsec;\n\tvdso_data->stamp_sec_fraction = frac_sec;\n\tvdso_data->hrtimer_res = hrtimer_resolution;\n\tsmp_wmb();\n\t++(vdso_data->tb_update_count);\n}"
  },
  {
    "function_name": "timebase_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "855-858",
    "snippet": "static notrace u64 timebase_read(struct clocksource *cs)\n{\n\treturn (u64)get_tb();\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 rtc_read(struct clocksource *);",
      "static u64 timebase_read(struct clocksource *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_tb",
          "args": [],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 rtc_read(struct clocksource *);\nstatic u64 timebase_read(struct clocksource *);\n\nstatic notrace u64 timebase_read(struct clocksource *cs)\n{\n\treturn (u64)get_tb();\n}"
  },
  {
    "function_name": "rtc_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "850-853",
    "snippet": "static notrace u64 rtc_read(struct clocksource *cs)\n{\n\treturn (u64)get_rtc();\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 rtc_read(struct clocksource *);",
      "static u64 timebase_read(struct clocksource *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_rtc",
          "args": [],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 rtc_read(struct clocksource *);\nstatic u64 timebase_read(struct clocksource *);\n\nstatic notrace u64 rtc_read(struct clocksource *cs)\n{\n\treturn (u64)get_rtc();\n}"
  },
  {
    "function_name": "read_persistent_clock64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "837-847",
    "snippet": "void read_persistent_clock64(struct timespec64 *ts)\n{\n\t__read_persistent_clock(ts);\n\n\t/* Sanitize it in case real time clock is set below EPOCH */\n\tif (ts->tv_sec < 0) {\n\t\tts->tv_sec = 0;\n\t\tts->tv_nsec = 0;\n\t}\n\t\t\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__read_persistent_clock",
          "args": [
            "ts"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "__read_persistent_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "810-835",
          "snippet": "static void __read_persistent_clock(struct timespec64 *ts)\n{\n\tstruct rtc_time tm;\n\tstatic int first = 1;\n\n\tts->tv_nsec = 0;\n\t/* XXX this is a litle fragile but will work okay in the short term */\n\tif (first) {\n\t\tfirst = 0;\n\t\tif (ppc_md.time_init)\n\t\t\ttimezone_offset = ppc_md.time_init();\n\n\t\t/* get_boot_time() isn't guaranteed to be safe to call late */\n\t\tif (ppc_md.get_boot_time) {\n\t\t\tts->tv_sec = ppc_md.get_boot_time() - timezone_offset;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!ppc_md.get_rtc_time) {\n\t\tts->tv_sec = 0;\n\t\treturn;\n\t}\n\tppc_md.get_rtc_time(&tm);\n\n\tts->tv_sec = rtc_tm_to_time64(&tm);\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static long timezone_offset;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic long timezone_offset;\n\nstatic void __read_persistent_clock(struct timespec64 *ts)\n{\n\tstruct rtc_time tm;\n\tstatic int first = 1;\n\n\tts->tv_nsec = 0;\n\t/* XXX this is a litle fragile but will work okay in the short term */\n\tif (first) {\n\t\tfirst = 0;\n\t\tif (ppc_md.time_init)\n\t\t\ttimezone_offset = ppc_md.time_init();\n\n\t\t/* get_boot_time() isn't guaranteed to be safe to call late */\n\t\tif (ppc_md.get_boot_time) {\n\t\t\tts->tv_sec = ppc_md.get_boot_time() - timezone_offset;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!ppc_md.get_rtc_time) {\n\t\tts->tv_sec = 0;\n\t\treturn;\n\t}\n\tppc_md.get_rtc_time(&tm);\n\n\tts->tv_sec = rtc_tm_to_time64(&tm);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid read_persistent_clock64(struct timespec64 *ts)\n{\n\t__read_persistent_clock(ts);\n\n\t/* Sanitize it in case real time clock is set below EPOCH */\n\tif (ts->tv_sec < 0) {\n\t\tts->tv_sec = 0;\n\t\tts->tv_nsec = 0;\n\t}\n\t\t\n}"
  },
  {
    "function_name": "__read_persistent_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "810-835",
    "snippet": "static void __read_persistent_clock(struct timespec64 *ts)\n{\n\tstruct rtc_time tm;\n\tstatic int first = 1;\n\n\tts->tv_nsec = 0;\n\t/* XXX this is a litle fragile but will work okay in the short term */\n\tif (first) {\n\t\tfirst = 0;\n\t\tif (ppc_md.time_init)\n\t\t\ttimezone_offset = ppc_md.time_init();\n\n\t\t/* get_boot_time() isn't guaranteed to be safe to call late */\n\t\tif (ppc_md.get_boot_time) {\n\t\t\tts->tv_sec = ppc_md.get_boot_time() - timezone_offset;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!ppc_md.get_rtc_time) {\n\t\tts->tv_sec = 0;\n\t\treturn;\n\t}\n\tppc_md.get_rtc_time(&tm);\n\n\tts->tv_sec = rtc_tm_to_time64(&tm);\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static long timezone_offset;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rtc_tm_to_time64",
          "args": [
            "&tm"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.get_rtc_time",
          "args": [
            "&tm"
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.get_boot_time",
          "args": [],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.time_init",
          "args": [],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "time_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "1068-1137",
          "snippet": "void __init time_init(void)\n{\n\tstruct div_result res;\n\tu64 scale;\n\tunsigned shift;\n\n\tif (__USE_RTC()) {\n\t\t/* 601 processor: dec counts down by 128 every 128ns */\n\t\tppc_tb_freq = 1000000000;\n\t} else {\n\t\t/* Normal PowerPC with timebase register */\n\t\tppc_md.calibrate_decr();\n\t\tprintk(KERN_DEBUG \"time_init: decrementer frequency = %lu.%.6lu MHz\\n\",\n\t\t       ppc_tb_freq / 1000000, ppc_tb_freq % 1000000);\n\t\tprintk(KERN_DEBUG \"time_init: processor frequency   = %lu.%.6lu MHz\\n\",\n\t\t       ppc_proc_freq / 1000000, ppc_proc_freq % 1000000);\n\t}\n\n\ttb_ticks_per_jiffy = ppc_tb_freq / HZ;\n\ttb_ticks_per_sec = ppc_tb_freq;\n\ttb_ticks_per_usec = ppc_tb_freq / 1000000;\n\tcalc_cputime_factors();\n\n\t/*\n\t * Compute scale factor for sched_clock.\n\t * The calibrate_decr() function has set tb_ticks_per_sec,\n\t * which is the timebase frequency.\n\t * We compute 1e9 * 2^64 / tb_ticks_per_sec and interpret\n\t * the 128-bit result as a 64.64 fixed-point number.\n\t * We then shift that number right until it is less than 1.0,\n\t * giving us the scale factor and shift count to use in\n\t * sched_clock().\n\t */\n\tdiv128_by_32(1000000000, 0, tb_ticks_per_sec, &res);\n\tscale = res.result_low;\n\tfor (shift = 0; res.result_high != 0; ++shift) {\n\t\tscale = (scale >> 1) | (res.result_high << 63);\n\t\tres.result_high >>= 1;\n\t}\n\ttb_to_ns_scale = scale;\n\ttb_to_ns_shift = shift;\n\t/* Save the current timebase to pretty up CONFIG_PRINTK_TIME */\n\tboot_tb = get_tb_or_rtc();\n\n\t/* If platform provided a timezone (pmac), we correct the time */\n\tif (timezone_offset) {\n\t\tsys_tz.tz_minuteswest = -timezone_offset / 60;\n\t\tsys_tz.tz_dsttime = 0;\n\t}\n\n\tvdso_data->tb_update_count = 0;\n\tvdso_data->tb_ticks_per_sec = tb_ticks_per_sec;\n\n\t/* initialise and enable the large decrementer (if we have one) */\n\tset_decrementer_max();\n\tenable_large_decrementer();\n\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* Register the clocksource */\n\tclocksource_init();\n\n\tinit_decrementer_clockevent();\n\ttick_setup_hrtimer_broadcast();\n\n\tof_clk_init(NULL);\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u64 rtc_read(struct clocksource *);",
            "static u64 timebase_read(struct clocksource *);",
            "unsigned long tb_ticks_per_jiffy;",
            "unsigned long tb_ticks_per_usec = 100;",
            "unsigned long tb_ticks_per_sec;",
            "static u64 tb_to_ns_scale",
            "extern struct timezone sys_tz;",
            "static long timezone_offset;",
            "unsigned long ppc_proc_freq;",
            "unsigned long ppc_tb_freq;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 rtc_read(struct clocksource *);\nstatic u64 timebase_read(struct clocksource *);\nunsigned long tb_ticks_per_jiffy;\nunsigned long tb_ticks_per_usec = 100;\nunsigned long tb_ticks_per_sec;\nstatic u64 tb_to_ns_scale;\nextern struct timezone sys_tz;\nstatic long timezone_offset;\nunsigned long ppc_proc_freq;\nunsigned long ppc_tb_freq;\n\nvoid __init time_init(void)\n{\n\tstruct div_result res;\n\tu64 scale;\n\tunsigned shift;\n\n\tif (__USE_RTC()) {\n\t\t/* 601 processor: dec counts down by 128 every 128ns */\n\t\tppc_tb_freq = 1000000000;\n\t} else {\n\t\t/* Normal PowerPC with timebase register */\n\t\tppc_md.calibrate_decr();\n\t\tprintk(KERN_DEBUG \"time_init: decrementer frequency = %lu.%.6lu MHz\\n\",\n\t\t       ppc_tb_freq / 1000000, ppc_tb_freq % 1000000);\n\t\tprintk(KERN_DEBUG \"time_init: processor frequency   = %lu.%.6lu MHz\\n\",\n\t\t       ppc_proc_freq / 1000000, ppc_proc_freq % 1000000);\n\t}\n\n\ttb_ticks_per_jiffy = ppc_tb_freq / HZ;\n\ttb_ticks_per_sec = ppc_tb_freq;\n\ttb_ticks_per_usec = ppc_tb_freq / 1000000;\n\tcalc_cputime_factors();\n\n\t/*\n\t * Compute scale factor for sched_clock.\n\t * The calibrate_decr() function has set tb_ticks_per_sec,\n\t * which is the timebase frequency.\n\t * We compute 1e9 * 2^64 / tb_ticks_per_sec and interpret\n\t * the 128-bit result as a 64.64 fixed-point number.\n\t * We then shift that number right until it is less than 1.0,\n\t * giving us the scale factor and shift count to use in\n\t * sched_clock().\n\t */\n\tdiv128_by_32(1000000000, 0, tb_ticks_per_sec, &res);\n\tscale = res.result_low;\n\tfor (shift = 0; res.result_high != 0; ++shift) {\n\t\tscale = (scale >> 1) | (res.result_high << 63);\n\t\tres.result_high >>= 1;\n\t}\n\ttb_to_ns_scale = scale;\n\ttb_to_ns_shift = shift;\n\t/* Save the current timebase to pretty up CONFIG_PRINTK_TIME */\n\tboot_tb = get_tb_or_rtc();\n\n\t/* If platform provided a timezone (pmac), we correct the time */\n\tif (timezone_offset) {\n\t\tsys_tz.tz_minuteswest = -timezone_offset / 60;\n\t\tsys_tz.tz_dsttime = 0;\n\t}\n\n\tvdso_data->tb_update_count = 0;\n\tvdso_data->tb_ticks_per_sec = tb_ticks_per_sec;\n\n\t/* initialise and enable the large decrementer (if we have one) */\n\tset_decrementer_max();\n\tenable_large_decrementer();\n\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* Register the clocksource */\n\tclocksource_init();\n\n\tinit_decrementer_clockevent();\n\ttick_setup_hrtimer_broadcast();\n\n\tof_clk_init(NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic long timezone_offset;\n\nstatic void __read_persistent_clock(struct timespec64 *ts)\n{\n\tstruct rtc_time tm;\n\tstatic int first = 1;\n\n\tts->tv_nsec = 0;\n\t/* XXX this is a litle fragile but will work okay in the short term */\n\tif (first) {\n\t\tfirst = 0;\n\t\tif (ppc_md.time_init)\n\t\t\ttimezone_offset = ppc_md.time_init();\n\n\t\t/* get_boot_time() isn't guaranteed to be safe to call late */\n\t\tif (ppc_md.get_boot_time) {\n\t\t\tts->tv_sec = ppc_md.get_boot_time() - timezone_offset;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!ppc_md.get_rtc_time) {\n\t\tts->tv_sec = 0;\n\t\treturn;\n\t}\n\tppc_md.get_rtc_time(&tm);\n\n\tts->tv_sec = rtc_tm_to_time64(&tm);\n}"
  },
  {
    "function_name": "update_persistent_clock64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "798-808",
    "snippet": "int update_persistent_clock64(struct timespec64 now)\n{\n\tstruct rtc_time tm;\n\n\tif (!ppc_md.set_rtc_time)\n\t\treturn -ENODEV;\n\n\trtc_time64_to_tm(now.tv_sec + 1 + timezone_offset, &tm);\n\n\treturn ppc_md.set_rtc_time(&tm);\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static long timezone_offset;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.set_rtc_time",
          "args": [
            "&tm"
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rtc_time64_to_tm",
          "args": [
            "now.tv_sec + 1 + timezone_offset",
            "&tm"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic long timezone_offset;\n\nint update_persistent_clock64(struct timespec64 now)\n{\n\tstruct rtc_time tm;\n\n\tif (!ppc_md.set_rtc_time)\n\t\treturn -ENODEV;\n\n\trtc_time64_to_tm(now.tv_sec + 1 + timezone_offset, &tm);\n\n\treturn ppc_md.set_rtc_time(&tm);\n}"
  },
  {
    "function_name": "generic_calibrate_decr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "777-796",
    "snippet": "void __init generic_calibrate_decr(void)\n{\n\tppc_tb_freq = DEFAULT_TB_FREQ;\t\t/* hardcoded default */\n\n\tif (!get_freq(\"ibm,extended-timebase-frequency\", 2, &ppc_tb_freq) &&\n\t    !get_freq(\"timebase-frequency\", 1, &ppc_tb_freq)) {\n\n\t\tprintk(KERN_ERR \"WARNING: Estimating decrementer frequency \"\n\t\t\t\t\"(not found)\\n\");\n\t}\n\n\tppc_proc_freq = DEFAULT_PROC_FREQ;\t/* hardcoded default */\n\n\tif (!get_freq(\"ibm,extended-clock-frequency\", 2, &ppc_proc_freq) &&\n\t    !get_freq(\"clock-frequency\", 1, &ppc_proc_freq)) {\n\n\t\tprintk(KERN_ERR \"WARNING: Estimating processor frequency \"\n\t\t\t\t\"(not found)\\n\");\n\t}\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long ppc_proc_freq;",
      "unsigned long ppc_tb_freq;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"WARNING: Estimating processor frequency \"\n\t\t\t\t\"(not found)\\n\""
          ],
          "line": 793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_freq",
          "args": [
            "\"clock-frequency\"",
            "1",
            "&ppc_proc_freq"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "get_freq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "736-756",
          "snippet": "static int __init get_freq(char *name, int cells, unsigned long *val)\n{\n\tstruct device_node *cpu;\n\tconst __be32 *fp;\n\tint found = 0;\n\n\t/* The cpu node should have timebase and clock frequency properties */\n\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\tif (cpu) {\n\t\tfp = of_get_property(cpu, name, NULL);\n\t\tif (fp) {\n\t\t\tfound = 1;\n\t\t\t*val = of_read_ulong(fp, cells);\n\t\t}\n\n\t\tof_node_put(cpu);\n\t}\n\n\treturn found;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic int __init get_freq(char *name, int cells, unsigned long *val)\n{\n\tstruct device_node *cpu;\n\tconst __be32 *fp;\n\tint found = 0;\n\n\t/* The cpu node should have timebase and clock frequency properties */\n\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\tif (cpu) {\n\t\tfp = of_get_property(cpu, name, NULL);\n\t\tif (fp) {\n\t\t\tfound = 1;\n\t\t\t*val = of_read_ulong(fp, cells);\n\t\t}\n\n\t\tof_node_put(cpu);\n\t}\n\n\treturn found;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"WARNING: Estimating decrementer frequency \"\n\t\t\t\t\"(not found)\\n\""
          ],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long ppc_proc_freq;\nunsigned long ppc_tb_freq;\n\nvoid __init generic_calibrate_decr(void)\n{\n\tppc_tb_freq = DEFAULT_TB_FREQ;\t\t/* hardcoded default */\n\n\tif (!get_freq(\"ibm,extended-timebase-frequency\", 2, &ppc_tb_freq) &&\n\t    !get_freq(\"timebase-frequency\", 1, &ppc_tb_freq)) {\n\n\t\tprintk(KERN_ERR \"WARNING: Estimating decrementer frequency \"\n\t\t\t\t\"(not found)\\n\");\n\t}\n\n\tppc_proc_freq = DEFAULT_PROC_FREQ;\t/* hardcoded default */\n\n\tif (!get_freq(\"ibm,extended-clock-frequency\", 2, &ppc_proc_freq) &&\n\t    !get_freq(\"clock-frequency\", 1, &ppc_proc_freq)) {\n\n\t\tprintk(KERN_ERR \"WARNING: Estimating processor frequency \"\n\t\t\t\t\"(not found)\\n\");\n\t}\n}"
  },
  {
    "function_name": "start_cpu_decrementer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "758-775",
    "snippet": "static void start_cpu_decrementer(void)\n{\n#if defined(CONFIG_BOOKE) || defined(CONFIG_40x)\n\tunsigned int tcr;\n\n\t/* Clear any pending timer interrupts */\n\tmtspr(SPRN_TSR, TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS);\n\n\ttcr = mfspr(SPRN_TCR);\n\t/*\n\t * The watchdog may have already been enabled by u-boot. So leave\n\t * TRC[WP] (Watchdog Period) alone.\n\t */\n\ttcr &= TCR_WP_MASK;\t/* Clear all bits except for TCR[WP] */\n\ttcr |= TCR_DIE;\t\t/* Enable decrementer */\n\tmtspr(SPRN_TCR, tcr);\n#endif\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_TCR",
            "tcr"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_TCR"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_TSR",
            "TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void start_cpu_decrementer(void)\n{\n#if defined(CONFIG_BOOKE) || defined(CONFIG_40x)\n\tunsigned int tcr;\n\n\t/* Clear any pending timer interrupts */\n\tmtspr(SPRN_TSR, TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS);\n\n\ttcr = mfspr(SPRN_TCR);\n\t/*\n\t * The watchdog may have already been enabled by u-boot. So leave\n\t * TRC[WP] (Watchdog Period) alone.\n\t */\n\ttcr &= TCR_WP_MASK;\t/* Clear all bits except for TCR[WP] */\n\ttcr |= TCR_DIE;\t\t/* Enable decrementer */\n\tmtspr(SPRN_TCR, tcr);\n#endif\n}"
  },
  {
    "function_name": "get_freq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "736-756",
    "snippet": "static int __init get_freq(char *name, int cells, unsigned long *val)\n{\n\tstruct device_node *cpu;\n\tconst __be32 *fp;\n\tint found = 0;\n\n\t/* The cpu node should have timebase and clock frequency properties */\n\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\tif (cpu) {\n\t\tfp = of_get_property(cpu, name, NULL);\n\t\tif (fp) {\n\t\t\tfound = 1;\n\t\t\t*val = of_read_ulong(fp, cells);\n\t\t}\n\n\t\tof_node_put(cpu);\n\t}\n\n\treturn found;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "cpu"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_read_ulong",
          "args": [
            "fp",
            "cells"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "cpu",
            "name",
            "NULL"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_type",
          "args": [
            "NULL",
            "\"cpu\""
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic int __init get_freq(char *name, int cells, unsigned long *val)\n{\n\tstruct device_node *cpu;\n\tconst __be32 *fp;\n\tint found = 0;\n\n\t/* The cpu node should have timebase and clock frequency properties */\n\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\tif (cpu) {\n\t\tfp = of_get_property(cpu, name, NULL);\n\t\tif (fp) {\n\t\t\tfound = 1;\n\t\t\t*val = of_read_ulong(fp, cells);\n\t\t}\n\n\t\tof_node_put(cpu);\n\t}\n\n\treturn found;\n}"
  },
  {
    "function_name": "running_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "712-733",
    "snippet": "unsigned long long running_clock(void)\n{\n\t/*\n\t * Don't read the VTB as a host since KVM does not switch in host\n\t * timebase into the VTB when it takes a guest off the CPU, reading the\n\t * VTB would result in reading 'last switched out' guest VTB.\n\t *\n\t * Host kernels are often compiled with CONFIG_PPC_PSERIES checked, it\n\t * would be unsafe to rely only on the #ifdef above.\n\t */\n\tif (firmware_has_feature(FW_FEATURE_LPAR) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\treturn mulhdu(get_vtb() - boot_tb, tb_to_ns_scale) << tb_to_ns_shift;\n\n\t/*\n\t * This is a next best approximation without a VTB.\n\t * On a host which is running bare metal there should never be any stolen\n\t * time and on a host which doesn't do any virtualisation TB *should* equal\n\t * VTB so it makes no difference anyway.\n\t */\n\treturn local_clock() - kcpustat_this_cpu->cpustat[CPUTIME_STEAL];\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 tb_to_ns_scale"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_clock",
          "args": [],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mulhdu",
          "args": [
            "get_vtb() - boot_tb",
            "tb_to_ns_scale"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_vtb",
          "args": [],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_207S"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 tb_to_ns_scale;\n\nunsigned long long running_clock(void)\n{\n\t/*\n\t * Don't read the VTB as a host since KVM does not switch in host\n\t * timebase into the VTB when it takes a guest off the CPU, reading the\n\t * VTB would result in reading 'last switched out' guest VTB.\n\t *\n\t * Host kernels are often compiled with CONFIG_PPC_PSERIES checked, it\n\t * would be unsafe to rely only on the #ifdef above.\n\t */\n\tif (firmware_has_feature(FW_FEATURE_LPAR) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\treturn mulhdu(get_vtb() - boot_tb, tb_to_ns_scale) << tb_to_ns_shift;\n\n\t/*\n\t * This is a next best approximation without a VTB.\n\t * On a host which is running bare metal there should never be any stolen\n\t * time and on a host which doesn't do any virtualisation TB *should* equal\n\t * VTB so it makes no difference anyway.\n\t */\n\treturn local_clock() - kcpustat_this_cpu->cpustat[CPUTIME_STEAL];\n}"
  },
  {
    "function_name": "sched_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "697-702",
    "snippet": "notrace unsigned long long sched_clock(void)\n{\n\tif (__USE_RTC())\n\t\treturn get_rtc();\n\treturn mulhdu(get_tb() - boot_tb, tb_to_ns_scale) << tb_to_ns_shift;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 tb_to_ns_scale"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mulhdu",
          "args": [
            "get_tb() - boot_tb",
            "tb_to_ns_scale"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_tb",
          "args": [],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_rtc",
          "args": [],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__USE_RTC",
          "args": [],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 tb_to_ns_scale;\n\nnotrace unsigned long long sched_clock(void)\n{\n\tif (__USE_RTC())\n\t\treturn get_rtc();\n\treturn mulhdu(get_tb() - boot_tb, tb_to_ns_scale) << tb_to_ns_shift;\n}"
  },
  {
    "function_name": "tb_to_ns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "684-687",
    "snippet": "unsigned long long tb_to_ns(unsigned long long ticks)\n{\n\treturn mulhdu(ticks, tb_to_ns_scale) << tb_to_ns_shift;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 tb_to_ns_scale"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mulhdu",
          "args": [
            "ticks",
            "tb_to_ns_scale"
          ],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 tb_to_ns_scale;\n\nunsigned long long tb_to_ns(unsigned long long ticks)\n{\n\treturn mulhdu(ticks, tb_to_ns_scale) << tb_to_ns_shift;\n}"
  },
  {
    "function_name": "arch_suspend_enable_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "676-681",
    "snippet": "void arch_suspend_enable_irqs(void)\n{\n\tgeneric_suspend_enable_irqs();\n\tif (ppc_md.suspend_enable_irqs)\n\t\tppc_md.suspend_enable_irqs();\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.suspend_enable_irqs",
          "args": [],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "generic_suspend_enable_irqs",
          "args": [],
          "line": 678
        },
        "resolved": true,
        "details": {
          "function_name": "generic_suspend_enable_irqs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "662-665",
          "snippet": "static void generic_suspend_enable_irqs(void)\n{\n\tlocal_irq_enable();\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void generic_suspend_enable_irqs(void)\n{\n\tlocal_irq_enable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid arch_suspend_enable_irqs(void)\n{\n\tgeneric_suspend_enable_irqs();\n\tif (ppc_md.suspend_enable_irqs)\n\t\tppc_md.suspend_enable_irqs();\n}"
  },
  {
    "function_name": "arch_suspend_disable_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "668-673",
    "snippet": "void arch_suspend_disable_irqs(void)\n{\n\tif (ppc_md.suspend_disable_irqs)\n\t\tppc_md.suspend_disable_irqs();\n\tgeneric_suspend_disable_irqs();\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "generic_suspend_disable_irqs",
          "args": [],
          "line": 672
        },
        "resolved": true,
        "details": {
          "function_name": "generic_suspend_disable_irqs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "651-660",
          "snippet": "static void generic_suspend_disable_irqs(void)\n{\n\t/* Disable the decrementer, so that it doesn't interfere\n\t * with suspending.\n\t */\n\n\tset_dec(decrementer_max);\n\tlocal_irq_disable();\n\tset_dec(decrementer_max);\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "u64 decrementer_max = DECREMENTER_DEFAULT_MAX;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nu64 decrementer_max = DECREMENTER_DEFAULT_MAX;\n\nstatic void generic_suspend_disable_irqs(void)\n{\n\t/* Disable the decrementer, so that it doesn't interfere\n\t * with suspending.\n\t */\n\n\tset_dec(decrementer_max);\n\tlocal_irq_disable();\n\tset_dec(decrementer_max);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppc_md.suspend_disable_irqs",
          "args": [],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid arch_suspend_disable_irqs(void)\n{\n\tif (ppc_md.suspend_disable_irqs)\n\t\tppc_md.suspend_disable_irqs();\n\tgeneric_suspend_disable_irqs();\n}"
  },
  {
    "function_name": "generic_suspend_enable_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "662-665",
    "snippet": "static void generic_suspend_enable_irqs(void)\n{\n\tlocal_irq_enable();\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_enable",
          "args": [],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void generic_suspend_enable_irqs(void)\n{\n\tlocal_irq_enable();\n}"
  },
  {
    "function_name": "generic_suspend_disable_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "651-660",
    "snippet": "static void generic_suspend_disable_irqs(void)\n{\n\t/* Disable the decrementer, so that it doesn't interfere\n\t * with suspending.\n\t */\n\n\tset_dec(decrementer_max);\n\tlocal_irq_disable();\n\tset_dec(decrementer_max);\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "u64 decrementer_max = DECREMENTER_DEFAULT_MAX;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "decrementer_max"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_disable",
          "args": [],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "decrementer_max"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nu64 decrementer_max = DECREMENTER_DEFAULT_MAX;\n\nstatic void generic_suspend_disable_irqs(void)\n{\n\t/* Disable the decrementer, so that it doesn't interfere\n\t * with suspending.\n\t */\n\n\tset_dec(decrementer_max);\n\tlocal_irq_disable();\n\tset_dec(decrementer_max);\n}"
  },
  {
    "function_name": "timer_broadcast_interrupt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "640-647",
    "snippet": "void timer_broadcast_interrupt(void)\n{\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t*next_tb = ~(u64)0;\n\ttick_receive_broadcast();\n\t__this_cpu_inc(irq_stat.broadcast_irqs_event);\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__this_cpu_inc",
          "args": [
            "irq_stat.broadcast_irqs_event"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tick_receive_broadcast",
          "args": [],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&decrementers_next_tb"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid timer_broadcast_interrupt(void)\n{\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t*next_tb = ~(u64)0;\n\ttick_receive_broadcast();\n\t__this_cpu_inc(irq_stat.broadcast_irqs_event);\n}"
  },
  {
    "function_name": "timer_interrupt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "567-636",
    "snippet": "void timer_interrupt(struct pt_regs *regs)\n{\n\tstruct clock_event_device *evt = this_cpu_ptr(&decrementers);\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\tstruct pt_regs *old_regs;\n\tu64 now;\n\n\t/* Some implementations of hotplug will get timer interrupts while\n\t * offline, just ignore these and we also need to set\n\t * decrementers_next_tb as MAX to make sure __check_irq_replay\n\t * don't replay timer interrupt when return, otherwise we'll trap\n\t * here infinitely :(\n\t */\n\tif (unlikely(!cpu_online(smp_processor_id()))) {\n\t\t*next_tb = ~(u64)0;\n\t\tset_dec(decrementer_max);\n\t\treturn;\n\t}\n\n\t/* Ensure a positive value is written to the decrementer, or else\n\t * some CPUs will continue to take decrementer exceptions. When the\n\t * PPC_WATCHDOG (decrementer based) is configured, keep this at most\n\t * 31 bits, which is about 4 seconds on most systems, which gives\n\t * the watchdog a chance of catching timer interrupt hard lockups.\n\t */\n\tif (IS_ENABLED(CONFIG_PPC_WATCHDOG))\n\t\tset_dec(0x7fffffff);\n\telse\n\t\tset_dec(decrementer_max);\n\n\t/* Conditionally hard-enable interrupts now that the DEC has been\n\t * bumped to its maximum value\n\t */\n\tmay_hard_irq_enable();\n\n\n#if defined(CONFIG_PPC32) && defined(CONFIG_PPC_PMAC)\n\tif (atomic_read(&ppc_n_lost_interrupts) != 0)\n\t\tdo_IRQ(regs);\n#endif\n\n\told_regs = set_irq_regs(regs);\n\tirq_enter();\n\ttrace_timer_interrupt_entry(regs);\n\n\tif (test_irq_work_pending()) {\n\t\tclear_irq_work_pending();\n\t\tirq_work_run();\n\t}\n\n\tnow = get_tb_or_rtc();\n\tif (now >= *next_tb) {\n\t\t*next_tb = ~(u64)0;\n\t\tif (evt->event_handler)\n\t\t\tevt->event_handler(evt);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_event);\n\t} else {\n\t\tnow = *next_tb - now;\n\t\tif (now <= decrementer_max)\n\t\t\tset_dec(now);\n\t\t/* We may have raced with new irq work */\n\t\tif (test_irq_work_pending())\n\t\t\tset_dec(1);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_others);\n\t}\n\n\ttrace_timer_interrupt_exit(regs);\n\tirq_exit();\n\tset_irq_regs(old_regs);\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "u64 decrementer_max = DECREMENTER_DEFAULT_MAX;",
      "static int decrementer_shutdown(struct clock_event_device *evt);",
      "static DEFINE_PER_CPU(struct clock_event_device, decrementers);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_irq_regs",
          "args": [
            "old_regs"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_exit",
          "args": [],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_timer_interrupt_exit",
          "args": [
            "regs"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__this_cpu_inc",
          "args": [
            "irq_stat.timer_irqs_others"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "1"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_irq_work_pending",
          "args": [],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "test_irq_work_pending",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "503-511",
          "snippet": "static inline unsigned long test_irq_work_pending(void)\n{\n\tunsigned long x;\n\n\tasm volatile(\"lbz %0,%1(13)\"\n\t\t: \"=r\" (x)\n\t\t: \"i\" (offsetof(struct paca_struct, irq_work_pending)));\n\treturn x;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline unsigned long test_irq_work_pending(void)\n{\n\tunsigned long x;\n\n\tasm volatile(\"lbz %0,%1(13)\"\n\t\t: \"=r\" (x)\n\t\t: \"i\" (offsetof(struct paca_struct, irq_work_pending)));\n\treturn x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "now"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__this_cpu_inc",
          "args": [
            "irq_stat.timer_irqs_event"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evt->event_handler",
          "args": [
            "evt"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_tb_or_rtc",
          "args": [],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_work_run",
          "args": [],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_irq_work_pending",
          "args": [],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "clear_irq_work_pending",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "520-525",
          "snippet": "static inline void clear_irq_work_pending(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (0),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline void clear_irq_work_pending(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (0),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_timer_interrupt_entry",
          "args": [
            "regs"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_enter",
          "args": [],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_irq_regs",
          "args": [
            "regs"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_IRQ",
          "args": [
            "regs"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "do_IRQ",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/irq.c",
          "lines": "713-735",
          "snippet": "void do_IRQ(struct pt_regs *regs)\n{\n\tstruct pt_regs *old_regs = set_irq_regs(regs);\n\tvoid *cursp, *irqsp, *sirqsp;\n\n\t/* Switch to the irq stack to handle this */\n\tcursp = (void *)(current_stack_pointer & ~(THREAD_SIZE - 1));\n\tirqsp = hardirq_ctx[raw_smp_processor_id()];\n\tsirqsp = softirq_ctx[raw_smp_processor_id()];\n\n\tcheck_stack_overflow();\n\n\t/* Already there ? */\n\tif (unlikely(cursp == irqsp || cursp == sirqsp)) {\n\t\t__do_irq(regs);\n\t\tset_irq_regs(old_regs);\n\t\treturn;\n\t}\n\t/* Switch stack and call */\n\tcall_do_irq(regs, irqsp);\n\n\tset_irq_regs(old_regs);\n}",
          "includes": [
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/trace.h>",
            "#include <asm/dbell.h>",
            "#include <asm/lv1call.h>",
            "#include <asm/firmware.h>",
            "#include <asm/paca.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/smp.h>",
            "#include <asm/udbg.h>",
            "#include <asm/machdep.h>",
            "#include <asm/ptrace.h>",
            "#include <asm/prom.h>",
            "#include <asm/cache.h>",
            "#include <asm/irq.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/pci.h>",
            "#include <linux/mutex.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/list.h>",
            "#include <linux/bitops.h>",
            "#include <linux/profile.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/irq.h>",
            "#include <linux/delay.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/ioport.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/sched.h>",
            "#include <linux/signal.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/threads.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void *softirq_ctx[NR_CPUS]",
            "void *hardirq_ctx[NR_CPUS]"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cpu_has_feature.h>\n#include <asm/trace.h>\n#include <asm/dbell.h>\n#include <asm/lv1call.h>\n#include <asm/firmware.h>\n#include <asm/paca.h>\n#include <asm/hw_irq.h>\n#include <asm/asm-prototypes.h>\n#include <asm/livepatch.h>\n#include <asm/smp.h>\n#include <asm/udbg.h>\n#include <asm/machdep.h>\n#include <asm/ptrace.h>\n#include <asm/prom.h>\n#include <asm/cache.h>\n#include <asm/irq.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <linux/pgtable.h>\n#include <linux/vmalloc.h>\n#include <linux/of_irq.h>\n#include <linux/of.h>\n#include <linux/debugfs.h>\n#include <linux/pci.h>\n#include <linux/mutex.h>\n#include <linux/radix-tree.h>\n#include <linux/list.h>\n#include <linux/bitops.h>\n#include <linux/profile.h>\n#include <linux/cpumask.h>\n#include <linux/seq_file.h>\n#include <linux/irq.h>\n#include <linux/delay.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/ioport.h>\n#include <linux/ptrace.h>\n#include <linux/sched.h>\n#include <linux/signal.h>\n#include <linux/kernel_stat.h>\n#include <linux/threads.h>\n#include <linux/export.h>\n\nvoid *softirq_ctx[NR_CPUS];\nvoid *hardirq_ctx[NR_CPUS];\n\nvoid do_IRQ(struct pt_regs *regs)\n{\n\tstruct pt_regs *old_regs = set_irq_regs(regs);\n\tvoid *cursp, *irqsp, *sirqsp;\n\n\t/* Switch to the irq stack to handle this */\n\tcursp = (void *)(current_stack_pointer & ~(THREAD_SIZE - 1));\n\tirqsp = hardirq_ctx[raw_smp_processor_id()];\n\tsirqsp = softirq_ctx[raw_smp_processor_id()];\n\n\tcheck_stack_overflow();\n\n\t/* Already there ? */\n\tif (unlikely(cursp == irqsp || cursp == sirqsp)) {\n\t\t__do_irq(regs);\n\t\tset_irq_regs(old_regs);\n\t\treturn;\n\t}\n\t/* Switch stack and call */\n\tcall_do_irq(regs, irqsp);\n\n\tset_irq_regs(old_regs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ppc_n_lost_interrupts"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "may_hard_irq_enable",
          "args": [],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "decrementer_max"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "0x7fffffff"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC_WATCHDOG"
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "decrementer_max"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!cpu_online(smp_processor_id())"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "smp_processor_id()"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_cpu_online",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "924-1018",
          "snippet": "static int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [
            "#define unregister_cpu_online NULL",
            "#define HAS_PPC_PA6T",
            "#define HAS_PPC_PMC_G4\t\t1",
            "#define HAS_PPC_PMC_PA6T\t1",
            "#define HAS_PPC_PMC_IBM\t\t1"
          ],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cpu, cpu_devices);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define unregister_cpu_online NULL\n#define HAS_PPC_PA6T\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\n\nstatic int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&decrementers_next_tb"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&decrementers"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nu64 decrementer_max = DECREMENTER_DEFAULT_MAX;\nstatic int decrementer_shutdown(struct clock_event_device *evt);\nstatic DEFINE_PER_CPU(struct clock_event_device, decrementers);\n\nvoid timer_interrupt(struct pt_regs *regs)\n{\n\tstruct clock_event_device *evt = this_cpu_ptr(&decrementers);\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\tstruct pt_regs *old_regs;\n\tu64 now;\n\n\t/* Some implementations of hotplug will get timer interrupts while\n\t * offline, just ignore these and we also need to set\n\t * decrementers_next_tb as MAX to make sure __check_irq_replay\n\t * don't replay timer interrupt when return, otherwise we'll trap\n\t * here infinitely :(\n\t */\n\tif (unlikely(!cpu_online(smp_processor_id()))) {\n\t\t*next_tb = ~(u64)0;\n\t\tset_dec(decrementer_max);\n\t\treturn;\n\t}\n\n\t/* Ensure a positive value is written to the decrementer, or else\n\t * some CPUs will continue to take decrementer exceptions. When the\n\t * PPC_WATCHDOG (decrementer based) is configured, keep this at most\n\t * 31 bits, which is about 4 seconds on most systems, which gives\n\t * the watchdog a chance of catching timer interrupt hard lockups.\n\t */\n\tif (IS_ENABLED(CONFIG_PPC_WATCHDOG))\n\t\tset_dec(0x7fffffff);\n\telse\n\t\tset_dec(decrementer_max);\n\n\t/* Conditionally hard-enable interrupts now that the DEC has been\n\t * bumped to its maximum value\n\t */\n\tmay_hard_irq_enable();\n\n\n#if defined(CONFIG_PPC32) && defined(CONFIG_PPC_PMAC)\n\tif (atomic_read(&ppc_n_lost_interrupts) != 0)\n\t\tdo_IRQ(regs);\n#endif\n\n\told_regs = set_irq_regs(regs);\n\tirq_enter();\n\ttrace_timer_interrupt_entry(regs);\n\n\tif (test_irq_work_pending()) {\n\t\tclear_irq_work_pending();\n\t\tirq_work_run();\n\t}\n\n\tnow = get_tb_or_rtc();\n\tif (now >= *next_tb) {\n\t\t*next_tb = ~(u64)0;\n\t\tif (evt->event_handler)\n\t\t\tevt->event_handler(evt);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_event);\n\t} else {\n\t\tnow = *next_tb - now;\n\t\tif (now <= decrementer_max)\n\t\t\tset_dec(now);\n\t\t/* We may have raced with new irq work */\n\t\tif (test_irq_work_pending())\n\t\t\tset_dec(1);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_others);\n\t}\n\n\ttrace_timer_interrupt_exit(regs);\n\tirq_exit();\n\tset_irq_regs(old_regs);\n}"
  },
  {
    "function_name": "arch_irq_work_raise",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "537-554",
    "snippet": "void arch_irq_work_raise(void)\n{\n\t/*\n\t * 64-bit code that uses irq soft-mask can just cause an immediate\n\t * interrupt here that gets soft masked, if this is called under\n\t * local_irq_disable(). It might be possible to prevent that happening\n\t * by noticing interrupts are disabled and setting decrementer pending\n\t * to be replayed when irqs are enabled. The problem there is that\n\t * tracing can call irq_work_raise, including in code that does low\n\t * level manipulations of irq soft-mask state (e.g., trace_hardirqs_on)\n\t * which could get tangled up if we're messing with the same state\n\t * here.\n\t */\n\tpreempt_disable();\n\tset_irq_work_pending_flag();\n\tset_dec(1);\n\tpreempt_enable();\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "1"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_irq_work_pending_flag",
          "args": [],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "set_irq_work_pending_flag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "513-518",
          "snippet": "static inline void set_irq_work_pending_flag(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (1),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline void set_irq_work_pending_flag(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (1),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid arch_irq_work_raise(void)\n{\n\t/*\n\t * 64-bit code that uses irq soft-mask can just cause an immediate\n\t * interrupt here that gets soft masked, if this is called under\n\t * local_irq_disable(). It might be possible to prevent that happening\n\t * by noticing interrupts are disabled and setting decrementer pending\n\t * to be replayed when irqs are enabled. The problem there is that\n\t * tracing can call irq_work_raise, including in code that does low\n\t * level manipulations of irq soft-mask state (e.g., trace_hardirqs_on)\n\t * which could get tangled up if we're messing with the same state\n\t * here.\n\t */\n\tpreempt_disable();\n\tset_irq_work_pending_flag();\n\tset_dec(1);\n\tpreempt_enable();\n}"
  },
  {
    "function_name": "clear_irq_work_pending",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "520-525",
    "snippet": "static inline void clear_irq_work_pending(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (0),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline void clear_irq_work_pending(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (0),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}"
  },
  {
    "function_name": "set_irq_work_pending_flag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "513-518",
    "snippet": "static inline void set_irq_work_pending_flag(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (1),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline void set_irq_work_pending_flag(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (1),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}"
  },
  {
    "function_name": "test_irq_work_pending",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "503-511",
    "snippet": "static inline unsigned long test_irq_work_pending(void)\n{\n\tunsigned long x;\n\n\tasm volatile(\"lbz %0,%1(13)\"\n\t\t: \"=r\" (x)\n\t\t: \"i\" (offsetof(struct paca_struct, irq_work_pending)));\n\treturn x;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline unsigned long test_irq_work_pending(void)\n{\n\tunsigned long x;\n\n\tasm volatile(\"lbz %0,%1(13)\"\n\t\t: \"=r\" (x)\n\t\t: \"i\" (offsetof(struct paca_struct, irq_work_pending)));\n\treturn x;\n}"
  },
  {
    "function_name": "profile_pc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "485-493",
    "snippet": "unsigned long profile_pc(struct pt_regs *regs)\n{\n\tunsigned long pc = instruction_pointer(regs);\n\n\tif (in_lock_functions(pc))\n\t\treturn regs->link;\n\n\treturn pc;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_lock_functions",
          "args": [
            "pc"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "instruction_pointer",
          "args": [
            "regs"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long profile_pc(struct pt_regs *regs)\n{\n\tunsigned long pc = instruction_pointer(regs);\n\n\tif (in_lock_functions(pc))\n\t\treturn regs->link;\n\n\treturn pc;\n}"
  },
  {
    "function_name": "udelay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "478-481",
    "snippet": "void udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long tb_ticks_per_usec = 100;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__delay",
          "args": [
            "tb_ticks_per_usec * usecs"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "__delay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "447-475",
          "snippet": "void __delay(unsigned long loops)\n{\n\tunsigned long start;\n\tint diff;\n\n\tspin_begin();\n\tif (__USE_RTC()) {\n\t\tstart = get_rtcl();\n\t\tdo {\n\t\t\t/* the RTCL register wraps at 1000000000 */\n\t\t\tdiff = get_rtcl() - start;\n\t\t\tif (diff < 0)\n\t\t\t\tdiff += 1000000000;\n\t\t\tspin_cpu_relax();\n\t\t} while (diff < loops);\n\t} else if (tb_invalid) {\n\t\t/*\n\t\t * TB is in error state and isn't ticking anymore.\n\t\t * HMI handler was unable to recover from TB error.\n\t\t * Return immediately, so that kernel won't get stuck here.\n\t\t */\n\t\tspin_cpu_relax();\n\t} else {\n\t\tstart = get_tbl();\n\t\twhile (get_tbl() - start < loops)\n\t\t\tspin_cpu_relax();\n\t}\n\tspin_end();\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool tb_invalid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nbool tb_invalid;\n\nvoid __delay(unsigned long loops)\n{\n\tunsigned long start;\n\tint diff;\n\n\tspin_begin();\n\tif (__USE_RTC()) {\n\t\tstart = get_rtcl();\n\t\tdo {\n\t\t\t/* the RTCL register wraps at 1000000000 */\n\t\t\tdiff = get_rtcl() - start;\n\t\t\tif (diff < 0)\n\t\t\t\tdiff += 1000000000;\n\t\t\tspin_cpu_relax();\n\t\t} while (diff < loops);\n\t} else if (tb_invalid) {\n\t\t/*\n\t\t * TB is in error state and isn't ticking anymore.\n\t\t * HMI handler was unable to recover from TB error.\n\t\t * Return immediately, so that kernel won't get stuck here.\n\t\t */\n\t\tspin_cpu_relax();\n\t} else {\n\t\tstart = get_tbl();\n\t\twhile (get_tbl() - start < loops)\n\t\t\tspin_cpu_relax();\n\t}\n\tspin_end();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long tb_ticks_per_usec = 100;\n\nvoid udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}"
  },
  {
    "function_name": "__delay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "447-475",
    "snippet": "void __delay(unsigned long loops)\n{\n\tunsigned long start;\n\tint diff;\n\n\tspin_begin();\n\tif (__USE_RTC()) {\n\t\tstart = get_rtcl();\n\t\tdo {\n\t\t\t/* the RTCL register wraps at 1000000000 */\n\t\t\tdiff = get_rtcl() - start;\n\t\t\tif (diff < 0)\n\t\t\t\tdiff += 1000000000;\n\t\t\tspin_cpu_relax();\n\t\t} while (diff < loops);\n\t} else if (tb_invalid) {\n\t\t/*\n\t\t * TB is in error state and isn't ticking anymore.\n\t\t * HMI handler was unable to recover from TB error.\n\t\t * Return immediately, so that kernel won't get stuck here.\n\t\t */\n\t\tspin_cpu_relax();\n\t} else {\n\t\tstart = get_tbl();\n\t\twhile (get_tbl() - start < loops)\n\t\t\tspin_cpu_relax();\n\t}\n\tspin_end();\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool tb_invalid;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_end",
          "args": [],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_cpu_relax",
          "args": [],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_tbl",
          "args": [],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_tbl",
          "args": [],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_cpu_relax",
          "args": [],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_cpu_relax",
          "args": [],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_rtcl",
          "args": [],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_rtcl",
          "args": [],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__USE_RTC",
          "args": [],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_begin",
          "args": [],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nbool tb_invalid;\n\nvoid __delay(unsigned long loops)\n{\n\tunsigned long start;\n\tint diff;\n\n\tspin_begin();\n\tif (__USE_RTC()) {\n\t\tstart = get_rtcl();\n\t\tdo {\n\t\t\t/* the RTCL register wraps at 1000000000 */\n\t\t\tdiff = get_rtcl() - start;\n\t\t\tif (diff < 0)\n\t\t\t\tdiff += 1000000000;\n\t\t\tspin_cpu_relax();\n\t\t} while (diff < loops);\n\t} else if (tb_invalid) {\n\t\t/*\n\t\t * TB is in error state and isn't ticking anymore.\n\t\t * HMI handler was unable to recover from TB error.\n\t\t * Return immediately, so that kernel won't get stuck here.\n\t\t */\n\t\tspin_cpu_relax();\n\t} else {\n\t\tstart = get_tbl();\n\t\twhile (get_tbl() - start < loops)\n\t\t\tspin_cpu_relax();\n\t}\n\tspin_end();\n}"
  },
  {
    "function_name": "vtime_flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "404-441",
    "snippet": "void vtime_flush(struct task_struct *tsk)\n{\n\tstruct cpu_accounting_data *acct = get_accounting(tsk);\n\n\tif (acct->utime)\n\t\taccount_user_time(tsk, cputime_to_nsecs(acct->utime));\n\n\tif (acct->gtime)\n\t\taccount_guest_time(tsk, cputime_to_nsecs(acct->gtime));\n\n\tif (IS_ENABLED(CONFIG_PPC_SPLPAR) && acct->steal_time) {\n\t\taccount_steal_time(cputime_to_nsecs(acct->steal_time));\n\t\tacct->steal_time = 0;\n\t}\n\n\tif (acct->idle_time)\n\t\taccount_idle_time(cputime_to_nsecs(acct->idle_time));\n\n\tif (acct->stime)\n\t\taccount_system_index_time(tsk, cputime_to_nsecs(acct->stime),\n\t\t\t\t\t  CPUTIME_SYSTEM);\n\n\tif (acct->hardirq_time)\n\t\taccount_system_index_time(tsk, cputime_to_nsecs(acct->hardirq_time),\n\t\t\t\t\t  CPUTIME_IRQ);\n\tif (acct->softirq_time)\n\t\taccount_system_index_time(tsk, cputime_to_nsecs(acct->softirq_time),\n\t\t\t\t\t  CPUTIME_SOFTIRQ);\n\n\tvtime_flush_scaled(tsk, acct);\n\n\tacct->utime = 0;\n\tacct->gtime = 0;\n\tacct->idle_time = 0;\n\tacct->stime = 0;\n\tacct->hardirq_time = 0;\n\tacct->softirq_time = 0;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vtime_flush_scaled",
          "args": [
            "tsk",
            "acct"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "vtime_flush_scaled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "382-395",
          "snippet": "static void vtime_flush_scaled(struct task_struct *tsk,\n\t\t\t       struct cpu_accounting_data *acct)\n{\n#ifdef CONFIG_ARCH_HAS_SCALED_CPUTIME\n\tif (acct->utime_scaled)\n\t\ttsk->utimescaled += cputime_to_nsecs(acct->utime_scaled);\n\tif (acct->stime_scaled)\n\t\ttsk->stimescaled += cputime_to_nsecs(acct->stime_scaled);\n\n\tacct->utime_scaled = 0;\n\tacct->utime_sspurr = 0;\n\tacct->stime_scaled = 0;\n#endif\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void vtime_flush_scaled(struct task_struct *tsk,\n\t\t\t       struct cpu_accounting_data *acct)\n{\n#ifdef CONFIG_ARCH_HAS_SCALED_CPUTIME\n\tif (acct->utime_scaled)\n\t\ttsk->utimescaled += cputime_to_nsecs(acct->utime_scaled);\n\tif (acct->stime_scaled)\n\t\ttsk->stimescaled += cputime_to_nsecs(acct->stime_scaled);\n\n\tacct->utime_scaled = 0;\n\tacct->utime_sspurr = 0;\n\tacct->stime_scaled = 0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "account_system_index_time",
          "args": [
            "tsk",
            "cputime_to_nsecs(acct->softirq_time)",
            "CPUTIME_SOFTIRQ"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime_to_nsecs",
          "args": [
            "acct->softirq_time"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "account_system_index_time",
          "args": [
            "tsk",
            "cputime_to_nsecs(acct->hardirq_time)",
            "CPUTIME_IRQ"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime_to_nsecs",
          "args": [
            "acct->hardirq_time"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "account_system_index_time",
          "args": [
            "tsk",
            "cputime_to_nsecs(acct->stime)",
            "CPUTIME_SYSTEM"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime_to_nsecs",
          "args": [
            "acct->stime"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "account_idle_time",
          "args": [
            "cputime_to_nsecs(acct->idle_time)"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime_to_nsecs",
          "args": [
            "acct->idle_time"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "account_steal_time",
          "args": [
            "cputime_to_nsecs(acct->steal_time)"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime_to_nsecs",
          "args": [
            "acct->steal_time"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC_SPLPAR"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "account_guest_time",
          "args": [
            "tsk",
            "cputime_to_nsecs(acct->gtime)"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime_to_nsecs",
          "args": [
            "acct->gtime"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "account_user_time",
          "args": [
            "tsk",
            "cputime_to_nsecs(acct->utime)"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime_to_nsecs",
          "args": [
            "acct->utime"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_accounting",
          "args": [
            "tsk"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid vtime_flush(struct task_struct *tsk)\n{\n\tstruct cpu_accounting_data *acct = get_accounting(tsk);\n\n\tif (acct->utime)\n\t\taccount_user_time(tsk, cputime_to_nsecs(acct->utime));\n\n\tif (acct->gtime)\n\t\taccount_guest_time(tsk, cputime_to_nsecs(acct->gtime));\n\n\tif (IS_ENABLED(CONFIG_PPC_SPLPAR) && acct->steal_time) {\n\t\taccount_steal_time(cputime_to_nsecs(acct->steal_time));\n\t\tacct->steal_time = 0;\n\t}\n\n\tif (acct->idle_time)\n\t\taccount_idle_time(cputime_to_nsecs(acct->idle_time));\n\n\tif (acct->stime)\n\t\taccount_system_index_time(tsk, cputime_to_nsecs(acct->stime),\n\t\t\t\t\t  CPUTIME_SYSTEM);\n\n\tif (acct->hardirq_time)\n\t\taccount_system_index_time(tsk, cputime_to_nsecs(acct->hardirq_time),\n\t\t\t\t\t  CPUTIME_IRQ);\n\tif (acct->softirq_time)\n\t\taccount_system_index_time(tsk, cputime_to_nsecs(acct->softirq_time),\n\t\t\t\t\t  CPUTIME_SOFTIRQ);\n\n\tvtime_flush_scaled(tsk, acct);\n\n\tacct->utime = 0;\n\tacct->gtime = 0;\n\tacct->idle_time = 0;\n\tacct->stime = 0;\n\tacct->hardirq_time = 0;\n\tacct->softirq_time = 0;\n}"
  },
  {
    "function_name": "vtime_flush_scaled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "382-395",
    "snippet": "static void vtime_flush_scaled(struct task_struct *tsk,\n\t\t\t       struct cpu_accounting_data *acct)\n{\n#ifdef CONFIG_ARCH_HAS_SCALED_CPUTIME\n\tif (acct->utime_scaled)\n\t\ttsk->utimescaled += cputime_to_nsecs(acct->utime_scaled);\n\tif (acct->stime_scaled)\n\t\ttsk->stimescaled += cputime_to_nsecs(acct->stime_scaled);\n\n\tacct->utime_scaled = 0;\n\tacct->utime_sspurr = 0;\n\tacct->stime_scaled = 0;\n#endif\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cputime_to_nsecs",
          "args": [
            "acct->stime_scaled"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cputime_to_nsecs",
          "args": [
            "acct->utime_scaled"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void vtime_flush_scaled(struct task_struct *tsk,\n\t\t\t       struct cpu_accounting_data *acct)\n{\n#ifdef CONFIG_ARCH_HAS_SCALED_CPUTIME\n\tif (acct->utime_scaled)\n\t\ttsk->utimescaled += cputime_to_nsecs(acct->utime_scaled);\n\tif (acct->stime_scaled)\n\t\ttsk->stimescaled += cputime_to_nsecs(acct->stime_scaled);\n\n\tacct->utime_scaled = 0;\n\tacct->utime_sspurr = 0;\n\tacct->stime_scaled = 0;\n#endif\n}"
  },
  {
    "function_name": "vtime_account_idle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "373-380",
    "snippet": "void vtime_account_idle(struct task_struct *tsk)\n{\n\tunsigned long stime, stime_scaled, steal_time;\n\tstruct cpu_accounting_data *acct = get_accounting(tsk);\n\n\tstime = vtime_delta(tsk, &stime_scaled, &steal_time);\n\tacct->idle_time += stime + steal_time;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vtime_delta",
          "args": [
            "tsk",
            "&stime_scaled",
            "&steal_time"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "vtime_delta",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "323-341",
          "snippet": "static unsigned long vtime_delta(struct task_struct *tsk,\n\t\t\t\t unsigned long *stime_scaled,\n\t\t\t\t unsigned long *steal_time)\n{\n\tunsigned long now, stime;\n\tstruct cpu_accounting_data *acct = get_accounting(tsk);\n\n\tWARN_ON_ONCE(!irqs_disabled());\n\n\tnow = mftb();\n\tstime = now - acct->starttime;\n\tacct->starttime = now;\n\n\t*stime_scaled = vtime_delta_scaled(acct, now, stime);\n\n\t*steal_time = calculate_stolen_time(now);\n\n\treturn stime;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic unsigned long vtime_delta(struct task_struct *tsk,\n\t\t\t\t unsigned long *stime_scaled,\n\t\t\t\t unsigned long *steal_time)\n{\n\tunsigned long now, stime;\n\tstruct cpu_accounting_data *acct = get_accounting(tsk);\n\n\tWARN_ON_ONCE(!irqs_disabled());\n\n\tnow = mftb();\n\tstime = now - acct->starttime;\n\tacct->starttime = now;\n\n\t*stime_scaled = vtime_delta_scaled(acct, now, stime);\n\n\t*steal_time = calculate_stolen_time(now);\n\n\treturn stime;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_accounting",
          "args": [
            "tsk"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid vtime_account_idle(struct task_struct *tsk)\n{\n\tunsigned long stime, stime_scaled, steal_time;\n\tstruct cpu_accounting_data *acct = get_accounting(tsk);\n\n\tstime = vtime_delta(tsk, &stime_scaled, &steal_time);\n\tacct->idle_time += stime + steal_time;\n}"
  },
  {
    "function_name": "vtime_account_kernel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "343-370",
    "snippet": "void vtime_account_kernel(struct task_struct *tsk)\n{\n\tunsigned long stime, stime_scaled, steal_time;\n\tstruct cpu_accounting_data *acct = get_accounting(tsk);\n\n\tstime = vtime_delta(tsk, &stime_scaled, &steal_time);\n\n\tstime -= min(stime, steal_time);\n\tacct->steal_time += steal_time;\n\n\tif ((tsk->flags & PF_VCPU) && !irq_count()) {\n\t\tacct->gtime += stime;\n#ifdef CONFIG_ARCH_HAS_SCALED_CPUTIME\n\t\tacct->utime_scaled += stime_scaled;\n#endif\n\t} else {\n\t\tif (hardirq_count())\n\t\t\tacct->hardirq_time += stime;\n\t\telse if (in_serving_softirq())\n\t\t\tacct->softirq_time += stime;\n\t\telse\n\t\t\tacct->stime += stime;\n\n#ifdef CONFIG_ARCH_HAS_SCALED_CPUTIME\n\t\tacct->stime_scaled += stime_scaled;\n#endif\n\t}\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_serving_softirq",
          "args": [],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hardirq_count",
          "args": [],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_count",
          "args": [],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "stime",
            "steal_time"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vtime_delta",
          "args": [
            "tsk",
            "&stime_scaled",
            "&steal_time"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "vtime_delta",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "323-341",
          "snippet": "static unsigned long vtime_delta(struct task_struct *tsk,\n\t\t\t\t unsigned long *stime_scaled,\n\t\t\t\t unsigned long *steal_time)\n{\n\tunsigned long now, stime;\n\tstruct cpu_accounting_data *acct = get_accounting(tsk);\n\n\tWARN_ON_ONCE(!irqs_disabled());\n\n\tnow = mftb();\n\tstime = now - acct->starttime;\n\tacct->starttime = now;\n\n\t*stime_scaled = vtime_delta_scaled(acct, now, stime);\n\n\t*steal_time = calculate_stolen_time(now);\n\n\treturn stime;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic unsigned long vtime_delta(struct task_struct *tsk,\n\t\t\t\t unsigned long *stime_scaled,\n\t\t\t\t unsigned long *steal_time)\n{\n\tunsigned long now, stime;\n\tstruct cpu_accounting_data *acct = get_accounting(tsk);\n\n\tWARN_ON_ONCE(!irqs_disabled());\n\n\tnow = mftb();\n\tstime = now - acct->starttime;\n\tacct->starttime = now;\n\n\t*stime_scaled = vtime_delta_scaled(acct, now, stime);\n\n\t*steal_time = calculate_stolen_time(now);\n\n\treturn stime;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_accounting",
          "args": [
            "tsk"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid vtime_account_kernel(struct task_struct *tsk)\n{\n\tunsigned long stime, stime_scaled, steal_time;\n\tstruct cpu_accounting_data *acct = get_accounting(tsk);\n\n\tstime = vtime_delta(tsk, &stime_scaled, &steal_time);\n\n\tstime -= min(stime, steal_time);\n\tacct->steal_time += steal_time;\n\n\tif ((tsk->flags & PF_VCPU) && !irq_count()) {\n\t\tacct->gtime += stime;\n#ifdef CONFIG_ARCH_HAS_SCALED_CPUTIME\n\t\tacct->utime_scaled += stime_scaled;\n#endif\n\t} else {\n\t\tif (hardirq_count())\n\t\t\tacct->hardirq_time += stime;\n\t\telse if (in_serving_softirq())\n\t\t\tacct->softirq_time += stime;\n\t\telse\n\t\t\tacct->stime += stime;\n\n#ifdef CONFIG_ARCH_HAS_SCALED_CPUTIME\n\t\tacct->stime_scaled += stime_scaled;\n#endif\n\t}\n}"
  },
  {
    "function_name": "vtime_delta",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "323-341",
    "snippet": "static unsigned long vtime_delta(struct task_struct *tsk,\n\t\t\t\t unsigned long *stime_scaled,\n\t\t\t\t unsigned long *steal_time)\n{\n\tunsigned long now, stime;\n\tstruct cpu_accounting_data *acct = get_accounting(tsk);\n\n\tWARN_ON_ONCE(!irqs_disabled());\n\n\tnow = mftb();\n\tstime = now - acct->starttime;\n\tacct->starttime = now;\n\n\t*stime_scaled = vtime_delta_scaled(acct, now, stime);\n\n\t*steal_time = calculate_stolen_time(now);\n\n\treturn stime;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "calculate_stolen_time",
          "args": [
            "now"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "calculate_stolen_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "272-275",
          "snippet": "static inline u64 calculate_stolen_time(u64 stop_tb)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline u64 calculate_stolen_time(u64 stop_tb)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vtime_delta_scaled",
          "args": [
            "acct",
            "now",
            "stime"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "vtime_delta_scaled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "283-321",
          "snippet": "static unsigned long vtime_delta_scaled(struct cpu_accounting_data *acct,\n\t\t\t\t\tunsigned long now, unsigned long stime)\n{\n\tunsigned long stime_scaled = 0;\n#ifdef CONFIG_ARCH_HAS_SCALED_CPUTIME\n\tunsigned long nowscaled, deltascaled;\n\tunsigned long utime, utime_scaled;\n\n\tnowscaled = read_spurr(now);\n\tdeltascaled = nowscaled - acct->startspurr;\n\tacct->startspurr = nowscaled;\n\tutime = acct->utime - acct->utime_sspurr;\n\tacct->utime_sspurr = acct->utime;\n\n\t/*\n\t * Because we don't read the SPURR on every kernel entry/exit,\n\t * deltascaled includes both user and system SPURR ticks.\n\t * Apportion these ticks to system SPURR ticks and user\n\t * SPURR ticks in the same ratio as the system time (delta)\n\t * and user time (udelta) values obtained from the timebase\n\t * over the same interval.  The system ticks get accounted here;\n\t * the user ticks get saved up in paca->user_time_scaled to be\n\t * used by account_process_tick.\n\t */\n\tstime_scaled = stime;\n\tutime_scaled = utime;\n\tif (deltascaled != stime + utime) {\n\t\tif (utime) {\n\t\t\tstime_scaled = deltascaled * stime / (stime + utime);\n\t\t\tutime_scaled = deltascaled - stime_scaled;\n\t\t} else {\n\t\t\tstime_scaled = deltascaled;\n\t\t}\n\t}\n\tacct->utime_scaled += utime_scaled;\n#endif\n\n\treturn stime_scaled;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic unsigned long vtime_delta_scaled(struct cpu_accounting_data *acct,\n\t\t\t\t\tunsigned long now, unsigned long stime)\n{\n\tunsigned long stime_scaled = 0;\n#ifdef CONFIG_ARCH_HAS_SCALED_CPUTIME\n\tunsigned long nowscaled, deltascaled;\n\tunsigned long utime, utime_scaled;\n\n\tnowscaled = read_spurr(now);\n\tdeltascaled = nowscaled - acct->startspurr;\n\tacct->startspurr = nowscaled;\n\tutime = acct->utime - acct->utime_sspurr;\n\tacct->utime_sspurr = acct->utime;\n\n\t/*\n\t * Because we don't read the SPURR on every kernel entry/exit,\n\t * deltascaled includes both user and system SPURR ticks.\n\t * Apportion these ticks to system SPURR ticks and user\n\t * SPURR ticks in the same ratio as the system time (delta)\n\t * and user time (udelta) values obtained from the timebase\n\t * over the same interval.  The system ticks get accounted here;\n\t * the user ticks get saved up in paca->user_time_scaled to be\n\t * used by account_process_tick.\n\t */\n\tstime_scaled = stime;\n\tutime_scaled = utime;\n\tif (deltascaled != stime + utime) {\n\t\tif (utime) {\n\t\t\tstime_scaled = deltascaled * stime / (stime + utime);\n\t\t\tutime_scaled = deltascaled - stime_scaled;\n\t\t} else {\n\t\t\tstime_scaled = deltascaled;\n\t\t}\n\t}\n\tacct->utime_scaled += utime_scaled;\n#endif\n\n\treturn stime_scaled;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mftb",
          "args": [],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!irqs_disabled()"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irqs_disabled",
          "args": [],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_accounting",
          "args": [
            "tsk"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic unsigned long vtime_delta(struct task_struct *tsk,\n\t\t\t\t unsigned long *stime_scaled,\n\t\t\t\t unsigned long *steal_time)\n{\n\tunsigned long now, stime;\n\tstruct cpu_accounting_data *acct = get_accounting(tsk);\n\n\tWARN_ON_ONCE(!irqs_disabled());\n\n\tnow = mftb();\n\tstime = now - acct->starttime;\n\tacct->starttime = now;\n\n\t*stime_scaled = vtime_delta_scaled(acct, now, stime);\n\n\t*steal_time = calculate_stolen_time(now);\n\n\treturn stime;\n}"
  },
  {
    "function_name": "vtime_delta_scaled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "283-321",
    "snippet": "static unsigned long vtime_delta_scaled(struct cpu_accounting_data *acct,\n\t\t\t\t\tunsigned long now, unsigned long stime)\n{\n\tunsigned long stime_scaled = 0;\n#ifdef CONFIG_ARCH_HAS_SCALED_CPUTIME\n\tunsigned long nowscaled, deltascaled;\n\tunsigned long utime, utime_scaled;\n\n\tnowscaled = read_spurr(now);\n\tdeltascaled = nowscaled - acct->startspurr;\n\tacct->startspurr = nowscaled;\n\tutime = acct->utime - acct->utime_sspurr;\n\tacct->utime_sspurr = acct->utime;\n\n\t/*\n\t * Because we don't read the SPURR on every kernel entry/exit,\n\t * deltascaled includes both user and system SPURR ticks.\n\t * Apportion these ticks to system SPURR ticks and user\n\t * SPURR ticks in the same ratio as the system time (delta)\n\t * and user time (udelta) values obtained from the timebase\n\t * over the same interval.  The system ticks get accounted here;\n\t * the user ticks get saved up in paca->user_time_scaled to be\n\t * used by account_process_tick.\n\t */\n\tstime_scaled = stime;\n\tutime_scaled = utime;\n\tif (deltascaled != stime + utime) {\n\t\tif (utime) {\n\t\t\tstime_scaled = deltascaled * stime / (stime + utime);\n\t\t\tutime_scaled = deltascaled - stime_scaled;\n\t\t} else {\n\t\t\tstime_scaled = deltascaled;\n\t\t}\n\t}\n\tacct->utime_scaled += utime_scaled;\n#endif\n\n\treturn stime_scaled;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "read_spurr",
          "args": [
            "now"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "read_spurr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "175-182",
          "snippet": "static inline unsigned long read_spurr(unsigned long tb)\n{\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\treturn mfspr(SPRN_SPURR);\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\treturn mfspr(SPRN_PURR);\n\treturn tb;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline unsigned long read_spurr(unsigned long tb)\n{\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\treturn mfspr(SPRN_SPURR);\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\treturn mfspr(SPRN_PURR);\n\treturn tb;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic unsigned long vtime_delta_scaled(struct cpu_accounting_data *acct,\n\t\t\t\t\tunsigned long now, unsigned long stime)\n{\n\tunsigned long stime_scaled = 0;\n#ifdef CONFIG_ARCH_HAS_SCALED_CPUTIME\n\tunsigned long nowscaled, deltascaled;\n\tunsigned long utime, utime_scaled;\n\n\tnowscaled = read_spurr(now);\n\tdeltascaled = nowscaled - acct->startspurr;\n\tacct->startspurr = nowscaled;\n\tutime = acct->utime - acct->utime_sspurr;\n\tacct->utime_sspurr = acct->utime;\n\n\t/*\n\t * Because we don't read the SPURR on every kernel entry/exit,\n\t * deltascaled includes both user and system SPURR ticks.\n\t * Apportion these ticks to system SPURR ticks and user\n\t * SPURR ticks in the same ratio as the system time (delta)\n\t * and user time (udelta) values obtained from the timebase\n\t * over the same interval.  The system ticks get accounted here;\n\t * the user ticks get saved up in paca->user_time_scaled to be\n\t * used by account_process_tick.\n\t */\n\tstime_scaled = stime;\n\tutime_scaled = utime;\n\tif (deltascaled != stime + utime) {\n\t\tif (utime) {\n\t\t\tstime_scaled = deltascaled * stime / (stime + utime);\n\t\t\tutime_scaled = deltascaled - stime_scaled;\n\t\t} else {\n\t\t\tstime_scaled = deltascaled;\n\t\t}\n\t}\n\tacct->utime_scaled += utime_scaled;\n#endif\n\n\treturn stime_scaled;\n}"
  },
  {
    "function_name": "calculate_stolen_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "272-275",
    "snippet": "static inline u64 calculate_stolen_time(u64 stop_tb)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline u64 calculate_stolen_time(u64 stop_tb)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "calculate_stolen_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "260-269",
    "snippet": "static inline u64 calculate_stolen_time(u64 stop_tb)\n{\n\tif (!firmware_has_feature(FW_FEATURE_SPLPAR))\n\t\treturn 0;\n\n\tif (get_paca()->dtl_ridx != be64_to_cpu(get_lppaca()->dtl_idx))\n\t\treturn scan_dispatch_log(stop_tb);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scan_dispatch_log",
          "args": [
            "stop_tb"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "scan_dispatch_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "192-231",
          "snippet": "static u64 scan_dispatch_log(u64 stop_tb)\n{\n\tu64 i = local_paca->dtl_ridx;\n\tstruct dtl_entry *dtl = local_paca->dtl_curr;\n\tstruct dtl_entry *dtl_end = local_paca->dispatch_log_end;\n\tstruct lppaca *vpa = local_paca->lppaca_ptr;\n\tu64 tb_delta;\n\tu64 stolen = 0;\n\tu64 dtb;\n\n\tif (!dtl)\n\t\treturn 0;\n\n\tif (i == be64_to_cpu(vpa->dtl_idx))\n\t\treturn 0;\n\twhile (i < be64_to_cpu(vpa->dtl_idx)) {\n\t\tdtb = be64_to_cpu(dtl->timebase);\n\t\ttb_delta = be32_to_cpu(dtl->enqueue_to_dispatch_time) +\n\t\t\tbe32_to_cpu(dtl->ready_to_enqueue_time);\n\t\tbarrier();\n\t\tif (i + N_DISPATCH_LOG < be64_to_cpu(vpa->dtl_idx)) {\n\t\t\t/* buffer has overflowed */\n\t\t\ti = be64_to_cpu(vpa->dtl_idx) - N_DISPATCH_LOG;\n\t\t\tdtl = local_paca->dispatch_log + (i % N_DISPATCH_LOG);\n\t\t\tcontinue;\n\t\t}\n\t\tif (dtb > stop_tb)\n\t\t\tbreak;\n\t\tif (dtl_consumer)\n\t\t\tdtl_consumer(dtl, i);\n\t\tstolen += tb_delta;\n\t\t++i;\n\t\t++dtl;\n\t\tif (dtl == dtl_end)\n\t\t\tdtl = local_paca->dispatch_log;\n\t}\n\tlocal_paca->dtl_ridx = i;\n\tlocal_paca->dtl_curr = dtl;\n\treturn stolen;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 scan_dispatch_log(u64 stop_tb)\n{\n\tu64 i = local_paca->dtl_ridx;\n\tstruct dtl_entry *dtl = local_paca->dtl_curr;\n\tstruct dtl_entry *dtl_end = local_paca->dispatch_log_end;\n\tstruct lppaca *vpa = local_paca->lppaca_ptr;\n\tu64 tb_delta;\n\tu64 stolen = 0;\n\tu64 dtb;\n\n\tif (!dtl)\n\t\treturn 0;\n\n\tif (i == be64_to_cpu(vpa->dtl_idx))\n\t\treturn 0;\n\twhile (i < be64_to_cpu(vpa->dtl_idx)) {\n\t\tdtb = be64_to_cpu(dtl->timebase);\n\t\ttb_delta = be32_to_cpu(dtl->enqueue_to_dispatch_time) +\n\t\t\tbe32_to_cpu(dtl->ready_to_enqueue_time);\n\t\tbarrier();\n\t\tif (i + N_DISPATCH_LOG < be64_to_cpu(vpa->dtl_idx)) {\n\t\t\t/* buffer has overflowed */\n\t\t\ti = be64_to_cpu(vpa->dtl_idx) - N_DISPATCH_LOG;\n\t\t\tdtl = local_paca->dispatch_log + (i % N_DISPATCH_LOG);\n\t\t\tcontinue;\n\t\t}\n\t\tif (dtb > stop_tb)\n\t\t\tbreak;\n\t\tif (dtl_consumer)\n\t\t\tdtl_consumer(dtl, i);\n\t\tstolen += tb_delta;\n\t\t++i;\n\t\t++dtl;\n\t\tif (dtl == dtl_end)\n\t\t\tdtl = local_paca->dispatch_log;\n\t}\n\tlocal_paca->dtl_ridx = i;\n\tlocal_paca->dtl_curr = dtl;\n\treturn stolen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "get_lppaca()->dtl_idx"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_lppaca",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_SPLPAR"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline u64 calculate_stolen_time(u64 stop_tb)\n{\n\tif (!firmware_has_feature(FW_FEATURE_SPLPAR))\n\t\treturn 0;\n\n\tif (get_paca()->dtl_ridx != be64_to_cpu(get_lppaca()->dtl_idx))\n\t\treturn scan_dispatch_log(stop_tb);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "accumulate_stolen_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "237-258",
    "snippet": "void notrace accumulate_stolen_time(void)\n{\n\tu64 sst, ust;\n\tunsigned long save_irq_soft_mask = irq_soft_mask_return();\n\tstruct cpu_accounting_data *acct = &local_paca->accounting;\n\n\t/* We are called early in the exception entry, before\n\t * soft/hard_enabled are sync'ed to the expected state\n\t * for the exception. We are hard disabled but the PACA\n\t * needs to reflect that so various debug stuff doesn't\n\t * complain\n\t */\n\tirq_soft_mask_set(IRQS_DISABLED);\n\n\tsst = scan_dispatch_log(acct->starttime_user);\n\tust = scan_dispatch_log(acct->starttime);\n\tacct->stime -= sst;\n\tacct->utime -= ust;\n\tacct->steal_time += ust + sst;\n\n\tirq_soft_mask_set(save_irq_soft_mask);\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_soft_mask_set",
          "args": [
            "save_irq_soft_mask"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scan_dispatch_log",
          "args": [
            "acct->starttime"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "scan_dispatch_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "192-231",
          "snippet": "static u64 scan_dispatch_log(u64 stop_tb)\n{\n\tu64 i = local_paca->dtl_ridx;\n\tstruct dtl_entry *dtl = local_paca->dtl_curr;\n\tstruct dtl_entry *dtl_end = local_paca->dispatch_log_end;\n\tstruct lppaca *vpa = local_paca->lppaca_ptr;\n\tu64 tb_delta;\n\tu64 stolen = 0;\n\tu64 dtb;\n\n\tif (!dtl)\n\t\treturn 0;\n\n\tif (i == be64_to_cpu(vpa->dtl_idx))\n\t\treturn 0;\n\twhile (i < be64_to_cpu(vpa->dtl_idx)) {\n\t\tdtb = be64_to_cpu(dtl->timebase);\n\t\ttb_delta = be32_to_cpu(dtl->enqueue_to_dispatch_time) +\n\t\t\tbe32_to_cpu(dtl->ready_to_enqueue_time);\n\t\tbarrier();\n\t\tif (i + N_DISPATCH_LOG < be64_to_cpu(vpa->dtl_idx)) {\n\t\t\t/* buffer has overflowed */\n\t\t\ti = be64_to_cpu(vpa->dtl_idx) - N_DISPATCH_LOG;\n\t\t\tdtl = local_paca->dispatch_log + (i % N_DISPATCH_LOG);\n\t\t\tcontinue;\n\t\t}\n\t\tif (dtb > stop_tb)\n\t\t\tbreak;\n\t\tif (dtl_consumer)\n\t\t\tdtl_consumer(dtl, i);\n\t\tstolen += tb_delta;\n\t\t++i;\n\t\t++dtl;\n\t\tif (dtl == dtl_end)\n\t\t\tdtl = local_paca->dispatch_log;\n\t}\n\tlocal_paca->dtl_ridx = i;\n\tlocal_paca->dtl_curr = dtl;\n\treturn stolen;\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 scan_dispatch_log(u64 stop_tb)\n{\n\tu64 i = local_paca->dtl_ridx;\n\tstruct dtl_entry *dtl = local_paca->dtl_curr;\n\tstruct dtl_entry *dtl_end = local_paca->dispatch_log_end;\n\tstruct lppaca *vpa = local_paca->lppaca_ptr;\n\tu64 tb_delta;\n\tu64 stolen = 0;\n\tu64 dtb;\n\n\tif (!dtl)\n\t\treturn 0;\n\n\tif (i == be64_to_cpu(vpa->dtl_idx))\n\t\treturn 0;\n\twhile (i < be64_to_cpu(vpa->dtl_idx)) {\n\t\tdtb = be64_to_cpu(dtl->timebase);\n\t\ttb_delta = be32_to_cpu(dtl->enqueue_to_dispatch_time) +\n\t\t\tbe32_to_cpu(dtl->ready_to_enqueue_time);\n\t\tbarrier();\n\t\tif (i + N_DISPATCH_LOG < be64_to_cpu(vpa->dtl_idx)) {\n\t\t\t/* buffer has overflowed */\n\t\t\ti = be64_to_cpu(vpa->dtl_idx) - N_DISPATCH_LOG;\n\t\t\tdtl = local_paca->dispatch_log + (i % N_DISPATCH_LOG);\n\t\t\tcontinue;\n\t\t}\n\t\tif (dtb > stop_tb)\n\t\t\tbreak;\n\t\tif (dtl_consumer)\n\t\t\tdtl_consumer(dtl, i);\n\t\tstolen += tb_delta;\n\t\t++i;\n\t\t++dtl;\n\t\tif (dtl == dtl_end)\n\t\t\tdtl = local_paca->dispatch_log;\n\t}\n\tlocal_paca->dtl_ridx = i;\n\tlocal_paca->dtl_curr = dtl;\n\treturn stolen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_soft_mask_set",
          "args": [
            "IRQS_DISABLED"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_soft_mask_return",
          "args": [],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid notrace accumulate_stolen_time(void)\n{\n\tu64 sst, ust;\n\tunsigned long save_irq_soft_mask = irq_soft_mask_return();\n\tstruct cpu_accounting_data *acct = &local_paca->accounting;\n\n\t/* We are called early in the exception entry, before\n\t * soft/hard_enabled are sync'ed to the expected state\n\t * for the exception. We are hard disabled but the PACA\n\t * needs to reflect that so various debug stuff doesn't\n\t * complain\n\t */\n\tirq_soft_mask_set(IRQS_DISABLED);\n\n\tsst = scan_dispatch_log(acct->starttime_user);\n\tust = scan_dispatch_log(acct->starttime);\n\tacct->stime -= sst;\n\tacct->utime -= ust;\n\tacct->steal_time += ust + sst;\n\n\tirq_soft_mask_set(save_irq_soft_mask);\n}"
  },
  {
    "function_name": "scan_dispatch_log",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "192-231",
    "snippet": "static u64 scan_dispatch_log(u64 stop_tb)\n{\n\tu64 i = local_paca->dtl_ridx;\n\tstruct dtl_entry *dtl = local_paca->dtl_curr;\n\tstruct dtl_entry *dtl_end = local_paca->dispatch_log_end;\n\tstruct lppaca *vpa = local_paca->lppaca_ptr;\n\tu64 tb_delta;\n\tu64 stolen = 0;\n\tu64 dtb;\n\n\tif (!dtl)\n\t\treturn 0;\n\n\tif (i == be64_to_cpu(vpa->dtl_idx))\n\t\treturn 0;\n\twhile (i < be64_to_cpu(vpa->dtl_idx)) {\n\t\tdtb = be64_to_cpu(dtl->timebase);\n\t\ttb_delta = be32_to_cpu(dtl->enqueue_to_dispatch_time) +\n\t\t\tbe32_to_cpu(dtl->ready_to_enqueue_time);\n\t\tbarrier();\n\t\tif (i + N_DISPATCH_LOG < be64_to_cpu(vpa->dtl_idx)) {\n\t\t\t/* buffer has overflowed */\n\t\t\ti = be64_to_cpu(vpa->dtl_idx) - N_DISPATCH_LOG;\n\t\t\tdtl = local_paca->dispatch_log + (i % N_DISPATCH_LOG);\n\t\t\tcontinue;\n\t\t}\n\t\tif (dtb > stop_tb)\n\t\t\tbreak;\n\t\tif (dtl_consumer)\n\t\t\tdtl_consumer(dtl, i);\n\t\tstolen += tb_delta;\n\t\t++i;\n\t\t++dtl;\n\t\tif (dtl == dtl_end)\n\t\t\tdtl = local_paca->dispatch_log;\n\t}\n\tlocal_paca->dtl_ridx = i;\n\tlocal_paca->dtl_curr = dtl;\n\treturn stolen;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dtl_consumer",
          "args": [
            "dtl",
            "i"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "vpa->dtl_idx"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "vpa->dtl_idx"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "barrier",
          "args": [],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "stf_barrier_debugfs_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/security.c",
          "lines": "422-427",
          "snippet": "static __init int stf_barrier_debugfs_init(void)\n{\n\tdebugfs_create_file_unsafe(\"stf_barrier\", 0600, powerpc_debugfs_root,\n\t\t\t\t   NULL, &fops_stf_barrier);\n\treturn 0;\n}",
          "includes": [
            "#include <asm/inst.h>",
            "#include <asm/setup.h>",
            "#include <asm/security_features.h>",
            "#include <asm/debugfs.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/prctl.h>",
            "#include <linux/nospec.h>",
            "#include <linux/device.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/inst.h>\n#include <asm/setup.h>\n#include <asm/security_features.h>\n#include <asm/debugfs.h>\n#include <asm/code-patching.h>\n#include <asm/asm-prototypes.h>\n#include <linux/seq_buf.h>\n#include <linux/prctl.h>\n#include <linux/nospec.h>\n#include <linux/device.h>\n#include <linux/kernel.h>\n#include <linux/cpu.h>\n\nstatic __init int stf_barrier_debugfs_init(void)\n{\n\tdebugfs_create_file_unsafe(\"stf_barrier\", 0600, powerpc_debugfs_root,\n\t\t\t\t   NULL, &fops_stf_barrier);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "dtl->ready_to_enqueue_time"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "dtl->enqueue_to_dispatch_time"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "dtl->timebase"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "vpa->dtl_idx"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "vpa->dtl_idx"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 scan_dispatch_log(u64 stop_tb)\n{\n\tu64 i = local_paca->dtl_ridx;\n\tstruct dtl_entry *dtl = local_paca->dtl_curr;\n\tstruct dtl_entry *dtl_end = local_paca->dispatch_log_end;\n\tstruct lppaca *vpa = local_paca->lppaca_ptr;\n\tu64 tb_delta;\n\tu64 stolen = 0;\n\tu64 dtb;\n\n\tif (!dtl)\n\t\treturn 0;\n\n\tif (i == be64_to_cpu(vpa->dtl_idx))\n\t\treturn 0;\n\twhile (i < be64_to_cpu(vpa->dtl_idx)) {\n\t\tdtb = be64_to_cpu(dtl->timebase);\n\t\ttb_delta = be32_to_cpu(dtl->enqueue_to_dispatch_time) +\n\t\t\tbe32_to_cpu(dtl->ready_to_enqueue_time);\n\t\tbarrier();\n\t\tif (i + N_DISPATCH_LOG < be64_to_cpu(vpa->dtl_idx)) {\n\t\t\t/* buffer has overflowed */\n\t\t\ti = be64_to_cpu(vpa->dtl_idx) - N_DISPATCH_LOG;\n\t\t\tdtl = local_paca->dispatch_log + (i % N_DISPATCH_LOG);\n\t\t\tcontinue;\n\t\t}\n\t\tif (dtb > stop_tb)\n\t\t\tbreak;\n\t\tif (dtl_consumer)\n\t\t\tdtl_consumer(dtl, i);\n\t\tstolen += tb_delta;\n\t\t++i;\n\t\t++dtl;\n\t\tif (dtl == dtl_end)\n\t\t\tdtl = local_paca->dispatch_log;\n\t}\n\tlocal_paca->dtl_ridx = i;\n\tlocal_paca->dtl_curr = dtl;\n\treturn stolen;\n}"
  },
  {
    "function_name": "read_spurr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "175-182",
    "snippet": "static inline unsigned long read_spurr(unsigned long tb)\n{\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\treturn mfspr(SPRN_SPURR);\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\treturn mfspr(SPRN_PURR);\n\treturn tb;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PURR"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_PURR"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_SPURR"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SPURR"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline unsigned long read_spurr(unsigned long tb)\n{\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\treturn mfspr(SPRN_SPURR);\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\treturn mfspr(SPRN_PURR);\n\treturn tb;\n}"
  },
  {
    "function_name": "calc_cputime_factors",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
    "lines": "163-169",
    "snippet": "static void calc_cputime_factors(void)\n{\n\tstruct div_result res;\n\n\tdiv128_by_32(1000000, 0, tb_ticks_per_sec, &res);\n\t__cputime_usec_factor = res.result_low;\n}",
    "includes": [
      "#include <asm/dtl.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/processor.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/suspend.h>",
      "#include <linux/of_clk.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long tb_ticks_per_sec;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "div128_by_32",
          "args": [
            "1000000",
            "0",
            "tb_ticks_per_sec",
            "&res"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "div128_by_32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "1143-1170",
          "snippet": "void div128_by_32(u64 dividend_high, u64 dividend_low,\n\t\t  unsigned divisor, struct div_result *dr)\n{\n\tunsigned long a, b, c, d;\n\tunsigned long w, x, y, z;\n\tu64 ra, rb, rc;\n\n\ta = dividend_high >> 32;\n\tb = dividend_high & 0xffffffff;\n\tc = dividend_low >> 32;\n\td = dividend_low & 0xffffffff;\n\n\tw = a / divisor;\n\tra = ((u64)(a - (w * divisor)) << 32) + b;\n\n\trb = ((u64) do_div(ra, divisor) << 32) + c;\n\tx = ra;\n\n\trc = ((u64) do_div(rb, divisor) << 32) + d;\n\ty = rb;\n\n\tdo_div(rc, divisor);\n\tz = rc;\n\n\tdr->result_high = ((u64)w << 32) + x;\n\tdr->result_low  = ((u64)y << 32) + z;\n\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid div128_by_32(u64 dividend_high, u64 dividend_low,\n\t\t  unsigned divisor, struct div_result *dr)\n{\n\tunsigned long a, b, c, d;\n\tunsigned long w, x, y, z;\n\tu64 ra, rb, rc;\n\n\ta = dividend_high >> 32;\n\tb = dividend_high & 0xffffffff;\n\tc = dividend_low >> 32;\n\td = dividend_low & 0xffffffff;\n\n\tw = a / divisor;\n\tra = ((u64)(a - (w * divisor)) << 32) + b;\n\n\trb = ((u64) do_div(ra, divisor) << 32) + c;\n\tx = ra;\n\n\trc = ((u64) do_div(rb, divisor) << 32) + d;\n\ty = rb;\n\n\tdo_div(rc, divisor);\n\tz = rc;\n\n\tdr->result_high = ((u64)w << 32) + x;\n\tdr->result_low  = ((u64)y << 32) + z;\n\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long tb_ticks_per_sec;\n\nstatic void calc_cputime_factors(void)\n{\n\tstruct div_result res;\n\n\tdiv128_by_32(1000000, 0, tb_ticks_per_sec, &res);\n\t__cputime_usec_factor = res.result_low;\n}"
  }
]