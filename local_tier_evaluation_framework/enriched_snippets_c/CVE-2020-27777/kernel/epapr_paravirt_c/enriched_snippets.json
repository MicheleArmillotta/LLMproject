[
  {
    "function_name": "epapr_idle_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/epapr_paravirt.c",
    "lines": "64-72",
    "snippet": "static int __init epapr_idle_init(void)\n{\n#if !defined(CONFIG_64BIT) || defined(CONFIG_PPC_BOOK3E_64)\n\tif (epapr_has_idle)\n\t\tppc_md.power_save = epapr_ev_idle;\n#endif\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/inst.h>",
      "#include <asm/machdep.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/cacheflush.h>",
      "#include <asm/epapr_hcalls.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/inst.h>\n#include <asm/machdep.h>\n#include <asm/code-patching.h>\n#include <asm/cacheflush.h>\n#include <asm/epapr_hcalls.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n\nstatic int __init epapr_idle_init(void)\n{\n#if !defined(CONFIG_64BIT) || defined(CONFIG_PPC_BOOK3E_64)\n\tif (epapr_has_idle)\n\t\tppc_md.power_save = epapr_ev_idle;\n#endif\n\n\treturn 0;\n}"
  },
  {
    "function_name": "epapr_paravirt_early_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/epapr_paravirt.c",
    "lines": "57-62",
    "snippet": "int __init epapr_paravirt_early_init(void)\n{\n\tof_scan_flat_dt(early_init_dt_scan_epapr, NULL);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/inst.h>",
      "#include <asm/machdep.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/cacheflush.h>",
      "#include <asm/epapr_hcalls.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_scan_flat_dt",
          "args": [
            "early_init_dt_scan_epapr",
            "NULL"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/inst.h>\n#include <asm/machdep.h>\n#include <asm/code-patching.h>\n#include <asm/cacheflush.h>\n#include <asm/epapr_hcalls.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n\nint __init epapr_paravirt_early_init(void)\n{\n\tof_scan_flat_dt(early_init_dt_scan_epapr, NULL);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "early_init_dt_scan_epapr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/epapr_paravirt.c",
    "lines": "24-55",
    "snippet": "static int __init early_init_dt_scan_epapr(unsigned long node,\n\t\t\t\t\t   const char *uname,\n\t\t\t\t\t   int depth, void *data)\n{\n\tconst u32 *insts;\n\tint len;\n\tint i;\n\n\tinsts = of_get_flat_dt_prop(node, \"hcall-instructions\", &len);\n\tif (!insts)\n\t\treturn 0;\n\n\tif (len % 4 || len > (4 * 4))\n\t\treturn -1;\n\n\tfor (i = 0; i < (len / 4); i++) {\n\t\tstruct ppc_inst inst = ppc_inst(be32_to_cpu(insts[i]));\n\t\tpatch_instruction((struct ppc_inst *)(epapr_hypercall_start + i), inst);\n#if !defined(CONFIG_64BIT) || defined(CONFIG_PPC_BOOK3E_64)\n\t\tpatch_instruction((struct ppc_inst *)(epapr_ev_idle_start + i), inst);\n#endif\n\t}\n\n#if !defined(CONFIG_64BIT) || defined(CONFIG_PPC_BOOK3E_64)\n\tif (of_get_flat_dt_prop(node, \"has-idle\", NULL))\n\t\tepapr_has_idle = true;\n#endif\n\n\tepapr_paravirt_enabled = true;\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/inst.h>",
      "#include <asm/machdep.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/cacheflush.h>",
      "#include <asm/epapr_hcalls.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool epapr_paravirt_enabled;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"has-idle\"",
            "NULL"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "patch_instruction",
          "args": [
            "(struct ppc_inst *)(epapr_ev_idle_start + i)",
            "inst"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "patch_instruction",
          "args": [
            "(struct ppc_inst *)(epapr_hypercall_start + i)",
            "inst"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_inst",
          "args": [
            "be32_to_cpu(insts[i])"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "insts[i]"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"hcall-instructions\"",
            "&len"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/inst.h>\n#include <asm/machdep.h>\n#include <asm/code-patching.h>\n#include <asm/cacheflush.h>\n#include <asm/epapr_hcalls.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n\nbool epapr_paravirt_enabled;\n\nstatic int __init early_init_dt_scan_epapr(unsigned long node,\n\t\t\t\t\t   const char *uname,\n\t\t\t\t\t   int depth, void *data)\n{\n\tconst u32 *insts;\n\tint len;\n\tint i;\n\n\tinsts = of_get_flat_dt_prop(node, \"hcall-instructions\", &len);\n\tif (!insts)\n\t\treturn 0;\n\n\tif (len % 4 || len > (4 * 4))\n\t\treturn -1;\n\n\tfor (i = 0; i < (len / 4); i++) {\n\t\tstruct ppc_inst inst = ppc_inst(be32_to_cpu(insts[i]));\n\t\tpatch_instruction((struct ppc_inst *)(epapr_hypercall_start + i), inst);\n#if !defined(CONFIG_64BIT) || defined(CONFIG_PPC_BOOK3E_64)\n\t\tpatch_instruction((struct ppc_inst *)(epapr_ev_idle_start + i), inst);\n#endif\n\t}\n\n#if !defined(CONFIG_64BIT) || defined(CONFIG_PPC_BOOK3E_64)\n\tif (of_get_flat_dt_prop(node, \"has-idle\", NULL))\n\t\tepapr_has_idle = true;\n#endif\n\n\tepapr_paravirt_enabled = true;\n\n\treturn 1;\n}"
  }
]