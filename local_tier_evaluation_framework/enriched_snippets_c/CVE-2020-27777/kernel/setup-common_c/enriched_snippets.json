[
  {
    "function_name": "setup_arch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "856-966",
    "snippet": "void __init setup_arch(char **cmdline_p)\n{\n\tkasan_init();\n\n\t*cmdline_p = boot_command_line;\n\n\t/* Set a half-reasonable default so udelay does something sensible */\n\tloops_per_jiffy = 500000000 / HZ;\n\n\t/* Unflatten the device-tree passed by prom_init or kexec */\n\tunflatten_device_tree();\n\n\t/*\n\t * Initialize cache line/block info from device-tree (on ppc64) or\n\t * just cputable (on ppc32).\n\t */\n\tinitialize_cache_info();\n\n\t/* Initialize RTAS if available. */\n\trtas_initialize();\n\n\t/* Check if we have an initrd provided via the device-tree. */\n\tcheck_for_initrd();\n\n\t/* Probe the machine type, establish ppc_md. */\n\tprobe_machine();\n\n\t/* Setup panic notifier if requested by the platform. */\n\tsetup_panic();\n\n\t/*\n\t * Configure ppc_md.power_save (ppc32 only, 64-bit machines do\n\t * it from their respective probe() function.\n\t */\n\tsetup_power_save();\n\n\t/* Discover standard serial ports. */\n\tfind_legacy_serial_ports();\n\n\t/* Register early console with the printk subsystem. */\n\tregister_early_udbg_console();\n\n\t/* Setup the various CPU maps based on the device-tree. */\n\tsmp_setup_cpu_maps();\n\n\t/* Initialize xmon. */\n\txmon_setup();\n\n\t/* Check the SMT related command line arguments (ppc64). */\n\tcheck_smt_enabled();\n\n\t/* Parse memory topology */\n\tmem_topology_setup();\n\n\t/*\n\t * Release secondary cpus out of their spinloops at 0x60 now that\n\t * we can map physical -> logical CPU ids.\n\t *\n\t * Freescale Book3e parts spin in a loop provided by firmware,\n\t * so smp_release_cpus() does nothing for them.\n\t */\n#ifdef CONFIG_SMP\n\tsmp_setup_pacas();\n\n\t/* On BookE, setup per-core TLB data structures. */\n\tsetup_tlb_core_data();\n\n\tsmp_release_cpus();\n#endif\n\n\t/* Print various info about the machine that has been gathered so far. */\n\tprint_system_info();\n\n\t/* Reserve large chunks of memory for use by CMA for KVM. */\n\tkvm_cma_reserve();\n\n\t/*  Reserve large chunks of memory for us by CMA for hugetlb */\n\tgigantic_hugetlb_cma_reserve();\n\n\tklp_init_thread_info(&init_task);\n\n\tinit_mm.start_code = (unsigned long)_stext;\n\tinit_mm.end_code = (unsigned long) _etext;\n\tinit_mm.end_data = (unsigned long) _edata;\n\tinit_mm.brk = klimit;\n\n\tmm_iommu_init(&init_mm);\n\tirqstack_early_init();\n\texc_lvl_early_init();\n\temergency_stack_init();\n\n\tinitmem_init();\n\n\tearly_memtest(min_low_pfn << PAGE_SHIFT, max_low_pfn << PAGE_SHIFT);\n\n\tif (ppc_md.setup_arch)\n\t\tppc_md.setup_arch();\n\n\tsetup_barrier_nospec();\n\tsetup_spectre_v2();\n\n\tpaging_init();\n\n\t/* Initialize the MMU context management stuff. */\n\tmmu_context_init();\n\n\t/* Interrupt code needs to be 64K-aligned. */\n\tif (IS_ENABLED(CONFIG_PPC64) && (unsigned long)_stext & 0xffff)\n\t\tpanic(\"Kernelbase not 64K-aligned (0x%lx)!\\n\",\n\t\t      (unsigned long)_stext);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;",
      "unsigned long klimit = (unsigned long) _end;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"Kernelbase not 64K-aligned (0x%lx)!\\n\"",
            "(unsigned long)_stext"
          ],
          "line": 964
        },
        "resolved": true,
        "details": {
          "function_name": "watchdog_smp_panic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/watchdog.c",
          "lines": "147-199",
          "snippet": "static void watchdog_smp_panic(int cpu, u64 tb)\n{\n\tunsigned long flags;\n\tint c;\n\n\twd_smp_lock(&flags);\n\t/* Double check some things under lock */\n\tif ((s64)(tb - wd_smp_last_reset_tb) < (s64)wd_smp_panic_timeout_tb)\n\t\tgoto out;\n\tif (cpumask_test_cpu(cpu, &wd_smp_cpus_pending))\n\t\tgoto out;\n\tif (cpumask_weight(&wd_smp_cpus_pending) == 0)\n\t\tgoto out;\n\n\tpr_emerg(\"CPU %d detected hard LOCKUP on other CPUs %*pbl\\n\",\n\t\t cpu, cpumask_pr_args(&wd_smp_cpus_pending));\n\tpr_emerg(\"CPU %d TB:%lld, last SMP heartbeat TB:%lld (%lldms ago)\\n\",\n\t\t cpu, tb, wd_smp_last_reset_tb,\n\t\t tb_to_ns(tb - wd_smp_last_reset_tb) / 1000000);\n\n\tif (!sysctl_hardlockup_all_cpu_backtrace) {\n\t\t/*\n\t\t * Try to trigger the stuck CPUs, unless we are going to\n\t\t * get a backtrace on all of them anyway.\n\t\t */\n\t\tfor_each_cpu(c, &wd_smp_cpus_pending) {\n\t\t\tif (c == cpu)\n\t\t\t\tcontinue;\n\t\t\tsmp_send_nmi_ipi(c, wd_lockup_ipi, 1000000);\n\t\t}\n\t}\n\n\t/* Take the stuck CPUs out of the watch group */\n\tset_cpumask_stuck(&wd_smp_cpus_pending, tb);\n\n\twd_smp_unlock(&flags);\n\n\tprintk_safe_flush();\n\t/*\n\t * printk_safe_flush() seems to require another print\n\t * before anything actually goes out to console.\n\t */\n\tif (sysctl_hardlockup_all_cpu_backtrace)\n\t\ttrigger_allbutself_cpu_backtrace();\n\n\tif (hardlockup_panic)\n\t\tnmi_panic(NULL, \"Hard LOCKUP\");\n\n\treturn;\n\nout:\n\twd_smp_unlock(&flags);\n}",
          "includes": [
            "#include <asm/paca.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/slab.h>",
            "#include <linux/reboot.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/export.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/init.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u64 wd_smp_panic_timeout_tb",
            "static cpumask_t wd_smp_cpus_pending;",
            "static u64 wd_smp_last_reset_tb;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/paca.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/sched/debug.h>\n#include <linux/kdebug.h>\n#include <linux/slab.h>\n#include <linux/reboot.h>\n#include <linux/hardirq.h>\n#include <linux/kprobes.h>\n#include <linux/export.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/init.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n\nstatic u64 wd_smp_panic_timeout_tb;\nstatic cpumask_t wd_smp_cpus_pending;\nstatic u64 wd_smp_last_reset_tb;\n\nstatic void watchdog_smp_panic(int cpu, u64 tb)\n{\n\tunsigned long flags;\n\tint c;\n\n\twd_smp_lock(&flags);\n\t/* Double check some things under lock */\n\tif ((s64)(tb - wd_smp_last_reset_tb) < (s64)wd_smp_panic_timeout_tb)\n\t\tgoto out;\n\tif (cpumask_test_cpu(cpu, &wd_smp_cpus_pending))\n\t\tgoto out;\n\tif (cpumask_weight(&wd_smp_cpus_pending) == 0)\n\t\tgoto out;\n\n\tpr_emerg(\"CPU %d detected hard LOCKUP on other CPUs %*pbl\\n\",\n\t\t cpu, cpumask_pr_args(&wd_smp_cpus_pending));\n\tpr_emerg(\"CPU %d TB:%lld, last SMP heartbeat TB:%lld (%lldms ago)\\n\",\n\t\t cpu, tb, wd_smp_last_reset_tb,\n\t\t tb_to_ns(tb - wd_smp_last_reset_tb) / 1000000);\n\n\tif (!sysctl_hardlockup_all_cpu_backtrace) {\n\t\t/*\n\t\t * Try to trigger the stuck CPUs, unless we are going to\n\t\t * get a backtrace on all of them anyway.\n\t\t */\n\t\tfor_each_cpu(c, &wd_smp_cpus_pending) {\n\t\t\tif (c == cpu)\n\t\t\t\tcontinue;\n\t\t\tsmp_send_nmi_ipi(c, wd_lockup_ipi, 1000000);\n\t\t}\n\t}\n\n\t/* Take the stuck CPUs out of the watch group */\n\tset_cpumask_stuck(&wd_smp_cpus_pending, tb);\n\n\twd_smp_unlock(&flags);\n\n\tprintk_safe_flush();\n\t/*\n\t * printk_safe_flush() seems to require another print\n\t * before anything actually goes out to console.\n\t */\n\tif (sysctl_hardlockup_all_cpu_backtrace)\n\t\ttrigger_allbutself_cpu_backtrace();\n\n\tif (hardlockup_panic)\n\t\tnmi_panic(NULL, \"Hard LOCKUP\");\n\n\treturn;\n\nout:\n\twd_smp_unlock(&flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC64"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mmu_context_init",
          "args": [],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "paging_init",
          "args": [],
          "line": 957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup_spectre_v2",
          "args": [],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "setup_spectre_v2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/security.c",
          "lines": "133-139",
          "snippet": "void setup_spectre_v2(void)\n{\n\tif (no_spectrev2 || cpu_mitigations_off())\n\t\tdo_btb_flush_fixups();\n\telse\n\t\tbtb_flush_enabled = true;\n}",
          "includes": [
            "#include <asm/inst.h>",
            "#include <asm/setup.h>",
            "#include <asm/security_features.h>",
            "#include <asm/debugfs.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/prctl.h>",
            "#include <linux/nospec.h>",
            "#include <linux/device.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool btb_flush_enabled;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/inst.h>\n#include <asm/setup.h>\n#include <asm/security_features.h>\n#include <asm/debugfs.h>\n#include <asm/code-patching.h>\n#include <asm/asm-prototypes.h>\n#include <linux/seq_buf.h>\n#include <linux/prctl.h>\n#include <linux/nospec.h>\n#include <linux/device.h>\n#include <linux/kernel.h>\n#include <linux/cpu.h>\n\nstatic bool btb_flush_enabled;\n\nvoid setup_spectre_v2(void)\n{\n\tif (no_spectrev2 || cpu_mitigations_off())\n\t\tdo_btb_flush_fixups();\n\telse\n\t\tbtb_flush_enabled = true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup_barrier_nospec",
          "args": [],
          "line": 954
        },
        "resolved": true,
        "details": {
          "function_name": "setup_barrier_nospec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/security.c",
          "lines": "45-66",
          "snippet": "void setup_barrier_nospec(void)\n{\n\tbool enable;\n\n\t/*\n\t * It would make sense to check SEC_FTR_SPEC_BAR_ORI31 below as well.\n\t * But there's a good reason not to. The two flags we check below are\n\t * both are enabled by default in the kernel, so if the hcall is not\n\t * functional they will be enabled.\n\t * On a system where the host firmware has been updated (so the ori\n\t * functions as a barrier), but on which the hypervisor (KVM/Qemu) has\n\t * not been updated, we would like to enable the barrier. Dropping the\n\t * check for SEC_FTR_SPEC_BAR_ORI31 achieves that. The only downside is\n\t * we potentially enable the barrier on systems where the host firmware\n\t * is not updated, but that's harmless as it's a no-op.\n\t */\n\tenable = security_ftr_enabled(SEC_FTR_FAVOUR_SECURITY) &&\n\t\t security_ftr_enabled(SEC_FTR_BNDS_CHK_SPEC_BAR);\n\n\tif (!no_nospec && !cpu_mitigations_off())\n\t\tenable_barrier_nospec(enable);\n}",
          "includes": [
            "#include <asm/inst.h>",
            "#include <asm/setup.h>",
            "#include <asm/security_features.h>",
            "#include <asm/debugfs.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/prctl.h>",
            "#include <linux/nospec.h>",
            "#include <linux/device.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool no_nospec;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/inst.h>\n#include <asm/setup.h>\n#include <asm/security_features.h>\n#include <asm/debugfs.h>\n#include <asm/code-patching.h>\n#include <asm/asm-prototypes.h>\n#include <linux/seq_buf.h>\n#include <linux/prctl.h>\n#include <linux/nospec.h>\n#include <linux/device.h>\n#include <linux/kernel.h>\n#include <linux/cpu.h>\n\nstatic bool no_nospec;\n\nvoid setup_barrier_nospec(void)\n{\n\tbool enable;\n\n\t/*\n\t * It would make sense to check SEC_FTR_SPEC_BAR_ORI31 below as well.\n\t * But there's a good reason not to. The two flags we check below are\n\t * both are enabled by default in the kernel, so if the hcall is not\n\t * functional they will be enabled.\n\t * On a system where the host firmware has been updated (so the ori\n\t * functions as a barrier), but on which the hypervisor (KVM/Qemu) has\n\t * not been updated, we would like to enable the barrier. Dropping the\n\t * check for SEC_FTR_SPEC_BAR_ORI31 achieves that. The only downside is\n\t * we potentially enable the barrier on systems where the host firmware\n\t * is not updated, but that's harmless as it's a no-op.\n\t */\n\tenable = security_ftr_enabled(SEC_FTR_FAVOUR_SECURITY) &&\n\t\t security_ftr_enabled(SEC_FTR_BNDS_CHK_SPEC_BAR);\n\n\tif (!no_nospec && !cpu_mitigations_off())\n\t\tenable_barrier_nospec(enable);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppc_md.setup_arch",
          "args": [],
          "line": 952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_memtest",
          "args": [
            "min_low_pfn << PAGE_SHIFT",
            "max_low_pfn << PAGE_SHIFT"
          ],
          "line": 949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initmem_init",
          "args": [],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "emergency_stack_init",
          "args": [],
          "line": 945
        },
        "resolved": true,
        "details": {
          "function_name": "emergency_stack_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "716-757",
          "snippet": "void __init emergency_stack_init(void)\n{\n\tu64 limit, mce_limit;\n\tunsigned int i;\n\n\t/*\n\t * Emergency stacks must be under 256MB, we cannot afford to take\n\t * SLB misses on them. The ABI also requires them to be 128-byte\n\t * aligned.\n\t *\n\t * Since we use these as temporary stacks during secondary CPU\n\t * bringup, machine check, system reset, and HMI, we need to get\n\t * at them in real mode. This means they must also be within the RMO\n\t * region.\n\t *\n\t * The IRQ stacks allocated elsewhere in this file are zeroed and\n\t * initialized in kernel/irq.c. These are initialized here in order\n\t * to have emergency stacks available as early as possible.\n\t */\n\tlimit = mce_limit = min(ppc64_bolted_size(), ppc64_rma_size);\n\n\t/*\n\t * Machine check on pseries calls rtas, but can't use the static\n\t * rtas_args due to a machine check hitting while the lock is held.\n\t * rtas args have to be under 4GB, so the machine check stack is\n\t * limited to 4GB so args can be put on stack.\n\t */\n\tif (firmware_has_feature(FW_FEATURE_LPAR) && mce_limit > SZ_4G)\n\t\tmce_limit = SZ_4G;\n\n\tfor_each_possible_cpu(i) {\n\t\tpaca_ptrs[i]->emergency_sp = alloc_stack(limit, i) + THREAD_SIZE;\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\t\t/* emergency stack for NMI exception handling. */\n\t\tpaca_ptrs[i]->nmi_emergency_sp = alloc_stack(limit, i) + THREAD_SIZE;\n\n\t\t/* emergency stack for machine check exception handling. */\n\t\tpaca_ptrs[i]->mc_emergency_sp = alloc_stack(mce_limit, i) + THREAD_SIZE;\n#endif\n\t}\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nvoid __init emergency_stack_init(void)\n{\n\tu64 limit, mce_limit;\n\tunsigned int i;\n\n\t/*\n\t * Emergency stacks must be under 256MB, we cannot afford to take\n\t * SLB misses on them. The ABI also requires them to be 128-byte\n\t * aligned.\n\t *\n\t * Since we use these as temporary stacks during secondary CPU\n\t * bringup, machine check, system reset, and HMI, we need to get\n\t * at them in real mode. This means they must also be within the RMO\n\t * region.\n\t *\n\t * The IRQ stacks allocated elsewhere in this file are zeroed and\n\t * initialized in kernel/irq.c. These are initialized here in order\n\t * to have emergency stacks available as early as possible.\n\t */\n\tlimit = mce_limit = min(ppc64_bolted_size(), ppc64_rma_size);\n\n\t/*\n\t * Machine check on pseries calls rtas, but can't use the static\n\t * rtas_args due to a machine check hitting while the lock is held.\n\t * rtas args have to be under 4GB, so the machine check stack is\n\t * limited to 4GB so args can be put on stack.\n\t */\n\tif (firmware_has_feature(FW_FEATURE_LPAR) && mce_limit > SZ_4G)\n\t\tmce_limit = SZ_4G;\n\n\tfor_each_possible_cpu(i) {\n\t\tpaca_ptrs[i]->emergency_sp = alloc_stack(limit, i) + THREAD_SIZE;\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\t\t/* emergency stack for NMI exception handling. */\n\t\tpaca_ptrs[i]->nmi_emergency_sp = alloc_stack(limit, i) + THREAD_SIZE;\n\n\t\t/* emergency stack for machine check exception handling. */\n\t\tpaca_ptrs[i]->mc_emergency_sp = alloc_stack(mce_limit, i) + THREAD_SIZE;\n#endif\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "exc_lvl_early_init",
          "args": [],
          "line": 944
        },
        "resolved": true,
        "details": {
          "function_name": "exc_lvl_early_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "686-708",
          "snippet": "void __init exc_lvl_early_init(void)\n{\n\tunsigned int i;\n\n\tfor_each_possible_cpu(i) {\n\t\tvoid *sp;\n\n\t\tsp = alloc_stack(ULONG_MAX, i);\n\t\tcritirq_ctx[i] = sp;\n\t\tpaca_ptrs[i]->crit_kstack = sp + THREAD_SIZE;\n\n\t\tsp = alloc_stack(ULONG_MAX, i);\n\t\tdbgirq_ctx[i] = sp;\n\t\tpaca_ptrs[i]->dbg_kstack = sp + THREAD_SIZE;\n\n\t\tsp = alloc_stack(ULONG_MAX, i);\n\t\tmcheckirq_ctx[i] = sp;\n\t\tpaca_ptrs[i]->mc_kstack = sp + THREAD_SIZE;\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DEBUG_LVL_EXC))\n\t\tpatch_exception(0x040, exc_debug_debug_book3e);\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nvoid __init exc_lvl_early_init(void)\n{\n\tunsigned int i;\n\n\tfor_each_possible_cpu(i) {\n\t\tvoid *sp;\n\n\t\tsp = alloc_stack(ULONG_MAX, i);\n\t\tcritirq_ctx[i] = sp;\n\t\tpaca_ptrs[i]->crit_kstack = sp + THREAD_SIZE;\n\n\t\tsp = alloc_stack(ULONG_MAX, i);\n\t\tdbgirq_ctx[i] = sp;\n\t\tpaca_ptrs[i]->dbg_kstack = sp + THREAD_SIZE;\n\n\t\tsp = alloc_stack(ULONG_MAX, i);\n\t\tmcheckirq_ctx[i] = sp;\n\t\tpaca_ptrs[i]->mc_kstack = sp + THREAD_SIZE;\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DEBUG_LVL_EXC))\n\t\tpatch_exception(0x040, exc_debug_debug_book3e);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irqstack_early_init",
          "args": [],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "irqstack_early_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "669-683",
          "snippet": "void __init irqstack_early_init(void)\n{\n\tu64 limit = ppc64_bolted_size();\n\tunsigned int i;\n\n\t/*\n\t * Interrupt stacks must be in the first segment since we\n\t * cannot afford to take SLB misses on them. They are not\n\t * accessed in realmode.\n\t */\n\tfor_each_possible_cpu(i) {\n\t\tsoftirq_ctx[i] = alloc_stack(limit, i);\n\t\thardirq_ctx[i] = alloc_stack(limit, i);\n\t}\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nvoid __init irqstack_early_init(void)\n{\n\tu64 limit = ppc64_bolted_size();\n\tunsigned int i;\n\n\t/*\n\t * Interrupt stacks must be in the first segment since we\n\t * cannot afford to take SLB misses on them. They are not\n\t * accessed in realmode.\n\t */\n\tfor_each_possible_cpu(i) {\n\t\tsoftirq_ctx[i] = alloc_stack(limit, i);\n\t\thardirq_ctx[i] = alloc_stack(limit, i);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mm_iommu_init",
          "args": [
            "&init_mm"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "klp_init_thread_info",
          "args": [
            "&init_task"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gigantic_hugetlb_cma_reserve",
          "args": [],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvm_cma_reserve",
          "args": [],
          "line": 930
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_cma_reserve",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup.h",
          "lines": "64-64",
          "snippet": "static inline void kvm_cma_reserve(void) { }",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void kvm_cma_reserve(void) { }"
        }
      },
      {
        "call_info": {
          "callee": "print_system_info",
          "args": [],
          "line": 927
        },
        "resolved": true,
        "details": {
          "function_name": "print_system_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "797-833",
          "snippet": "static __init void print_system_info(void)\n{\n\tpr_info(\"-----------------------------------------------------\\n\");\n\tpr_info(\"phys_mem_size     = 0x%llx\\n\",\n\t\t(unsigned long long)memblock_phys_mem_size());\n\n\tpr_info(\"dcache_bsize      = 0x%x\\n\", dcache_bsize);\n\tpr_info(\"icache_bsize      = 0x%x\\n\", icache_bsize);\n\tif (ucache_bsize != 0)\n\t\tpr_info(\"ucache_bsize      = 0x%x\\n\", ucache_bsize);\n\n\tpr_info(\"cpu_features      = 0x%016lx\\n\", cur_cpu_spec->cpu_features);\n\tpr_info(\"  possible        = 0x%016lx\\n\",\n\t\t(unsigned long)CPU_FTRS_POSSIBLE);\n\tpr_info(\"  always          = 0x%016lx\\n\",\n\t\t(unsigned long)CPU_FTRS_ALWAYS);\n\tpr_info(\"cpu_user_features = 0x%08x 0x%08x\\n\",\n\t\tcur_cpu_spec->cpu_user_features,\n\t\tcur_cpu_spec->cpu_user_features2);\n\tpr_info(\"mmu_features      = 0x%08x\\n\", cur_cpu_spec->mmu_features);\n#ifdef CONFIG_PPC64\n\tpr_info(\"firmware_features = 0x%016lx\\n\", powerpc_firmware_features);\n#ifdef CONFIG_PPC_BOOK3S\n\tpr_info(\"vmalloc start     = 0x%lx\\n\", KERN_VIRT_START);\n\tpr_info(\"IO start          = 0x%lx\\n\", KERN_IO_START);\n\tpr_info(\"vmemmap start     = 0x%lx\\n\", (unsigned long)vmemmap);\n#endif\n#endif\n\n\tif (!early_radix_enabled())\n\t\tprint_system_hash_info();\n\n\tif (PHYSICAL_START > 0)\n\t\tpr_info(\"physical_start    = 0x%llx\\n\",\n\t\t       (unsigned long long)PHYSICAL_START);\n\tpr_info(\"-----------------------------------------------------\\n\");\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int dcache_bsize;",
            "int icache_bsize;",
            "int ucache_bsize;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nint dcache_bsize;\nint icache_bsize;\nint ucache_bsize;\n\nstatic __init void print_system_info(void)\n{\n\tpr_info(\"-----------------------------------------------------\\n\");\n\tpr_info(\"phys_mem_size     = 0x%llx\\n\",\n\t\t(unsigned long long)memblock_phys_mem_size());\n\n\tpr_info(\"dcache_bsize      = 0x%x\\n\", dcache_bsize);\n\tpr_info(\"icache_bsize      = 0x%x\\n\", icache_bsize);\n\tif (ucache_bsize != 0)\n\t\tpr_info(\"ucache_bsize      = 0x%x\\n\", ucache_bsize);\n\n\tpr_info(\"cpu_features      = 0x%016lx\\n\", cur_cpu_spec->cpu_features);\n\tpr_info(\"  possible        = 0x%016lx\\n\",\n\t\t(unsigned long)CPU_FTRS_POSSIBLE);\n\tpr_info(\"  always          = 0x%016lx\\n\",\n\t\t(unsigned long)CPU_FTRS_ALWAYS);\n\tpr_info(\"cpu_user_features = 0x%08x 0x%08x\\n\",\n\t\tcur_cpu_spec->cpu_user_features,\n\t\tcur_cpu_spec->cpu_user_features2);\n\tpr_info(\"mmu_features      = 0x%08x\\n\", cur_cpu_spec->mmu_features);\n#ifdef CONFIG_PPC64\n\tpr_info(\"firmware_features = 0x%016lx\\n\", powerpc_firmware_features);\n#ifdef CONFIG_PPC_BOOK3S\n\tpr_info(\"vmalloc start     = 0x%lx\\n\", KERN_VIRT_START);\n\tpr_info(\"IO start          = 0x%lx\\n\", KERN_IO_START);\n\tpr_info(\"vmemmap start     = 0x%lx\\n\", (unsigned long)vmemmap);\n#endif\n#endif\n\n\tif (!early_radix_enabled())\n\t\tprint_system_hash_info();\n\n\tif (PHYSICAL_START > 0)\n\t\tpr_info(\"physical_start    = 0x%llx\\n\",\n\t\t       (unsigned long long)PHYSICAL_START);\n\tpr_info(\"-----------------------------------------------------\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_release_cpus",
          "args": [],
          "line": 923
        },
        "resolved": true,
        "details": {
          "function_name": "smp_release_cpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "450-477",
          "snippet": "void smp_release_cpus(void)\n{\n\tunsigned long *ptr;\n\tint i;\n\n\tif (!use_spinloop())\n\t\treturn;\n\n\t/* All secondary cpus are spinning on a common spinloop, release them\n\t * all now so they can start to spin on their individual paca\n\t * spinloops. For non SMP kernels, the secondary cpus never get out\n\t * of the common spinloop.\n\t */\n\n\tptr  = (unsigned long *)((unsigned long)&__secondary_hold_spinloop\n\t\t\t- PHYSICAL_START);\n\t*ptr = ppc_function_entry(generic_secondary_smp_init);\n\n\t/* And wait a bit for them to catch up */\n\tfor (i = 0; i < 100000; i++) {\n\t\tmb();\n\t\tHMT_low();\n\t\tif (spinning_secondaries == 0)\n\t\t\tbreak;\n\t\tudelay(1);\n\t}\n\tpr_debug(\"spinning_secondaries = %d\\n\", spinning_secondaries);\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int spinning_secondaries;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nint spinning_secondaries;\n\nvoid smp_release_cpus(void)\n{\n\tunsigned long *ptr;\n\tint i;\n\n\tif (!use_spinloop())\n\t\treturn;\n\n\t/* All secondary cpus are spinning on a common spinloop, release them\n\t * all now so they can start to spin on their individual paca\n\t * spinloops. For non SMP kernels, the secondary cpus never get out\n\t * of the common spinloop.\n\t */\n\n\tptr  = (unsigned long *)((unsigned long)&__secondary_hold_spinloop\n\t\t\t- PHYSICAL_START);\n\t*ptr = ppc_function_entry(generic_secondary_smp_init);\n\n\t/* And wait a bit for them to catch up */\n\tfor (i = 0; i < 100000; i++) {\n\t\tmb();\n\t\tHMT_low();\n\t\tif (spinning_secondaries == 0)\n\t\t\tbreak;\n\t\tudelay(1);\n\t}\n\tpr_debug(\"spinning_secondaries = %d\\n\", spinning_secondaries);\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup_tlb_core_data",
          "args": [],
          "line": 921
        },
        "resolved": true,
        "details": {
          "function_name": "setup_tlb_core_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "89-119",
          "snippet": "void __init setup_tlb_core_data(void)\n{\n\tint cpu;\n\n\tBUILD_BUG_ON(offsetof(struct tlb_core_data, lock) != 0);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tint first = cpu_first_thread_sibling(cpu);\n\n\t\t/*\n\t\t * If we boot via kdump on a non-primary thread,\n\t\t * make sure we point at the thread that actually\n\t\t * set up this TLB.\n\t\t */\n\t\tif (cpu_first_thread_sibling(boot_cpuid) == first)\n\t\t\tfirst = boot_cpuid;\n\n\t\tpaca_ptrs[cpu]->tcd_ptr = &paca_ptrs[first]->tcd;\n\n\t\t/*\n\t\t * If we have threads, we need either tlbsrx.\n\t\t * or e6500 tablewalk mode, or else TLB handlers\n\t\t * will be racy and could produce duplicate entries.\n\t\t * Should we panic instead?\n\t\t */\n\t\tWARN_ONCE(smt_enabled_at_boot >= 2 &&\n\t\t\t  !mmu_has_feature(MMU_FTR_USE_TLBRSRV) &&\n\t\t\t  book3e_htw_mode != PPC_HTW_E6500,\n\t\t\t  \"%s: unsupported MMU configuration\\n\", __func__);\n\t}\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nvoid __init setup_tlb_core_data(void)\n{\n\tint cpu;\n\n\tBUILD_BUG_ON(offsetof(struct tlb_core_data, lock) != 0);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tint first = cpu_first_thread_sibling(cpu);\n\n\t\t/*\n\t\t * If we boot via kdump on a non-primary thread,\n\t\t * make sure we point at the thread that actually\n\t\t * set up this TLB.\n\t\t */\n\t\tif (cpu_first_thread_sibling(boot_cpuid) == first)\n\t\t\tfirst = boot_cpuid;\n\n\t\tpaca_ptrs[cpu]->tcd_ptr = &paca_ptrs[first]->tcd;\n\n\t\t/*\n\t\t * If we have threads, we need either tlbsrx.\n\t\t * or e6500 tablewalk mode, or else TLB handlers\n\t\t * will be racy and could produce duplicate entries.\n\t\t * Should we panic instead?\n\t\t */\n\t\tWARN_ONCE(smt_enabled_at_boot >= 2 &&\n\t\t\t  !mmu_has_feature(MMU_FTR_USE_TLBRSRV) &&\n\t\t\t  book3e_htw_mode != PPC_HTW_E6500,\n\t\t\t  \"%s: unsupported MMU configuration\\n\", __func__);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_setup_pacas",
          "args": [],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "smp_setup_pacas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "836-849",
          "snippet": "static void smp_setup_pacas(void)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tif (cpu == smp_processor_id())\n\t\t\tcontinue;\n\t\tallocate_paca(cpu);\n\t\tset_hard_smp_processor_id(cpu, cpu_to_phys_id[cpu]);\n\t}\n\n\tmemblock_free(__pa(cpu_to_phys_id), nr_cpu_ids * sizeof(u32));\n\tcpu_to_phys_id = NULL;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void smp_setup_pacas(void)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tif (cpu == smp_processor_id())\n\t\t\tcontinue;\n\t\tallocate_paca(cpu);\n\t\tset_hard_smp_processor_id(cpu, cpu_to_phys_id[cpu]);\n\t}\n\n\tmemblock_free(__pa(cpu_to_phys_id), nr_cpu_ids * sizeof(u32));\n\tcpu_to_phys_id = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mem_topology_setup",
          "args": [],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_smt_enabled",
          "args": [],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "check_smt_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "127-166",
          "snippet": "void __init check_smt_enabled(void)\n{\n\tstruct device_node *dn;\n\tconst char *smt_option;\n\n\t/* Default to enabling all threads */\n\tsmt_enabled_at_boot = threads_per_core;\n\n\t/* Allow the command line to overrule the OF option */\n\tif (smt_enabled_cmdline) {\n\t\tif (!strcmp(smt_enabled_cmdline, \"on\"))\n\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\telse if (!strcmp(smt_enabled_cmdline, \"off\"))\n\t\t\tsmt_enabled_at_boot = 0;\n\t\telse {\n\t\t\tint smt;\n\t\t\tint rc;\n\n\t\t\trc = kstrtoint(smt_enabled_cmdline, 10, &smt);\n\t\t\tif (!rc)\n\t\t\t\tsmt_enabled_at_boot =\n\t\t\t\t\tmin(threads_per_core, smt);\n\t\t}\n\t} else {\n\t\tdn = of_find_node_by_path(\"/options\");\n\t\tif (dn) {\n\t\t\tsmt_option = of_get_property(dn, \"ibm,smt-enabled\",\n\t\t\t\t\t\t     NULL);\n\n\t\t\tif (smt_option) {\n\t\t\t\tif (!strcmp(smt_option, \"on\"))\n\t\t\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\t\t\telse if (!strcmp(smt_option, \"off\"))\n\t\t\t\t\tsmt_enabled_at_boot = 0;\n\t\t\t}\n\n\t\t\tof_node_put(dn);\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nvoid __init check_smt_enabled(void)\n{\n\tstruct device_node *dn;\n\tconst char *smt_option;\n\n\t/* Default to enabling all threads */\n\tsmt_enabled_at_boot = threads_per_core;\n\n\t/* Allow the command line to overrule the OF option */\n\tif (smt_enabled_cmdline) {\n\t\tif (!strcmp(smt_enabled_cmdline, \"on\"))\n\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\telse if (!strcmp(smt_enabled_cmdline, \"off\"))\n\t\t\tsmt_enabled_at_boot = 0;\n\t\telse {\n\t\t\tint smt;\n\t\t\tint rc;\n\n\t\t\trc = kstrtoint(smt_enabled_cmdline, 10, &smt);\n\t\t\tif (!rc)\n\t\t\t\tsmt_enabled_at_boot =\n\t\t\t\t\tmin(threads_per_core, smt);\n\t\t}\n\t} else {\n\t\tdn = of_find_node_by_path(\"/options\");\n\t\tif (dn) {\n\t\t\tsmt_option = of_get_property(dn, \"ibm,smt-enabled\",\n\t\t\t\t\t\t     NULL);\n\n\t\t\tif (smt_option) {\n\t\t\t\tif (!strcmp(smt_option, \"on\"))\n\t\t\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\t\t\telse if (!strcmp(smt_option, \"off\"))\n\t\t\t\t\tsmt_enabled_at_boot = 0;\n\t\t\t}\n\n\t\t\tof_node_put(dn);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmon_setup",
          "args": [],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_setup_cpu_maps",
          "args": [],
          "line": 899
        },
        "resolved": true,
        "details": {
          "function_name": "smp_setup_cpu_maps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "443-565",
          "snippet": "void __init smp_setup_cpu_maps(void)\n{\n\tstruct device_node *dn;\n\tint cpu = 0;\n\tint nthreads = 1;\n\n\tDBG(\"smp_setup_cpu_maps()\\n\");\n\n\tcpu_to_phys_id = memblock_alloc(nr_cpu_ids * sizeof(u32),\n\t\t\t\t\t__alignof__(u32));\n\tif (!cpu_to_phys_id)\n\t\tpanic(\"%s: Failed to allocate %zu bytes align=0x%zx\\n\",\n\t\t      __func__, nr_cpu_ids * sizeof(u32), __alignof__(u32));\n\n\tfor_each_node_by_type(dn, \"cpu\") {\n\t\tconst __be32 *intserv;\n\t\t__be32 cpu_be;\n\t\tint j, len;\n\n\t\tDBG(\"  * %pOF...\\n\", dn);\n\n\t\tintserv = of_get_property(dn, \"ibm,ppc-interrupt-server#s\",\n\t\t\t\t&len);\n\t\tif (intserv) {\n\t\t\tDBG(\"    ibm,ppc-interrupt-server#s -> %d threads\\n\",\n\t\t\t    nthreads);\n\t\t} else {\n\t\t\tDBG(\"    no ibm,ppc-interrupt-server#s -> 1 thread\\n\");\n\t\t\tintserv = of_get_property(dn, \"reg\", &len);\n\t\t\tif (!intserv) {\n\t\t\t\tcpu_be = cpu_to_be32(cpu);\n\t\t\t\t/* XXX: what is this? uninitialized?? */\n\t\t\t\tintserv = &cpu_be;\t/* assume logical == phys */\n\t\t\t\tlen = 4;\n\t\t\t}\n\t\t}\n\n\t\tnthreads = len / sizeof(int);\n\n\t\tfor (j = 0; j < nthreads && cpu < nr_cpu_ids; j++) {\n\t\t\tbool avail;\n\n\t\t\tDBG(\"    thread %d -> cpu %d (hard id %d)\\n\",\n\t\t\t    j, cpu, be32_to_cpu(intserv[j]));\n\n\t\t\tavail = of_device_is_available(dn);\n\t\t\tif (!avail)\n\t\t\t\tavail = !of_property_match_string(dn,\n\t\t\t\t\t\t\"enable-method\", \"spin-table\");\n\n\t\t\tset_cpu_present(cpu, avail);\n\t\t\tset_cpu_possible(cpu, true);\n\t\t\tcpu_to_phys_id[cpu] = be32_to_cpu(intserv[j]);\n\t\t\tcpu++;\n\t\t}\n\n\t\tif (cpu >= nr_cpu_ids) {\n\t\t\tof_node_put(dn);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* If no SMT supported, nthreads is forced to 1 */\n\tif (!cpu_has_feature(CPU_FTR_SMT)) {\n\t\tDBG(\"  SMT disabled ! nthreads forced to 1\\n\");\n\t\tnthreads = 1;\n\t}\n\n#ifdef CONFIG_PPC64\n\t/*\n\t * On pSeries LPAR, we need to know how many cpus\n\t * could possibly be added to this partition.\n\t */\n\tif (firmware_has_feature(FW_FEATURE_LPAR) &&\n\t    (dn = of_find_node_by_path(\"/rtas\"))) {\n\t\tint num_addr_cell, num_size_cell, maxcpus;\n\t\tconst __be32 *ireg;\n\n\t\tnum_addr_cell = of_n_addr_cells(dn);\n\t\tnum_size_cell = of_n_size_cells(dn);\n\n\t\tireg = of_get_property(dn, \"ibm,lrdr-capacity\", NULL);\n\n\t\tif (!ireg)\n\t\t\tgoto out;\n\n\t\tmaxcpus = be32_to_cpup(ireg + num_addr_cell + num_size_cell);\n\n\t\t/* Double maxcpus for processors which have SMT capability */\n\t\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\t\tmaxcpus *= nthreads;\n\n\t\tif (maxcpus > nr_cpu_ids) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"Partition configured for %d cpus, \"\n\t\t\t       \"operating system maximum is %u.\\n\",\n\t\t\t       maxcpus, nr_cpu_ids);\n\t\t\tmaxcpus = nr_cpu_ids;\n\t\t} else\n\t\t\tprintk(KERN_INFO \"Partition configured for %d cpus.\\n\",\n\t\t\t       maxcpus);\n\n\t\tfor (cpu = 0; cpu < maxcpus; cpu++)\n\t\t\tset_cpu_possible(cpu, true);\n\tout:\n\t\tof_node_put(dn);\n\t}\n\tvdso_data->processorCount = num_present_cpus();\n#endif /* CONFIG_PPC64 */\n\n        /* Initialize CPU <=> thread mapping/\n\t *\n\t * WARNING: We assume that the number of threads is the same for\n\t * every CPU in the system. If that is not the case, then some code\n\t * here will have to be reworked\n\t */\n\tcpu_init_thread_core_maps(nthreads);\n\n\t/* Now that possible cpus are set, set nr_cpu_ids for later use */\n\tsetup_nr_cpu_ids();\n\n\tfree_unused_pacas();\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init smp_setup_cpu_maps(void)\n{\n\tstruct device_node *dn;\n\tint cpu = 0;\n\tint nthreads = 1;\n\n\tDBG(\"smp_setup_cpu_maps()\\n\");\n\n\tcpu_to_phys_id = memblock_alloc(nr_cpu_ids * sizeof(u32),\n\t\t\t\t\t__alignof__(u32));\n\tif (!cpu_to_phys_id)\n\t\tpanic(\"%s: Failed to allocate %zu bytes align=0x%zx\\n\",\n\t\t      __func__, nr_cpu_ids * sizeof(u32), __alignof__(u32));\n\n\tfor_each_node_by_type(dn, \"cpu\") {\n\t\tconst __be32 *intserv;\n\t\t__be32 cpu_be;\n\t\tint j, len;\n\n\t\tDBG(\"  * %pOF...\\n\", dn);\n\n\t\tintserv = of_get_property(dn, \"ibm,ppc-interrupt-server#s\",\n\t\t\t\t&len);\n\t\tif (intserv) {\n\t\t\tDBG(\"    ibm,ppc-interrupt-server#s -> %d threads\\n\",\n\t\t\t    nthreads);\n\t\t} else {\n\t\t\tDBG(\"    no ibm,ppc-interrupt-server#s -> 1 thread\\n\");\n\t\t\tintserv = of_get_property(dn, \"reg\", &len);\n\t\t\tif (!intserv) {\n\t\t\t\tcpu_be = cpu_to_be32(cpu);\n\t\t\t\t/* XXX: what is this? uninitialized?? */\n\t\t\t\tintserv = &cpu_be;\t/* assume logical == phys */\n\t\t\t\tlen = 4;\n\t\t\t}\n\t\t}\n\n\t\tnthreads = len / sizeof(int);\n\n\t\tfor (j = 0; j < nthreads && cpu < nr_cpu_ids; j++) {\n\t\t\tbool avail;\n\n\t\t\tDBG(\"    thread %d -> cpu %d (hard id %d)\\n\",\n\t\t\t    j, cpu, be32_to_cpu(intserv[j]));\n\n\t\t\tavail = of_device_is_available(dn);\n\t\t\tif (!avail)\n\t\t\t\tavail = !of_property_match_string(dn,\n\t\t\t\t\t\t\"enable-method\", \"spin-table\");\n\n\t\t\tset_cpu_present(cpu, avail);\n\t\t\tset_cpu_possible(cpu, true);\n\t\t\tcpu_to_phys_id[cpu] = be32_to_cpu(intserv[j]);\n\t\t\tcpu++;\n\t\t}\n\n\t\tif (cpu >= nr_cpu_ids) {\n\t\t\tof_node_put(dn);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* If no SMT supported, nthreads is forced to 1 */\n\tif (!cpu_has_feature(CPU_FTR_SMT)) {\n\t\tDBG(\"  SMT disabled ! nthreads forced to 1\\n\");\n\t\tnthreads = 1;\n\t}\n\n#ifdef CONFIG_PPC64\n\t/*\n\t * On pSeries LPAR, we need to know how many cpus\n\t * could possibly be added to this partition.\n\t */\n\tif (firmware_has_feature(FW_FEATURE_LPAR) &&\n\t    (dn = of_find_node_by_path(\"/rtas\"))) {\n\t\tint num_addr_cell, num_size_cell, maxcpus;\n\t\tconst __be32 *ireg;\n\n\t\tnum_addr_cell = of_n_addr_cells(dn);\n\t\tnum_size_cell = of_n_size_cells(dn);\n\n\t\tireg = of_get_property(dn, \"ibm,lrdr-capacity\", NULL);\n\n\t\tif (!ireg)\n\t\t\tgoto out;\n\n\t\tmaxcpus = be32_to_cpup(ireg + num_addr_cell + num_size_cell);\n\n\t\t/* Double maxcpus for processors which have SMT capability */\n\t\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\t\tmaxcpus *= nthreads;\n\n\t\tif (maxcpus > nr_cpu_ids) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"Partition configured for %d cpus, \"\n\t\t\t       \"operating system maximum is %u.\\n\",\n\t\t\t       maxcpus, nr_cpu_ids);\n\t\t\tmaxcpus = nr_cpu_ids;\n\t\t} else\n\t\t\tprintk(KERN_INFO \"Partition configured for %d cpus.\\n\",\n\t\t\t       maxcpus);\n\n\t\tfor (cpu = 0; cpu < maxcpus; cpu++)\n\t\t\tset_cpu_possible(cpu, true);\n\tout:\n\t\tof_node_put(dn);\n\t}\n\tvdso_data->processorCount = num_present_cpus();\n#endif /* CONFIG_PPC64 */\n\n        /* Initialize CPU <=> thread mapping/\n\t *\n\t * WARNING: We assume that the number of threads is the same for\n\t * every CPU in the system. If that is not the case, then some code\n\t * here will have to be reworked\n\t */\n\tcpu_init_thread_core_maps(nthreads);\n\n\t/* Now that possible cpus are set, set nr_cpu_ids for later use */\n\tsetup_nr_cpu_ids();\n\n\tfree_unused_pacas();\n}"
        }
      },
      {
        "call_info": {
          "callee": "register_early_udbg_console",
          "args": [],
          "line": 896
        },
        "resolved": true,
        "details": {
          "function_name": "register_early_udbg_console",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg.c",
          "lines": "160-174",
          "snippet": "void __init register_early_udbg_console(void)\n{\n\tif (early_console)\n\t\treturn;\n\n\tif (!udbg_putc)\n\t\treturn;\n\n\tif (strstr(boot_command_line, \"udbg-immortal\")) {\n\t\tprintk(KERN_INFO \"early console immortal !\\n\");\n\t\tudbg_console.flags &= ~CON_BOOT;\n\t}\n\tearly_console = &udbg_console;\n\tregister_console(&udbg_console);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/processor.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct console udbg_console = {\n\t.name\t= \"udbg\",\n\t.write\t= udbg_console_write,\n\t.flags\t= CON_PRINTBUFFER | CON_ENABLED | CON_BOOT | CON_ANYTIME,\n\t.index\t= 0,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/processor.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n#include <stdarg.h>\n\nstatic struct console udbg_console = {\n\t.name\t= \"udbg\",\n\t.write\t= udbg_console_write,\n\t.flags\t= CON_PRINTBUFFER | CON_ENABLED | CON_BOOT | CON_ANYTIME,\n\t.index\t= 0,\n};\n\nvoid __init register_early_udbg_console(void)\n{\n\tif (early_console)\n\t\treturn;\n\n\tif (!udbg_putc)\n\t\treturn;\n\n\tif (strstr(boot_command_line, \"udbg-immortal\")) {\n\t\tprintk(KERN_INFO \"early console immortal !\\n\");\n\t\tudbg_console.flags &= ~CON_BOOT;\n\t}\n\tearly_console = &udbg_console;\n\tregister_console(&udbg_console);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_legacy_serial_ports",
          "args": [],
          "line": 893
        },
        "resolved": true,
        "details": {
          "function_name": "find_legacy_serial_ports",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/legacy_serial.c",
          "lines": "365-450",
          "snippet": "void __init find_legacy_serial_ports(void)\n{\n\tstruct device_node *np, *stdout = NULL;\n\tconst char *path;\n\tint index;\n\n\tDBG(\" -> find_legacy_serial_port()\\n\");\n\n\t/* Now find out if one of these is out firmware console */\n\tpath = of_get_property(of_chosen, \"linux,stdout-path\", NULL);\n\tif (path == NULL)\n\t\tpath = of_get_property(of_chosen, \"stdout-path\", NULL);\n\tif (path != NULL) {\n\t\tstdout = of_find_node_by_path(path);\n\t\tif (stdout)\n\t\t\tDBG(\"stdout is %pOF\\n\", stdout);\n\t} else {\n\t\tDBG(\" no linux,stdout-path !\\n\");\n\t}\n\n\t/* Iterate over all the 16550 ports, looking for known parents */\n\tfor_each_compatible_node(np, \"serial\", \"ns16550\") {\n\t\tstruct device_node *parent = of_get_parent(np);\n\t\tif (!parent)\n\t\t\tcontinue;\n\t\tif (of_match_node(legacy_serial_parents, parent) != NULL) {\n\t\t\tif (of_device_is_available(np)) {\n\t\t\t\tindex = add_legacy_soc_port(np, np);\n\t\t\t\tif (index >= 0 && np == stdout)\n\t\t\t\t\tlegacy_serial_console = index;\n\t\t\t}\n\t\t}\n\t\tof_node_put(parent);\n\t}\n\n\t/* Next, fill our array with ISA ports */\n\tfor_each_node_by_type(np, \"serial\") {\n\t\tstruct device_node *isa = of_get_parent(np);\n\t\tif (of_node_name_eq(isa, \"isa\") || of_node_name_eq(isa, \"lpc\")) {\n\t\t\tif (of_device_is_available(np)) {\n\t\t\t\tindex = add_legacy_isa_port(np, isa);\n\t\t\t\tif (index >= 0 && np == stdout)\n\t\t\t\t\tlegacy_serial_console = index;\n\t\t\t}\n\t\t}\n\t\tof_node_put(isa);\n\t}\n\n#ifdef CONFIG_PCI\n\t/* Next, try to locate PCI ports */\n\tfor (np = NULL; (np = of_find_all_nodes(np));) {\n\t\tstruct device_node *pci, *parent = of_get_parent(np);\n\t\tif (of_node_name_eq(parent, \"isa\")) {\n\t\t\tof_node_put(parent);\n\t\t\tcontinue;\n\t\t}\n\t\tif (!of_node_name_eq(np, \"serial\") &&\n\t\t    !of_node_is_type(np, \"serial\")) {\n\t\t\tof_node_put(parent);\n\t\t\tcontinue;\n\t\t}\n\t\t/* Check for known pciclass, and also check whether we have\n\t\t * a device with child nodes for ports or not\n\t\t */\n\t\tif (of_device_is_compatible(np, \"pciclass,0700\") ||\n\t\t    of_device_is_compatible(np, \"pciclass,070002\"))\n\t\t\tpci = np;\n\t\telse if (of_device_is_compatible(parent, \"pciclass,0700\") ||\n\t\t\t of_device_is_compatible(parent, \"pciclass,070002\"))\n\t\t\tpci = parent;\n\t\telse {\n\t\t\tof_node_put(parent);\n\t\t\tcontinue;\n\t\t}\n\t\tindex = add_legacy_pci_port(np, pci);\n\t\tif (index >= 0 && np == stdout)\n\t\t\tlegacy_serial_console = index;\n\t\tof_node_put(parent);\n\t}\n#endif\n\n\tDBG(\"legacy_serial_console = %d\\n\", legacy_serial_console);\n\tif (legacy_serial_console >= 0)\n\t\tsetup_legacy_serial_console(legacy_serial_console);\n\tDBG(\" <- find_legacy_serial_port()\\n\");\n}",
          "includes": [
            "#include <asm/ppc-pci.h>",
            "#include <asm/pci-bridge.h>",
            "#include <asm/udbg.h>",
            "#include <asm/serial.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/io.h>",
            "#include <linux/serial_reg.h>",
            "#include <linux/of_device.h>",
            "#include <linux/of_address.h>",
            "#include <linux/pci.h>",
            "#include <linux/console.h>",
            "#include <linux/serial_core.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct of_device_id legacy_serial_parents[] __initconst = {\n\t{.type = \"soc\",},\n\t{.type = \"tsi-bridge\",},\n\t{.type = \"opb\", },\n\t{.compatible = \"ibm,opb\",},\n\t{.compatible = \"simple-bus\",},\n\t{.compatible = \"wrs,epld-localbus\",},\n\t{},\n};",
            "static int legacy_serial_console = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ppc-pci.h>\n#include <asm/pci-bridge.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/io.h>\n#include <linux/serial_reg.h>\n#include <linux/of_device.h>\n#include <linux/of_address.h>\n#include <linux/pci.h>\n#include <linux/console.h>\n#include <linux/serial_core.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/kernel.h>\n\nstatic const struct of_device_id legacy_serial_parents[] __initconst = {\n\t{.type = \"soc\",},\n\t{.type = \"tsi-bridge\",},\n\t{.type = \"opb\", },\n\t{.compatible = \"ibm,opb\",},\n\t{.compatible = \"simple-bus\",},\n\t{.compatible = \"wrs,epld-localbus\",},\n\t{},\n};\nstatic int legacy_serial_console = -1;\n\nvoid __init find_legacy_serial_ports(void)\n{\n\tstruct device_node *np, *stdout = NULL;\n\tconst char *path;\n\tint index;\n\n\tDBG(\" -> find_legacy_serial_port()\\n\");\n\n\t/* Now find out if one of these is out firmware console */\n\tpath = of_get_property(of_chosen, \"linux,stdout-path\", NULL);\n\tif (path == NULL)\n\t\tpath = of_get_property(of_chosen, \"stdout-path\", NULL);\n\tif (path != NULL) {\n\t\tstdout = of_find_node_by_path(path);\n\t\tif (stdout)\n\t\t\tDBG(\"stdout is %pOF\\n\", stdout);\n\t} else {\n\t\tDBG(\" no linux,stdout-path !\\n\");\n\t}\n\n\t/* Iterate over all the 16550 ports, looking for known parents */\n\tfor_each_compatible_node(np, \"serial\", \"ns16550\") {\n\t\tstruct device_node *parent = of_get_parent(np);\n\t\tif (!parent)\n\t\t\tcontinue;\n\t\tif (of_match_node(legacy_serial_parents, parent) != NULL) {\n\t\t\tif (of_device_is_available(np)) {\n\t\t\t\tindex = add_legacy_soc_port(np, np);\n\t\t\t\tif (index >= 0 && np == stdout)\n\t\t\t\t\tlegacy_serial_console = index;\n\t\t\t}\n\t\t}\n\t\tof_node_put(parent);\n\t}\n\n\t/* Next, fill our array with ISA ports */\n\tfor_each_node_by_type(np, \"serial\") {\n\t\tstruct device_node *isa = of_get_parent(np);\n\t\tif (of_node_name_eq(isa, \"isa\") || of_node_name_eq(isa, \"lpc\")) {\n\t\t\tif (of_device_is_available(np)) {\n\t\t\t\tindex = add_legacy_isa_port(np, isa);\n\t\t\t\tif (index >= 0 && np == stdout)\n\t\t\t\t\tlegacy_serial_console = index;\n\t\t\t}\n\t\t}\n\t\tof_node_put(isa);\n\t}\n\n#ifdef CONFIG_PCI\n\t/* Next, try to locate PCI ports */\n\tfor (np = NULL; (np = of_find_all_nodes(np));) {\n\t\tstruct device_node *pci, *parent = of_get_parent(np);\n\t\tif (of_node_name_eq(parent, \"isa\")) {\n\t\t\tof_node_put(parent);\n\t\t\tcontinue;\n\t\t}\n\t\tif (!of_node_name_eq(np, \"serial\") &&\n\t\t    !of_node_is_type(np, \"serial\")) {\n\t\t\tof_node_put(parent);\n\t\t\tcontinue;\n\t\t}\n\t\t/* Check for known pciclass, and also check whether we have\n\t\t * a device with child nodes for ports or not\n\t\t */\n\t\tif (of_device_is_compatible(np, \"pciclass,0700\") ||\n\t\t    of_device_is_compatible(np, \"pciclass,070002\"))\n\t\t\tpci = np;\n\t\telse if (of_device_is_compatible(parent, \"pciclass,0700\") ||\n\t\t\t of_device_is_compatible(parent, \"pciclass,070002\"))\n\t\t\tpci = parent;\n\t\telse {\n\t\t\tof_node_put(parent);\n\t\t\tcontinue;\n\t\t}\n\t\tindex = add_legacy_pci_port(np, pci);\n\t\tif (index >= 0 && np == stdout)\n\t\t\tlegacy_serial_console = index;\n\t\tof_node_put(parent);\n\t}\n#endif\n\n\tDBG(\"legacy_serial_console = %d\\n\", legacy_serial_console);\n\tif (legacy_serial_console >= 0)\n\t\tsetup_legacy_serial_console(legacy_serial_console);\n\tDBG(\" <- find_legacy_serial_port()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup_power_save",
          "args": [],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "setup_power_save",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup.h",
          "lines": "23-23",
          "snippet": "static inline void setup_power_save(void) { }",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void setup_power_save(void) { }"
        }
      },
      {
        "call_info": {
          "callee": "setup_panic",
          "args": [],
          "line": 884
        },
        "resolved": true,
        "details": {
          "function_name": "setup_panic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "731-741",
          "snippet": "void __init setup_panic(void)\n{\n\tif (IS_ENABLED(CONFIG_RANDOMIZE_BASE) && kaslr_offset() > 0)\n\t\tatomic_notifier_chain_register(&panic_notifier_list,\n\t\t\t\t\t       &kernel_offset_notifier);\n\n\t/* PPC64 always does a hard irq disable in its panic handler */\n\tif (!IS_ENABLED(CONFIG_PPC64) && !ppc_md.panic)\n\t\treturn;\n\tatomic_notifier_chain_register(&panic_notifier_list, &ppc_panic_block);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct machdep_calls ppc_md;",
            "static struct notifier_block ppc_panic_block = {\n\t.notifier_call = ppc_panic_event,\n\t.priority = INT_MIN /* may not return; must be done last */\n};",
            "static struct notifier_block kernel_offset_notifier = {\n\t.notifier_call = dump_kernel_offset\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\nstatic struct notifier_block ppc_panic_block = {\n\t.notifier_call = ppc_panic_event,\n\t.priority = INT_MIN /* may not return; must be done last */\n};\nstatic struct notifier_block kernel_offset_notifier = {\n\t.notifier_call = dump_kernel_offset\n};\n\nvoid __init setup_panic(void)\n{\n\tif (IS_ENABLED(CONFIG_RANDOMIZE_BASE) && kaslr_offset() > 0)\n\t\tatomic_notifier_chain_register(&panic_notifier_list,\n\t\t\t\t\t       &kernel_offset_notifier);\n\n\t/* PPC64 always does a hard irq disable in its panic handler */\n\tif (!IS_ENABLED(CONFIG_PPC64) && !ppc_md.panic)\n\t\treturn;\n\tatomic_notifier_chain_register(&panic_notifier_list, &ppc_panic_block);\n}"
        }
      },
      {
        "call_info": {
          "callee": "probe_machine",
          "args": [],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "probe_machine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "593-634",
          "snippet": "void probe_machine(void)\n{\n\textern struct machdep_calls __machine_desc_start;\n\textern struct machdep_calls __machine_desc_end;\n\tunsigned int i;\n\n\t/*\n\t * Iterate all ppc_md structures until we find the proper\n\t * one for the current machine type\n\t */\n\tDBG(\"Probing machine type ...\\n\");\n\n\t/*\n\t * Check ppc_md is empty, if not we have a bug, ie, we setup an\n\t * entry before probe_machine() which will be overwritten\n\t */\n\tfor (i = 0; i < (sizeof(ppc_md) / sizeof(void *)); i++) {\n\t\tif (((void **)&ppc_md)[i]) {\n\t\t\tprintk(KERN_ERR \"Entry %d in ppc_md non empty before\"\n\t\t\t       \" machine probe !\\n\", i);\n\t\t}\n\t}\n\n\tfor (machine_id = &__machine_desc_start;\n\t     machine_id < &__machine_desc_end;\n\t     machine_id++) {\n\t\tDBG(\"  %s ...\", machine_id->name);\n\t\tmemcpy(&ppc_md, machine_id, sizeof(struct machdep_calls));\n\t\tif (ppc_md.probe()) {\n\t\t\tDBG(\" match !\\n\");\n\t\t\tbreak;\n\t\t}\n\t\tDBG(\"\\n\");\n\t}\n\t/* What can we do if we didn't find ? */\n\tif (machine_id >= &__machine_desc_end) {\n\t\tpr_err(\"No suitable machine description found !\\n\");\n\t\tfor (;;);\n\t}\n\n\tprintk(KERN_INFO \"Using %s machine description\\n\", ppc_md.name);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct machdep_calls ppc_md;",
            "struct machdep_calls *machine_id;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\nstruct machdep_calls *machine_id;\n\nvoid probe_machine(void)\n{\n\textern struct machdep_calls __machine_desc_start;\n\textern struct machdep_calls __machine_desc_end;\n\tunsigned int i;\n\n\t/*\n\t * Iterate all ppc_md structures until we find the proper\n\t * one for the current machine type\n\t */\n\tDBG(\"Probing machine type ...\\n\");\n\n\t/*\n\t * Check ppc_md is empty, if not we have a bug, ie, we setup an\n\t * entry before probe_machine() which will be overwritten\n\t */\n\tfor (i = 0; i < (sizeof(ppc_md) / sizeof(void *)); i++) {\n\t\tif (((void **)&ppc_md)[i]) {\n\t\t\tprintk(KERN_ERR \"Entry %d in ppc_md non empty before\"\n\t\t\t       \" machine probe !\\n\", i);\n\t\t}\n\t}\n\n\tfor (machine_id = &__machine_desc_start;\n\t     machine_id < &__machine_desc_end;\n\t     machine_id++) {\n\t\tDBG(\"  %s ...\", machine_id->name);\n\t\tmemcpy(&ppc_md, machine_id, sizeof(struct machdep_calls));\n\t\tif (ppc_md.probe()) {\n\t\t\tDBG(\" match !\\n\");\n\t\t\tbreak;\n\t\t}\n\t\tDBG(\"\\n\");\n\t}\n\t/* What can we do if we didn't find ? */\n\tif (machine_id >= &__machine_desc_end) {\n\t\tpr_err(\"No suitable machine description found !\\n\");\n\t\tfor (;;);\n\t}\n\n\tprintk(KERN_INFO \"Using %s machine description\\n\", ppc_md.name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_for_initrd",
          "args": [],
          "line": 878
        },
        "resolved": true,
        "details": {
          "function_name": "check_for_initrd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "369-389",
          "snippet": "void __init check_for_initrd(void)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tDBG(\" -> check_for_initrd()  initrd_start=0x%lx  initrd_end=0x%lx\\n\",\n\t    initrd_start, initrd_end);\n\n\t/* If we were passed an initrd, set the ROOT_DEV properly if the values\n\t * look sensible. If not, clear initrd reference.\n\t */\n\tif (is_kernel_addr(initrd_start) && is_kernel_addr(initrd_end) &&\n\t    initrd_end > initrd_start)\n\t\tROOT_DEV = Root_RAM0;\n\telse\n\t\tinitrd_start = initrd_end = 0;\n\n\tif (initrd_start)\n\t\tpr_info(\"Found initrd at 0x%lx:0x%lx\\n\", initrd_start, initrd_end);\n\n\tDBG(\" <- check_for_initrd()\\n\");\n#endif /* CONFIG_BLK_DEV_INITRD */\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init check_for_initrd(void)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tDBG(\" -> check_for_initrd()  initrd_start=0x%lx  initrd_end=0x%lx\\n\",\n\t    initrd_start, initrd_end);\n\n\t/* If we were passed an initrd, set the ROOT_DEV properly if the values\n\t * look sensible. If not, clear initrd reference.\n\t */\n\tif (is_kernel_addr(initrd_start) && is_kernel_addr(initrd_end) &&\n\t    initrd_end > initrd_start)\n\t\tROOT_DEV = Root_RAM0;\n\telse\n\t\tinitrd_start = initrd_end = 0;\n\n\tif (initrd_start)\n\t\tpr_info(\"Found initrd at 0x%lx:0x%lx\\n\", initrd_start, initrd_end);\n\n\tDBG(\" <- check_for_initrd()\\n\");\n#endif /* CONFIG_BLK_DEV_INITRD */\n}"
        }
      },
      {
        "call_info": {
          "callee": "rtas_initialize",
          "args": [],
          "line": 875
        },
        "resolved": true,
        "details": {
          "function_name": "rtas_initialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/rtas.c",
          "lines": "1088-1132",
          "snippet": "void __init rtas_initialize(void)\n{\n\tunsigned long rtas_region = RTAS_INSTANTIATE_MAX;\n\tu32 base, size, entry;\n\tint no_base, no_size, no_entry;\n\n\t/* Get RTAS dev node and fill up our \"rtas\" structure with infos\n\t * about it.\n\t */\n\trtas.dev = of_find_node_by_name(NULL, \"rtas\");\n\tif (!rtas.dev)\n\t\treturn;\n\n\tno_base = of_property_read_u32(rtas.dev, \"linux,rtas-base\", &base);\n\tno_size = of_property_read_u32(rtas.dev, \"rtas-size\", &size);\n\tif (no_base || no_size) {\n\t\tof_node_put(rtas.dev);\n\t\trtas.dev = NULL;\n\t\treturn;\n\t}\n\n\trtas.base = base;\n\trtas.size = size;\n\tno_entry = of_property_read_u32(rtas.dev, \"linux,rtas-entry\", &entry);\n\trtas.entry = no_entry ? rtas.base : entry;\n\n\t/* If RTAS was found, allocate the RMO buffer for it and look for\n\t * the stop-self token if any\n\t */\n#ifdef CONFIG_PPC64\n\tif (firmware_has_feature(FW_FEATURE_LPAR)) {\n\t\trtas_region = min(ppc64_rma_size, RTAS_INSTANTIATE_MAX);\n\t\tibm_suspend_me_token = rtas_token(\"ibm,suspend-me\");\n\t}\n#endif\n\trtas_rmo_buf = memblock_phys_alloc_range(RTAS_RMOBUF_MAX, PAGE_SIZE,\n\t\t\t\t\t\t 0, rtas_region);\n\tif (!rtas_rmo_buf)\n\t\tpanic(\"ERROR: RTAS: Failed to allocate %lx bytes below %pa\\n\",\n\t\t      PAGE_SIZE, &rtas_region);\n\n#ifdef CONFIG_RTAS_ERROR_LOGGING\n\trtas_last_error_token = rtas_token(\"rtas-last-error\");\n#endif\n}",
          "includes": [
            "#include <asm/paca.h>",
            "#include <asm/topology.h>",
            "#include <asm/mmu.h>",
            "#include <asm/time.h>",
            "#include <linux/atomic.h>",
            "#include <asm/smp.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/udbg.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/delay.h>",
            "#include <asm/param.h>",
            "#include <asm/page.h>",
            "#include <asm/firmware.h>",
            "#include <asm/machdep.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/reboot.h>",
            "#include <linux/slab.h>",
            "#include <linux/memblock.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/completion.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/cpu.h>",
            "#include <linux/delay.h>",
            "#include <linux/capability.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct rtas_t rtas = {\n\t.lock = __ARCH_SPIN_LOCK_UNLOCKED\n};",
            "unsigned long rtas_rmo_buf;",
            "static int ibm_suspend_me_token = RTAS_UNKNOWN_SERVICE;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/paca.h>\n#include <asm/topology.h>\n#include <asm/mmu.h>\n#include <asm/time.h>\n#include <linux/atomic.h>\n#include <asm/smp.h>\n#include <asm/syscalls.h>\n#include <asm/udbg.h>\n#include <linux/uaccess.h>\n#include <asm/delay.h>\n#include <asm/param.h>\n#include <asm/page.h>\n#include <asm/firmware.h>\n#include <asm/machdep.h>\n#include <asm/hvcall.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/syscalls.h>\n#include <linux/reboot.h>\n#include <linux/slab.h>\n#include <linux/memblock.h>\n#include <linux/cpumask.h>\n#include <linux/completion.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/cpu.h>\n#include <linux/delay.h>\n#include <linux/capability.h>\n#include <linux/init.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstruct rtas_t rtas = {\n\t.lock = __ARCH_SPIN_LOCK_UNLOCKED\n};\nunsigned long rtas_rmo_buf;\nstatic int ibm_suspend_me_token = RTAS_UNKNOWN_SERVICE;\n\nvoid __init rtas_initialize(void)\n{\n\tunsigned long rtas_region = RTAS_INSTANTIATE_MAX;\n\tu32 base, size, entry;\n\tint no_base, no_size, no_entry;\n\n\t/* Get RTAS dev node and fill up our \"rtas\" structure with infos\n\t * about it.\n\t */\n\trtas.dev = of_find_node_by_name(NULL, \"rtas\");\n\tif (!rtas.dev)\n\t\treturn;\n\n\tno_base = of_property_read_u32(rtas.dev, \"linux,rtas-base\", &base);\n\tno_size = of_property_read_u32(rtas.dev, \"rtas-size\", &size);\n\tif (no_base || no_size) {\n\t\tof_node_put(rtas.dev);\n\t\trtas.dev = NULL;\n\t\treturn;\n\t}\n\n\trtas.base = base;\n\trtas.size = size;\n\tno_entry = of_property_read_u32(rtas.dev, \"linux,rtas-entry\", &entry);\n\trtas.entry = no_entry ? rtas.base : entry;\n\n\t/* If RTAS was found, allocate the RMO buffer for it and look for\n\t * the stop-self token if any\n\t */\n#ifdef CONFIG_PPC64\n\tif (firmware_has_feature(FW_FEATURE_LPAR)) {\n\t\trtas_region = min(ppc64_rma_size, RTAS_INSTANTIATE_MAX);\n\t\tibm_suspend_me_token = rtas_token(\"ibm,suspend-me\");\n\t}\n#endif\n\trtas_rmo_buf = memblock_phys_alloc_range(RTAS_RMOBUF_MAX, PAGE_SIZE,\n\t\t\t\t\t\t 0, rtas_region);\n\tif (!rtas_rmo_buf)\n\t\tpanic(\"ERROR: RTAS: Failed to allocate %lx bytes below %pa\\n\",\n\t\t      PAGE_SIZE, &rtas_region);\n\n#ifdef CONFIG_RTAS_ERROR_LOGGING\n\trtas_last_error_token = rtas_token(\"rtas-last-error\");\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "initialize_cache_info",
          "args": [],
          "line": 872
        },
        "resolved": true,
        "details": {
          "function_name": "initialize_cache_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "566-622",
          "snippet": "void __init initialize_cache_info(void)\n{\n\tstruct device_node *cpu = NULL, *l2, *l3 = NULL;\n\tu32 pvr;\n\n\t/*\n\t * All shipping POWER8 machines have a firmware bug that\n\t * puts incorrect information in the device-tree. This will\n\t * be (hopefully) fixed for future chips but for now hard\n\t * code the values if we are running on one of these\n\t */\n\tpvr = PVR_VER(mfspr(SPRN_PVR));\n\tif (pvr == PVR_POWER8 || pvr == PVR_POWER8E ||\n\t    pvr == PVR_POWER8NVL) {\n\t\t\t\t\t\t/* size    lsize   blk  sets */\n\t\tinit_cache_info(&ppc64_caches.l1i, 0x8000,   128,  128, 32);\n\t\tinit_cache_info(&ppc64_caches.l1d, 0x10000,  128,  128, 64);\n\t\tinit_cache_info(&ppc64_caches.l2,  0x80000,  128,  0,   512);\n\t\tinit_cache_info(&ppc64_caches.l3,  0x800000, 128,  0,   8192);\n\t} else\n\t\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\t/*\n\t * We're assuming *all* of the CPUs have the same\n\t * d-cache and i-cache sizes... -Peter\n\t */\n\tif (cpu) {\n\t\tif (!parse_cache_info(cpu, false, &ppc64_caches.l1d))\n\t\t\tpr_warn(\"Argh, can't find dcache properties !\\n\");\n\n\t\tif (!parse_cache_info(cpu, true, &ppc64_caches.l1i))\n\t\t\tpr_warn(\"Argh, can't find icache properties !\\n\");\n\n\t\t/*\n\t\t * Try to find the L2 and L3 if any. Assume they are\n\t\t * unified and use the D-side properties.\n\t\t */\n\t\tl2 = of_find_next_cache_node(cpu);\n\t\tof_node_put(cpu);\n\t\tif (l2) {\n\t\t\tparse_cache_info(l2, false, &ppc64_caches.l2);\n\t\t\tl3 = of_find_next_cache_node(l2);\n\t\t\tof_node_put(l2);\n\t\t}\n\t\tif (l3) {\n\t\t\tparse_cache_info(l3, false, &ppc64_caches.l3);\n\t\t\tof_node_put(l3);\n\t\t}\n\t}\n\n\t/* For use by binfmt_elf */\n\tdcache_bsize = ppc64_caches.l1d.block_size;\n\ticache_bsize = ppc64_caches.l1i.block_size;\n\n\tcur_cpu_spec->dcache_bsize = dcache_bsize;\n\tcur_cpu_spec->icache_bsize = icache_bsize;\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct ppc64_caches ppc64_caches = {\n\t.l1d = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6,\n\t},\n\t.l1i = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6\n\t},\n};",
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct ppc64_caches ppc64_caches = {\n\t.l1d = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6,\n\t},\n\t.l1i = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6\n\t},\n};\nvoid __init;\n\nvoid __init initialize_cache_info(void)\n{\n\tstruct device_node *cpu = NULL, *l2, *l3 = NULL;\n\tu32 pvr;\n\n\t/*\n\t * All shipping POWER8 machines have a firmware bug that\n\t * puts incorrect information in the device-tree. This will\n\t * be (hopefully) fixed for future chips but for now hard\n\t * code the values if we are running on one of these\n\t */\n\tpvr = PVR_VER(mfspr(SPRN_PVR));\n\tif (pvr == PVR_POWER8 || pvr == PVR_POWER8E ||\n\t    pvr == PVR_POWER8NVL) {\n\t\t\t\t\t\t/* size    lsize   blk  sets */\n\t\tinit_cache_info(&ppc64_caches.l1i, 0x8000,   128,  128, 32);\n\t\tinit_cache_info(&ppc64_caches.l1d, 0x10000,  128,  128, 64);\n\t\tinit_cache_info(&ppc64_caches.l2,  0x80000,  128,  0,   512);\n\t\tinit_cache_info(&ppc64_caches.l3,  0x800000, 128,  0,   8192);\n\t} else\n\t\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\t/*\n\t * We're assuming *all* of the CPUs have the same\n\t * d-cache and i-cache sizes... -Peter\n\t */\n\tif (cpu) {\n\t\tif (!parse_cache_info(cpu, false, &ppc64_caches.l1d))\n\t\t\tpr_warn(\"Argh, can't find dcache properties !\\n\");\n\n\t\tif (!parse_cache_info(cpu, true, &ppc64_caches.l1i))\n\t\t\tpr_warn(\"Argh, can't find icache properties !\\n\");\n\n\t\t/*\n\t\t * Try to find the L2 and L3 if any. Assume they are\n\t\t * unified and use the D-side properties.\n\t\t */\n\t\tl2 = of_find_next_cache_node(cpu);\n\t\tof_node_put(cpu);\n\t\tif (l2) {\n\t\t\tparse_cache_info(l2, false, &ppc64_caches.l2);\n\t\t\tl3 = of_find_next_cache_node(l2);\n\t\t\tof_node_put(l2);\n\t\t}\n\t\tif (l3) {\n\t\t\tparse_cache_info(l3, false, &ppc64_caches.l3);\n\t\t\tof_node_put(l3);\n\t\t}\n\t}\n\n\t/* For use by binfmt_elf */\n\tdcache_bsize = ppc64_caches.l1d.block_size;\n\ticache_bsize = ppc64_caches.l1i.block_size;\n\n\tcur_cpu_spec->dcache_bsize = dcache_bsize;\n\tcur_cpu_spec->icache_bsize = icache_bsize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unflatten_device_tree",
          "args": [],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_init",
          "args": [],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\nunsigned long klimit = (unsigned long) _end;\n\nvoid __init setup_arch(char **cmdline_p)\n{\n\tkasan_init();\n\n\t*cmdline_p = boot_command_line;\n\n\t/* Set a half-reasonable default so udelay does something sensible */\n\tloops_per_jiffy = 500000000 / HZ;\n\n\t/* Unflatten the device-tree passed by prom_init or kexec */\n\tunflatten_device_tree();\n\n\t/*\n\t * Initialize cache line/block info from device-tree (on ppc64) or\n\t * just cputable (on ppc32).\n\t */\n\tinitialize_cache_info();\n\n\t/* Initialize RTAS if available. */\n\trtas_initialize();\n\n\t/* Check if we have an initrd provided via the device-tree. */\n\tcheck_for_initrd();\n\n\t/* Probe the machine type, establish ppc_md. */\n\tprobe_machine();\n\n\t/* Setup panic notifier if requested by the platform. */\n\tsetup_panic();\n\n\t/*\n\t * Configure ppc_md.power_save (ppc32 only, 64-bit machines do\n\t * it from their respective probe() function.\n\t */\n\tsetup_power_save();\n\n\t/* Discover standard serial ports. */\n\tfind_legacy_serial_ports();\n\n\t/* Register early console with the printk subsystem. */\n\tregister_early_udbg_console();\n\n\t/* Setup the various CPU maps based on the device-tree. */\n\tsmp_setup_cpu_maps();\n\n\t/* Initialize xmon. */\n\txmon_setup();\n\n\t/* Check the SMT related command line arguments (ppc64). */\n\tcheck_smt_enabled();\n\n\t/* Parse memory topology */\n\tmem_topology_setup();\n\n\t/*\n\t * Release secondary cpus out of their spinloops at 0x60 now that\n\t * we can map physical -> logical CPU ids.\n\t *\n\t * Freescale Book3e parts spin in a loop provided by firmware,\n\t * so smp_release_cpus() does nothing for them.\n\t */\n#ifdef CONFIG_SMP\n\tsmp_setup_pacas();\n\n\t/* On BookE, setup per-core TLB data structures. */\n\tsetup_tlb_core_data();\n\n\tsmp_release_cpus();\n#endif\n\n\t/* Print various info about the machine that has been gathered so far. */\n\tprint_system_info();\n\n\t/* Reserve large chunks of memory for use by CMA for KVM. */\n\tkvm_cma_reserve();\n\n\t/*  Reserve large chunks of memory for us by CMA for hugetlb */\n\tgigantic_hugetlb_cma_reserve();\n\n\tklp_init_thread_info(&init_task);\n\n\tinit_mm.start_code = (unsigned long)_stext;\n\tinit_mm.end_code = (unsigned long) _etext;\n\tinit_mm.end_data = (unsigned long) _edata;\n\tinit_mm.brk = klimit;\n\n\tmm_iommu_init(&init_mm);\n\tirqstack_early_init();\n\texc_lvl_early_init();\n\temergency_stack_init();\n\n\tinitmem_init();\n\n\tearly_memtest(min_low_pfn << PAGE_SHIFT, max_low_pfn << PAGE_SHIFT);\n\n\tif (ppc_md.setup_arch)\n\t\tppc_md.setup_arch();\n\n\tsetup_barrier_nospec();\n\tsetup_spectre_v2();\n\n\tpaging_init();\n\n\t/* Initialize the MMU context management stuff. */\n\tmmu_context_init();\n\n\t/* Interrupt code needs to be 64K-aligned. */\n\tif (IS_ENABLED(CONFIG_PPC64) && (unsigned long)_stext & 0xffff)\n\t\tpanic(\"Kernelbase not 64K-aligned (0x%lx)!\\n\",\n\t\t      (unsigned long)_stext);\n}"
  },
  {
    "function_name": "smp_setup_pacas",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "836-849",
    "snippet": "static void smp_setup_pacas(void)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tif (cpu == smp_processor_id())\n\t\t\tcontinue;\n\t\tallocate_paca(cpu);\n\t\tset_hard_smp_processor_id(cpu, cpu_to_phys_id[cpu]);\n\t}\n\n\tmemblock_free(__pa(cpu_to_phys_id), nr_cpu_ids * sizeof(u32));\n\tcpu_to_phys_id = NULL;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memblock_free",
          "args": [
            "__pa(cpu_to_phys_id)",
            "nr_cpu_ids * sizeof(u32)"
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__pa",
          "args": [
            "cpu_to_phys_id"
          ],
          "line": 847
        },
        "resolved": true,
        "details": {
          "function_name": "__parse_fpscr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/traps.c",
          "lines": "1164-1189",
          "snippet": "static inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/nmi.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/kprobes.h>",
            "#include <sysdev/fsl_pci.h>",
            "#include <asm/hmi.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/fadump.h>",
            "#include <asm/rio.h>",
            "#include <asm/ppc-opcode.h>",
            "#include <asm/kexec.h>",
            "#include <asm/tm.h>",
            "#include <asm/processor.h>",
            "#include <asm/firmware.h>",
            "#include <asm/backlight.h>",
            "#include <asm/reg.h>",
            "#include <asm/pmc.h>",
            "#include <asm/rtas.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/emulated_ops.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/console.h>",
            "#include <linux/smp.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/bug.h>",
            "#include <linux/backlight.h>",
            "#include <linux/kexec.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/delay.h>",
            "#include <linux/prctl.h>",
            "#include <linux/module.h>\t/* print_modules */",
            "#include <linux/extable.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/user.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/nmi.h>\n#include <asm/stacktrace.h>\n#include <asm/kprobes.h>\n#include <sysdev/fsl_pci.h>\n#include <asm/hmi.h>\n#include <asm/asm-prototypes.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/fadump.h>\n#include <asm/rio.h>\n#include <asm/ppc-opcode.h>\n#include <asm/kexec.h>\n#include <asm/tm.h>\n#include <asm/processor.h>\n#include <asm/firmware.h>\n#include <asm/backlight.h>\n#include <asm/reg.h>\n#include <asm/pmc.h>\n#include <asm/rtas.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/uaccess.h>\n#include <asm/emulated_ops.h>\n#include <linux/kmsg_dump.h>\n#include <linux/console.h>\n#include <linux/smp.h>\n#include <linux/context_tracking.h>\n#include <linux/ratelimit.h>\n#include <linux/kdebug.h>\n#include <linux/bug.h>\n#include <linux/backlight.h>\n#include <linux/kexec.h>\n#include <linux/kprobes.h>\n#include <linux/delay.h>\n#include <linux/prctl.h>\n#include <linux/module.h>\t/* print_modules */\n#include <linux/extable.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/user.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/pkeys.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_hard_smp_processor_id",
          "args": [
            "cpu",
            "cpu_to_phys_id[cpu]"
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allocate_paca",
          "args": [
            "cpu"
          ],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "allocate_paca",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/paca.c",
          "lines": "285-317",
          "snippet": "void __init allocate_paca(int cpu)\n{\n\tu64 limit;\n\tstruct paca_struct *paca;\n\n\tBUG_ON(cpu >= paca_nr_cpu_ids);\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\t/*\n\t * We access pacas in real mode, and cannot take SLB faults\n\t * on them when in virtual mode, so allocate them accordingly.\n\t */\n\tlimit = min(ppc64_bolted_size(), ppc64_rma_size);\n#else\n\tlimit = ppc64_rma_size;\n#endif\n\n\tpaca = alloc_paca_data(sizeof(struct paca_struct), L1_CACHE_BYTES,\n\t\t\t\tlimit, cpu);\n\tpaca_ptrs[cpu] = paca;\n\n\tinitialise_paca(paca, cpu);\n#ifdef CONFIG_PPC_PSERIES\n\tpaca->lppaca_ptr = new_lppaca(cpu, limit);\n#endif\n#ifdef CONFIG_PPC_BOOK3S_64\n\tpaca->slb_shadow_ptr = new_slb_shadow(cpu, limit);\n#endif\n#ifdef CONFIG_PPC_PSERIES\n\tpaca->rtas_args_reentrant = new_rtas_args(cpu, limit);\n#endif\n\tpaca_struct_size += sizeof(struct paca_struct);\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/rtas.h>",
            "#include <asm/ultravisor.h>",
            "#include <asm/svm.h>",
            "#include <asm/kexec.h>",
            "#include <asm/sections.h>",
            "#include <asm/paca.h>",
            "#include <asm/lppaca.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/numa.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/memblock.h>",
            "#include <linux/export.h>",
            "#include <linux/smp.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/rtas.h>\n#include <asm/ultravisor.h>\n#include <asm/svm.h>\n#include <asm/kexec.h>\n#include <asm/sections.h>\n#include <asm/paca.h>\n#include <asm/lppaca.h>\n#include <linux/pgtable.h>\n#include <linux/numa.h>\n#include <linux/sched/task.h>\n#include <linux/memblock.h>\n#include <linux/export.h>\n#include <linux/smp.h>\n\nvoid __init;\n\nvoid __init allocate_paca(int cpu)\n{\n\tu64 limit;\n\tstruct paca_struct *paca;\n\n\tBUG_ON(cpu >= paca_nr_cpu_ids);\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\t/*\n\t * We access pacas in real mode, and cannot take SLB faults\n\t * on them when in virtual mode, so allocate them accordingly.\n\t */\n\tlimit = min(ppc64_bolted_size(), ppc64_rma_size);\n#else\n\tlimit = ppc64_rma_size;\n#endif\n\n\tpaca = alloc_paca_data(sizeof(struct paca_struct), L1_CACHE_BYTES,\n\t\t\t\tlimit, cpu);\n\tpaca_ptrs[cpu] = paca;\n\n\tinitialise_paca(paca, cpu);\n#ifdef CONFIG_PPC_PSERIES\n\tpaca->lppaca_ptr = new_lppaca(cpu, limit);\n#endif\n#ifdef CONFIG_PPC_BOOK3S_64\n\tpaca->slb_shadow_ptr = new_slb_shadow(cpu, limit);\n#endif\n#ifdef CONFIG_PPC_PSERIES\n\tpaca->rtas_args_reentrant = new_rtas_args(cpu, limit);\n#endif\n\tpaca_struct_size += sizeof(struct paca_struct);\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void smp_setup_pacas(void)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tif (cpu == smp_processor_id())\n\t\t\tcontinue;\n\t\tallocate_paca(cpu);\n\t\tset_hard_smp_processor_id(cpu, cpu_to_phys_id[cpu]);\n\t}\n\n\tmemblock_free(__pa(cpu_to_phys_id), nr_cpu_ids * sizeof(u32));\n\tcpu_to_phys_id = NULL;\n}"
  },
  {
    "function_name": "print_system_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "797-833",
    "snippet": "static __init void print_system_info(void)\n{\n\tpr_info(\"-----------------------------------------------------\\n\");\n\tpr_info(\"phys_mem_size     = 0x%llx\\n\",\n\t\t(unsigned long long)memblock_phys_mem_size());\n\n\tpr_info(\"dcache_bsize      = 0x%x\\n\", dcache_bsize);\n\tpr_info(\"icache_bsize      = 0x%x\\n\", icache_bsize);\n\tif (ucache_bsize != 0)\n\t\tpr_info(\"ucache_bsize      = 0x%x\\n\", ucache_bsize);\n\n\tpr_info(\"cpu_features      = 0x%016lx\\n\", cur_cpu_spec->cpu_features);\n\tpr_info(\"  possible        = 0x%016lx\\n\",\n\t\t(unsigned long)CPU_FTRS_POSSIBLE);\n\tpr_info(\"  always          = 0x%016lx\\n\",\n\t\t(unsigned long)CPU_FTRS_ALWAYS);\n\tpr_info(\"cpu_user_features = 0x%08x 0x%08x\\n\",\n\t\tcur_cpu_spec->cpu_user_features,\n\t\tcur_cpu_spec->cpu_user_features2);\n\tpr_info(\"mmu_features      = 0x%08x\\n\", cur_cpu_spec->mmu_features);\n#ifdef CONFIG_PPC64\n\tpr_info(\"firmware_features = 0x%016lx\\n\", powerpc_firmware_features);\n#ifdef CONFIG_PPC_BOOK3S\n\tpr_info(\"vmalloc start     = 0x%lx\\n\", KERN_VIRT_START);\n\tpr_info(\"IO start          = 0x%lx\\n\", KERN_IO_START);\n\tpr_info(\"vmemmap start     = 0x%lx\\n\", (unsigned long)vmemmap);\n#endif\n#endif\n\n\tif (!early_radix_enabled())\n\t\tprint_system_hash_info();\n\n\tif (PHYSICAL_START > 0)\n\t\tpr_info(\"physical_start    = 0x%llx\\n\",\n\t\t       (unsigned long long)PHYSICAL_START);\n\tpr_info(\"-----------------------------------------------------\\n\");\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int dcache_bsize;",
      "int icache_bsize;",
      "int ucache_bsize;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"-----------------------------------------------------\\n\""
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"physical_start    = 0x%llx\\n\"",
            "(unsigned long long)PHYSICAL_START"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_system_hash_info",
          "args": [],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_radix_enabled",
          "args": [],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"vmemmap start     = 0x%lx\\n\"",
            "(unsigned long)vmemmap"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"IO start          = 0x%lx\\n\"",
            "KERN_IO_START"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"vmalloc start     = 0x%lx\\n\"",
            "KERN_VIRT_START"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"firmware_features = 0x%016lx\\n\"",
            "powerpc_firmware_features"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"mmu_features      = 0x%08x\\n\"",
            "cur_cpu_spec->mmu_features"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"cpu_user_features = 0x%08x 0x%08x\\n\"",
            "cur_cpu_spec->cpu_user_features",
            "cur_cpu_spec->cpu_user_features2"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"  always          = 0x%016lx\\n\"",
            "(unsigned long)CPU_FTRS_ALWAYS"
          ],
          "line": 811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"  possible        = 0x%016lx\\n\"",
            "(unsigned long)CPU_FTRS_POSSIBLE"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"cpu_features      = 0x%016lx\\n\"",
            "cur_cpu_spec->cpu_features"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"ucache_bsize      = 0x%x\\n\"",
            "ucache_bsize"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"icache_bsize      = 0x%x\\n\"",
            "icache_bsize"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"dcache_bsize      = 0x%x\\n\"",
            "dcache_bsize"
          ],
          "line": 803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"phys_mem_size     = 0x%llx\\n\"",
            "(unsigned long long)memblock_phys_mem_size()"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_phys_mem_size",
          "args": [],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"-----------------------------------------------------\\n\""
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nint dcache_bsize;\nint icache_bsize;\nint ucache_bsize;\n\nstatic __init void print_system_info(void)\n{\n\tpr_info(\"-----------------------------------------------------\\n\");\n\tpr_info(\"phys_mem_size     = 0x%llx\\n\",\n\t\t(unsigned long long)memblock_phys_mem_size());\n\n\tpr_info(\"dcache_bsize      = 0x%x\\n\", dcache_bsize);\n\tpr_info(\"icache_bsize      = 0x%x\\n\", icache_bsize);\n\tif (ucache_bsize != 0)\n\t\tpr_info(\"ucache_bsize      = 0x%x\\n\", ucache_bsize);\n\n\tpr_info(\"cpu_features      = 0x%016lx\\n\", cur_cpu_spec->cpu_features);\n\tpr_info(\"  possible        = 0x%016lx\\n\",\n\t\t(unsigned long)CPU_FTRS_POSSIBLE);\n\tpr_info(\"  always          = 0x%016lx\\n\",\n\t\t(unsigned long)CPU_FTRS_ALWAYS);\n\tpr_info(\"cpu_user_features = 0x%08x 0x%08x\\n\",\n\t\tcur_cpu_spec->cpu_user_features,\n\t\tcur_cpu_spec->cpu_user_features2);\n\tpr_info(\"mmu_features      = 0x%08x\\n\", cur_cpu_spec->mmu_features);\n#ifdef CONFIG_PPC64\n\tpr_info(\"firmware_features = 0x%016lx\\n\", powerpc_firmware_features);\n#ifdef CONFIG_PPC_BOOK3S\n\tpr_info(\"vmalloc start     = 0x%lx\\n\", KERN_VIRT_START);\n\tpr_info(\"IO start          = 0x%lx\\n\", KERN_IO_START);\n\tpr_info(\"vmemmap start     = 0x%lx\\n\", (unsigned long)vmemmap);\n#endif\n#endif\n\n\tif (!early_radix_enabled())\n\t\tprint_system_hash_info();\n\n\tif (PHYSICAL_START > 0)\n\t\tpr_info(\"physical_start    = 0x%llx\\n\",\n\t\t       (unsigned long long)PHYSICAL_START);\n\tpr_info(\"-----------------------------------------------------\\n\");\n}"
  },
  {
    "function_name": "ppc_printk_progress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "792-795",
    "snippet": "void ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"%s\\n\"",
            "s"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}"
  },
  {
    "function_name": "powerpc_debugfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "784-788",
    "snippet": "static int powerpc_debugfs_init(void)\n{\n\tpowerpc_debugfs_root = debugfs_create_dir(\"powerpc\", NULL);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "\"powerpc\"",
            "NULL"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic int powerpc_debugfs_init(void)\n{\n\tpowerpc_debugfs_root = debugfs_create_dir(\"powerpc\", NULL);\n\treturn 0;\n}"
  },
  {
    "function_name": "check_cache_coherency",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "754-775",
    "snippet": "static int __init check_cache_coherency(void)\n{\n\tstruct device_node *np;\n\tconst void *prop;\n\tbool devtree_coherency;\n\n\tnp = of_find_node_by_path(\"/\");\n\tprop = of_get_property(np, \"coherency-off\", NULL);\n\tof_node_put(np);\n\n\tdevtree_coherency = prop ? false : true;\n\n\tif (devtree_coherency != KERNEL_COHERENCY) {\n\t\tprintk(KERN_ERR\n\t\t\t\"kernel coherency:%s != device tree_coherency:%s\\n\",\n\t\t\tKERNEL_COHERENCY ? \"on\" : \"off\",\n\t\t\tdevtree_coherency ? \"on\" : \"off\");\n\t\tBUG();\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define KERNEL_COHERENCY\t(!IS_ENABLED(CONFIG_NOT_COHERENT_CACHE))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR\n\t\t\t\"kernel coherency:%s != device tree_coherency:%s\\n\"",
            "KERNEL_COHERENCY ? \"on\" : \"off\"",
            "devtree_coherency ? \"on\" : \"off\""
          ],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "\"coherency-off\"",
            "NULL"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_path",
          "args": [
            "\"/\""
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\n#define KERNEL_COHERENCY\t(!IS_ENABLED(CONFIG_NOT_COHERENT_CACHE))\n\nstatic int __init check_cache_coherency(void)\n{\n\tstruct device_node *np;\n\tconst void *prop;\n\tbool devtree_coherency;\n\n\tnp = of_find_node_by_path(\"/\");\n\tprop = of_get_property(np, \"coherency-off\", NULL);\n\tof_node_put(np);\n\n\tdevtree_coherency = prop ? false : true;\n\n\tif (devtree_coherency != KERNEL_COHERENCY) {\n\t\tprintk(KERN_ERR\n\t\t\t\"kernel coherency:%s != device tree_coherency:%s\\n\",\n\t\t\tKERNEL_COHERENCY ? \"on\" : \"off\",\n\t\t\tdevtree_coherency ? \"on\" : \"off\");\n\t\tBUG();\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "setup_panic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "731-741",
    "snippet": "void __init setup_panic(void)\n{\n\tif (IS_ENABLED(CONFIG_RANDOMIZE_BASE) && kaslr_offset() > 0)\n\t\tatomic_notifier_chain_register(&panic_notifier_list,\n\t\t\t\t\t       &kernel_offset_notifier);\n\n\t/* PPC64 always does a hard irq disable in its panic handler */\n\tif (!IS_ENABLED(CONFIG_PPC64) && !ppc_md.panic)\n\t\treturn;\n\tatomic_notifier_chain_register(&panic_notifier_list, &ppc_panic_block);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;",
      "static struct notifier_block ppc_panic_block = {\n\t.notifier_call = ppc_panic_event,\n\t.priority = INT_MIN /* may not return; must be done last */\n};",
      "static struct notifier_block kernel_offset_notifier = {\n\t.notifier_call = dump_kernel_offset\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_notifier_chain_register",
          "args": [
            "&panic_notifier_list",
            "&ppc_panic_block"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC64"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_notifier_chain_register",
          "args": [
            "&panic_notifier_list",
            "&kernel_offset_notifier"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kaslr_offset",
          "args": [],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_RANDOMIZE_BASE"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\nstatic struct notifier_block ppc_panic_block = {\n\t.notifier_call = ppc_panic_event,\n\t.priority = INT_MIN /* may not return; must be done last */\n};\nstatic struct notifier_block kernel_offset_notifier = {\n\t.notifier_call = dump_kernel_offset\n};\n\nvoid __init setup_panic(void)\n{\n\tif (IS_ENABLED(CONFIG_RANDOMIZE_BASE) && kaslr_offset() > 0)\n\t\tatomic_notifier_chain_register(&panic_notifier_list,\n\t\t\t\t\t       &kernel_offset_notifier);\n\n\t/* PPC64 always does a hard irq disable in its panic handler */\n\tif (!IS_ENABLED(CONFIG_PPC64) && !ppc_md.panic)\n\t\treturn;\n\tatomic_notifier_chain_register(&panic_notifier_list, &ppc_panic_block);\n}"
  },
  {
    "function_name": "dump_kernel_offset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "718-725",
    "snippet": "static int dump_kernel_offset(struct notifier_block *self, unsigned long v,\n\t\t\t      void *p)\n{\n\tpr_emerg(\"Kernel Offset: 0x%lx from 0x%lx\\n\",\n\t\t kaslr_offset(), KERNELBASE);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_emerg",
          "args": [
            "\"Kernel Offset: 0x%lx from 0x%lx\\n\"",
            "kaslr_offset()",
            "KERNELBASE"
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kaslr_offset",
          "args": [],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic int dump_kernel_offset(struct notifier_block *self, unsigned long v,\n\t\t\t      void *p)\n{\n\tpr_emerg(\"Kernel Offset: 0x%lx from 0x%lx\\n\",\n\t\t kaslr_offset(), KERNELBASE);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ppc_panic_event",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "691-708",
    "snippet": "static int ppc_panic_event(struct notifier_block *this,\n                             unsigned long event, void *ptr)\n{\n\t/*\n\t * panic does a local_irq_disable, but we really\n\t * want interrupts to be hard disabled.\n\t */\n\thard_irq_disable();\n\n\t/*\n\t * If firmware-assisted dump has been registered then trigger\n\t * firmware-assisted dump and let firmware handle everything else.\n\t */\n\tcrash_fadump(NULL, ptr);\n\tif (ppc_md.panic)\n\t\tppc_md.panic(ptr);  /* May not return */\n\treturn NOTIFY_DONE;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.panic",
          "args": [
            "ptr"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crash_fadump",
          "args": [
            "NULL",
            "ptr"
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "crash_fadump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/fadump.c",
          "lines": "680-738",
          "snippet": "void crash_fadump(struct pt_regs *regs, const char *str)\n{\n\tunsigned int msecs;\n\tstruct fadump_crash_info_header *fdh = NULL;\n\tint old_cpu, this_cpu;\n\t/* Do not include first CPU */\n\tunsigned int ncpus = num_online_cpus() - 1;\n\n\tif (!should_fadump_crash())\n\t\treturn;\n\n\t/*\n\t * old_cpu == -1 means this is the first CPU which has come here,\n\t * go ahead and trigger fadump.\n\t *\n\t * old_cpu != -1 means some other CPU has already on it's way\n\t * to trigger fadump, just keep looping here.\n\t */\n\tthis_cpu = smp_processor_id();\n\told_cpu = cmpxchg(&crashing_cpu, -1, this_cpu);\n\n\tif (old_cpu != -1) {\n\t\tatomic_inc(&cpus_in_fadump);\n\n\t\t/*\n\t\t * We can't loop here indefinitely. Wait as long as fadump\n\t\t * is in force. If we race with fadump un-registration this\n\t\t * loop will break and then we go down to normal panic path\n\t\t * and reboot. If fadump is in force the first crashing\n\t\t * cpu will definitely trigger fadump.\n\t\t */\n\t\twhile (fw_dump.dump_registered)\n\t\t\tcpu_relax();\n\t\treturn;\n\t}\n\n\tfdh = __va(fw_dump.fadumphdr_addr);\n\tfdh->crashing_cpu = crashing_cpu;\n\tcrash_save_vmcoreinfo();\n\n\tif (regs)\n\t\tfdh->regs = *regs;\n\telse\n\t\tppc_save_regs(&fdh->regs);\n\n\tfdh->online_mask = *cpu_online_mask;\n\n\t/*\n\t * If we came in via system reset, wait a while for the secondary\n\t * CPUs to enter.\n\t */\n\tif (TRAP(&(fdh->regs)) == 0x100) {\n\t\tmsecs = CRASH_TIMEOUT;\n\t\twhile ((atomic_read(&cpus_in_fadump) < ncpus) && (--msecs > 0))\n\t\t\tmdelay(1);\n\t}\n\n\tfw_dump.ops->fadump_trigger(fdh, str);\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/fadump-internal.h>",
            "#include <asm/fadump.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/cma.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/crash_dump.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/delay.h>",
            "#include <linux/memblock.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [
            "#define CRASH_TIMEOUT\t\t500"
          ],
          "globals_used": [
            "static struct fw_dump fw_dump;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/fadump-internal.h>\n#include <asm/fadump.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/debugfs.h>\n#include <linux/hugetlb.h>\n#include <linux/cma.h>\n#include <linux/slab.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/crash_dump.h>\n#include <linux/seq_file.h>\n#include <linux/delay.h>\n#include <linux/memblock.h>\n#include <linux/string.h>\n\n#define CRASH_TIMEOUT\t\t500\n\nstatic struct fw_dump fw_dump;\n\nvoid crash_fadump(struct pt_regs *regs, const char *str)\n{\n\tunsigned int msecs;\n\tstruct fadump_crash_info_header *fdh = NULL;\n\tint old_cpu, this_cpu;\n\t/* Do not include first CPU */\n\tunsigned int ncpus = num_online_cpus() - 1;\n\n\tif (!should_fadump_crash())\n\t\treturn;\n\n\t/*\n\t * old_cpu == -1 means this is the first CPU which has come here,\n\t * go ahead and trigger fadump.\n\t *\n\t * old_cpu != -1 means some other CPU has already on it's way\n\t * to trigger fadump, just keep looping here.\n\t */\n\tthis_cpu = smp_processor_id();\n\told_cpu = cmpxchg(&crashing_cpu, -1, this_cpu);\n\n\tif (old_cpu != -1) {\n\t\tatomic_inc(&cpus_in_fadump);\n\n\t\t/*\n\t\t * We can't loop here indefinitely. Wait as long as fadump\n\t\t * is in force. If we race with fadump un-registration this\n\t\t * loop will break and then we go down to normal panic path\n\t\t * and reboot. If fadump is in force the first crashing\n\t\t * cpu will definitely trigger fadump.\n\t\t */\n\t\twhile (fw_dump.dump_registered)\n\t\t\tcpu_relax();\n\t\treturn;\n\t}\n\n\tfdh = __va(fw_dump.fadumphdr_addr);\n\tfdh->crashing_cpu = crashing_cpu;\n\tcrash_save_vmcoreinfo();\n\n\tif (regs)\n\t\tfdh->regs = *regs;\n\telse\n\t\tppc_save_regs(&fdh->regs);\n\n\tfdh->online_mask = *cpu_online_mask;\n\n\t/*\n\t * If we came in via system reset, wait a while for the secondary\n\t * CPUs to enter.\n\t */\n\tif (TRAP(&(fdh->regs)) == 0x100) {\n\t\tmsecs = CRASH_TIMEOUT;\n\t\twhile ((atomic_read(&cpus_in_fadump) < ncpus) && (--msecs > 0))\n\t\t\tmdelay(1);\n\t}\n\n\tfw_dump.ops->fadump_trigger(fdh, str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hard_irq_disable",
          "args": [],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nstatic int ppc_panic_event(struct notifier_block *this,\n                             unsigned long event, void *ptr)\n{\n\t/*\n\t * panic does a local_irq_disable, but we really\n\t * want interrupts to be hard disabled.\n\t */\n\thard_irq_disable();\n\n\t/*\n\t * If firmware-assisted dump has been registered then trigger\n\t * firmware-assisted dump and let firmware handle everything else.\n\t */\n\tcrash_fadump(NULL, ptr);\n\tif (ppc_md.panic)\n\t\tppc_md.panic(ptr);  /* May not return */\n\treturn NOTIFY_DONE;\n}"
  },
  {
    "function_name": "check_legacy_ioport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "637-688",
    "snippet": "int check_legacy_ioport(unsigned long base_port)\n{\n\tstruct device_node *parent, *np = NULL;\n\tint ret = -ENODEV;\n\n\tswitch(base_port) {\n\tcase I8042_DATA_REG:\n\t\tif (!(np = of_find_compatible_node(NULL, NULL, \"pnpPNP,303\")))\n\t\t\tnp = of_find_compatible_node(NULL, NULL, \"pnpPNP,f03\");\n\t\tif (np) {\n\t\t\tparent = of_get_parent(np);\n\n\t\t\tof_i8042_kbd_irq = irq_of_parse_and_map(parent, 0);\n\t\t\tif (!of_i8042_kbd_irq)\n\t\t\t\tof_i8042_kbd_irq = 1;\n\n\t\t\tof_i8042_aux_irq = irq_of_parse_and_map(parent, 1);\n\t\t\tif (!of_i8042_aux_irq)\n\t\t\t\tof_i8042_aux_irq = 12;\n\n\t\t\tof_node_put(np);\n\t\t\tnp = parent;\n\t\t\tbreak;\n\t\t}\n\t\tnp = of_find_node_by_type(NULL, \"8042\");\n\t\t/* Pegasos has no device_type on its 8042 node, look for the\n\t\t * name instead */\n\t\tif (!np)\n\t\t\tnp = of_find_node_by_name(NULL, \"8042\");\n\t\tif (np) {\n\t\t\tof_i8042_kbd_irq = 1;\n\t\t\tof_i8042_aux_irq = 12;\n\t\t}\n\t\tbreak;\n\tcase FDC_BASE: /* FDC1 */\n\t\tnp = of_find_node_by_type(NULL, \"fdc\");\n\t\tbreak;\n\tdefault:\n\t\t/* ipmi is supposed to fail here */\n\t\tbreak;\n\t}\n\tif (!np)\n\t\treturn ret;\n\tparent = of_get_parent(np);\n\tif (parent) {\n\t\tif (of_node_is_type(parent, \"isa\"))\n\t\t\tret = 0;\n\t\tof_node_put(parent);\n\t}\n\tof_node_put(np);\n\treturn ret;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int of_i8042_kbd_irq;",
      "int of_i8042_aux_irq;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "parent"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_is_type",
          "args": [
            "parent",
            "\"isa\""
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_parent",
          "args": [
            "np"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_type",
          "args": [
            "NULL",
            "\"fdc\""
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_name",
          "args": [
            "NULL",
            "\"8042\""
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_type",
          "args": [
            "NULL",
            "\"8042\""
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_of_parse_and_map",
          "args": [
            "parent",
            "1"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_of_parse_and_map",
          "args": [
            "parent",
            "0"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_parent",
          "args": [
            "np"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_compatible_node",
          "args": [
            "NULL",
            "NULL",
            "\"pnpPNP,f03\""
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_compatible_node",
          "args": [
            "NULL",
            "NULL",
            "\"pnpPNP,303\""
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nint of_i8042_kbd_irq;\nint of_i8042_aux_irq;\n\nint check_legacy_ioport(unsigned long base_port)\n{\n\tstruct device_node *parent, *np = NULL;\n\tint ret = -ENODEV;\n\n\tswitch(base_port) {\n\tcase I8042_DATA_REG:\n\t\tif (!(np = of_find_compatible_node(NULL, NULL, \"pnpPNP,303\")))\n\t\t\tnp = of_find_compatible_node(NULL, NULL, \"pnpPNP,f03\");\n\t\tif (np) {\n\t\t\tparent = of_get_parent(np);\n\n\t\t\tof_i8042_kbd_irq = irq_of_parse_and_map(parent, 0);\n\t\t\tif (!of_i8042_kbd_irq)\n\t\t\t\tof_i8042_kbd_irq = 1;\n\n\t\t\tof_i8042_aux_irq = irq_of_parse_and_map(parent, 1);\n\t\t\tif (!of_i8042_aux_irq)\n\t\t\t\tof_i8042_aux_irq = 12;\n\n\t\t\tof_node_put(np);\n\t\t\tnp = parent;\n\t\t\tbreak;\n\t\t}\n\t\tnp = of_find_node_by_type(NULL, \"8042\");\n\t\t/* Pegasos has no device_type on its 8042 node, look for the\n\t\t * name instead */\n\t\tif (!np)\n\t\t\tnp = of_find_node_by_name(NULL, \"8042\");\n\t\tif (np) {\n\t\t\tof_i8042_kbd_irq = 1;\n\t\t\tof_i8042_aux_irq = 12;\n\t\t}\n\t\tbreak;\n\tcase FDC_BASE: /* FDC1 */\n\t\tnp = of_find_node_by_type(NULL, \"fdc\");\n\t\tbreak;\n\tdefault:\n\t\t/* ipmi is supposed to fail here */\n\t\tbreak;\n\t}\n\tif (!np)\n\t\treturn ret;\n\tparent = of_get_parent(np);\n\tif (parent) {\n\t\tif (of_node_is_type(parent, \"isa\"))\n\t\t\tret = 0;\n\t\tof_node_put(parent);\n\t}\n\tof_node_put(np);\n\treturn ret;\n}"
  },
  {
    "function_name": "probe_machine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "593-634",
    "snippet": "void probe_machine(void)\n{\n\textern struct machdep_calls __machine_desc_start;\n\textern struct machdep_calls __machine_desc_end;\n\tunsigned int i;\n\n\t/*\n\t * Iterate all ppc_md structures until we find the proper\n\t * one for the current machine type\n\t */\n\tDBG(\"Probing machine type ...\\n\");\n\n\t/*\n\t * Check ppc_md is empty, if not we have a bug, ie, we setup an\n\t * entry before probe_machine() which will be overwritten\n\t */\n\tfor (i = 0; i < (sizeof(ppc_md) / sizeof(void *)); i++) {\n\t\tif (((void **)&ppc_md)[i]) {\n\t\t\tprintk(KERN_ERR \"Entry %d in ppc_md non empty before\"\n\t\t\t       \" machine probe !\\n\", i);\n\t\t}\n\t}\n\n\tfor (machine_id = &__machine_desc_start;\n\t     machine_id < &__machine_desc_end;\n\t     machine_id++) {\n\t\tDBG(\"  %s ...\", machine_id->name);\n\t\tmemcpy(&ppc_md, machine_id, sizeof(struct machdep_calls));\n\t\tif (ppc_md.probe()) {\n\t\t\tDBG(\" match !\\n\");\n\t\t\tbreak;\n\t\t}\n\t\tDBG(\"\\n\");\n\t}\n\t/* What can we do if we didn't find ? */\n\tif (machine_id >= &__machine_desc_end) {\n\t\tpr_err(\"No suitable machine description found !\\n\");\n\t\tfor (;;);\n\t}\n\n\tprintk(KERN_INFO \"Using %s machine description\\n\", ppc_md.name);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;",
      "struct machdep_calls *machine_id;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"Using %s machine description\\n\"",
            "ppc_md.name"
          ],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "ppc_printk_progress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "792-795",
          "snippet": "void ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"No suitable machine description found !\\n\""
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"\\n\""
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" match !\\n\""
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.probe",
          "args": [],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&ppc_md",
            "machine_id",
            "sizeof(struct machdep_calls)"
          ],
          "line": 620
        },
        "resolved": true,
        "details": {
          "function_name": "_memcpy_toio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "181-205",
          "snippet": "void _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"  %s ...\"",
            "machine_id->name"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"Probing machine type ...\\n\""
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\nstruct machdep_calls *machine_id;\n\nvoid probe_machine(void)\n{\n\textern struct machdep_calls __machine_desc_start;\n\textern struct machdep_calls __machine_desc_end;\n\tunsigned int i;\n\n\t/*\n\t * Iterate all ppc_md structures until we find the proper\n\t * one for the current machine type\n\t */\n\tDBG(\"Probing machine type ...\\n\");\n\n\t/*\n\t * Check ppc_md is empty, if not we have a bug, ie, we setup an\n\t * entry before probe_machine() which will be overwritten\n\t */\n\tfor (i = 0; i < (sizeof(ppc_md) / sizeof(void *)); i++) {\n\t\tif (((void **)&ppc_md)[i]) {\n\t\t\tprintk(KERN_ERR \"Entry %d in ppc_md non empty before\"\n\t\t\t       \" machine probe !\\n\", i);\n\t\t}\n\t}\n\n\tfor (machine_id = &__machine_desc_start;\n\t     machine_id < &__machine_desc_end;\n\t     machine_id++) {\n\t\tDBG(\"  %s ...\", machine_id->name);\n\t\tmemcpy(&ppc_md, machine_id, sizeof(struct machdep_calls));\n\t\tif (ppc_md.probe()) {\n\t\t\tDBG(\" match !\\n\");\n\t\t\tbreak;\n\t\t}\n\t\tDBG(\"\\n\");\n\t}\n\t/* What can we do if we didn't find ? */\n\tif (machine_id >= &__machine_desc_end) {\n\t\tpr_err(\"No suitable machine description found !\\n\");\n\t\tfor (;;);\n\t}\n\n\tprintk(KERN_INFO \"Using %s machine description\\n\", ppc_md.name);\n}"
  },
  {
    "function_name": "add_pcspkr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "569-589",
    "snippet": "static __init int add_pcspkr(void)\n{\n\tstruct device_node *np;\n\tstruct platform_device *pd;\n\tint ret;\n\n\tnp = of_find_compatible_node(NULL, NULL, \"pnpPNP,100\");\n\tof_node_put(np);\n\tif (!np)\n\t\treturn -ENODEV;\n\n\tpd = platform_device_alloc(\"pcspkr\", -1);\n\tif (!pd)\n\t\treturn -ENOMEM;\n\n\tret = platform_device_add(pd);\n\tif (ret)\n\t\tplatform_device_put(pd);\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "platform_device_put",
          "args": [
            "pd"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "platform_device_add",
          "args": [
            "pd"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "platform_device_alloc",
          "args": [
            "\"pcspkr\"",
            "-1"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_compatible_node",
          "args": [
            "NULL",
            "NULL",
            "\"pnpPNP,100\""
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic __init int add_pcspkr(void)\n{\n\tstruct device_node *np;\n\tstruct platform_device *pd;\n\tint ret;\n\n\tnp = of_find_compatible_node(NULL, NULL, \"pnpPNP,100\");\n\tof_node_put(np);\n\tif (!np)\n\t\treturn -ENODEV;\n\n\tpd = platform_device_alloc(\"pcspkr\", -1);\n\tif (!pd)\n\t\treturn -ENOMEM;\n\n\tret = platform_device_add(pd);\n\tif (ret)\n\t\tplatform_device_put(pd);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "smp_setup_cpu_maps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "443-565",
    "snippet": "void __init smp_setup_cpu_maps(void)\n{\n\tstruct device_node *dn;\n\tint cpu = 0;\n\tint nthreads = 1;\n\n\tDBG(\"smp_setup_cpu_maps()\\n\");\n\n\tcpu_to_phys_id = memblock_alloc(nr_cpu_ids * sizeof(u32),\n\t\t\t\t\t__alignof__(u32));\n\tif (!cpu_to_phys_id)\n\t\tpanic(\"%s: Failed to allocate %zu bytes align=0x%zx\\n\",\n\t\t      __func__, nr_cpu_ids * sizeof(u32), __alignof__(u32));\n\n\tfor_each_node_by_type(dn, \"cpu\") {\n\t\tconst __be32 *intserv;\n\t\t__be32 cpu_be;\n\t\tint j, len;\n\n\t\tDBG(\"  * %pOF...\\n\", dn);\n\n\t\tintserv = of_get_property(dn, \"ibm,ppc-interrupt-server#s\",\n\t\t\t\t&len);\n\t\tif (intserv) {\n\t\t\tDBG(\"    ibm,ppc-interrupt-server#s -> %d threads\\n\",\n\t\t\t    nthreads);\n\t\t} else {\n\t\t\tDBG(\"    no ibm,ppc-interrupt-server#s -> 1 thread\\n\");\n\t\t\tintserv = of_get_property(dn, \"reg\", &len);\n\t\t\tif (!intserv) {\n\t\t\t\tcpu_be = cpu_to_be32(cpu);\n\t\t\t\t/* XXX: what is this? uninitialized?? */\n\t\t\t\tintserv = &cpu_be;\t/* assume logical == phys */\n\t\t\t\tlen = 4;\n\t\t\t}\n\t\t}\n\n\t\tnthreads = len / sizeof(int);\n\n\t\tfor (j = 0; j < nthreads && cpu < nr_cpu_ids; j++) {\n\t\t\tbool avail;\n\n\t\t\tDBG(\"    thread %d -> cpu %d (hard id %d)\\n\",\n\t\t\t    j, cpu, be32_to_cpu(intserv[j]));\n\n\t\t\tavail = of_device_is_available(dn);\n\t\t\tif (!avail)\n\t\t\t\tavail = !of_property_match_string(dn,\n\t\t\t\t\t\t\"enable-method\", \"spin-table\");\n\n\t\t\tset_cpu_present(cpu, avail);\n\t\t\tset_cpu_possible(cpu, true);\n\t\t\tcpu_to_phys_id[cpu] = be32_to_cpu(intserv[j]);\n\t\t\tcpu++;\n\t\t}\n\n\t\tif (cpu >= nr_cpu_ids) {\n\t\t\tof_node_put(dn);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* If no SMT supported, nthreads is forced to 1 */\n\tif (!cpu_has_feature(CPU_FTR_SMT)) {\n\t\tDBG(\"  SMT disabled ! nthreads forced to 1\\n\");\n\t\tnthreads = 1;\n\t}\n\n#ifdef CONFIG_PPC64\n\t/*\n\t * On pSeries LPAR, we need to know how many cpus\n\t * could possibly be added to this partition.\n\t */\n\tif (firmware_has_feature(FW_FEATURE_LPAR) &&\n\t    (dn = of_find_node_by_path(\"/rtas\"))) {\n\t\tint num_addr_cell, num_size_cell, maxcpus;\n\t\tconst __be32 *ireg;\n\n\t\tnum_addr_cell = of_n_addr_cells(dn);\n\t\tnum_size_cell = of_n_size_cells(dn);\n\n\t\tireg = of_get_property(dn, \"ibm,lrdr-capacity\", NULL);\n\n\t\tif (!ireg)\n\t\t\tgoto out;\n\n\t\tmaxcpus = be32_to_cpup(ireg + num_addr_cell + num_size_cell);\n\n\t\t/* Double maxcpus for processors which have SMT capability */\n\t\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\t\tmaxcpus *= nthreads;\n\n\t\tif (maxcpus > nr_cpu_ids) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"Partition configured for %d cpus, \"\n\t\t\t       \"operating system maximum is %u.\\n\",\n\t\t\t       maxcpus, nr_cpu_ids);\n\t\t\tmaxcpus = nr_cpu_ids;\n\t\t} else\n\t\t\tprintk(KERN_INFO \"Partition configured for %d cpus.\\n\",\n\t\t\t       maxcpus);\n\n\t\tfor (cpu = 0; cpu < maxcpus; cpu++)\n\t\t\tset_cpu_possible(cpu, true);\n\tout:\n\t\tof_node_put(dn);\n\t}\n\tvdso_data->processorCount = num_present_cpus();\n#endif /* CONFIG_PPC64 */\n\n        /* Initialize CPU <=> thread mapping/\n\t *\n\t * WARNING: We assume that the number of threads is the same for\n\t * every CPU in the system. If that is not the case, then some code\n\t * here will have to be reworked\n\t */\n\tcpu_init_thread_core_maps(nthreads);\n\n\t/* Now that possible cpus are set, set nr_cpu_ids for later use */\n\tsetup_nr_cpu_ids();\n\n\tfree_unused_pacas();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_unused_pacas",
          "args": [],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "free_unused_pacas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/paca.c",
          "lines": "319-342",
          "snippet": "void __init free_unused_pacas(void)\n{\n\tint new_ptrs_size;\n\n\tnew_ptrs_size = sizeof(struct paca_struct *) * nr_cpu_ids;\n\tif (new_ptrs_size < paca_ptrs_size)\n\t\tmemblock_free(__pa(paca_ptrs) + new_ptrs_size,\n\t\t\t\t\tpaca_ptrs_size - new_ptrs_size);\n\n\tpaca_nr_cpu_ids = nr_cpu_ids;\n\tpaca_ptrs_size = new_ptrs_size;\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\tif (early_radix_enabled()) {\n\t\t/* Ugly fixup, see new_slb_shadow() */\n\t\tmemblock_free(__pa(paca_ptrs[boot_cpuid]->slb_shadow_ptr),\n\t\t\t\tsizeof(struct slb_shadow));\n\t\tpaca_ptrs[boot_cpuid]->slb_shadow_ptr = NULL;\n\t}\n#endif\n\n\tprintk(KERN_DEBUG \"Allocated %u bytes for %u pacas\\n\",\n\t\t\tpaca_ptrs_size + paca_struct_size, nr_cpu_ids);\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/rtas.h>",
            "#include <asm/ultravisor.h>",
            "#include <asm/svm.h>",
            "#include <asm/kexec.h>",
            "#include <asm/sections.h>",
            "#include <asm/paca.h>",
            "#include <asm/lppaca.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/numa.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/memblock.h>",
            "#include <linux/export.h>",
            "#include <linux/smp.h>"
          ],
          "macros_used": [
            "#define boot_cpuid 0"
          ],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/rtas.h>\n#include <asm/ultravisor.h>\n#include <asm/svm.h>\n#include <asm/kexec.h>\n#include <asm/sections.h>\n#include <asm/paca.h>\n#include <asm/lppaca.h>\n#include <linux/pgtable.h>\n#include <linux/numa.h>\n#include <linux/sched/task.h>\n#include <linux/memblock.h>\n#include <linux/export.h>\n#include <linux/smp.h>\n\n#define boot_cpuid 0\n\nvoid __init;\n\nvoid __init free_unused_pacas(void)\n{\n\tint new_ptrs_size;\n\n\tnew_ptrs_size = sizeof(struct paca_struct *) * nr_cpu_ids;\n\tif (new_ptrs_size < paca_ptrs_size)\n\t\tmemblock_free(__pa(paca_ptrs) + new_ptrs_size,\n\t\t\t\t\tpaca_ptrs_size - new_ptrs_size);\n\n\tpaca_nr_cpu_ids = nr_cpu_ids;\n\tpaca_ptrs_size = new_ptrs_size;\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\tif (early_radix_enabled()) {\n\t\t/* Ugly fixup, see new_slb_shadow() */\n\t\tmemblock_free(__pa(paca_ptrs[boot_cpuid]->slb_shadow_ptr),\n\t\t\t\tsizeof(struct slb_shadow));\n\t\tpaca_ptrs[boot_cpuid]->slb_shadow_ptr = NULL;\n\t}\n#endif\n\n\tprintk(KERN_DEBUG \"Allocated %u bytes for %u pacas\\n\",\n\t\t\tpaca_ptrs_size + paca_struct_size, nr_cpu_ids);\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup_nr_cpu_ids",
          "args": [],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_init_thread_core_maps",
          "args": [
            "nthreads"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_init_thread_core_maps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "400-420",
          "snippet": "static void __init cpu_init_thread_core_maps(int tpc)\n{\n\tint i;\n\n\tthreads_per_core = tpc;\n\tthreads_per_subcore = tpc;\n\tcpumask_clear(&threads_core_mask);\n\n\t/* This implementation only supports power of 2 number of threads\n\t * for simplicity and performance\n\t */\n\tthreads_shift = ilog2(tpc);\n\tBUG_ON(tpc != (1 << threads_shift));\n\n\tfor (i = 0; i < tpc; i++)\n\t\tcpumask_set_cpu(i, &threads_core_mask);\n\n\tprintk(KERN_INFO \"CPU maps initialized for %d thread%s per core\\n\",\n\t       tpc, tpc > 1 ? \"s\" : \"\");\n\tprintk(KERN_DEBUG \" (thread shift is %d)\\n\", threads_shift);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void __init cpu_init_thread_core_maps(int tpc)\n{\n\tint i;\n\n\tthreads_per_core = tpc;\n\tthreads_per_subcore = tpc;\n\tcpumask_clear(&threads_core_mask);\n\n\t/* This implementation only supports power of 2 number of threads\n\t * for simplicity and performance\n\t */\n\tthreads_shift = ilog2(tpc);\n\tBUG_ON(tpc != (1 << threads_shift));\n\n\tfor (i = 0; i < tpc; i++)\n\t\tcpumask_set_cpu(i, &threads_core_mask);\n\n\tprintk(KERN_INFO \"CPU maps initialized for %d thread%s per core\\n\",\n\t       tpc, tpc > 1 ? \"s\" : \"\");\n\tprintk(KERN_DEBUG \" (thread shift is %d)\\n\", threads_shift);\n}"
        }
      },
      {
        "call_info": {
          "callee": "num_present_cpus",
          "args": [],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "dn"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_possible",
          "args": [
            "cpu",
            "true"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"Partition configured for %d cpus.\\n\"",
            "maxcpus"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "ppc_printk_progress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "792-795",
          "snippet": "void ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING\n\t\t\t       \"Partition configured for %d cpus, \"\n\t\t\t       \"operating system maximum is %u.\\n\"",
            "maxcpus",
            "nr_cpu_ids"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SMT"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "ireg + num_addr_cell + num_size_cell"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "dn",
            "\"ibm,lrdr-capacity\"",
            "NULL"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_n_size_cells",
          "args": [
            "dn"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_n_addr_cells",
          "args": [
            "dn"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_path",
          "args": [
            "\"/rtas\""
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"  SMT disabled ! nthreads forced to 1\\n\""
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SMT"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "dn"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "intserv[j]"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_possible",
          "args": [
            "cpu",
            "true"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_present",
          "args": [
            "cpu",
            "avail"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_property_match_string",
          "args": [
            "dn",
            "\"enable-method\"",
            "\"spin-table\""
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_device_is_available",
          "args": [
            "dn"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"    thread %d -> cpu %d (hard id %d)\\n\"",
            "j",
            "cpu",
            "be32_to_cpu(intserv[j])"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "intserv[j]"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "cpu"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "dn",
            "\"reg\"",
            "&len"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"    no ibm,ppc-interrupt-server#s -> 1 thread\\n\""
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"    ibm,ppc-interrupt-server#s -> %d threads\\n\"",
            "nthreads"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "dn",
            "\"ibm,ppc-interrupt-server#s\"",
            "&len"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"  * %pOF...\\n\"",
            "dn"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "for_each_node_by_type",
          "args": [
            "dn",
            "\"cpu\""
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"%s: Failed to allocate %zu bytes align=0x%zx\\n\"",
            "__func__",
            "nr_cpu_ids * sizeof(u32)",
            "__alignof__(u32)"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc",
          "args": [
            "nr_cpu_ids * sizeof(u32)",
            "__alignof__(u32)"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"smp_setup_cpu_maps()\\n\""
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init smp_setup_cpu_maps(void)\n{\n\tstruct device_node *dn;\n\tint cpu = 0;\n\tint nthreads = 1;\n\n\tDBG(\"smp_setup_cpu_maps()\\n\");\n\n\tcpu_to_phys_id = memblock_alloc(nr_cpu_ids * sizeof(u32),\n\t\t\t\t\t__alignof__(u32));\n\tif (!cpu_to_phys_id)\n\t\tpanic(\"%s: Failed to allocate %zu bytes align=0x%zx\\n\",\n\t\t      __func__, nr_cpu_ids * sizeof(u32), __alignof__(u32));\n\n\tfor_each_node_by_type(dn, \"cpu\") {\n\t\tconst __be32 *intserv;\n\t\t__be32 cpu_be;\n\t\tint j, len;\n\n\t\tDBG(\"  * %pOF...\\n\", dn);\n\n\t\tintserv = of_get_property(dn, \"ibm,ppc-interrupt-server#s\",\n\t\t\t\t&len);\n\t\tif (intserv) {\n\t\t\tDBG(\"    ibm,ppc-interrupt-server#s -> %d threads\\n\",\n\t\t\t    nthreads);\n\t\t} else {\n\t\t\tDBG(\"    no ibm,ppc-interrupt-server#s -> 1 thread\\n\");\n\t\t\tintserv = of_get_property(dn, \"reg\", &len);\n\t\t\tif (!intserv) {\n\t\t\t\tcpu_be = cpu_to_be32(cpu);\n\t\t\t\t/* XXX: what is this? uninitialized?? */\n\t\t\t\tintserv = &cpu_be;\t/* assume logical == phys */\n\t\t\t\tlen = 4;\n\t\t\t}\n\t\t}\n\n\t\tnthreads = len / sizeof(int);\n\n\t\tfor (j = 0; j < nthreads && cpu < nr_cpu_ids; j++) {\n\t\t\tbool avail;\n\n\t\t\tDBG(\"    thread %d -> cpu %d (hard id %d)\\n\",\n\t\t\t    j, cpu, be32_to_cpu(intserv[j]));\n\n\t\t\tavail = of_device_is_available(dn);\n\t\t\tif (!avail)\n\t\t\t\tavail = !of_property_match_string(dn,\n\t\t\t\t\t\t\"enable-method\", \"spin-table\");\n\n\t\t\tset_cpu_present(cpu, avail);\n\t\t\tset_cpu_possible(cpu, true);\n\t\t\tcpu_to_phys_id[cpu] = be32_to_cpu(intserv[j]);\n\t\t\tcpu++;\n\t\t}\n\n\t\tif (cpu >= nr_cpu_ids) {\n\t\t\tof_node_put(dn);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* If no SMT supported, nthreads is forced to 1 */\n\tif (!cpu_has_feature(CPU_FTR_SMT)) {\n\t\tDBG(\"  SMT disabled ! nthreads forced to 1\\n\");\n\t\tnthreads = 1;\n\t}\n\n#ifdef CONFIG_PPC64\n\t/*\n\t * On pSeries LPAR, we need to know how many cpus\n\t * could possibly be added to this partition.\n\t */\n\tif (firmware_has_feature(FW_FEATURE_LPAR) &&\n\t    (dn = of_find_node_by_path(\"/rtas\"))) {\n\t\tint num_addr_cell, num_size_cell, maxcpus;\n\t\tconst __be32 *ireg;\n\n\t\tnum_addr_cell = of_n_addr_cells(dn);\n\t\tnum_size_cell = of_n_size_cells(dn);\n\n\t\tireg = of_get_property(dn, \"ibm,lrdr-capacity\", NULL);\n\n\t\tif (!ireg)\n\t\t\tgoto out;\n\n\t\tmaxcpus = be32_to_cpup(ireg + num_addr_cell + num_size_cell);\n\n\t\t/* Double maxcpus for processors which have SMT capability */\n\t\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\t\tmaxcpus *= nthreads;\n\n\t\tif (maxcpus > nr_cpu_ids) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"Partition configured for %d cpus, \"\n\t\t\t       \"operating system maximum is %u.\\n\",\n\t\t\t       maxcpus, nr_cpu_ids);\n\t\t\tmaxcpus = nr_cpu_ids;\n\t\t} else\n\t\t\tprintk(KERN_INFO \"Partition configured for %d cpus.\\n\",\n\t\t\t       maxcpus);\n\n\t\tfor (cpu = 0; cpu < maxcpus; cpu++)\n\t\t\tset_cpu_possible(cpu, true);\n\tout:\n\t\tof_node_put(dn);\n\t}\n\tvdso_data->processorCount = num_present_cpus();\n#endif /* CONFIG_PPC64 */\n\n        /* Initialize CPU <=> thread mapping/\n\t *\n\t * WARNING: We assume that the number of threads is the same for\n\t * every CPU in the system. If that is not the case, then some code\n\t * here will have to be reworked\n\t */\n\tcpu_init_thread_core_maps(nthreads);\n\n\t/* Now that possible cpus are set, set nr_cpu_ids for later use */\n\tsetup_nr_cpu_ids();\n\n\tfree_unused_pacas();\n}"
  },
  {
    "function_name": "cpu_init_thread_core_maps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "400-420",
    "snippet": "static void __init cpu_init_thread_core_maps(int tpc)\n{\n\tint i;\n\n\tthreads_per_core = tpc;\n\tthreads_per_subcore = tpc;\n\tcpumask_clear(&threads_core_mask);\n\n\t/* This implementation only supports power of 2 number of threads\n\t * for simplicity and performance\n\t */\n\tthreads_shift = ilog2(tpc);\n\tBUG_ON(tpc != (1 << threads_shift));\n\n\tfor (i = 0; i < tpc; i++)\n\t\tcpumask_set_cpu(i, &threads_core_mask);\n\n\tprintk(KERN_INFO \"CPU maps initialized for %d thread%s per core\\n\",\n\t       tpc, tpc > 1 ? \"s\" : \"\");\n\tprintk(KERN_DEBUG \" (thread shift is %d)\\n\", threads_shift);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_DEBUG \" (thread shift is %d)\\n\"",
            "threads_shift"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "ppc_printk_progress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "792-795",
          "snippet": "void ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"CPU maps initialized for %d thread%s per core\\n\"",
            "tpc",
            "tpc > 1 ? \"s\" : \"\""
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "i",
            "&threads_core_mask"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "tpc != (1 << threads_shift)"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ilog2",
          "args": [
            "tpc"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear",
          "args": [
            "&threads_core_mask"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void __init cpu_init_thread_core_maps(int tpc)\n{\n\tint i;\n\n\tthreads_per_core = tpc;\n\tthreads_per_subcore = tpc;\n\tcpumask_clear(&threads_core_mask);\n\n\t/* This implementation only supports power of 2 number of threads\n\t * for simplicity and performance\n\t */\n\tthreads_shift = ilog2(tpc);\n\tBUG_ON(tpc != (1 << threads_shift));\n\n\tfor (i = 0; i < tpc; i++)\n\t\tcpumask_set_cpu(i, &threads_core_mask);\n\n\tprintk(KERN_INFO \"CPU maps initialized for %d thread%s per core\\n\",\n\t       tpc, tpc > 1 ? \"s\" : \"\");\n\tprintk(KERN_DEBUG \" (thread shift is %d)\\n\", threads_shift);\n}"
  },
  {
    "function_name": "check_for_initrd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "369-389",
    "snippet": "void __init check_for_initrd(void)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tDBG(\" -> check_for_initrd()  initrd_start=0x%lx  initrd_end=0x%lx\\n\",\n\t    initrd_start, initrd_end);\n\n\t/* If we were passed an initrd, set the ROOT_DEV properly if the values\n\t * look sensible. If not, clear initrd reference.\n\t */\n\tif (is_kernel_addr(initrd_start) && is_kernel_addr(initrd_end) &&\n\t    initrd_end > initrd_start)\n\t\tROOT_DEV = Root_RAM0;\n\telse\n\t\tinitrd_start = initrd_end = 0;\n\n\tif (initrd_start)\n\t\tpr_info(\"Found initrd at 0x%lx:0x%lx\\n\", initrd_start, initrd_end);\n\n\tDBG(\" <- check_for_initrd()\\n\");\n#endif /* CONFIG_BLK_DEV_INITRD */\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" <- check_for_initrd()\\n\""
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Found initrd at 0x%lx:0x%lx\\n\"",
            "initrd_start",
            "initrd_end"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_kernel_addr",
          "args": [
            "initrd_end"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_kernel_addr",
          "args": [
            "initrd_start"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" -> check_for_initrd()  initrd_start=0x%lx  initrd_end=0x%lx\\n\"",
            "initrd_start",
            "initrd_end"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init check_for_initrd(void)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tDBG(\" -> check_for_initrd()  initrd_start=0x%lx  initrd_end=0x%lx\\n\",\n\t    initrd_start, initrd_end);\n\n\t/* If we were passed an initrd, set the ROOT_DEV properly if the values\n\t * look sensible. If not, clear initrd reference.\n\t */\n\tif (is_kernel_addr(initrd_start) && is_kernel_addr(initrd_end) &&\n\t    initrd_end > initrd_start)\n\t\tROOT_DEV = Root_RAM0;\n\telse\n\t\tinitrd_start = initrd_end = 0;\n\n\tif (initrd_start)\n\t\tpr_info(\"Found initrd at 0x%lx:0x%lx\\n\", initrd_start, initrd_end);\n\n\tDBG(\" <- check_for_initrd()\\n\");\n#endif /* CONFIG_BLK_DEV_INITRD */\n}"
  },
  {
    "function_name": "c_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "358-360",
    "snippet": "static void c_stop(struct seq_file *m, void *v)\n{\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void c_stop(struct seq_file *m, void *v)\n{\n}"
  },
  {
    "function_name": "c_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "352-356",
    "snippet": "static void *c_next(struct seq_file *m, void *v, loff_t *pos)\n{\n\t(*pos)++;\n\treturn c_start(m, pos);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "c_start",
          "args": [
            "m",
            "pos"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "c_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "341-350",
          "snippet": "static void *c_start(struct seq_file *m, loff_t *pos)\n{\n\tif (*pos == 0)\t/* just in case, cpu 0 is not the first */\n\t\t*pos = cpumask_first(cpu_online_mask);\n\telse\n\t\t*pos = cpumask_next(*pos - 1, cpu_online_mask);\n\tif ((*pos) < nr_cpu_ids)\n\t\treturn (void *)(unsigned long)(*pos + 1);\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void *c_start(struct seq_file *m, loff_t *pos)\n{\n\tif (*pos == 0)\t/* just in case, cpu 0 is not the first */\n\t\t*pos = cpumask_first(cpu_online_mask);\n\telse\n\t\t*pos = cpumask_next(*pos - 1, cpu_online_mask);\n\tif ((*pos) < nr_cpu_ids)\n\t\treturn (void *)(unsigned long)(*pos + 1);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void *c_next(struct seq_file *m, void *v, loff_t *pos)\n{\n\t(*pos)++;\n\treturn c_start(m, pos);\n}"
  },
  {
    "function_name": "c_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "341-350",
    "snippet": "static void *c_start(struct seq_file *m, loff_t *pos)\n{\n\tif (*pos == 0)\t/* just in case, cpu 0 is not the first */\n\t\t*pos = cpumask_first(cpu_online_mask);\n\telse\n\t\t*pos = cpumask_next(*pos - 1, cpu_online_mask);\n\tif ((*pos) < nr_cpu_ids)\n\t\treturn (void *)(unsigned long)(*pos + 1);\n\treturn NULL;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_next",
          "args": [
            "*pos - 1",
            "cpu_online_mask"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_first",
          "args": [
            "cpu_online_mask"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void *c_start(struct seq_file *m, loff_t *pos)\n{\n\tif (*pos == 0)\t/* just in case, cpu 0 is not the first */\n\t\t*pos = cpumask_first(cpu_online_mask);\n\telse\n\t\t*pos = cpumask_next(*pos - 1, cpu_online_mask);\n\tif ((*pos) < nr_cpu_ids)\n\t\treturn (void *)(unsigned long)(*pos + 1);\n\treturn NULL;\n}"
  },
  {
    "function_name": "show_cpuinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "226-339",
    "snippet": "static int show_cpuinfo(struct seq_file *m, void *v)\n{\n\tunsigned long cpu_id = (unsigned long)v - 1;\n\tunsigned int pvr;\n\tunsigned long proc_freq;\n\tunsigned short maj;\n\tunsigned short min;\n\n#ifdef CONFIG_SMP\n\tpvr = per_cpu(cpu_pvr, cpu_id);\n#else\n\tpvr = mfspr(SPRN_PVR);\n#endif\n\tmaj = (pvr >> 8) & 0xFF;\n\tmin = pvr & 0xFF;\n\n\tseq_printf(m, \"processor\\t: %lu\\n\", cpu_id);\n\tseq_printf(m, \"cpu\\t\\t: \");\n\n\tif (cur_cpu_spec->pvr_mask && cur_cpu_spec->cpu_name)\n\t\tseq_printf(m, \"%s\", cur_cpu_spec->cpu_name);\n\telse\n\t\tseq_printf(m, \"unknown (%08x)\", pvr);\n\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC))\n\t\tseq_printf(m, \", altivec supported\");\n\n\tseq_printf(m, \"\\n\");\n\n#ifdef CONFIG_TAU\n\tif (cpu_has_feature(CPU_FTR_TAU)) {\n\t\tif (IS_ENABLED(CONFIG_TAU_AVERAGE)) {\n\t\t\t/* more straightforward, but potentially misleading */\n\t\t\tseq_printf(m,  \"temperature \\t: %u C (uncalibrated)\\n\",\n\t\t\t\t   cpu_temp(cpu_id));\n\t\t} else {\n\t\t\t/* show the actual temp sensor range */\n\t\t\tu32 temp;\n\t\t\ttemp = cpu_temp_both(cpu_id);\n\t\t\tseq_printf(m, \"temperature \\t: %u-%u C (uncalibrated)\\n\",\n\t\t\t\t   temp & 0xff, temp >> 16);\n\t\t}\n\t}\n#endif /* CONFIG_TAU */\n\n\t/*\n\t * Platforms that have variable clock rates, should implement\n\t * the method ppc_md.get_proc_freq() that reports the clock\n\t * rate of a given cpu. The rest can use ppc_proc_freq to\n\t * report the clock rate that is same across all cpus.\n\t */\n\tif (ppc_md.get_proc_freq)\n\t\tproc_freq = ppc_md.get_proc_freq(cpu_id);\n\telse\n\t\tproc_freq = ppc_proc_freq;\n\n\tif (proc_freq)\n\t\tseq_printf(m, \"clock\\t\\t: %lu.%06luMHz\\n\",\n\t\t\t   proc_freq / 1000000, proc_freq % 1000000);\n\n\tif (ppc_md.show_percpuinfo != NULL)\n\t\tppc_md.show_percpuinfo(m, cpu_id);\n\n\t/* If we are a Freescale core do a simple check so\n\t * we dont have to keep adding cases in the future */\n\tif (PVR_VER(pvr) & 0x8000) {\n\t\tswitch (PVR_VER(pvr)) {\n\t\tcase 0x8000:\t/* 7441/7450/7451, Voyager */\n\t\tcase 0x8001:\t/* 7445/7455, Apollo 6 */\n\t\tcase 0x8002:\t/* 7447/7457, Apollo 7 */\n\t\tcase 0x8003:\t/* 7447A, Apollo 7 PM */\n\t\tcase 0x8004:\t/* 7448, Apollo 8 */\n\t\tcase 0x800c:\t/* 7410, Nitro */\n\t\t\tmaj = ((pvr >> 8) & 0xF);\n\t\t\tmin = PVR_MIN(pvr);\n\t\t\tbreak;\n\t\tdefault:\t/* e500/book-e */\n\t\t\tmaj = PVR_MAJ(pvr);\n\t\t\tmin = PVR_MIN(pvr);\n\t\t\tbreak;\n\t\t}\n\t} else {\n\t\tswitch (PVR_VER(pvr)) {\n\t\t\tcase 0x1008:\t/* 740P/750P ?? */\n\t\t\t\tmaj = ((pvr >> 8) & 0xFF) - 1;\n\t\t\t\tmin = pvr & 0xFF;\n\t\t\t\tbreak;\n\t\t\tcase 0x004e: /* POWER9 bits 12-15 give chip type */\n\t\t\tcase 0x0080: /* POWER10 bit 12 gives SMT8/4 */\n\t\t\t\tmaj = (pvr >> 8) & 0x0F;\n\t\t\t\tmin = pvr & 0xFF;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tmaj = (pvr >> 8) & 0xFF;\n\t\t\t\tmin = pvr & 0xFF;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tseq_printf(m, \"revision\\t: %hd.%hd (pvr %04x %04x)\\n\",\n\t\t   maj, min, PVR_VER(pvr), PVR_REV(pvr));\n\n\tif (IS_ENABLED(CONFIG_PPC32))\n\t\tseq_printf(m, \"bogomips\\t: %lu.%02lu\\n\", loops_per_jiffy / (500000 / HZ),\n\t\t\t   (loops_per_jiffy / (5000 / HZ)) % 100);\n\n\tseq_printf(m, \"\\n\");\n\n\t/* If this is the last cpu, print the summary */\n\tif (cpumask_next(cpu_id, cpu_online_mask) >= nr_cpu_ids)\n\t\tshow_cpuinfo_summary(m);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "show_cpuinfo_summary",
          "args": [
            "m"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "show_cpuinfo_summary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "194-224",
          "snippet": "static void show_cpuinfo_summary(struct seq_file *m)\n{\n\tstruct device_node *root;\n\tconst char *model = NULL;\n\tunsigned long bogosum = 0;\n\tint i;\n\n\tif (IS_ENABLED(CONFIG_SMP) && IS_ENABLED(CONFIG_PPC32)) {\n\t\tfor_each_online_cpu(i)\n\t\t\tbogosum += loops_per_jiffy;\n\t\tseq_printf(m, \"total bogomips\\t: %lu.%02lu\\n\",\n\t\t\t   bogosum / (500000 / HZ), bogosum / (5000 / HZ) % 100);\n\t}\n\tseq_printf(m, \"timebase\\t: %lu\\n\", ppc_tb_freq);\n\tif (ppc_md.name)\n\t\tseq_printf(m, \"platform\\t: %s\\n\", ppc_md.name);\n\troot = of_find_node_by_path(\"/\");\n\tif (root)\n\t\tmodel = of_get_property(root, \"model\", NULL);\n\tif (model)\n\t\tseq_printf(m, \"model\\t\\t: %s\\n\", model);\n\tof_node_put(root);\n\n\tif (ppc_md.show_cpuinfo != NULL)\n\t\tppc_md.show_cpuinfo(m);\n\n\t/* Display the amount of memory */\n\tif (IS_ENABLED(CONFIG_PPC32))\n\t\tseq_printf(m, \"Memory\\t\\t: %d MB\\n\",\n\t\t\t   (unsigned int)(total_memory / (1024 * 1024)));\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct machdep_calls ppc_md;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nstatic void show_cpuinfo_summary(struct seq_file *m)\n{\n\tstruct device_node *root;\n\tconst char *model = NULL;\n\tunsigned long bogosum = 0;\n\tint i;\n\n\tif (IS_ENABLED(CONFIG_SMP) && IS_ENABLED(CONFIG_PPC32)) {\n\t\tfor_each_online_cpu(i)\n\t\t\tbogosum += loops_per_jiffy;\n\t\tseq_printf(m, \"total bogomips\\t: %lu.%02lu\\n\",\n\t\t\t   bogosum / (500000 / HZ), bogosum / (5000 / HZ) % 100);\n\t}\n\tseq_printf(m, \"timebase\\t: %lu\\n\", ppc_tb_freq);\n\tif (ppc_md.name)\n\t\tseq_printf(m, \"platform\\t: %s\\n\", ppc_md.name);\n\troot = of_find_node_by_path(\"/\");\n\tif (root)\n\t\tmodel = of_get_property(root, \"model\", NULL);\n\tif (model)\n\t\tseq_printf(m, \"model\\t\\t: %s\\n\", model);\n\tof_node_put(root);\n\n\tif (ppc_md.show_cpuinfo != NULL)\n\t\tppc_md.show_cpuinfo(m);\n\n\t/* Display the amount of memory */\n\tif (IS_ENABLED(CONFIG_PPC32))\n\t\tseq_printf(m, \"Memory\\t\\t: %d MB\\n\",\n\t\t\t   (unsigned int)(total_memory / (1024 * 1024)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_next",
          "args": [
            "cpu_id",
            "cpu_online_mask"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"\\n\""
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"bogomips\\t: %lu.%02lu\\n\"",
            "loops_per_jiffy / (500000 / HZ)",
            "(loops_per_jiffy / (5000 / HZ)) % 100"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC32"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"revision\\t: %hd.%hd (pvr %04x %04x)\\n\"",
            "maj",
            "min",
            "PVR_VER(pvr)",
            "PVR_REV(pvr)"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_REV",
          "args": [
            "pvr"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "pvr"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "pvr"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_MIN",
          "args": [
            "pvr"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_MAJ",
          "args": [
            "pvr"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_MIN",
          "args": [
            "pvr"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "pvr"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "pvr"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.show_percpuinfo",
          "args": [
            "m",
            "cpu_id"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"clock\\t\\t: %lu.%06luMHz\\n\"",
            "proc_freq / 1000000",
            "proc_freq % 1000000"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.get_proc_freq",
          "args": [
            "cpu_id"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"temperature \\t: %u-%u C (uncalibrated)\\n\"",
            "temp & 0xff",
            "temp >> 16"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_temp_both",
          "args": [
            "cpu_id"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_temp_both",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/tau_6xx.c",
          "lines": "227-230",
          "snippet": "u32 cpu_temp_both(unsigned long cpu)\n{\n\treturn ((tau[cpu].high << 16) | tau[cpu].low);\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/8xx_immap.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/reg.h>",
            "#include <asm/io.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/delay.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct tau_temp\n{\n\tint interrupts;\n\tunsigned char low;\n\tunsigned char high;\n\tunsigned char grew;\n} tau[NR_CPUS];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/8xx_immap.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/reg.h>\n#include <asm/io.h>\n#include <linux/workqueue.h>\n#include <linux/delay.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic struct tau_temp\n{\n\tint interrupts;\n\tunsigned char low;\n\tunsigned char high;\n\tunsigned char grew;\n} tau[NR_CPUS];\n\nu32 cpu_temp_both(unsigned long cpu)\n{\n\treturn ((tau[cpu].high << 16) | tau[cpu].low);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"temperature \\t: %u C (uncalibrated)\\n\"",
            "cpu_temp(cpu_id)"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_temp",
          "args": [
            "cpu_id"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_temp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/tau_6xx.c",
          "lines": "232-235",
          "snippet": "u32 cpu_temp(unsigned long cpu)\n{\n\treturn ((tau[cpu].high + tau[cpu].low) / 2);\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/8xx_immap.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/reg.h>",
            "#include <asm/io.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/delay.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct tau_temp\n{\n\tint interrupts;\n\tunsigned char low;\n\tunsigned char high;\n\tunsigned char grew;\n} tau[NR_CPUS];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/8xx_immap.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/reg.h>\n#include <asm/io.h>\n#include <linux/workqueue.h>\n#include <linux/delay.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic struct tau_temp\n{\n\tint interrupts;\n\tunsigned char low;\n\tunsigned char high;\n\tunsigned char grew;\n} tau[NR_CPUS];\n\nu32 cpu_temp(unsigned long cpu)\n{\n\treturn ((tau[cpu].high + tau[cpu].low) / 2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_TAU_AVERAGE"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_TAU"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"\\n\""
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\", altivec supported\""
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ALTIVEC"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"unknown (%08x)\"",
            "pvr"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"%s\"",
            "cur_cpu_spec->cpu_name"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"cpu\\t\\t: \""
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"processor\\t: %lu\\n\"",
            "cpu_id"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PVR"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_pvr",
            "cpu_id"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nstatic int show_cpuinfo(struct seq_file *m, void *v)\n{\n\tunsigned long cpu_id = (unsigned long)v - 1;\n\tunsigned int pvr;\n\tunsigned long proc_freq;\n\tunsigned short maj;\n\tunsigned short min;\n\n#ifdef CONFIG_SMP\n\tpvr = per_cpu(cpu_pvr, cpu_id);\n#else\n\tpvr = mfspr(SPRN_PVR);\n#endif\n\tmaj = (pvr >> 8) & 0xFF;\n\tmin = pvr & 0xFF;\n\n\tseq_printf(m, \"processor\\t: %lu\\n\", cpu_id);\n\tseq_printf(m, \"cpu\\t\\t: \");\n\n\tif (cur_cpu_spec->pvr_mask && cur_cpu_spec->cpu_name)\n\t\tseq_printf(m, \"%s\", cur_cpu_spec->cpu_name);\n\telse\n\t\tseq_printf(m, \"unknown (%08x)\", pvr);\n\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC))\n\t\tseq_printf(m, \", altivec supported\");\n\n\tseq_printf(m, \"\\n\");\n\n#ifdef CONFIG_TAU\n\tif (cpu_has_feature(CPU_FTR_TAU)) {\n\t\tif (IS_ENABLED(CONFIG_TAU_AVERAGE)) {\n\t\t\t/* more straightforward, but potentially misleading */\n\t\t\tseq_printf(m,  \"temperature \\t: %u C (uncalibrated)\\n\",\n\t\t\t\t   cpu_temp(cpu_id));\n\t\t} else {\n\t\t\t/* show the actual temp sensor range */\n\t\t\tu32 temp;\n\t\t\ttemp = cpu_temp_both(cpu_id);\n\t\t\tseq_printf(m, \"temperature \\t: %u-%u C (uncalibrated)\\n\",\n\t\t\t\t   temp & 0xff, temp >> 16);\n\t\t}\n\t}\n#endif /* CONFIG_TAU */\n\n\t/*\n\t * Platforms that have variable clock rates, should implement\n\t * the method ppc_md.get_proc_freq() that reports the clock\n\t * rate of a given cpu. The rest can use ppc_proc_freq to\n\t * report the clock rate that is same across all cpus.\n\t */\n\tif (ppc_md.get_proc_freq)\n\t\tproc_freq = ppc_md.get_proc_freq(cpu_id);\n\telse\n\t\tproc_freq = ppc_proc_freq;\n\n\tif (proc_freq)\n\t\tseq_printf(m, \"clock\\t\\t: %lu.%06luMHz\\n\",\n\t\t\t   proc_freq / 1000000, proc_freq % 1000000);\n\n\tif (ppc_md.show_percpuinfo != NULL)\n\t\tppc_md.show_percpuinfo(m, cpu_id);\n\n\t/* If we are a Freescale core do a simple check so\n\t * we dont have to keep adding cases in the future */\n\tif (PVR_VER(pvr) & 0x8000) {\n\t\tswitch (PVR_VER(pvr)) {\n\t\tcase 0x8000:\t/* 7441/7450/7451, Voyager */\n\t\tcase 0x8001:\t/* 7445/7455, Apollo 6 */\n\t\tcase 0x8002:\t/* 7447/7457, Apollo 7 */\n\t\tcase 0x8003:\t/* 7447A, Apollo 7 PM */\n\t\tcase 0x8004:\t/* 7448, Apollo 8 */\n\t\tcase 0x800c:\t/* 7410, Nitro */\n\t\t\tmaj = ((pvr >> 8) & 0xF);\n\t\t\tmin = PVR_MIN(pvr);\n\t\t\tbreak;\n\t\tdefault:\t/* e500/book-e */\n\t\t\tmaj = PVR_MAJ(pvr);\n\t\t\tmin = PVR_MIN(pvr);\n\t\t\tbreak;\n\t\t}\n\t} else {\n\t\tswitch (PVR_VER(pvr)) {\n\t\t\tcase 0x1008:\t/* 740P/750P ?? */\n\t\t\t\tmaj = ((pvr >> 8) & 0xFF) - 1;\n\t\t\t\tmin = pvr & 0xFF;\n\t\t\t\tbreak;\n\t\t\tcase 0x004e: /* POWER9 bits 12-15 give chip type */\n\t\t\tcase 0x0080: /* POWER10 bit 12 gives SMT8/4 */\n\t\t\t\tmaj = (pvr >> 8) & 0x0F;\n\t\t\t\tmin = pvr & 0xFF;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tmaj = (pvr >> 8) & 0xFF;\n\t\t\t\tmin = pvr & 0xFF;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tseq_printf(m, \"revision\\t: %hd.%hd (pvr %04x %04x)\\n\",\n\t\t   maj, min, PVR_VER(pvr), PVR_REV(pvr));\n\n\tif (IS_ENABLED(CONFIG_PPC32))\n\t\tseq_printf(m, \"bogomips\\t: %lu.%02lu\\n\", loops_per_jiffy / (500000 / HZ),\n\t\t\t   (loops_per_jiffy / (5000 / HZ)) % 100);\n\n\tseq_printf(m, \"\\n\");\n\n\t/* If this is the last cpu, print the summary */\n\tif (cpumask_next(cpu_id, cpu_online_mask) >= nr_cpu_ids)\n\t\tshow_cpuinfo_summary(m);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "show_cpuinfo_summary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "194-224",
    "snippet": "static void show_cpuinfo_summary(struct seq_file *m)\n{\n\tstruct device_node *root;\n\tconst char *model = NULL;\n\tunsigned long bogosum = 0;\n\tint i;\n\n\tif (IS_ENABLED(CONFIG_SMP) && IS_ENABLED(CONFIG_PPC32)) {\n\t\tfor_each_online_cpu(i)\n\t\t\tbogosum += loops_per_jiffy;\n\t\tseq_printf(m, \"total bogomips\\t: %lu.%02lu\\n\",\n\t\t\t   bogosum / (500000 / HZ), bogosum / (5000 / HZ) % 100);\n\t}\n\tseq_printf(m, \"timebase\\t: %lu\\n\", ppc_tb_freq);\n\tif (ppc_md.name)\n\t\tseq_printf(m, \"platform\\t: %s\\n\", ppc_md.name);\n\troot = of_find_node_by_path(\"/\");\n\tif (root)\n\t\tmodel = of_get_property(root, \"model\", NULL);\n\tif (model)\n\t\tseq_printf(m, \"model\\t\\t: %s\\n\", model);\n\tof_node_put(root);\n\n\tif (ppc_md.show_cpuinfo != NULL)\n\t\tppc_md.show_cpuinfo(m);\n\n\t/* Display the amount of memory */\n\tif (IS_ENABLED(CONFIG_PPC32))\n\t\tseq_printf(m, \"Memory\\t\\t: %d MB\\n\",\n\t\t\t   (unsigned int)(total_memory / (1024 * 1024)));\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"Memory\\t\\t: %d MB\\n\"",
            "(unsigned int)(total_memory / (1024 * 1024))"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC32"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.show_cpuinfo",
          "args": [
            "m"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "root"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"model\\t\\t: %s\\n\"",
            "model"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "root",
            "\"model\"",
            "NULL"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_path",
          "args": [
            "\"/\""
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"platform\\t: %s\\n\"",
            "ppc_md.name"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"timebase\\t: %lu\\n\"",
            "ppc_tb_freq"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"total bogomips\\t: %lu.%02lu\\n\"",
            "bogosum / (500000 / HZ)",
            "bogosum / (5000 / HZ) % 100"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC32"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_SMP"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nstatic void show_cpuinfo_summary(struct seq_file *m)\n{\n\tstruct device_node *root;\n\tconst char *model = NULL;\n\tunsigned long bogosum = 0;\n\tint i;\n\n\tif (IS_ENABLED(CONFIG_SMP) && IS_ENABLED(CONFIG_PPC32)) {\n\t\tfor_each_online_cpu(i)\n\t\t\tbogosum += loops_per_jiffy;\n\t\tseq_printf(m, \"total bogomips\\t: %lu.%02lu\\n\",\n\t\t\t   bogosum / (500000 / HZ), bogosum / (5000 / HZ) % 100);\n\t}\n\tseq_printf(m, \"timebase\\t: %lu\\n\", ppc_tb_freq);\n\tif (ppc_md.name)\n\t\tseq_printf(m, \"platform\\t: %s\\n\", ppc_md.name);\n\troot = of_find_node_by_path(\"/\");\n\tif (root)\n\t\tmodel = of_get_property(root, \"model\", NULL);\n\tif (model)\n\t\tseq_printf(m, \"model\\t\\t: %s\\n\", model);\n\tof_node_put(root);\n\n\tif (ppc_md.show_cpuinfo != NULL)\n\t\tppc_md.show_cpuinfo(m);\n\n\t/* Display the amount of memory */\n\tif (IS_ENABLED(CONFIG_PPC32))\n\t\tseq_printf(m, \"Memory\\t\\t: %d MB\\n\",\n\t\t\t   (unsigned int)(total_memory / (1024 * 1024)));\n}"
  },
  {
    "function_name": "machine_halt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "180-188",
    "snippet": "void machine_halt(void)\n{\n\tmachine_shutdown();\n\tif (ppc_md.halt)\n\t\tppc_md.halt();\n\n\tsmp_send_stop();\n\tmachine_hang();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "machine_hang",
          "args": [],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "machine_hang",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "143-149",
          "snippet": "static void machine_hang(void)\n{\n\tpr_emerg(\"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1)\n\t\t;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void machine_hang(void)\n{\n\tpr_emerg(\"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1)\n\t\t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_send_stop",
          "args": [],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "smp_send_stop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "623-639",
          "snippet": "void smp_send_stop(void)\n{\n\tstatic bool stopped = false;\n\n\t/*\n\t * Prevent waiting on csd lock from a previous smp_send_stop.\n\t * This is racy, but in general callers try to do the right\n\t * thing and only fire off one smp_send_stop (e.g., see\n\t * kernel/panic.c)\n\t */\n\tif (stopped)\n\t\treturn;\n\n\tstopped = true;\n\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_send_stop(void)\n{\n\tstatic bool stopped = false;\n\n\t/*\n\t * Prevent waiting on csd lock from a previous smp_send_stop.\n\t * This is racy, but in general callers try to do the right\n\t * thing and only fire off one smp_send_stop (e.g., see\n\t * kernel/panic.c)\n\t */\n\tif (stopped)\n\t\treturn;\n\n\tstopped = true;\n\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppc_md.halt",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "machine_shutdown",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "machine_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "131-141",
          "snippet": "void machine_shutdown(void)\n{\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct machdep_calls ppc_md;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nvoid machine_shutdown(void)\n{\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nvoid machine_halt(void)\n{\n\tmachine_shutdown();\n\tif (ppc_md.halt)\n\t\tppc_md.halt();\n\n\tsmp_send_stop();\n\tmachine_hang();\n}"
  },
  {
    "function_name": "machine_power_off",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "165-173",
    "snippet": "void machine_power_off(void)\n{\n\tmachine_shutdown();\n\tif (pm_power_off)\n\t\tpm_power_off();\n\n\tsmp_send_stop();\n\tmachine_hang();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void (*pm_power_off)(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "machine_hang",
          "args": [],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "machine_hang",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "143-149",
          "snippet": "static void machine_hang(void)\n{\n\tpr_emerg(\"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1)\n\t\t;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void machine_hang(void)\n{\n\tpr_emerg(\"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1)\n\t\t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_send_stop",
          "args": [],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "smp_send_stop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "623-639",
          "snippet": "void smp_send_stop(void)\n{\n\tstatic bool stopped = false;\n\n\t/*\n\t * Prevent waiting on csd lock from a previous smp_send_stop.\n\t * This is racy, but in general callers try to do the right\n\t * thing and only fire off one smp_send_stop (e.g., see\n\t * kernel/panic.c)\n\t */\n\tif (stopped)\n\t\treturn;\n\n\tstopped = true;\n\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_send_stop(void)\n{\n\tstatic bool stopped = false;\n\n\t/*\n\t * Prevent waiting on csd lock from a previous smp_send_stop.\n\t * This is racy, but in general callers try to do the right\n\t * thing and only fire off one smp_send_stop (e.g., see\n\t * kernel/panic.c)\n\t */\n\tif (stopped)\n\t\treturn;\n\n\tstopped = true;\n\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_power_off",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "machine_shutdown",
          "args": [],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "machine_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "131-141",
          "snippet": "void machine_shutdown(void)\n{\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct machdep_calls ppc_md;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nvoid machine_shutdown(void)\n{\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid (*pm_power_off)(void);\n\nvoid machine_power_off(void)\n{\n\tmachine_shutdown();\n\tif (pm_power_off)\n\t\tpm_power_off();\n\n\tsmp_send_stop();\n\tmachine_hang();\n}"
  },
  {
    "function_name": "machine_restart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "151-163",
    "snippet": "void machine_restart(char *cmd)\n{\n\tmachine_shutdown();\n\tif (ppc_md.restart)\n\t\tppc_md.restart(cmd);\n\n\tsmp_send_stop();\n\n\tdo_kernel_restart(cmd);\n\tmdelay(1000);\n\n\tmachine_hang();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "machine_hang",
          "args": [],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "machine_hang",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "143-149",
          "snippet": "static void machine_hang(void)\n{\n\tpr_emerg(\"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1)\n\t\t;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void machine_hang(void)\n{\n\tpr_emerg(\"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1)\n\t\t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mdelay",
          "args": [
            "1000"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_kernel_restart",
          "args": [
            "cmd"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_send_stop",
          "args": [],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "smp_send_stop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "623-639",
          "snippet": "void smp_send_stop(void)\n{\n\tstatic bool stopped = false;\n\n\t/*\n\t * Prevent waiting on csd lock from a previous smp_send_stop.\n\t * This is racy, but in general callers try to do the right\n\t * thing and only fire off one smp_send_stop (e.g., see\n\t * kernel/panic.c)\n\t */\n\tif (stopped)\n\t\treturn;\n\n\tstopped = true;\n\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_send_stop(void)\n{\n\tstatic bool stopped = false;\n\n\t/*\n\t * Prevent waiting on csd lock from a previous smp_send_stop.\n\t * This is racy, but in general callers try to do the right\n\t * thing and only fire off one smp_send_stop (e.g., see\n\t * kernel/panic.c)\n\t */\n\tif (stopped)\n\t\treturn;\n\n\tstopped = true;\n\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppc_md.restart",
          "args": [
            "cmd"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "machine_shutdown",
          "args": [],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "machine_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "131-141",
          "snippet": "void machine_shutdown(void)\n{\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct machdep_calls ppc_md;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nvoid machine_shutdown(void)\n{\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nvoid machine_restart(char *cmd)\n{\n\tmachine_shutdown();\n\tif (ppc_md.restart)\n\t\tppc_md.restart(cmd);\n\n\tsmp_send_stop();\n\n\tdo_kernel_restart(cmd);\n\tmdelay(1000);\n\n\tmachine_hang();\n}"
  },
  {
    "function_name": "machine_hang",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "143-149",
    "snippet": "static void machine_hang(void)\n{\n\tpr_emerg(\"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1)\n\t\t;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_disable",
          "args": [],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_emerg",
          "args": [
            "\"System Halted, OK to turn off power\\n\""
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void machine_hang(void)\n{\n\tpr_emerg(\"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1)\n\t\t;\n}"
  },
  {
    "function_name": "machine_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "131-141",
    "snippet": "void machine_shutdown(void)\n{\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include \"setup.h\"",
      "#include <asm/kasan.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.machine_shutdown",
          "args": [],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "machine_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "131-141",
          "snippet": "void machine_shutdown(void)\n{\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "fadump_cleanup",
          "args": [],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "fadump_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/fadump.c",
          "lines": "1200-1217",
          "snippet": "void fadump_cleanup(void)\n{\n\tif (!fw_dump.fadump_supported)\n\t\treturn;\n\n\t/* Invalidate the registration only if dump is active. */\n\tif (fw_dump.dump_active) {\n\t\tpr_debug(\"Invalidating firmware-assisted dump registration\\n\");\n\t\tfw_dump.ops->fadump_invalidate(&fw_dump);\n\t} else if (fw_dump.dump_registered) {\n\t\t/* Un-register Firmware-assisted dump if it was registered. */\n\t\tfw_dump.ops->fadump_unregister(&fw_dump);\n\t\tfadump_free_mem_ranges(&crash_mrange_info);\n\t}\n\n\tif (fw_dump.ops->fadump_cleanup)\n\t\tfw_dump.ops->fadump_cleanup(&fw_dump);\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/fadump-internal.h>",
            "#include <asm/fadump.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/cma.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/crash_dump.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/delay.h>",
            "#include <linux/memblock.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct fw_dump fw_dump;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/fadump-internal.h>\n#include <asm/fadump.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/debugfs.h>\n#include <linux/hugetlb.h>\n#include <linux/cma.h>\n#include <linux/slab.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/crash_dump.h>\n#include <linux/seq_file.h>\n#include <linux/delay.h>\n#include <linux/memblock.h>\n#include <linux/string.h>\n\nstatic struct fw_dump fw_dump;\n\nvoid fadump_cleanup(void)\n{\n\tif (!fw_dump.fadump_supported)\n\t\treturn;\n\n\t/* Invalidate the registration only if dump is active. */\n\tif (fw_dump.dump_active) {\n\t\tpr_debug(\"Invalidating firmware-assisted dump registration\\n\");\n\t\tfw_dump.ops->fadump_invalidate(&fw_dump);\n\t} else if (fw_dump.dump_registered) {\n\t\t/* Un-register Firmware-assisted dump if it was registered. */\n\t\tfw_dump.ops->fadump_unregister(&fw_dump);\n\t\tfadump_free_mem_ranges(&crash_mrange_info);\n\t}\n\n\tif (fw_dump.ops->fadump_cleanup)\n\t\tfw_dump.ops->fadump_cleanup(&fw_dump);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nvoid machine_shutdown(void)\n{\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}"
  }
]