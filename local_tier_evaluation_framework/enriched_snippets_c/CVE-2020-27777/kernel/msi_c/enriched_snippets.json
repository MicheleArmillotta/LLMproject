[
  {
    "function_name": "arch_teardown_msi_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/msi.c",
    "lines": "29-39",
    "snippet": "void arch_teardown_msi_irqs(struct pci_dev *dev)\n{\n\tstruct pci_controller *phb = pci_bus_to_host(dev->bus);\n\n\t/*\n\t * We can be called even when arch_setup_msi_irqs() returns -ENOSYS,\n\t * so check the pointer again.\n\t */\n\tif (phb->controller_ops.teardown_msi_irqs)\n\t\tphb->controller_ops.teardown_msi_irqs(dev);\n}",
    "includes": [
      "#include <asm/machdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/msi.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "phb->controller_ops.teardown_msi_irqs",
          "args": [
            "dev"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_bus_to_host",
          "args": [
            "dev->bus"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/machdep.h>\n#include <linux/pci.h>\n#include <linux/msi.h>\n#include <linux/kernel.h>\n\nvoid arch_teardown_msi_irqs(struct pci_dev *dev)\n{\n\tstruct pci_controller *phb = pci_bus_to_host(dev->bus);\n\n\t/*\n\t * We can be called even when arch_setup_msi_irqs() returns -ENOSYS,\n\t * so check the pointer again.\n\t */\n\tif (phb->controller_ops.teardown_msi_irqs)\n\t\tphb->controller_ops.teardown_msi_irqs(dev);\n}"
  },
  {
    "function_name": "arch_setup_msi_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/msi.c",
    "lines": "12-27",
    "snippet": "int arch_setup_msi_irqs(struct pci_dev *dev, int nvec, int type)\n{\n\tstruct pci_controller *phb = pci_bus_to_host(dev->bus);\n\n\tif (!phb->controller_ops.setup_msi_irqs ||\n\t    !phb->controller_ops.teardown_msi_irqs) {\n\t\tpr_debug(\"msi: Platform doesn't provide MSI callbacks.\\n\");\n\t\treturn -ENOSYS;\n\t}\n\n\t/* PowerPC doesn't support multiple MSI yet */\n\tif (type == PCI_CAP_ID_MSI && nvec > 1)\n\t\treturn 1;\n\n\treturn phb->controller_ops.setup_msi_irqs(dev, nvec, type);\n}",
    "includes": [
      "#include <asm/machdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/msi.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "phb->controller_ops.setup_msi_irqs",
          "args": [
            "dev",
            "nvec",
            "type"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"msi: Platform doesn't provide MSI callbacks.\\n\""
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_bus_to_host",
          "args": [
            "dev->bus"
          ],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/machdep.h>\n#include <linux/pci.h>\n#include <linux/msi.h>\n#include <linux/kernel.h>\n\nint arch_setup_msi_irqs(struct pci_dev *dev, int nvec, int type)\n{\n\tstruct pci_controller *phb = pci_bus_to_host(dev->bus);\n\n\tif (!phb->controller_ops.setup_msi_irqs ||\n\t    !phb->controller_ops.teardown_msi_irqs) {\n\t\tpr_debug(\"msi: Platform doesn't provide MSI callbacks.\\n\");\n\t\treturn -ENOSYS;\n\t}\n\n\t/* PowerPC doesn't support multiple MSI yet */\n\tif (type == PCI_CAP_ID_MSI && nvec > 1)\n\t\treturn 1;\n\n\treturn phb->controller_ops.setup_msi_irqs(dev, nvec, type);\n}"
  }
]