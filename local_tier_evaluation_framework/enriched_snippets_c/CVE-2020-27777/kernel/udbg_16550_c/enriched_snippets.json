[
  {
    "function_name": "udbg_init_40x_realmode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "291-296",
    "snippet": "void __init udbg_init_40x_realmode(void)\n{\n\tudbg_uart_in = udbg_uart_in_40x;\n\tudbg_uart_out = udbg_uart_out_40x;\n\tudbg_use_uart();\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "udbg_use_uart",
          "args": [],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_use_uart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "87-93",
          "snippet": "static void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nvoid __init udbg_init_40x_realmode(void)\n{\n\tudbg_uart_in = udbg_uart_in_40x;\n\tudbg_uart_out = udbg_uart_out_40x;\n\tudbg_use_uart();\n}"
  },
  {
    "function_name": "udbg_uart_out_40x",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "285-289",
    "snippet": "static void udbg_uart_out_40x(unsigned int reg, u8 val)\n{\n\treal_writeb(val, (void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t    + reg);\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u8 (*udbg_uart_in)(unsigned int reg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "real_writeb",
          "args": [
            "val",
            "(void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t    + reg"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic void udbg_uart_out_40x(unsigned int reg, u8 val)\n{\n\treal_writeb(val, (void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t    + reg);\n}"
  },
  {
    "function_name": "udbg_uart_in_40x",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "279-283",
    "snippet": "static u8 udbg_uart_in_40x(unsigned int reg)\n{\n\treturn real_readb((void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t\t  + reg);\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u8 (*udbg_uart_in)(unsigned int reg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "real_readb",
          "args": [
            "(void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t\t  + reg"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic u8 udbg_uart_in_40x(unsigned int reg)\n{\n\treturn real_readb((void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t\t  + reg);\n}"
  },
  {
    "function_name": "udbg_init_44x_as1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "268-273",
    "snippet": "void __init udbg_init_44x_as1(void)\n{\n\tudbg_uart_in = udbg_uart_in_44x_as1;\n\tudbg_uart_out = udbg_uart_out_44x_as1;\n\tudbg_use_uart();\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "udbg_use_uart",
          "args": [],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_use_uart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "87-93",
          "snippet": "static void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nvoid __init udbg_init_44x_as1(void)\n{\n\tudbg_uart_in = udbg_uart_in_44x_as1;\n\tudbg_uart_out = udbg_uart_out_44x_as1;\n\tudbg_use_uart();\n}"
  },
  {
    "function_name": "udbg_uart_out_44x_as1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "263-266",
    "snippet": "static void udbg_uart_out_44x_as1(unsigned int reg, u8 val)\n{\n\tas1_writeb(val, (void __iomem *)PPC44x_EARLY_DEBUG_VIRTADDR + reg);\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u8 (*udbg_uart_in)(unsigned int reg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "as1_writeb",
          "args": [
            "val",
            "(void __iomem *)PPC44x_EARLY_DEBUG_VIRTADDR + reg"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic void udbg_uart_out_44x_as1(unsigned int reg, u8 val)\n{\n\tas1_writeb(val, (void __iomem *)PPC44x_EARLY_DEBUG_VIRTADDR + reg);\n}"
  },
  {
    "function_name": "udbg_uart_in_44x_as1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "258-261",
    "snippet": "static u8 udbg_uart_in_44x_as1(unsigned int reg)\n{\n\treturn as1_readb((void __iomem *)PPC44x_EARLY_DEBUG_VIRTADDR + reg);\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u8 (*udbg_uart_in)(unsigned int reg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "as1_readb",
          "args": [
            "(void __iomem *)PPC44x_EARLY_DEBUG_VIRTADDR + reg"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic u8 udbg_uart_in_44x_as1(unsigned int reg)\n{\n\treturn as1_readb((void __iomem *)PPC44x_EARLY_DEBUG_VIRTADDR + reg);\n}"
  },
  {
    "function_name": "udbg_init_pas_realmode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "245-250",
    "snippet": "void __init udbg_init_pas_realmode(void)\n{\n\tudbg_uart_in = udbg_uart_in_pas;\n\tudbg_uart_out = udbg_uart_out_pas;\n\tudbg_use_uart();\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "udbg_use_uart",
          "args": [],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_use_uart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "87-93",
          "snippet": "static void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nvoid __init udbg_init_pas_realmode(void)\n{\n\tudbg_uart_in = udbg_uart_in_pas;\n\tudbg_uart_out = udbg_uart_out_pas;\n\tudbg_use_uart();\n}"
  },
  {
    "function_name": "udbg_uart_out_pas",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "240-243",
    "snippet": "static void udbg_uart_out_pas(unsigned int reg, u8 val)\n{\n\treal_205_writeb(val, UDBG_UART_PAS_ADDR + reg);\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define UDBG_UART_PAS_ADDR\t((void __iomem *)0xfcff03f8UL)"
    ],
    "globals_used": [
      "static u8 (*udbg_uart_in)(unsigned int reg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "real_205_writeb",
          "args": [
            "val",
            "UDBG_UART_PAS_ADDR + reg"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\n#define UDBG_UART_PAS_ADDR\t((void __iomem *)0xfcff03f8UL)\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic void udbg_uart_out_pas(unsigned int reg, u8 val)\n{\n\treal_205_writeb(val, UDBG_UART_PAS_ADDR + reg);\n}"
  },
  {
    "function_name": "udbg_uart_in_pas",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "235-238",
    "snippet": "static u8 udbg_uart_in_pas(unsigned int reg)\n{\n\treturn real_205_readb(UDBG_UART_PAS_ADDR + reg);\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define UDBG_UART_PAS_ADDR\t((void __iomem *)0xfcff03f8UL)"
    ],
    "globals_used": [
      "static u8 (*udbg_uart_in)(unsigned int reg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "real_205_readb",
          "args": [
            "UDBG_UART_PAS_ADDR + reg"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\n#define UDBG_UART_PAS_ADDR\t((void __iomem *)0xfcff03f8UL)\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic u8 udbg_uart_in_pas(unsigned int reg)\n{\n\treturn real_205_readb(UDBG_UART_PAS_ADDR + reg);\n}"
  },
  {
    "function_name": "udbg_init_maple_realmode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "222-227",
    "snippet": "void __init udbg_init_maple_realmode(void)\n{\n\tudbg_uart_in = udbg_uart_in_maple;\n\tudbg_uart_out = udbg_uart_out_maple;\n\tudbg_use_uart();\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "udbg_use_uart",
          "args": [],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_use_uart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "87-93",
          "snippet": "static void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nvoid __init udbg_init_maple_realmode(void)\n{\n\tudbg_uart_in = udbg_uart_in_maple;\n\tudbg_uart_out = udbg_uart_out_maple;\n\tudbg_use_uart();\n}"
  },
  {
    "function_name": "udbg_uart_out_maple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "217-220",
    "snippet": "static void udbg_uart_out_maple(unsigned int reg, u8 val)\n{\n\treal_writeb(val, UDBG_UART_MAPLE_ADDR + reg);\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define UDBG_UART_MAPLE_ADDR\t((void __iomem *)0xf40003f8)"
    ],
    "globals_used": [
      "static u8 (*udbg_uart_in)(unsigned int reg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "real_writeb",
          "args": [
            "val",
            "UDBG_UART_MAPLE_ADDR + reg"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\n#define UDBG_UART_MAPLE_ADDR\t((void __iomem *)0xf40003f8)\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic void udbg_uart_out_maple(unsigned int reg, u8 val)\n{\n\treal_writeb(val, UDBG_UART_MAPLE_ADDR + reg);\n}"
  },
  {
    "function_name": "udbg_uart_in_maple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "212-215",
    "snippet": "static u8 udbg_uart_in_maple(unsigned int reg)\n{\n\treturn real_readb(UDBG_UART_MAPLE_ADDR + reg);\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define UDBG_UART_MAPLE_ADDR\t((void __iomem *)0xf40003f8)"
    ],
    "globals_used": [
      "static u8 (*udbg_uart_in)(unsigned int reg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "real_readb",
          "args": [
            "UDBG_UART_MAPLE_ADDR + reg"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\n#define UDBG_UART_MAPLE_ADDR\t((void __iomem *)0xf40003f8)\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic u8 udbg_uart_in_maple(unsigned int reg)\n{\n\treturn real_readb(UDBG_UART_MAPLE_ADDR + reg);\n}"
  },
  {
    "function_name": "udbg_uart_init_mmio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "197-206",
    "snippet": "void udbg_uart_init_mmio(void __iomem *addr, unsigned int stride)\n{\n\tif (!addr)\n\t\treturn;\n\tudbg_uart.mmio_base = addr;\n\tudbg_uart_stride = stride;\n\tudbg_uart_in = udbg_uart_in_mmio;\n\tudbg_uart_out = udbg_uart_out_mmio;\n\tudbg_use_uart();\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern u8 real_readb(volatile u8 __iomem  *addr);",
      "extern void real_writeb(u8 data, volatile u8 __iomem *addr);",
      "extern u8 real_205_readb(volatile u8 __iomem  *addr);",
      "extern void real_205_writeb(u8 data, volatile u8 __iomem *addr);",
      "static union {\n\tunsigned char __iomem *mmio_base;\n\tunsigned long pio_base;\n} udbg_uart;",
      "static unsigned int udbg_uart_stride = 1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "udbg_use_uart",
          "args": [],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_use_uart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "87-93",
          "snippet": "static void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nextern u8 real_readb(volatile u8 __iomem  *addr);\nextern void real_writeb(u8 data, volatile u8 __iomem *addr);\nextern u8 real_205_readb(volatile u8 __iomem  *addr);\nextern void real_205_writeb(u8 data, volatile u8 __iomem *addr);\nstatic union {\n\tunsigned char __iomem *mmio_base;\n\tunsigned long pio_base;\n} udbg_uart;\nstatic unsigned int udbg_uart_stride = 1;\n\nvoid udbg_uart_init_mmio(void __iomem *addr, unsigned int stride)\n{\n\tif (!addr)\n\t\treturn;\n\tudbg_uart.mmio_base = addr;\n\tudbg_uart_stride = stride;\n\tudbg_uart_in = udbg_uart_in_mmio;\n\tudbg_uart_out = udbg_uart_out_mmio;\n\tudbg_use_uart();\n}"
  },
  {
    "function_name": "udbg_uart_out_mmio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "191-194",
    "snippet": "static void udbg_uart_out_mmio(unsigned int reg, u8 data)\n{\n\tout_8(udbg_uart.mmio_base + (reg * udbg_uart_stride), data);\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u8 (*udbg_uart_in)(unsigned int reg);",
      "static void (*udbg_uart_out)(unsigned int reg, u8 data);",
      "static union {\n\tunsigned char __iomem *mmio_base;\n\tunsigned long pio_base;\n} udbg_uart;",
      "static unsigned int udbg_uart_stride = 1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "out_8",
          "args": [
            "udbg_uart.mmio_base + (reg * udbg_uart_stride)",
            "data"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\nstatic void (*udbg_uart_out)(unsigned int reg, u8 data);\nstatic union {\n\tunsigned char __iomem *mmio_base;\n\tunsigned long pio_base;\n} udbg_uart;\nstatic unsigned int udbg_uart_stride = 1;\n\nstatic void udbg_uart_out_mmio(unsigned int reg, u8 data)\n{\n\tout_8(udbg_uart.mmio_base + (reg * udbg_uart_stride), data);\n}"
  },
  {
    "function_name": "udbg_uart_in_mmio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "186-189",
    "snippet": "static u8 udbg_uart_in_mmio(unsigned int reg)\n{\n\treturn in_8(udbg_uart.mmio_base + (reg * udbg_uart_stride));\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u8 (*udbg_uart_in)(unsigned int reg);",
      "static union {\n\tunsigned char __iomem *mmio_base;\n\tunsigned long pio_base;\n} udbg_uart;",
      "static unsigned int udbg_uart_stride = 1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_8",
          "args": [
            "udbg_uart.mmio_base + (reg * udbg_uart_stride)"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\nstatic union {\n\tunsigned char __iomem *mmio_base;\n\tunsigned long pio_base;\n} udbg_uart;\nstatic unsigned int udbg_uart_stride = 1;\n\nstatic u8 udbg_uart_in_mmio(unsigned int reg)\n{\n\treturn in_8(udbg_uart.mmio_base + (reg * udbg_uart_stride));\n}"
  },
  {
    "function_name": "udbg_uart_init_pio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "175-184",
    "snippet": "void udbg_uart_init_pio(unsigned long port, unsigned int stride)\n{\n\tif (!port)\n\t\treturn;\n\tudbg_uart.pio_base = port;\n\tudbg_uart_stride = stride;\n\tudbg_uart_in = udbg_uart_in_pio;\n\tudbg_uart_out = udbg_uart_out_pio;\n\tudbg_use_uart();\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static union {\n\tunsigned char __iomem *mmio_base;\n\tunsigned long pio_base;\n} udbg_uart;",
      "static unsigned int udbg_uart_stride = 1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "udbg_use_uart",
          "args": [],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_use_uart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "87-93",
          "snippet": "static void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic union {\n\tunsigned char __iomem *mmio_base;\n\tunsigned long pio_base;\n} udbg_uart;\nstatic unsigned int udbg_uart_stride = 1;\n\nvoid udbg_uart_init_pio(unsigned long port, unsigned int stride)\n{\n\tif (!port)\n\t\treturn;\n\tudbg_uart.pio_base = port;\n\tudbg_uart_stride = stride;\n\tudbg_uart_in = udbg_uart_in_pio;\n\tudbg_uart_out = udbg_uart_out_pio;\n\tudbg_use_uart();\n}"
  },
  {
    "function_name": "udbg_uart_out_pio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "170-173",
    "snippet": "static void udbg_uart_out_pio(unsigned int reg, u8 data)\n{\n\toutb(data, udbg_uart.pio_base + (reg * udbg_uart_stride));\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u8 (*udbg_uart_in)(unsigned int reg);",
      "static void (*udbg_uart_out)(unsigned int reg, u8 data);",
      "static union {\n\tunsigned char __iomem *mmio_base;\n\tunsigned long pio_base;\n} udbg_uart;",
      "static unsigned int udbg_uart_stride = 1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "outb",
          "args": [
            "data",
            "udbg_uart.pio_base + (reg * udbg_uart_stride)"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\nstatic void (*udbg_uart_out)(unsigned int reg, u8 data);\nstatic union {\n\tunsigned char __iomem *mmio_base;\n\tunsigned long pio_base;\n} udbg_uart;\nstatic unsigned int udbg_uart_stride = 1;\n\nstatic void udbg_uart_out_pio(unsigned int reg, u8 data)\n{\n\toutb(data, udbg_uart.pio_base + (reg * udbg_uart_stride));\n}"
  },
  {
    "function_name": "udbg_uart_in_pio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "165-168",
    "snippet": "static u8 udbg_uart_in_pio(unsigned int reg)\n{\n\treturn inb(udbg_uart.pio_base + (reg * udbg_uart_stride));\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u8 (*udbg_uart_in)(unsigned int reg);",
      "static union {\n\tunsigned char __iomem *mmio_base;\n\tunsigned long pio_base;\n} udbg_uart;",
      "static unsigned int udbg_uart_stride = 1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "inb",
          "args": [
            "udbg_uart.pio_base + (reg * udbg_uart_stride)"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\nstatic union {\n\tunsigned char __iomem *mmio_base;\n\tunsigned long pio_base;\n} udbg_uart;\nstatic unsigned int udbg_uart_stride = 1;\n\nstatic u8 udbg_uart_in_pio(unsigned int reg)\n{\n\treturn inb(udbg_uart.pio_base + (reg * udbg_uart_stride));\n}"
  },
  {
    "function_name": "udbg_probe_uart_speed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "124-156",
    "snippet": "unsigned int udbg_probe_uart_speed(unsigned int clock)\n{\n\tunsigned int dll, dlm, divisor, prescaler, speed;\n\tu8 old_lcr;\n\n\told_lcr = udbg_uart_in(UART_LCR);\n\n\t/* select divisor latch registers.  */\n\tudbg_uart_out(UART_LCR, old_lcr | LCR_DLAB);\n\n\t/* now, read the divisor */\n\tdll = udbg_uart_in(UART_DLL);\n\tdlm = udbg_uart_in(UART_DLM);\n\tdivisor = dlm << 8 | dll;\n\n\t/* check prescaling */\n\tif (udbg_uart_in(UART_MCR) & 0x80)\n\t\tprescaler = 4;\n\telse\n\t\tprescaler = 1;\n\n\t/* restore the LCR */\n\tudbg_uart_out(UART_LCR, old_lcr);\n\n\t/* calculate speed */\n\tspeed = (clock / prescaler) / (divisor * 16);\n\n\t/* sanity check */\n\tif (speed > (clock / 16))\n\t\tspeed = 9600;\n\n\treturn speed;\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define LCR_DLAB 0x80",
      "#define UART_DLM\tUART_IER",
      "#define UART_DLL\tUART_RBR",
      "#define UART_MCR\t4",
      "#define UART_LCR\t3"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "udbg_uart_out",
          "args": [
            "UART_LCR",
            "old_lcr"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_uart_out_40x",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "285-289",
          "snippet": "static void udbg_uart_out_40x(unsigned int reg, u8 val)\n{\n\treal_writeb(val, (void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t    + reg);\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u8 (*udbg_uart_in)(unsigned int reg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic void udbg_uart_out_40x(unsigned int reg, u8 val)\n{\n\treal_writeb(val, (void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t    + reg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "udbg_uart_in",
          "args": [
            "UART_MCR"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_uart_in_40x",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "279-283",
          "snippet": "static u8 udbg_uart_in_40x(unsigned int reg)\n{\n\treturn real_readb((void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t\t  + reg);\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u8 (*udbg_uart_in)(unsigned int reg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic u8 udbg_uart_in_40x(unsigned int reg)\n{\n\treturn real_readb((void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t\t  + reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\n#define LCR_DLAB 0x80\n#define UART_DLM\tUART_IER\n#define UART_DLL\tUART_RBR\n#define UART_MCR\t4\n#define UART_LCR\t3\n\nunsigned int udbg_probe_uart_speed(unsigned int clock)\n{\n\tunsigned int dll, dlm, divisor, prescaler, speed;\n\tu8 old_lcr;\n\n\told_lcr = udbg_uart_in(UART_LCR);\n\n\t/* select divisor latch registers.  */\n\tudbg_uart_out(UART_LCR, old_lcr | LCR_DLAB);\n\n\t/* now, read the divisor */\n\tdll = udbg_uart_in(UART_DLL);\n\tdlm = udbg_uart_in(UART_DLM);\n\tdivisor = dlm << 8 | dll;\n\n\t/* check prescaling */\n\tif (udbg_uart_in(UART_MCR) & 0x80)\n\t\tprescaler = 4;\n\telse\n\t\tprescaler = 1;\n\n\t/* restore the LCR */\n\tudbg_uart_out(UART_LCR, old_lcr);\n\n\t/* calculate speed */\n\tspeed = (clock / prescaler) / (divisor * 16);\n\n\t/* sanity check */\n\tif (speed > (clock / 16))\n\t\tspeed = 9600;\n\n\treturn speed;\n}"
  },
  {
    "function_name": "udbg_uart_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "95-122",
    "snippet": "void udbg_uart_setup(unsigned int speed, unsigned int clock)\n{\n\tunsigned int dll, base_bauds;\n\n\tif (!udbg_uart_out)\n\t\treturn;\n\n\tif (clock == 0)\n\t\tclock = 1843200;\n\tif (speed == 0)\n\t\tspeed = 9600;\n\n\tbase_bauds = clock / 16;\n\tdll = base_bauds / speed;\n\n\tudbg_uart_out(UART_LCR, 0x00);\n\tudbg_uart_out(UART_IER, 0xff);\n\tudbg_uart_out(UART_IER, 0x00);\n\tudbg_uart_out(UART_LCR, LCR_DLAB);\n\tudbg_uart_out(UART_DLL, dll & 0xff);\n\tudbg_uart_out(UART_DLM, dll >> 8);\n\t/* 8 data, 1 stop, no parity */\n\tudbg_uart_out(UART_LCR, 0x3);\n\t/* RTS/DTR */\n\tudbg_uart_out(UART_MCR, 0x3);\n\t/* Clear & enable FIFOs */\n\tudbg_uart_out(UART_FCR, 0x7);\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define LCR_DLAB 0x80",
      "#define UART_DLM\tUART_IER",
      "#define UART_DLL\tUART_RBR",
      "#define UART_MCR\t4",
      "#define UART_LCR\t3",
      "#define UART_FCR\t2",
      "#define UART_IER\t1"
    ],
    "globals_used": [
      "static void (*udbg_uart_out)(unsigned int reg, u8 data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "udbg_uart_out",
          "args": [
            "UART_FCR",
            "0x7"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_uart_out_40x",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "285-289",
          "snippet": "static void udbg_uart_out_40x(unsigned int reg, u8 val)\n{\n\treal_writeb(val, (void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t    + reg);\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u8 (*udbg_uart_in)(unsigned int reg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic void udbg_uart_out_40x(unsigned int reg, u8 val)\n{\n\treal_writeb(val, (void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t    + reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\n#define LCR_DLAB 0x80\n#define UART_DLM\tUART_IER\n#define UART_DLL\tUART_RBR\n#define UART_MCR\t4\n#define UART_LCR\t3\n#define UART_FCR\t2\n#define UART_IER\t1\n\nstatic void (*udbg_uart_out)(unsigned int reg, u8 data);\n\nvoid udbg_uart_setup(unsigned int speed, unsigned int clock)\n{\n\tunsigned int dll, base_bauds;\n\n\tif (!udbg_uart_out)\n\t\treturn;\n\n\tif (clock == 0)\n\t\tclock = 1843200;\n\tif (speed == 0)\n\t\tspeed = 9600;\n\n\tbase_bauds = clock / 16;\n\tdll = base_bauds / speed;\n\n\tudbg_uart_out(UART_LCR, 0x00);\n\tudbg_uart_out(UART_IER, 0xff);\n\tudbg_uart_out(UART_IER, 0x00);\n\tudbg_uart_out(UART_LCR, LCR_DLAB);\n\tudbg_uart_out(UART_DLL, dll & 0xff);\n\tudbg_uart_out(UART_DLM, dll >> 8);\n\t/* 8 data, 1 stop, no parity */\n\tudbg_uart_out(UART_LCR, 0x3);\n\t/* RTS/DTR */\n\tudbg_uart_out(UART_MCR, 0x3);\n\t/* Clear & enable FIFOs */\n\tudbg_uart_out(UART_FCR, 0x7);\n}"
  },
  {
    "function_name": "udbg_use_uart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "87-93",
    "snippet": "static void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic void udbg_use_uart(void)\n{\n\tudbg_putc = udbg_uart_putc;\n\tudbg_flush = udbg_uart_flush;\n\tudbg_getc = udbg_uart_getc;\n\tudbg_getc_poll = udbg_uart_getc_poll;\n}"
  },
  {
    "function_name": "udbg_uart_getc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "77-85",
    "snippet": "static int udbg_uart_getc(void)\n{\n\tif (!udbg_uart_in)\n\t\treturn -1;\n\t/* wait for char */\n\twhile (!(udbg_uart_in(UART_LSR) & LSR_DR))\n\t\tcpu_relax();\n\treturn udbg_uart_in(UART_RBR);\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define LSR_DR   0x01  /* Data ready */",
      "#define UART_LSR\t5",
      "#define UART_RBR\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "udbg_uart_in",
          "args": [
            "UART_RBR"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_uart_in_40x",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "279-283",
          "snippet": "static u8 udbg_uart_in_40x(unsigned int reg)\n{\n\treturn real_readb((void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t\t  + reg);\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u8 (*udbg_uart_in)(unsigned int reg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic u8 udbg_uart_in_40x(unsigned int reg)\n{\n\treturn real_readb((void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t\t  + reg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_relax",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\n#define LSR_DR   0x01  /* Data ready */\n#define UART_LSR\t5\n#define UART_RBR\t0\n\nstatic int udbg_uart_getc(void)\n{\n\tif (!udbg_uart_in)\n\t\treturn -1;\n\t/* wait for char */\n\twhile (!(udbg_uart_in(UART_LSR) & LSR_DR))\n\t\tcpu_relax();\n\treturn udbg_uart_in(UART_RBR);\n}"
  },
  {
    "function_name": "udbg_uart_getc_poll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "66-75",
    "snippet": "static int udbg_uart_getc_poll(void)\n{\n\tif (!udbg_uart_in)\n\t\treturn -1;\n\n\tif (!(udbg_uart_in(UART_LSR) & LSR_DR))\n\t\treturn udbg_uart_in(UART_RBR);\n\n\treturn -1;\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define LSR_DR   0x01  /* Data ready */",
      "#define UART_LSR\t5",
      "#define UART_RBR\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "udbg_uart_in",
          "args": [
            "UART_RBR"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_uart_in_40x",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "279-283",
          "snippet": "static u8 udbg_uart_in_40x(unsigned int reg)\n{\n\treturn real_readb((void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t\t  + reg);\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u8 (*udbg_uart_in)(unsigned int reg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic u8 udbg_uart_in_40x(unsigned int reg)\n{\n\treturn real_readb((void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t\t  + reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\n#define LSR_DR   0x01  /* Data ready */\n#define UART_LSR\t5\n#define UART_RBR\t0\n\nstatic int udbg_uart_getc_poll(void)\n{\n\tif (!udbg_uart_in)\n\t\treturn -1;\n\n\tif (!(udbg_uart_in(UART_LSR) & LSR_DR))\n\t\treturn udbg_uart_in(UART_RBR);\n\n\treturn -1;\n}"
  },
  {
    "function_name": "udbg_uart_putc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "55-64",
    "snippet": "static void udbg_uart_putc(char c)\n{\n\tif (!udbg_uart_out)\n\t\treturn;\n\n\tif (c == '\\n')\n\t\tudbg_uart_putc('\\r');\n\tudbg_uart_flush();\n\tudbg_uart_out(UART_THR, c);\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define UART_THR\tUART_RBR"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "udbg_uart_out",
          "args": [
            "UART_THR",
            "c"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_uart_out_40x",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "285-289",
          "snippet": "static void udbg_uart_out_40x(unsigned int reg, u8 val)\n{\n\treal_writeb(val, (void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t    + reg);\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u8 (*udbg_uart_in)(unsigned int reg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic void udbg_uart_out_40x(unsigned int reg, u8 val)\n{\n\treal_writeb(val, (void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t    + reg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "udbg_uart_flush",
          "args": [],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_uart_flush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "45-53",
          "snippet": "static void udbg_uart_flush(void)\n{\n\tif (!udbg_uart_in)\n\t\treturn;\n\n\t/* wait for idle */\n\twhile ((udbg_uart_in(UART_LSR) & LSR_THRE) == 0)\n\t\tcpu_relax();\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define LSR_THRE 0x20  /* Xmit holding register empty */",
            "#define UART_LSR\t5"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\n#define LSR_THRE 0x20  /* Xmit holding register empty */\n#define UART_LSR\t5\n\nstatic void udbg_uart_flush(void)\n{\n\tif (!udbg_uart_in)\n\t\treturn;\n\n\t/* wait for idle */\n\twhile ((udbg_uart_in(UART_LSR) & LSR_THRE) == 0)\n\t\tcpu_relax();\n}"
        }
      },
      {
        "call_info": {
          "callee": "udbg_uart_putc",
          "args": [
            "'\\r'"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_uart_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "55-64",
          "snippet": "static void udbg_uart_putc(char c)\n{\n\tif (!udbg_uart_out)\n\t\treturn;\n\n\tif (c == '\\n')\n\t\tudbg_uart_putc('\\r');\n\tudbg_uart_flush();\n\tudbg_uart_out(UART_THR, c);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\n#define UART_THR\tUART_RBR\n\nstatic void udbg_uart_putc(char c)\n{\n\tif (!udbg_uart_out)\n\t\treturn;\n\n\tif (c == '\\n')\n\t\tudbg_uart_putc('\\r');\n\tudbg_uart_flush();\n\tudbg_uart_out(UART_THR, c);\n}"
  },
  {
    "function_name": "udbg_uart_flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
    "lines": "45-53",
    "snippet": "static void udbg_uart_flush(void)\n{\n\tif (!udbg_uart_in)\n\t\treturn;\n\n\t/* wait for idle */\n\twhile ((udbg_uart_in(UART_LSR) & LSR_THRE) == 0)\n\t\tcpu_relax();\n}",
    "includes": [
      "#include <platforms/44x/44x.h>",
      "#include <asm/reg_a2.h>",
      "#include <asm/io.h>",
      "#include <asm/udbg.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define LSR_THRE 0x20  /* Xmit holding register empty */",
      "#define UART_LSR\t5"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_relax",
          "args": [],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udbg_uart_in",
          "args": [
            "UART_LSR"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_uart_in_40x",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg_16550.c",
          "lines": "279-283",
          "snippet": "static u8 udbg_uart_in_40x(unsigned int reg)\n{\n\treturn real_readb((void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t\t  + reg);\n}",
          "includes": [
            "#include <platforms/44x/44x.h>",
            "#include <asm/reg_a2.h>",
            "#include <asm/io.h>",
            "#include <asm/udbg.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u8 (*udbg_uart_in)(unsigned int reg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\nstatic u8 (*udbg_uart_in)(unsigned int reg);\n\nstatic u8 udbg_uart_in_40x(unsigned int reg)\n{\n\treturn real_readb((void __iomem *)CONFIG_PPC_EARLY_DEBUG_40x_PHYSADDR\n\t\t\t  + reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <platforms/44x/44x.h>\n#include <asm/reg_a2.h>\n#include <asm/io.h>\n#include <asm/udbg.h>\n#include <linux/types.h>\n\n#define LSR_THRE 0x20  /* Xmit holding register empty */\n#define UART_LSR\t5\n\nstatic void udbg_uart_flush(void)\n{\n\tif (!udbg_uart_in)\n\t\treturn;\n\n\t/* wait for idle */\n\twhile ((udbg_uart_in(UART_LSR) & LSR_THRE) == 0)\n\t\tcpu_relax();\n}"
  }
]