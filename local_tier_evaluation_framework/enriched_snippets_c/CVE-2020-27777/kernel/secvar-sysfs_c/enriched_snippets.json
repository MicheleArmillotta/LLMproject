[
  {
    "function_name": "secvar_sysfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secvar-sysfs.c",
    "lines": "209-246",
    "snippet": "static int secvar_sysfs_init(void)\n{\n\tint rc;\n\n\tif (!secvar_ops) {\n\t\tpr_warn(\"secvar: failed to retrieve secvar operations.\\n\");\n\t\treturn -ENODEV;\n\t}\n\n\tsecvar_kobj = kobject_create_and_add(\"secvar\", firmware_kobj);\n\tif (!secvar_kobj) {\n\t\tpr_err(\"secvar: Failed to create firmware kobj\\n\");\n\t\treturn -ENOMEM;\n\t}\n\n\trc = sysfs_create_file(secvar_kobj, &format_attr.attr);\n\tif (rc) {\n\t\tkobject_put(secvar_kobj);\n\t\treturn -ENOMEM;\n\t}\n\n\tsecvar_kset = kset_create_and_add(\"vars\", NULL, secvar_kobj);\n\tif (!secvar_kset) {\n\t\tpr_err(\"secvar: sysfs kobject registration failed.\\n\");\n\t\tkobject_put(secvar_kobj);\n\t\treturn -ENOMEM;\n\t}\n\n\trc = update_kobj_size();\n\tif (rc) {\n\t\tpr_err(\"Cannot read the size of the attribute\\n\");\n\t\treturn rc;\n\t}\n\n\tsecvar_sysfs_load();\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/secvar.h>",
      "#include <linux/of.h>",
      "#include <linux/string.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobject *secvar_kobj;",
      "static struct kset *secvar_kset;",
      "static struct kobj_attribute format_attr = __ATTR_RO(format);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "secvar_sysfs_load",
          "args": [],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "secvar_sysfs_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secvar-sysfs.c",
          "lines": "164-207",
          "snippet": "static int secvar_sysfs_load(void)\n{\n\tchar *name;\n\tuint64_t namesize = 0;\n\tstruct kobject *kobj;\n\tint rc;\n\n\tname = kzalloc(NAME_MAX_SIZE, GFP_KERNEL);\n\tif (!name)\n\t\treturn -ENOMEM;\n\n\tdo {\n\t\trc = secvar_ops->get_next(name, &namesize, NAME_MAX_SIZE);\n\t\tif (rc) {\n\t\t\tif (rc != -ENOENT)\n\t\t\t\tpr_err(\"error getting secvar from firmware %d\\n\",\n\t\t\t\t       rc);\n\t\t\tbreak;\n\t\t}\n\n\t\tkobj = kzalloc(sizeof(*kobj), GFP_KERNEL);\n\t\tif (!kobj) {\n\t\t\trc = -ENOMEM;\n\t\t\tbreak;\n\t\t}\n\n\t\tkobject_init(kobj, &secvar_ktype);\n\n\t\trc = kobject_add(kobj, &secvar_kset->kobj, \"%s\", name);\n\t\tif (rc) {\n\t\t\tpr_warn(\"kobject_add error %d for attribute: %s\\n\", rc,\n\t\t\t\tname);\n\t\t\tkobject_put(kobj);\n\t\t\tkobj = NULL;\n\t\t}\n\n\t\tif (kobj)\n\t\t\tkobject_uevent(kobj, KOBJ_ADD);\n\n\t} while (!rc);\n\n\tkfree(name);\n\treturn rc;\n}",
          "includes": [
            "#include <asm/secvar.h>",
            "#include <linux/of.h>",
            "#include <linux/string.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [
            "#define NAME_MAX_SIZE\t   1024"
          ],
          "globals_used": [
            "static struct kset *secvar_kset;",
            "static struct kobj_type secvar_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.default_groups = secvar_attr_groups,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/secvar.h>\n#include <linux/of.h>\n#include <linux/string.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n\n#define NAME_MAX_SIZE\t   1024\n\nstatic struct kset *secvar_kset;\nstatic struct kobj_type secvar_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.default_groups = secvar_attr_groups,\n};\n\nstatic int secvar_sysfs_load(void)\n{\n\tchar *name;\n\tuint64_t namesize = 0;\n\tstruct kobject *kobj;\n\tint rc;\n\n\tname = kzalloc(NAME_MAX_SIZE, GFP_KERNEL);\n\tif (!name)\n\t\treturn -ENOMEM;\n\n\tdo {\n\t\trc = secvar_ops->get_next(name, &namesize, NAME_MAX_SIZE);\n\t\tif (rc) {\n\t\t\tif (rc != -ENOENT)\n\t\t\t\tpr_err(\"error getting secvar from firmware %d\\n\",\n\t\t\t\t       rc);\n\t\t\tbreak;\n\t\t}\n\n\t\tkobj = kzalloc(sizeof(*kobj), GFP_KERNEL);\n\t\tif (!kobj) {\n\t\t\trc = -ENOMEM;\n\t\t\tbreak;\n\t\t}\n\n\t\tkobject_init(kobj, &secvar_ktype);\n\n\t\trc = kobject_add(kobj, &secvar_kset->kobj, \"%s\", name);\n\t\tif (rc) {\n\t\t\tpr_warn(\"kobject_add error %d for attribute: %s\\n\", rc,\n\t\t\t\tname);\n\t\t\tkobject_put(kobj);\n\t\t\tkobj = NULL;\n\t\t}\n\n\t\tif (kobj)\n\t\t\tkobject_uevent(kobj, KOBJ_ADD);\n\n\t} while (!rc);\n\n\tkfree(name);\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Cannot read the size of the attribute\\n\""
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "update_kobj_size",
          "args": [],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "update_kobj_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secvar-sysfs.c",
          "lines": "138-162",
          "snippet": "static int update_kobj_size(void)\n{\n\n\tstruct device_node *node;\n\tu64 varsize;\n\tint rc = 0;\n\n\tnode = of_find_compatible_node(NULL, NULL, \"ibm,secvar-backend\");\n\tif (!of_device_is_available(node)) {\n\t\trc = -ENODEV;\n\t\tgoto out;\n\t}\n\n\trc = of_property_read_u64(node, \"max-var-size\", &varsize);\n\tif (rc)\n\t\tgoto out;\n\n\tdata_attr.size = varsize;\n\tupdate_attr.size = varsize;\n\nout:\n\tof_node_put(node);\n\n\treturn rc;\n}",
          "includes": [
            "#include <asm/secvar.h>",
            "#include <linux/of.h>",
            "#include <linux/string.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct bin_attribute data_attr = __BIN_ATTR_RO(data, 0);",
            "static struct bin_attribute update_attr = __BIN_ATTR_WO(update, 0);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/secvar.h>\n#include <linux/of.h>\n#include <linux/string.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n\nstatic struct bin_attribute data_attr = __BIN_ATTR_RO(data, 0);\nstatic struct bin_attribute update_attr = __BIN_ATTR_WO(update, 0);\n\nstatic int update_kobj_size(void)\n{\n\n\tstruct device_node *node;\n\tu64 varsize;\n\tint rc = 0;\n\n\tnode = of_find_compatible_node(NULL, NULL, \"ibm,secvar-backend\");\n\tif (!of_device_is_available(node)) {\n\t\trc = -ENODEV;\n\t\tgoto out;\n\t}\n\n\trc = of_property_read_u64(node, \"max-var-size\", &varsize);\n\tif (rc)\n\t\tgoto out;\n\n\tdata_attr.size = varsize;\n\tupdate_attr.size = varsize;\n\nout:\n\tof_node_put(node);\n\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "secvar_kobj"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"secvar: sysfs kobject registration failed.\\n\""
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kset_create_and_add",
          "args": [
            "\"vars\"",
            "NULL",
            "secvar_kobj"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "secvar_kobj"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_create_file",
          "args": [
            "secvar_kobj",
            "&format_attr.attr"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"secvar: Failed to create firmware kobj\\n\""
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_create_and_add",
          "args": [
            "\"secvar\"",
            "firmware_kobj"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"secvar: failed to retrieve secvar operations.\\n\""
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/secvar.h>\n#include <linux/of.h>\n#include <linux/string.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n\nstatic struct kobject *secvar_kobj;\nstatic struct kset *secvar_kset;\nstatic struct kobj_attribute format_attr = __ATTR_RO(format);\n\nstatic int secvar_sysfs_init(void)\n{\n\tint rc;\n\n\tif (!secvar_ops) {\n\t\tpr_warn(\"secvar: failed to retrieve secvar operations.\\n\");\n\t\treturn -ENODEV;\n\t}\n\n\tsecvar_kobj = kobject_create_and_add(\"secvar\", firmware_kobj);\n\tif (!secvar_kobj) {\n\t\tpr_err(\"secvar: Failed to create firmware kobj\\n\");\n\t\treturn -ENOMEM;\n\t}\n\n\trc = sysfs_create_file(secvar_kobj, &format_attr.attr);\n\tif (rc) {\n\t\tkobject_put(secvar_kobj);\n\t\treturn -ENOMEM;\n\t}\n\n\tsecvar_kset = kset_create_and_add(\"vars\", NULL, secvar_kobj);\n\tif (!secvar_kset) {\n\t\tpr_err(\"secvar: sysfs kobject registration failed.\\n\");\n\t\tkobject_put(secvar_kobj);\n\t\treturn -ENOMEM;\n\t}\n\n\trc = update_kobj_size();\n\tif (rc) {\n\t\tpr_err(\"Cannot read the size of the attribute\\n\");\n\t\treturn rc;\n\t}\n\n\tsecvar_sysfs_load();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "secvar_sysfs_load",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secvar-sysfs.c",
    "lines": "164-207",
    "snippet": "static int secvar_sysfs_load(void)\n{\n\tchar *name;\n\tuint64_t namesize = 0;\n\tstruct kobject *kobj;\n\tint rc;\n\n\tname = kzalloc(NAME_MAX_SIZE, GFP_KERNEL);\n\tif (!name)\n\t\treturn -ENOMEM;\n\n\tdo {\n\t\trc = secvar_ops->get_next(name, &namesize, NAME_MAX_SIZE);\n\t\tif (rc) {\n\t\t\tif (rc != -ENOENT)\n\t\t\t\tpr_err(\"error getting secvar from firmware %d\\n\",\n\t\t\t\t       rc);\n\t\t\tbreak;\n\t\t}\n\n\t\tkobj = kzalloc(sizeof(*kobj), GFP_KERNEL);\n\t\tif (!kobj) {\n\t\t\trc = -ENOMEM;\n\t\t\tbreak;\n\t\t}\n\n\t\tkobject_init(kobj, &secvar_ktype);\n\n\t\trc = kobject_add(kobj, &secvar_kset->kobj, \"%s\", name);\n\t\tif (rc) {\n\t\t\tpr_warn(\"kobject_add error %d for attribute: %s\\n\", rc,\n\t\t\t\tname);\n\t\t\tkobject_put(kobj);\n\t\t\tkobj = NULL;\n\t\t}\n\n\t\tif (kobj)\n\t\t\tkobject_uevent(kobj, KOBJ_ADD);\n\n\t} while (!rc);\n\n\tkfree(name);\n\treturn rc;\n}",
    "includes": [
      "#include <asm/secvar.h>",
      "#include <linux/of.h>",
      "#include <linux/string.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [
      "#define NAME_MAX_SIZE\t   1024"
    ],
    "globals_used": [
      "static struct kset *secvar_kset;",
      "static struct kobj_type secvar_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.default_groups = secvar_attr_groups,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "name"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_uevent",
          "args": [
            "kobj",
            "KOBJ_ADD"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "kobj"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"kobject_add error %d for attribute: %s\\n\"",
            "rc",
            "name"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_add",
          "args": [
            "kobj",
            "&secvar_kset->kobj",
            "\"%s\"",
            "name"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_init",
          "args": [
            "kobj",
            "&secvar_ktype"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*kobj)",
            "GFP_KERNEL"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"error getting secvar from firmware %d\\n\"",
            "rc"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "secvar_ops->get_next",
          "args": [
            "name",
            "&namesize",
            "NAME_MAX_SIZE"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "NAME_MAX_SIZE",
            "GFP_KERNEL"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/secvar.h>\n#include <linux/of.h>\n#include <linux/string.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n\n#define NAME_MAX_SIZE\t   1024\n\nstatic struct kset *secvar_kset;\nstatic struct kobj_type secvar_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.default_groups = secvar_attr_groups,\n};\n\nstatic int secvar_sysfs_load(void)\n{\n\tchar *name;\n\tuint64_t namesize = 0;\n\tstruct kobject *kobj;\n\tint rc;\n\n\tname = kzalloc(NAME_MAX_SIZE, GFP_KERNEL);\n\tif (!name)\n\t\treturn -ENOMEM;\n\n\tdo {\n\t\trc = secvar_ops->get_next(name, &namesize, NAME_MAX_SIZE);\n\t\tif (rc) {\n\t\t\tif (rc != -ENOENT)\n\t\t\t\tpr_err(\"error getting secvar from firmware %d\\n\",\n\t\t\t\t       rc);\n\t\t\tbreak;\n\t\t}\n\n\t\tkobj = kzalloc(sizeof(*kobj), GFP_KERNEL);\n\t\tif (!kobj) {\n\t\t\trc = -ENOMEM;\n\t\t\tbreak;\n\t\t}\n\n\t\tkobject_init(kobj, &secvar_ktype);\n\n\t\trc = kobject_add(kobj, &secvar_kset->kobj, \"%s\", name);\n\t\tif (rc) {\n\t\t\tpr_warn(\"kobject_add error %d for attribute: %s\\n\", rc,\n\t\t\t\tname);\n\t\t\tkobject_put(kobj);\n\t\t\tkobj = NULL;\n\t\t}\n\n\t\tif (kobj)\n\t\t\tkobject_uevent(kobj, KOBJ_ADD);\n\n\t} while (!rc);\n\n\tkfree(name);\n\treturn rc;\n}"
  },
  {
    "function_name": "update_kobj_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secvar-sysfs.c",
    "lines": "138-162",
    "snippet": "static int update_kobj_size(void)\n{\n\n\tstruct device_node *node;\n\tu64 varsize;\n\tint rc = 0;\n\n\tnode = of_find_compatible_node(NULL, NULL, \"ibm,secvar-backend\");\n\tif (!of_device_is_available(node)) {\n\t\trc = -ENODEV;\n\t\tgoto out;\n\t}\n\n\trc = of_property_read_u64(node, \"max-var-size\", &varsize);\n\tif (rc)\n\t\tgoto out;\n\n\tdata_attr.size = varsize;\n\tupdate_attr.size = varsize;\n\nout:\n\tof_node_put(node);\n\n\treturn rc;\n}",
    "includes": [
      "#include <asm/secvar.h>",
      "#include <linux/of.h>",
      "#include <linux/string.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct bin_attribute data_attr = __BIN_ATTR_RO(data, 0);",
      "static struct bin_attribute update_attr = __BIN_ATTR_WO(update, 0);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "node"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_property_read_u64",
          "args": [
            "node",
            "\"max-var-size\"",
            "&varsize"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_device_is_available",
          "args": [
            "node"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_compatible_node",
          "args": [
            "NULL",
            "NULL",
            "\"ibm,secvar-backend\""
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/secvar.h>\n#include <linux/of.h>\n#include <linux/string.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n\nstatic struct bin_attribute data_attr = __BIN_ATTR_RO(data, 0);\nstatic struct bin_attribute update_attr = __BIN_ATTR_WO(update, 0);\n\nstatic int update_kobj_size(void)\n{\n\n\tstruct device_node *node;\n\tu64 varsize;\n\tint rc = 0;\n\n\tnode = of_find_compatible_node(NULL, NULL, \"ibm,secvar-backend\");\n\tif (!of_device_is_available(node)) {\n\t\trc = -ENODEV;\n\t\tgoto out;\n\t}\n\n\trc = of_property_read_u64(node, \"max-var-size\", &varsize);\n\tif (rc)\n\t\tgoto out;\n\n\tdata_attr.size = varsize;\n\tupdate_attr.size = varsize;\n\nout:\n\tof_node_put(node);\n\n\treturn rc;\n}"
  },
  {
    "function_name": "update_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secvar-sysfs.c",
    "lines": "92-106",
    "snippet": "static ssize_t update_write(struct file *filep, struct kobject *kobj,\n\t\t\t    struct bin_attribute *attr, char *buf, loff_t off,\n\t\t\t    size_t count)\n{\n\tint rc;\n\n\tpr_debug(\"count is %ld\\n\", count);\n\trc = secvar_ops->set(kobj->name, strlen(kobj->name) + 1, buf, count);\n\tif (rc) {\n\t\tpr_err(\"Error setting the %s variable %d\\n\", kobj->name, rc);\n\t\treturn rc;\n\t}\n\n\treturn count;\n}",
    "includes": [
      "#include <asm/secvar.h>",
      "#include <linux/of.h>",
      "#include <linux/string.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Error setting the %s variable %d\\n\"",
            "kobj->name",
            "rc"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "secvar_ops->set",
          "args": [
            "kobj->name",
            "strlen(kobj->name) + 1",
            "buf",
            "count"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "kobj->name"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "270-277",
          "snippet": "static size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"count is %ld\\n\"",
            "count"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/secvar.h>\n#include <linux/of.h>\n#include <linux/string.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n\nstatic ssize_t update_write(struct file *filep, struct kobject *kobj,\n\t\t\t    struct bin_attribute *attr, char *buf, loff_t off,\n\t\t\t    size_t count)\n{\n\tint rc;\n\n\tpr_debug(\"count is %ld\\n\", count);\n\trc = secvar_ops->set(kobj->name, strlen(kobj->name) + 1, buf, count);\n\tif (rc) {\n\t\tpr_err(\"Error setting the %s variable %d\\n\", kobj->name, rc);\n\t\treturn rc;\n\t}\n\n\treturn count;\n}"
  },
  {
    "function_name": "data_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secvar-sysfs.c",
    "lines": "60-90",
    "snippet": "static ssize_t data_read(struct file *filep, struct kobject *kobj,\n\t\t\t struct bin_attribute *attr, char *buf, loff_t off,\n\t\t\t size_t count)\n{\n\tuint64_t dsize;\n\tchar *data;\n\tint rc;\n\n\trc = secvar_ops->get(kobj->name, strlen(kobj->name) + 1, NULL, &dsize);\n\tif (rc) {\n\t\tpr_err(\"Error getting %s variable size %d\\n\", kobj->name, rc);\n\t\treturn rc;\n\t}\n\tpr_debug(\"dsize is %llu\\n\", dsize);\n\n\tdata = kzalloc(dsize, GFP_KERNEL);\n\tif (!data)\n\t\treturn -ENOMEM;\n\n\trc = secvar_ops->get(kobj->name, strlen(kobj->name) + 1, data, &dsize);\n\tif (rc) {\n\t\tpr_err(\"Error getting %s variable %d\\n\", kobj->name, rc);\n\t\tgoto data_fail;\n\t}\n\n\trc = memory_read_from_buffer(buf, count, &off, data, dsize);\n\ndata_fail:\n\tkfree(data);\n\treturn rc;\n}",
    "includes": [
      "#include <asm/secvar.h>",
      "#include <linux/of.h>",
      "#include <linux/string.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "data"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_read_from_buffer",
          "args": [
            "buf",
            "count",
            "&off",
            "data",
            "dsize"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Error getting %s variable %d\\n\"",
            "kobj->name",
            "rc"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "secvar_ops->get",
          "args": [
            "kobj->name",
            "strlen(kobj->name) + 1",
            "data",
            "&dsize"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "kobj->name"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "270-277",
          "snippet": "static size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "dsize",
            "GFP_KERNEL"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"dsize is %llu\\n\"",
            "dsize"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Error getting %s variable size %d\\n\"",
            "kobj->name",
            "rc"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "secvar_ops->get",
          "args": [
            "kobj->name",
            "strlen(kobj->name) + 1",
            "NULL",
            "&dsize"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/secvar.h>\n#include <linux/of.h>\n#include <linux/string.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n\nstatic ssize_t data_read(struct file *filep, struct kobject *kobj,\n\t\t\t struct bin_attribute *attr, char *buf, loff_t off,\n\t\t\t size_t count)\n{\n\tuint64_t dsize;\n\tchar *data;\n\tint rc;\n\n\trc = secvar_ops->get(kobj->name, strlen(kobj->name) + 1, NULL, &dsize);\n\tif (rc) {\n\t\tpr_err(\"Error getting %s variable size %d\\n\", kobj->name, rc);\n\t\treturn rc;\n\t}\n\tpr_debug(\"dsize is %llu\\n\", dsize);\n\n\tdata = kzalloc(dsize, GFP_KERNEL);\n\tif (!data)\n\t\treturn -ENOMEM;\n\n\trc = secvar_ops->get(kobj->name, strlen(kobj->name) + 1, data, &dsize);\n\tif (rc) {\n\t\tpr_err(\"Error getting %s variable %d\\n\", kobj->name, rc);\n\t\tgoto data_fail;\n\t}\n\n\trc = memory_read_from_buffer(buf, count, &off, data, dsize);\n\ndata_fail:\n\tkfree(data);\n\treturn rc;\n}"
  },
  {
    "function_name": "size_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secvar-sysfs.c",
    "lines": "44-58",
    "snippet": "static ssize_t size_show(struct kobject *kobj, struct kobj_attribute *attr,\n\t\t\t char *buf)\n{\n\tuint64_t dsize;\n\tint rc;\n\n\trc = secvar_ops->get(kobj->name, strlen(kobj->name) + 1, NULL, &dsize);\n\tif (rc) {\n\t\tpr_err(\"Error retrieving %s variable size %d\\n\", kobj->name,\n\t\t       rc);\n\t\treturn rc;\n\t}\n\n\treturn sprintf(buf, \"%llu\\n\", dsize);\n}",
    "includes": [
      "#include <asm/secvar.h>",
      "#include <linux/of.h>",
      "#include <linux/string.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%llu\\n\"",
            "dsize"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Error retrieving %s variable size %d\\n\"",
            "kobj->name",
            "rc"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "secvar_ops->get",
          "args": [
            "kobj->name",
            "strlen(kobj->name) + 1",
            "NULL",
            "&dsize"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "kobj->name"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "270-277",
          "snippet": "static size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/secvar.h>\n#include <linux/of.h>\n#include <linux/string.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n\nstatic ssize_t size_show(struct kobject *kobj, struct kobj_attribute *attr,\n\t\t\t char *buf)\n{\n\tuint64_t dsize;\n\tint rc;\n\n\trc = secvar_ops->get(kobj->name, strlen(kobj->name) + 1, NULL, &dsize);\n\tif (rc) {\n\t\tpr_err(\"Error retrieving %s variable size %d\\n\", kobj->name,\n\t\t       rc);\n\t\treturn rc;\n\t}\n\n\treturn sprintf(buf, \"%llu\\n\", dsize);\n}"
  },
  {
    "function_name": "format_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secvar-sysfs.c",
    "lines": "21-41",
    "snippet": "static ssize_t format_show(struct kobject *kobj, struct kobj_attribute *attr,\n\t\t\t   char *buf)\n{\n\tssize_t rc = 0;\n\tstruct device_node *node;\n\tconst char *format;\n\n\tnode = of_find_compatible_node(NULL, NULL, \"ibm,secvar-backend\");\n\tif (!of_device_is_available(node))\n\t\treturn -ENODEV;\n\n\trc = of_property_read_string(node, \"format\", &format);\n\tif (rc)\n\t\treturn rc;\n\n\trc = sprintf(buf, \"%s\\n\", format);\n\n\tof_node_put(node);\n\n\treturn rc;\n}",
    "includes": [
      "#include <asm/secvar.h>",
      "#include <linux/of.h>",
      "#include <linux/string.h>",
      "#include <linux/compat.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "node"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%s\\n\"",
            "format"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_property_read_string",
          "args": [
            "node",
            "\"format\"",
            "&format"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_device_is_available",
          "args": [
            "node"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_compatible_node",
          "args": [
            "NULL",
            "NULL",
            "\"ibm,secvar-backend\""
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/secvar.h>\n#include <linux/of.h>\n#include <linux/string.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n\nstatic ssize_t format_show(struct kobject *kobj, struct kobj_attribute *attr,\n\t\t\t   char *buf)\n{\n\tssize_t rc = 0;\n\tstruct device_node *node;\n\tconst char *format;\n\n\tnode = of_find_compatible_node(NULL, NULL, \"ibm,secvar-backend\");\n\tif (!of_device_is_available(node))\n\t\treturn -ENODEV;\n\n\trc = of_property_read_string(node, \"format\", &format);\n\tif (rc)\n\t\treturn rc;\n\n\trc = sprintf(buf, \"%s\\n\", format);\n\n\tof_node_put(node);\n\n\treturn rc;\n}"
  }
]