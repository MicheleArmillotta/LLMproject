[
  {
    "function_name": "register_powersave_nap_sysctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/idle.c",
    "lines": "120-126",
    "snippet": "static int __init\nregister_powersave_nap_sysctl(void)\n{\n\tregister_sysctl_table(powersave_nap_sysctl_root);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/smp.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <linux/tick.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/cpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_sysctl_table",
          "args": [
            "powersave_nap_sysctl_root"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/smp.h>\n#include <asm/runlatch.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <linux/tick.h>\n#include <linux/sysctl.h>\n#include <linux/cpu.h>\n#include <linux/smp.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n\nstatic int __init\nregister_powersave_nap_sysctl(void)\n{\n\tregister_sysctl_table(powersave_nap_sysctl_root);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "power4_idle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/idle.c",
    "lines": "73-94",
    "snippet": "void power4_idle(void)\n{\n\tif (!cpu_has_feature(CPU_FTR_CAN_NAP))\n\t\treturn;\n\n\tif (!powersave_nap)\n\t\treturn;\n\n\tif (!prep_irq_for_idle())\n\t\treturn;\n\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC))\n\t\tasm volatile(\"DSSALL ; sync\" ::: \"memory\");\n\n\tpower4_idle_nap();\n\n\t/*\n\t * power4_idle_nap returns with interrupts enabled (soft and hard).\n\t * to our caller with interrupts enabled (soft and hard). Our caller\n\t * can cope with either interrupts disabled or enabled upon return.\n\t */\n}",
    "includes": [
      "#include <asm/smp.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <linux/tick.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/cpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int powersave_nap;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "power4_idle_nap",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ALTIVEC"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prep_irq_for_idle",
          "args": [],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "prep_irq_for_idle_irqsoff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/irq.c",
          "lines": "440-462",
          "snippet": "bool prep_irq_for_idle_irqsoff(void)\n{\n\tWARN_ON(!irqs_disabled());\n\n\t/*\n\t * First we need to hard disable to ensure no interrupt\n\t * occurs before we effectively enter the low power state\n\t */\n\t__hard_irq_disable();\n\tlocal_paca->irq_happened |= PACA_IRQ_HARD_DIS;\n\n\t/*\n\t * If anything happened while we were soft-disabled,\n\t * we return now and do not enter the low power state.\n\t */\n\tif (lazy_irq_pending())\n\t\treturn false;\n\n\t/* Tell lockdep we are about to re-enable */\n\ttrace_hardirqs_on();\n\n\treturn true;\n}",
          "includes": [
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/trace.h>",
            "#include <asm/dbell.h>",
            "#include <asm/lv1call.h>",
            "#include <asm/firmware.h>",
            "#include <asm/paca.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/smp.h>",
            "#include <asm/udbg.h>",
            "#include <asm/machdep.h>",
            "#include <asm/ptrace.h>",
            "#include <asm/prom.h>",
            "#include <asm/cache.h>",
            "#include <asm/irq.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/pci.h>",
            "#include <linux/mutex.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/list.h>",
            "#include <linux/bitops.h>",
            "#include <linux/profile.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/irq.h>",
            "#include <linux/delay.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/ioport.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/sched.h>",
            "#include <linux/signal.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/threads.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cpu_has_feature.h>\n#include <asm/trace.h>\n#include <asm/dbell.h>\n#include <asm/lv1call.h>\n#include <asm/firmware.h>\n#include <asm/paca.h>\n#include <asm/hw_irq.h>\n#include <asm/asm-prototypes.h>\n#include <asm/livepatch.h>\n#include <asm/smp.h>\n#include <asm/udbg.h>\n#include <asm/machdep.h>\n#include <asm/ptrace.h>\n#include <asm/prom.h>\n#include <asm/cache.h>\n#include <asm/irq.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <linux/pgtable.h>\n#include <linux/vmalloc.h>\n#include <linux/of_irq.h>\n#include <linux/of.h>\n#include <linux/debugfs.h>\n#include <linux/pci.h>\n#include <linux/mutex.h>\n#include <linux/radix-tree.h>\n#include <linux/list.h>\n#include <linux/bitops.h>\n#include <linux/profile.h>\n#include <linux/cpumask.h>\n#include <linux/seq_file.h>\n#include <linux/irq.h>\n#include <linux/delay.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/ioport.h>\n#include <linux/ptrace.h>\n#include <linux/sched.h>\n#include <linux/signal.h>\n#include <linux/kernel_stat.h>\n#include <linux/threads.h>\n#include <linux/export.h>\n\nbool prep_irq_for_idle_irqsoff(void)\n{\n\tWARN_ON(!irqs_disabled());\n\n\t/*\n\t * First we need to hard disable to ensure no interrupt\n\t * occurs before we effectively enter the low power state\n\t */\n\t__hard_irq_disable();\n\tlocal_paca->irq_happened |= PACA_IRQ_HARD_DIS;\n\n\t/*\n\t * If anything happened while we were soft-disabled,\n\t * we return now and do not enter the low power state.\n\t */\n\tif (lazy_irq_pending())\n\t\treturn false;\n\n\t/* Tell lockdep we are about to re-enable */\n\ttrace_hardirqs_on();\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_CAN_NAP"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/smp.h>\n#include <asm/runlatch.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <linux/tick.h>\n#include <linux/sysctl.h>\n#include <linux/cpu.h>\n#include <linux/smp.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n\nint powersave_nap;\n\nvoid power4_idle(void)\n{\n\tif (!cpu_has_feature(CPU_FTR_CAN_NAP))\n\t\treturn;\n\n\tif (!powersave_nap)\n\t\treturn;\n\n\tif (!prep_irq_for_idle())\n\t\treturn;\n\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC))\n\t\tasm volatile(\"DSSALL ; sync\" ::: \"memory\");\n\n\tpower4_idle_nap();\n\n\t/*\n\t * power4_idle_nap returns with interrupts enabled (soft and hard).\n\t * to our caller with interrupts enabled (soft and hard). Our caller\n\t * can cope with either interrupts disabled or enabled upon return.\n\t */\n}"
  },
  {
    "function_name": "arch_cpu_idle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/idle.c",
    "lines": "44-68",
    "snippet": "void arch_cpu_idle(void)\n{\n\tppc64_runlatch_off();\n\n\tif (ppc_md.power_save) {\n\t\tppc_md.power_save();\n\t\t/*\n\t\t * Some power_save functions return with\n\t\t * interrupts enabled, some don't.\n\t\t */\n\t\tif (irqs_disabled())\n\t\t\tlocal_irq_enable();\n\t} else {\n\t\tlocal_irq_enable();\n\t\t/*\n\t\t * Go into low thread priority and possibly\n\t\t * low power mode.\n\t\t */\n\t\tHMT_low();\n\t\tHMT_very_low();\n\t}\n\n\tHMT_medium();\n\tppc64_runlatch_on();\n}",
    "includes": [
      "#include <asm/smp.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <linux/tick.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/cpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc64_runlatch_on",
          "args": [],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "__ppc64_runlatch_on",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "2192-2216",
          "snippet": "void notrace __ppc64_runlatch_on(void)\n{\n\tstruct thread_info *ti = current_thread_info();\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206)) {\n\t\t/*\n\t\t * Least significant bit (RUN) is the only writable bit of\n\t\t * the CTRL register, so we can avoid mfspr. 2.06 is not the\n\t\t * earliest ISA where this is the case, but it's convenient.\n\t\t */\n\t\tmtspr(SPRN_CTRLT, CTRL_RUNLATCH);\n\t} else {\n\t\tunsigned long ctrl;\n\n\t\t/*\n\t\t * Some architectures (e.g., Cell) have writable fields other\n\t\t * than RUN, so do the read-modify-write.\n\t\t */\n\t\tctrl = mfspr(SPRN_CTRLF);\n\t\tctrl |= CTRL_RUNLATCH;\n\t\tmtspr(SPRN_CTRLT, ctrl);\n\t}\n\n\tti->local_flags |= _TLF_RUNLATCH;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __ppc64_runlatch_on(void)\n{\n\tstruct thread_info *ti = current_thread_info();\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206)) {\n\t\t/*\n\t\t * Least significant bit (RUN) is the only writable bit of\n\t\t * the CTRL register, so we can avoid mfspr. 2.06 is not the\n\t\t * earliest ISA where this is the case, but it's convenient.\n\t\t */\n\t\tmtspr(SPRN_CTRLT, CTRL_RUNLATCH);\n\t} else {\n\t\tunsigned long ctrl;\n\n\t\t/*\n\t\t * Some architectures (e.g., Cell) have writable fields other\n\t\t * than RUN, so do the read-modify-write.\n\t\t */\n\t\tctrl = mfspr(SPRN_CTRLF);\n\t\tctrl |= CTRL_RUNLATCH;\n\t\tmtspr(SPRN_CTRLT, ctrl);\n\t}\n\n\tti->local_flags |= _TLF_RUNLATCH;\n}"
        }
      },
      {
        "call_info": {
          "callee": "HMT_medium",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HMT_very_low",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HMT_low",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_enable",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_enable",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irqs_disabled",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.power_save",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc64_runlatch_off",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "__ppc64_runlatch_off",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "2219-2234",
          "snippet": "void notrace __ppc64_runlatch_off(void)\n{\n\tstruct thread_info *ti = current_thread_info();\n\n\tti->local_flags &= ~_TLF_RUNLATCH;\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206)) {\n\t\tmtspr(SPRN_CTRLT, 0);\n\t} else {\n\t\tunsigned long ctrl;\n\n\t\tctrl = mfspr(SPRN_CTRLF);\n\t\tctrl &= ~CTRL_RUNLATCH;\n\t\tmtspr(SPRN_CTRLT, ctrl);\n\t}\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __ppc64_runlatch_off(void)\n{\n\tstruct thread_info *ti = current_thread_info();\n\n\tti->local_flags &= ~_TLF_RUNLATCH;\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206)) {\n\t\tmtspr(SPRN_CTRLT, 0);\n\t} else {\n\t\tunsigned long ctrl;\n\n\t\tctrl = mfspr(SPRN_CTRLF);\n\t\tctrl &= ~CTRL_RUNLATCH;\n\t\tmtspr(SPRN_CTRLT, ctrl);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/smp.h>\n#include <asm/runlatch.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <linux/tick.h>\n#include <linux/sysctl.h>\n#include <linux/cpu.h>\n#include <linux/smp.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n\nvoid arch_cpu_idle(void)\n{\n\tppc64_runlatch_off();\n\n\tif (ppc_md.power_save) {\n\t\tppc_md.power_save();\n\t\t/*\n\t\t * Some power_save functions return with\n\t\t * interrupts enabled, some don't.\n\t\t */\n\t\tif (irqs_disabled())\n\t\t\tlocal_irq_enable();\n\t} else {\n\t\tlocal_irq_enable();\n\t\t/*\n\t\t * Go into low thread priority and possibly\n\t\t * low power mode.\n\t\t */\n\t\tHMT_low();\n\t\tHMT_very_low();\n\t}\n\n\tHMT_medium();\n\tppc64_runlatch_on();\n}"
  },
  {
    "function_name": "powersave_off",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/idle.c",
    "lines": "36-41",
    "snippet": "static int __init powersave_off(char *arg)\n{\n\tppc_md.power_save = NULL;\n\tcpuidle_disable = IDLE_POWERSAVE_OFF;\n\treturn 0;\n}",
    "includes": [
      "#include <asm/smp.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <linux/tick.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/cpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long cpuidle_disable = IDLE_NO_OVERRIDE;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <asm/smp.h>\n#include <asm/runlatch.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <linux/tick.h>\n#include <linux/sysctl.h>\n#include <linux/cpu.h>\n#include <linux/smp.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n\nunsigned long cpuidle_disable = IDLE_NO_OVERRIDE;\n\nstatic int __init powersave_off(char *arg)\n{\n\tppc_md.power_save = NULL;\n\tcpuidle_disable = IDLE_POWERSAVE_OFF;\n\treturn 0;\n}"
  }
]