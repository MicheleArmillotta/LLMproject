[
  {
    "function_name": "is_ppc_trustedboot_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secure_boot.c",
    "lines": "44-64",
    "snippet": "bool is_ppc_trustedboot_enabled(void)\n{\n\tstruct device_node *node;\n\tbool enabled = false;\n\tu32 trustedboot;\n\n\tnode = get_ppc_fw_sb_node();\n\tenabled = of_property_read_bool(node, \"trusted-enabled\");\n\tof_node_put(node);\n\n\tif (enabled)\n\t\tgoto out;\n\n\tif (!of_property_read_u32(of_root, \"ibm,trusted-boot\", &trustedboot))\n\t\tenabled = (trustedboot > 0);\n\nout:\n\tpr_info(\"Trusted boot mode %s\\n\", enabled ? \"enabled\" : \"disabled\");\n\n\treturn enabled;\n}",
    "includes": [
      "#include <asm/secure_boot.h>",
      "#include <linux/of.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Trusted boot mode %s\\n\"",
            "enabled ? \"enabled\" : \"disabled\""
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_property_read_u32",
          "args": [
            "of_root",
            "\"ibm,trusted-boot\"",
            "&trustedboot"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "node"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_property_read_bool",
          "args": [
            "node",
            "\"trusted-enabled\""
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_ppc_fw_sb_node",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "get_ppc_fw_sb_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secure_boot.c",
          "lines": "10-20",
          "snippet": "static struct device_node *get_ppc_fw_sb_node(void)\n{\n\tstatic const struct of_device_id ids[] = {\n\t\t{ .compatible = \"ibm,secureboot\", },\n\t\t{ .compatible = \"ibm,secureboot-v1\", },\n\t\t{ .compatible = \"ibm,secureboot-v2\", },\n\t\t{},\n\t};\n\n\treturn of_find_matching_node(NULL, ids);\n}",
          "includes": [
            "#include <asm/secure_boot.h>",
            "#include <linux/of.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/secure_boot.h>\n#include <linux/of.h>\n#include <linux/types.h>\n\nstatic struct device_node *get_ppc_fw_sb_node(void)\n{\n\tstatic const struct of_device_id ids[] = {\n\t\t{ .compatible = \"ibm,secureboot\", },\n\t\t{ .compatible = \"ibm,secureboot-v1\", },\n\t\t{ .compatible = \"ibm,secureboot-v2\", },\n\t\t{},\n\t};\n\n\treturn of_find_matching_node(NULL, ids);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/secure_boot.h>\n#include <linux/of.h>\n#include <linux/types.h>\n\nbool is_ppc_trustedboot_enabled(void)\n{\n\tstruct device_node *node;\n\tbool enabled = false;\n\tu32 trustedboot;\n\n\tnode = get_ppc_fw_sb_node();\n\tenabled = of_property_read_bool(node, \"trusted-enabled\");\n\tof_node_put(node);\n\n\tif (enabled)\n\t\tgoto out;\n\n\tif (!of_property_read_u32(of_root, \"ibm,trusted-boot\", &trustedboot))\n\t\tenabled = (trustedboot > 0);\n\nout:\n\tpr_info(\"Trusted boot mode %s\\n\", enabled ? \"enabled\" : \"disabled\");\n\n\treturn enabled;\n}"
  },
  {
    "function_name": "is_ppc_secureboot_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secure_boot.c",
    "lines": "22-42",
    "snippet": "bool is_ppc_secureboot_enabled(void)\n{\n\tstruct device_node *node;\n\tbool enabled = false;\n\tu32 secureboot;\n\n\tnode = get_ppc_fw_sb_node();\n\tenabled = of_property_read_bool(node, \"os-secureboot-enforcing\");\n\tof_node_put(node);\n\n\tif (enabled)\n\t\tgoto out;\n\n\tif (!of_property_read_u32(of_root, \"ibm,secure-boot\", &secureboot))\n\t\tenabled = (secureboot > 1);\n\nout:\n\tpr_info(\"Secure boot mode %s\\n\", enabled ? \"enabled\" : \"disabled\");\n\n\treturn enabled;\n}",
    "includes": [
      "#include <asm/secure_boot.h>",
      "#include <linux/of.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Secure boot mode %s\\n\"",
            "enabled ? \"enabled\" : \"disabled\""
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_property_read_u32",
          "args": [
            "of_root",
            "\"ibm,secure-boot\"",
            "&secureboot"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "node"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_property_read_bool",
          "args": [
            "node",
            "\"os-secureboot-enforcing\""
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_ppc_fw_sb_node",
          "args": [],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "get_ppc_fw_sb_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secure_boot.c",
          "lines": "10-20",
          "snippet": "static struct device_node *get_ppc_fw_sb_node(void)\n{\n\tstatic const struct of_device_id ids[] = {\n\t\t{ .compatible = \"ibm,secureboot\", },\n\t\t{ .compatible = \"ibm,secureboot-v1\", },\n\t\t{ .compatible = \"ibm,secureboot-v2\", },\n\t\t{},\n\t};\n\n\treturn of_find_matching_node(NULL, ids);\n}",
          "includes": [
            "#include <asm/secure_boot.h>",
            "#include <linux/of.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/secure_boot.h>\n#include <linux/of.h>\n#include <linux/types.h>\n\nstatic struct device_node *get_ppc_fw_sb_node(void)\n{\n\tstatic const struct of_device_id ids[] = {\n\t\t{ .compatible = \"ibm,secureboot\", },\n\t\t{ .compatible = \"ibm,secureboot-v1\", },\n\t\t{ .compatible = \"ibm,secureboot-v2\", },\n\t\t{},\n\t};\n\n\treturn of_find_matching_node(NULL, ids);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/secure_boot.h>\n#include <linux/of.h>\n#include <linux/types.h>\n\nbool is_ppc_secureboot_enabled(void)\n{\n\tstruct device_node *node;\n\tbool enabled = false;\n\tu32 secureboot;\n\n\tnode = get_ppc_fw_sb_node();\n\tenabled = of_property_read_bool(node, \"os-secureboot-enforcing\");\n\tof_node_put(node);\n\n\tif (enabled)\n\t\tgoto out;\n\n\tif (!of_property_read_u32(of_root, \"ibm,secure-boot\", &secureboot))\n\t\tenabled = (secureboot > 1);\n\nout:\n\tpr_info(\"Secure boot mode %s\\n\", enabled ? \"enabled\" : \"disabled\");\n\n\treturn enabled;\n}"
  },
  {
    "function_name": "get_ppc_fw_sb_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/secure_boot.c",
    "lines": "10-20",
    "snippet": "static struct device_node *get_ppc_fw_sb_node(void)\n{\n\tstatic const struct of_device_id ids[] = {\n\t\t{ .compatible = \"ibm,secureboot\", },\n\t\t{ .compatible = \"ibm,secureboot-v1\", },\n\t\t{ .compatible = \"ibm,secureboot-v2\", },\n\t\t{},\n\t};\n\n\treturn of_find_matching_node(NULL, ids);\n}",
    "includes": [
      "#include <asm/secure_boot.h>",
      "#include <linux/of.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_find_matching_node",
          "args": [
            "NULL",
            "ids"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/secure_boot.h>\n#include <linux/of.h>\n#include <linux/types.h>\n\nstatic struct device_node *get_ppc_fw_sb_node(void)\n{\n\tstatic const struct of_device_id ids[] = {\n\t\t{ .compatible = \"ibm,secureboot\", },\n\t\t{ .compatible = \"ibm,secureboot-v1\", },\n\t\t{ .compatible = \"ibm,secureboot-v2\", },\n\t\t{},\n\t};\n\n\treturn of_find_matching_node(NULL, ids);\n}"
  }
]