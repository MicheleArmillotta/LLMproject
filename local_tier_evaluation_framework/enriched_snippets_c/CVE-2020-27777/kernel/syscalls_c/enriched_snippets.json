[
  {
    "function_name": "ppc_fadvise64_64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/syscalls.c",
    "lines": "114-119",
    "snippet": "long ppc_fadvise64_64(int fd, int advice, u32 offset_high, u32 offset_low,\n\t\t      u32 len_high, u32 len_low)\n{\n\treturn ksys_fadvise64_64(fd, (u64)offset_high << 32 | offset_low,\n\t\t\t\t (u64)len_high << 32 | len_low, advice);\n}",
    "includes": [
      "#include <asm/asm-prototypes.h>",
      "#include <asm/unistd.h>",
      "#include <asm/time.h>",
      "#include <asm/syscalls.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/personality.h>",
      "#include <linux/file.h>",
      "#include <linux/utsname.h>",
      "#include <linux/ipc.h>",
      "#include <linux/sys.h>",
      "#include <linux/mman.h>",
      "#include <linux/stat.h>",
      "#include <linux/shm.h>",
      "#include <linux/msg.h>",
      "#include <linux/sem.h>",
      "#include <linux/smp.h>",
      "#include <linux/fs.h>",
      "#include <linux/mm.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ksys_fadvise64_64",
          "args": [
            "fd",
            "(u64)offset_high << 32 | offset_low",
            "(u64)len_high << 32 | len_low",
            "advice"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/asm-prototypes.h>\n#include <asm/unistd.h>\n#include <asm/time.h>\n#include <asm/syscalls.h>\n#include <linux/uaccess.h>\n#include <linux/personality.h>\n#include <linux/file.h>\n#include <linux/utsname.h>\n#include <linux/ipc.h>\n#include <linux/sys.h>\n#include <linux/mman.h>\n#include <linux/stat.h>\n#include <linux/shm.h>\n#include <linux/msg.h>\n#include <linux/sem.h>\n#include <linux/smp.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/syscalls.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nlong ppc_fadvise64_64(int fd, int advice, u32 offset_high, u32 offset_low,\n\t\t      u32 len_high, u32 len_low)\n{\n\treturn ksys_fadvise64_64(fd, (u64)offset_high << 32 | offset_low,\n\t\t\t\t (u64)len_high << 32 | len_low, advice);\n}"
  },
  {
    "function_name": "ppc64_personality",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/syscalls.c",
    "lines": "100-111",
    "snippet": "long ppc64_personality(unsigned long personality)\n{\n\tlong ret;\n\n\tif (personality(current->personality) == PER_LINUX32\n\t    && personality(personality) == PER_LINUX)\n\t\tpersonality = (personality & ~PER_MASK) | PER_LINUX32;\n\tret = sys_personality(personality);\n\tif (personality(ret) == PER_LINUX32)\n\t\tret = (ret & ~PER_MASK) | PER_LINUX;\n\treturn ret;\n}",
    "includes": [
      "#include <asm/asm-prototypes.h>",
      "#include <asm/unistd.h>",
      "#include <asm/time.h>",
      "#include <asm/syscalls.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/personality.h>",
      "#include <linux/file.h>",
      "#include <linux/utsname.h>",
      "#include <linux/ipc.h>",
      "#include <linux/sys.h>",
      "#include <linux/mman.h>",
      "#include <linux/stat.h>",
      "#include <linux/shm.h>",
      "#include <linux/msg.h>",
      "#include <linux/sem.h>",
      "#include <linux/smp.h>",
      "#include <linux/fs.h>",
      "#include <linux/mm.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "personality",
          "args": [
            "ret"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "ppc64_personality",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/syscalls.c",
          "lines": "100-111",
          "snippet": "long ppc64_personality(unsigned long personality)\n{\n\tlong ret;\n\n\tif (personality(current->personality) == PER_LINUX32\n\t    && personality(personality) == PER_LINUX)\n\t\tpersonality = (personality & ~PER_MASK) | PER_LINUX32;\n\tret = sys_personality(personality);\n\tif (personality(ret) == PER_LINUX32)\n\t\tret = (ret & ~PER_MASK) | PER_LINUX;\n\treturn ret;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "sys_personality",
          "args": [
            "personality"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/asm-prototypes.h>\n#include <asm/unistd.h>\n#include <asm/time.h>\n#include <asm/syscalls.h>\n#include <linux/uaccess.h>\n#include <linux/personality.h>\n#include <linux/file.h>\n#include <linux/utsname.h>\n#include <linux/ipc.h>\n#include <linux/sys.h>\n#include <linux/mman.h>\n#include <linux/stat.h>\n#include <linux/shm.h>\n#include <linux/msg.h>\n#include <linux/sem.h>\n#include <linux/smp.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/syscalls.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nlong ppc64_personality(unsigned long personality)\n{\n\tlong ret;\n\n\tif (personality(current->personality) == PER_LINUX32\n\t    && personality(personality) == PER_LINUX)\n\t\tpersonality = (personality & ~PER_MASK) | PER_LINUX32;\n\tret = sys_personality(personality);\n\tif (personality(ret) == PER_LINUX32)\n\t\tret = (ret & ~PER_MASK) | PER_LINUX;\n\treturn ret;\n}"
  },
  {
    "function_name": "ppc_select",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/syscalls.c",
    "lines": "81-96",
    "snippet": "int\nppc_select(int n, fd_set __user *inp, fd_set __user *outp, fd_set __user *exp, struct __kernel_old_timeval __user *tvp)\n{\n\tif ( (unsigned long)n >= 4096 )\n\t{\n\t\tunsigned long __user *buffer = (unsigned long __user *)n;\n\t\tif (!access_ok(buffer, 5*sizeof(unsigned long))\n\t\t    || __get_user(n, buffer)\n\t\t    || __get_user(inp, ((fd_set __user * __user *)(buffer+1)))\n\t\t    || __get_user(outp, ((fd_set  __user * __user *)(buffer+2)))\n\t\t    || __get_user(exp, ((fd_set  __user * __user *)(buffer+3)))\n\t\t    || __get_user(tvp, ((struct __kernel_old_timeval  __user * __user *)(buffer+4))))\n\t\t\treturn -EFAULT;\n\t}\n\treturn sys_select(n, inp, outp, exp, tvp);\n}",
    "includes": [
      "#include <asm/asm-prototypes.h>",
      "#include <asm/unistd.h>",
      "#include <asm/time.h>",
      "#include <asm/syscalls.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/personality.h>",
      "#include <linux/file.h>",
      "#include <linux/utsname.h>",
      "#include <linux/ipc.h>",
      "#include <linux/sys.h>",
      "#include <linux/mman.h>",
      "#include <linux/stat.h>",
      "#include <linux/shm.h>",
      "#include <linux/msg.h>",
      "#include <linux/sem.h>",
      "#include <linux/smp.h>",
      "#include <linux/fs.h>",
      "#include <linux/mm.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sys_select",
          "args": [
            "n",
            "inp",
            "outp",
            "exp",
            "tvp"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "tvp",
            "((struct __kernel_old_timeval  __user * __user *)(buffer+4))"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "buffer+4"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "exp",
            "((fd_set  __user * __user *)(buffer+3))"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "buffer+3"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "outp",
            "((fd_set  __user * __user *)(buffer+2))"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "buffer+2"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "inp",
            "((fd_set __user * __user *)(buffer+1))"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "buffer+1"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "n",
            "buffer"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "buffer",
            "5*sizeof(unsigned long)"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/asm-prototypes.h>\n#include <asm/unistd.h>\n#include <asm/time.h>\n#include <asm/syscalls.h>\n#include <linux/uaccess.h>\n#include <linux/personality.h>\n#include <linux/file.h>\n#include <linux/utsname.h>\n#include <linux/ipc.h>\n#include <linux/sys.h>\n#include <linux/mman.h>\n#include <linux/stat.h>\n#include <linux/shm.h>\n#include <linux/msg.h>\n#include <linux/sem.h>\n#include <linux/smp.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/syscalls.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint\nppc_select(int n, fd_set __user *inp, fd_set __user *outp, fd_set __user *exp, struct __kernel_old_timeval __user *tvp)\n{\n\tif ( (unsigned long)n >= 4096 )\n\t{\n\t\tunsigned long __user *buffer = (unsigned long __user *)n;\n\t\tif (!access_ok(buffer, 5*sizeof(unsigned long))\n\t\t    || __get_user(n, buffer)\n\t\t    || __get_user(inp, ((fd_set __user * __user *)(buffer+1)))\n\t\t    || __get_user(outp, ((fd_set  __user * __user *)(buffer+2)))\n\t\t    || __get_user(exp, ((fd_set  __user * __user *)(buffer+3)))\n\t\t    || __get_user(tvp, ((struct __kernel_old_timeval  __user * __user *)(buffer+4))))\n\t\t\treturn -EFAULT;\n\t}\n\treturn sys_select(n, inp, outp, exp, tvp);\n}"
  },
  {
    "function_name": "do_mmap2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/syscalls.c",
    "lines": "40-58",
    "snippet": "static inline long do_mmap2(unsigned long addr, size_t len,\n\t\t\tunsigned long prot, unsigned long flags,\n\t\t\tunsigned long fd, unsigned long off, int shift)\n{\n\tlong ret = -EINVAL;\n\n\tif (!arch_validate_prot(prot, addr))\n\t\tgoto out;\n\n\tif (shift) {\n\t\tif (off & ((1 << shift) - 1))\n\t\t\tgoto out;\n\t\toff >>= shift;\n\t}\n\n\tret = ksys_mmap_pgoff(addr, len, prot, flags, fd, off);\nout:\n\treturn ret;\n}",
    "includes": [
      "#include <asm/asm-prototypes.h>",
      "#include <asm/unistd.h>",
      "#include <asm/time.h>",
      "#include <asm/syscalls.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/personality.h>",
      "#include <linux/file.h>",
      "#include <linux/utsname.h>",
      "#include <linux/ipc.h>",
      "#include <linux/sys.h>",
      "#include <linux/mman.h>",
      "#include <linux/stat.h>",
      "#include <linux/shm.h>",
      "#include <linux/msg.h>",
      "#include <linux/sem.h>",
      "#include <linux/smp.h>",
      "#include <linux/fs.h>",
      "#include <linux/mm.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ksys_mmap_pgoff",
          "args": [
            "addr",
            "len",
            "prot",
            "flags",
            "fd",
            "off"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arch_validate_prot",
          "args": [
            "prot",
            "addr"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/asm-prototypes.h>\n#include <asm/unistd.h>\n#include <asm/time.h>\n#include <asm/syscalls.h>\n#include <linux/uaccess.h>\n#include <linux/personality.h>\n#include <linux/file.h>\n#include <linux/utsname.h>\n#include <linux/ipc.h>\n#include <linux/sys.h>\n#include <linux/mman.h>\n#include <linux/stat.h>\n#include <linux/shm.h>\n#include <linux/msg.h>\n#include <linux/sem.h>\n#include <linux/smp.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/syscalls.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline long do_mmap2(unsigned long addr, size_t len,\n\t\t\tunsigned long prot, unsigned long flags,\n\t\t\tunsigned long fd, unsigned long off, int shift)\n{\n\tlong ret = -EINVAL;\n\n\tif (!arch_validate_prot(prot, addr))\n\t\tgoto out;\n\n\tif (shift) {\n\t\tif (off & ((1 << shift) - 1))\n\t\t\tgoto out;\n\t\toff >>= shift;\n\t}\n\n\tret = ksys_mmap_pgoff(addr, len, prot, flags, fd, off);\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "mmap2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/syscalls.c",
    "lines": "60-65",
    "snippet": "SYSCALL_DEFINE6(mmap2, unsigned long, addr, size_t, len,\n\t\tunsigned long, prot, unsigned long, flags,\n\t\tunsigned long, fd, unsigned long, pgoff)\n{\n\treturn do_mmap2(addr, len, prot, flags, fd, pgoff, PAGE_SHIFT-12);\n}",
    "includes": [
      "#include <asm/asm-prototypes.h>",
      "#include <asm/unistd.h>",
      "#include <asm/time.h>",
      "#include <asm/syscalls.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/personality.h>",
      "#include <linux/file.h>",
      "#include <linux/utsname.h>",
      "#include <linux/ipc.h>",
      "#include <linux/sys.h>",
      "#include <linux/mman.h>",
      "#include <linux/stat.h>",
      "#include <linux/shm.h>",
      "#include <linux/msg.h>",
      "#include <linux/sem.h>",
      "#include <linux/smp.h>",
      "#include <linux/fs.h>",
      "#include <linux/mm.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/asm-prototypes.h>\n#include <asm/unistd.h>\n#include <asm/time.h>\n#include <asm/syscalls.h>\n#include <linux/uaccess.h>\n#include <linux/personality.h>\n#include <linux/file.h>\n#include <linux/utsname.h>\n#include <linux/ipc.h>\n#include <linux/sys.h>\n#include <linux/mman.h>\n#include <linux/stat.h>\n#include <linux/shm.h>\n#include <linux/msg.h>\n#include <linux/sem.h>\n#include <linux/smp.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/syscalls.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nSYSCALL_DEFINE6(mmap2, unsigned long, addr, size_t, len,\n\t\tunsigned long, prot, unsigned long, flags,\n\t\tunsigned long, fd, unsigned long, pgoff)\n{\n\treturn do_mmap2(addr, len, prot, flags, fd, pgoff, PAGE_SHIFT-12);\n}"
  },
  {
    "function_name": "mmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/syscalls.c",
    "lines": "67-72",
    "snippet": "SYSCALL_DEFINE6(mmap, unsigned long, addr, size_t, len,\n\t\tunsigned long, prot, unsigned long, flags,\n\t\tunsigned long, fd, off_t, offset)\n{\n\treturn do_mmap2(addr, len, prot, flags, fd, offset, PAGE_SHIFT);\n}",
    "includes": [
      "#include <asm/asm-prototypes.h>",
      "#include <asm/unistd.h>",
      "#include <asm/time.h>",
      "#include <asm/syscalls.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/personality.h>",
      "#include <linux/file.h>",
      "#include <linux/utsname.h>",
      "#include <linux/ipc.h>",
      "#include <linux/sys.h>",
      "#include <linux/mman.h>",
      "#include <linux/stat.h>",
      "#include <linux/shm.h>",
      "#include <linux/msg.h>",
      "#include <linux/sem.h>",
      "#include <linux/smp.h>",
      "#include <linux/fs.h>",
      "#include <linux/mm.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/asm-prototypes.h>\n#include <asm/unistd.h>\n#include <asm/time.h>\n#include <asm/syscalls.h>\n#include <linux/uaccess.h>\n#include <linux/personality.h>\n#include <linux/file.h>\n#include <linux/utsname.h>\n#include <linux/ipc.h>\n#include <linux/sys.h>\n#include <linux/mman.h>\n#include <linux/stat.h>\n#include <linux/shm.h>\n#include <linux/msg.h>\n#include <linux/sem.h>\n#include <linux/smp.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/syscalls.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nSYSCALL_DEFINE6(mmap, unsigned long, addr, size_t, len,\n\t\tunsigned long, prot, unsigned long, flags,\n\t\tunsigned long, fd, off_t, offset)\n{\n\treturn do_mmap2(addr, len, prot, flags, fd, offset, PAGE_SHIFT);\n}"
  },
  {
    "function_name": "switch_endian",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/syscalls.c",
    "lines": "121-136",
    "snippet": "SYSCALL_DEFINE0(switch_endian)\n{\n\tstruct thread_info *ti;\n\n\tcurrent->thread.regs->msr ^= MSR_LE;\n\n\t/*\n\t * Set TIF_RESTOREALL so that r3 isn't clobbered on return to\n\t * userspace. That also has the effect of restoring the non-volatile\n\t * GPRs, so we saved them on the way in here.\n\t */\n\tti = current_thread_info();\n\tti->flags |= _TIF_RESTOREALL;\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/asm-prototypes.h>",
      "#include <asm/unistd.h>",
      "#include <asm/time.h>",
      "#include <asm/syscalls.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/personality.h>",
      "#include <linux/file.h>",
      "#include <linux/utsname.h>",
      "#include <linux/ipc.h>",
      "#include <linux/sys.h>",
      "#include <linux/mman.h>",
      "#include <linux/stat.h>",
      "#include <linux/shm.h>",
      "#include <linux/msg.h>",
      "#include <linux/sem.h>",
      "#include <linux/smp.h>",
      "#include <linux/fs.h>",
      "#include <linux/mm.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/sched.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/asm-prototypes.h>\n#include <asm/unistd.h>\n#include <asm/time.h>\n#include <asm/syscalls.h>\n#include <linux/uaccess.h>\n#include <linux/personality.h>\n#include <linux/file.h>\n#include <linux/utsname.h>\n#include <linux/ipc.h>\n#include <linux/sys.h>\n#include <linux/mman.h>\n#include <linux/stat.h>\n#include <linux/shm.h>\n#include <linux/msg.h>\n#include <linux/sem.h>\n#include <linux/smp.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/syscalls.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nSYSCALL_DEFINE0(switch_endian)\n{\n\tstruct thread_info *ti;\n\n\tcurrent->thread.regs->msr ^= MSR_LE;\n\n\t/*\n\t * Set TIF_RESTOREALL so that r3 isn't clobbered on return to\n\t * userspace. That also has the effect of restoring the non-volatile\n\t * GPRs, so we saved them on the way in here.\n\t */\n\tti = current_thread_info();\n\tti->flags |= _TIF_RESTOREALL;\n\n\treturn 0;\n}"
  }
]