[
  {
    "function_name": "attach_system_cgroup_pid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "494-530",
    "snippet": "extern void attach_system_cgroup_pid(pid_t pid)\n{\n\tchar* slurm_cgpath;\n\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn;\n\n\tslurm_cgpath = (char*) xstrdup(slurm_cgroup_conf.cgroup_prepend);\n#ifdef MULTIPLE_SLURMD\n\tif ( conf->node_name != NULL )\n\t\txstrsubstitute(slurm_cgpath,\"%n\", conf->node_name);\n\telse {\n\t\txfree(slurm_cgpath);\n\t\tslurm_cgpath = (char*) xstrdup(\"/slurm\");\n\t}\n#endif\n\txstrcat(slurm_cgpath,\"/system\");\n\tif (xcgroup_ns_load(&slurm_cgroup_conf, &cpuset_ns, \"cpuset\")\n\t    == XCGROUP_SUCCESS) {\n\t\tif (xcgroup_load(&cpuset_ns, &system_cpuset_cg, slurm_cgpath)\n\t\t    == XCGROUP_SUCCESS)\n\t\t\tif (attach_system_cpuset_pid(pid) != SLURM_SUCCESS)\n\t\t\t\tdebug2(\"system cgroup: unable to attach pid to \"\n\t\t\t\t       \"system cpuset cgroup\");\n\t}\n\tif (xcgroup_ns_load(&slurm_cgroup_conf, &memory_ns, \"memory\")\n\t    == XCGROUP_SUCCESS) {\n\t\tif (xcgroup_load(&memory_ns, &system_memory_cg, slurm_cgpath)\n\t\t    == XCGROUP_SUCCESS)\n\t\t\tif (attach_system_memory_pid(pid) != SLURM_SUCCESS)\n\t\t\t\tdebug2(\"system cgroup: unable to attach pid to \"\n\t\t\t\t       \"system memory cgroup\");\n\t}\n\txfree(slurm_cgpath);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
      "static xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
      "static xcgroup_ns_t cpuset_ns = {NULL, NULL, NULL, NULL};",
      "static xcgroup_ns_t memory_ns = {NULL, NULL, NULL, NULL};",
      "static slurm_cgroup_conf_t slurm_cgroup_conf;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "slurm_cgpath"
          ],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"system cgroup: unable to attach pid to \"\n\t\t\t\t       \"system memory cgroup\""
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "attach_system_memory_pid",
          "args": [
            "pid"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "attach_system_memory_pid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "455-460",
          "snippet": "extern int attach_system_memory_pid(pid_t pid)\n{\n\tif (xcgroup_add_pids(&system_memory_cg, &pid, 1) != XCGROUP_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\n\nextern int attach_system_memory_pid(pid_t pid)\n{\n\tif (xcgroup_add_pids(&system_memory_cg, &pid, 1) != XCGROUP_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_load",
          "args": [
            "&memory_ns",
            "&system_memory_cg",
            "slurm_cgpath"
          ],
          "line": 521
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "497-529",
          "snippet": "int xcgroup_load(xcgroup_ns_t* cgns, xcgroup_t* cg, char* uri)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\tstruct stat buf;\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\tif (stat((const char*)file_path, &buf)) {\n\t\tdebug2(\"%s: unable to get cgroup '%s' entry '%s' properties\"\n\t\t       \": %m\", __func__, cgns->mnt_point, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = buf.st_uid;\n\tcg->gid = buf.st_gid;\n\n\t/* read the content of the notify flag */\n\txcgroup_get_uint32_param(cg, \"notify_on_release\", &(cg->notify));\n\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_load(xcgroup_ns_t* cgns, xcgroup_t* cg, char* uri)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\tstruct stat buf;\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\tif (stat((const char*)file_path, &buf)) {\n\t\tdebug2(\"%s: unable to get cgroup '%s' entry '%s' properties\"\n\t\t       \": %m\", __func__, cgns->mnt_point, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = buf.st_uid;\n\tcg->gid = buf.st_gid;\n\n\t/* read the content of the notify flag */\n\txcgroup_get_uint32_param(cg, \"notify_on_release\", &(cg->notify));\n\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_ns_load",
          "args": [
            "&slurm_cgroup_conf",
            "&memory_ns",
            "\"memory\""
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_ns_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "352-361",
          "snippet": "int xcgroup_ns_load(slurm_cgroup_conf_t *conf, xcgroup_ns_t *cgns, char *subsys)\n{\n\tcgns->mnt_point = xstrdup_printf(\"%s/%s\",\n\t\t\t\t\t conf->cgroup_mountpoint, subsys);\n\tcgns->mnt_args = NULL;\n\tcgns->subsystems = xstrdup(subsys);\n\tcgns->notify_prog = xstrdup_printf(\"%s/release_%s\",\n\t\t\t\t\t   conf->cgroup_release_agent, subsys);\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_ns_load(slurm_cgroup_conf_t *conf, xcgroup_ns_t *cgns, char *subsys)\n{\n\tcgns->mnt_point = xstrdup_printf(\"%s/%s\",\n\t\t\t\t\t conf->cgroup_mountpoint, subsys);\n\tcgns->mnt_args = NULL;\n\tcgns->subsystems = xstrdup(subsys);\n\tcgns->notify_prog = xstrdup_printf(\"%s/release_%s\",\n\t\t\t\t\t   conf->cgroup_release_agent, subsys);\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"system cgroup: unable to attach pid to \"\n\t\t\t\t       \"system cpuset cgroup\""
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "attach_system_cpuset_pid",
          "args": [
            "pid"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "attach_system_cpuset_pid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "448-453",
          "snippet": "extern int attach_system_cpuset_pid(pid_t pid)\n{\n\tif (xcgroup_add_pids(&system_cpuset_cg, &pid, 1) != XCGROUP_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\n\nextern int attach_system_cpuset_pid(pid_t pid)\n{\n\tif (xcgroup_add_pids(&system_cpuset_cg, &pid, 1) != XCGROUP_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xstrcat",
          "args": [
            "slurm_cgpath",
            "\"/system\""
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"/slurm\""
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrsubstitute",
          "args": [
            "slurm_cgpath",
            "\"%n\"",
            "conf->node_name"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "slurm_cgroup_conf.cgroup_prepend"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic xcgroup_ns_t cpuset_ns = {NULL, NULL, NULL, NULL};\nstatic xcgroup_ns_t memory_ns = {NULL, NULL, NULL, NULL};\nstatic slurm_cgroup_conf_t slurm_cgroup_conf;\n\nextern void attach_system_cgroup_pid(pid_t pid)\n{\n\tchar* slurm_cgpath;\n\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn;\n\n\tslurm_cgpath = (char*) xstrdup(slurm_cgroup_conf.cgroup_prepend);\n#ifdef MULTIPLE_SLURMD\n\tif ( conf->node_name != NULL )\n\t\txstrsubstitute(slurm_cgpath,\"%n\", conf->node_name);\n\telse {\n\t\txfree(slurm_cgpath);\n\t\tslurm_cgpath = (char*) xstrdup(\"/slurm\");\n\t}\n#endif\n\txstrcat(slurm_cgpath,\"/system\");\n\tif (xcgroup_ns_load(&slurm_cgroup_conf, &cpuset_ns, \"cpuset\")\n\t    == XCGROUP_SUCCESS) {\n\t\tif (xcgroup_load(&cpuset_ns, &system_cpuset_cg, slurm_cgpath)\n\t\t    == XCGROUP_SUCCESS)\n\t\t\tif (attach_system_cpuset_pid(pid) != SLURM_SUCCESS)\n\t\t\t\tdebug2(\"system cgroup: unable to attach pid to \"\n\t\t\t\t       \"system cpuset cgroup\");\n\t}\n\tif (xcgroup_ns_load(&slurm_cgroup_conf, &memory_ns, \"memory\")\n\t    == XCGROUP_SUCCESS) {\n\t\tif (xcgroup_load(&memory_ns, &system_memory_cg, slurm_cgpath)\n\t\t    == XCGROUP_SUCCESS)\n\t\t\tif (attach_system_memory_pid(pid) != SLURM_SUCCESS)\n\t\t\t\tdebug2(\"system cgroup: unable to attach pid to \"\n\t\t\t\t       \"system memory cgroup\");\n\t}\n\txfree(slurm_cgpath);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn;\n}"
  },
  {
    "function_name": "check_corespec_cgroup_job_confinement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "478-492",
    "snippet": "extern bool check_corespec_cgroup_job_confinement(void)\n{\n\tchar *task_plugin_type = NULL;\n\tbool status = FALSE;\n\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn FALSE;\n\ttask_plugin_type = slurm_get_task_plugin();\n\tif (slurm_cgroup_conf.constrain_cores &&\n\t    strstr(task_plugin_type, \"cgroup\"))\n\t\tstatus = TRUE;\n\txfree(task_plugin_type);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn status;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static slurm_cgroup_conf_t slurm_cgroup_conf;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "task_plugin_type"
          ],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "task_plugin_type",
            "\"cgroup\""
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_get_task_plugin",
          "args": [],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic slurm_cgroup_conf_t slurm_cgroup_conf;\n\nextern bool check_corespec_cgroup_job_confinement(void)\n{\n\tchar *task_plugin_type = NULL;\n\tbool status = FALSE;\n\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn FALSE;\n\ttask_plugin_type = slurm_get_task_plugin();\n\tif (slurm_cgroup_conf.constrain_cores &&\n\t    strstr(task_plugin_type, \"cgroup\"))\n\t\tstatus = TRUE;\n\txfree(task_plugin_type);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn status;\n}"
  },
  {
    "function_name": "check_memspec_cgroup_job_confinement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "462-476",
    "snippet": "extern bool check_memspec_cgroup_job_confinement(void)\n{\n\tchar *task_plugin_type = NULL;\n\tbool status = false;\n\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn false;\n\ttask_plugin_type = slurm_get_task_plugin();\n\tif (slurm_cgroup_conf.constrain_ram_space &&\n\t    strstr(task_plugin_type, \"cgroup\"))\n\t\tstatus = true;\n\txfree(task_plugin_type);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn status;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static slurm_cgroup_conf_t slurm_cgroup_conf;",
      "static bool constrain_ram_space;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "task_plugin_type"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "task_plugin_type",
            "\"cgroup\""
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_get_task_plugin",
          "args": [],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic slurm_cgroup_conf_t slurm_cgroup_conf;\nstatic bool constrain_ram_space;\n\nextern bool check_memspec_cgroup_job_confinement(void)\n{\n\tchar *task_plugin_type = NULL;\n\tbool status = false;\n\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn false;\n\ttask_plugin_type = slurm_get_task_plugin();\n\tif (slurm_cgroup_conf.constrain_ram_space &&\n\t    strstr(task_plugin_type, \"cgroup\"))\n\t\tstatus = true;\n\txfree(task_plugin_type);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn status;\n}"
  },
  {
    "function_name": "attach_system_memory_pid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "455-460",
    "snippet": "extern int attach_system_memory_pid(pid_t pid)\n{\n\tif (xcgroup_add_pids(&system_memory_cg, &pid, 1) != XCGROUP_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_add_pids",
          "args": [
            "&system_memory_cg",
            "&pid",
            "1"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_add_pids",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "569-580",
          "snippet": "int xcgroup_add_pids(xcgroup_t* cg, pid_t* pids, int npids)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar* path = _cgroup_procs_writable_path(cg);\n\n\tfstatus = _file_write_uint32s(path, (uint32_t*)pids, npids);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to add pids to '%s'\", __func__, cg->path);\n\n\txfree(path);\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_add_pids(xcgroup_t* cg, pid_t* pids, int npids)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar* path = _cgroup_procs_writable_path(cg);\n\n\tfstatus = _file_write_uint32s(path, (uint32_t*)pids, npids);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to add pids to '%s'\", __func__, cg->path);\n\n\txfree(path);\n\treturn fstatus;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\n\nextern int attach_system_memory_pid(pid_t pid)\n{\n\tif (xcgroup_add_pids(&system_memory_cg, &pid, 1) != XCGROUP_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "attach_system_cpuset_pid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "448-453",
    "snippet": "extern int attach_system_cpuset_pid(pid_t pid)\n{\n\tif (xcgroup_add_pids(&system_cpuset_cg, &pid, 1) != XCGROUP_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_add_pids",
          "args": [
            "&system_cpuset_cg",
            "&pid",
            "1"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_add_pids",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "569-580",
          "snippet": "int xcgroup_add_pids(xcgroup_t* cg, pid_t* pids, int npids)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar* path = _cgroup_procs_writable_path(cg);\n\n\tfstatus = _file_write_uint32s(path, (uint32_t*)pids, npids);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to add pids to '%s'\", __func__, cg->path);\n\n\txfree(path);\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_add_pids(xcgroup_t* cg, pid_t* pids, int npids)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar* path = _cgroup_procs_writable_path(cg);\n\n\tfstatus = _file_write_uint32s(path, (uint32_t*)pids, npids);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to add pids to '%s'\", __func__, cg->path);\n\n\txfree(path);\n\treturn fstatus;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\n\nextern int attach_system_cpuset_pid(pid_t pid)\n{\n\tif (xcgroup_add_pids(&system_cpuset_cg, &pid, 1) != XCGROUP_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "disable_system_cgroup_mem_oom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "441-446",
    "snippet": "extern int disable_system_cgroup_mem_oom()\n{\n\t/* 1: disables the oom killer */\n\treturn xcgroup_set_uint64_param(&system_memory_cg, \"memory.oom_control\",\n\t\t\t\t\t1);\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_set_uint64_param",
          "args": [
            "&system_memory_cg",
            "\"memory.oom_control\"",
            "1"
          ],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_set_uint64_param",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "745-766",
          "snippet": "int xcgroup_set_uint64_param(xcgroup_t* cg, char* param, uint64_t value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_uint64s(file_path, &value, 1);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%\"PRIu64\"' for \"\n\t\t\t\"'%s'\", __func__, param, value, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%\"PRIu64\"' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_set_uint64_param(xcgroup_t* cg, char* param, uint64_t value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_uint64s(file_path, &value, 1);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%\"PRIu64\"' for \"\n\t\t\t\"'%s'\", __func__, param, value, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%\"PRIu64\"' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\n\treturn fstatus;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\n\nextern int disable_system_cgroup_mem_oom()\n{\n\t/* 1: disables the oom killer */\n\treturn xcgroup_set_uint64_param(&system_memory_cg, \"memory.oom_control\",\n\t\t\t\t\t1);\n}"
  },
  {
    "function_name": "set_system_cgroup_mem_limit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "433-439",
    "snippet": "extern int set_system_cgroup_mem_limit(uint32_t mem_spec_limit)\n{\n    uint64_t mem_spec_bytes = (uint64_t)mem_spec_limit * 1024 * 1024;\n\txcgroup_set_uint64_param(&system_memory_cg, \"memory.limit_in_bytes\",\n\t\t\t\t mem_spec_bytes);\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_set_uint64_param",
          "args": [
            "&system_memory_cg",
            "\"memory.limit_in_bytes\"",
            "mem_spec_bytes"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_set_uint64_param",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "745-766",
          "snippet": "int xcgroup_set_uint64_param(xcgroup_t* cg, char* param, uint64_t value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_uint64s(file_path, &value, 1);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%\"PRIu64\"' for \"\n\t\t\t\"'%s'\", __func__, param, value, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%\"PRIu64\"' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_set_uint64_param(xcgroup_t* cg, char* param, uint64_t value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_uint64s(file_path, &value, 1);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%\"PRIu64\"' for \"\n\t\t\t\"'%s'\", __func__, param, value, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%\"PRIu64\"' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\n\treturn fstatus;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\n\nextern int set_system_cgroup_mem_limit(uint32_t mem_spec_limit)\n{\n    uint64_t mem_spec_bytes = (uint64_t)mem_spec_limit * 1024 * 1024;\n\txcgroup_set_uint64_param(&system_memory_cg, \"memory.limit_in_bytes\",\n\t\t\t\t mem_spec_bytes);\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "set_system_cgroup_cpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "426-431",
    "snippet": "extern int set_system_cgroup_cpus(char *phys_cpu_str)\n{\n\tsnprintf(cpuset_meta, sizeof(cpuset_meta), \"%scpus\", cpuset_prefix);\n\txcgroup_set_param(&system_cpuset_cg, cpuset_meta, phys_cpu_str);\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
      "static char *cpuset_prefix = \"\";",
      "char cpuset_meta[PATH_MAX];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_set_param",
          "args": [
            "&system_cpuset_cg",
            "cpuset_meta",
            "phys_cpu_str"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_set_param",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "653-674",
          "snippet": "int xcgroup_set_param(xcgroup_t* cg, char* param, char* content)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_content(file_path, content, strlen(content));\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_set_param(xcgroup_t* cg, char* param, char* content)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_content(file_path, content, strlen(content));\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "cpuset_meta",
            "sizeof(cpuset_meta)",
            "\"%scpus\"",
            "cpuset_prefix"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic char *cpuset_prefix = \"\";\nchar cpuset_meta[PATH_MAX];\n\nextern int set_system_cgroup_cpus(char *phys_cpu_str)\n{\n\tsnprintf(cpuset_meta, sizeof(cpuset_meta), \"%scpus\", cpuset_prefix);\n\txcgroup_set_param(&system_cpuset_cg, cpuset_meta, phys_cpu_str);\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "_xcgroup_cpuset_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "354-424",
    "snippet": "static int _xcgroup_cpuset_init(xcgroup_t* cg)\n{\n\tint fstatus, i;\n\n\tchar* cpuset_metafiles[] = {\n\t\t\"cpus\",\n\t\t\"mems\"\n\t};\n\tchar* cpuset_conf = NULL;\n\tsize_t csize = 0;\n\n\txcgroup_t acg;\n\tchar* acg_name = NULL;\n\tchar* p;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* load ancestor cg */\n\tacg_name = (char*) xstrdup(cg->name);\n\tp = rindex(acg_name,'/');\n\tif (p == NULL) {\n\t\tdebug2(\"system cgroup: unable to get ancestor path for \"\n\t\t       \"cpuset cg '%s' : %m\", cg->path);\n\t\txfree(acg_name);\n\t\treturn fstatus;\n\t} else\n\t\t*p = '\\0';\n\tif (xcgroup_load(cg->ns, &acg, acg_name) != XCGROUP_SUCCESS) {\n\t\tdebug2(\"system cgroup: unable to load ancestor for \"\n\t\t       \"cpuset cg '%s' : %m\", cg->path);\n\t\txfree(acg_name);\n\t\treturn fstatus;\n\t}\n\txfree(acg_name);\n\n\t/* inherits ancestor params */\n\tfor (i = 0 ; i < 2 ; i++) {\n\tagain:\n\t\tsnprintf(cpuset_meta, sizeof(cpuset_meta), \"%s%s\",\n\t\t\t cpuset_prefix, cpuset_metafiles[i]);\n\t\tif (xcgroup_get_param(&acg ,cpuset_meta,\n\t\t\t\t      &cpuset_conf, &csize)\n\t\t    != XCGROUP_SUCCESS) {\n\t\t\tif (!cpuset_prefix_set) {\n\t\t\t\tcpuset_prefix_set = 1;\n\t\t\t\tcpuset_prefix = \"cpuset.\";\n\t\t\t\tgoto again;\n\t\t\t}\n\n\t\t\tdebug(\"system cgroup: assuming no cpuset cg \"\n\t\t\t       \"support for '%s'\",acg.path);\n\t\t\txcgroup_destroy(&acg);\n\t\t\treturn fstatus;\n\t\t}\n\t\tif (csize > 0)\n\t\t\tcpuset_conf[csize-1] = '\\0';\n\t\tif (xcgroup_set_param(cg,cpuset_meta, cpuset_conf)\n\t\t    != XCGROUP_SUCCESS) {\n\t\t\tdebug(\"system cgroup: unable to write %s configuration \"\n\t\t\t       \"(%s) for cpuset cg '%s'\",cpuset_meta,\n\t\t\t       cpuset_conf, cg->path);\n\t\t\txcgroup_destroy(&acg);\n\t\t\txfree(cpuset_conf);\n\t\t\treturn fstatus;\n\t\t}\n\t\txfree(cpuset_conf);\n\t}\n\n\txcgroup_destroy(&acg);\n\treturn XCGROUP_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static bool cpuset_prefix_set = false;",
      "static char *cpuset_prefix = \"\";",
      "char cpuset_meta[PATH_MAX];",
      "static char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);",
      "static int _xcgroup_cpuset_init(xcgroup_t* cg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_destroy",
          "args": [
            "&acg"
          ],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "396-403",
          "snippet": "void xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nvoid xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "cpuset_conf"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"system cgroup: unable to write %s configuration \"\n\t\t\t       \"(%s) for cpuset cg '%s'\"",
            "cpuset_meta",
            "cpuset_conf",
            "cg->path"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xcgroup_set_param",
          "args": [
            "cg",
            "cpuset_meta",
            "cpuset_conf"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_set_param",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "653-674",
          "snippet": "int xcgroup_set_param(xcgroup_t* cg, char* param, char* content)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_content(file_path, content, strlen(content));\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_set_param(xcgroup_t* cg, char* param, char* content)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_content(file_path, content, strlen(content));\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"system cgroup: assuming no cpuset cg \"\n\t\t\t       \"support for '%s'\"",
            "acg.path"
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "pdebug_wake_process",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/pdebug.c",
          "lines": "187-199",
          "snippet": "void pdebug_wake_process(stepd_step_rec_t *job, pid_t pid)\n{\n\tif ((job->task_flags & TASK_PARALLEL_DEBUG) && (pid > (pid_t) 0)) {\n\t\tif (_pid_to_wake(pid)) {\n\t\t\tif (kill(pid, SIGCONT) < 0)\n\t\t\t\terror(\"kill(%lu): %m\", (unsigned long) pid);\n\t\t\telse\n\t\t\t\tdebug(\"woke pid %lu\", (unsigned long) pid);\n\t\t} else {\n\t\t\tdebug(\"pid %lu not stopped\", (unsigned long) pid);\n\t\t}\n\t}\n}",
          "includes": [
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"pdebug.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"pdebug.h\"\n\nvoid pdebug_wake_process(stepd_step_rec_t *job, pid_t pid)\n{\n\tif ((job->task_flags & TASK_PARALLEL_DEBUG) && (pid > (pid_t) 0)) {\n\t\tif (_pid_to_wake(pid)) {\n\t\t\tif (kill(pid, SIGCONT) < 0)\n\t\t\t\terror(\"kill(%lu): %m\", (unsigned long) pid);\n\t\t\telse\n\t\t\t\tdebug(\"woke pid %lu\", (unsigned long) pid);\n\t\t} else {\n\t\t\tdebug(\"pid %lu not stopped\", (unsigned long) pid);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_get_param",
          "args": [
            "&acg",
            "cpuset_meta",
            "&cpuset_conf",
            "&csize"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_get_param",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "676-692",
          "snippet": "int xcgroup_get_param(xcgroup_t* cg, char* param, char **content, size_t *csize)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t} else {\n\t\tfstatus = _file_read_content(file_path, content, csize);\n\t\tif (fstatus != XCGROUP_SUCCESS)\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t}\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint xcgroup_get_param(xcgroup_t* cg, char* param, char **content, size_t *csize)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t} else {\n\t\tfstatus = _file_read_content(file_path, content, csize);\n\t\tif (fstatus != XCGROUP_SUCCESS)\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t}\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "cpuset_meta",
            "sizeof(cpuset_meta)",
            "\"%s%s\"",
            "cpuset_prefix",
            "cpuset_metafiles[i]"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"system cgroup: unable to load ancestor for \"\n\t\t       \"cpuset cg '%s' : %m\"",
            "cg->path"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xcgroup_load",
          "args": [
            "cg->ns",
            "&acg",
            "acg_name"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "497-529",
          "snippet": "int xcgroup_load(xcgroup_ns_t* cgns, xcgroup_t* cg, char* uri)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\tstruct stat buf;\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\tif (stat((const char*)file_path, &buf)) {\n\t\tdebug2(\"%s: unable to get cgroup '%s' entry '%s' properties\"\n\t\t       \": %m\", __func__, cgns->mnt_point, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = buf.st_uid;\n\tcg->gid = buf.st_gid;\n\n\t/* read the content of the notify flag */\n\txcgroup_get_uint32_param(cg, \"notify_on_release\", &(cg->notify));\n\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_load(xcgroup_ns_t* cgns, xcgroup_t* cg, char* uri)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\tstruct stat buf;\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\tif (stat((const char*)file_path, &buf)) {\n\t\tdebug2(\"%s: unable to get cgroup '%s' entry '%s' properties\"\n\t\t       \": %m\", __func__, cgns->mnt_point, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = buf.st_uid;\n\tcg->gid = buf.st_gid;\n\n\t/* read the content of the notify flag */\n\txcgroup_get_uint32_param(cg, \"notify_on_release\", &(cg->notify));\n\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"system cgroup: unable to get ancestor path for \"\n\t\t       \"cpuset cg '%s' : %m\"",
            "cg->path"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rindex",
          "args": [
            "acg_name",
            "'/'"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cg->name"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic bool cpuset_prefix_set = false;\nstatic char *cpuset_prefix = \"\";\nchar cpuset_meta[PATH_MAX];\nstatic char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);\nstatic int _xcgroup_cpuset_init(xcgroup_t* cg);\n\nstatic int _xcgroup_cpuset_init(xcgroup_t* cg)\n{\n\tint fstatus, i;\n\n\tchar* cpuset_metafiles[] = {\n\t\t\"cpus\",\n\t\t\"mems\"\n\t};\n\tchar* cpuset_conf = NULL;\n\tsize_t csize = 0;\n\n\txcgroup_t acg;\n\tchar* acg_name = NULL;\n\tchar* p;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* load ancestor cg */\n\tacg_name = (char*) xstrdup(cg->name);\n\tp = rindex(acg_name,'/');\n\tif (p == NULL) {\n\t\tdebug2(\"system cgroup: unable to get ancestor path for \"\n\t\t       \"cpuset cg '%s' : %m\", cg->path);\n\t\txfree(acg_name);\n\t\treturn fstatus;\n\t} else\n\t\t*p = '\\0';\n\tif (xcgroup_load(cg->ns, &acg, acg_name) != XCGROUP_SUCCESS) {\n\t\tdebug2(\"system cgroup: unable to load ancestor for \"\n\t\t       \"cpuset cg '%s' : %m\", cg->path);\n\t\txfree(acg_name);\n\t\treturn fstatus;\n\t}\n\txfree(acg_name);\n\n\t/* inherits ancestor params */\n\tfor (i = 0 ; i < 2 ; i++) {\n\tagain:\n\t\tsnprintf(cpuset_meta, sizeof(cpuset_meta), \"%s%s\",\n\t\t\t cpuset_prefix, cpuset_metafiles[i]);\n\t\tif (xcgroup_get_param(&acg ,cpuset_meta,\n\t\t\t\t      &cpuset_conf, &csize)\n\t\t    != XCGROUP_SUCCESS) {\n\t\t\tif (!cpuset_prefix_set) {\n\t\t\t\tcpuset_prefix_set = 1;\n\t\t\t\tcpuset_prefix = \"cpuset.\";\n\t\t\t\tgoto again;\n\t\t\t}\n\n\t\t\tdebug(\"system cgroup: assuming no cpuset cg \"\n\t\t\t       \"support for '%s'\",acg.path);\n\t\t\txcgroup_destroy(&acg);\n\t\t\treturn fstatus;\n\t\t}\n\t\tif (csize > 0)\n\t\t\tcpuset_conf[csize-1] = '\\0';\n\t\tif (xcgroup_set_param(cg,cpuset_meta, cpuset_conf)\n\t\t    != XCGROUP_SUCCESS) {\n\t\t\tdebug(\"system cgroup: unable to write %s configuration \"\n\t\t\t       \"(%s) for cpuset cg '%s'\",cpuset_meta,\n\t\t\t       cpuset_conf, cg->path);\n\t\t\txcgroup_destroy(&acg);\n\t\t\txfree(cpuset_conf);\n\t\t\treturn fstatus;\n\t\t}\n\t\txfree(cpuset_conf);\n\t}\n\n\txcgroup_destroy(&acg);\n\treturn XCGROUP_SUCCESS;\n}"
  },
  {
    "function_name": "_system_cgroup_create_slurm_cg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "307-348",
    "snippet": "static char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns)\n{\n\t/* we do it here as we do not have access to the conf structure */\n\t/* in libslurm (src/common/xcgroup.c) */\n\txcgroup_t slurm_cg;\n\tchar* pre = (char*) xstrdup(slurm_cgroup_conf.cgroup_prepend);\n\n#ifdef MULTIPLE_SLURMD\n\tif ( conf->node_name != NULL )\n\t\txstrsubstitute(pre, \"%n\", conf->node_name);\n\telse {\n\t\txfree(pre);\n\t\tpre = (char*) xstrdup(\"/slurm\");\n\t}\n#endif\n\n\t/* create slurm cgroup in the ns\n\t * disable notify_on_release to avoid the removal/creation\n\t * of this cgroup for each last/first running job on the node */\n\tif (xcgroup_create(ns, &slurm_cg, pre,\n\t\t\t   getuid(), getgid()) != XCGROUP_SUCCESS) {\n\t\txfree(pre);\n\t\treturn pre;\n\t}\n\tslurm_cg.notify = 0;\n\tif (xcgroup_instantiate(&slurm_cg) != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to build slurm cgroup for \"\n\t\t      \"ns %s: %m\",\n\t\t      ns->subsystems);\n\t\txcgroup_destroy(&slurm_cg);\n\t\txfree(pre);\n\t\treturn pre;\n\t}\n\telse {\n\t\tdebug3(\"system cgroup: slurm cgroup %s successfully created \"\n\t\t       \"for ns %s: %m\",\n\t\t       pre, ns->subsystems);\n\t\txcgroup_destroy(&slurm_cg);\n\t}\n\n\treturn pre;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static slurm_cgroup_conf_t slurm_cgroup_conf;",
      "static char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_destroy",
          "args": [
            "&slurm_cg"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "396-403",
          "snippet": "void xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nvoid xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"system cgroup: slurm cgroup %s successfully created \"\n\t\t       \"for ns %s: %m\"",
            "pre",
            "ns->subsystems"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "pre"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"system cgroup: unable to build slurm cgroup for \"\n\t\t      \"ns %s: %m\"",
            "ns->subsystems"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "_task_write_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "641-650",
          "snippet": "static int\n_task_write_error(eio_obj_t *obj, List objs)\n{\n\tdebug4(\"Called _task_write_error, closing fd %d\", obj->fd);\n\n\tclose(obj->fd);\n\tobj->fd = -1;\n\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static int  _client_read(eio_obj_t *, List);",
            "static int  _client_write(eio_obj_t *, List);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static int  _local_file_write(eio_obj_t *, List);",
            "static bool _task_writable(eio_obj_t *);",
            "static int  _task_write(eio_obj_t *, List);",
            "static int _task_write_error(eio_obj_t *obj, List objs);",
            "static bool _task_readable(eio_obj_t *);",
            "static int  _task_read(eio_obj_t *, List);",
            "static void _route_msg_task_to_client(eio_obj_t *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic int  _client_read(eio_obj_t *, List);\nstatic int  _client_write(eio_obj_t *, List);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic int  _local_file_write(eio_obj_t *, List);\nstatic bool _task_writable(eio_obj_t *);\nstatic int  _task_write(eio_obj_t *, List);\nstatic int _task_write_error(eio_obj_t *obj, List objs);\nstatic bool _task_readable(eio_obj_t *);\nstatic int  _task_read(eio_obj_t *, List);\nstatic void _route_msg_task_to_client(eio_obj_t *obj);\n\nstatic int\n_task_write_error(eio_obj_t *obj, List objs)\n{\n\tdebug4(\"Called _task_write_error, closing fd %d\", obj->fd);\n\n\tclose(obj->fd);\n\tobj->fd = -1;\n\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_instantiate",
          "args": [
            "&slurm_cg"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_instantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "442-495",
          "snippet": "int xcgroup_instantiate(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tmode_t cmask;\n\tmode_t omask;\n\n\txcgroup_ns_t* cgns;\n\tchar* file_path;\n\tuid_t uid;\n\tgid_t gid;\n\tint create_only;\n\tuint32_t notify;\n\n\t/* init variables based on input cgroup */\n\tcgns = cg->ns;\n\tfile_path = cg->path;\n\tuid = cg->uid;\n\tgid = cg->gid;\n\tcreate_only = 0;\n\tnotify = cg->notify;\n\n\t/* save current mask and apply working one */\n\tcmask = S_IWGRP | S_IWOTH;\n\tomask = umask(cmask);\n\n\t/* build cgroup */\n \tif (mkdir(file_path, 0755)) {\n\t\tif (create_only || errno != EEXIST) {\n\t\t\tdebug2(\"%s: unable to create cgroup '%s' : %m\",\n\t\t\t       __func__, file_path);\n\t\t\tumask(omask);\n\t\t\treturn fstatus;\n\t\t}\n\t}\n\tumask(omask);\n\n\t/* change cgroup ownership as requested */\n\tif (chown(file_path, uid, gid)) {\n\t\tdebug2(\"%s: unable to chown %d:%d cgroup '%s' : %m\",\n\t\t       __func__, uid, gid, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* following operations failure might not result in a general\n\t * failure so set output status to success */\n\tfstatus = XCGROUP_SUCCESS;\n\n\t/* set notify on release flag */\n\tif (notify == 1 && cgns->notify_prog)\n\t\txcgroup_set_params(cg, \"notify_on_release=1\");\n\telse\n\t\txcgroup_set_params(cg, \"notify_on_release=0\");\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_instantiate(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tmode_t cmask;\n\tmode_t omask;\n\n\txcgroup_ns_t* cgns;\n\tchar* file_path;\n\tuid_t uid;\n\tgid_t gid;\n\tint create_only;\n\tuint32_t notify;\n\n\t/* init variables based on input cgroup */\n\tcgns = cg->ns;\n\tfile_path = cg->path;\n\tuid = cg->uid;\n\tgid = cg->gid;\n\tcreate_only = 0;\n\tnotify = cg->notify;\n\n\t/* save current mask and apply working one */\n\tcmask = S_IWGRP | S_IWOTH;\n\tomask = umask(cmask);\n\n\t/* build cgroup */\n \tif (mkdir(file_path, 0755)) {\n\t\tif (create_only || errno != EEXIST) {\n\t\t\tdebug2(\"%s: unable to create cgroup '%s' : %m\",\n\t\t\t       __func__, file_path);\n\t\t\tumask(omask);\n\t\t\treturn fstatus;\n\t\t}\n\t}\n\tumask(omask);\n\n\t/* change cgroup ownership as requested */\n\tif (chown(file_path, uid, gid)) {\n\t\tdebug2(\"%s: unable to chown %d:%d cgroup '%s' : %m\",\n\t\t       __func__, uid, gid, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* following operations failure might not result in a general\n\t * failure so set output status to success */\n\tfstatus = XCGROUP_SUCCESS;\n\n\t/* set notify on release flag */\n\tif (notify == 1 && cgns->notify_prog)\n\t\txcgroup_set_params(cg, \"notify_on_release=1\");\n\telse\n\t\txcgroup_set_params(cg, \"notify_on_release=0\");\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_create",
          "args": [
            "ns",
            "&slurm_cg",
            "pre",
            "getuid()",
            "getgid()"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "371-394",
          "snippet": "int xcgroup_create(xcgroup_ns_t* cgns, xcgroup_t* cg,\n\t\t   char* uri, uid_t uid,  gid_t gid)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = uid;\n\tcg->gid = gid;\n\tcg->notify = 1;\n\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_create(xcgroup_ns_t* cgns, xcgroup_t* cg,\n\t\t   char* uri, uid_t uid,  gid_t gid)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = uid;\n\tcg->gid = gid;\n\tcg->notify = 1;\n\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getgid",
          "args": [],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"/slurm\""
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrsubstitute",
          "args": [
            "pre",
            "\"%n\"",
            "conf->node_name"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "slurm_cgroup_conf.cgroup_prepend"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic slurm_cgroup_conf_t slurm_cgroup_conf;\nstatic char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);\n\nstatic char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns)\n{\n\t/* we do it here as we do not have access to the conf structure */\n\t/* in libslurm (src/common/xcgroup.c) */\n\txcgroup_t slurm_cg;\n\tchar* pre = (char*) xstrdup(slurm_cgroup_conf.cgroup_prepend);\n\n#ifdef MULTIPLE_SLURMD\n\tif ( conf->node_name != NULL )\n\t\txstrsubstitute(pre, \"%n\", conf->node_name);\n\telse {\n\t\txfree(pre);\n\t\tpre = (char*) xstrdup(\"/slurm\");\n\t}\n#endif\n\n\t/* create slurm cgroup in the ns\n\t * disable notify_on_release to avoid the removal/creation\n\t * of this cgroup for each last/first running job on the node */\n\tif (xcgroup_create(ns, &slurm_cg, pre,\n\t\t\t   getuid(), getgid()) != XCGROUP_SUCCESS) {\n\t\txfree(pre);\n\t\treturn pre;\n\t}\n\tslurm_cg.notify = 0;\n\tif (xcgroup_instantiate(&slurm_cg) != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to build slurm cgroup for \"\n\t\t      \"ns %s: %m\",\n\t\t      ns->subsystems);\n\t\txcgroup_destroy(&slurm_cg);\n\t\txfree(pre);\n\t\treturn pre;\n\t}\n\telse {\n\t\tdebug3(\"system cgroup: slurm cgroup %s successfully created \"\n\t\t       \"for ns %s: %m\",\n\t\t       pre, ns->subsystems);\n\t\txcgroup_destroy(&slurm_cg);\n\t}\n\n\treturn pre;\n}"
  },
  {
    "function_name": "fini_system_cgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "299-305",
    "snippet": "extern void fini_system_cgroup(void)\n{\n\txcgroup_destroy(&system_cpuset_cg);\n\txcgroup_destroy(&system_memory_cg);\n\txcgroup_ns_destroy(&cpuset_ns);\n\txcgroup_ns_destroy(&memory_ns);\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
      "static xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
      "static xcgroup_ns_t cpuset_ns = {NULL, NULL, NULL, NULL};",
      "static xcgroup_ns_t memory_ns = {NULL, NULL, NULL, NULL};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_ns_destroy",
          "args": [
            "&memory_ns"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_ns_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "133-139",
          "snippet": "void xcgroup_ns_destroy(xcgroup_ns_t* cgns)\n{\n\txfree(cgns->mnt_point);\n\txfree(cgns->mnt_args);\n\txfree(cgns->subsystems);\n\txfree(cgns->notify_prog);\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nvoid xcgroup_ns_destroy(xcgroup_ns_t* cgns)\n{\n\txfree(cgns->mnt_point);\n\txfree(cgns->mnt_args);\n\txfree(cgns->subsystems);\n\txfree(cgns->notify_prog);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_destroy",
          "args": [
            "&system_memory_cg"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "396-403",
          "snippet": "void xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nvoid xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic xcgroup_ns_t cpuset_ns = {NULL, NULL, NULL, NULL};\nstatic xcgroup_ns_t memory_ns = {NULL, NULL, NULL, NULL};\n\nextern void fini_system_cgroup(void)\n{\n\txcgroup_destroy(&system_cpuset_cg);\n\txcgroup_destroy(&system_memory_cg);\n\txcgroup_ns_destroy(&cpuset_ns);\n\txcgroup_ns_destroy(&memory_ns);\n}"
  },
  {
    "function_name": "init_system_memory_cgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "189-297",
    "snippet": "extern int init_system_memory_cgroup(void)\n{\n\tint fstatus = SLURM_ERROR;\n\tchar* slurm_cgpath;\n\n\t/* read cgroup configuration */\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn SLURM_ERROR;\n\n\t/* initialize memory cgroup namespace */\n\tif (xcgroup_ns_create(&slurm_cgroup_conf, &memory_ns, \"\", \"memory\")\n\t    != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to create memory namespace\");\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\tconstrain_ram_space = slurm_cgroup_conf.constrain_ram_space;\n\tconstrain_swap_space = slurm_cgroup_conf.constrain_swap_space;\n\n\t/*\n\t * as the swap space threshold will be configured with a\n\t * mem+swp parameter value, if RAM space is not monitored,\n\t * set allowed RAM space to 100% of the job requested memory.\n\t * It will help to construct the mem+swp value that will be\n\t * used for both mem and mem+swp limit during memcg creation.\n\t */\n\tif ( constrain_ram_space )\n\t\tallowed_ram_space = slurm_cgroup_conf.allowed_ram_space;\n\telse\n\t\tallowed_ram_space = 100.0;\n\n\tallowed_swap_space = slurm_cgroup_conf.allowed_swap_space;\n\n\tif ((totalram = (uint64_t) conf->real_memory_size) == 0)\n\t\terror (\"system cgroup: Unable to get RealMemory size\");\n\n\tmax_ram = _percent_in_bytes(totalram, slurm_cgroup_conf.max_ram_percent);\n\tmax_swap = _percent_in_bytes(totalram, slurm_cgroup_conf.max_swap_percent);\n\tmax_swap += max_ram;\n\tmin_ram_space = slurm_cgroup_conf.min_ram_space * 1024 * 1024;\n\n\tdebug (\"system cgroup: memory: total:%luM allowed:%.4g%%(%s), \"\n\t       \"swap:%.4g%%(%s), max:%.4g%%(%luM) max+swap:%.4g%%(%luM) min:%uM\",\n\t       (unsigned long) totalram,\n\t       allowed_ram_space,\n\t       constrain_ram_space?\"enforced\":\"permissive\",\n\t       allowed_swap_space,\n\t       constrain_swap_space?\"enforced\":\"permissive\",\n\t       slurm_cgroup_conf.max_ram_percent,\n\t       (unsigned long) (max_ram/(1024*1024)),\n\t       slurm_cgroup_conf.max_swap_percent,\n\t       (unsigned long) (max_swap/(1024*1024)),\n\t       (unsigned) slurm_cgroup_conf.min_ram_space);\n\n        /*\n         *  Warning: OOM Killer must be disabled for slurmstepd\n         *  or it would be destroyed if the application use\n         *  more memory than permitted\n         *\n         *  If an env value is already set for slurmstepd\n         *  OOM killer behavior, keep it, otherwise set the\n         *  -1000 value, wich means do not let OOM killer kill it\n         *\n         *  FYI, setting \"export SLURMSTEPD_OOM_ADJ=-1000\"\n         *  in /etc/sysconfig/slurm would be the same\n         */\n        setenv(\"SLURMSTEPD_OOM_ADJ\", \"-1000\", 0);\n\n\t/* create slurm root cg in this cg namespace */\n\tslurm_cgpath = _system_cgroup_create_slurm_cg(&memory_ns);\n\tif ( slurm_cgpath == NULL ) {\n\t\txcgroup_ns_destroy(&memory_ns);\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\t/* build system cgroup relative path */\n\tsnprintf(system_cgroup_path, PATH_MAX, \"%s/system\", slurm_cgpath);\n\txfree(slurm_cgpath);\n\n\t/* create system cgroup in the cpuset ns */\n\tif (xcgroup_create(&memory_ns, &system_memory_cg,\n\t\t\t   system_cgroup_path,\n\t\t\t   getuid(), getgid()) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\tif (xcgroup_instantiate(&system_memory_cg) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\n\tif ( xcgroup_set_param(&system_memory_cg, \"memory.use_hierarchy\", \"1\")\n\t     != XCGROUP_SUCCESS ) {\n\t\terror(\"system cgroup: unable to ask for hierarchical accounting\"\n\t\t      \"of system memcg '%s'\", system_memory_cg.path);\n\t\tgoto error;\n\t}\n\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\tdebug(\"system cgroup: system memory cgroup initialized\");\n\treturn SLURM_SUCCESS;\n\nerror:\n\txcgroup_unlock(&system_memory_cg);\n\txcgroup_destroy(&system_memory_cg);\n\txcgroup_ns_destroy(&memory_ns);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn fstatus;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [
      "#define PATH_MAX 256"
    ],
    "globals_used": [
      "static xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
      "static xcgroup_ns_t memory_ns = {NULL, NULL, NULL, NULL};",
      "static char system_cgroup_path[PATH_MAX];",
      "static slurm_cgroup_conf_t slurm_cgroup_conf;",
      "static bool constrain_ram_space;",
      "static bool constrain_swap_space;",
      "static float allowed_ram_space;",
      "static float allowed_swap_space;",
      "static uint64_t max_ram;",
      "static uint64_t max_swap;",
      "static uint64_t totalram;",
      "static uint64_t min_ram_space;",
      "static char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);",
      "static int _xcgroup_cpuset_init(xcgroup_t* cg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xcgroup_ns_destroy",
          "args": [
            "&memory_ns"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_ns_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "133-139",
          "snippet": "void xcgroup_ns_destroy(xcgroup_ns_t* cgns)\n{\n\txfree(cgns->mnt_point);\n\txfree(cgns->mnt_args);\n\txfree(cgns->subsystems);\n\txfree(cgns->notify_prog);\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nvoid xcgroup_ns_destroy(xcgroup_ns_t* cgns)\n{\n\txfree(cgns->mnt_point);\n\txfree(cgns->mnt_args);\n\txfree(cgns->subsystems);\n\txfree(cgns->notify_prog);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_destroy",
          "args": [
            "&system_memory_cg"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "396-403",
          "snippet": "void xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nvoid xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_unlock",
          "args": [
            "&system_memory_cg"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "428-440",
          "snippet": "int xcgroup_unlock(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\n\tif (flock(cg->fd,  LOCK_UN) < 0) {\n\t\tdebug2(\"%s: error unlocking cgroup '%s' : %m\",\n\t\t       __func__, cg->path);\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\tclose(cg->fd);\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\n\nint xcgroup_unlock(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\n\tif (flock(cg->fd,  LOCK_UN) < 0) {\n\t\tdebug2(\"%s: error unlocking cgroup '%s' : %m\",\n\t\t       __func__, cg->path);\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\tclose(cg->fd);\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"system cgroup: system memory cgroup initialized\""
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "pdebug_stop_current",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/pdebug.c",
          "lines": "120-139",
          "snippet": "void\npdebug_stop_current(stepd_step_rec_t *job)\n{\n\t/*\n\t * Stop the task on exec for TotalView to connect\n\t */\n\tif ( (job->task_flags & TASK_PARALLEL_DEBUG)\n#ifdef BSD\n\t     && (_PTRACE(PT_TRACE_ME, 0, (caddr_t)0, 0) < 0) )\n#elif defined(PT_TRACE_ME)\n\t     && (_PTRACE(PT_TRACE_ME, 0, NULL, 0) < 0) )\n#elif defined(__sun)\n\t     && (_PTRACE(0, 0, NULL, 0) < 0))\n#elif defined(__CYGWIN__)\n\t     && 0)\n#else\n\t     && (_PTRACE(PTRACE_TRACEME, 0, NULL, 0) < 0) )\n#endif\n\t\terror(\"ptrace: %m\");\n}",
          "includes": [
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"pdebug.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"pdebug.h\"\n\nvoid\npdebug_stop_current(stepd_step_rec_t *job)\n{\n\t/*\n\t * Stop the task on exec for TotalView to connect\n\t */\n\tif ( (job->task_flags & TASK_PARALLEL_DEBUG)\n#ifdef BSD\n\t     && (_PTRACE(PT_TRACE_ME, 0, (caddr_t)0, 0) < 0) )\n#elif defined(PT_TRACE_ME)\n\t     && (_PTRACE(PT_TRACE_ME, 0, NULL, 0) < 0) )\n#elif defined(__sun)\n\t     && (_PTRACE(0, 0, NULL, 0) < 0))\n#elif defined(__CYGWIN__)\n\t     && 0)\n#else\n\t     && (_PTRACE(PTRACE_TRACEME, 0, NULL, 0) < 0) )\n#endif\n\t\terror(\"ptrace: %m\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"system cgroup: unable to ask for hierarchical accounting\"\n\t\t      \"of system memcg '%s'\"",
            "system_memory_cg.path"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "_task_write_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "641-650",
          "snippet": "static int\n_task_write_error(eio_obj_t *obj, List objs)\n{\n\tdebug4(\"Called _task_write_error, closing fd %d\", obj->fd);\n\n\tclose(obj->fd);\n\tobj->fd = -1;\n\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static int  _client_read(eio_obj_t *, List);",
            "static int  _client_write(eio_obj_t *, List);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static int  _local_file_write(eio_obj_t *, List);",
            "static bool _task_writable(eio_obj_t *);",
            "static int  _task_write(eio_obj_t *, List);",
            "static int _task_write_error(eio_obj_t *obj, List objs);",
            "static bool _task_readable(eio_obj_t *);",
            "static int  _task_read(eio_obj_t *, List);",
            "static void _route_msg_task_to_client(eio_obj_t *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic int  _client_read(eio_obj_t *, List);\nstatic int  _client_write(eio_obj_t *, List);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic int  _local_file_write(eio_obj_t *, List);\nstatic bool _task_writable(eio_obj_t *);\nstatic int  _task_write(eio_obj_t *, List);\nstatic int _task_write_error(eio_obj_t *obj, List objs);\nstatic bool _task_readable(eio_obj_t *);\nstatic int  _task_read(eio_obj_t *, List);\nstatic void _route_msg_task_to_client(eio_obj_t *obj);\n\nstatic int\n_task_write_error(eio_obj_t *obj, List objs)\n{\n\tdebug4(\"Called _task_write_error, closing fd %d\", obj->fd);\n\n\tclose(obj->fd);\n\tobj->fd = -1;\n\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_set_param",
          "args": [
            "&system_memory_cg",
            "\"memory.use_hierarchy\"",
            "\"1\""
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_set_param",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "653-674",
          "snippet": "int xcgroup_set_param(xcgroup_t* cg, char* param, char* content)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_content(file_path, content, strlen(content));\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_set_param(xcgroup_t* cg, char* param, char* content)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_content(file_path, content, strlen(content));\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_instantiate",
          "args": [
            "&system_memory_cg"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_instantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "442-495",
          "snippet": "int xcgroup_instantiate(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tmode_t cmask;\n\tmode_t omask;\n\n\txcgroup_ns_t* cgns;\n\tchar* file_path;\n\tuid_t uid;\n\tgid_t gid;\n\tint create_only;\n\tuint32_t notify;\n\n\t/* init variables based on input cgroup */\n\tcgns = cg->ns;\n\tfile_path = cg->path;\n\tuid = cg->uid;\n\tgid = cg->gid;\n\tcreate_only = 0;\n\tnotify = cg->notify;\n\n\t/* save current mask and apply working one */\n\tcmask = S_IWGRP | S_IWOTH;\n\tomask = umask(cmask);\n\n\t/* build cgroup */\n \tif (mkdir(file_path, 0755)) {\n\t\tif (create_only || errno != EEXIST) {\n\t\t\tdebug2(\"%s: unable to create cgroup '%s' : %m\",\n\t\t\t       __func__, file_path);\n\t\t\tumask(omask);\n\t\t\treturn fstatus;\n\t\t}\n\t}\n\tumask(omask);\n\n\t/* change cgroup ownership as requested */\n\tif (chown(file_path, uid, gid)) {\n\t\tdebug2(\"%s: unable to chown %d:%d cgroup '%s' : %m\",\n\t\t       __func__, uid, gid, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* following operations failure might not result in a general\n\t * failure so set output status to success */\n\tfstatus = XCGROUP_SUCCESS;\n\n\t/* set notify on release flag */\n\tif (notify == 1 && cgns->notify_prog)\n\t\txcgroup_set_params(cg, \"notify_on_release=1\");\n\telse\n\t\txcgroup_set_params(cg, \"notify_on_release=0\");\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_instantiate(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tmode_t cmask;\n\tmode_t omask;\n\n\txcgroup_ns_t* cgns;\n\tchar* file_path;\n\tuid_t uid;\n\tgid_t gid;\n\tint create_only;\n\tuint32_t notify;\n\n\t/* init variables based on input cgroup */\n\tcgns = cg->ns;\n\tfile_path = cg->path;\n\tuid = cg->uid;\n\tgid = cg->gid;\n\tcreate_only = 0;\n\tnotify = cg->notify;\n\n\t/* save current mask and apply working one */\n\tcmask = S_IWGRP | S_IWOTH;\n\tomask = umask(cmask);\n\n\t/* build cgroup */\n \tif (mkdir(file_path, 0755)) {\n\t\tif (create_only || errno != EEXIST) {\n\t\t\tdebug2(\"%s: unable to create cgroup '%s' : %m\",\n\t\t\t       __func__, file_path);\n\t\t\tumask(omask);\n\t\t\treturn fstatus;\n\t\t}\n\t}\n\tumask(omask);\n\n\t/* change cgroup ownership as requested */\n\tif (chown(file_path, uid, gid)) {\n\t\tdebug2(\"%s: unable to chown %d:%d cgroup '%s' : %m\",\n\t\t       __func__, uid, gid, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* following operations failure might not result in a general\n\t * failure so set output status to success */\n\tfstatus = XCGROUP_SUCCESS;\n\n\t/* set notify on release flag */\n\tif (notify == 1 && cgns->notify_prog)\n\t\txcgroup_set_params(cg, \"notify_on_release=1\");\n\telse\n\t\txcgroup_set_params(cg, \"notify_on_release=0\");\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_create",
          "args": [
            "&memory_ns",
            "&system_memory_cg",
            "system_cgroup_path",
            "getuid()",
            "getgid()"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "371-394",
          "snippet": "int xcgroup_create(xcgroup_ns_t* cgns, xcgroup_t* cg,\n\t\t   char* uri, uid_t uid,  gid_t gid)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = uid;\n\tcg->gid = gid;\n\tcg->notify = 1;\n\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_create(xcgroup_ns_t* cgns, xcgroup_t* cg,\n\t\t   char* uri, uid_t uid,  gid_t gid)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = uid;\n\tcg->gid = gid;\n\tcg->notify = 1;\n\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getgid",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "slurm_cgpath"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "system_cgroup_path",
            "PATH_MAX",
            "\"%s/system\"",
            "slurm_cgpath"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_system_cgroup_create_slurm_cg",
          "args": [
            "&memory_ns"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "_system_cgroup_create_slurm_cg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "307-348",
          "snippet": "static char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns)\n{\n\t/* we do it here as we do not have access to the conf structure */\n\t/* in libslurm (src/common/xcgroup.c) */\n\txcgroup_t slurm_cg;\n\tchar* pre = (char*) xstrdup(slurm_cgroup_conf.cgroup_prepend);\n\n#ifdef MULTIPLE_SLURMD\n\tif ( conf->node_name != NULL )\n\t\txstrsubstitute(pre, \"%n\", conf->node_name);\n\telse {\n\t\txfree(pre);\n\t\tpre = (char*) xstrdup(\"/slurm\");\n\t}\n#endif\n\n\t/* create slurm cgroup in the ns\n\t * disable notify_on_release to avoid the removal/creation\n\t * of this cgroup for each last/first running job on the node */\n\tif (xcgroup_create(ns, &slurm_cg, pre,\n\t\t\t   getuid(), getgid()) != XCGROUP_SUCCESS) {\n\t\txfree(pre);\n\t\treturn pre;\n\t}\n\tslurm_cg.notify = 0;\n\tif (xcgroup_instantiate(&slurm_cg) != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to build slurm cgroup for \"\n\t\t      \"ns %s: %m\",\n\t\t      ns->subsystems);\n\t\txcgroup_destroy(&slurm_cg);\n\t\txfree(pre);\n\t\treturn pre;\n\t}\n\telse {\n\t\tdebug3(\"system cgroup: slurm cgroup %s successfully created \"\n\t\t       \"for ns %s: %m\",\n\t\t       pre, ns->subsystems);\n\t\txcgroup_destroy(&slurm_cg);\n\t}\n\n\treturn pre;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static slurm_cgroup_conf_t slurm_cgroup_conf;",
            "static char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic slurm_cgroup_conf_t slurm_cgroup_conf;\nstatic char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);\n\nstatic char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns)\n{\n\t/* we do it here as we do not have access to the conf structure */\n\t/* in libslurm (src/common/xcgroup.c) */\n\txcgroup_t slurm_cg;\n\tchar* pre = (char*) xstrdup(slurm_cgroup_conf.cgroup_prepend);\n\n#ifdef MULTIPLE_SLURMD\n\tif ( conf->node_name != NULL )\n\t\txstrsubstitute(pre, \"%n\", conf->node_name);\n\telse {\n\t\txfree(pre);\n\t\tpre = (char*) xstrdup(\"/slurm\");\n\t}\n#endif\n\n\t/* create slurm cgroup in the ns\n\t * disable notify_on_release to avoid the removal/creation\n\t * of this cgroup for each last/first running job on the node */\n\tif (xcgroup_create(ns, &slurm_cg, pre,\n\t\t\t   getuid(), getgid()) != XCGROUP_SUCCESS) {\n\t\txfree(pre);\n\t\treturn pre;\n\t}\n\tslurm_cg.notify = 0;\n\tif (xcgroup_instantiate(&slurm_cg) != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to build slurm cgroup for \"\n\t\t      \"ns %s: %m\",\n\t\t      ns->subsystems);\n\t\txcgroup_destroy(&slurm_cg);\n\t\txfree(pre);\n\t\treturn pre;\n\t}\n\telse {\n\t\tdebug3(\"system cgroup: slurm cgroup %s successfully created \"\n\t\t       \"for ns %s: %m\",\n\t\t       pre, ns->subsystems);\n\t\txcgroup_destroy(&slurm_cg);\n\t}\n\n\treturn pre;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setenv",
          "args": [
            "\"SLURMSTEPD_OOM_ADJ\"",
            "\"-1000\"",
            "0"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"system cgroup: memory: total:%luM allowed:%.4g%%(%s), \"\n\t       \"swap:%.4g%%(%s), max:%.4g%%(%luM) max+swap:%.4g%%(%luM) min:%uM\"",
            "(unsigned long) totalram",
            "allowed_ram_space",
            "constrain_ram_space?\"enforced\":\"permissive\"",
            "allowed_swap_space",
            "constrain_swap_space?\"enforced\":\"permissive\"",
            "slurm_cgroup_conf.max_ram_percent",
            "(unsigned long) (max_ram/(1024*1024))",
            "slurm_cgroup_conf.max_swap_percent",
            "(unsigned long) (max_swap/(1024*1024))",
            "(unsigned) slurm_cgroup_conf.min_ram_space"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_percent_in_bytes",
          "args": [
            "totalram",
            "slurm_cgroup_conf.max_swap_percent"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "_percent_in_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "94-97",
          "snippet": "static uint64_t _percent_in_bytes (uint64_t mb, float percent)\n{\n\treturn ((mb * 1024 * 1024) * (percent / 100.0));\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic uint64_t _percent_in_bytes (uint64_t mb, float percent)\n{\n\treturn ((mb * 1024 * 1024) * (percent / 100.0));\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"system cgroup: Unable to get RealMemory size\""
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"system cgroup: unable to create memory namespace\""
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xcgroup_ns_create",
          "args": [
            "&slurm_cgroup_conf",
            "&memory_ns",
            "\"\"",
            "\"memory\""
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_ns_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "97-128",
          "snippet": "int xcgroup_ns_create(slurm_cgroup_conf_t *conf,\n\t\t      xcgroup_ns_t *cgns, char *mnt_args, char *subsys) {\n\n\tcgns->mnt_point = xstrdup_printf(\"%s/%s\",\n\t\t\t\t\t conf->cgroup_mountpoint, subsys);\n\tcgns->mnt_args = xstrdup(mnt_args);\n\tcgns->subsystems = xstrdup(subsys);\n\tcgns->notify_prog = xstrdup_printf(\"%s/release_%s\",\n\t\t\t\t\t   conf->cgroup_release_agent, subsys);\n\n\t/* check that freezer cgroup namespace is available */\n\tif (!xcgroup_ns_is_available(cgns)) {\n\t\tif (conf->cgroup_automount) {\n\t\t\tif (xcgroup_ns_mount(cgns)) {\n\t\t\t\terror(\"unable to mount %s cgroup \"\n\t\t\t\t      \"namespace: %s\",\n\t\t\t\t      subsys, slurm_strerror(errno));\n\t\t\t\tgoto clean;\n\t\t\t}\n\t\t\tinfo(\"cgroup namespace '%s' is now mounted\", subsys);\n\t\t} else {\n\t\t\terror(\"cgroup namespace '%s' not mounted. aborting\",\n\t\t\t      subsys);\n\t\t\tgoto clean;\n\t\t}\n\t}\n\n\treturn XCGROUP_SUCCESS;\nclean:\n\txcgroup_ns_destroy(cgns);\n\treturn XCGROUP_ERROR;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_ns_create(slurm_cgroup_conf_t *conf,\n\t\t      xcgroup_ns_t *cgns, char *mnt_args, char *subsys) {\n\n\tcgns->mnt_point = xstrdup_printf(\"%s/%s\",\n\t\t\t\t\t conf->cgroup_mountpoint, subsys);\n\tcgns->mnt_args = xstrdup(mnt_args);\n\tcgns->subsystems = xstrdup(subsys);\n\tcgns->notify_prog = xstrdup_printf(\"%s/release_%s\",\n\t\t\t\t\t   conf->cgroup_release_agent, subsys);\n\n\t/* check that freezer cgroup namespace is available */\n\tif (!xcgroup_ns_is_available(cgns)) {\n\t\tif (conf->cgroup_automount) {\n\t\t\tif (xcgroup_ns_mount(cgns)) {\n\t\t\t\terror(\"unable to mount %s cgroup \"\n\t\t\t\t      \"namespace: %s\",\n\t\t\t\t      subsys, slurm_strerror(errno));\n\t\t\t\tgoto clean;\n\t\t\t}\n\t\t\tinfo(\"cgroup namespace '%s' is now mounted\", subsys);\n\t\t} else {\n\t\t\terror(\"cgroup namespace '%s' not mounted. aborting\",\n\t\t\t      subsys);\n\t\t\tgoto clean;\n\t\t}\n\t}\n\n\treturn XCGROUP_SUCCESS;\nclean:\n\txcgroup_ns_destroy(cgns);\n\treturn XCGROUP_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "read_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\n#define PATH_MAX 256\n\nstatic xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic xcgroup_ns_t memory_ns = {NULL, NULL, NULL, NULL};\nstatic char system_cgroup_path[PATH_MAX];\nstatic slurm_cgroup_conf_t slurm_cgroup_conf;\nstatic bool constrain_ram_space;\nstatic bool constrain_swap_space;\nstatic float allowed_ram_space;\nstatic float allowed_swap_space;\nstatic uint64_t max_ram;\nstatic uint64_t max_swap;\nstatic uint64_t totalram;\nstatic uint64_t min_ram_space;\nstatic char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);\nstatic int _xcgroup_cpuset_init(xcgroup_t* cg);\n\nextern int init_system_memory_cgroup(void)\n{\n\tint fstatus = SLURM_ERROR;\n\tchar* slurm_cgpath;\n\n\t/* read cgroup configuration */\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn SLURM_ERROR;\n\n\t/* initialize memory cgroup namespace */\n\tif (xcgroup_ns_create(&slurm_cgroup_conf, &memory_ns, \"\", \"memory\")\n\t    != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to create memory namespace\");\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\tconstrain_ram_space = slurm_cgroup_conf.constrain_ram_space;\n\tconstrain_swap_space = slurm_cgroup_conf.constrain_swap_space;\n\n\t/*\n\t * as the swap space threshold will be configured with a\n\t * mem+swp parameter value, if RAM space is not monitored,\n\t * set allowed RAM space to 100% of the job requested memory.\n\t * It will help to construct the mem+swp value that will be\n\t * used for both mem and mem+swp limit during memcg creation.\n\t */\n\tif ( constrain_ram_space )\n\t\tallowed_ram_space = slurm_cgroup_conf.allowed_ram_space;\n\telse\n\t\tallowed_ram_space = 100.0;\n\n\tallowed_swap_space = slurm_cgroup_conf.allowed_swap_space;\n\n\tif ((totalram = (uint64_t) conf->real_memory_size) == 0)\n\t\terror (\"system cgroup: Unable to get RealMemory size\");\n\n\tmax_ram = _percent_in_bytes(totalram, slurm_cgroup_conf.max_ram_percent);\n\tmax_swap = _percent_in_bytes(totalram, slurm_cgroup_conf.max_swap_percent);\n\tmax_swap += max_ram;\n\tmin_ram_space = slurm_cgroup_conf.min_ram_space * 1024 * 1024;\n\n\tdebug (\"system cgroup: memory: total:%luM allowed:%.4g%%(%s), \"\n\t       \"swap:%.4g%%(%s), max:%.4g%%(%luM) max+swap:%.4g%%(%luM) min:%uM\",\n\t       (unsigned long) totalram,\n\t       allowed_ram_space,\n\t       constrain_ram_space?\"enforced\":\"permissive\",\n\t       allowed_swap_space,\n\t       constrain_swap_space?\"enforced\":\"permissive\",\n\t       slurm_cgroup_conf.max_ram_percent,\n\t       (unsigned long) (max_ram/(1024*1024)),\n\t       slurm_cgroup_conf.max_swap_percent,\n\t       (unsigned long) (max_swap/(1024*1024)),\n\t       (unsigned) slurm_cgroup_conf.min_ram_space);\n\n        /*\n         *  Warning: OOM Killer must be disabled for slurmstepd\n         *  or it would be destroyed if the application use\n         *  more memory than permitted\n         *\n         *  If an env value is already set for slurmstepd\n         *  OOM killer behavior, keep it, otherwise set the\n         *  -1000 value, wich means do not let OOM killer kill it\n         *\n         *  FYI, setting \"export SLURMSTEPD_OOM_ADJ=-1000\"\n         *  in /etc/sysconfig/slurm would be the same\n         */\n        setenv(\"SLURMSTEPD_OOM_ADJ\", \"-1000\", 0);\n\n\t/* create slurm root cg in this cg namespace */\n\tslurm_cgpath = _system_cgroup_create_slurm_cg(&memory_ns);\n\tif ( slurm_cgpath == NULL ) {\n\t\txcgroup_ns_destroy(&memory_ns);\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\t/* build system cgroup relative path */\n\tsnprintf(system_cgroup_path, PATH_MAX, \"%s/system\", slurm_cgpath);\n\txfree(slurm_cgpath);\n\n\t/* create system cgroup in the cpuset ns */\n\tif (xcgroup_create(&memory_ns, &system_memory_cg,\n\t\t\t   system_cgroup_path,\n\t\t\t   getuid(), getgid()) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\tif (xcgroup_instantiate(&system_memory_cg) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\n\tif ( xcgroup_set_param(&system_memory_cg, \"memory.use_hierarchy\", \"1\")\n\t     != XCGROUP_SUCCESS ) {\n\t\terror(\"system cgroup: unable to ask for hierarchical accounting\"\n\t\t      \"of system memcg '%s'\", system_memory_cg.path);\n\t\tgoto error;\n\t}\n\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\tdebug(\"system cgroup: system memory cgroup initialized\");\n\treturn SLURM_SUCCESS;\n\nerror:\n\txcgroup_unlock(&system_memory_cg);\n\txcgroup_destroy(&system_memory_cg);\n\txcgroup_ns_destroy(&memory_ns);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn fstatus;\n}"
  },
  {
    "function_name": "init_system_cpuset_cgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "99-187",
    "snippet": "extern int init_system_cpuset_cgroup(void)\n{\n\tint rc;\n\tint fstatus = SLURM_ERROR;\n\tchar* cpus = NULL;\n\tsize_t cpus_size;\n\tchar* slurm_cgpath;\n\txcgroup_t slurm_cg;\n\n\t/* read cgroup configuration */\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn SLURM_ERROR;\n\n\t/* initialize cpuset cgroup namespace */\n\tif (xcgroup_ns_create(&slurm_cgroup_conf, &cpuset_ns, \"\", \"cpuset\")\n\t    != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to create cpuset namespace\");\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\t/* create slurm root cg in this cg namespace */\n\tslurm_cgpath = _system_cgroup_create_slurm_cg(&cpuset_ns);\n\tif ( slurm_cgpath == NULL ) {\n\t\txcgroup_ns_destroy(&cpuset_ns);\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\t/* check that this cgroup has cpus allowed or initialize them */\n\tif (xcgroup_load(&cpuset_ns, &slurm_cg, slurm_cgpath)\n\t    != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to load slurm cpuset xcgroup\");\n\t\txfree(slurm_cgpath);\n\t\txcgroup_ns_destroy(&cpuset_ns);\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\nagain:\n\tsnprintf(cpuset_meta, sizeof(cpuset_meta), \"%scpus\", cpuset_prefix);\n\trc = xcgroup_get_param(&slurm_cg, cpuset_meta, &cpus, &cpus_size);\n\tif (rc != XCGROUP_SUCCESS || cpus_size == 1) {\n\t\tif (!cpuset_prefix_set && (rc != XCGROUP_SUCCESS)) {\n\t\t\tcpuset_prefix_set = 1;\n\t\t\tcpuset_prefix = \"cpuset.\";\n\t\t\tgoto again;\n\t\t}\n\n\t\t/* initialize the cpusets as it was nonexistent */\n\t\tif (_xcgroup_cpuset_init(&slurm_cg) != XCGROUP_SUCCESS) {\n\t\t\txfree(slurm_cgpath);\n\t\t\txcgroup_destroy(&slurm_cg);\n\t\t\txcgroup_ns_destroy(&cpuset_ns);\n\t\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\t\txfree(cpus);\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t}\n\txcgroup_destroy(&slurm_cg);\n\txfree(cpus);\n\n\t/* build system cgroup relative path */\n\tsnprintf(system_cgroup_path, PATH_MAX, \"%s/system\", slurm_cgpath);\n\txfree(slurm_cgpath);\n\n\t/* create system cgroup in the cpuset ns */\n\tif (xcgroup_create(&cpuset_ns, &system_cpuset_cg, system_cgroup_path,\n\t\t\t   getuid(),getgid()) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\tif (xcgroup_instantiate(&system_cpuset_cg) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\tif (_xcgroup_cpuset_init(&system_cpuset_cg) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\tdebug(\"system cgroup: system cpuset cgroup initialized\");\n\treturn SLURM_SUCCESS;\n\nerror:\n\txcgroup_unlock(&system_cpuset_cg);\n\txcgroup_destroy(&system_cpuset_cg);\n\txcgroup_ns_destroy(&cpuset_ns);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn fstatus;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [
      "#define PATH_MAX 256"
    ],
    "globals_used": [
      "static xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
      "static bool cpuset_prefix_set = false;",
      "static char *cpuset_prefix = \"\";",
      "static xcgroup_ns_t cpuset_ns = {NULL, NULL, NULL, NULL};",
      "char cpuset_meta[PATH_MAX];",
      "static char system_cgroup_path[PATH_MAX];",
      "static slurm_cgroup_conf_t slurm_cgroup_conf;",
      "static char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);",
      "static int _xcgroup_cpuset_init(xcgroup_t* cg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xcgroup_ns_destroy",
          "args": [
            "&cpuset_ns"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_ns_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "133-139",
          "snippet": "void xcgroup_ns_destroy(xcgroup_ns_t* cgns)\n{\n\txfree(cgns->mnt_point);\n\txfree(cgns->mnt_args);\n\txfree(cgns->subsystems);\n\txfree(cgns->notify_prog);\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nvoid xcgroup_ns_destroy(xcgroup_ns_t* cgns)\n{\n\txfree(cgns->mnt_point);\n\txfree(cgns->mnt_args);\n\txfree(cgns->subsystems);\n\txfree(cgns->notify_prog);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_destroy",
          "args": [
            "&system_cpuset_cg"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "396-403",
          "snippet": "void xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nvoid xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_unlock",
          "args": [
            "&system_cpuset_cg"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "428-440",
          "snippet": "int xcgroup_unlock(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\n\tif (flock(cg->fd,  LOCK_UN) < 0) {\n\t\tdebug2(\"%s: error unlocking cgroup '%s' : %m\",\n\t\t       __func__, cg->path);\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\tclose(cg->fd);\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\n\nint xcgroup_unlock(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\n\tif (flock(cg->fd,  LOCK_UN) < 0) {\n\t\tdebug2(\"%s: error unlocking cgroup '%s' : %m\",\n\t\t       __func__, cg->path);\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\tclose(cg->fd);\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"system cgroup: system cpuset cgroup initialized\""
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "pdebug_stop_current",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/pdebug.c",
          "lines": "120-139",
          "snippet": "void\npdebug_stop_current(stepd_step_rec_t *job)\n{\n\t/*\n\t * Stop the task on exec for TotalView to connect\n\t */\n\tif ( (job->task_flags & TASK_PARALLEL_DEBUG)\n#ifdef BSD\n\t     && (_PTRACE(PT_TRACE_ME, 0, (caddr_t)0, 0) < 0) )\n#elif defined(PT_TRACE_ME)\n\t     && (_PTRACE(PT_TRACE_ME, 0, NULL, 0) < 0) )\n#elif defined(__sun)\n\t     && (_PTRACE(0, 0, NULL, 0) < 0))\n#elif defined(__CYGWIN__)\n\t     && 0)\n#else\n\t     && (_PTRACE(PTRACE_TRACEME, 0, NULL, 0) < 0) )\n#endif\n\t\terror(\"ptrace: %m\");\n}",
          "includes": [
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"pdebug.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"pdebug.h\"\n\nvoid\npdebug_stop_current(stepd_step_rec_t *job)\n{\n\t/*\n\t * Stop the task on exec for TotalView to connect\n\t */\n\tif ( (job->task_flags & TASK_PARALLEL_DEBUG)\n#ifdef BSD\n\t     && (_PTRACE(PT_TRACE_ME, 0, (caddr_t)0, 0) < 0) )\n#elif defined(PT_TRACE_ME)\n\t     && (_PTRACE(PT_TRACE_ME, 0, NULL, 0) < 0) )\n#elif defined(__sun)\n\t     && (_PTRACE(0, 0, NULL, 0) < 0))\n#elif defined(__CYGWIN__)\n\t     && 0)\n#else\n\t     && (_PTRACE(PTRACE_TRACEME, 0, NULL, 0) < 0) )\n#endif\n\t\terror(\"ptrace: %m\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_xcgroup_cpuset_init",
          "args": [
            "&system_cpuset_cg"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "_xcgroup_cpuset_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "354-424",
          "snippet": "static int _xcgroup_cpuset_init(xcgroup_t* cg)\n{\n\tint fstatus, i;\n\n\tchar* cpuset_metafiles[] = {\n\t\t\"cpus\",\n\t\t\"mems\"\n\t};\n\tchar* cpuset_conf = NULL;\n\tsize_t csize = 0;\n\n\txcgroup_t acg;\n\tchar* acg_name = NULL;\n\tchar* p;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* load ancestor cg */\n\tacg_name = (char*) xstrdup(cg->name);\n\tp = rindex(acg_name,'/');\n\tif (p == NULL) {\n\t\tdebug2(\"system cgroup: unable to get ancestor path for \"\n\t\t       \"cpuset cg '%s' : %m\", cg->path);\n\t\txfree(acg_name);\n\t\treturn fstatus;\n\t} else\n\t\t*p = '\\0';\n\tif (xcgroup_load(cg->ns, &acg, acg_name) != XCGROUP_SUCCESS) {\n\t\tdebug2(\"system cgroup: unable to load ancestor for \"\n\t\t       \"cpuset cg '%s' : %m\", cg->path);\n\t\txfree(acg_name);\n\t\treturn fstatus;\n\t}\n\txfree(acg_name);\n\n\t/* inherits ancestor params */\n\tfor (i = 0 ; i < 2 ; i++) {\n\tagain:\n\t\tsnprintf(cpuset_meta, sizeof(cpuset_meta), \"%s%s\",\n\t\t\t cpuset_prefix, cpuset_metafiles[i]);\n\t\tif (xcgroup_get_param(&acg ,cpuset_meta,\n\t\t\t\t      &cpuset_conf, &csize)\n\t\t    != XCGROUP_SUCCESS) {\n\t\t\tif (!cpuset_prefix_set) {\n\t\t\t\tcpuset_prefix_set = 1;\n\t\t\t\tcpuset_prefix = \"cpuset.\";\n\t\t\t\tgoto again;\n\t\t\t}\n\n\t\t\tdebug(\"system cgroup: assuming no cpuset cg \"\n\t\t\t       \"support for '%s'\",acg.path);\n\t\t\txcgroup_destroy(&acg);\n\t\t\treturn fstatus;\n\t\t}\n\t\tif (csize > 0)\n\t\t\tcpuset_conf[csize-1] = '\\0';\n\t\tif (xcgroup_set_param(cg,cpuset_meta, cpuset_conf)\n\t\t    != XCGROUP_SUCCESS) {\n\t\t\tdebug(\"system cgroup: unable to write %s configuration \"\n\t\t\t       \"(%s) for cpuset cg '%s'\",cpuset_meta,\n\t\t\t       cpuset_conf, cg->path);\n\t\t\txcgroup_destroy(&acg);\n\t\t\txfree(cpuset_conf);\n\t\t\treturn fstatus;\n\t\t}\n\t\txfree(cpuset_conf);\n\t}\n\n\txcgroup_destroy(&acg);\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool cpuset_prefix_set = false;",
            "static char *cpuset_prefix = \"\";",
            "char cpuset_meta[PATH_MAX];",
            "static char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);",
            "static int _xcgroup_cpuset_init(xcgroup_t* cg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic bool cpuset_prefix_set = false;\nstatic char *cpuset_prefix = \"\";\nchar cpuset_meta[PATH_MAX];\nstatic char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);\nstatic int _xcgroup_cpuset_init(xcgroup_t* cg);\n\nstatic int _xcgroup_cpuset_init(xcgroup_t* cg)\n{\n\tint fstatus, i;\n\n\tchar* cpuset_metafiles[] = {\n\t\t\"cpus\",\n\t\t\"mems\"\n\t};\n\tchar* cpuset_conf = NULL;\n\tsize_t csize = 0;\n\n\txcgroup_t acg;\n\tchar* acg_name = NULL;\n\tchar* p;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* load ancestor cg */\n\tacg_name = (char*) xstrdup(cg->name);\n\tp = rindex(acg_name,'/');\n\tif (p == NULL) {\n\t\tdebug2(\"system cgroup: unable to get ancestor path for \"\n\t\t       \"cpuset cg '%s' : %m\", cg->path);\n\t\txfree(acg_name);\n\t\treturn fstatus;\n\t} else\n\t\t*p = '\\0';\n\tif (xcgroup_load(cg->ns, &acg, acg_name) != XCGROUP_SUCCESS) {\n\t\tdebug2(\"system cgroup: unable to load ancestor for \"\n\t\t       \"cpuset cg '%s' : %m\", cg->path);\n\t\txfree(acg_name);\n\t\treturn fstatus;\n\t}\n\txfree(acg_name);\n\n\t/* inherits ancestor params */\n\tfor (i = 0 ; i < 2 ; i++) {\n\tagain:\n\t\tsnprintf(cpuset_meta, sizeof(cpuset_meta), \"%s%s\",\n\t\t\t cpuset_prefix, cpuset_metafiles[i]);\n\t\tif (xcgroup_get_param(&acg ,cpuset_meta,\n\t\t\t\t      &cpuset_conf, &csize)\n\t\t    != XCGROUP_SUCCESS) {\n\t\t\tif (!cpuset_prefix_set) {\n\t\t\t\tcpuset_prefix_set = 1;\n\t\t\t\tcpuset_prefix = \"cpuset.\";\n\t\t\t\tgoto again;\n\t\t\t}\n\n\t\t\tdebug(\"system cgroup: assuming no cpuset cg \"\n\t\t\t       \"support for '%s'\",acg.path);\n\t\t\txcgroup_destroy(&acg);\n\t\t\treturn fstatus;\n\t\t}\n\t\tif (csize > 0)\n\t\t\tcpuset_conf[csize-1] = '\\0';\n\t\tif (xcgroup_set_param(cg,cpuset_meta, cpuset_conf)\n\t\t    != XCGROUP_SUCCESS) {\n\t\t\tdebug(\"system cgroup: unable to write %s configuration \"\n\t\t\t       \"(%s) for cpuset cg '%s'\",cpuset_meta,\n\t\t\t       cpuset_conf, cg->path);\n\t\t\txcgroup_destroy(&acg);\n\t\t\txfree(cpuset_conf);\n\t\t\treturn fstatus;\n\t\t}\n\t\txfree(cpuset_conf);\n\t}\n\n\txcgroup_destroy(&acg);\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_instantiate",
          "args": [
            "&system_cpuset_cg"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_instantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "442-495",
          "snippet": "int xcgroup_instantiate(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tmode_t cmask;\n\tmode_t omask;\n\n\txcgroup_ns_t* cgns;\n\tchar* file_path;\n\tuid_t uid;\n\tgid_t gid;\n\tint create_only;\n\tuint32_t notify;\n\n\t/* init variables based on input cgroup */\n\tcgns = cg->ns;\n\tfile_path = cg->path;\n\tuid = cg->uid;\n\tgid = cg->gid;\n\tcreate_only = 0;\n\tnotify = cg->notify;\n\n\t/* save current mask and apply working one */\n\tcmask = S_IWGRP | S_IWOTH;\n\tomask = umask(cmask);\n\n\t/* build cgroup */\n \tif (mkdir(file_path, 0755)) {\n\t\tif (create_only || errno != EEXIST) {\n\t\t\tdebug2(\"%s: unable to create cgroup '%s' : %m\",\n\t\t\t       __func__, file_path);\n\t\t\tumask(omask);\n\t\t\treturn fstatus;\n\t\t}\n\t}\n\tumask(omask);\n\n\t/* change cgroup ownership as requested */\n\tif (chown(file_path, uid, gid)) {\n\t\tdebug2(\"%s: unable to chown %d:%d cgroup '%s' : %m\",\n\t\t       __func__, uid, gid, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* following operations failure might not result in a general\n\t * failure so set output status to success */\n\tfstatus = XCGROUP_SUCCESS;\n\n\t/* set notify on release flag */\n\tif (notify == 1 && cgns->notify_prog)\n\t\txcgroup_set_params(cg, \"notify_on_release=1\");\n\telse\n\t\txcgroup_set_params(cg, \"notify_on_release=0\");\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_instantiate(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tmode_t cmask;\n\tmode_t omask;\n\n\txcgroup_ns_t* cgns;\n\tchar* file_path;\n\tuid_t uid;\n\tgid_t gid;\n\tint create_only;\n\tuint32_t notify;\n\n\t/* init variables based on input cgroup */\n\tcgns = cg->ns;\n\tfile_path = cg->path;\n\tuid = cg->uid;\n\tgid = cg->gid;\n\tcreate_only = 0;\n\tnotify = cg->notify;\n\n\t/* save current mask and apply working one */\n\tcmask = S_IWGRP | S_IWOTH;\n\tomask = umask(cmask);\n\n\t/* build cgroup */\n \tif (mkdir(file_path, 0755)) {\n\t\tif (create_only || errno != EEXIST) {\n\t\t\tdebug2(\"%s: unable to create cgroup '%s' : %m\",\n\t\t\t       __func__, file_path);\n\t\t\tumask(omask);\n\t\t\treturn fstatus;\n\t\t}\n\t}\n\tumask(omask);\n\n\t/* change cgroup ownership as requested */\n\tif (chown(file_path, uid, gid)) {\n\t\tdebug2(\"%s: unable to chown %d:%d cgroup '%s' : %m\",\n\t\t       __func__, uid, gid, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* following operations failure might not result in a general\n\t * failure so set output status to success */\n\tfstatus = XCGROUP_SUCCESS;\n\n\t/* set notify on release flag */\n\tif (notify == 1 && cgns->notify_prog)\n\t\txcgroup_set_params(cg, \"notify_on_release=1\");\n\telse\n\t\txcgroup_set_params(cg, \"notify_on_release=0\");\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_create",
          "args": [
            "&cpuset_ns",
            "&system_cpuset_cg",
            "system_cgroup_path",
            "getuid()",
            "getgid()"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "371-394",
          "snippet": "int xcgroup_create(xcgroup_ns_t* cgns, xcgroup_t* cg,\n\t\t   char* uri, uid_t uid,  gid_t gid)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = uid;\n\tcg->gid = gid;\n\tcg->notify = 1;\n\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_create(xcgroup_ns_t* cgns, xcgroup_t* cg,\n\t\t   char* uri, uid_t uid,  gid_t gid)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = uid;\n\tcg->gid = gid;\n\tcg->notify = 1;\n\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getgid",
          "args": [],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "slurm_cgpath"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "system_cgroup_path",
            "PATH_MAX",
            "\"%s/system\"",
            "slurm_cgpath"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xcgroup_get_param",
          "args": [
            "&slurm_cg",
            "cpuset_meta",
            "&cpus",
            "&cpus_size"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_get_param",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "676-692",
          "snippet": "int xcgroup_get_param(xcgroup_t* cg, char* param, char **content, size_t *csize)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t} else {\n\t\tfstatus = _file_read_content(file_path, content, csize);\n\t\tif (fstatus != XCGROUP_SUCCESS)\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t}\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint xcgroup_get_param(xcgroup_t* cg, char* param, char **content, size_t *csize)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t} else {\n\t\tfstatus = _file_read_content(file_path, content, csize);\n\t\tif (fstatus != XCGROUP_SUCCESS)\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t}\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "cpuset_meta",
            "sizeof(cpuset_meta)",
            "\"%scpus\"",
            "cpuset_prefix"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"system cgroup: unable to load slurm cpuset xcgroup\""
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xcgroup_load",
          "args": [
            "&cpuset_ns",
            "&slurm_cg",
            "slurm_cgpath"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "497-529",
          "snippet": "int xcgroup_load(xcgroup_ns_t* cgns, xcgroup_t* cg, char* uri)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\tstruct stat buf;\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\tif (stat((const char*)file_path, &buf)) {\n\t\tdebug2(\"%s: unable to get cgroup '%s' entry '%s' properties\"\n\t\t       \": %m\", __func__, cgns->mnt_point, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = buf.st_uid;\n\tcg->gid = buf.st_gid;\n\n\t/* read the content of the notify flag */\n\txcgroup_get_uint32_param(cg, \"notify_on_release\", &(cg->notify));\n\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_load(xcgroup_ns_t* cgns, xcgroup_t* cg, char* uri)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\tstruct stat buf;\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\tif (stat((const char*)file_path, &buf)) {\n\t\tdebug2(\"%s: unable to get cgroup '%s' entry '%s' properties\"\n\t\t       \": %m\", __func__, cgns->mnt_point, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = buf.st_uid;\n\tcg->gid = buf.st_gid;\n\n\t/* read the content of the notify flag */\n\txcgroup_get_uint32_param(cg, \"notify_on_release\", &(cg->notify));\n\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_system_cgroup_create_slurm_cg",
          "args": [
            "&cpuset_ns"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "_system_cgroup_create_slurm_cg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "307-348",
          "snippet": "static char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns)\n{\n\t/* we do it here as we do not have access to the conf structure */\n\t/* in libslurm (src/common/xcgroup.c) */\n\txcgroup_t slurm_cg;\n\tchar* pre = (char*) xstrdup(slurm_cgroup_conf.cgroup_prepend);\n\n#ifdef MULTIPLE_SLURMD\n\tif ( conf->node_name != NULL )\n\t\txstrsubstitute(pre, \"%n\", conf->node_name);\n\telse {\n\t\txfree(pre);\n\t\tpre = (char*) xstrdup(\"/slurm\");\n\t}\n#endif\n\n\t/* create slurm cgroup in the ns\n\t * disable notify_on_release to avoid the removal/creation\n\t * of this cgroup for each last/first running job on the node */\n\tif (xcgroup_create(ns, &slurm_cg, pre,\n\t\t\t   getuid(), getgid()) != XCGROUP_SUCCESS) {\n\t\txfree(pre);\n\t\treturn pre;\n\t}\n\tslurm_cg.notify = 0;\n\tif (xcgroup_instantiate(&slurm_cg) != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to build slurm cgroup for \"\n\t\t      \"ns %s: %m\",\n\t\t      ns->subsystems);\n\t\txcgroup_destroy(&slurm_cg);\n\t\txfree(pre);\n\t\treturn pre;\n\t}\n\telse {\n\t\tdebug3(\"system cgroup: slurm cgroup %s successfully created \"\n\t\t       \"for ns %s: %m\",\n\t\t       pre, ns->subsystems);\n\t\txcgroup_destroy(&slurm_cg);\n\t}\n\n\treturn pre;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static slurm_cgroup_conf_t slurm_cgroup_conf;",
            "static char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic slurm_cgroup_conf_t slurm_cgroup_conf;\nstatic char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);\n\nstatic char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns)\n{\n\t/* we do it here as we do not have access to the conf structure */\n\t/* in libslurm (src/common/xcgroup.c) */\n\txcgroup_t slurm_cg;\n\tchar* pre = (char*) xstrdup(slurm_cgroup_conf.cgroup_prepend);\n\n#ifdef MULTIPLE_SLURMD\n\tif ( conf->node_name != NULL )\n\t\txstrsubstitute(pre, \"%n\", conf->node_name);\n\telse {\n\t\txfree(pre);\n\t\tpre = (char*) xstrdup(\"/slurm\");\n\t}\n#endif\n\n\t/* create slurm cgroup in the ns\n\t * disable notify_on_release to avoid the removal/creation\n\t * of this cgroup for each last/first running job on the node */\n\tif (xcgroup_create(ns, &slurm_cg, pre,\n\t\t\t   getuid(), getgid()) != XCGROUP_SUCCESS) {\n\t\txfree(pre);\n\t\treturn pre;\n\t}\n\tslurm_cg.notify = 0;\n\tif (xcgroup_instantiate(&slurm_cg) != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to build slurm cgroup for \"\n\t\t      \"ns %s: %m\",\n\t\t      ns->subsystems);\n\t\txcgroup_destroy(&slurm_cg);\n\t\txfree(pre);\n\t\treturn pre;\n\t}\n\telse {\n\t\tdebug3(\"system cgroup: slurm cgroup %s successfully created \"\n\t\t       \"for ns %s: %m\",\n\t\t       pre, ns->subsystems);\n\t\txcgroup_destroy(&slurm_cg);\n\t}\n\n\treturn pre;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"system cgroup: unable to create cpuset namespace\""
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xcgroup_ns_create",
          "args": [
            "&slurm_cgroup_conf",
            "&cpuset_ns",
            "\"\"",
            "\"cpuset\""
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_ns_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "97-128",
          "snippet": "int xcgroup_ns_create(slurm_cgroup_conf_t *conf,\n\t\t      xcgroup_ns_t *cgns, char *mnt_args, char *subsys) {\n\n\tcgns->mnt_point = xstrdup_printf(\"%s/%s\",\n\t\t\t\t\t conf->cgroup_mountpoint, subsys);\n\tcgns->mnt_args = xstrdup(mnt_args);\n\tcgns->subsystems = xstrdup(subsys);\n\tcgns->notify_prog = xstrdup_printf(\"%s/release_%s\",\n\t\t\t\t\t   conf->cgroup_release_agent, subsys);\n\n\t/* check that freezer cgroup namespace is available */\n\tif (!xcgroup_ns_is_available(cgns)) {\n\t\tif (conf->cgroup_automount) {\n\t\t\tif (xcgroup_ns_mount(cgns)) {\n\t\t\t\terror(\"unable to mount %s cgroup \"\n\t\t\t\t      \"namespace: %s\",\n\t\t\t\t      subsys, slurm_strerror(errno));\n\t\t\t\tgoto clean;\n\t\t\t}\n\t\t\tinfo(\"cgroup namespace '%s' is now mounted\", subsys);\n\t\t} else {\n\t\t\terror(\"cgroup namespace '%s' not mounted. aborting\",\n\t\t\t      subsys);\n\t\t\tgoto clean;\n\t\t}\n\t}\n\n\treturn XCGROUP_SUCCESS;\nclean:\n\txcgroup_ns_destroy(cgns);\n\treturn XCGROUP_ERROR;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_ns_create(slurm_cgroup_conf_t *conf,\n\t\t      xcgroup_ns_t *cgns, char *mnt_args, char *subsys) {\n\n\tcgns->mnt_point = xstrdup_printf(\"%s/%s\",\n\t\t\t\t\t conf->cgroup_mountpoint, subsys);\n\tcgns->mnt_args = xstrdup(mnt_args);\n\tcgns->subsystems = xstrdup(subsys);\n\tcgns->notify_prog = xstrdup_printf(\"%s/release_%s\",\n\t\t\t\t\t   conf->cgroup_release_agent, subsys);\n\n\t/* check that freezer cgroup namespace is available */\n\tif (!xcgroup_ns_is_available(cgns)) {\n\t\tif (conf->cgroup_automount) {\n\t\t\tif (xcgroup_ns_mount(cgns)) {\n\t\t\t\terror(\"unable to mount %s cgroup \"\n\t\t\t\t      \"namespace: %s\",\n\t\t\t\t      subsys, slurm_strerror(errno));\n\t\t\t\tgoto clean;\n\t\t\t}\n\t\t\tinfo(\"cgroup namespace '%s' is now mounted\", subsys);\n\t\t} else {\n\t\t\terror(\"cgroup namespace '%s' not mounted. aborting\",\n\t\t\t      subsys);\n\t\t\tgoto clean;\n\t\t}\n\t}\n\n\treturn XCGROUP_SUCCESS;\nclean:\n\txcgroup_ns_destroy(cgns);\n\treturn XCGROUP_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "read_slurm_cgroup_conf",
          "args": [
            "&slurm_cgroup_conf"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\n#define PATH_MAX 256\n\nstatic xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic bool cpuset_prefix_set = false;\nstatic char *cpuset_prefix = \"\";\nstatic xcgroup_ns_t cpuset_ns = {NULL, NULL, NULL, NULL};\nchar cpuset_meta[PATH_MAX];\nstatic char system_cgroup_path[PATH_MAX];\nstatic slurm_cgroup_conf_t slurm_cgroup_conf;\nstatic char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);\nstatic int _xcgroup_cpuset_init(xcgroup_t* cg);\n\nextern int init_system_cpuset_cgroup(void)\n{\n\tint rc;\n\tint fstatus = SLURM_ERROR;\n\tchar* cpus = NULL;\n\tsize_t cpus_size;\n\tchar* slurm_cgpath;\n\txcgroup_t slurm_cg;\n\n\t/* read cgroup configuration */\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn SLURM_ERROR;\n\n\t/* initialize cpuset cgroup namespace */\n\tif (xcgroup_ns_create(&slurm_cgroup_conf, &cpuset_ns, \"\", \"cpuset\")\n\t    != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to create cpuset namespace\");\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\t/* create slurm root cg in this cg namespace */\n\tslurm_cgpath = _system_cgroup_create_slurm_cg(&cpuset_ns);\n\tif ( slurm_cgpath == NULL ) {\n\t\txcgroup_ns_destroy(&cpuset_ns);\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\t/* check that this cgroup has cpus allowed or initialize them */\n\tif (xcgroup_load(&cpuset_ns, &slurm_cg, slurm_cgpath)\n\t    != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to load slurm cpuset xcgroup\");\n\t\txfree(slurm_cgpath);\n\t\txcgroup_ns_destroy(&cpuset_ns);\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\nagain:\n\tsnprintf(cpuset_meta, sizeof(cpuset_meta), \"%scpus\", cpuset_prefix);\n\trc = xcgroup_get_param(&slurm_cg, cpuset_meta, &cpus, &cpus_size);\n\tif (rc != XCGROUP_SUCCESS || cpus_size == 1) {\n\t\tif (!cpuset_prefix_set && (rc != XCGROUP_SUCCESS)) {\n\t\t\tcpuset_prefix_set = 1;\n\t\t\tcpuset_prefix = \"cpuset.\";\n\t\t\tgoto again;\n\t\t}\n\n\t\t/* initialize the cpusets as it was nonexistent */\n\t\tif (_xcgroup_cpuset_init(&slurm_cg) != XCGROUP_SUCCESS) {\n\t\t\txfree(slurm_cgpath);\n\t\t\txcgroup_destroy(&slurm_cg);\n\t\t\txcgroup_ns_destroy(&cpuset_ns);\n\t\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\t\txfree(cpus);\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t}\n\txcgroup_destroy(&slurm_cg);\n\txfree(cpus);\n\n\t/* build system cgroup relative path */\n\tsnprintf(system_cgroup_path, PATH_MAX, \"%s/system\", slurm_cgpath);\n\txfree(slurm_cgpath);\n\n\t/* create system cgroup in the cpuset ns */\n\tif (xcgroup_create(&cpuset_ns, &system_cpuset_cg, system_cgroup_path,\n\t\t\t   getuid(),getgid()) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\tif (xcgroup_instantiate(&system_cpuset_cg) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\tif (_xcgroup_cpuset_init(&system_cpuset_cg) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\tdebug(\"system cgroup: system cpuset cgroup initialized\");\n\treturn SLURM_SUCCESS;\n\nerror:\n\txcgroup_unlock(&system_cpuset_cg);\n\txcgroup_destroy(&system_cpuset_cg);\n\txcgroup_ns_destroy(&cpuset_ns);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn fstatus;\n}"
  },
  {
    "function_name": "_percent_in_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
    "lines": "94-97",
    "snippet": "static uint64_t _percent_in_bytes (uint64_t mb, float percent)\n{\n\treturn ((mb * 1024 * 1024) * (percent / 100.0));\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/common/xcgroup.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xcgroup_read_config.h\"",
      "#include \"src/common/slurm_resource_info.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include \"slurm/slurm.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include <sys/types.h>",
      "#include <stdlib.h>",
      "#include <sched.h>",
      "#include <ctype.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic uint64_t _percent_in_bytes (uint64_t mb, float percent)\n{\n\treturn ((mb * 1024 * 1024) * (percent / 100.0));\n}"
  }
]