[
  {
    "function_name": "proctrack_g_get_pids",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
    "lines": "468-475",
    "snippet": "extern int\nproctrack_g_get_pids(uint64_t cont_id, pid_t ** pids, int *npids)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.get_pids)) (cont_id, pids, npids);\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/plugrack.h\"",
      "#include \"src/common/log.h\"",
      "#  include <linux/sched.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static slurm_proctrack_ops_t ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "cont_id",
            "pids",
            "npids"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_proctrack_init",
          "args": [],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "slurm_proctrack_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "108-137",
          "snippet": "extern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};",
            "static slurm_proctrack_ops_t ops;",
            "static plugin_context_t *g_context = NULL;",
            "static pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};\nstatic slurm_proctrack_ops_t ops;\nstatic plugin_context_t *g_context = NULL;\nstatic pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic slurm_proctrack_ops_t ops;\n\nextern int\nproctrack_g_get_pids(uint64_t cont_id, pid_t ** pids, int *npids)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.get_pids)) (cont_id, pids, npids);\n}"
  },
  {
    "function_name": "proctrack_g_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
    "lines": "448-454",
    "snippet": "extern int proctrack_g_wait(uint64_t cont_id)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.wait)) (cont_id);\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/plugrack.h\"",
      "#include \"src/common/log.h\"",
      "#  include <linux/sched.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static slurm_proctrack_ops_t ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "cont_id"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_proctrack_init",
          "args": [],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "slurm_proctrack_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "108-137",
          "snippet": "extern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};",
            "static slurm_proctrack_ops_t ops;",
            "static plugin_context_t *g_context = NULL;",
            "static pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};\nstatic slurm_proctrack_ops_t ops;\nstatic plugin_context_t *g_context = NULL;\nstatic pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic slurm_proctrack_ops_t ops;\n\nextern int proctrack_g_wait(uint64_t cont_id)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.wait)) (cont_id);\n}"
  },
  {
    "function_name": "proctrack_g_has_pid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
    "lines": "430-436",
    "snippet": "extern bool proctrack_g_has_pid(uint64_t cont_id, pid_t pid)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.has_pid)) (cont_id, pid);\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/plugrack.h\"",
      "#include \"src/common/log.h\"",
      "#  include <linux/sched.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static slurm_proctrack_ops_t ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "cont_id",
            "pid"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_proctrack_init",
          "args": [],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "slurm_proctrack_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "108-137",
          "snippet": "extern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};",
            "static slurm_proctrack_ops_t ops;",
            "static plugin_context_t *g_context = NULL;",
            "static pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};\nstatic slurm_proctrack_ops_t ops;\nstatic plugin_context_t *g_context = NULL;\nstatic pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic slurm_proctrack_ops_t ops;\n\nextern bool proctrack_g_has_pid(uint64_t cont_id, pid_t pid)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.has_pid)) (cont_id, pid);\n}"
  },
  {
    "function_name": "proctrack_g_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
    "lines": "418-424",
    "snippet": "extern uint64_t proctrack_g_find(pid_t pid)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.find_cont)) (pid);\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/plugrack.h\"",
      "#include \"src/common/log.h\"",
      "#  include <linux/sched.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static slurm_proctrack_ops_t ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "pid"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_proctrack_init",
          "args": [],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "slurm_proctrack_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "108-137",
          "snippet": "extern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};",
            "static slurm_proctrack_ops_t ops;",
            "static plugin_context_t *g_context = NULL;",
            "static pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};\nstatic slurm_proctrack_ops_t ops;\nstatic plugin_context_t *g_context = NULL;\nstatic pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic slurm_proctrack_ops_t ops;\n\nextern uint64_t proctrack_g_find(pid_t pid)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.find_cont)) (pid);\n}"
  },
  {
    "function_name": "proctrack_g_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
    "lines": "405-411",
    "snippet": "extern int proctrack_g_destroy(uint64_t cont_id)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.destroy)) (cont_id);\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/plugrack.h\"",
      "#include \"src/common/log.h\"",
      "#  include <linux/sched.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static slurm_proctrack_ops_t ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "cont_id"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_proctrack_init",
          "args": [],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "slurm_proctrack_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "108-137",
          "snippet": "extern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};",
            "static slurm_proctrack_ops_t ops;",
            "static plugin_context_t *g_context = NULL;",
            "static pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};\nstatic slurm_proctrack_ops_t ops;\nstatic plugin_context_t *g_context = NULL;\nstatic pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic slurm_proctrack_ops_t ops;\n\nextern int proctrack_g_destroy(uint64_t cont_id)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.destroy)) (cont_id);\n}"
  },
  {
    "function_name": "proctrack_g_signal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
    "lines": "348-397",
    "snippet": "extern int proctrack_g_signal(uint64_t cont_id, int signal)\n{\n\n\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\tif (signal == SIGKILL) {\n\t\tpid_t *pids = NULL;\n\t\tint i, j, npids = 0, hung_pids = 0;\n\t\tchar *stat_fname = NULL;\n\t\tif (proctrack_g_get_pids(cont_id, &pids, &npids) ==\n\t\t    SLURM_SUCCESS) {\n\t\t\t/* NOTE: proctrack_g_get_pids() is not supported\n\t\t\t * by the proctrack/pgid plugin */\n\t\t\tfor (j = 0; j < 2; j++) {\n\t\t\t\tif (j)\n\t\t\t\t\tsleep(2);\n\t\t\t\thung_pids = 0;\n\t\t\t\tfor (i = 0; i < npids; i++) {\n\t\t\t\t\tif (!pids[i])\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\txstrfmtcat(stat_fname, \"/proc/%d/stat\",\n\t\t\t\t\t\t   (int) pids[i]);\n\t\t\t\t\tif (_test_core_dumping(stat_fname)) {\n\t\t\t\t\t\tdebug(\"Process %d continuing \"\n\t\t\t\t\t\t      \"core dump\",\n\t\t\t\t\t\t      (int) pids[i]);\n\t\t\t\t\t\thung_pids++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t/* Don't test this PID again */\n\t\t\t\t\t\tpids[i] = 0;\n\t\t\t\t\t}\n\t\t\t\t\txfree(stat_fname);\n\t\t\t\t}\n\t\t\t\tif (hung_pids == 0)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\txfree(pids);\n\t\t\tif (hung_pids) {\n\t\t\t\tinfo(\"Defering sending signal, processes in \"\n\t\t\t\t     \"job are currently core dumping\");\n\t\t\t\t_spawn_signal_thread(cont_id, signal);\n\t\t\t\treturn SLURM_SUCCESS;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn (*(ops.signal)) (cont_id, signal);\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/plugrack.h\"",
      "#include \"src/common/log.h\"",
      "#  include <linux/sched.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static slurm_proctrack_ops_t ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "cont_id",
            "signal"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_spawn_signal_thread",
          "args": [
            "cont_id",
            "signal"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "_spawn_signal_thread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "323-338",
          "snippet": "static void _spawn_signal_thread(uint64_t cont_id, int signal)\n{\n\tagent_arg_t *agent_arg_ptr;\n\tpthread_attr_t attr_agent;\n\tpthread_t thread_agent;\n\n\tslurm_attr_init(&attr_agent);\n\tif (pthread_attr_setdetachstate(&attr_agent, PTHREAD_CREATE_DETACHED))\n\t\terror(\"pthread_attr_setdetachstate error %m\");\n\tagent_arg_ptr = xmalloc(sizeof(agent_arg_t));\n\tagent_arg_ptr->cont_id = cont_id;\n\tagent_arg_ptr->signal  = signal;\n\t(void) pthread_create(&thread_agent, &attr_agent,\n\t\t\t     _sig_agent, (void *) agent_arg_ptr);\n\tslurm_attr_destroy(&attr_agent);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic void _spawn_signal_thread(uint64_t cont_id, int signal)\n{\n\tagent_arg_t *agent_arg_ptr;\n\tpthread_attr_t attr_agent;\n\tpthread_t thread_agent;\n\n\tslurm_attr_init(&attr_agent);\n\tif (pthread_attr_setdetachstate(&attr_agent, PTHREAD_CREATE_DETACHED))\n\t\terror(\"pthread_attr_setdetachstate error %m\");\n\tagent_arg_ptr = xmalloc(sizeof(agent_arg_t));\n\tagent_arg_ptr->cont_id = cont_id;\n\tagent_arg_ptr->signal  = signal;\n\t(void) pthread_create(&thread_agent, &attr_agent,\n\t\t\t     _sig_agent, (void *) agent_arg_ptr);\n\tslurm_attr_destroy(&attr_agent);\n}"
        }
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Defering sending signal, processes in \"\n\t\t\t\t     \"job are currently core dumping\""
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "_fork_child_with_wait_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/mgr.c",
          "lines": "1464-1486",
          "snippet": "static struct exec_wait_info * _fork_child_with_wait_info (int id)\n{\n\tstruct exec_wait_info *e;\n\n\tif (!(e = _exec_wait_info_create (id)))\n\t\treturn (NULL);\n\n\tif ((e->pid = fork ()) < 0) {\n\t\t_exec_wait_info_destroy (e);\n\t\treturn (NULL);\n\t}\n\t/*\n\t *  Close parentfd in child, and childfd in parent:\n\t */\n\tif (e->pid == 0) {\n\t\tclose (e->parentfd);\n\t\te->parentfd = -1;\n\t} else {\n\t\tclose (e->childfd);\n\t\te->childfd = -1;\n\t}\n\treturn (e);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/ulimits.h\"",
            "#include \"src/slurmd/slurmstepd/pam_ses.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmstepd/task.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/reverse_tree.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/slurm_mpi.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/safeopen.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#    include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <pthread.h>",
            "#include <poll.h>",
            "#include <grp.h>",
            "#  include \"src/common/unsetenv.h\"",
            "#  include <sys/checkpnt.h>",
            "#  include <sys/prctl.h>",
            "#  include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/ulimits.h\"\n#include \"src/slurmd/slurmstepd/pam_ses.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmstepd/task.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/reverse_tree.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/slurm_mpi.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/safeopen.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/cbuf.h\"\n#include \"slurm/slurm_errno.h\"\n#    include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <string.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <pthread.h>\n#include <poll.h>\n#include <grp.h>\n#  include \"src/common/unsetenv.h\"\n#  include <sys/checkpnt.h>\n#  include <sys/prctl.h>\n#  include <sys/types.h>\n#  include \"config.h\"\n\nstatic struct exec_wait_info * _fork_child_with_wait_info (int id)\n{\n\tstruct exec_wait_info *e;\n\n\tif (!(e = _exec_wait_info_create (id)))\n\t\treturn (NULL);\n\n\tif ((e->pid = fork ()) < 0) {\n\t\t_exec_wait_info_destroy (e);\n\t\treturn (NULL);\n\t}\n\t/*\n\t *  Close parentfd in child, and childfd in parent:\n\t */\n\tif (e->pid == 0) {\n\t\tclose (e->parentfd);\n\t\te->parentfd = -1;\n\t} else {\n\t\tclose (e->childfd);\n\t\te->childfd = -1;\n\t}\n\treturn (e);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "pids"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"Process %d continuing \"\n\t\t\t\t\t\t      \"core dump\"",
            "(int) pids[i]"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "pdebug_wake_process",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/pdebug.c",
          "lines": "187-199",
          "snippet": "void pdebug_wake_process(stepd_step_rec_t *job, pid_t pid)\n{\n\tif ((job->task_flags & TASK_PARALLEL_DEBUG) && (pid > (pid_t) 0)) {\n\t\tif (_pid_to_wake(pid)) {\n\t\t\tif (kill(pid, SIGCONT) < 0)\n\t\t\t\terror(\"kill(%lu): %m\", (unsigned long) pid);\n\t\t\telse\n\t\t\t\tdebug(\"woke pid %lu\", (unsigned long) pid);\n\t\t} else {\n\t\t\tdebug(\"pid %lu not stopped\", (unsigned long) pid);\n\t\t}\n\t}\n}",
          "includes": [
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"pdebug.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"pdebug.h\"\n\nvoid pdebug_wake_process(stepd_step_rec_t *job, pid_t pid)\n{\n\tif ((job->task_flags & TASK_PARALLEL_DEBUG) && (pid > (pid_t) 0)) {\n\t\tif (_pid_to_wake(pid)) {\n\t\t\tif (kill(pid, SIGCONT) < 0)\n\t\t\t\terror(\"kill(%lu): %m\", (unsigned long) pid);\n\t\t\telse\n\t\t\t\tdebug(\"woke pid %lu\", (unsigned long) pid);\n\t\t} else {\n\t\t\tdebug(\"pid %lu not stopped\", (unsigned long) pid);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "_test_core_dumping",
          "args": [
            "stat_fname"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "_test_core_dumping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "205-279",
          "snippet": "static bool _test_core_dumping(char* stat_fname)\n{\n\tint pid, ppid, pgrp, session, tty, tpgid;\n\tchar cmd[16], state[1];\n\tlong unsigned flags, min_flt, cmin_flt, maj_flt, cmaj_flt;\n\tlong unsigned utime, stime;\n\tlong cutime, cstime, priority, nice, timeout, it_real_value;\n\tlong resident_set_size;\n\tlong unsigned start_time, vsize;\n\tlong unsigned resident_set_size_rlim, start_code, end_code;\n\tlong unsigned start_stack, kstk_esp, kstk_eip;\n\tlong unsigned w_chan, n_swap, sn_swap;\n\tint  l_proc;\n\tint num;\n\tchar *str_ptr, *proc_stat;\n\tint proc_fd, proc_stat_size = BUF_SIZE;\n\tbool dumping_results = false;\n\n\tproc_stat = (char *) xmalloc(proc_stat_size);\n\tproc_fd = open(stat_fname, O_RDONLY, 0);\n\tif (proc_fd == -1)\n\t\treturn false;  /* process is now gone */\n\twhile ((num = read(proc_fd, proc_stat, proc_stat_size)) > 0) {\n\t\tif (num < (proc_stat_size-1))\n\t\t\tbreak;\n\t\tproc_stat_size += BUF_SIZE;\n\t\txrealloc(proc_stat, proc_stat_size);\n\t\tif (lseek(proc_fd, (off_t) 0, SEEK_SET) != 0)\n\t\t\tbreak;\n\t}\n\tclose(proc_fd);\n\n\t/* split into \"PID (cmd\" and \"<rest>\" */\n\tstr_ptr = (char *)strrchr(proc_stat, ')');\n\tif (str_ptr == NULL) {\n\t\terror(\"\\\n%s: unexpected format of %s (%s) bracket missing?\", __func__,\n\t\t      stat_fname, proc_stat);\n\t\txfree(proc_stat);\n\t\treturn false;\n\t}\n\t*str_ptr = '\\0';\t\t/* replace trailing ')' with NULL */\n\t/* parse these two strings separately, skipping the leading \"(\". */\n\tmemset (cmd, 0, sizeof(cmd));\n\tsscanf (proc_stat, \"%d (%15c\", &pid, cmd);   /* comm[16] in kernel */\n\tnum = sscanf(str_ptr + 2,\t\t/* skip space after ')' too */\n\t\t\"%c \"\n\t\t\"%d %d %d %d %d \"\n\t\t\"%lu %lu %lu %lu %lu %lu %lu \"\n\t\t\"%ld %ld %ld %ld %ld %ld \"\n\t\t\"%lu %lu \"\n\t\t\"%ld \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%*s %*s %*s %*s \" /* discard, no RT signals & Linux 2.1 used hex */\n\t\t\"%lu %lu %lu %*d %d\",\n\t\tstate,\n\t\t&ppid, &pgrp, &session, &tty, &tpgid,\n\t\t&flags, &min_flt, &cmin_flt, &maj_flt, &cmaj_flt, &utime, &stime,\n\t\t&cutime, &cstime, &priority, &nice, &timeout, &it_real_value,\n\t\t&start_time, &vsize,\n\t\t&resident_set_size,\n\t\t&resident_set_size_rlim, &start_code, &end_code,\n\t\t&start_stack, &kstk_esp, &kstk_eip,\n/*\t\t&signal, &blocked, &sig_ignore, &sig_catch, */ /* can't use */\n\t\t&w_chan, &n_swap, &sn_swap /* , &Exit_signal  */, &l_proc);\n\n\tif (num < 13)\n\t\terror(\"/proc entry too short (%s)\", proc_stat);\n\telse if (flags & PF_DUMPCORE)\n\t\tdumping_results = true;\n\txfree(proc_stat);\n\n\treturn dumping_results;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [
            "#define PF_DUMPCORE     0x00000200      /* dumped core */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\n#define PF_DUMPCORE     0x00000200      /* dumped core */\n\nstatic bool _test_core_dumping(char* stat_fname)\n{\n\tint pid, ppid, pgrp, session, tty, tpgid;\n\tchar cmd[16], state[1];\n\tlong unsigned flags, min_flt, cmin_flt, maj_flt, cmaj_flt;\n\tlong unsigned utime, stime;\n\tlong cutime, cstime, priority, nice, timeout, it_real_value;\n\tlong resident_set_size;\n\tlong unsigned start_time, vsize;\n\tlong unsigned resident_set_size_rlim, start_code, end_code;\n\tlong unsigned start_stack, kstk_esp, kstk_eip;\n\tlong unsigned w_chan, n_swap, sn_swap;\n\tint  l_proc;\n\tint num;\n\tchar *str_ptr, *proc_stat;\n\tint proc_fd, proc_stat_size = BUF_SIZE;\n\tbool dumping_results = false;\n\n\tproc_stat = (char *) xmalloc(proc_stat_size);\n\tproc_fd = open(stat_fname, O_RDONLY, 0);\n\tif (proc_fd == -1)\n\t\treturn false;  /* process is now gone */\n\twhile ((num = read(proc_fd, proc_stat, proc_stat_size)) > 0) {\n\t\tif (num < (proc_stat_size-1))\n\t\t\tbreak;\n\t\tproc_stat_size += BUF_SIZE;\n\t\txrealloc(proc_stat, proc_stat_size);\n\t\tif (lseek(proc_fd, (off_t) 0, SEEK_SET) != 0)\n\t\t\tbreak;\n\t}\n\tclose(proc_fd);\n\n\t/* split into \"PID (cmd\" and \"<rest>\" */\n\tstr_ptr = (char *)strrchr(proc_stat, ')');\n\tif (str_ptr == NULL) {\n\t\terror(\"\\\n%s: unexpected format of %s (%s) bracket missing?\", __func__,\n\t\t      stat_fname, proc_stat);\n\t\txfree(proc_stat);\n\t\treturn false;\n\t}\n\t*str_ptr = '\\0';\t\t/* replace trailing ')' with NULL */\n\t/* parse these two strings separately, skipping the leading \"(\". */\n\tmemset (cmd, 0, sizeof(cmd));\n\tsscanf (proc_stat, \"%d (%15c\", &pid, cmd);   /* comm[16] in kernel */\n\tnum = sscanf(str_ptr + 2,\t\t/* skip space after ')' too */\n\t\t\"%c \"\n\t\t\"%d %d %d %d %d \"\n\t\t\"%lu %lu %lu %lu %lu %lu %lu \"\n\t\t\"%ld %ld %ld %ld %ld %ld \"\n\t\t\"%lu %lu \"\n\t\t\"%ld \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%*s %*s %*s %*s \" /* discard, no RT signals & Linux 2.1 used hex */\n\t\t\"%lu %lu %lu %*d %d\",\n\t\tstate,\n\t\t&ppid, &pgrp, &session, &tty, &tpgid,\n\t\t&flags, &min_flt, &cmin_flt, &maj_flt, &cmaj_flt, &utime, &stime,\n\t\t&cutime, &cstime, &priority, &nice, &timeout, &it_real_value,\n\t\t&start_time, &vsize,\n\t\t&resident_set_size,\n\t\t&resident_set_size_rlim, &start_code, &end_code,\n\t\t&start_stack, &kstk_esp, &kstk_eip,\n/*\t\t&signal, &blocked, &sig_ignore, &sig_catch, */ /* can't use */\n\t\t&w_chan, &n_swap, &sn_swap /* , &Exit_signal  */, &l_proc);\n\n\tif (num < 13)\n\t\terror(\"/proc entry too short (%s)\", proc_stat);\n\telse if (flags & PF_DUMPCORE)\n\t\tdumping_results = true;\n\txfree(proc_stat);\n\n\treturn dumping_results;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "stat_fname",
            "\"/proc/%d/stat\"",
            "(int) pids[i]"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sleep",
          "args": [
            "2"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "_random_sleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/mgr.c",
          "lines": "664-678",
          "snippet": "static void\n_random_sleep(stepd_step_rec_t *job)\n{\n#if !defined HAVE_FRONT_END\n\tlong int delay = 0;\n\tlong int max   = (slurm_get_tcp_timeout() * job->nnodes);\n\n\tmax = MIN(max, 5000);\n\tsrand48((long int) (job->jobid + job->nodeid));\n\n\tdelay = lrand48() % ( max + 1 );\n\tdebug3(\"delaying %ldms\", delay);\n\tpoll(NULL, 0, delay);\n#endif\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/ulimits.h\"",
            "#include \"src/slurmd/slurmstepd/pam_ses.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmstepd/task.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/reverse_tree.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/slurm_mpi.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/safeopen.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#    include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <pthread.h>",
            "#include <poll.h>",
            "#include <grp.h>",
            "#  include \"src/common/unsetenv.h\"",
            "#  include <sys/checkpnt.h>",
            "#  include <sys/prctl.h>",
            "#  include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void  _set_prio_process (stepd_step_rec_t *job);",
            "static void _set_job_log_prefix(stepd_step_rec_t *job);",
            "static int  _setup_normal_io(stepd_step_rec_t *job);",
            "static int  _slurmd_job_log_init(stepd_step_rec_t *job);",
            "static void _wait_for_io(stepd_step_rec_t *job);",
            "static void _wait_for_children_slurmstepd(stepd_step_rec_t *job);",
            "static int  _send_pending_exit_msgs(stepd_step_rec_t *job);",
            "static void _send_step_complete_msgs(stepd_step_rec_t *job);",
            "static void _wait_for_all_tasks(stepd_step_rec_t *job);",
            "static void _setargs(stepd_step_rec_t *job);",
            "static void _random_sleep(stepd_step_rec_t *job);",
            "static char * _make_batch_dir(stepd_step_rec_t *job);",
            "static int _initgroups(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/ulimits.h\"\n#include \"src/slurmd/slurmstepd/pam_ses.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmstepd/task.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/reverse_tree.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/slurm_mpi.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/safeopen.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/cbuf.h\"\n#include \"slurm/slurm_errno.h\"\n#    include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <string.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <pthread.h>\n#include <poll.h>\n#include <grp.h>\n#  include \"src/common/unsetenv.h\"\n#  include <sys/checkpnt.h>\n#  include <sys/prctl.h>\n#  include <sys/types.h>\n#  include \"config.h\"\n\nstatic void  _set_prio_process (stepd_step_rec_t *job);\nstatic void _set_job_log_prefix(stepd_step_rec_t *job);\nstatic int  _setup_normal_io(stepd_step_rec_t *job);\nstatic int  _slurmd_job_log_init(stepd_step_rec_t *job);\nstatic void _wait_for_io(stepd_step_rec_t *job);\nstatic void _wait_for_children_slurmstepd(stepd_step_rec_t *job);\nstatic int  _send_pending_exit_msgs(stepd_step_rec_t *job);\nstatic void _send_step_complete_msgs(stepd_step_rec_t *job);\nstatic void _wait_for_all_tasks(stepd_step_rec_t *job);\nstatic void _setargs(stepd_step_rec_t *job);\nstatic void _random_sleep(stepd_step_rec_t *job);\nstatic char * _make_batch_dir(stepd_step_rec_t *job);\nstatic int _initgroups(stepd_step_rec_t *job);\n\nstatic void\n_random_sleep(stepd_step_rec_t *job)\n{\n#if !defined HAVE_FRONT_END\n\tlong int delay = 0;\n\tlong int max   = (slurm_get_tcp_timeout() * job->nnodes);\n\n\tmax = MIN(max, 5000);\n\tsrand48((long int) (job->jobid + job->nodeid));\n\n\tdelay = lrand48() % ( max + 1 );\n\tdebug3(\"delaying %ldms\", delay);\n\tpoll(NULL, 0, delay);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "proctrack_g_get_pids",
          "args": [
            "cont_id",
            "&pids",
            "&npids"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "proctrack_g_get_pids",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "468-475",
          "snippet": "extern int\nproctrack_g_get_pids(uint64_t cont_id, pid_t ** pids, int *npids)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.get_pids)) (cont_id, pids, npids);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static slurm_proctrack_ops_t ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic slurm_proctrack_ops_t ops;\n\nextern int\nproctrack_g_get_pids(uint64_t cont_id, pid_t ** pids, int *npids)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.get_pids)) (cont_id, pids, npids);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_proctrack_init",
          "args": [],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "slurm_proctrack_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "108-137",
          "snippet": "extern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};",
            "static slurm_proctrack_ops_t ops;",
            "static plugin_context_t *g_context = NULL;",
            "static pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};\nstatic slurm_proctrack_ops_t ops;\nstatic plugin_context_t *g_context = NULL;\nstatic pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic slurm_proctrack_ops_t ops;\n\nextern int proctrack_g_signal(uint64_t cont_id, int signal)\n{\n\n\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\tif (signal == SIGKILL) {\n\t\tpid_t *pids = NULL;\n\t\tint i, j, npids = 0, hung_pids = 0;\n\t\tchar *stat_fname = NULL;\n\t\tif (proctrack_g_get_pids(cont_id, &pids, &npids) ==\n\t\t    SLURM_SUCCESS) {\n\t\t\t/* NOTE: proctrack_g_get_pids() is not supported\n\t\t\t * by the proctrack/pgid plugin */\n\t\t\tfor (j = 0; j < 2; j++) {\n\t\t\t\tif (j)\n\t\t\t\t\tsleep(2);\n\t\t\t\thung_pids = 0;\n\t\t\t\tfor (i = 0; i < npids; i++) {\n\t\t\t\t\tif (!pids[i])\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\txstrfmtcat(stat_fname, \"/proc/%d/stat\",\n\t\t\t\t\t\t   (int) pids[i]);\n\t\t\t\t\tif (_test_core_dumping(stat_fname)) {\n\t\t\t\t\t\tdebug(\"Process %d continuing \"\n\t\t\t\t\t\t      \"core dump\",\n\t\t\t\t\t\t      (int) pids[i]);\n\t\t\t\t\t\thung_pids++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t/* Don't test this PID again */\n\t\t\t\t\t\tpids[i] = 0;\n\t\t\t\t\t}\n\t\t\t\t\txfree(stat_fname);\n\t\t\t\t}\n\t\t\t\tif (hung_pids == 0)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\txfree(pids);\n\t\t\tif (hung_pids) {\n\t\t\t\tinfo(\"Defering sending signal, processes in \"\n\t\t\t\t     \"job are currently core dumping\");\n\t\t\t\t_spawn_signal_thread(cont_id, signal);\n\t\t\t\treturn SLURM_SUCCESS;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn (*(ops.signal)) (cont_id, signal);\n}"
  },
  {
    "function_name": "_spawn_signal_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
    "lines": "323-338",
    "snippet": "static void _spawn_signal_thread(uint64_t cont_id, int signal)\n{\n\tagent_arg_t *agent_arg_ptr;\n\tpthread_attr_t attr_agent;\n\tpthread_t thread_agent;\n\n\tslurm_attr_init(&attr_agent);\n\tif (pthread_attr_setdetachstate(&attr_agent, PTHREAD_CREATE_DETACHED))\n\t\terror(\"pthread_attr_setdetachstate error %m\");\n\tagent_arg_ptr = xmalloc(sizeof(agent_arg_t));\n\tagent_arg_ptr->cont_id = cont_id;\n\tagent_arg_ptr->signal  = signal;\n\t(void) pthread_create(&thread_agent, &attr_agent,\n\t\t\t     _sig_agent, (void *) agent_arg_ptr);\n\tslurm_attr_destroy(&attr_agent);\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/plugrack.h\"",
      "#include \"src/common/log.h\"",
      "#  include <linux/sched.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "slurm_attr_destroy",
          "args": [
            "&attr_agent"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_create",
          "args": [
            "&thread_agent",
            "&attr_agent",
            "_sig_agent",
            "(void *) agent_arg_ptr"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "sizeof(agent_arg_t)"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"pthread_attr_setdetachstate error %m\""
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_attr_setdetachstate",
          "args": [
            "&attr_agent",
            "PTHREAD_CREATE_DETACHED"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_attr_init",
          "args": [
            "&attr_agent"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic void _spawn_signal_thread(uint64_t cont_id, int signal)\n{\n\tagent_arg_t *agent_arg_ptr;\n\tpthread_attr_t attr_agent;\n\tpthread_t thread_agent;\n\n\tslurm_attr_init(&attr_agent);\n\tif (pthread_attr_setdetachstate(&attr_agent, PTHREAD_CREATE_DETACHED))\n\t\terror(\"pthread_attr_setdetachstate error %m\");\n\tagent_arg_ptr = xmalloc(sizeof(agent_arg_t));\n\tagent_arg_ptr->cont_id = cont_id;\n\tagent_arg_ptr->signal  = signal;\n\t(void) pthread_create(&thread_agent, &attr_agent,\n\t\t\t     _sig_agent, (void *) agent_arg_ptr);\n\tslurm_attr_destroy(&attr_agent);\n}"
  },
  {
    "function_name": "_sig_agent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
    "lines": "286-321",
    "snippet": "static void *_sig_agent(void *args)\n{\n\tagent_arg_t *agent_arg_ptr = args;\n\n\twhile (1) {\n\t\tpid_t *pids = NULL;\n\t\tint i, npids = 0, hung_pids = 0;\n\t\tchar *stat_fname = NULL;\n\n\t\tif (proctrack_g_get_pids(agent_arg_ptr->cont_id, &pids,\n\t\t\t\t\t     &npids) == SLURM_SUCCESS) {\n\t\t\thung_pids = 0;\n\t\t\tfor (i = 0; i < npids; i++) {\n\t\t\t\txstrfmtcat(stat_fname, \"/proc/%d/stat\",\n\t\t\t\t\t   (int) pids[i]);\n\t\t\t\tif (_test_core_dumping(stat_fname)) {\n\t\t\t\t\tdebug(\"Process %d continuing \"\n\t\t\t\t\t      \"core dump\",\n\t\t\t\t\t      (int) pids[i]);\n\t\t\t\t\thung_pids++;\n\t\t\t\t} else {\n\t\t\t\t\t/* Kill processes that we can now */\n\t\t\t\t\tkill(pids[i], agent_arg_ptr->signal);\n\t\t\t\t}\n\t\t\t\txfree(stat_fname);\n\t\t\t}\n\t\t}\n\t\tif (hung_pids == 0)\n\t\t\tbreak;\n\t\tsleep(5);\n\t}\n\n\t(void) (*(ops.signal)) (agent_arg_ptr->cont_id, agent_arg_ptr->signal);\n\txfree(args);\n\treturn NULL;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/plugrack.h\"",
      "#include \"src/common/log.h\"",
      "#  include <linux/sched.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static slurm_proctrack_ops_t ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "args"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "agent_arg_ptr->cont_id",
            "agent_arg_ptr->signal"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sleep",
          "args": [
            "5"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "_random_sleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/mgr.c",
          "lines": "664-678",
          "snippet": "static void\n_random_sleep(stepd_step_rec_t *job)\n{\n#if !defined HAVE_FRONT_END\n\tlong int delay = 0;\n\tlong int max   = (slurm_get_tcp_timeout() * job->nnodes);\n\n\tmax = MIN(max, 5000);\n\tsrand48((long int) (job->jobid + job->nodeid));\n\n\tdelay = lrand48() % ( max + 1 );\n\tdebug3(\"delaying %ldms\", delay);\n\tpoll(NULL, 0, delay);\n#endif\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/ulimits.h\"",
            "#include \"src/slurmd/slurmstepd/pam_ses.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmstepd/task.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/reverse_tree.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/slurm_mpi.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/safeopen.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#    include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <pthread.h>",
            "#include <poll.h>",
            "#include <grp.h>",
            "#  include \"src/common/unsetenv.h\"",
            "#  include <sys/checkpnt.h>",
            "#  include <sys/prctl.h>",
            "#  include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void  _set_prio_process (stepd_step_rec_t *job);",
            "static void _set_job_log_prefix(stepd_step_rec_t *job);",
            "static int  _setup_normal_io(stepd_step_rec_t *job);",
            "static int  _slurmd_job_log_init(stepd_step_rec_t *job);",
            "static void _wait_for_io(stepd_step_rec_t *job);",
            "static void _wait_for_children_slurmstepd(stepd_step_rec_t *job);",
            "static int  _send_pending_exit_msgs(stepd_step_rec_t *job);",
            "static void _send_step_complete_msgs(stepd_step_rec_t *job);",
            "static void _wait_for_all_tasks(stepd_step_rec_t *job);",
            "static void _setargs(stepd_step_rec_t *job);",
            "static void _random_sleep(stepd_step_rec_t *job);",
            "static char * _make_batch_dir(stepd_step_rec_t *job);",
            "static int _initgroups(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/ulimits.h\"\n#include \"src/slurmd/slurmstepd/pam_ses.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmstepd/task.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/reverse_tree.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/slurm_mpi.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/safeopen.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/cbuf.h\"\n#include \"slurm/slurm_errno.h\"\n#    include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <string.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <pthread.h>\n#include <poll.h>\n#include <grp.h>\n#  include \"src/common/unsetenv.h\"\n#  include <sys/checkpnt.h>\n#  include <sys/prctl.h>\n#  include <sys/types.h>\n#  include \"config.h\"\n\nstatic void  _set_prio_process (stepd_step_rec_t *job);\nstatic void _set_job_log_prefix(stepd_step_rec_t *job);\nstatic int  _setup_normal_io(stepd_step_rec_t *job);\nstatic int  _slurmd_job_log_init(stepd_step_rec_t *job);\nstatic void _wait_for_io(stepd_step_rec_t *job);\nstatic void _wait_for_children_slurmstepd(stepd_step_rec_t *job);\nstatic int  _send_pending_exit_msgs(stepd_step_rec_t *job);\nstatic void _send_step_complete_msgs(stepd_step_rec_t *job);\nstatic void _wait_for_all_tasks(stepd_step_rec_t *job);\nstatic void _setargs(stepd_step_rec_t *job);\nstatic void _random_sleep(stepd_step_rec_t *job);\nstatic char * _make_batch_dir(stepd_step_rec_t *job);\nstatic int _initgroups(stepd_step_rec_t *job);\n\nstatic void\n_random_sleep(stepd_step_rec_t *job)\n{\n#if !defined HAVE_FRONT_END\n\tlong int delay = 0;\n\tlong int max   = (slurm_get_tcp_timeout() * job->nnodes);\n\n\tmax = MIN(max, 5000);\n\tsrand48((long int) (job->jobid + job->nodeid));\n\n\tdelay = lrand48() % ( max + 1 );\n\tdebug3(\"delaying %ldms\", delay);\n\tpoll(NULL, 0, delay);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "kill",
          "args": [
            "pids[i]",
            "agent_arg_ptr->signal"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "_delay_kill_thread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/mgr.c",
          "lines": "2124-2144",
          "snippet": "static void _delay_kill_thread(pthread_t thread_id, int secs)\n{\n\tpthread_t kill_id;\n\tpthread_attr_t attr;\n\tkill_thread_t *kt = xmalloc(sizeof(kill_thread_t));\n\tint retries = 0;\n\n\tkt->thread_id = thread_id;\n\tkt->secs = secs;\n\tslurm_attr_init(&attr);\n\tpthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);\n\twhile (pthread_create(&kill_id, &attr, &_kill_thr, (void *) kt)) {\n\t\terror(\"_delay_kill_thread: pthread_create: %m\");\n\t\tif (++retries > MAX_RETRIES) {\n\t\t\terror(\"_delay_kill_thread: Can't create pthread\");\n\t\t\tbreak;\n\t\t}\n\t\tusleep(10);\t/* sleep and again */\n\t}\n\tslurm_attr_destroy(&attr);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/ulimits.h\"",
            "#include \"src/slurmd/slurmstepd/pam_ses.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmstepd/task.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/reverse_tree.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/slurm_mpi.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/safeopen.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#    include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <pthread.h>",
            "#include <poll.h>",
            "#include <grp.h>",
            "#  include \"src/common/unsetenv.h\"",
            "#  include <sys/checkpnt.h>",
            "#  include <sys/prctl.h>",
            "#  include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/ulimits.h\"\n#include \"src/slurmd/slurmstepd/pam_ses.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmstepd/task.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/reverse_tree.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/slurm_mpi.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/safeopen.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/cbuf.h\"\n#include \"slurm/slurm_errno.h\"\n#    include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <string.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <pthread.h>\n#include <poll.h>\n#include <grp.h>\n#  include \"src/common/unsetenv.h\"\n#  include <sys/checkpnt.h>\n#  include <sys/prctl.h>\n#  include <sys/types.h>\n#  include \"config.h\"\n\nstatic void _delay_kill_thread(pthread_t thread_id, int secs)\n{\n\tpthread_t kill_id;\n\tpthread_attr_t attr;\n\tkill_thread_t *kt = xmalloc(sizeof(kill_thread_t));\n\tint retries = 0;\n\n\tkt->thread_id = thread_id;\n\tkt->secs = secs;\n\tslurm_attr_init(&attr);\n\tpthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);\n\twhile (pthread_create(&kill_id, &attr, &_kill_thr, (void *) kt)) {\n\t\terror(\"_delay_kill_thread: pthread_create: %m\");\n\t\tif (++retries > MAX_RETRIES) {\n\t\t\terror(\"_delay_kill_thread: Can't create pthread\");\n\t\t\tbreak;\n\t\t}\n\t\tusleep(10);\t/* sleep and again */\n\t}\n\tslurm_attr_destroy(&attr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"Process %d continuing \"\n\t\t\t\t\t      \"core dump\"",
            "(int) pids[i]"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "pdebug_wake_process",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/pdebug.c",
          "lines": "187-199",
          "snippet": "void pdebug_wake_process(stepd_step_rec_t *job, pid_t pid)\n{\n\tif ((job->task_flags & TASK_PARALLEL_DEBUG) && (pid > (pid_t) 0)) {\n\t\tif (_pid_to_wake(pid)) {\n\t\t\tif (kill(pid, SIGCONT) < 0)\n\t\t\t\terror(\"kill(%lu): %m\", (unsigned long) pid);\n\t\t\telse\n\t\t\t\tdebug(\"woke pid %lu\", (unsigned long) pid);\n\t\t} else {\n\t\t\tdebug(\"pid %lu not stopped\", (unsigned long) pid);\n\t\t}\n\t}\n}",
          "includes": [
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"pdebug.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"pdebug.h\"\n\nvoid pdebug_wake_process(stepd_step_rec_t *job, pid_t pid)\n{\n\tif ((job->task_flags & TASK_PARALLEL_DEBUG) && (pid > (pid_t) 0)) {\n\t\tif (_pid_to_wake(pid)) {\n\t\t\tif (kill(pid, SIGCONT) < 0)\n\t\t\t\terror(\"kill(%lu): %m\", (unsigned long) pid);\n\t\t\telse\n\t\t\t\tdebug(\"woke pid %lu\", (unsigned long) pid);\n\t\t} else {\n\t\t\tdebug(\"pid %lu not stopped\", (unsigned long) pid);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "_test_core_dumping",
          "args": [
            "stat_fname"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "_test_core_dumping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "205-279",
          "snippet": "static bool _test_core_dumping(char* stat_fname)\n{\n\tint pid, ppid, pgrp, session, tty, tpgid;\n\tchar cmd[16], state[1];\n\tlong unsigned flags, min_flt, cmin_flt, maj_flt, cmaj_flt;\n\tlong unsigned utime, stime;\n\tlong cutime, cstime, priority, nice, timeout, it_real_value;\n\tlong resident_set_size;\n\tlong unsigned start_time, vsize;\n\tlong unsigned resident_set_size_rlim, start_code, end_code;\n\tlong unsigned start_stack, kstk_esp, kstk_eip;\n\tlong unsigned w_chan, n_swap, sn_swap;\n\tint  l_proc;\n\tint num;\n\tchar *str_ptr, *proc_stat;\n\tint proc_fd, proc_stat_size = BUF_SIZE;\n\tbool dumping_results = false;\n\n\tproc_stat = (char *) xmalloc(proc_stat_size);\n\tproc_fd = open(stat_fname, O_RDONLY, 0);\n\tif (proc_fd == -1)\n\t\treturn false;  /* process is now gone */\n\twhile ((num = read(proc_fd, proc_stat, proc_stat_size)) > 0) {\n\t\tif (num < (proc_stat_size-1))\n\t\t\tbreak;\n\t\tproc_stat_size += BUF_SIZE;\n\t\txrealloc(proc_stat, proc_stat_size);\n\t\tif (lseek(proc_fd, (off_t) 0, SEEK_SET) != 0)\n\t\t\tbreak;\n\t}\n\tclose(proc_fd);\n\n\t/* split into \"PID (cmd\" and \"<rest>\" */\n\tstr_ptr = (char *)strrchr(proc_stat, ')');\n\tif (str_ptr == NULL) {\n\t\terror(\"\\\n%s: unexpected format of %s (%s) bracket missing?\", __func__,\n\t\t      stat_fname, proc_stat);\n\t\txfree(proc_stat);\n\t\treturn false;\n\t}\n\t*str_ptr = '\\0';\t\t/* replace trailing ')' with NULL */\n\t/* parse these two strings separately, skipping the leading \"(\". */\n\tmemset (cmd, 0, sizeof(cmd));\n\tsscanf (proc_stat, \"%d (%15c\", &pid, cmd);   /* comm[16] in kernel */\n\tnum = sscanf(str_ptr + 2,\t\t/* skip space after ')' too */\n\t\t\"%c \"\n\t\t\"%d %d %d %d %d \"\n\t\t\"%lu %lu %lu %lu %lu %lu %lu \"\n\t\t\"%ld %ld %ld %ld %ld %ld \"\n\t\t\"%lu %lu \"\n\t\t\"%ld \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%*s %*s %*s %*s \" /* discard, no RT signals & Linux 2.1 used hex */\n\t\t\"%lu %lu %lu %*d %d\",\n\t\tstate,\n\t\t&ppid, &pgrp, &session, &tty, &tpgid,\n\t\t&flags, &min_flt, &cmin_flt, &maj_flt, &cmaj_flt, &utime, &stime,\n\t\t&cutime, &cstime, &priority, &nice, &timeout, &it_real_value,\n\t\t&start_time, &vsize,\n\t\t&resident_set_size,\n\t\t&resident_set_size_rlim, &start_code, &end_code,\n\t\t&start_stack, &kstk_esp, &kstk_eip,\n/*\t\t&signal, &blocked, &sig_ignore, &sig_catch, */ /* can't use */\n\t\t&w_chan, &n_swap, &sn_swap /* , &Exit_signal  */, &l_proc);\n\n\tif (num < 13)\n\t\terror(\"/proc entry too short (%s)\", proc_stat);\n\telse if (flags & PF_DUMPCORE)\n\t\tdumping_results = true;\n\txfree(proc_stat);\n\n\treturn dumping_results;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [
            "#define PF_DUMPCORE     0x00000200      /* dumped core */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\n#define PF_DUMPCORE     0x00000200      /* dumped core */\n\nstatic bool _test_core_dumping(char* stat_fname)\n{\n\tint pid, ppid, pgrp, session, tty, tpgid;\n\tchar cmd[16], state[1];\n\tlong unsigned flags, min_flt, cmin_flt, maj_flt, cmaj_flt;\n\tlong unsigned utime, stime;\n\tlong cutime, cstime, priority, nice, timeout, it_real_value;\n\tlong resident_set_size;\n\tlong unsigned start_time, vsize;\n\tlong unsigned resident_set_size_rlim, start_code, end_code;\n\tlong unsigned start_stack, kstk_esp, kstk_eip;\n\tlong unsigned w_chan, n_swap, sn_swap;\n\tint  l_proc;\n\tint num;\n\tchar *str_ptr, *proc_stat;\n\tint proc_fd, proc_stat_size = BUF_SIZE;\n\tbool dumping_results = false;\n\n\tproc_stat = (char *) xmalloc(proc_stat_size);\n\tproc_fd = open(stat_fname, O_RDONLY, 0);\n\tif (proc_fd == -1)\n\t\treturn false;  /* process is now gone */\n\twhile ((num = read(proc_fd, proc_stat, proc_stat_size)) > 0) {\n\t\tif (num < (proc_stat_size-1))\n\t\t\tbreak;\n\t\tproc_stat_size += BUF_SIZE;\n\t\txrealloc(proc_stat, proc_stat_size);\n\t\tif (lseek(proc_fd, (off_t) 0, SEEK_SET) != 0)\n\t\t\tbreak;\n\t}\n\tclose(proc_fd);\n\n\t/* split into \"PID (cmd\" and \"<rest>\" */\n\tstr_ptr = (char *)strrchr(proc_stat, ')');\n\tif (str_ptr == NULL) {\n\t\terror(\"\\\n%s: unexpected format of %s (%s) bracket missing?\", __func__,\n\t\t      stat_fname, proc_stat);\n\t\txfree(proc_stat);\n\t\treturn false;\n\t}\n\t*str_ptr = '\\0';\t\t/* replace trailing ')' with NULL */\n\t/* parse these two strings separately, skipping the leading \"(\". */\n\tmemset (cmd, 0, sizeof(cmd));\n\tsscanf (proc_stat, \"%d (%15c\", &pid, cmd);   /* comm[16] in kernel */\n\tnum = sscanf(str_ptr + 2,\t\t/* skip space after ')' too */\n\t\t\"%c \"\n\t\t\"%d %d %d %d %d \"\n\t\t\"%lu %lu %lu %lu %lu %lu %lu \"\n\t\t\"%ld %ld %ld %ld %ld %ld \"\n\t\t\"%lu %lu \"\n\t\t\"%ld \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%*s %*s %*s %*s \" /* discard, no RT signals & Linux 2.1 used hex */\n\t\t\"%lu %lu %lu %*d %d\",\n\t\tstate,\n\t\t&ppid, &pgrp, &session, &tty, &tpgid,\n\t\t&flags, &min_flt, &cmin_flt, &maj_flt, &cmaj_flt, &utime, &stime,\n\t\t&cutime, &cstime, &priority, &nice, &timeout, &it_real_value,\n\t\t&start_time, &vsize,\n\t\t&resident_set_size,\n\t\t&resident_set_size_rlim, &start_code, &end_code,\n\t\t&start_stack, &kstk_esp, &kstk_eip,\n/*\t\t&signal, &blocked, &sig_ignore, &sig_catch, */ /* can't use */\n\t\t&w_chan, &n_swap, &sn_swap /* , &Exit_signal  */, &l_proc);\n\n\tif (num < 13)\n\t\terror(\"/proc entry too short (%s)\", proc_stat);\n\telse if (flags & PF_DUMPCORE)\n\t\tdumping_results = true;\n\txfree(proc_stat);\n\n\treturn dumping_results;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "stat_fname",
            "\"/proc/%d/stat\"",
            "(int) pids[i]"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proctrack_g_get_pids",
          "args": [
            "agent_arg_ptr->cont_id",
            "&pids",
            "&npids"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "proctrack_g_get_pids",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "468-475",
          "snippet": "extern int\nproctrack_g_get_pids(uint64_t cont_id, pid_t ** pids, int *npids)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.get_pids)) (cont_id, pids, npids);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static slurm_proctrack_ops_t ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic slurm_proctrack_ops_t ops;\n\nextern int\nproctrack_g_get_pids(uint64_t cont_id, pid_t ** pids, int *npids)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn (*(ops.get_pids)) (cont_id, pids, npids);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic slurm_proctrack_ops_t ops;\n\nstatic void *_sig_agent(void *args)\n{\n\tagent_arg_t *agent_arg_ptr = args;\n\n\twhile (1) {\n\t\tpid_t *pids = NULL;\n\t\tint i, npids = 0, hung_pids = 0;\n\t\tchar *stat_fname = NULL;\n\n\t\tif (proctrack_g_get_pids(agent_arg_ptr->cont_id, &pids,\n\t\t\t\t\t     &npids) == SLURM_SUCCESS) {\n\t\t\thung_pids = 0;\n\t\t\tfor (i = 0; i < npids; i++) {\n\t\t\t\txstrfmtcat(stat_fname, \"/proc/%d/stat\",\n\t\t\t\t\t   (int) pids[i]);\n\t\t\t\tif (_test_core_dumping(stat_fname)) {\n\t\t\t\t\tdebug(\"Process %d continuing \"\n\t\t\t\t\t      \"core dump\",\n\t\t\t\t\t      (int) pids[i]);\n\t\t\t\t\thung_pids++;\n\t\t\t\t} else {\n\t\t\t\t\t/* Kill processes that we can now */\n\t\t\t\t\tkill(pids[i], agent_arg_ptr->signal);\n\t\t\t\t}\n\t\t\t\txfree(stat_fname);\n\t\t\t}\n\t\t}\n\t\tif (hung_pids == 0)\n\t\t\tbreak;\n\t\tsleep(5);\n\t}\n\n\t(void) (*(ops.signal)) (agent_arg_ptr->cont_id, agent_arg_ptr->signal);\n\txfree(args);\n\treturn NULL;\n}"
  },
  {
    "function_name": "_test_core_dumping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
    "lines": "205-279",
    "snippet": "static bool _test_core_dumping(char* stat_fname)\n{\n\tint pid, ppid, pgrp, session, tty, tpgid;\n\tchar cmd[16], state[1];\n\tlong unsigned flags, min_flt, cmin_flt, maj_flt, cmaj_flt;\n\tlong unsigned utime, stime;\n\tlong cutime, cstime, priority, nice, timeout, it_real_value;\n\tlong resident_set_size;\n\tlong unsigned start_time, vsize;\n\tlong unsigned resident_set_size_rlim, start_code, end_code;\n\tlong unsigned start_stack, kstk_esp, kstk_eip;\n\tlong unsigned w_chan, n_swap, sn_swap;\n\tint  l_proc;\n\tint num;\n\tchar *str_ptr, *proc_stat;\n\tint proc_fd, proc_stat_size = BUF_SIZE;\n\tbool dumping_results = false;\n\n\tproc_stat = (char *) xmalloc(proc_stat_size);\n\tproc_fd = open(stat_fname, O_RDONLY, 0);\n\tif (proc_fd == -1)\n\t\treturn false;  /* process is now gone */\n\twhile ((num = read(proc_fd, proc_stat, proc_stat_size)) > 0) {\n\t\tif (num < (proc_stat_size-1))\n\t\t\tbreak;\n\t\tproc_stat_size += BUF_SIZE;\n\t\txrealloc(proc_stat, proc_stat_size);\n\t\tif (lseek(proc_fd, (off_t) 0, SEEK_SET) != 0)\n\t\t\tbreak;\n\t}\n\tclose(proc_fd);\n\n\t/* split into \"PID (cmd\" and \"<rest>\" */\n\tstr_ptr = (char *)strrchr(proc_stat, ')');\n\tif (str_ptr == NULL) {\n\t\terror(\"\\\n%s: unexpected format of %s (%s) bracket missing?\", __func__,\n\t\t      stat_fname, proc_stat);\n\t\txfree(proc_stat);\n\t\treturn false;\n\t}\n\t*str_ptr = '\\0';\t\t/* replace trailing ')' with NULL */\n\t/* parse these two strings separately, skipping the leading \"(\". */\n\tmemset (cmd, 0, sizeof(cmd));\n\tsscanf (proc_stat, \"%d (%15c\", &pid, cmd);   /* comm[16] in kernel */\n\tnum = sscanf(str_ptr + 2,\t\t/* skip space after ')' too */\n\t\t\"%c \"\n\t\t\"%d %d %d %d %d \"\n\t\t\"%lu %lu %lu %lu %lu %lu %lu \"\n\t\t\"%ld %ld %ld %ld %ld %ld \"\n\t\t\"%lu %lu \"\n\t\t\"%ld \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%*s %*s %*s %*s \" /* discard, no RT signals & Linux 2.1 used hex */\n\t\t\"%lu %lu %lu %*d %d\",\n\t\tstate,\n\t\t&ppid, &pgrp, &session, &tty, &tpgid,\n\t\t&flags, &min_flt, &cmin_flt, &maj_flt, &cmaj_flt, &utime, &stime,\n\t\t&cutime, &cstime, &priority, &nice, &timeout, &it_real_value,\n\t\t&start_time, &vsize,\n\t\t&resident_set_size,\n\t\t&resident_set_size_rlim, &start_code, &end_code,\n\t\t&start_stack, &kstk_esp, &kstk_eip,\n/*\t\t&signal, &blocked, &sig_ignore, &sig_catch, */ /* can't use */\n\t\t&w_chan, &n_swap, &sn_swap /* , &Exit_signal  */, &l_proc);\n\n\tif (num < 13)\n\t\terror(\"/proc entry too short (%s)\", proc_stat);\n\telse if (flags & PF_DUMPCORE)\n\t\tdumping_results = true;\n\txfree(proc_stat);\n\n\treturn dumping_results;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/plugrack.h\"",
      "#include \"src/common/log.h\"",
      "#  include <linux/sched.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [
      "#define PF_DUMPCORE     0x00000200      /* dumped core */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "proc_stat"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"/proc entry too short (%s)\"",
            "proc_stat"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "_task_write_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "641-650",
          "snippet": "static int\n_task_write_error(eio_obj_t *obj, List objs)\n{\n\tdebug4(\"Called _task_write_error, closing fd %d\", obj->fd);\n\n\tclose(obj->fd);\n\tobj->fd = -1;\n\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static int  _client_read(eio_obj_t *, List);",
            "static int  _client_write(eio_obj_t *, List);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static int  _local_file_write(eio_obj_t *, List);",
            "static bool _task_writable(eio_obj_t *);",
            "static int  _task_write(eio_obj_t *, List);",
            "static int _task_write_error(eio_obj_t *obj, List objs);",
            "static bool _task_readable(eio_obj_t *);",
            "static int  _task_read(eio_obj_t *, List);",
            "static void _route_msg_task_to_client(eio_obj_t *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic int  _client_read(eio_obj_t *, List);\nstatic int  _client_write(eio_obj_t *, List);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic int  _local_file_write(eio_obj_t *, List);\nstatic bool _task_writable(eio_obj_t *);\nstatic int  _task_write(eio_obj_t *, List);\nstatic int _task_write_error(eio_obj_t *obj, List objs);\nstatic bool _task_readable(eio_obj_t *);\nstatic int  _task_read(eio_obj_t *, List);\nstatic void _route_msg_task_to_client(eio_obj_t *obj);\n\nstatic int\n_task_write_error(eio_obj_t *obj, List objs)\n{\n\tdebug4(\"Called _task_write_error, closing fd %d\", obj->fd);\n\n\tclose(obj->fd);\n\tobj->fd = -1;\n\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "str_ptr + 2",
            "/* skip space after ')' too */\"%c \"\n\t\t\"%d %d %d %d %d \"\n\t\t\"%lu %lu %lu %lu %lu %lu %lu \"\n\t\t\"%ld %ld %ld %ld %ld %ld \"\n\t\t\"%lu %lu \"\n\t\t\"%ld \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%*s %*s %*s %*s \" /* discard, no RT signals & Linux 2.1 used hex */\n\t\t\"%lu %lu %lu %*d %d\"",
            "state",
            "&ppid",
            "&pgrp",
            "&session",
            "&tty",
            "&tpgid",
            "&flags",
            "&min_flt",
            "&cmin_flt",
            "&maj_flt",
            "&cmaj_flt",
            "&utime",
            "&stime",
            "&cutime",
            "&cstime",
            "&priority",
            "&nice",
            "&timeout",
            "&it_real_value",
            "&start_time",
            "&vsize",
            "&resident_set_size",
            "&resident_set_size_rlim",
            "&start_code",
            "&end_code",
            "&start_stack",
            "&kstk_esp",
            "&kstk_eip",
            "/*\t\t&signal, &blocked, &sig_ignore, &sig_catch, *//* can't use */&w_chan",
            "&n_swap",
            "&sn_swap/* , &Exit_signal  */",
            "&l_proc"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "proc_stat",
            "\"%d (%15c\"",
            "&pid",
            "cmd"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "cmd",
            "0",
            "sizeof(cmd)"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"\\\n%s: unexpected format of %s (%s) bracket missing?\"",
            "__func__",
            "stat_fname",
            "proc_stat"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "proc_stat",
            "')'"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "proc_fd"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "io_close_local_fds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "1463-1487",
          "snippet": "void\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static bool _task_writable(eio_obj_t *);",
            "static bool _task_readable(eio_obj_t *);",
            "static int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);",
            "static void *_io_thr(void *arg);",
            "static void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);",
            "static bool _incoming_buf_free(stepd_step_rec_t *job);",
            "static bool _outgoing_buf_free(stepd_step_rec_t *job);",
            "static int  _send_connection_okay_response(stepd_step_rec_t *job);",
            "static struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic bool _task_writable(eio_obj_t *);\nstatic bool _task_readable(eio_obj_t *);\nstatic int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);\nstatic void *_io_thr(void *arg);\nstatic void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);\nstatic bool _incoming_buf_free(stepd_step_rec_t *job);\nstatic bool _outgoing_buf_free(stepd_step_rec_t *job);\nstatic int  _send_connection_okay_response(stepd_step_rec_t *job);\nstatic struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);\n\nvoid\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "proc_fd",
            "(off_t) 0",
            "SEEK_SET"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xrealloc",
          "args": [
            "proc_stat",
            "proc_stat_size"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "proc_fd",
            "proc_stat",
            "proc_stat_size"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "_file_read_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1149-1197",
          "snippet": "int _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "stat_fname",
            "O_RDONLY",
            "0"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "proc_stat_size"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\n#define PF_DUMPCORE     0x00000200      /* dumped core */\n\nstatic bool _test_core_dumping(char* stat_fname)\n{\n\tint pid, ppid, pgrp, session, tty, tpgid;\n\tchar cmd[16], state[1];\n\tlong unsigned flags, min_flt, cmin_flt, maj_flt, cmaj_flt;\n\tlong unsigned utime, stime;\n\tlong cutime, cstime, priority, nice, timeout, it_real_value;\n\tlong resident_set_size;\n\tlong unsigned start_time, vsize;\n\tlong unsigned resident_set_size_rlim, start_code, end_code;\n\tlong unsigned start_stack, kstk_esp, kstk_eip;\n\tlong unsigned w_chan, n_swap, sn_swap;\n\tint  l_proc;\n\tint num;\n\tchar *str_ptr, *proc_stat;\n\tint proc_fd, proc_stat_size = BUF_SIZE;\n\tbool dumping_results = false;\n\n\tproc_stat = (char *) xmalloc(proc_stat_size);\n\tproc_fd = open(stat_fname, O_RDONLY, 0);\n\tif (proc_fd == -1)\n\t\treturn false;  /* process is now gone */\n\twhile ((num = read(proc_fd, proc_stat, proc_stat_size)) > 0) {\n\t\tif (num < (proc_stat_size-1))\n\t\t\tbreak;\n\t\tproc_stat_size += BUF_SIZE;\n\t\txrealloc(proc_stat, proc_stat_size);\n\t\tif (lseek(proc_fd, (off_t) 0, SEEK_SET) != 0)\n\t\t\tbreak;\n\t}\n\tclose(proc_fd);\n\n\t/* split into \"PID (cmd\" and \"<rest>\" */\n\tstr_ptr = (char *)strrchr(proc_stat, ')');\n\tif (str_ptr == NULL) {\n\t\terror(\"\\\n%s: unexpected format of %s (%s) bracket missing?\", __func__,\n\t\t      stat_fname, proc_stat);\n\t\txfree(proc_stat);\n\t\treturn false;\n\t}\n\t*str_ptr = '\\0';\t\t/* replace trailing ')' with NULL */\n\t/* parse these two strings separately, skipping the leading \"(\". */\n\tmemset (cmd, 0, sizeof(cmd));\n\tsscanf (proc_stat, \"%d (%15c\", &pid, cmd);   /* comm[16] in kernel */\n\tnum = sscanf(str_ptr + 2,\t\t/* skip space after ')' too */\n\t\t\"%c \"\n\t\t\"%d %d %d %d %d \"\n\t\t\"%lu %lu %lu %lu %lu %lu %lu \"\n\t\t\"%ld %ld %ld %ld %ld %ld \"\n\t\t\"%lu %lu \"\n\t\t\"%ld \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%lu %lu %lu \"\n\t\t\"%*s %*s %*s %*s \" /* discard, no RT signals & Linux 2.1 used hex */\n\t\t\"%lu %lu %lu %*d %d\",\n\t\tstate,\n\t\t&ppid, &pgrp, &session, &tty, &tpgid,\n\t\t&flags, &min_flt, &cmin_flt, &maj_flt, &cmaj_flt, &utime, &stime,\n\t\t&cutime, &cstime, &priority, &nice, &timeout, &it_real_value,\n\t\t&start_time, &vsize,\n\t\t&resident_set_size,\n\t\t&resident_set_size_rlim, &start_code, &end_code,\n\t\t&start_stack, &kstk_esp, &kstk_eip,\n/*\t\t&signal, &blocked, &sig_ignore, &sig_catch, */ /* can't use */\n\t\t&w_chan, &n_swap, &sn_swap /* , &Exit_signal  */, &l_proc);\n\n\tif (num < 13)\n\t\terror(\"/proc entry too short (%s)\", proc_stat);\n\telse if (flags & PF_DUMPCORE)\n\t\tdumping_results = true;\n\txfree(proc_stat);\n\n\treturn dumping_results;\n}"
  },
  {
    "function_name": "proctrack_g_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
    "lines": "180-199",
    "snippet": "extern int proctrack_g_add(stepd_step_rec_t * job, pid_t pid)\n{\n\tint i = 0, max_retry = 3, rc;\n\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\t/* Sometimes a plugin is transient in adding a pid, so lets\n\t * try a few times before we call it quits.\n\t */\n\twhile ((rc = (*(ops.add)) (job, pid)) != SLURM_SUCCESS) {\n\t\tif (i++ > max_retry)\n\t\t\tbreak;\n\t\tdebug(\"%s: %u.%u couldn't add pid %u, sleeping and trying again\",\n\t\t      __func__, job->jobid, job->stepid, pid);\n\t\tsleep(1);\n\t}\n\n\treturn rc;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/plugrack.h\"",
      "#include \"src/common/log.h\"",
      "#  include <linux/sched.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static slurm_proctrack_ops_t ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sleep",
          "args": [
            "1"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "_random_sleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/mgr.c",
          "lines": "664-678",
          "snippet": "static void\n_random_sleep(stepd_step_rec_t *job)\n{\n#if !defined HAVE_FRONT_END\n\tlong int delay = 0;\n\tlong int max   = (slurm_get_tcp_timeout() * job->nnodes);\n\n\tmax = MIN(max, 5000);\n\tsrand48((long int) (job->jobid + job->nodeid));\n\n\tdelay = lrand48() % ( max + 1 );\n\tdebug3(\"delaying %ldms\", delay);\n\tpoll(NULL, 0, delay);\n#endif\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/ulimits.h\"",
            "#include \"src/slurmd/slurmstepd/pam_ses.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmstepd/task.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/reverse_tree.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/slurm_mpi.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/safeopen.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#    include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <pthread.h>",
            "#include <poll.h>",
            "#include <grp.h>",
            "#  include \"src/common/unsetenv.h\"",
            "#  include <sys/checkpnt.h>",
            "#  include <sys/prctl.h>",
            "#  include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void  _set_prio_process (stepd_step_rec_t *job);",
            "static void _set_job_log_prefix(stepd_step_rec_t *job);",
            "static int  _setup_normal_io(stepd_step_rec_t *job);",
            "static int  _slurmd_job_log_init(stepd_step_rec_t *job);",
            "static void _wait_for_io(stepd_step_rec_t *job);",
            "static void _wait_for_children_slurmstepd(stepd_step_rec_t *job);",
            "static int  _send_pending_exit_msgs(stepd_step_rec_t *job);",
            "static void _send_step_complete_msgs(stepd_step_rec_t *job);",
            "static void _wait_for_all_tasks(stepd_step_rec_t *job);",
            "static void _setargs(stepd_step_rec_t *job);",
            "static void _random_sleep(stepd_step_rec_t *job);",
            "static char * _make_batch_dir(stepd_step_rec_t *job);",
            "static int _initgroups(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/ulimits.h\"\n#include \"src/slurmd/slurmstepd/pam_ses.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmstepd/task.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/reverse_tree.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/slurm_mpi.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/safeopen.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/cbuf.h\"\n#include \"slurm/slurm_errno.h\"\n#    include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <string.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <pthread.h>\n#include <poll.h>\n#include <grp.h>\n#  include \"src/common/unsetenv.h\"\n#  include <sys/checkpnt.h>\n#  include <sys/prctl.h>\n#  include <sys/types.h>\n#  include \"config.h\"\n\nstatic void  _set_prio_process (stepd_step_rec_t *job);\nstatic void _set_job_log_prefix(stepd_step_rec_t *job);\nstatic int  _setup_normal_io(stepd_step_rec_t *job);\nstatic int  _slurmd_job_log_init(stepd_step_rec_t *job);\nstatic void _wait_for_io(stepd_step_rec_t *job);\nstatic void _wait_for_children_slurmstepd(stepd_step_rec_t *job);\nstatic int  _send_pending_exit_msgs(stepd_step_rec_t *job);\nstatic void _send_step_complete_msgs(stepd_step_rec_t *job);\nstatic void _wait_for_all_tasks(stepd_step_rec_t *job);\nstatic void _setargs(stepd_step_rec_t *job);\nstatic void _random_sleep(stepd_step_rec_t *job);\nstatic char * _make_batch_dir(stepd_step_rec_t *job);\nstatic int _initgroups(stepd_step_rec_t *job);\n\nstatic void\n_random_sleep(stepd_step_rec_t *job)\n{\n#if !defined HAVE_FRONT_END\n\tlong int delay = 0;\n\tlong int max   = (slurm_get_tcp_timeout() * job->nnodes);\n\n\tmax = MIN(max, 5000);\n\tsrand48((long int) (job->jobid + job->nodeid));\n\n\tdelay = lrand48() % ( max + 1 );\n\tdebug3(\"delaying %ldms\", delay);\n\tpoll(NULL, 0, delay);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"%s: %u.%u couldn't add pid %u, sleeping and trying again\"",
            "__func__",
            "job->jobid",
            "job->stepid",
            "pid"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "job",
            "pid"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_proctrack_init",
          "args": [],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "slurm_proctrack_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "108-137",
          "snippet": "extern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};",
            "static slurm_proctrack_ops_t ops;",
            "static plugin_context_t *g_context = NULL;",
            "static pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};\nstatic slurm_proctrack_ops_t ops;\nstatic plugin_context_t *g_context = NULL;\nstatic pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic slurm_proctrack_ops_t ops;\n\nextern int proctrack_g_add(stepd_step_rec_t * job, pid_t pid)\n{\n\tint i = 0, max_retry = 3, rc;\n\n\tif (slurm_proctrack_init() < 0)\n\t\treturn SLURM_ERROR;\n\n\t/* Sometimes a plugin is transient in adding a pid, so lets\n\t * try a few times before we call it quits.\n\t */\n\twhile ((rc = (*(ops.add)) (job, pid)) != SLURM_SUCCESS) {\n\t\tif (i++ > max_retry)\n\t\t\tbreak;\n\t\tdebug(\"%s: %u.%u couldn't add pid %u, sleeping and trying again\",\n\t\t      __func__, job->jobid, job->stepid, pid);\n\t\tsleep(1);\n\t}\n\n\treturn rc;\n}"
  },
  {
    "function_name": "proctrack_g_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
    "lines": "163-169",
    "snippet": "extern int proctrack_g_create(stepd_step_rec_t * job)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn 0;\n\n\treturn (*(ops.create)) (job);\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/plugrack.h\"",
      "#include \"src/common/log.h\"",
      "#  include <linux/sched.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static slurm_proctrack_ops_t ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "job"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_proctrack_init",
          "args": [],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "slurm_proctrack_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "108-137",
          "snippet": "extern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};",
            "static slurm_proctrack_ops_t ops;",
            "static plugin_context_t *g_context = NULL;",
            "static pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};\nstatic slurm_proctrack_ops_t ops;\nstatic plugin_context_t *g_context = NULL;\nstatic pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic slurm_proctrack_ops_t ops;\n\nextern int proctrack_g_create(stepd_step_rec_t * job)\n{\n\tif (slurm_proctrack_init() < 0)\n\t\treturn 0;\n\n\treturn (*(ops.create)) (job);\n}"
  },
  {
    "function_name": "slurm_proctrack_fini",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
    "lines": "142-153",
    "snippet": "extern int slurm_proctrack_fini(void)\n{\n\tint rc;\n\n\tif (!g_context)\n\t\treturn SLURM_SUCCESS;\n\n\tinit_run = false;\n\trc = plugin_context_destroy(g_context);\n\tg_context = NULL;\n\treturn rc;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/plugrack.h\"",
      "#include \"src/common/log.h\"",
      "#  include <linux/sched.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static plugin_context_t *g_context = NULL;",
      "static bool init_run = false;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "plugin_context_destroy",
          "args": [
            "g_context"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic plugin_context_t *g_context = NULL;\nstatic bool init_run = false;\n\nextern int slurm_proctrack_fini(void)\n{\n\tint rc;\n\n\tif (!g_context)\n\t\treturn SLURM_SUCCESS;\n\n\tinit_run = false;\n\trc = plugin_context_destroy(g_context);\n\tg_context = NULL;\n\treturn rc;\n}"
  },
  {
    "function_name": "slurm_proctrack_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
    "lines": "108-137",
    "snippet": "extern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}",
    "includes": [
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/plugrack.h\"",
      "#include \"src/common/log.h\"",
      "#  include <linux/sched.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};",
      "static slurm_proctrack_ops_t ops;",
      "static plugin_context_t *g_context = NULL;",
      "static pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;",
      "static bool init_run = false;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "type"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_mutex_unlock",
          "args": [
            "&g_context_lock"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"cannot create %s context for %s\"",
            "plugin_type",
            "type"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plugin_context_create",
          "args": [
            "plugin_type",
            "type",
            "(void **)&ops",
            "syms",
            "sizeof(syms)"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_get_proctrack_type",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_mutex_lock",
          "args": [
            "&g_context_lock"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};\nstatic slurm_proctrack_ops_t ops;\nstatic plugin_context_t *g_context = NULL;\nstatic pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}"
  }
]