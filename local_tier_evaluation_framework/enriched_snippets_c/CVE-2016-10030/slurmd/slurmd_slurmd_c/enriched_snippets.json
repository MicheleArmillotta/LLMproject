[
  {
    "function_name": "run_script_health_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2359-2370",
    "snippet": "extern int run_script_health_check(void)\n{\n\tint rc = SLURM_SUCCESS;\n\n\tif (conf->health_check_program) {\n\t\tchar *env[1] = { NULL };\n\t\trc = run_script(\"health_check\", conf->health_check_program,\n\t\t\t\t0, 60, env, 0);\n\t}\n\n\treturn rc;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "run_script",
          "args": [
            "\"health_check\"",
            "conf->health_check_program",
            "0",
            "60",
            "env",
            "0"
          ],
          "line": 2365
        },
        "resolved": true,
        "details": {
          "function_name": "run_script",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "212-240",
          "snippet": "int run_script(const char *name, const char *pattern, uint32_t job_id,\n\t       int max_wait, char **env, uid_t uid)\n{\n\tint rc = 0;\n\tList l;\n\tListIterator i;\n\tchar *s;\n\n\tif (pattern == NULL || pattern[0] == '\\0')\n\t\treturn 0;\n\n\tl = _script_list_create (pattern);\n\tif (l == NULL)\n\t\treturn error (\"Unable to run %s [%s]\", name, pattern);\n\n\ti = list_iterator_create (l);\n\twhile ((s = list_next (i))) {\n\t\trc = _run_one_script (name, s, job_id, max_wait, env, uid);\n\t\tif (rc) {\n\t\t\terror (\"%s: exited with status 0x%04x\\n\", s, rc);\n\t\t\tbreak;\n\t\t}\n\n\t}\n\tlist_iterator_destroy (i);\n\tFREE_NULL_LIST (l);\n\n\treturn rc;\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nint run_script(const char *name, const char *pattern, uint32_t job_id,\n\t       int max_wait, char **env, uid_t uid)\n{\n\tint rc = 0;\n\tList l;\n\tListIterator i;\n\tchar *s;\n\n\tif (pattern == NULL || pattern[0] == '\\0')\n\t\treturn 0;\n\n\tl = _script_list_create (pattern);\n\tif (l == NULL)\n\t\treturn error (\"Unable to run %s [%s]\", name, pattern);\n\n\ti = list_iterator_create (l);\n\twhile ((s = list_next (i))) {\n\t\trc = _run_one_script (name, s, job_id, max_wait, env, uid);\n\t\tif (rc) {\n\t\t\terror (\"%s: exited with status 0x%04x\\n\", s, rc);\n\t\t\tbreak;\n\t\t}\n\n\t}\n\tlist_iterator_destroy (i);\n\tFREE_NULL_LIST (l);\n\n\treturn rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\n\nextern int run_script_health_check(void)\n{\n\tint rc = SLURM_SUCCESS;\n\n\tif (conf->health_check_program) {\n\t\tchar *env[1] = { NULL };\n\t\trc = run_script(\"health_check\", conf->health_check_program,\n\t\t\t\t0, 60, env, 0);\n\t}\n\n\treturn rc;\n}"
  },
  {
    "function_name": "_wait_health_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2337-2351",
    "snippet": "static void _wait_health_check(void)\n{\n\tint last_check_time = 0;\n\twhile (!_shutdown && (conf->health_check_interval != 0) ) {\n\t\tif (time(NULL) - last_check_time > HEALTH_RETRY_DELAY) {\n\t\t\tif (run_script_health_check() == SLURM_SUCCESS) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tlast_check_time = time(NULL);\n\t\t\tinfo (\"Health Check failed, retrying in %ds...\",\n\t\t\t\tHEALTH_RETRY_DELAY);\n\t\t}\n\t\tusleep(10000);\n\t}\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [
      "#define HEALTH_RETRY_DELAY 10"
    ],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static sig_atomic_t _shutdown = 0;",
      "static void      _wait_health_check(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "usleep",
          "args": [
            "10000"
          ],
          "line": 2349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Health Check failed, retrying in %ds...\"",
            "HEALTH_RETRY_DELAY"
          ],
          "line": 2346
        },
        "resolved": true,
        "details": {
          "function_name": "_task_info_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/slurmstepd_job.c",
          "lines": "222-232",
          "snippet": "static void\n_task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog)\n{\n\tslurm_mutex_lock(&t->mutex);\n\tslurm_mutex_unlock(&t->mutex);\n\tslurm_mutex_destroy(&t->mutex);\n\tif (multi_prog) {\n\t\txfree(t->argv);\n\t} /* otherwise, t->argv is a pointer to job->argv */\n\txfree(t);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmstepd/multi_prog.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <grp.h>",
            "#  include <string.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void _task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmstepd/multi_prog.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <grp.h>\n#  include <string.h>\n#  include \"config.h\"\n\nstatic void _task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog);\n\nstatic void\n_task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog)\n{\n\tslurm_mutex_lock(&t->mutex);\n\tslurm_mutex_unlock(&t->mutex);\n\tslurm_mutex_destroy(&t->mutex);\n\tif (multi_prog) {\n\t\txfree(t->argv);\n\t} /* otherwise, t->argv is a pointer to job->argv */\n\txfree(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "NULL"
          ],
          "line": 2345
        },
        "resolved": true,
        "details": {
          "function_name": "get_up_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "274-325",
          "snippet": "extern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "run_script_health_check",
          "args": [],
          "line": 2342
        },
        "resolved": true,
        "details": {
          "function_name": "run_script_health_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2359-2370",
          "snippet": "extern int run_script_health_check(void)\n{\n\tint rc = SLURM_SUCCESS;\n\n\tif (conf->health_check_program) {\n\t\tchar *env[1] = { NULL };\n\t\trc = run_script(\"health_check\", conf->health_check_program,\n\t\t\t\t0, 60, env, 0);\n\t}\n\n\treturn rc;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\n\nextern int run_script_health_check(void)\n{\n\tint rc = SLURM_SUCCESS;\n\n\tif (conf->health_check_program) {\n\t\tchar *env[1] = { NULL };\n\t\trc = run_script(\"health_check\", conf->health_check_program,\n\t\t\t\t0, 60, env, 0);\n\t}\n\n\treturn rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\n#define HEALTH_RETRY_DELAY 10\n\nslurmd_conf_t * conf = NULL;\nstatic sig_atomic_t _shutdown = 0;\nstatic void      _wait_health_check(void);\n\nstatic void _wait_health_check(void)\n{\n\tint last_check_time = 0;\n\twhile (!_shutdown && (conf->health_check_interval != 0) ) {\n\t\tif (time(NULL) - last_check_time > HEALTH_RETRY_DELAY) {\n\t\t\tif (run_script_health_check() == SLURM_SUCCESS) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tlast_check_time = time(NULL);\n\t\t\tinfo (\"Health Check failed, retrying in %ds...\",\n\t\t\t\tHEALTH_RETRY_DELAY);\n\t\t}\n\t\tusleep(10000);\n\t}\n}"
  },
  {
    "function_name": "_resource_spec_fini",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2323-2329",
    "snippet": "static void _resource_spec_fini(void)\n{\n\txfree(res_abs_cores);\n\txfree(res_mac_cpus);\n\tFREE_NULL_BITMAP(res_core_bitmap);\n\tFREE_NULL_BITMAP(res_cpu_bitmap);\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static bitstr_t\t*res_core_bitmap;",
      "static bitstr_t\t*res_cpu_bitmap;",
      "static char\t*res_abs_cores = NULL;",
      "static char\t*res_mac_cpus = NULL;",
      "static void      _resource_spec_fini(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "FREE_NULL_BITMAP",
          "args": [
            "res_cpu_bitmap"
          ],
          "line": 2328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FREE_NULL_BITMAP",
          "args": [
            "res_core_bitmap"
          ],
          "line": 2327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "res_mac_cpus"
          ],
          "line": 2326
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic bitstr_t\t*res_core_bitmap;\nstatic bitstr_t\t*res_cpu_bitmap;\nstatic char\t*res_abs_cores = NULL;\nstatic char\t*res_mac_cpus = NULL;\nstatic void      _resource_spec_fini(void);\n\nstatic void _resource_spec_fini(void)\n{\n\txfree(res_abs_cores);\n\txfree(res_mac_cpus);\n\tFREE_NULL_BITMAP(res_core_bitmap);\n\tFREE_NULL_BITMAP(res_cpu_bitmap);\n}"
  },
  {
    "function_name": "_validate_and_convert_cpu_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2292-2321",
    "snippet": "static int _validate_and_convert_cpu_list(void)\n{\n\tint core_off, thread_off;\n\n\t/* create CPU bitmap from input CPU list */\n\tif (bit_unfmt(res_cpu_bitmap, conf->cpu_spec_list) != 0) {\n\t\treturn SLURM_ERROR;\n\t}\n\t/* create core bitmap and list from CPU bitmap */\n\tfor (thread_off = 0; thread_off < ncpus; thread_off++) {\n\t\tif (bit_test(res_cpu_bitmap, thread_off) == 1)\n\t\t\tbit_set(res_core_bitmap, thread_off/(conf->threads));\n\t}\n\tbit_fmt(res_abs_cores, sizeof(res_abs_cores), res_core_bitmap);\n\t/* create output abstract CPU list from core bitmap */\n\tfor (core_off = 0; core_off < ncores; core_off++) {\n\t\tif (bit_test(res_core_bitmap, core_off) == 1) {\n\t\t\tfor (thread_off = 0; thread_off < conf->threads;\n\t\t\t     thread_off++)\n\t\t\t\tbit_set(res_cpu_bitmap,\n\t\t\t\t\t(core_off*conf->threads) + thread_off);\n\t\t}\n\t}\n\tbit_fmt(res_abs_cpus, sizeof(res_abs_cpus), res_cpu_bitmap);\n\t/* create output machine CPU list from core list */\n\tif (xcpuinfo_abs_to_mac(res_abs_cores, &res_mac_cpus)\n\t\t   != XCPUINFO_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static bitstr_t\t*res_core_bitmap;",
      "static bitstr_t\t*res_cpu_bitmap;",
      "static char\t*res_abs_cores = NULL;",
      "static char\tres_abs_cpus[MAX_CPUSTR];",
      "static char\t*res_mac_cpus = NULL;",
      "static int\tncores;",
      "static int\tncpus;",
      "static int       _validate_and_convert_cpu_list(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcpuinfo_abs_to_mac",
          "args": [
            "res_abs_cores",
            "&res_mac_cpus"
          ],
          "line": 2317
        },
        "resolved": true,
        "details": {
          "function_name": "xcpuinfo_abs_to_mac",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcpuinfo.c",
          "lines": "987-1045",
          "snippet": "int\nxcpuinfo_abs_to_mac(char* lrange,char** prange)\n{\n\tstatic int total_cores = -1, total_cpus = -1;\n\tbitstr_t* absmap = NULL;\n\tbitstr_t* macmap = NULL;\n\tint icore, ithread;\n\tint absid, macid;\n\tint rc = SLURM_SUCCESS;\n\n\tif (total_cores == -1) {\n\t\ttotal_cores = conf->sockets * conf->cores;\n\t\ttotal_cpus  = conf->block_map_size;\n\t}\n\n\t/* allocate bitmap */\n\tabsmap = bit_alloc(total_cores);\n\tmacmap = bit_alloc(total_cpus);\n\n\tif (!absmap || !macmap) {\n\t\trc = SLURM_ERROR;\n\t\tgoto end_it;\n\t}\n\n\t/* string to bitmap conversion */\n\tif (bit_unfmt(absmap, lrange)) {\n\t\trc = SLURM_ERROR;\n\t\tgoto end_it;\n\t}\n\n\t/* mapping abstract id to machine id using conf->block_map */\n\tfor (icore = 0; icore < total_cores; icore++) {\n\t\tif (bit_test(absmap, icore)) {\n\t\t\tfor (ithread = 0; ithread<conf->threads; ithread++) {\n\t\t\t\tabsid  = icore*conf->threads + ithread;\n\t\t\t\tabsid %= total_cpus;\n\n\t\t\t\tmacid  = conf->block_map[absid];\n\t\t\t\tmacid %= total_cpus;\n\n\t\t\t\tbit_set(macmap, macid);\n\t\t\t}\n\t\t}\n\t}\n\n\t/* convert machine cpu bitmap to range string */\n\t*prange = (char*)xmalloc(total_cpus*6);\n\tbit_fmt(*prange, total_cpus*6, macmap);\n\n\t/* free unused bitmaps */\nend_it:\n\tFREE_NULL_BITMAP(absmap);\n\tFREE_NULL_BITMAP(macmap);\n\n\tif (rc != SLURM_SUCCESS)\n\t\tinfo(\"_abs_to_mac failed\");\n\n\treturn rc;\n}",
          "includes": [
            "#include \"xcpuinfo.h\"",
            "#include <hwloc.h>",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <ctype.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int _map_to_range(uint16_t *map, uint16_t map_size, char** prange);",
            "uint16_t procs, boards, sockets, cores, threads=1;",
            "uint16_t block_map_size;",
            "extern slurmd_conf_t *conf;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcpuinfo.h\"\n#include <hwloc.h>\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <ctype.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nstatic int _map_to_range(uint16_t *map, uint16_t map_size, char** prange);\nuint16_t procs, boards, sockets, cores, threads=1;\nuint16_t block_map_size;\nextern slurmd_conf_t *conf;\n\nint\nxcpuinfo_abs_to_mac(char* lrange,char** prange)\n{\n\tstatic int total_cores = -1, total_cpus = -1;\n\tbitstr_t* absmap = NULL;\n\tbitstr_t* macmap = NULL;\n\tint icore, ithread;\n\tint absid, macid;\n\tint rc = SLURM_SUCCESS;\n\n\tif (total_cores == -1) {\n\t\ttotal_cores = conf->sockets * conf->cores;\n\t\ttotal_cpus  = conf->block_map_size;\n\t}\n\n\t/* allocate bitmap */\n\tabsmap = bit_alloc(total_cores);\n\tmacmap = bit_alloc(total_cpus);\n\n\tif (!absmap || !macmap) {\n\t\trc = SLURM_ERROR;\n\t\tgoto end_it;\n\t}\n\n\t/* string to bitmap conversion */\n\tif (bit_unfmt(absmap, lrange)) {\n\t\trc = SLURM_ERROR;\n\t\tgoto end_it;\n\t}\n\n\t/* mapping abstract id to machine id using conf->block_map */\n\tfor (icore = 0; icore < total_cores; icore++) {\n\t\tif (bit_test(absmap, icore)) {\n\t\t\tfor (ithread = 0; ithread<conf->threads; ithread++) {\n\t\t\t\tabsid  = icore*conf->threads + ithread;\n\t\t\t\tabsid %= total_cpus;\n\n\t\t\t\tmacid  = conf->block_map[absid];\n\t\t\t\tmacid %= total_cpus;\n\n\t\t\t\tbit_set(macmap, macid);\n\t\t\t}\n\t\t}\n\t}\n\n\t/* convert machine cpu bitmap to range string */\n\t*prange = (char*)xmalloc(total_cpus*6);\n\tbit_fmt(*prange, total_cpus*6, macmap);\n\n\t/* free unused bitmaps */\nend_it:\n\tFREE_NULL_BITMAP(absmap);\n\tFREE_NULL_BITMAP(macmap);\n\n\tif (rc != SLURM_SUCCESS)\n\t\tinfo(\"_abs_to_mac failed\");\n\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bit_fmt",
          "args": [
            "res_abs_cpus",
            "sizeof(res_abs_cpus)",
            "res_cpu_bitmap"
          ],
          "line": 2315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bit_set",
          "args": [
            "res_cpu_bitmap",
            "(core_off*conf->threads) + thread_off"
          ],
          "line": 2311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bit_test",
          "args": [
            "res_core_bitmap",
            "core_off"
          ],
          "line": 2308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bit_fmt",
          "args": [
            "res_abs_cores",
            "sizeof(res_abs_cores)",
            "res_core_bitmap"
          ],
          "line": 2305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bit_set",
          "args": [
            "res_core_bitmap",
            "thread_off/(conf->threads)"
          ],
          "line": 2303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bit_test",
          "args": [
            "res_cpu_bitmap",
            "thread_off"
          ],
          "line": 2302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bit_unfmt",
          "args": [
            "res_cpu_bitmap",
            "conf->cpu_spec_list"
          ],
          "line": 2297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic bitstr_t\t*res_core_bitmap;\nstatic bitstr_t\t*res_cpu_bitmap;\nstatic char\t*res_abs_cores = NULL;\nstatic char\tres_abs_cpus[MAX_CPUSTR];\nstatic char\t*res_mac_cpus = NULL;\nstatic int\tncores;\nstatic int\tncpus;\nstatic int       _validate_and_convert_cpu_list(void);\n\nstatic int _validate_and_convert_cpu_list(void)\n{\n\tint core_off, thread_off;\n\n\t/* create CPU bitmap from input CPU list */\n\tif (bit_unfmt(res_cpu_bitmap, conf->cpu_spec_list) != 0) {\n\t\treturn SLURM_ERROR;\n\t}\n\t/* create core bitmap and list from CPU bitmap */\n\tfor (thread_off = 0; thread_off < ncpus; thread_off++) {\n\t\tif (bit_test(res_cpu_bitmap, thread_off) == 1)\n\t\t\tbit_set(res_core_bitmap, thread_off/(conf->threads));\n\t}\n\tbit_fmt(res_abs_cores, sizeof(res_abs_cores), res_core_bitmap);\n\t/* create output abstract CPU list from core bitmap */\n\tfor (core_off = 0; core_off < ncores; core_off++) {\n\t\tif (bit_test(res_core_bitmap, core_off) == 1) {\n\t\t\tfor (thread_off = 0; thread_off < conf->threads;\n\t\t\t     thread_off++)\n\t\t\t\tbit_set(res_cpu_bitmap,\n\t\t\t\t\t(core_off*conf->threads) + thread_off);\n\t\t}\n\t}\n\tbit_fmt(res_abs_cpus, sizeof(res_abs_cpus), res_cpu_bitmap);\n\t/* create output machine CPU list from core list */\n\tif (xcpuinfo_abs_to_mac(res_abs_cores, &res_mac_cpus)\n\t\t   != XCPUINFO_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "_convert_spec_cores",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2269-2276",
    "snippet": "static int _convert_spec_cores(void)\n{\n\tbit_fmt(res_abs_cores, sizeof(res_abs_cores), res_core_bitmap);\n\tbit_fmt(res_abs_cpus, sizeof(res_abs_cpus), res_cpu_bitmap);\n\tif (xcpuinfo_abs_to_mac(res_abs_cores, &res_mac_cpus) != SLURM_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static bitstr_t\t*res_core_bitmap;",
      "static bitstr_t\t*res_cpu_bitmap;",
      "static char\t*res_abs_cores = NULL;",
      "static char\tres_abs_cpus[MAX_CPUSTR];",
      "static char\t*res_mac_cpus = NULL;",
      "static int       _convert_spec_cores(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcpuinfo_abs_to_mac",
          "args": [
            "res_abs_cores",
            "&res_mac_cpus"
          ],
          "line": 2273
        },
        "resolved": true,
        "details": {
          "function_name": "xcpuinfo_abs_to_mac",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcpuinfo.c",
          "lines": "987-1045",
          "snippet": "int\nxcpuinfo_abs_to_mac(char* lrange,char** prange)\n{\n\tstatic int total_cores = -1, total_cpus = -1;\n\tbitstr_t* absmap = NULL;\n\tbitstr_t* macmap = NULL;\n\tint icore, ithread;\n\tint absid, macid;\n\tint rc = SLURM_SUCCESS;\n\n\tif (total_cores == -1) {\n\t\ttotal_cores = conf->sockets * conf->cores;\n\t\ttotal_cpus  = conf->block_map_size;\n\t}\n\n\t/* allocate bitmap */\n\tabsmap = bit_alloc(total_cores);\n\tmacmap = bit_alloc(total_cpus);\n\n\tif (!absmap || !macmap) {\n\t\trc = SLURM_ERROR;\n\t\tgoto end_it;\n\t}\n\n\t/* string to bitmap conversion */\n\tif (bit_unfmt(absmap, lrange)) {\n\t\trc = SLURM_ERROR;\n\t\tgoto end_it;\n\t}\n\n\t/* mapping abstract id to machine id using conf->block_map */\n\tfor (icore = 0; icore < total_cores; icore++) {\n\t\tif (bit_test(absmap, icore)) {\n\t\t\tfor (ithread = 0; ithread<conf->threads; ithread++) {\n\t\t\t\tabsid  = icore*conf->threads + ithread;\n\t\t\t\tabsid %= total_cpus;\n\n\t\t\t\tmacid  = conf->block_map[absid];\n\t\t\t\tmacid %= total_cpus;\n\n\t\t\t\tbit_set(macmap, macid);\n\t\t\t}\n\t\t}\n\t}\n\n\t/* convert machine cpu bitmap to range string */\n\t*prange = (char*)xmalloc(total_cpus*6);\n\tbit_fmt(*prange, total_cpus*6, macmap);\n\n\t/* free unused bitmaps */\nend_it:\n\tFREE_NULL_BITMAP(absmap);\n\tFREE_NULL_BITMAP(macmap);\n\n\tif (rc != SLURM_SUCCESS)\n\t\tinfo(\"_abs_to_mac failed\");\n\n\treturn rc;\n}",
          "includes": [
            "#include \"xcpuinfo.h\"",
            "#include <hwloc.h>",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <ctype.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int _map_to_range(uint16_t *map, uint16_t map_size, char** prange);",
            "uint16_t procs, boards, sockets, cores, threads=1;",
            "uint16_t block_map_size;",
            "extern slurmd_conf_t *conf;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcpuinfo.h\"\n#include <hwloc.h>\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <ctype.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nstatic int _map_to_range(uint16_t *map, uint16_t map_size, char** prange);\nuint16_t procs, boards, sockets, cores, threads=1;\nuint16_t block_map_size;\nextern slurmd_conf_t *conf;\n\nint\nxcpuinfo_abs_to_mac(char* lrange,char** prange)\n{\n\tstatic int total_cores = -1, total_cpus = -1;\n\tbitstr_t* absmap = NULL;\n\tbitstr_t* macmap = NULL;\n\tint icore, ithread;\n\tint absid, macid;\n\tint rc = SLURM_SUCCESS;\n\n\tif (total_cores == -1) {\n\t\ttotal_cores = conf->sockets * conf->cores;\n\t\ttotal_cpus  = conf->block_map_size;\n\t}\n\n\t/* allocate bitmap */\n\tabsmap = bit_alloc(total_cores);\n\tmacmap = bit_alloc(total_cpus);\n\n\tif (!absmap || !macmap) {\n\t\trc = SLURM_ERROR;\n\t\tgoto end_it;\n\t}\n\n\t/* string to bitmap conversion */\n\tif (bit_unfmt(absmap, lrange)) {\n\t\trc = SLURM_ERROR;\n\t\tgoto end_it;\n\t}\n\n\t/* mapping abstract id to machine id using conf->block_map */\n\tfor (icore = 0; icore < total_cores; icore++) {\n\t\tif (bit_test(absmap, icore)) {\n\t\t\tfor (ithread = 0; ithread<conf->threads; ithread++) {\n\t\t\t\tabsid  = icore*conf->threads + ithread;\n\t\t\t\tabsid %= total_cpus;\n\n\t\t\t\tmacid  = conf->block_map[absid];\n\t\t\t\tmacid %= total_cpus;\n\n\t\t\t\tbit_set(macmap, macid);\n\t\t\t}\n\t\t}\n\t}\n\n\t/* convert machine cpu bitmap to range string */\n\t*prange = (char*)xmalloc(total_cpus*6);\n\tbit_fmt(*prange, total_cpus*6, macmap);\n\n\t/* free unused bitmaps */\nend_it:\n\tFREE_NULL_BITMAP(absmap);\n\tFREE_NULL_BITMAP(macmap);\n\n\tif (rc != SLURM_SUCCESS)\n\t\tinfo(\"_abs_to_mac failed\");\n\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bit_fmt",
          "args": [
            "res_abs_cpus",
            "sizeof(res_abs_cpus)",
            "res_cpu_bitmap"
          ],
          "line": 2272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bit_fmt",
          "args": [
            "res_abs_cores",
            "sizeof(res_abs_cores)",
            "res_core_bitmap"
          ],
          "line": 2271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic bitstr_t\t*res_core_bitmap;\nstatic bitstr_t\t*res_cpu_bitmap;\nstatic char\t*res_abs_cores = NULL;\nstatic char\tres_abs_cpus[MAX_CPUSTR];\nstatic char\t*res_mac_cpus = NULL;\nstatic int       _convert_spec_cores(void);\n\nstatic int _convert_spec_cores(void)\n{\n\tbit_fmt(res_abs_cores, sizeof(res_abs_cores), res_core_bitmap);\n\tbit_fmt(res_abs_cpus, sizeof(res_abs_cpus), res_cpu_bitmap);\n\tif (xcpuinfo_abs_to_mac(res_abs_cores, &res_mac_cpus) != SLURM_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "_select_spec_cores",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2236-2257",
    "snippet": "static void _select_spec_cores(void)\n{\n\tint spec_cores, res_core, res_sock, res_off, core_off, thread_off;\n\n\tspec_cores = conf->core_spec_cnt;\n\tfor (res_core = conf->cores - 1;\n\t     (spec_cores && (res_core >= 0)); res_core--) {\n\t\tfor (res_sock = conf->sockets - 1;\n\t\t     (spec_cores && (res_sock >= 0)); res_sock--) {\n\t\t\tcore_off = ((res_sock*conf->cores) + res_core) *\n\t\t\t\t\tconf->threads;\n\t\t\tfor (thread_off = 0; thread_off < conf->threads;\n\t\t\t     thread_off++) {\n\t\t\t\tbit_set(res_cpu_bitmap, core_off + thread_off);\n\t\t\t}\n\t\t\tres_off = (res_sock*conf->cores) + res_core;\n\t\t\tbit_set(res_core_bitmap, res_off);\n\t\t\tspec_cores--;\n\t\t}\n\t}\n\treturn;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static bitstr_t\t*res_core_bitmap;",
      "static bitstr_t\t*res_cpu_bitmap;",
      "static void      _select_spec_cores(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bit_set",
          "args": [
            "res_core_bitmap",
            "res_off"
          ],
          "line": 2252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bit_set",
          "args": [
            "res_cpu_bitmap",
            "core_off + thread_off"
          ],
          "line": 2249
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic bitstr_t\t*res_core_bitmap;\nstatic bitstr_t\t*res_cpu_bitmap;\nstatic void      _select_spec_cores(void);\n\nstatic void _select_spec_cores(void)\n{\n\tint spec_cores, res_core, res_sock, res_off, core_off, thread_off;\n\n\tspec_cores = conf->core_spec_cnt;\n\tfor (res_core = conf->cores - 1;\n\t     (spec_cores && (res_core >= 0)); res_core--) {\n\t\tfor (res_sock = conf->sockets - 1;\n\t\t     (spec_cores && (res_sock >= 0)); res_sock--) {\n\t\t\tcore_off = ((res_sock*conf->cores) + res_core) *\n\t\t\t\t\tconf->threads;\n\t\t\tfor (thread_off = 0; thread_off < conf->threads;\n\t\t\t     thread_off++) {\n\t\t\t\tbit_set(res_cpu_bitmap, core_off + thread_off);\n\t\t\t}\n\t\t\tres_off = (res_sock*conf->cores) + res_core;\n\t\t\tbit_set(res_core_bitmap, res_off);\n\t\t\tspec_cores--;\n\t\t}\n\t}\n\treturn;\n}"
  },
  {
    "function_name": "_memory_spec_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2183-2223",
    "snippet": "static int _memory_spec_init(void)\n{\n\tpid_t pid;\n\n\tif (conf->mem_spec_limit == 0) {\n\t\tinfo (\"Resource spec: Reserved system memory limit not \"\n\t\t      \"configured for this node\");\n\t\treturn SLURM_SUCCESS;\n\t}\n\tif (!check_memspec_cgroup_job_confinement()) {\n\t\terror(\"Resource spec: cgroup job confinement not configured. \"\n\t\t      \"MemSpecLimit requires TaskPlugin=task/cgroup and \"\n\t\t      \"ConstrainRAMSpace=yes in cgroup.conf\");\n\t\treturn SLURM_ERROR;\n\t}\n\tif (init_system_memory_cgroup() != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to initialize system \"\n\t\t      \"memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tif (set_system_cgroup_mem_limit(conf->mem_spec_limit)\n\t\t\t!= SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to set memory limit in \"\n\t\t      \"system memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tif (disable_system_cgroup_mem_oom()) {\n\t\terror(\"Resource spec: unable to disable OOM Killer in \"\n\t\t      \"system memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tpid = getpid();\n\tif (attach_system_memory_pid(pid) != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to attach slurmd to \"\n\t\t      \"system memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tinfo(\"Resource spec: system cgroup memory limit set to %u MB\",\n\t     conf->mem_spec_limit);\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static int       _memory_spec_init(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Resource spec: system cgroup memory limit set to %u MB\"",
            "conf->mem_spec_limit"
          ],
          "line": 2220
        },
        "resolved": true,
        "details": {
          "function_name": "_task_info_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/slurmstepd_job.c",
          "lines": "222-232",
          "snippet": "static void\n_task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog)\n{\n\tslurm_mutex_lock(&t->mutex);\n\tslurm_mutex_unlock(&t->mutex);\n\tslurm_mutex_destroy(&t->mutex);\n\tif (multi_prog) {\n\t\txfree(t->argv);\n\t} /* otherwise, t->argv is a pointer to job->argv */\n\txfree(t);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmstepd/multi_prog.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <grp.h>",
            "#  include <string.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void _task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmstepd/multi_prog.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <grp.h>\n#  include <string.h>\n#  include \"config.h\"\n\nstatic void _task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog);\n\nstatic void\n_task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog)\n{\n\tslurm_mutex_lock(&t->mutex);\n\tslurm_mutex_unlock(&t->mutex);\n\tslurm_mutex_destroy(&t->mutex);\n\tif (multi_prog) {\n\t\txfree(t->argv);\n\t} /* otherwise, t->argv is a pointer to job->argv */\n\txfree(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: unable to attach slurmd to \"\n\t\t      \"system memory cgroup\""
          ],
          "line": 2216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "attach_system_memory_pid",
          "args": [
            "pid"
          ],
          "line": 2215
        },
        "resolved": true,
        "details": {
          "function_name": "attach_system_memory_pid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "455-460",
          "snippet": "extern int attach_system_memory_pid(pid_t pid)\n{\n\tif (xcgroup_add_pids(&system_memory_cg, &pid, 1) != XCGROUP_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\n\nextern int attach_system_memory_pid(pid_t pid)\n{\n\tif (xcgroup_add_pids(&system_memory_cg, &pid, 1) != XCGROUP_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 2214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: unable to disable OOM Killer in \"\n\t\t      \"system memory cgroup\""
          ],
          "line": 2210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "disable_system_cgroup_mem_oom",
          "args": [],
          "line": 2209
        },
        "resolved": true,
        "details": {
          "function_name": "disable_system_cgroup_mem_oom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "441-446",
          "snippet": "extern int disable_system_cgroup_mem_oom()\n{\n\t/* 1: disables the oom killer */\n\treturn xcgroup_set_uint64_param(&system_memory_cg, \"memory.oom_control\",\n\t\t\t\t\t1);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\n\nextern int disable_system_cgroup_mem_oom()\n{\n\t/* 1: disables the oom killer */\n\treturn xcgroup_set_uint64_param(&system_memory_cg, \"memory.oom_control\",\n\t\t\t\t\t1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: unable to set memory limit in \"\n\t\t      \"system memory cgroup\""
          ],
          "line": 2205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_system_cgroup_mem_limit",
          "args": [
            "conf->mem_spec_limit"
          ],
          "line": 2203
        },
        "resolved": true,
        "details": {
          "function_name": "set_system_cgroup_mem_limit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "433-439",
          "snippet": "extern int set_system_cgroup_mem_limit(uint32_t mem_spec_limit)\n{\n    uint64_t mem_spec_bytes = (uint64_t)mem_spec_limit * 1024 * 1024;\n\txcgroup_set_uint64_param(&system_memory_cg, \"memory.limit_in_bytes\",\n\t\t\t\t mem_spec_bytes);\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\n\nextern int set_system_cgroup_mem_limit(uint32_t mem_spec_limit)\n{\n    uint64_t mem_spec_bytes = (uint64_t)mem_spec_limit * 1024 * 1024;\n\txcgroup_set_uint64_param(&system_memory_cg, \"memory.limit_in_bytes\",\n\t\t\t\t mem_spec_bytes);\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: unable to initialize system \"\n\t\t      \"memory cgroup\""
          ],
          "line": 2199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_system_memory_cgroup",
          "args": [],
          "line": 2198
        },
        "resolved": true,
        "details": {
          "function_name": "init_system_memory_cgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "189-297",
          "snippet": "extern int init_system_memory_cgroup(void)\n{\n\tint fstatus = SLURM_ERROR;\n\tchar* slurm_cgpath;\n\n\t/* read cgroup configuration */\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn SLURM_ERROR;\n\n\t/* initialize memory cgroup namespace */\n\tif (xcgroup_ns_create(&slurm_cgroup_conf, &memory_ns, \"\", \"memory\")\n\t    != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to create memory namespace\");\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\tconstrain_ram_space = slurm_cgroup_conf.constrain_ram_space;\n\tconstrain_swap_space = slurm_cgroup_conf.constrain_swap_space;\n\n\t/*\n\t * as the swap space threshold will be configured with a\n\t * mem+swp parameter value, if RAM space is not monitored,\n\t * set allowed RAM space to 100% of the job requested memory.\n\t * It will help to construct the mem+swp value that will be\n\t * used for both mem and mem+swp limit during memcg creation.\n\t */\n\tif ( constrain_ram_space )\n\t\tallowed_ram_space = slurm_cgroup_conf.allowed_ram_space;\n\telse\n\t\tallowed_ram_space = 100.0;\n\n\tallowed_swap_space = slurm_cgroup_conf.allowed_swap_space;\n\n\tif ((totalram = (uint64_t) conf->real_memory_size) == 0)\n\t\terror (\"system cgroup: Unable to get RealMemory size\");\n\n\tmax_ram = _percent_in_bytes(totalram, slurm_cgroup_conf.max_ram_percent);\n\tmax_swap = _percent_in_bytes(totalram, slurm_cgroup_conf.max_swap_percent);\n\tmax_swap += max_ram;\n\tmin_ram_space = slurm_cgroup_conf.min_ram_space * 1024 * 1024;\n\n\tdebug (\"system cgroup: memory: total:%luM allowed:%.4g%%(%s), \"\n\t       \"swap:%.4g%%(%s), max:%.4g%%(%luM) max+swap:%.4g%%(%luM) min:%uM\",\n\t       (unsigned long) totalram,\n\t       allowed_ram_space,\n\t       constrain_ram_space?\"enforced\":\"permissive\",\n\t       allowed_swap_space,\n\t       constrain_swap_space?\"enforced\":\"permissive\",\n\t       slurm_cgroup_conf.max_ram_percent,\n\t       (unsigned long) (max_ram/(1024*1024)),\n\t       slurm_cgroup_conf.max_swap_percent,\n\t       (unsigned long) (max_swap/(1024*1024)),\n\t       (unsigned) slurm_cgroup_conf.min_ram_space);\n\n        /*\n         *  Warning: OOM Killer must be disabled for slurmstepd\n         *  or it would be destroyed if the application use\n         *  more memory than permitted\n         *\n         *  If an env value is already set for slurmstepd\n         *  OOM killer behavior, keep it, otherwise set the\n         *  -1000 value, wich means do not let OOM killer kill it\n         *\n         *  FYI, setting \"export SLURMSTEPD_OOM_ADJ=-1000\"\n         *  in /etc/sysconfig/slurm would be the same\n         */\n        setenv(\"SLURMSTEPD_OOM_ADJ\", \"-1000\", 0);\n\n\t/* create slurm root cg in this cg namespace */\n\tslurm_cgpath = _system_cgroup_create_slurm_cg(&memory_ns);\n\tif ( slurm_cgpath == NULL ) {\n\t\txcgroup_ns_destroy(&memory_ns);\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\t/* build system cgroup relative path */\n\tsnprintf(system_cgroup_path, PATH_MAX, \"%s/system\", slurm_cgpath);\n\txfree(slurm_cgpath);\n\n\t/* create system cgroup in the cpuset ns */\n\tif (xcgroup_create(&memory_ns, &system_memory_cg,\n\t\t\t   system_cgroup_path,\n\t\t\t   getuid(), getgid()) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\tif (xcgroup_instantiate(&system_memory_cg) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\n\tif ( xcgroup_set_param(&system_memory_cg, \"memory.use_hierarchy\", \"1\")\n\t     != XCGROUP_SUCCESS ) {\n\t\terror(\"system cgroup: unable to ask for hierarchical accounting\"\n\t\t      \"of system memcg '%s'\", system_memory_cg.path);\n\t\tgoto error;\n\t}\n\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\tdebug(\"system cgroup: system memory cgroup initialized\");\n\treturn SLURM_SUCCESS;\n\nerror:\n\txcgroup_unlock(&system_memory_cg);\n\txcgroup_destroy(&system_memory_cg);\n\txcgroup_ns_destroy(&memory_ns);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn fstatus;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [
            "static xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
            "static xcgroup_ns_t memory_ns = {NULL, NULL, NULL, NULL};",
            "static char system_cgroup_path[PATH_MAX];",
            "static slurm_cgroup_conf_t slurm_cgroup_conf;",
            "static bool constrain_ram_space;",
            "static bool constrain_swap_space;",
            "static float allowed_ram_space;",
            "static float allowed_swap_space;",
            "static uint64_t max_ram;",
            "static uint64_t max_swap;",
            "static uint64_t totalram;",
            "static uint64_t min_ram_space;",
            "static char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);",
            "static int _xcgroup_cpuset_init(xcgroup_t* cg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\n#define PATH_MAX 256\n\nstatic xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic xcgroup_ns_t memory_ns = {NULL, NULL, NULL, NULL};\nstatic char system_cgroup_path[PATH_MAX];\nstatic slurm_cgroup_conf_t slurm_cgroup_conf;\nstatic bool constrain_ram_space;\nstatic bool constrain_swap_space;\nstatic float allowed_ram_space;\nstatic float allowed_swap_space;\nstatic uint64_t max_ram;\nstatic uint64_t max_swap;\nstatic uint64_t totalram;\nstatic uint64_t min_ram_space;\nstatic char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);\nstatic int _xcgroup_cpuset_init(xcgroup_t* cg);\n\nextern int init_system_memory_cgroup(void)\n{\n\tint fstatus = SLURM_ERROR;\n\tchar* slurm_cgpath;\n\n\t/* read cgroup configuration */\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn SLURM_ERROR;\n\n\t/* initialize memory cgroup namespace */\n\tif (xcgroup_ns_create(&slurm_cgroup_conf, &memory_ns, \"\", \"memory\")\n\t    != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to create memory namespace\");\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\tconstrain_ram_space = slurm_cgroup_conf.constrain_ram_space;\n\tconstrain_swap_space = slurm_cgroup_conf.constrain_swap_space;\n\n\t/*\n\t * as the swap space threshold will be configured with a\n\t * mem+swp parameter value, if RAM space is not monitored,\n\t * set allowed RAM space to 100% of the job requested memory.\n\t * It will help to construct the mem+swp value that will be\n\t * used for both mem and mem+swp limit during memcg creation.\n\t */\n\tif ( constrain_ram_space )\n\t\tallowed_ram_space = slurm_cgroup_conf.allowed_ram_space;\n\telse\n\t\tallowed_ram_space = 100.0;\n\n\tallowed_swap_space = slurm_cgroup_conf.allowed_swap_space;\n\n\tif ((totalram = (uint64_t) conf->real_memory_size) == 0)\n\t\terror (\"system cgroup: Unable to get RealMemory size\");\n\n\tmax_ram = _percent_in_bytes(totalram, slurm_cgroup_conf.max_ram_percent);\n\tmax_swap = _percent_in_bytes(totalram, slurm_cgroup_conf.max_swap_percent);\n\tmax_swap += max_ram;\n\tmin_ram_space = slurm_cgroup_conf.min_ram_space * 1024 * 1024;\n\n\tdebug (\"system cgroup: memory: total:%luM allowed:%.4g%%(%s), \"\n\t       \"swap:%.4g%%(%s), max:%.4g%%(%luM) max+swap:%.4g%%(%luM) min:%uM\",\n\t       (unsigned long) totalram,\n\t       allowed_ram_space,\n\t       constrain_ram_space?\"enforced\":\"permissive\",\n\t       allowed_swap_space,\n\t       constrain_swap_space?\"enforced\":\"permissive\",\n\t       slurm_cgroup_conf.max_ram_percent,\n\t       (unsigned long) (max_ram/(1024*1024)),\n\t       slurm_cgroup_conf.max_swap_percent,\n\t       (unsigned long) (max_swap/(1024*1024)),\n\t       (unsigned) slurm_cgroup_conf.min_ram_space);\n\n        /*\n         *  Warning: OOM Killer must be disabled for slurmstepd\n         *  or it would be destroyed if the application use\n         *  more memory than permitted\n         *\n         *  If an env value is already set for slurmstepd\n         *  OOM killer behavior, keep it, otherwise set the\n         *  -1000 value, wich means do not let OOM killer kill it\n         *\n         *  FYI, setting \"export SLURMSTEPD_OOM_ADJ=-1000\"\n         *  in /etc/sysconfig/slurm would be the same\n         */\n        setenv(\"SLURMSTEPD_OOM_ADJ\", \"-1000\", 0);\n\n\t/* create slurm root cg in this cg namespace */\n\tslurm_cgpath = _system_cgroup_create_slurm_cg(&memory_ns);\n\tif ( slurm_cgpath == NULL ) {\n\t\txcgroup_ns_destroy(&memory_ns);\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\t/* build system cgroup relative path */\n\tsnprintf(system_cgroup_path, PATH_MAX, \"%s/system\", slurm_cgpath);\n\txfree(slurm_cgpath);\n\n\t/* create system cgroup in the cpuset ns */\n\tif (xcgroup_create(&memory_ns, &system_memory_cg,\n\t\t\t   system_cgroup_path,\n\t\t\t   getuid(), getgid()) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\tif (xcgroup_instantiate(&system_memory_cg) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\n\tif ( xcgroup_set_param(&system_memory_cg, \"memory.use_hierarchy\", \"1\")\n\t     != XCGROUP_SUCCESS ) {\n\t\terror(\"system cgroup: unable to ask for hierarchical accounting\"\n\t\t      \"of system memcg '%s'\", system_memory_cg.path);\n\t\tgoto error;\n\t}\n\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\tdebug(\"system cgroup: system memory cgroup initialized\");\n\treturn SLURM_SUCCESS;\n\nerror:\n\txcgroup_unlock(&system_memory_cg);\n\txcgroup_destroy(&system_memory_cg);\n\txcgroup_ns_destroy(&memory_ns);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: cgroup job confinement not configured. \"\n\t\t      \"MemSpecLimit requires TaskPlugin=task/cgroup and \"\n\t\t      \"ConstrainRAMSpace=yes in cgroup.conf\""
          ],
          "line": 2193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_memspec_cgroup_job_confinement",
          "args": [],
          "line": 2192
        },
        "resolved": true,
        "details": {
          "function_name": "check_memspec_cgroup_job_confinement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "462-476",
          "snippet": "extern bool check_memspec_cgroup_job_confinement(void)\n{\n\tchar *task_plugin_type = NULL;\n\tbool status = false;\n\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn false;\n\ttask_plugin_type = slurm_get_task_plugin();\n\tif (slurm_cgroup_conf.constrain_ram_space &&\n\t    strstr(task_plugin_type, \"cgroup\"))\n\t\tstatus = true;\n\txfree(task_plugin_type);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn status;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static slurm_cgroup_conf_t slurm_cgroup_conf;",
            "static bool constrain_ram_space;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic slurm_cgroup_conf_t slurm_cgroup_conf;\nstatic bool constrain_ram_space;\n\nextern bool check_memspec_cgroup_job_confinement(void)\n{\n\tchar *task_plugin_type = NULL;\n\tbool status = false;\n\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn false;\n\ttask_plugin_type = slurm_get_task_plugin();\n\tif (slurm_cgroup_conf.constrain_ram_space &&\n\t    strstr(task_plugin_type, \"cgroup\"))\n\t\tstatus = true;\n\txfree(task_plugin_type);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Resource spec: Reserved system memory limit not \"\n\t\t      \"configured for this node\""
          ],
          "line": 2188
        },
        "resolved": true,
        "details": {
          "function_name": "_free_file_bcast_info_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "3642-3648",
          "snippet": "static void _free_file_bcast_info_t(file_bcast_info_t *f)\n{\n\txfree(f->fname);\n\tif (f->fd)\n\t\tclose(f->fd);\n\txfree(f);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic void _free_file_bcast_info_t(file_bcast_info_t *f)\n{\n\txfree(f->fname);\n\tif (f->fd)\n\t\tclose(f->fd);\n\txfree(f);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic int       _memory_spec_init(void);\n\nstatic int _memory_spec_init(void)\n{\n\tpid_t pid;\n\n\tif (conf->mem_spec_limit == 0) {\n\t\tinfo (\"Resource spec: Reserved system memory limit not \"\n\t\t      \"configured for this node\");\n\t\treturn SLURM_SUCCESS;\n\t}\n\tif (!check_memspec_cgroup_job_confinement()) {\n\t\terror(\"Resource spec: cgroup job confinement not configured. \"\n\t\t      \"MemSpecLimit requires TaskPlugin=task/cgroup and \"\n\t\t      \"ConstrainRAMSpace=yes in cgroup.conf\");\n\t\treturn SLURM_ERROR;\n\t}\n\tif (init_system_memory_cgroup() != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to initialize system \"\n\t\t      \"memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tif (set_system_cgroup_mem_limit(conf->mem_spec_limit)\n\t\t\t!= SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to set memory limit in \"\n\t\t      \"system memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tif (disable_system_cgroup_mem_oom()) {\n\t\terror(\"Resource spec: unable to disable OOM Killer in \"\n\t\t      \"system memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tpid = getpid();\n\tif (attach_system_memory_pid(pid) != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to attach slurmd to \"\n\t\t      \"system memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tinfo(\"Resource spec: system cgroup memory limit set to %u MB\",\n\t     conf->mem_spec_limit);\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "_core_spec_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2101-2178",
    "snippet": "static int _core_spec_init(void)\n{\n\tpid_t pid;\n\n\tif ((conf->core_spec_cnt == 0) && (conf->cpu_spec_list == NULL)) {\n\t\tdebug(\"Resource spec: No specialized cores configured by \"\n\t\t      \"default on this node\");\n\t\treturn SLURM_SUCCESS;\n\t}\n\tif (_is_core_spec_cray()) {\t/* No need to use cgroups */\n\t\tdebug(\"Using core_spec/cray to manage specialized cores\");\n\t\treturn SLURM_SUCCESS;\n\t}\n\tif (!check_corespec_cgroup_job_confinement()) {\n\t\terror(\"Resource spec: cgroup job confinement not configured. \"\n\t\t     \"CoreSpec requires TaskPlugin=task/cgroup and \"\n\t\t     \"ConstrainCores=yes in cgroup.conf\");\n\t\treturn SLURM_ERROR;\n\t}\n\n\tncores = conf->sockets * conf->cores;\n\tncpus = ncores * conf->threads;\n\tres_abs_cores = xmalloc(ncores * 4 * sizeof(char));\n\tres_core_bitmap = bit_alloc(ncores);\n\tres_cpu_bitmap  = bit_alloc(ncpus);\n\tres_abs_cpus[0] = '\\0';\n\n\tif (conf->cpu_spec_list != NULL) {\n\t\t/* CPUSpecList designated in slurm.conf */\n\t\tdebug2(\"Resource spec: configured CPU specialization list: %s\",\n\t\t\tconf->cpu_spec_list);\n\t\tif (_validate_and_convert_cpu_list() != SLURM_SUCCESS) {\n\t\t\terror(\"Resource spec: unable to process CPUSpecList\");\n\t\t\t_resource_spec_fini();\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t} else {\n\t\t/* CoreSpecCount designated in slurm.conf */\n\t\tdebug2(\"Resource spec: configured core specialization \"\n\t\t       \"count: %u\", conf->core_spec_cnt);\n\t\tif (conf->core_spec_cnt >= ncores) {\n\t\t\terror(\"Resource spec: CoreSpecCount too large\");\n\t\t\t_resource_spec_fini();\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t\t_select_spec_cores();\n\t\tif (_convert_spec_cores() != SLURM_SUCCESS) {\n\t\t\terror(\"Resource spec: unable to convert \"\n\t\t\t      \"selected cores to machine CPU IDs\");\n\t\t\t_resource_spec_fini();\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t}\n\tif (init_system_cpuset_cgroup() != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to initialize system \"\n\t\t      \"cpuset cgroup\");\n\t\t_resource_spec_fini();\n\t\treturn SLURM_ERROR;\n\t}\n\tif (set_system_cgroup_cpus(res_mac_cpus) != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to set reserved CPU IDs in \"\n\t\t      \"system cpuset cgroup\");\n\t\t_resource_spec_fini();\n\t\treturn SLURM_ERROR;\n\t}\n\tpid = getpid();\n\tif (attach_system_cpuset_pid(pid) != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to attach slurmd to \"\n\t\t      \"system cpuset cgroup\");\n\t\t_resource_spec_fini();\n\t\treturn SLURM_ERROR;\n\t}\n\tinfo(\"Resource spec: Reserved abstract CPU IDs: %s\", res_abs_cpus);\n\tinfo(\"Resource spec: Reserved machine CPU IDs: %s\", res_mac_cpus);\n\t_resource_spec_fini();\n\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static bitstr_t\t*res_core_bitmap;",
      "static bitstr_t\t*res_cpu_bitmap;",
      "static char\t*res_abs_cores = NULL;",
      "static char\tres_abs_cpus[MAX_CPUSTR];",
      "static char\t*res_mac_cpus = NULL;",
      "static int\tncores;",
      "static int\tncpus;",
      "static int       _convert_spec_cores(void);",
      "static int       _core_spec_init(void);",
      "static bool      _is_core_spec_cray(void);",
      "static void      _resource_spec_fini(void);",
      "static void      _select_spec_cores(void);",
      "static int       _validate_and_convert_cpu_list(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_resource_spec_fini",
          "args": [],
          "line": 2175
        },
        "resolved": true,
        "details": {
          "function_name": "_resource_spec_fini",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2323-2329",
          "snippet": "static void _resource_spec_fini(void)\n{\n\txfree(res_abs_cores);\n\txfree(res_mac_cpus);\n\tFREE_NULL_BITMAP(res_core_bitmap);\n\tFREE_NULL_BITMAP(res_cpu_bitmap);\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bitstr_t\t*res_core_bitmap;",
            "static bitstr_t\t*res_cpu_bitmap;",
            "static char\t*res_abs_cores = NULL;",
            "static char\t*res_mac_cpus = NULL;",
            "static void      _resource_spec_fini(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic bitstr_t\t*res_core_bitmap;\nstatic bitstr_t\t*res_cpu_bitmap;\nstatic char\t*res_abs_cores = NULL;\nstatic char\t*res_mac_cpus = NULL;\nstatic void      _resource_spec_fini(void);\n\nstatic void _resource_spec_fini(void)\n{\n\txfree(res_abs_cores);\n\txfree(res_mac_cpus);\n\tFREE_NULL_BITMAP(res_core_bitmap);\n\tFREE_NULL_BITMAP(res_cpu_bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Resource spec: Reserved machine CPU IDs: %s\"",
            "res_mac_cpus"
          ],
          "line": 2174
        },
        "resolved": true,
        "details": {
          "function_name": "_task_info_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/slurmstepd_job.c",
          "lines": "222-232",
          "snippet": "static void\n_task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog)\n{\n\tslurm_mutex_lock(&t->mutex);\n\tslurm_mutex_unlock(&t->mutex);\n\tslurm_mutex_destroy(&t->mutex);\n\tif (multi_prog) {\n\t\txfree(t->argv);\n\t} /* otherwise, t->argv is a pointer to job->argv */\n\txfree(t);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmstepd/multi_prog.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <grp.h>",
            "#  include <string.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void _task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmstepd/multi_prog.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <grp.h>\n#  include <string.h>\n#  include \"config.h\"\n\nstatic void _task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog);\n\nstatic void\n_task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog)\n{\n\tslurm_mutex_lock(&t->mutex);\n\tslurm_mutex_unlock(&t->mutex);\n\tslurm_mutex_destroy(&t->mutex);\n\tif (multi_prog) {\n\t\txfree(t->argv);\n\t} /* otherwise, t->argv is a pointer to job->argv */\n\txfree(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: unable to attach slurmd to \"\n\t\t      \"system cpuset cgroup\""
          ],
          "line": 2168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "attach_system_cpuset_pid",
          "args": [
            "pid"
          ],
          "line": 2167
        },
        "resolved": true,
        "details": {
          "function_name": "attach_system_cpuset_pid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "448-453",
          "snippet": "extern int attach_system_cpuset_pid(pid_t pid)\n{\n\tif (xcgroup_add_pids(&system_cpuset_cg, &pid, 1) != XCGROUP_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\n\nextern int attach_system_cpuset_pid(pid_t pid)\n{\n\tif (xcgroup_add_pids(&system_cpuset_cg, &pid, 1) != XCGROUP_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 2166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: unable to set reserved CPU IDs in \"\n\t\t      \"system cpuset cgroup\""
          ],
          "line": 2161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_system_cgroup_cpus",
          "args": [
            "res_mac_cpus"
          ],
          "line": 2160
        },
        "resolved": true,
        "details": {
          "function_name": "set_system_cgroup_cpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "426-431",
          "snippet": "extern int set_system_cgroup_cpus(char *phys_cpu_str)\n{\n\tsnprintf(cpuset_meta, sizeof(cpuset_meta), \"%scpus\", cpuset_prefix);\n\txcgroup_set_param(&system_cpuset_cg, cpuset_meta, phys_cpu_str);\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
            "static char *cpuset_prefix = \"\";",
            "char cpuset_meta[PATH_MAX];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic char *cpuset_prefix = \"\";\nchar cpuset_meta[PATH_MAX];\n\nextern int set_system_cgroup_cpus(char *phys_cpu_str)\n{\n\tsnprintf(cpuset_meta, sizeof(cpuset_meta), \"%scpus\", cpuset_prefix);\n\txcgroup_set_param(&system_cpuset_cg, cpuset_meta, phys_cpu_str);\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: unable to initialize system \"\n\t\t      \"cpuset cgroup\""
          ],
          "line": 2155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_system_cpuset_cgroup",
          "args": [],
          "line": 2154
        },
        "resolved": true,
        "details": {
          "function_name": "init_system_cpuset_cgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "99-187",
          "snippet": "extern int init_system_cpuset_cgroup(void)\n{\n\tint rc;\n\tint fstatus = SLURM_ERROR;\n\tchar* cpus = NULL;\n\tsize_t cpus_size;\n\tchar* slurm_cgpath;\n\txcgroup_t slurm_cg;\n\n\t/* read cgroup configuration */\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn SLURM_ERROR;\n\n\t/* initialize cpuset cgroup namespace */\n\tif (xcgroup_ns_create(&slurm_cgroup_conf, &cpuset_ns, \"\", \"cpuset\")\n\t    != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to create cpuset namespace\");\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\t/* create slurm root cg in this cg namespace */\n\tslurm_cgpath = _system_cgroup_create_slurm_cg(&cpuset_ns);\n\tif ( slurm_cgpath == NULL ) {\n\t\txcgroup_ns_destroy(&cpuset_ns);\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\t/* check that this cgroup has cpus allowed or initialize them */\n\tif (xcgroup_load(&cpuset_ns, &slurm_cg, slurm_cgpath)\n\t    != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to load slurm cpuset xcgroup\");\n\t\txfree(slurm_cgpath);\n\t\txcgroup_ns_destroy(&cpuset_ns);\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\nagain:\n\tsnprintf(cpuset_meta, sizeof(cpuset_meta), \"%scpus\", cpuset_prefix);\n\trc = xcgroup_get_param(&slurm_cg, cpuset_meta, &cpus, &cpus_size);\n\tif (rc != XCGROUP_SUCCESS || cpus_size == 1) {\n\t\tif (!cpuset_prefix_set && (rc != XCGROUP_SUCCESS)) {\n\t\t\tcpuset_prefix_set = 1;\n\t\t\tcpuset_prefix = \"cpuset.\";\n\t\t\tgoto again;\n\t\t}\n\n\t\t/* initialize the cpusets as it was nonexistent */\n\t\tif (_xcgroup_cpuset_init(&slurm_cg) != XCGROUP_SUCCESS) {\n\t\t\txfree(slurm_cgpath);\n\t\t\txcgroup_destroy(&slurm_cg);\n\t\t\txcgroup_ns_destroy(&cpuset_ns);\n\t\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\t\txfree(cpus);\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t}\n\txcgroup_destroy(&slurm_cg);\n\txfree(cpus);\n\n\t/* build system cgroup relative path */\n\tsnprintf(system_cgroup_path, PATH_MAX, \"%s/system\", slurm_cgpath);\n\txfree(slurm_cgpath);\n\n\t/* create system cgroup in the cpuset ns */\n\tif (xcgroup_create(&cpuset_ns, &system_cpuset_cg, system_cgroup_path,\n\t\t\t   getuid(),getgid()) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\tif (xcgroup_instantiate(&system_cpuset_cg) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\tif (_xcgroup_cpuset_init(&system_cpuset_cg) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\tdebug(\"system cgroup: system cpuset cgroup initialized\");\n\treturn SLURM_SUCCESS;\n\nerror:\n\txcgroup_unlock(&system_cpuset_cg);\n\txcgroup_destroy(&system_cpuset_cg);\n\txcgroup_ns_destroy(&cpuset_ns);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn fstatus;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [
            "static xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
            "static bool cpuset_prefix_set = false;",
            "static char *cpuset_prefix = \"\";",
            "static xcgroup_ns_t cpuset_ns = {NULL, NULL, NULL, NULL};",
            "char cpuset_meta[PATH_MAX];",
            "static char system_cgroup_path[PATH_MAX];",
            "static slurm_cgroup_conf_t slurm_cgroup_conf;",
            "static char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);",
            "static int _xcgroup_cpuset_init(xcgroup_t* cg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\n#define PATH_MAX 256\n\nstatic xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic bool cpuset_prefix_set = false;\nstatic char *cpuset_prefix = \"\";\nstatic xcgroup_ns_t cpuset_ns = {NULL, NULL, NULL, NULL};\nchar cpuset_meta[PATH_MAX];\nstatic char system_cgroup_path[PATH_MAX];\nstatic slurm_cgroup_conf_t slurm_cgroup_conf;\nstatic char* _system_cgroup_create_slurm_cg (xcgroup_ns_t* ns);\nstatic int _xcgroup_cpuset_init(xcgroup_t* cg);\n\nextern int init_system_cpuset_cgroup(void)\n{\n\tint rc;\n\tint fstatus = SLURM_ERROR;\n\tchar* cpus = NULL;\n\tsize_t cpus_size;\n\tchar* slurm_cgpath;\n\txcgroup_t slurm_cg;\n\n\t/* read cgroup configuration */\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn SLURM_ERROR;\n\n\t/* initialize cpuset cgroup namespace */\n\tif (xcgroup_ns_create(&slurm_cgroup_conf, &cpuset_ns, \"\", \"cpuset\")\n\t    != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to create cpuset namespace\");\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\t/* create slurm root cg in this cg namespace */\n\tslurm_cgpath = _system_cgroup_create_slurm_cg(&cpuset_ns);\n\tif ( slurm_cgpath == NULL ) {\n\t\txcgroup_ns_destroy(&cpuset_ns);\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\n\t/* check that this cgroup has cpus allowed or initialize them */\n\tif (xcgroup_load(&cpuset_ns, &slurm_cg, slurm_cgpath)\n\t    != XCGROUP_SUCCESS) {\n\t\terror(\"system cgroup: unable to load slurm cpuset xcgroup\");\n\t\txfree(slurm_cgpath);\n\t\txcgroup_ns_destroy(&cpuset_ns);\n\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\treturn SLURM_ERROR;\n\t}\n\nagain:\n\tsnprintf(cpuset_meta, sizeof(cpuset_meta), \"%scpus\", cpuset_prefix);\n\trc = xcgroup_get_param(&slurm_cg, cpuset_meta, &cpus, &cpus_size);\n\tif (rc != XCGROUP_SUCCESS || cpus_size == 1) {\n\t\tif (!cpuset_prefix_set && (rc != XCGROUP_SUCCESS)) {\n\t\t\tcpuset_prefix_set = 1;\n\t\t\tcpuset_prefix = \"cpuset.\";\n\t\t\tgoto again;\n\t\t}\n\n\t\t/* initialize the cpusets as it was nonexistent */\n\t\tif (_xcgroup_cpuset_init(&slurm_cg) != XCGROUP_SUCCESS) {\n\t\t\txfree(slurm_cgpath);\n\t\t\txcgroup_destroy(&slurm_cg);\n\t\t\txcgroup_ns_destroy(&cpuset_ns);\n\t\t\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\t\t\txfree(cpus);\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t}\n\txcgroup_destroy(&slurm_cg);\n\txfree(cpus);\n\n\t/* build system cgroup relative path */\n\tsnprintf(system_cgroup_path, PATH_MAX, \"%s/system\", slurm_cgpath);\n\txfree(slurm_cgpath);\n\n\t/* create system cgroup in the cpuset ns */\n\tif (xcgroup_create(&cpuset_ns, &system_cpuset_cg, system_cgroup_path,\n\t\t\t   getuid(),getgid()) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\tif (xcgroup_instantiate(&system_cpuset_cg) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\tif (_xcgroup_cpuset_init(&system_cpuset_cg) != XCGROUP_SUCCESS) {\n\t\tgoto error;\n\t}\n\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\tdebug(\"system cgroup: system cpuset cgroup initialized\");\n\treturn SLURM_SUCCESS;\n\nerror:\n\txcgroup_unlock(&system_cpuset_cg);\n\txcgroup_destroy(&system_cpuset_cg);\n\txcgroup_ns_destroy(&cpuset_ns);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: unable to convert \"\n\t\t\t      \"selected cores to machine CPU IDs\""
          ],
          "line": 2148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_convert_spec_cores",
          "args": [],
          "line": 2147
        },
        "resolved": true,
        "details": {
          "function_name": "_convert_spec_cores",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2269-2276",
          "snippet": "static int _convert_spec_cores(void)\n{\n\tbit_fmt(res_abs_cores, sizeof(res_abs_cores), res_core_bitmap);\n\tbit_fmt(res_abs_cpus, sizeof(res_abs_cpus), res_cpu_bitmap);\n\tif (xcpuinfo_abs_to_mac(res_abs_cores, &res_mac_cpus) != SLURM_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bitstr_t\t*res_core_bitmap;",
            "static bitstr_t\t*res_cpu_bitmap;",
            "static char\t*res_abs_cores = NULL;",
            "static char\tres_abs_cpus[MAX_CPUSTR];",
            "static char\t*res_mac_cpus = NULL;",
            "static int       _convert_spec_cores(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic bitstr_t\t*res_core_bitmap;\nstatic bitstr_t\t*res_cpu_bitmap;\nstatic char\t*res_abs_cores = NULL;\nstatic char\tres_abs_cpus[MAX_CPUSTR];\nstatic char\t*res_mac_cpus = NULL;\nstatic int       _convert_spec_cores(void);\n\nstatic int _convert_spec_cores(void)\n{\n\tbit_fmt(res_abs_cores, sizeof(res_abs_cores), res_core_bitmap);\n\tbit_fmt(res_abs_cpus, sizeof(res_abs_cpus), res_cpu_bitmap);\n\tif (xcpuinfo_abs_to_mac(res_abs_cores, &res_mac_cpus) != SLURM_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_select_spec_cores",
          "args": [],
          "line": 2146
        },
        "resolved": true,
        "details": {
          "function_name": "_select_spec_cores",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2236-2257",
          "snippet": "static void _select_spec_cores(void)\n{\n\tint spec_cores, res_core, res_sock, res_off, core_off, thread_off;\n\n\tspec_cores = conf->core_spec_cnt;\n\tfor (res_core = conf->cores - 1;\n\t     (spec_cores && (res_core >= 0)); res_core--) {\n\t\tfor (res_sock = conf->sockets - 1;\n\t\t     (spec_cores && (res_sock >= 0)); res_sock--) {\n\t\t\tcore_off = ((res_sock*conf->cores) + res_core) *\n\t\t\t\t\tconf->threads;\n\t\t\tfor (thread_off = 0; thread_off < conf->threads;\n\t\t\t     thread_off++) {\n\t\t\t\tbit_set(res_cpu_bitmap, core_off + thread_off);\n\t\t\t}\n\t\t\tres_off = (res_sock*conf->cores) + res_core;\n\t\t\tbit_set(res_core_bitmap, res_off);\n\t\t\tspec_cores--;\n\t\t}\n\t}\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static bitstr_t\t*res_core_bitmap;",
            "static bitstr_t\t*res_cpu_bitmap;",
            "static void      _select_spec_cores(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic bitstr_t\t*res_core_bitmap;\nstatic bitstr_t\t*res_cpu_bitmap;\nstatic void      _select_spec_cores(void);\n\nstatic void _select_spec_cores(void)\n{\n\tint spec_cores, res_core, res_sock, res_off, core_off, thread_off;\n\n\tspec_cores = conf->core_spec_cnt;\n\tfor (res_core = conf->cores - 1;\n\t     (spec_cores && (res_core >= 0)); res_core--) {\n\t\tfor (res_sock = conf->sockets - 1;\n\t\t     (spec_cores && (res_sock >= 0)); res_sock--) {\n\t\t\tcore_off = ((res_sock*conf->cores) + res_core) *\n\t\t\t\t\tconf->threads;\n\t\t\tfor (thread_off = 0; thread_off < conf->threads;\n\t\t\t     thread_off++) {\n\t\t\t\tbit_set(res_cpu_bitmap, core_off + thread_off);\n\t\t\t}\n\t\t\tres_off = (res_sock*conf->cores) + res_core;\n\t\t\tbit_set(res_core_bitmap, res_off);\n\t\t\tspec_cores--;\n\t\t}\n\t}\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: CoreSpecCount too large\""
          ],
          "line": 2142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"Resource spec: configured core specialization \"\n\t\t       \"count: %u\"",
            "conf->core_spec_cnt"
          ],
          "line": 2139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: unable to process CPUSpecList\""
          ],
          "line": 2133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_validate_and_convert_cpu_list",
          "args": [],
          "line": 2132
        },
        "resolved": true,
        "details": {
          "function_name": "_validate_and_convert_cpu_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2292-2321",
          "snippet": "static int _validate_and_convert_cpu_list(void)\n{\n\tint core_off, thread_off;\n\n\t/* create CPU bitmap from input CPU list */\n\tif (bit_unfmt(res_cpu_bitmap, conf->cpu_spec_list) != 0) {\n\t\treturn SLURM_ERROR;\n\t}\n\t/* create core bitmap and list from CPU bitmap */\n\tfor (thread_off = 0; thread_off < ncpus; thread_off++) {\n\t\tif (bit_test(res_cpu_bitmap, thread_off) == 1)\n\t\t\tbit_set(res_core_bitmap, thread_off/(conf->threads));\n\t}\n\tbit_fmt(res_abs_cores, sizeof(res_abs_cores), res_core_bitmap);\n\t/* create output abstract CPU list from core bitmap */\n\tfor (core_off = 0; core_off < ncores; core_off++) {\n\t\tif (bit_test(res_core_bitmap, core_off) == 1) {\n\t\t\tfor (thread_off = 0; thread_off < conf->threads;\n\t\t\t     thread_off++)\n\t\t\t\tbit_set(res_cpu_bitmap,\n\t\t\t\t\t(core_off*conf->threads) + thread_off);\n\t\t}\n\t}\n\tbit_fmt(res_abs_cpus, sizeof(res_abs_cpus), res_cpu_bitmap);\n\t/* create output machine CPU list from core list */\n\tif (xcpuinfo_abs_to_mac(res_abs_cores, &res_mac_cpus)\n\t\t   != XCPUINFO_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static bitstr_t\t*res_core_bitmap;",
            "static bitstr_t\t*res_cpu_bitmap;",
            "static char\t*res_abs_cores = NULL;",
            "static char\tres_abs_cpus[MAX_CPUSTR];",
            "static char\t*res_mac_cpus = NULL;",
            "static int\tncores;",
            "static int\tncpus;",
            "static int       _validate_and_convert_cpu_list(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic bitstr_t\t*res_core_bitmap;\nstatic bitstr_t\t*res_cpu_bitmap;\nstatic char\t*res_abs_cores = NULL;\nstatic char\tres_abs_cpus[MAX_CPUSTR];\nstatic char\t*res_mac_cpus = NULL;\nstatic int\tncores;\nstatic int\tncpus;\nstatic int       _validate_and_convert_cpu_list(void);\n\nstatic int _validate_and_convert_cpu_list(void)\n{\n\tint core_off, thread_off;\n\n\t/* create CPU bitmap from input CPU list */\n\tif (bit_unfmt(res_cpu_bitmap, conf->cpu_spec_list) != 0) {\n\t\treturn SLURM_ERROR;\n\t}\n\t/* create core bitmap and list from CPU bitmap */\n\tfor (thread_off = 0; thread_off < ncpus; thread_off++) {\n\t\tif (bit_test(res_cpu_bitmap, thread_off) == 1)\n\t\t\tbit_set(res_core_bitmap, thread_off/(conf->threads));\n\t}\n\tbit_fmt(res_abs_cores, sizeof(res_abs_cores), res_core_bitmap);\n\t/* create output abstract CPU list from core bitmap */\n\tfor (core_off = 0; core_off < ncores; core_off++) {\n\t\tif (bit_test(res_core_bitmap, core_off) == 1) {\n\t\t\tfor (thread_off = 0; thread_off < conf->threads;\n\t\t\t     thread_off++)\n\t\t\t\tbit_set(res_cpu_bitmap,\n\t\t\t\t\t(core_off*conf->threads) + thread_off);\n\t\t}\n\t}\n\tbit_fmt(res_abs_cpus, sizeof(res_abs_cpus), res_cpu_bitmap);\n\t/* create output machine CPU list from core list */\n\tif (xcpuinfo_abs_to_mac(res_abs_cores, &res_mac_cpus)\n\t\t   != XCPUINFO_SUCCESS)\n\t\treturn SLURM_ERROR;\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"Resource spec: configured CPU specialization list: %s\"",
            "conf->cpu_spec_list"
          ],
          "line": 2130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bit_alloc",
          "args": [
            "ncpus"
          ],
          "line": 2125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bit_alloc",
          "args": [
            "ncores"
          ],
          "line": 2124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "ncores * 4 * sizeof(char)"
          ],
          "line": 2123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: cgroup job confinement not configured. \"\n\t\t     \"CoreSpec requires TaskPlugin=task/cgroup and \"\n\t\t     \"ConstrainCores=yes in cgroup.conf\""
          ],
          "line": 2115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_corespec_cgroup_job_confinement",
          "args": [],
          "line": 2114
        },
        "resolved": true,
        "details": {
          "function_name": "check_corespec_cgroup_job_confinement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "478-492",
          "snippet": "extern bool check_corespec_cgroup_job_confinement(void)\n{\n\tchar *task_plugin_type = NULL;\n\tbool status = FALSE;\n\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn FALSE;\n\ttask_plugin_type = slurm_get_task_plugin();\n\tif (slurm_cgroup_conf.constrain_cores &&\n\t    strstr(task_plugin_type, \"cgroup\"))\n\t\tstatus = TRUE;\n\txfree(task_plugin_type);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn status;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static slurm_cgroup_conf_t slurm_cgroup_conf;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic slurm_cgroup_conf_t slurm_cgroup_conf;\n\nextern bool check_corespec_cgroup_job_confinement(void)\n{\n\tchar *task_plugin_type = NULL;\n\tbool status = FALSE;\n\n\tif (read_slurm_cgroup_conf(&slurm_cgroup_conf))\n\t\treturn FALSE;\n\ttask_plugin_type = slurm_get_task_plugin();\n\tif (slurm_cgroup_conf.constrain_cores &&\n\t    strstr(task_plugin_type, \"cgroup\"))\n\t\tstatus = TRUE;\n\txfree(task_plugin_type);\n\tfree_slurm_cgroup_conf(&slurm_cgroup_conf);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"Using core_spec/cray to manage specialized cores\""
          ],
          "line": 2111
        },
        "resolved": true,
        "details": {
          "function_name": "pdebug_stop_current",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/pdebug.c",
          "lines": "120-139",
          "snippet": "void\npdebug_stop_current(stepd_step_rec_t *job)\n{\n\t/*\n\t * Stop the task on exec for TotalView to connect\n\t */\n\tif ( (job->task_flags & TASK_PARALLEL_DEBUG)\n#ifdef BSD\n\t     && (_PTRACE(PT_TRACE_ME, 0, (caddr_t)0, 0) < 0) )\n#elif defined(PT_TRACE_ME)\n\t     && (_PTRACE(PT_TRACE_ME, 0, NULL, 0) < 0) )\n#elif defined(__sun)\n\t     && (_PTRACE(0, 0, NULL, 0) < 0))\n#elif defined(__CYGWIN__)\n\t     && 0)\n#else\n\t     && (_PTRACE(PTRACE_TRACEME, 0, NULL, 0) < 0) )\n#endif\n\t\terror(\"ptrace: %m\");\n}",
          "includes": [
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"pdebug.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"pdebug.h\"\n\nvoid\npdebug_stop_current(stepd_step_rec_t *job)\n{\n\t/*\n\t * Stop the task on exec for TotalView to connect\n\t */\n\tif ( (job->task_flags & TASK_PARALLEL_DEBUG)\n#ifdef BSD\n\t     && (_PTRACE(PT_TRACE_ME, 0, (caddr_t)0, 0) < 0) )\n#elif defined(PT_TRACE_ME)\n\t     && (_PTRACE(PT_TRACE_ME, 0, NULL, 0) < 0) )\n#elif defined(__sun)\n\t     && (_PTRACE(0, 0, NULL, 0) < 0))\n#elif defined(__CYGWIN__)\n\t     && 0)\n#else\n\t     && (_PTRACE(PTRACE_TRACEME, 0, NULL, 0) < 0) )\n#endif\n\t\terror(\"ptrace: %m\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "_is_core_spec_cray",
          "args": [],
          "line": 2110
        },
        "resolved": true,
        "details": {
          "function_name": "_is_core_spec_cray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2088-2096",
          "snippet": "static bool _is_core_spec_cray(void)\n{\n\tbool use_core_spec_cray = false;\n\tchar *core_spec_plugin = slurm_get_core_spec_plugin();\n\tif (core_spec_plugin && strstr(core_spec_plugin, \"cray\"))\n\t\tuse_core_spec_cray = true;\n\txfree(core_spec_plugin);\n\treturn use_core_spec_cray;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool      _is_core_spec_cray(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic bool      _is_core_spec_cray(void);\n\nstatic bool _is_core_spec_cray(void)\n{\n\tbool use_core_spec_cray = false;\n\tchar *core_spec_plugin = slurm_get_core_spec_plugin();\n\tif (core_spec_plugin && strstr(core_spec_plugin, \"cray\"))\n\t\tuse_core_spec_cray = true;\n\txfree(core_spec_plugin);\n\treturn use_core_spec_cray;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic bitstr_t\t*res_core_bitmap;\nstatic bitstr_t\t*res_cpu_bitmap;\nstatic char\t*res_abs_cores = NULL;\nstatic char\tres_abs_cpus[MAX_CPUSTR];\nstatic char\t*res_mac_cpus = NULL;\nstatic int\tncores;\nstatic int\tncpus;\nstatic int       _convert_spec_cores(void);\nstatic int       _core_spec_init(void);\nstatic bool      _is_core_spec_cray(void);\nstatic void      _resource_spec_fini(void);\nstatic void      _select_spec_cores(void);\nstatic int       _validate_and_convert_cpu_list(void);\n\nstatic int _core_spec_init(void)\n{\n\tpid_t pid;\n\n\tif ((conf->core_spec_cnt == 0) && (conf->cpu_spec_list == NULL)) {\n\t\tdebug(\"Resource spec: No specialized cores configured by \"\n\t\t      \"default on this node\");\n\t\treturn SLURM_SUCCESS;\n\t}\n\tif (_is_core_spec_cray()) {\t/* No need to use cgroups */\n\t\tdebug(\"Using core_spec/cray to manage specialized cores\");\n\t\treturn SLURM_SUCCESS;\n\t}\n\tif (!check_corespec_cgroup_job_confinement()) {\n\t\terror(\"Resource spec: cgroup job confinement not configured. \"\n\t\t     \"CoreSpec requires TaskPlugin=task/cgroup and \"\n\t\t     \"ConstrainCores=yes in cgroup.conf\");\n\t\treturn SLURM_ERROR;\n\t}\n\n\tncores = conf->sockets * conf->cores;\n\tncpus = ncores * conf->threads;\n\tres_abs_cores = xmalloc(ncores * 4 * sizeof(char));\n\tres_core_bitmap = bit_alloc(ncores);\n\tres_cpu_bitmap  = bit_alloc(ncpus);\n\tres_abs_cpus[0] = '\\0';\n\n\tif (conf->cpu_spec_list != NULL) {\n\t\t/* CPUSpecList designated in slurm.conf */\n\t\tdebug2(\"Resource spec: configured CPU specialization list: %s\",\n\t\t\tconf->cpu_spec_list);\n\t\tif (_validate_and_convert_cpu_list() != SLURM_SUCCESS) {\n\t\t\terror(\"Resource spec: unable to process CPUSpecList\");\n\t\t\t_resource_spec_fini();\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t} else {\n\t\t/* CoreSpecCount designated in slurm.conf */\n\t\tdebug2(\"Resource spec: configured core specialization \"\n\t\t       \"count: %u\", conf->core_spec_cnt);\n\t\tif (conf->core_spec_cnt >= ncores) {\n\t\t\terror(\"Resource spec: CoreSpecCount too large\");\n\t\t\t_resource_spec_fini();\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t\t_select_spec_cores();\n\t\tif (_convert_spec_cores() != SLURM_SUCCESS) {\n\t\t\terror(\"Resource spec: unable to convert \"\n\t\t\t      \"selected cores to machine CPU IDs\");\n\t\t\t_resource_spec_fini();\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t}\n\tif (init_system_cpuset_cgroup() != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to initialize system \"\n\t\t      \"cpuset cgroup\");\n\t\t_resource_spec_fini();\n\t\treturn SLURM_ERROR;\n\t}\n\tif (set_system_cgroup_cpus(res_mac_cpus) != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to set reserved CPU IDs in \"\n\t\t      \"system cpuset cgroup\");\n\t\t_resource_spec_fini();\n\t\treturn SLURM_ERROR;\n\t}\n\tpid = getpid();\n\tif (attach_system_cpuset_pid(pid) != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to attach slurmd to \"\n\t\t      \"system cpuset cgroup\");\n\t\t_resource_spec_fini();\n\t\treturn SLURM_ERROR;\n\t}\n\tinfo(\"Resource spec: Reserved abstract CPU IDs: %s\", res_abs_cpus);\n\tinfo(\"Resource spec: Reserved machine CPU IDs: %s\", res_mac_cpus);\n\t_resource_spec_fini();\n\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "_is_core_spec_cray",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2088-2096",
    "snippet": "static bool _is_core_spec_cray(void)\n{\n\tbool use_core_spec_cray = false;\n\tchar *core_spec_plugin = slurm_get_core_spec_plugin();\n\tif (core_spec_plugin && strstr(core_spec_plugin, \"cray\"))\n\t\tuse_core_spec_cray = true;\n\txfree(core_spec_plugin);\n\treturn use_core_spec_cray;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static bool      _is_core_spec_cray(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "core_spec_plugin"
          ],
          "line": 2094
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "core_spec_plugin",
            "\"cray\""
          ],
          "line": 2092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_get_core_spec_plugin",
          "args": [],
          "line": 2091
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic bool      _is_core_spec_cray(void);\n\nstatic bool _is_core_spec_cray(void)\n{\n\tbool use_core_spec_cray = false;\n\tchar *core_spec_plugin = slurm_get_core_spec_plugin();\n\tif (core_spec_plugin && strstr(core_spec_plugin, \"cray\"))\n\t\tuse_core_spec_cray = true;\n\txfree(core_spec_plugin);\n\treturn use_core_spec_cray;\n}"
  },
  {
    "function_name": "_resource_spec_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2077-2085",
    "snippet": "static int _resource_spec_init(void)\n{\n\tfini_system_cgroup();\t/* Prevent memory leak */\n\tif (_core_spec_init() != SLURM_SUCCESS)\n\t\terror(\"Resource spec: core specialization disabled\");\n\tif (_memory_spec_init() != SLURM_SUCCESS)\n\t\terror(\"Resource spec: system cgroup memory limit disabled\");\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int       _core_spec_init(void);",
      "static int       _memory_spec_init(void);",
      "static int       _resource_spec_init(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: system cgroup memory limit disabled\""
          ],
          "line": 2083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_memory_spec_init",
          "args": [],
          "line": 2082
        },
        "resolved": true,
        "details": {
          "function_name": "_memory_spec_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2183-2223",
          "snippet": "static int _memory_spec_init(void)\n{\n\tpid_t pid;\n\n\tif (conf->mem_spec_limit == 0) {\n\t\tinfo (\"Resource spec: Reserved system memory limit not \"\n\t\t      \"configured for this node\");\n\t\treturn SLURM_SUCCESS;\n\t}\n\tif (!check_memspec_cgroup_job_confinement()) {\n\t\terror(\"Resource spec: cgroup job confinement not configured. \"\n\t\t      \"MemSpecLimit requires TaskPlugin=task/cgroup and \"\n\t\t      \"ConstrainRAMSpace=yes in cgroup.conf\");\n\t\treturn SLURM_ERROR;\n\t}\n\tif (init_system_memory_cgroup() != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to initialize system \"\n\t\t      \"memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tif (set_system_cgroup_mem_limit(conf->mem_spec_limit)\n\t\t\t!= SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to set memory limit in \"\n\t\t      \"system memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tif (disable_system_cgroup_mem_oom()) {\n\t\terror(\"Resource spec: unable to disable OOM Killer in \"\n\t\t      \"system memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tpid = getpid();\n\tif (attach_system_memory_pid(pid) != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to attach slurmd to \"\n\t\t      \"system memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tinfo(\"Resource spec: system cgroup memory limit set to %u MB\",\n\t     conf->mem_spec_limit);\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static int       _memory_spec_init(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic int       _memory_spec_init(void);\n\nstatic int _memory_spec_init(void)\n{\n\tpid_t pid;\n\n\tif (conf->mem_spec_limit == 0) {\n\t\tinfo (\"Resource spec: Reserved system memory limit not \"\n\t\t      \"configured for this node\");\n\t\treturn SLURM_SUCCESS;\n\t}\n\tif (!check_memspec_cgroup_job_confinement()) {\n\t\terror(\"Resource spec: cgroup job confinement not configured. \"\n\t\t      \"MemSpecLimit requires TaskPlugin=task/cgroup and \"\n\t\t      \"ConstrainRAMSpace=yes in cgroup.conf\");\n\t\treturn SLURM_ERROR;\n\t}\n\tif (init_system_memory_cgroup() != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to initialize system \"\n\t\t      \"memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tif (set_system_cgroup_mem_limit(conf->mem_spec_limit)\n\t\t\t!= SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to set memory limit in \"\n\t\t      \"system memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tif (disable_system_cgroup_mem_oom()) {\n\t\terror(\"Resource spec: unable to disable OOM Killer in \"\n\t\t      \"system memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tpid = getpid();\n\tif (attach_system_memory_pid(pid) != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to attach slurmd to \"\n\t\t      \"system memory cgroup\");\n\t\treturn SLURM_ERROR;\n\t}\n\tinfo(\"Resource spec: system cgroup memory limit set to %u MB\",\n\t     conf->mem_spec_limit);\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Resource spec: core specialization disabled\""
          ],
          "line": 2081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_core_spec_init",
          "args": [],
          "line": 2080
        },
        "resolved": true,
        "details": {
          "function_name": "_core_spec_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2101-2178",
          "snippet": "static int _core_spec_init(void)\n{\n\tpid_t pid;\n\n\tif ((conf->core_spec_cnt == 0) && (conf->cpu_spec_list == NULL)) {\n\t\tdebug(\"Resource spec: No specialized cores configured by \"\n\t\t      \"default on this node\");\n\t\treturn SLURM_SUCCESS;\n\t}\n\tif (_is_core_spec_cray()) {\t/* No need to use cgroups */\n\t\tdebug(\"Using core_spec/cray to manage specialized cores\");\n\t\treturn SLURM_SUCCESS;\n\t}\n\tif (!check_corespec_cgroup_job_confinement()) {\n\t\terror(\"Resource spec: cgroup job confinement not configured. \"\n\t\t     \"CoreSpec requires TaskPlugin=task/cgroup and \"\n\t\t     \"ConstrainCores=yes in cgroup.conf\");\n\t\treturn SLURM_ERROR;\n\t}\n\n\tncores = conf->sockets * conf->cores;\n\tncpus = ncores * conf->threads;\n\tres_abs_cores = xmalloc(ncores * 4 * sizeof(char));\n\tres_core_bitmap = bit_alloc(ncores);\n\tres_cpu_bitmap  = bit_alloc(ncpus);\n\tres_abs_cpus[0] = '\\0';\n\n\tif (conf->cpu_spec_list != NULL) {\n\t\t/* CPUSpecList designated in slurm.conf */\n\t\tdebug2(\"Resource spec: configured CPU specialization list: %s\",\n\t\t\tconf->cpu_spec_list);\n\t\tif (_validate_and_convert_cpu_list() != SLURM_SUCCESS) {\n\t\t\terror(\"Resource spec: unable to process CPUSpecList\");\n\t\t\t_resource_spec_fini();\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t} else {\n\t\t/* CoreSpecCount designated in slurm.conf */\n\t\tdebug2(\"Resource spec: configured core specialization \"\n\t\t       \"count: %u\", conf->core_spec_cnt);\n\t\tif (conf->core_spec_cnt >= ncores) {\n\t\t\terror(\"Resource spec: CoreSpecCount too large\");\n\t\t\t_resource_spec_fini();\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t\t_select_spec_cores();\n\t\tif (_convert_spec_cores() != SLURM_SUCCESS) {\n\t\t\terror(\"Resource spec: unable to convert \"\n\t\t\t      \"selected cores to machine CPU IDs\");\n\t\t\t_resource_spec_fini();\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t}\n\tif (init_system_cpuset_cgroup() != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to initialize system \"\n\t\t      \"cpuset cgroup\");\n\t\t_resource_spec_fini();\n\t\treturn SLURM_ERROR;\n\t}\n\tif (set_system_cgroup_cpus(res_mac_cpus) != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to set reserved CPU IDs in \"\n\t\t      \"system cpuset cgroup\");\n\t\t_resource_spec_fini();\n\t\treturn SLURM_ERROR;\n\t}\n\tpid = getpid();\n\tif (attach_system_cpuset_pid(pid) != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to attach slurmd to \"\n\t\t      \"system cpuset cgroup\");\n\t\t_resource_spec_fini();\n\t\treturn SLURM_ERROR;\n\t}\n\tinfo(\"Resource spec: Reserved abstract CPU IDs: %s\", res_abs_cpus);\n\tinfo(\"Resource spec: Reserved machine CPU IDs: %s\", res_mac_cpus);\n\t_resource_spec_fini();\n\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static bitstr_t\t*res_core_bitmap;",
            "static bitstr_t\t*res_cpu_bitmap;",
            "static char\t*res_abs_cores = NULL;",
            "static char\tres_abs_cpus[MAX_CPUSTR];",
            "static char\t*res_mac_cpus = NULL;",
            "static int\tncores;",
            "static int\tncpus;",
            "static int       _convert_spec_cores(void);",
            "static int       _core_spec_init(void);",
            "static bool      _is_core_spec_cray(void);",
            "static void      _resource_spec_fini(void);",
            "static void      _select_spec_cores(void);",
            "static int       _validate_and_convert_cpu_list(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic bitstr_t\t*res_core_bitmap;\nstatic bitstr_t\t*res_cpu_bitmap;\nstatic char\t*res_abs_cores = NULL;\nstatic char\tres_abs_cpus[MAX_CPUSTR];\nstatic char\t*res_mac_cpus = NULL;\nstatic int\tncores;\nstatic int\tncpus;\nstatic int       _convert_spec_cores(void);\nstatic int       _core_spec_init(void);\nstatic bool      _is_core_spec_cray(void);\nstatic void      _resource_spec_fini(void);\nstatic void      _select_spec_cores(void);\nstatic int       _validate_and_convert_cpu_list(void);\n\nstatic int _core_spec_init(void)\n{\n\tpid_t pid;\n\n\tif ((conf->core_spec_cnt == 0) && (conf->cpu_spec_list == NULL)) {\n\t\tdebug(\"Resource spec: No specialized cores configured by \"\n\t\t      \"default on this node\");\n\t\treturn SLURM_SUCCESS;\n\t}\n\tif (_is_core_spec_cray()) {\t/* No need to use cgroups */\n\t\tdebug(\"Using core_spec/cray to manage specialized cores\");\n\t\treturn SLURM_SUCCESS;\n\t}\n\tif (!check_corespec_cgroup_job_confinement()) {\n\t\terror(\"Resource spec: cgroup job confinement not configured. \"\n\t\t     \"CoreSpec requires TaskPlugin=task/cgroup and \"\n\t\t     \"ConstrainCores=yes in cgroup.conf\");\n\t\treturn SLURM_ERROR;\n\t}\n\n\tncores = conf->sockets * conf->cores;\n\tncpus = ncores * conf->threads;\n\tres_abs_cores = xmalloc(ncores * 4 * sizeof(char));\n\tres_core_bitmap = bit_alloc(ncores);\n\tres_cpu_bitmap  = bit_alloc(ncpus);\n\tres_abs_cpus[0] = '\\0';\n\n\tif (conf->cpu_spec_list != NULL) {\n\t\t/* CPUSpecList designated in slurm.conf */\n\t\tdebug2(\"Resource spec: configured CPU specialization list: %s\",\n\t\t\tconf->cpu_spec_list);\n\t\tif (_validate_and_convert_cpu_list() != SLURM_SUCCESS) {\n\t\t\terror(\"Resource spec: unable to process CPUSpecList\");\n\t\t\t_resource_spec_fini();\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t} else {\n\t\t/* CoreSpecCount designated in slurm.conf */\n\t\tdebug2(\"Resource spec: configured core specialization \"\n\t\t       \"count: %u\", conf->core_spec_cnt);\n\t\tif (conf->core_spec_cnt >= ncores) {\n\t\t\terror(\"Resource spec: CoreSpecCount too large\");\n\t\t\t_resource_spec_fini();\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t\t_select_spec_cores();\n\t\tif (_convert_spec_cores() != SLURM_SUCCESS) {\n\t\t\terror(\"Resource spec: unable to convert \"\n\t\t\t      \"selected cores to machine CPU IDs\");\n\t\t\t_resource_spec_fini();\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t}\n\tif (init_system_cpuset_cgroup() != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to initialize system \"\n\t\t      \"cpuset cgroup\");\n\t\t_resource_spec_fini();\n\t\treturn SLURM_ERROR;\n\t}\n\tif (set_system_cgroup_cpus(res_mac_cpus) != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to set reserved CPU IDs in \"\n\t\t      \"system cpuset cgroup\");\n\t\t_resource_spec_fini();\n\t\treturn SLURM_ERROR;\n\t}\n\tpid = getpid();\n\tif (attach_system_cpuset_pid(pid) != SLURM_SUCCESS) {\n\t\terror(\"Resource spec: unable to attach slurmd to \"\n\t\t      \"system cpuset cgroup\");\n\t\t_resource_spec_fini();\n\t\treturn SLURM_ERROR;\n\t}\n\tinfo(\"Resource spec: Reserved abstract CPU IDs: %s\", res_abs_cpus);\n\tinfo(\"Resource spec: Reserved machine CPU IDs: %s\", res_mac_cpus);\n\t_resource_spec_fini();\n\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fini_system_cgroup",
          "args": [],
          "line": 2079
        },
        "resolved": true,
        "details": {
          "function_name": "fini_system_cgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "299-305",
          "snippet": "extern void fini_system_cgroup(void)\n{\n\txcgroup_destroy(&system_cpuset_cg);\n\txcgroup_destroy(&system_memory_cg);\n\txcgroup_ns_destroy(&cpuset_ns);\n\txcgroup_ns_destroy(&memory_ns);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
            "static xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
            "static xcgroup_ns_t cpuset_ns = {NULL, NULL, NULL, NULL};",
            "static xcgroup_ns_t memory_ns = {NULL, NULL, NULL, NULL};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic xcgroup_ns_t cpuset_ns = {NULL, NULL, NULL, NULL};\nstatic xcgroup_ns_t memory_ns = {NULL, NULL, NULL, NULL};\n\nextern void fini_system_cgroup(void)\n{\n\txcgroup_destroy(&system_cpuset_cg);\n\txcgroup_destroy(&system_memory_cg);\n\txcgroup_ns_destroy(&cpuset_ns);\n\txcgroup_ns_destroy(&memory_ns);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic int       _core_spec_init(void);\nstatic int       _memory_spec_init(void);\nstatic int       _resource_spec_init(void);\n\nstatic int _resource_spec_init(void)\n{\n\tfini_system_cgroup();\t/* Prevent memory leak */\n\tif (_core_spec_init() != SLURM_SUCCESS)\n\t\terror(\"Resource spec: core specialization disabled\");\n\tif (_memory_spec_init() != SLURM_SUCCESS)\n\t\terror(\"Resource spec: system cgroup memory limit disabled\");\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "_set_msg_aggr_params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2056-2072",
    "snippet": "static void _set_msg_aggr_params(void)\n{\n\tconf->msg_aggr_window_time = _parse_msg_aggr_params(WINDOW_TIME,\n\t\t\t       conf->msg_aggr_params);\n\tconf->msg_aggr_window_msgs = _parse_msg_aggr_params(WINDOW_MSGS,\n\t\t\t       conf->msg_aggr_params);\n\n\tif (conf->msg_aggr_window_time == NO_VAL)\n\t\tconf->msg_aggr_window_time = DEFAULT_MSG_AGGR_WINDOW_TIME;\n\tif (conf->msg_aggr_window_msgs == NO_VAL)\n\t\tconf->msg_aggr_window_msgs = DEFAULT_MSG_AGGR_WINDOW_MSGS;\n\tif (conf->msg_aggr_window_msgs > 1) {\n\t\tinfo(\"Message aggregation enabled: WindowMsgs=%\"PRIu64\", WindowTime=%\"PRIu64,\n\t\t     conf->msg_aggr_window_msgs, conf->msg_aggr_window_time);\n\t} else\n\t\tinfo(\"Message aggregation disabled\");\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _set_msg_aggr_params(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Message aggregation disabled\""
          ],
          "line": 2071
        },
        "resolved": true,
        "details": {
          "function_name": "_free_file_bcast_info_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "3642-3648",
          "snippet": "static void _free_file_bcast_info_t(file_bcast_info_t *f)\n{\n\txfree(f->fname);\n\tif (f->fd)\n\t\tclose(f->fd);\n\txfree(f);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic void _free_file_bcast_info_t(file_bcast_info_t *f)\n{\n\txfree(f->fname);\n\tif (f->fd)\n\t\tclose(f->fd);\n\txfree(f);\n}"
        }
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Message aggregation enabled: WindowMsgs=%\"PRIu64\", WindowTime=%\"PRIu64",
            "conf->msg_aggr_window_msgs",
            "conf->msg_aggr_window_time"
          ],
          "line": 2068
        },
        "resolved": true,
        "details": {
          "function_name": "_chk_cpuinfo_float",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "414-423",
          "snippet": "static int _chk_cpuinfo_float(char *buffer, char *keyword, float *val)\n{\n\tchar *valptr;\n\tif (_chk_cpuinfo_str(buffer, keyword, &valptr)) {\n\t\t*val = (float) strtod(valptr, (char **)NULL);\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nstatic int _chk_cpuinfo_float(char *buffer, char *keyword, float *val)\n{\n\tchar *valptr;\n\tif (_chk_cpuinfo_str(buffer, keyword, &valptr)) {\n\t\t*val = (float) strtod(valptr, (char **)NULL);\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "_parse_msg_aggr_params",
          "args": [
            "WINDOW_MSGS",
            "conf->msg_aggr_params"
          ],
          "line": 2060
        },
        "resolved": true,
        "details": {
          "function_name": "_parse_msg_aggr_params",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2033-2054",
          "snippet": "static uint64_t _parse_msg_aggr_params(int type, char *params)\n{\n\tuint64_t value = NO_VAL;\n\tchar *sub_str = NULL;\n\n\tif (!params)\n\t\treturn NO_VAL;\n\n\tswitch (type) {\n\tcase WINDOW_TIME:\n\t\tif ((sub_str = slurm_strcasestr(params, \"WindowTime=\")))\n\t\t\tvalue = _get_int(sub_str + 11);\n\t\tbreak;\n\tcase WINDOW_MSGS:\n\t\tif ((sub_str = slurm_strcasestr(params, \"WindowMsgs=\")))\n\t\t\tvalue = _get_int(sub_str + 11);\n\t\tbreak;\n\tdefault:\n\t\tfatal(\"invalid message aggregation parameters: %s\", params);\n\t}\n\treturn value;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static uint64_t  _parse_msg_aggr_params(int type, char *params);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic uint64_t  _parse_msg_aggr_params(int type, char *params);\n\nstatic uint64_t _parse_msg_aggr_params(int type, char *params)\n{\n\tuint64_t value = NO_VAL;\n\tchar *sub_str = NULL;\n\n\tif (!params)\n\t\treturn NO_VAL;\n\n\tswitch (type) {\n\tcase WINDOW_TIME:\n\t\tif ((sub_str = slurm_strcasestr(params, \"WindowTime=\")))\n\t\t\tvalue = _get_int(sub_str + 11);\n\t\tbreak;\n\tcase WINDOW_MSGS:\n\t\tif ((sub_str = slurm_strcasestr(params, \"WindowMsgs=\")))\n\t\t\tvalue = _get_int(sub_str + 11);\n\t\tbreak;\n\tdefault:\n\t\tfatal(\"invalid message aggregation parameters: %s\", params);\n\t}\n\treturn value;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _set_msg_aggr_params(void);\n\nstatic void _set_msg_aggr_params(void)\n{\n\tconf->msg_aggr_window_time = _parse_msg_aggr_params(WINDOW_TIME,\n\t\t\t       conf->msg_aggr_params);\n\tconf->msg_aggr_window_msgs = _parse_msg_aggr_params(WINDOW_MSGS,\n\t\t\t       conf->msg_aggr_params);\n\n\tif (conf->msg_aggr_window_time == NO_VAL)\n\t\tconf->msg_aggr_window_time = DEFAULT_MSG_AGGR_WINDOW_TIME;\n\tif (conf->msg_aggr_window_msgs == NO_VAL)\n\t\tconf->msg_aggr_window_msgs = DEFAULT_MSG_AGGR_WINDOW_MSGS;\n\tif (conf->msg_aggr_window_msgs > 1) {\n\t\tinfo(\"Message aggregation enabled: WindowMsgs=%\"PRIu64\", WindowTime=%\"PRIu64,\n\t\t     conf->msg_aggr_window_msgs, conf->msg_aggr_window_time);\n\t} else\n\t\tinfo(\"Message aggregation disabled\");\n}"
  },
  {
    "function_name": "_parse_msg_aggr_params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2033-2054",
    "snippet": "static uint64_t _parse_msg_aggr_params(int type, char *params)\n{\n\tuint64_t value = NO_VAL;\n\tchar *sub_str = NULL;\n\n\tif (!params)\n\t\treturn NO_VAL;\n\n\tswitch (type) {\n\tcase WINDOW_TIME:\n\t\tif ((sub_str = slurm_strcasestr(params, \"WindowTime=\")))\n\t\t\tvalue = _get_int(sub_str + 11);\n\t\tbreak;\n\tcase WINDOW_MSGS:\n\t\tif ((sub_str = slurm_strcasestr(params, \"WindowMsgs=\")))\n\t\t\tvalue = _get_int(sub_str + 11);\n\t\tbreak;\n\tdefault:\n\t\tfatal(\"invalid message aggregation parameters: %s\", params);\n\t}\n\treturn value;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static uint64_t  _parse_msg_aggr_params(int type, char *params);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"invalid message aggregation parameters: %s\"",
            "params"
          ],
          "line": 2051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_get_int",
          "args": [
            "sub_str + 11"
          ],
          "line": 2048
        },
        "resolved": true,
        "details": {
          "function_name": "_get_int",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2020-2031",
          "snippet": "static uint64_t _get_int(const char *my_str)\n{\n\tchar *end = NULL;\n\tuint64_t value;\n\n\tif (!my_str)\n\t\treturn NO_VAL;\n\tvalue = strtol(my_str, &end, 10);\n\tif (my_str == end)\n\t\treturn NO_VAL;\n\treturn value;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static uint64_t  _get_int(const char *my_str);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic uint64_t  _get_int(const char *my_str);\n\nstatic uint64_t _get_int(const char *my_str)\n{\n\tchar *end = NULL;\n\tuint64_t value;\n\n\tif (!my_str)\n\t\treturn NO_VAL;\n\tvalue = strtol(my_str, &end, 10);\n\tif (my_str == end)\n\t\treturn NO_VAL;\n\treturn value;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_strcasestr",
          "args": [
            "params",
            "\"WindowMsgs=\""
          ],
          "line": 2047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_strcasestr",
          "args": [
            "params",
            "\"WindowTime=\""
          ],
          "line": 2043
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic uint64_t  _parse_msg_aggr_params(int type, char *params);\n\nstatic uint64_t _parse_msg_aggr_params(int type, char *params)\n{\n\tuint64_t value = NO_VAL;\n\tchar *sub_str = NULL;\n\n\tif (!params)\n\t\treturn NO_VAL;\n\n\tswitch (type) {\n\tcase WINDOW_TIME:\n\t\tif ((sub_str = slurm_strcasestr(params, \"WindowTime=\")))\n\t\t\tvalue = _get_int(sub_str + 11);\n\t\tbreak;\n\tcase WINDOW_MSGS:\n\t\tif ((sub_str = slurm_strcasestr(params, \"WindowMsgs=\")))\n\t\t\tvalue = _get_int(sub_str + 11);\n\t\tbreak;\n\tdefault:\n\t\tfatal(\"invalid message aggregation parameters: %s\", params);\n\t}\n\treturn value;\n}"
  },
  {
    "function_name": "_get_int",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2020-2031",
    "snippet": "static uint64_t _get_int(const char *my_str)\n{\n\tchar *end = NULL;\n\tuint64_t value;\n\n\tif (!my_str)\n\t\treturn NO_VAL;\n\tvalue = strtol(my_str, &end, 10);\n\tif (my_str == end)\n\t\treturn NO_VAL;\n\treturn value;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static uint64_t  _get_int(const char *my_str);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "my_str",
            "&end",
            "10"
          ],
          "line": 2027
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic uint64_t  _get_int(const char *my_str);\n\nstatic uint64_t _get_int(const char *my_str)\n{\n\tchar *end = NULL;\n\tuint64_t value;\n\n\tif (!my_str)\n\t\treturn NO_VAL;\n\tvalue = strtol(my_str, &end, 10);\n\tif (my_str == end)\n\t\treturn NO_VAL;\n\treturn value;\n}"
  },
  {
    "function_name": "_set_topo_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "2004-2018",
    "snippet": "static int _set_topo_info(void)\n{\n\tint rc;\n\tchar * addr, * pattern;\n\n\trc = slurm_topo_get_node_addr(conf->node_name, &addr, &pattern);\n\tif ( rc == SLURM_SUCCESS ) {\n\t\txfree(conf->node_topo_addr);\n\t\txfree(conf->node_topo_pattern);\n\t\tconf->node_topo_addr = addr;\n\t\tconf->node_topo_pattern = pattern;\n\t}\n\n\treturn rc;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static int       _set_topo_info(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "conf->node_topo_pattern"
          ],
          "line": 2012
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_topo_get_node_addr",
          "args": [
            "conf->node_name",
            "&addr",
            "&pattern"
          ],
          "line": 2009
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic int       _set_topo_info(void);\n\nstatic int _set_topo_info(void)\n{\n\tint rc;\n\tchar * addr, * pattern;\n\n\trc = slurm_topo_get_node_addr(conf->node_name, &addr, &pattern);\n\tif ( rc == SLURM_SUCCESS ) {\n\t\txfree(conf->node_topo_addr);\n\t\txfree(conf->node_topo_pattern);\n\t\tconf->node_topo_addr = addr;\n\t\tconf->node_topo_pattern = pattern;\n\t}\n\n\treturn rc;\n}"
  },
  {
    "function_name": "_install_fork_handlers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1991-1999",
    "snippet": "static void _install_fork_handlers(void)\n{\n\tint err;\n\n\terr = pthread_atfork(&_atfork_prepare, &_atfork_final, &_atfork_final);\n\tif (err) error (\"pthread_atfork: %m\");\n\n\treturn;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void      _atfork_final(void);",
      "static void      _atfork_prepare(void);",
      "static void      _install_fork_handlers(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"pthread_atfork: %m\""
          ],
          "line": 1996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_atfork",
          "args": [
            "&_atfork_prepare",
            "&_atfork_final",
            "&_atfork_final"
          ],
          "line": 1995
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic void      _atfork_final(void);\nstatic void      _atfork_prepare(void);\nstatic void      _install_fork_handlers(void);\n\nstatic void _install_fork_handlers(void)\n{\n\tint err;\n\n\terr = pthread_atfork(&_atfork_prepare, &_atfork_final, &_atfork_final);\n\tif (err) error (\"pthread_atfork: %m\");\n\n\treturn;\n}"
  },
  {
    "function_name": "_atfork_final",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1986-1989",
    "snippet": "static void _atfork_final(void)\n{\n\tslurm_mutex_unlock(&fork_mutex);\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static pthread_mutex_t fork_mutex     = PTHREAD_MUTEX_INITIALIZER;",
      "static void      _atfork_final(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "slurm_mutex_unlock",
          "args": [
            "&fork_mutex"
          ],
          "line": 1988
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic pthread_mutex_t fork_mutex     = PTHREAD_MUTEX_INITIALIZER;\nstatic void      _atfork_final(void);\n\nstatic void _atfork_final(void)\n{\n\tslurm_mutex_unlock(&fork_mutex);\n}"
  },
  {
    "function_name": "_atfork_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1978-1981",
    "snippet": "static void _atfork_prepare(void)\n{\n\tslurm_mutex_lock(&fork_mutex);\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static pthread_mutex_t fork_mutex     = PTHREAD_MUTEX_INITIALIZER;",
      "static void      _atfork_prepare(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "slurm_mutex_lock",
          "args": [
            "&fork_mutex"
          ],
          "line": 1980
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic pthread_mutex_t fork_mutex     = PTHREAD_MUTEX_INITIALIZER;\nstatic void      _atfork_prepare(void);\n\nstatic void _atfork_prepare(void)\n{\n\tslurm_mutex_lock(&fork_mutex);\n}"
  },
  {
    "function_name": "_update_nice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1959-1973",
    "snippet": "static void _update_nice(void)\n{\n\tint cur_nice;\n\tid_t pid;\n\n\tif (conf->nice == 0)\t/* No change */\n\t\treturn;\n\n\tpid = getpid();\n\tcur_nice = getpriority(PRIO_PROCESS, pid);\n\tif (cur_nice == conf->nice)\n\t\treturn;\n\tif (setpriority(PRIO_PROCESS, pid, conf->nice))\n\t\terror(\"Unable to reset nice value to %d: %m\", conf->nice);\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _update_nice(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Unable to reset nice value to %d: %m\"",
            "conf->nice"
          ],
          "line": 1972
        },
        "resolved": true,
        "details": {
          "function_name": "_prolog_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "1386-1434",
          "snippet": "static void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _is_batch_job_finished(uint32_t job_id);",
            "static bool _job_still_running(uint32_t job_id);",
            "static void _launch_complete_add(uint32_t job_id);",
            "static void _launch_complete_log(char *type, uint32_t job_id);",
            "static void _launch_complete_rm(uint32_t job_id);",
            "static void _launch_complete_wait(uint32_t job_id);",
            "static bool _launch_job_test(uint32_t job_id);",
            "static void _note_batch_job_finished(uint32_t job_id);",
            "static bool _slurm_authorized_user(uid_t uid);",
            "static void _sync_messages_kill(kill_job_msg_t *req);",
            "static int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);",
            "static gids_t *_gids_cache_lookup(char *user, gid_t gid);",
            "static int  _add_starting_step(uint16_t type, void *req);",
            "static int  _remove_starting_step(uint16_t type, void *req);",
            "static void _add_job_running_prolog(uint32_t job_id);",
            "static void _remove_job_running_prolog(uint32_t job_id);",
            "static void _wait_for_job_running_prolog(uint32_t job_id);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic bool _is_batch_job_finished(uint32_t job_id);\nstatic bool _job_still_running(uint32_t job_id);\nstatic void _launch_complete_add(uint32_t job_id);\nstatic void _launch_complete_log(char *type, uint32_t job_id);\nstatic void _launch_complete_rm(uint32_t job_id);\nstatic void _launch_complete_wait(uint32_t job_id);\nstatic bool _launch_job_test(uint32_t job_id);\nstatic void _note_batch_job_finished(uint32_t job_id);\nstatic bool _slurm_authorized_user(uid_t uid);\nstatic void _sync_messages_kill(kill_job_msg_t *req);\nstatic int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);\nstatic gids_t *_gids_cache_lookup(char *user, gid_t gid);\nstatic int  _add_starting_step(uint16_t type, void *req);\nstatic int  _remove_starting_step(uint16_t type, void *req);\nstatic void _add_job_running_prolog(uint32_t job_id);\nstatic void _remove_job_running_prolog(uint32_t job_id);\nstatic void _wait_for_job_running_prolog(uint32_t job_id);\n\nstatic void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "setpriority",
          "args": [
            "PRIO_PROCESS",
            "pid",
            "conf->nice"
          ],
          "line": 1971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpriority",
          "args": [
            "PRIO_PROCESS",
            "pid"
          ],
          "line": 1968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 1967
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _update_nice(void);\n\nstatic void _update_nice(void)\n{\n\tint cur_nice;\n\tid_t pid;\n\n\tif (conf->nice == 0)\t/* No change */\n\t\treturn;\n\n\tpid = getpid();\n\tcur_nice = getpriority(PRIO_PROCESS, pid);\n\tif (cur_nice == conf->nice)\n\t\treturn;\n\tif (setpriority(PRIO_PROCESS, pid, conf->nice))\n\t\terror(\"Unable to reset nice value to %d: %m\", conf->nice);\n}"
  },
  {
    "function_name": "_update_logging",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1911-1956",
    "snippet": "static void _update_logging(void)\n{\n\tlog_options_t *o = &conf->log_opts;\n\tslurm_ctl_conf_t *cf;\n\n\t/* Preserve execute line verbose arguments (if any) */\n\tcf = slurm_conf_lock();\n\tif (!conf->debug_level_set && (cf->slurmd_debug != (uint16_t) NO_VAL))\n\t\tconf->debug_level = cf->slurmd_debug;\n\tconf->log_fmt = cf->log_fmt;\n\tslurm_conf_unlock();\n\n\to->stderr_level  = conf->debug_level;\n\to->logfile_level = conf->debug_level;\n\to->syslog_level  = conf->debug_level;\n\n\t/*\n\t * If daemonizing, turn off stderr logging -- also, if\n\t * logging to a file, turn off syslog.\n\t *\n\t * Otherwise, if remaining in foreground, turn off logging\n\t * to syslog (but keep logfile level)\n\t */\n\tif (conf->daemonize) {\n\t\to->stderr_level = LOG_LEVEL_QUIET;\n\t\tif (conf->logfile)\n\t\t\to->syslog_level = LOG_LEVEL_FATAL;\n\t} else\n\t\to->syslog_level  = LOG_LEVEL_QUIET;\n\n\tlog_alter(conf->log_opts, SYSLOG_FACILITY_DAEMON, conf->logfile);\n\tlog_set_timefmt(conf->log_fmt);\n\n\t/* If logging to syslog and running in\n\t * MULTIPLE_SLURMD mode add my node_name\n\t * in the name tag for syslog.\n\t */\n#if defined(MULTIPLE_SLURMD)\n\tif (conf->logfile == NULL) {\n\t\tchar buf[64];\n\n\t\tsnprintf(buf, sizeof(buf), \"slurmd-%s\", conf->node_name);\n\t\tlog_set_argv0(buf);\n\t}\n#endif\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _update_logging(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_set_argv0",
          "args": [
            "buf"
          ],
          "line": 1953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"slurmd-%s\"",
            "conf->node_name"
          ],
          "line": 1952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_set_timefmt",
          "args": [
            "conf->log_fmt"
          ],
          "line": 1942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_alter",
          "args": [
            "conf->log_opts",
            "SYSLOG_FACILITY_DAEMON",
            "conf->logfile"
          ],
          "line": 1941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_conf_unlock",
          "args": [],
          "line": 1921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_conf_lock",
          "args": [],
          "line": 1917
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _update_logging(void);\n\nstatic void _update_logging(void)\n{\n\tlog_options_t *o = &conf->log_opts;\n\tslurm_ctl_conf_t *cf;\n\n\t/* Preserve execute line verbose arguments (if any) */\n\tcf = slurm_conf_lock();\n\tif (!conf->debug_level_set && (cf->slurmd_debug != (uint16_t) NO_VAL))\n\t\tconf->debug_level = cf->slurmd_debug;\n\tconf->log_fmt = cf->log_fmt;\n\tslurm_conf_unlock();\n\n\to->stderr_level  = conf->debug_level;\n\to->logfile_level = conf->debug_level;\n\to->syslog_level  = conf->debug_level;\n\n\t/*\n\t * If daemonizing, turn off stderr logging -- also, if\n\t * logging to a file, turn off syslog.\n\t *\n\t * Otherwise, if remaining in foreground, turn off logging\n\t * to syslog (but keep logfile level)\n\t */\n\tif (conf->daemonize) {\n\t\to->stderr_level = LOG_LEVEL_QUIET;\n\t\tif (conf->logfile)\n\t\t\to->syslog_level = LOG_LEVEL_FATAL;\n\t} else\n\t\to->syslog_level  = LOG_LEVEL_QUIET;\n\n\tlog_alter(conf->log_opts, SYSLOG_FACILITY_DAEMON, conf->logfile);\n\tlog_set_timefmt(conf->log_fmt);\n\n\t/* If logging to syslog and running in\n\t * MULTIPLE_SLURMD mode add my node_name\n\t * in the name tag for syslog.\n\t */\n#if defined(MULTIPLE_SLURMD)\n\tif (conf->logfile == NULL) {\n\t\tchar buf[64];\n\n\t\tsnprintf(buf, sizeof(buf), \"slurmd-%s\", conf->node_name);\n\t\tlog_set_argv0(buf);\n\t}\n#endif\n}"
  },
  {
    "function_name": "_kill_old_slurmd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1890-1908",
    "snippet": "static void\n_kill_old_slurmd(void)\n{\n\tint fd;\n\tpid_t oldpid = read_pidfile(conf->pidfile, &fd);\n\tif (oldpid != (pid_t) 0) {\n\t\tinfo (\"killing old slurmd[%lu]\", (unsigned long) oldpid);\n\t\tkill(oldpid, SIGTERM);\n\n\t\t/*\n\t\t * Wait for previous daemon to terminate\n\t\t */\n\t\tif (fd_get_readw_lock(fd) < 0) {\n\t\t\tfatal (\"error getting readw lock on file %s: %m\",\n\t\t\t       conf->pidfile);\n\t\t}\n\t\t(void) close(fd); /* Ignore errors */\n\t}\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _kill_old_slurmd(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 1906
        },
        "resolved": true,
        "details": {
          "function_name": "_file_bcast_close_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "3635-3640",
          "snippet": "static void _file_bcast_close_file(file_bcast_info_t *key)\n{\n\t_fb_wrlock();\n\tlist_delete_all(file_bcast_list, _bcast_find_in_list, key);\n\t_fb_wrunlock();\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int  _job_limits_match(void *x, void *key);",
            "static int  _step_limits_match(void *x, void *key);",
            "static int  _file_bcast_register_file(slurm_msg_t *msg,\n\t\t\t\t      file_bcast_info_t *key);",
            "static List file_bcast_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic int  _job_limits_match(void *x, void *key);\nstatic int  _step_limits_match(void *x, void *key);\nstatic int  _file_bcast_register_file(slurm_msg_t *msg,\n\t\t\t\t      file_bcast_info_t *key);\nstatic List file_bcast_list = NULL;\n\nstatic void _file_bcast_close_file(file_bcast_info_t *key)\n{\n\t_fb_wrlock();\n\tlist_delete_all(file_bcast_list, _bcast_find_in_list, key);\n\t_fb_wrunlock();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"error getting readw lock on file %s: %m\"",
            "conf->pidfile"
          ],
          "line": 1903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fd_get_readw_lock",
          "args": [
            "fd"
          ],
          "line": 1902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kill",
          "args": [
            "oldpid",
            "SIGTERM"
          ],
          "line": 1897
        },
        "resolved": true,
        "details": {
          "function_name": "_delay_kill_thread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/mgr.c",
          "lines": "2124-2144",
          "snippet": "static void _delay_kill_thread(pthread_t thread_id, int secs)\n{\n\tpthread_t kill_id;\n\tpthread_attr_t attr;\n\tkill_thread_t *kt = xmalloc(sizeof(kill_thread_t));\n\tint retries = 0;\n\n\tkt->thread_id = thread_id;\n\tkt->secs = secs;\n\tslurm_attr_init(&attr);\n\tpthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);\n\twhile (pthread_create(&kill_id, &attr, &_kill_thr, (void *) kt)) {\n\t\terror(\"_delay_kill_thread: pthread_create: %m\");\n\t\tif (++retries > MAX_RETRIES) {\n\t\t\terror(\"_delay_kill_thread: Can't create pthread\");\n\t\t\tbreak;\n\t\t}\n\t\tusleep(10);\t/* sleep and again */\n\t}\n\tslurm_attr_destroy(&attr);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/ulimits.h\"",
            "#include \"src/slurmd/slurmstepd/pam_ses.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmstepd/task.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/reverse_tree.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/slurm_mpi.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/safeopen.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#    include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <pthread.h>",
            "#include <poll.h>",
            "#include <grp.h>",
            "#  include \"src/common/unsetenv.h\"",
            "#  include <sys/checkpnt.h>",
            "#  include <sys/prctl.h>",
            "#  include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/ulimits.h\"\n#include \"src/slurmd/slurmstepd/pam_ses.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmstepd/task.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/reverse_tree.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/slurm_mpi.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/safeopen.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/cbuf.h\"\n#include \"slurm/slurm_errno.h\"\n#    include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <string.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <pthread.h>\n#include <poll.h>\n#include <grp.h>\n#  include \"src/common/unsetenv.h\"\n#  include <sys/checkpnt.h>\n#  include <sys/prctl.h>\n#  include <sys/types.h>\n#  include \"config.h\"\n\nstatic void _delay_kill_thread(pthread_t thread_id, int secs)\n{\n\tpthread_t kill_id;\n\tpthread_attr_t attr;\n\tkill_thread_t *kt = xmalloc(sizeof(kill_thread_t));\n\tint retries = 0;\n\n\tkt->thread_id = thread_id;\n\tkt->secs = secs;\n\tslurm_attr_init(&attr);\n\tpthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);\n\twhile (pthread_create(&kill_id, &attr, &_kill_thr, (void *) kt)) {\n\t\terror(\"_delay_kill_thread: pthread_create: %m\");\n\t\tif (++retries > MAX_RETRIES) {\n\t\t\terror(\"_delay_kill_thread: Can't create pthread\");\n\t\t\tbreak;\n\t\t}\n\t\tusleep(10);\t/* sleep and again */\n\t}\n\tslurm_attr_destroy(&attr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"killing old slurmd[%lu]\"",
            "(unsigned long) oldpid"
          ],
          "line": 1896
        },
        "resolved": true,
        "details": {
          "function_name": "_task_info_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/slurmstepd_job.c",
          "lines": "222-232",
          "snippet": "static void\n_task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog)\n{\n\tslurm_mutex_lock(&t->mutex);\n\tslurm_mutex_unlock(&t->mutex);\n\tslurm_mutex_destroy(&t->mutex);\n\tif (multi_prog) {\n\t\txfree(t->argv);\n\t} /* otherwise, t->argv is a pointer to job->argv */\n\txfree(t);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmstepd/multi_prog.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <grp.h>",
            "#  include <string.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void _task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmstepd/multi_prog.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <grp.h>\n#  include <string.h>\n#  include \"config.h\"\n\nstatic void _task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog);\n\nstatic void\n_task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog)\n{\n\tslurm_mutex_lock(&t->mutex);\n\tslurm_mutex_unlock(&t->mutex);\n\tslurm_mutex_destroy(&t->mutex);\n\tif (multi_prog) {\n\t\txfree(t->argv);\n\t} /* otherwise, t->argv is a pointer to job->argv */\n\txfree(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "read_pidfile",
          "args": [
            "conf->pidfile",
            "&fd"
          ],
          "line": 1894
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _kill_old_slurmd(void);\n\nstatic void\n_kill_old_slurmd(void)\n{\n\tint fd;\n\tpid_t oldpid = read_pidfile(conf->pidfile, &fd);\n\tif (oldpid != (pid_t) 0) {\n\t\tinfo (\"killing old slurmd[%lu]\", (unsigned long) oldpid);\n\t\tkill(oldpid, SIGTERM);\n\n\t\t/*\n\t\t * Wait for previous daemon to terminate\n\t\t */\n\t\tif (fd_get_readw_lock(fd) < 0) {\n\t\t\tfatal (\"error getting readw lock on file %s: %m\",\n\t\t\t       conf->pidfile);\n\t\t}\n\t\t(void) close(fd); /* Ignore errors */\n\t}\n}"
  },
  {
    "function_name": "_set_slurmd_spooldir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1862-1883",
    "snippet": "static int\n_set_slurmd_spooldir(void)\n{\n\tdebug3(\"initializing slurmd spool directory\");\n\n\tif (mkdir(conf->spooldir, 0755) < 0) {\n\t\tif (errno != EEXIST) {\n\t\t\tfatal(\"mkdir(%s): %m\", conf->spooldir);\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t}\n\n\t/*\n\t * Ensure spool directory permissions are correct.\n\t */\n\tif (chmod(conf->spooldir, 0755) < 0) {\n\t\terror(\"chmod(%s, 0755): %m\", conf->spooldir);\n\t\treturn SLURM_ERROR;\n\t}\n\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static int       _set_slurmd_spooldir(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"chmod(%s, 0755): %m\"",
            "conf->spooldir"
          ],
          "line": 1878
        },
        "resolved": true,
        "details": {
          "function_name": "_prolog_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "1386-1434",
          "snippet": "static void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _is_batch_job_finished(uint32_t job_id);",
            "static bool _job_still_running(uint32_t job_id);",
            "static void _launch_complete_add(uint32_t job_id);",
            "static void _launch_complete_log(char *type, uint32_t job_id);",
            "static void _launch_complete_rm(uint32_t job_id);",
            "static void _launch_complete_wait(uint32_t job_id);",
            "static bool _launch_job_test(uint32_t job_id);",
            "static void _note_batch_job_finished(uint32_t job_id);",
            "static bool _slurm_authorized_user(uid_t uid);",
            "static void _sync_messages_kill(kill_job_msg_t *req);",
            "static int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);",
            "static gids_t *_gids_cache_lookup(char *user, gid_t gid);",
            "static int  _add_starting_step(uint16_t type, void *req);",
            "static int  _remove_starting_step(uint16_t type, void *req);",
            "static void _add_job_running_prolog(uint32_t job_id);",
            "static void _remove_job_running_prolog(uint32_t job_id);",
            "static void _wait_for_job_running_prolog(uint32_t job_id);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic bool _is_batch_job_finished(uint32_t job_id);\nstatic bool _job_still_running(uint32_t job_id);\nstatic void _launch_complete_add(uint32_t job_id);\nstatic void _launch_complete_log(char *type, uint32_t job_id);\nstatic void _launch_complete_rm(uint32_t job_id);\nstatic void _launch_complete_wait(uint32_t job_id);\nstatic bool _launch_job_test(uint32_t job_id);\nstatic void _note_batch_job_finished(uint32_t job_id);\nstatic bool _slurm_authorized_user(uid_t uid);\nstatic void _sync_messages_kill(kill_job_msg_t *req);\nstatic int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);\nstatic gids_t *_gids_cache_lookup(char *user, gid_t gid);\nstatic int  _add_starting_step(uint16_t type, void *req);\nstatic int  _remove_starting_step(uint16_t type, void *req);\nstatic void _add_job_running_prolog(uint32_t job_id);\nstatic void _remove_job_running_prolog(uint32_t job_id);\nstatic void _wait_for_job_running_prolog(uint32_t job_id);\n\nstatic void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "chmod",
          "args": [
            "conf->spooldir",
            "0755"
          ],
          "line": 1877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"mkdir(%s): %m\"",
            "conf->spooldir"
          ],
          "line": 1869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mkdir",
          "args": [
            "conf->spooldir",
            "0755"
          ],
          "line": 1867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"initializing slurmd spool directory\""
          ],
          "line": 1865
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic int       _set_slurmd_spooldir(void);\n\nstatic int\n_set_slurmd_spooldir(void)\n{\n\tdebug3(\"initializing slurmd spool directory\");\n\n\tif (mkdir(conf->spooldir, 0755) < 0) {\n\t\tif (errno != EEXIST) {\n\t\t\tfatal(\"mkdir(%s): %m\", conf->spooldir);\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t}\n\n\t/*\n\t * Ensure spool directory permissions are correct.\n\t */\n\tif (chmod(conf->spooldir, 0755) < 0) {\n\t\terror(\"chmod(%s, 0755): %m\", conf->spooldir);\n\t\treturn SLURM_ERROR;\n\t}\n\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "_usage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1838-1857",
    "snippet": "static void\n_usage(void)\n{\n\tfprintf(stderr, \"\\\nUsage: %s [OPTIONS]\\n\\\n   -b          Report node reboot now.\\n\\\n   -c          Force cleanup of slurmd shared memory.\\n\\\n   -C          Print node configuration information and exit.\\n\\\n   -d stepd    Pathname to the slurmstepd program.\\n\\\n   -D          Run daemon in foreground.\\n\\\n   -f config   Read configuration from the specified file.\\n\\\n   -h          Print this help message.\\n\\\n   -L logfile  Log messages to the file `logfile'.\\n\\\n   -M          Use mlock() to lock slurmd pages into memory.\\n\\\n   -n value    Run the daemon at the specified nice value.\\n\\\n   -N host     Run the daemon for specified hostname.\\n\\\n   -v          Verbose mode. Multiple -v's increase verbosity.\\n\\\n   -V          Print version information and exit.\\n\", conf->prog);\n\treturn;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _usage(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"\\\nUsage: %s [OPTIONS]\\n\\\n   -b          Report node reboot now.\\n\\\n   -c          Force cleanup of slurmd shared memory.\\n\\\n   -C          Print node configuration information and exit.\\n\\\n   -d stepd    Pathname to the slurmstepd program.\\n\\\n   -D          Run daemon in foreground.\\n\\\n   -f config   Read configuration from the specified file.\\n\\\n   -h          Print this help message.\\n\\\n   -L logfile  Log messages to the file `logfile'.\\n\\\n   -M          Use mlock() to lock slurmd pages into memory.\\n\\\n   -n value    Run the daemon at the specified nice value.\\n\\\n   -N host     Run the daemon for specified hostname.\\n\\\n   -v          Verbose mode. Multiple -v's increase verbosity.\\n\\\n   -V          Print version information and exit.\\n\"",
            "conf->prog"
          ],
          "line": 1841
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _usage(void);\n\nstatic void\n_usage(void)\n{\n\tfprintf(stderr, \"\\\nUsage: %s [OPTIONS]\\n\\\n   -b          Report node reboot now.\\n\\\n   -c          Force cleanup of slurmd shared memory.\\n\\\n   -C          Print node configuration information and exit.\\n\\\n   -d stepd    Pathname to the slurmstepd program.\\n\\\n   -D          Run daemon in foreground.\\n\\\n   -f config   Read configuration from the specified file.\\n\\\n   -h          Print this help message.\\n\\\n   -L logfile  Log messages to the file `logfile'.\\n\\\n   -M          Use mlock() to lock slurmd pages into memory.\\n\\\n   -n value    Run the daemon at the specified nice value.\\n\\\n   -N host     Run the daemon for specified hostname.\\n\\\n   -v          Verbose mode. Multiple -v's increase verbosity.\\n\\\n   -V          Print version information and exit.\\n\", conf->prog);\n\treturn;\n}"
  },
  {
    "function_name": "_hup_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1829-1835",
    "snippet": "static void\n_hup_handler(int signum)\n{\n\tif (signum == SIGHUP) {\n\t\t_reconfig = 1;\n\t}\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static sig_atomic_t _reconfig = 0;",
      "static void      _hup_handler(int);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic sig_atomic_t _reconfig = 0;\nstatic void      _hup_handler(int);\n\nstatic void\n_hup_handler(int signum)\n{\n\tif (signum == SIGHUP) {\n\t\t_reconfig = 1;\n\t}\n}"
  },
  {
    "function_name": "_term_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1818-1827",
    "snippet": "static void\n_term_handler(int signum)\n{\n\tif (signum == SIGTERM || signum == SIGINT) {\n\t\t_shutdown = 1;\n\t\tif (msg_pthread && (pthread_self() != msg_pthread))\n\t\t\tpthread_kill(msg_pthread, SIGTERM);\n\t\tmsg_aggr_sender_fini();\n\t}\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static sig_atomic_t _shutdown = 0;",
      "static pthread_t msg_pthread = (pthread_t) 0;",
      "static void      _term_handler(int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msg_aggr_sender_fini",
          "args": [],
          "line": 1825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_kill",
          "args": [
            "msg_pthread",
            "SIGTERM"
          ],
          "line": 1824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_self",
          "args": [],
          "line": 1823
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic sig_atomic_t _shutdown = 0;\nstatic pthread_t msg_pthread = (pthread_t) 0;\nstatic void      _term_handler(int);\n\nstatic void\n_term_handler(int signum)\n{\n\tif (signum == SIGTERM || signum == SIGINT) {\n\t\t_shutdown = 1;\n\t\tif (msg_pthread && (pthread_self() != msg_pthread))\n\t\t\tpthread_kill(msg_pthread, SIGTERM);\n\t\tmsg_aggr_sender_fini();\n\t}\n}"
  },
  {
    "function_name": "_drain_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1797-1816",
    "snippet": "static int _drain_node(char *reason)\n{\n\tslurm_msg_t req_msg;\n\tupdate_node_msg_t update_node_msg;\n\n\tmemset(&update_node_msg, 0, sizeof(update_node_msg_t));\n\tupdate_node_msg.node_names = conf->node_name;\n\tupdate_node_msg.node_state = NODE_STATE_DRAIN;\n\tupdate_node_msg.reason = reason;\n\tupdate_node_msg.reason_uid = getuid();\n\tupdate_node_msg.weight = NO_VAL;\n\tslurm_msg_t_init(&req_msg);\n\treq_msg.msg_type = REQUEST_UPDATE_NODE;\n\treq_msg.data = &update_node_msg;\n\n\tif (slurm_send_only_controller_msg(&req_msg) < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static int       _drain_node(char *reason);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "slurm_send_only_controller_msg",
          "args": [
            "&req_msg"
          ],
          "line": 1812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_msg_t_init",
          "args": [
            "&req_msg"
          ],
          "line": 1808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 1806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&update_node_msg",
            "0",
            "sizeof(update_node_msg_t)"
          ],
          "line": 1802
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic int       _drain_node(char *reason);\n\nstatic int _drain_node(char *reason)\n{\n\tslurm_msg_t req_msg;\n\tupdate_node_msg_t update_node_msg;\n\n\tmemset(&update_node_msg, 0, sizeof(update_node_msg_t));\n\tupdate_node_msg.node_names = conf->node_name;\n\tupdate_node_msg.node_state = NODE_STATE_DRAIN;\n\tupdate_node_msg.reason = reason;\n\tupdate_node_msg.reason_uid = getuid();\n\tupdate_node_msg.weight = NO_VAL;\n\tslurm_msg_t_init(&req_msg);\n\treq_msg.msg_type = REQUEST_UPDATE_NODE;\n\treq_msg.data = &update_node_msg;\n\n\tif (slurm_send_only_controller_msg(&req_msg) < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "save_cred_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1742-1795",
    "snippet": "int save_cred_state(slurm_cred_ctx_t ctx)\n{\n\tchar *old_file, *new_file, *reg_file;\n\tint cred_fd = -1, error_code = SLURM_SUCCESS, rc;\n\tBuf buffer = NULL;\n\tstatic pthread_mutex_t state_mutex = PTHREAD_MUTEX_INITIALIZER;\n\n\told_file = xstrdup(conf->spooldir);\n\txstrcat(old_file, \"/cred_state.old\");\n\treg_file = xstrdup(conf->spooldir);\n\txstrcat(reg_file, \"/cred_state\");\n\tnew_file = xstrdup(conf->spooldir);\n\txstrcat(new_file, \"/cred_state.new\");\n\n\tslurm_mutex_lock(&state_mutex);\n\tif ((cred_fd = creat(new_file, 0600)) < 0) {\n\t\terror(\"creat(%s): %m\", new_file);\n\t\tif (errno == ENOSPC)\n\t\t\t_drain_node(\"SlurmdSpoolDir is full\");\n\t\terror_code = errno;\n\t\tgoto cleanup;\n\t}\n\tbuffer = init_buf(1024);\n\tslurm_cred_ctx_pack(ctx, buffer);\n\trc = write(cred_fd, get_buf_data(buffer), get_buf_offset(buffer));\n\tif (rc != get_buf_offset(buffer)) {\n\t\terror(\"write %s error %m\", new_file);\n\t\t(void) unlink(new_file);\n\t\tif ((rc < 0) && (errno == ENOSPC))\n\t\t\t_drain_node(\"SlurmdSpoolDir is full\");\n\t\terror_code = errno;\n\t\tgoto cleanup;\n\t}\n\t(void) unlink(old_file);\n\tif (link(reg_file, old_file))\n\t\tdebug4(\"unable to create link for %s -> %s: %m\",\n\t\t       reg_file, old_file);\n\t(void) unlink(reg_file);\n\tif (link(new_file, reg_file))\n\t\tdebug4(\"unable to create link for %s -> %s: %m\",\n\t\t       new_file, reg_file);\n\t(void) unlink(new_file);\n\ncleanup:\n\tslurm_mutex_unlock(&state_mutex);\n\txfree(old_file);\n\txfree(reg_file);\n\txfree(new_file);\n\tif (buffer)\n\t\tfree_buf(buffer);\n\tif (cred_fd > 0)\n\t\tclose(cred_fd);\n\treturn error_code;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static int       _restore_cred_state(slurm_cred_ctx_t ctx);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "cred_fd"
          ],
          "line": 1793
        },
        "resolved": true,
        "details": {
          "function_name": "_file_bcast_close_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "3635-3640",
          "snippet": "static void _file_bcast_close_file(file_bcast_info_t *key)\n{\n\t_fb_wrlock();\n\tlist_delete_all(file_bcast_list, _bcast_find_in_list, key);\n\t_fb_wrunlock();\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int  _job_limits_match(void *x, void *key);",
            "static int  _step_limits_match(void *x, void *key);",
            "static int  _file_bcast_register_file(slurm_msg_t *msg,\n\t\t\t\t      file_bcast_info_t *key);",
            "static List file_bcast_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic int  _job_limits_match(void *x, void *key);\nstatic int  _step_limits_match(void *x, void *key);\nstatic int  _file_bcast_register_file(slurm_msg_t *msg,\n\t\t\t\t      file_bcast_info_t *key);\nstatic List file_bcast_list = NULL;\n\nstatic void _file_bcast_close_file(file_bcast_info_t *key)\n{\n\t_fb_wrlock();\n\tlist_delete_all(file_bcast_list, _bcast_find_in_list, key);\n\t_fb_wrunlock();\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_buf",
          "args": [
            "buffer"
          ],
          "line": 1791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "new_file"
          ],
          "line": 1789
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_mutex_unlock",
          "args": [
            "&state_mutex"
          ],
          "line": 1786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "new_file"
          ],
          "line": 1783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug4",
          "args": [
            "\"unable to create link for %s -> %s: %m\"",
            "new_file",
            "reg_file"
          ],
          "line": 1781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "link",
          "args": [
            "new_file",
            "reg_file"
          ],
          "line": 1780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "reg_file"
          ],
          "line": 1779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug4",
          "args": [
            "\"unable to create link for %s -> %s: %m\"",
            "reg_file",
            "old_file"
          ],
          "line": 1777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "link",
          "args": [
            "reg_file",
            "old_file"
          ],
          "line": 1776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "old_file"
          ],
          "line": 1775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_drain_node",
          "args": [
            "\"SlurmdSpoolDir is full\""
          ],
          "line": 1771
        },
        "resolved": true,
        "details": {
          "function_name": "_drain_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1797-1816",
          "snippet": "static int _drain_node(char *reason)\n{\n\tslurm_msg_t req_msg;\n\tupdate_node_msg_t update_node_msg;\n\n\tmemset(&update_node_msg, 0, sizeof(update_node_msg_t));\n\tupdate_node_msg.node_names = conf->node_name;\n\tupdate_node_msg.node_state = NODE_STATE_DRAIN;\n\tupdate_node_msg.reason = reason;\n\tupdate_node_msg.reason_uid = getuid();\n\tupdate_node_msg.weight = NO_VAL;\n\tslurm_msg_t_init(&req_msg);\n\treq_msg.msg_type = REQUEST_UPDATE_NODE;\n\treq_msg.data = &update_node_msg;\n\n\tif (slurm_send_only_controller_msg(&req_msg) < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static int       _drain_node(char *reason);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic int       _drain_node(char *reason);\n\nstatic int _drain_node(char *reason)\n{\n\tslurm_msg_t req_msg;\n\tupdate_node_msg_t update_node_msg;\n\n\tmemset(&update_node_msg, 0, sizeof(update_node_msg_t));\n\tupdate_node_msg.node_names = conf->node_name;\n\tupdate_node_msg.node_state = NODE_STATE_DRAIN;\n\tupdate_node_msg.reason = reason;\n\tupdate_node_msg.reason_uid = getuid();\n\tupdate_node_msg.weight = NO_VAL;\n\tslurm_msg_t_init(&req_msg);\n\treq_msg.msg_type = REQUEST_UPDATE_NODE;\n\treq_msg.data = &update_node_msg;\n\n\tif (slurm_send_only_controller_msg(&req_msg) < 0)\n\t\treturn SLURM_ERROR;\n\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "new_file"
          ],
          "line": 1769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"write %s error %m\"",
            "new_file"
          ],
          "line": 1768
        },
        "resolved": true,
        "details": {
          "function_name": "_prolog_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "1386-1434",
          "snippet": "static void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _is_batch_job_finished(uint32_t job_id);",
            "static bool _job_still_running(uint32_t job_id);",
            "static void _launch_complete_add(uint32_t job_id);",
            "static void _launch_complete_log(char *type, uint32_t job_id);",
            "static void _launch_complete_rm(uint32_t job_id);",
            "static void _launch_complete_wait(uint32_t job_id);",
            "static bool _launch_job_test(uint32_t job_id);",
            "static void _note_batch_job_finished(uint32_t job_id);",
            "static bool _slurm_authorized_user(uid_t uid);",
            "static void _sync_messages_kill(kill_job_msg_t *req);",
            "static int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);",
            "static gids_t *_gids_cache_lookup(char *user, gid_t gid);",
            "static int  _add_starting_step(uint16_t type, void *req);",
            "static int  _remove_starting_step(uint16_t type, void *req);",
            "static void _add_job_running_prolog(uint32_t job_id);",
            "static void _remove_job_running_prolog(uint32_t job_id);",
            "static void _wait_for_job_running_prolog(uint32_t job_id);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic bool _is_batch_job_finished(uint32_t job_id);\nstatic bool _job_still_running(uint32_t job_id);\nstatic void _launch_complete_add(uint32_t job_id);\nstatic void _launch_complete_log(char *type, uint32_t job_id);\nstatic void _launch_complete_rm(uint32_t job_id);\nstatic void _launch_complete_wait(uint32_t job_id);\nstatic bool _launch_job_test(uint32_t job_id);\nstatic void _note_batch_job_finished(uint32_t job_id);\nstatic bool _slurm_authorized_user(uid_t uid);\nstatic void _sync_messages_kill(kill_job_msg_t *req);\nstatic int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);\nstatic gids_t *_gids_cache_lookup(char *user, gid_t gid);\nstatic int  _add_starting_step(uint16_t type, void *req);\nstatic int  _remove_starting_step(uint16_t type, void *req);\nstatic void _add_job_running_prolog(uint32_t job_id);\nstatic void _remove_job_running_prolog(uint32_t job_id);\nstatic void _wait_for_job_running_prolog(uint32_t job_id);\n\nstatic void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_buf_offset",
          "args": [
            "buffer"
          ],
          "line": 1767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "write",
          "args": [
            "cred_fd",
            "get_buf_data(buffer)",
            "get_buf_offset(buffer)"
          ],
          "line": 1766
        },
        "resolved": true,
        "details": {
          "function_name": "_file_write_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1116-1147",
          "snippet": "int _file_write_content(char* file_path, char* content, size_t csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* write content */\n\tdo {\n\t\trc = write(fd, content, csize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* check read size */\n\tif (rc < csize) {\n\t\tdebug2(\"%s: unable to write %lu bytes to file '%s' : %m\",\n\t\t\t__func__, (long unsigned int) csize, file_path);\n\t\tfstatus = XCGROUP_ERROR;\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_write_content(char* file_path, char* content, size_t csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* write content */\n\tdo {\n\t\trc = write(fd, content, csize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* check read size */\n\tif (rc < csize) {\n\t\tdebug2(\"%s: unable to write %lu bytes to file '%s' : %m\",\n\t\t\t__func__, (long unsigned int) csize, file_path);\n\t\tfstatus = XCGROUP_ERROR;\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_buf_offset",
          "args": [
            "buffer"
          ],
          "line": 1766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_buf_data",
          "args": [
            "buffer"
          ],
          "line": 1766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_cred_ctx_pack",
          "args": [
            "ctx",
            "buffer"
          ],
          "line": 1765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_buf",
          "args": [
            "1024"
          ],
          "line": 1764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "creat",
          "args": [
            "new_file",
            "0600"
          ],
          "line": 1757
        },
        "resolved": true,
        "details": {
          "function_name": "_create_task_in_eio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "600-618",
          "snippet": "static eio_obj_t *\n_create_task_in_eio(int fd, stepd_step_rec_t *job)\n{\n\tstruct task_write_info *t = NULL;\n\teio_obj_t *eio = NULL;\n\n\tt = (struct task_write_info *)xmalloc(sizeof(struct task_write_info));\n#ifndef NDEBUG\n\tt->magic = TASK_IN_MAGIC;\n#endif\n\tt->job = job;\n\tt->msg_queue = list_create(NULL); /* FIXME! Add destructor */\n\tt->msg = NULL;\n\tt->remaining = 0;\n\n\teio = eio_obj_create(fd, &task_write_ops, (void *)t);\n\n\treturn eio;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [
            "#define TASK_IN_MAGIC  0x10103"
          ],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static bool _task_writable(eio_obj_t *);",
            "struct io_operations task_write_ops = {\n\t.writable = &_task_writable,\n\t.handle_write = &_task_write,\n\t.handle_error = &_task_write_error,\n};",
            "static bool _task_readable(eio_obj_t *);",
            "static int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);",
            "static void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);",
            "static bool _incoming_buf_free(stepd_step_rec_t *job);",
            "static bool _outgoing_buf_free(stepd_step_rec_t *job);",
            "static int  _send_connection_okay_response(stepd_step_rec_t *job);",
            "static struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\n#define TASK_IN_MAGIC  0x10103\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic bool _task_writable(eio_obj_t *);\nstruct io_operations task_write_ops = {\n\t.writable = &_task_writable,\n\t.handle_write = &_task_write,\n\t.handle_error = &_task_write_error,\n};\nstatic bool _task_readable(eio_obj_t *);\nstatic int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);\nstatic void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);\nstatic bool _incoming_buf_free(stepd_step_rec_t *job);\nstatic bool _outgoing_buf_free(stepd_step_rec_t *job);\nstatic int  _send_connection_okay_response(stepd_step_rec_t *job);\nstatic struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);\n\nstatic eio_obj_t *\n_create_task_in_eio(int fd, stepd_step_rec_t *job)\n{\n\tstruct task_write_info *t = NULL;\n\teio_obj_t *eio = NULL;\n\n\tt = (struct task_write_info *)xmalloc(sizeof(struct task_write_info));\n#ifndef NDEBUG\n\tt->magic = TASK_IN_MAGIC;\n#endif\n\tt->job = job;\n\tt->msg_queue = list_create(NULL); /* FIXME! Add destructor */\n\tt->msg = NULL;\n\tt->remaining = 0;\n\n\teio = eio_obj_create(fd, &task_write_ops, (void *)t);\n\n\treturn eio;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_mutex_lock",
          "args": [
            "&state_mutex"
          ],
          "line": 1756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrcat",
          "args": [
            "new_file",
            "\"/cred_state.new\""
          ],
          "line": 1754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "conf->spooldir"
          ],
          "line": 1753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrcat",
          "args": [
            "reg_file",
            "\"/cred_state\""
          ],
          "line": 1752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "conf->spooldir"
          ],
          "line": 1751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrcat",
          "args": [
            "old_file",
            "\"/cred_state.old\""
          ],
          "line": 1750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "conf->spooldir"
          ],
          "line": 1749
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic int       _restore_cred_state(slurm_cred_ctx_t ctx);\n\nint save_cred_state(slurm_cred_ctx_t ctx)\n{\n\tchar *old_file, *new_file, *reg_file;\n\tint cred_fd = -1, error_code = SLURM_SUCCESS, rc;\n\tBuf buffer = NULL;\n\tstatic pthread_mutex_t state_mutex = PTHREAD_MUTEX_INITIALIZER;\n\n\told_file = xstrdup(conf->spooldir);\n\txstrcat(old_file, \"/cred_state.old\");\n\treg_file = xstrdup(conf->spooldir);\n\txstrcat(reg_file, \"/cred_state\");\n\tnew_file = xstrdup(conf->spooldir);\n\txstrcat(new_file, \"/cred_state.new\");\n\n\tslurm_mutex_lock(&state_mutex);\n\tif ((cred_fd = creat(new_file, 0600)) < 0) {\n\t\terror(\"creat(%s): %m\", new_file);\n\t\tif (errno == ENOSPC)\n\t\t\t_drain_node(\"SlurmdSpoolDir is full\");\n\t\terror_code = errno;\n\t\tgoto cleanup;\n\t}\n\tbuffer = init_buf(1024);\n\tslurm_cred_ctx_pack(ctx, buffer);\n\trc = write(cred_fd, get_buf_data(buffer), get_buf_offset(buffer));\n\tif (rc != get_buf_offset(buffer)) {\n\t\terror(\"write %s error %m\", new_file);\n\t\t(void) unlink(new_file);\n\t\tif ((rc < 0) && (errno == ENOSPC))\n\t\t\t_drain_node(\"SlurmdSpoolDir is full\");\n\t\terror_code = errno;\n\t\tgoto cleanup;\n\t}\n\t(void) unlink(old_file);\n\tif (link(reg_file, old_file))\n\t\tdebug4(\"unable to create link for %s -> %s: %m\",\n\t\t       reg_file, old_file);\n\t(void) unlink(reg_file);\n\tif (link(new_file, reg_file))\n\t\tdebug4(\"unable to create link for %s -> %s: %m\",\n\t\t       new_file, reg_file);\n\t(void) unlink(new_file);\n\ncleanup:\n\tslurm_mutex_unlock(&state_mutex);\n\txfree(old_file);\n\txfree(reg_file);\n\txfree(new_file);\n\tif (buffer)\n\t\tfree_buf(buffer);\n\tif (cred_fd > 0)\n\t\tclose(cred_fd);\n\treturn error_code;\n}"
  },
  {
    "function_name": "_slurmd_fini",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1706-1735",
    "snippet": "static int\n_slurmd_fini(void)\n{\n\tnode_features_g_fini();\n\tcore_spec_g_fini();\n\tswitch_g_node_fini();\n\tjobacct_gather_fini();\n\tacct_gather_profile_fini();\n\tsave_cred_state(conf->vctx);\n\tswitch_fini();\n\tslurmd_task_fini();\n\tslurm_conf_destroy();\n\tslurm_proctrack_fini();\n\tslurm_auth_fini();\n\tnode_fini2();\n\tgres_plugin_fini();\n\tslurm_topo_fini();\n\tslurmd_req(NULL);\t/* purge memory allocated by slurmd_req() */\n\tfini_setproctitle();\n\tslurm_select_fini();\n\tspank_slurmd_exit();\n\tcpu_freq_fini();\n\t_resource_spec_fini();\n\tjob_container_fini();\n\tacct_gather_conf_destroy();\n\tfini_system_cgroup();\n\troute_fini();\n\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _resource_spec_fini(void);",
      "static int       _slurmd_fini(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "route_fini",
          "args": [],
          "line": 1732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fini_system_cgroup",
          "args": [],
          "line": 1731
        },
        "resolved": true,
        "details": {
          "function_name": "fini_system_cgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/slurmd_cgroup.c",
          "lines": "299-305",
          "snippet": "extern void fini_system_cgroup(void)\n{\n\txcgroup_destroy(&system_cpuset_cg);\n\txcgroup_destroy(&system_memory_cg);\n\txcgroup_ns_destroy(&cpuset_ns);\n\txcgroup_ns_destroy(&memory_ns);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/xcgroup.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xcgroup_read_config.h\"",
            "#include \"src/common/slurm_resource_info.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include \"slurm/slurm.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <sched.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
            "static xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};",
            "static xcgroup_ns_t cpuset_ns = {NULL, NULL, NULL, NULL};",
            "static xcgroup_ns_t memory_ns = {NULL, NULL, NULL, NULL};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/xcgroup.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xcgroup_read_config.h\"\n#include \"src/common/slurm_resource_info.h\"\n#include \"src/common/bitstring.h\"\n#include \"slurm/slurm.h\"\n#include \"slurm/slurm_errno.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <sched.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic xcgroup_t system_cpuset_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic xcgroup_t system_memory_cg = {NULL, NULL, NULL, 0, 0, 0, 0};\nstatic xcgroup_ns_t cpuset_ns = {NULL, NULL, NULL, NULL};\nstatic xcgroup_ns_t memory_ns = {NULL, NULL, NULL, NULL};\n\nextern void fini_system_cgroup(void)\n{\n\txcgroup_destroy(&system_cpuset_cg);\n\txcgroup_destroy(&system_memory_cg);\n\txcgroup_ns_destroy(&cpuset_ns);\n\txcgroup_ns_destroy(&memory_ns);\n}"
        }
      },
      {
        "call_info": {
          "callee": "acct_gather_conf_destroy",
          "args": [],
          "line": 1730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "job_container_fini",
          "args": [],
          "line": 1729
        },
        "resolved": true,
        "details": {
          "function_name": "job_container_fini",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/job_container_plugin.c",
          "lines": "150-175",
          "snippet": "extern int job_container_fini(void)\n{\n\tint i, rc = SLURM_SUCCESS;\n\n\tslurm_mutex_lock(&g_container_context_lock);\n\tif (!g_container_context)\n\t\tgoto done;\n\n\tinit_run = false;\n\tfor (i = 0; i < g_container_context_num; i++) {\n\t\tif (g_container_context[i]) {\n\t\t\tif (plugin_context_destroy(g_container_context[i])\n\t\t\t    != SLURM_SUCCESS) {\n\t\t\t\trc = SLURM_ERROR;\n\t\t\t}\n\t\t}\n\t}\n\n\txfree(ops);\n\txfree(g_container_context);\n\tg_container_context_num = -1;\n\ndone:\n\tslurm_mutex_unlock(&g_container_context_lock);\n\treturn rc;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/plugin.h\"",
            "#include <pthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static job_container_ops_t\t*ops = NULL;",
            "static plugin_context_t\t\t**g_container_context = NULL;",
            "static int\t\t\tg_container_context_num = -1;",
            "static pthread_mutex_t\t\tg_container_context_lock =\n\t\t\t\t\tPTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/plugin.h\"\n#include <pthread.h>\n\nstatic job_container_ops_t\t*ops = NULL;\nstatic plugin_context_t\t\t**g_container_context = NULL;\nstatic int\t\t\tg_container_context_num = -1;\nstatic pthread_mutex_t\t\tg_container_context_lock =\n\t\t\t\t\tPTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int job_container_fini(void)\n{\n\tint i, rc = SLURM_SUCCESS;\n\n\tslurm_mutex_lock(&g_container_context_lock);\n\tif (!g_container_context)\n\t\tgoto done;\n\n\tinit_run = false;\n\tfor (i = 0; i < g_container_context_num; i++) {\n\t\tif (g_container_context[i]) {\n\t\t\tif (plugin_context_destroy(g_container_context[i])\n\t\t\t    != SLURM_SUCCESS) {\n\t\t\t\trc = SLURM_ERROR;\n\t\t\t}\n\t\t}\n\t}\n\n\txfree(ops);\n\txfree(g_container_context);\n\tg_container_context_num = -1;\n\ndone:\n\tslurm_mutex_unlock(&g_container_context_lock);\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_resource_spec_fini",
          "args": [],
          "line": 1728
        },
        "resolved": true,
        "details": {
          "function_name": "_resource_spec_fini",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2323-2329",
          "snippet": "static void _resource_spec_fini(void)\n{\n\txfree(res_abs_cores);\n\txfree(res_mac_cpus);\n\tFREE_NULL_BITMAP(res_core_bitmap);\n\tFREE_NULL_BITMAP(res_cpu_bitmap);\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bitstr_t\t*res_core_bitmap;",
            "static bitstr_t\t*res_cpu_bitmap;",
            "static char\t*res_abs_cores = NULL;",
            "static char\t*res_mac_cpus = NULL;",
            "static void      _resource_spec_fini(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic bitstr_t\t*res_core_bitmap;\nstatic bitstr_t\t*res_cpu_bitmap;\nstatic char\t*res_abs_cores = NULL;\nstatic char\t*res_mac_cpus = NULL;\nstatic void      _resource_spec_fini(void);\n\nstatic void _resource_spec_fini(void)\n{\n\txfree(res_abs_cores);\n\txfree(res_mac_cpus);\n\tFREE_NULL_BITMAP(res_core_bitmap);\n\tFREE_NULL_BITMAP(res_cpu_bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_freq_fini",
          "args": [],
          "line": 1727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spank_slurmd_exit",
          "args": [],
          "line": 1726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_select_fini",
          "args": [],
          "line": 1725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fini_setproctitle",
          "args": [],
          "line": 1724
        },
        "resolved": true,
        "details": {
          "function_name": "fini_setproctitle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/setproctitle.c",
          "lines": "332-347",
          "snippet": "void fini_setproctitle(void)\n{\n#if SETPROCTITLE_STRATEGY == PS_USE_CLOBBER_ARGV\n\tint i;\n\n\tif (!new_environ)\n\t\treturn;\n\n\tfor (i = 0; new_environ[i] != NULL; i++) {\n\t\tfree(new_environ[i]);\n\t}\n\tfree(new_environ);\n\tnew_environ = (char **) NULL;\n\tenviron = new_environ;\n#endif /* PS_USE_CLOBBER_ARGV */\n}",
          "includes": [
            "#include <sys/exec.h>",
            "#include <machine/vmparam.h>\t/* for old BSD */",
            "#include <sys/pstat.h>\t\t/* for HP-UX */",
            "#include \"src/common/strlcpy.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#    include \"src/common/malloc.h\"",
            "#  include \"config.h\""
          ],
          "macros_used": [
            "#define PS_USE_CLOBBER_ARGV\t\t4"
          ],
          "globals_used": [
            "extern char **environ;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/exec.h>\n#include <machine/vmparam.h>\t/* for old BSD */\n#include <sys/pstat.h>\t\t/* for HP-UX */\n#include \"src/common/strlcpy.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n#    include \"src/common/malloc.h\"\n#  include \"config.h\"\n\n#define PS_USE_CLOBBER_ARGV\t\t4\n\nextern char **environ;\n\nvoid fini_setproctitle(void)\n{\n#if SETPROCTITLE_STRATEGY == PS_USE_CLOBBER_ARGV\n\tint i;\n\n\tif (!new_environ)\n\t\treturn;\n\n\tfor (i = 0; new_environ[i] != NULL; i++) {\n\t\tfree(new_environ[i]);\n\t}\n\tfree(new_environ);\n\tnew_environ = (char **) NULL;\n\tenviron = new_environ;\n#endif /* PS_USE_CLOBBER_ARGV */\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurmd_req",
          "args": [
            "NULL"
          ],
          "line": 1723
        },
        "resolved": true,
        "details": {
          "function_name": "slurmd_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "278-458",
          "snippet": "void\nslurmd_req(slurm_msg_t *msg)\n{\n\tint rc;\n\n\tif (msg == NULL) {\n\t\tif (startup == 0)\n\t\t\tstartup = time(NULL);\n\t\tFREE_NULL_LIST(waiters);\n\t\tslurm_mutex_lock(&job_limits_mutex);\n\t\tif (job_limits_list) {\n\t\t\tFREE_NULL_LIST(job_limits_list);\n\t\t\tjob_limits_loaded = false;\n\t\t}\n\t\tslurm_mutex_unlock(&job_limits_mutex);\n\t\treturn;\n\t}\n\n\tswitch (msg->msg_type) {\n\tcase REQUEST_LAUNCH_PROLOG:\n\t\tdebug2(\"Processing RPC: REQUEST_LAUNCH_PROLOG\");\n\t\t_rpc_prolog(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_BATCH_JOB_LAUNCH:\n\t\tdebug2(\"Processing RPC: REQUEST_BATCH_JOB_LAUNCH\");\n\t\t/* Mutex locking moved into _rpc_batch_job() due to\n\t\t * very slow prolog on Blue Gene system. Only batch\n\t\t * jobs are supported on Blue Gene (no job steps). */\n\t\t_rpc_batch_job(msg, true);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_LAUNCH_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_LAUNCH_TASKS\");\n\t\tslurm_mutex_lock(&launch_mutex);\n\t\t_rpc_launch_tasks(msg);\n\t\tslurm_mutex_unlock(&launch_mutex);\n\t\tbreak;\n\tcase REQUEST_SIGNAL_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_SIGNAL_TASKS\");\n\t\t_rpc_signal_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_CHECKPOINT_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_CHECKPOINT_TASKS\");\n\t\t_rpc_checkpoint_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_TERMINATE_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_TERMINATE_TASKS\");\n\t\t_rpc_terminate_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_KILL_PREEMPTED:\n\t\tdebug2(\"Processing RPC: REQUEST_KILL_PREEMPTED\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_timelimit(msg);\n\t\tbreak;\n\tcase REQUEST_KILL_TIMELIMIT:\n\t\tdebug2(\"Processing RPC: REQUEST_KILL_TIMELIMIT\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_timelimit(msg);\n\t\tbreak;\n\tcase REQUEST_REATTACH_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_REATTACH_TASKS\");\n\t\t_rpc_reattach_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_SIGNAL_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_SIGNAL_JOB\");\n\t\t_rpc_signal_job(msg);\n\t\tbreak;\n\tcase REQUEST_SUSPEND_INT:\n\t\tdebug2(\"Processing RPC: REQUEST_SUSPEND_INT\");\n\t\t_rpc_suspend_job(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ABORT_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_ABORT_JOB\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_abort_job(msg);\n\t\tbreak;\n\tcase REQUEST_TERMINATE_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_TERMINATE_JOB\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_terminate_job(msg);\n\t\tbreak;\n\tcase REQUEST_COMPLETE_BATCH_SCRIPT:\n\t\tdebug2(\"Processing RPC: REQUEST_COMPLETE_BATCH_SCRIPT\");\n\t\t_rpc_complete_batch(msg);\n\t\tbreak;\n\tcase REQUEST_UPDATE_JOB_TIME:\n\t\tdebug2(\"Processing RPC: REQUEST_UPDATE_JOB_TIME\");\n\t\t_rpc_update_time(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_SHUTDOWN:\n\t\tdebug2(\"Processing RPC: REQUEST_SHUTDOWN\");\n\t\t_rpc_shutdown(msg);\n\t\tbreak;\n\tcase REQUEST_RECONFIGURE:\n\t\tdebug2(\"Processing RPC: REQUEST_RECONFIGURE\");\n\t\t_rpc_reconfig(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_REBOOT_NODES:\n\t\tdebug2(\"Processing RPC: REQUEST_REBOOT_NODES\");\n\t\t_rpc_reboot(msg);\n\t\tbreak;\n\tcase REQUEST_NODE_REGISTRATION_STATUS:\n\t\tdebug2(\"Processing RPC: REQUEST_NODE_REGISTRATION_STATUS\");\n\t\t/* Treat as ping (for slurmctld agent, just return SUCCESS) */\n\t\trc = _rpc_ping(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t/* Then initiate a separate node registration */\n\t\tif (rc == SLURM_SUCCESS)\n\t\t\tsend_registration_msg(SLURM_SUCCESS, true);\n\t\tbreak;\n\tcase REQUEST_PING:\n\t\t_rpc_ping(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_HEALTH_CHECK:\n\t\tdebug2(\"Processing RPC: REQUEST_HEALTH_CHECK\");\n\t\t_rpc_health_check(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ACCT_GATHER_UPDATE:\n\t\tdebug2(\"Processing RPC: REQUEST_ACCT_GATHER_UPDATE\");\n\t\t_rpc_acct_gather_update(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ACCT_GATHER_ENERGY:\n\t\tdebug2(\"Processing RPC: REQUEST_ACCT_GATHER_ENERGY\");\n\t\t_rpc_acct_gather_energy(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_ID:\n\t\t_rpc_pid2jid(msg);\n\t\tbreak;\n\tcase REQUEST_FILE_BCAST:\n\t\trc = _rpc_file_bcast(msg);\n\t\tslurm_send_rc_msg(msg, rc);\n\t\tbreak;\n\tcase REQUEST_STEP_COMPLETE:\n\t\t(void) _rpc_step_complete(msg);\n\t\tbreak;\n\tcase REQUEST_STEP_COMPLETE_AGGR:\n\t\t(void) _rpc_step_complete_aggr(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_STEP_STAT:\n\t\t(void) _rpc_stat_jobacct(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_STEP_PIDS:\n\t\t(void) _rpc_list_pids(msg);\n\t\tbreak;\n\tcase REQUEST_DAEMON_STATUS:\n\t\t_rpc_daemon_status(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_NOTIFY:\n\t\t_rpc_job_notify(msg);\n\t\tbreak;\n\tcase REQUEST_FORWARD_DATA:\n\t\t_rpc_forward_data(msg);\n\t\tbreak;\n\tcase REQUEST_NETWORK_CALLERID:\n\t\tdebug2(\"Processing RPC: REQUEST_NETWORK_CALLERID\");\n\t\t_rpc_network_callerid(msg);\n\t\tbreak;\n\tcase MESSAGE_COMPOSITE:\n\t\terror(\"Processing RPC: MESSAGE_COMPOSITE: \"\n\t\t      \"This should never happen\");\n\t\tmsg_aggr_add_msg(msg, 0, NULL);\n\t\tbreak;\n\tcase RESPONSE_MESSAGE_COMPOSITE:\n\t\tdebug2(\"Processing RPC: RESPONSE_MESSAGE_COMPOSITE\");\n\t\tmsg_aggr_resp(msg);\n\t\tbreak;\n\tdefault:\n\t\terror(\"slurmd_req: invalid request msg type %d\",\n\t\t      msg->msg_type);\n\t\tslurm_send_rc_msg(msg, EINVAL);\n\t\tbreak;\n\t}\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int  _kill_all_active_steps(uint32_t jobid, int sig, bool batch);",
            "static int  _terminate_all_steps(uint32_t jobid, bool batch);",
            "static void _rpc_launch_tasks(slurm_msg_t *);",
            "static void _rpc_abort_job(slurm_msg_t *);",
            "static void _rpc_prolog(slurm_msg_t *msg);",
            "static void _rpc_job_notify(slurm_msg_t *);",
            "static void _rpc_signal_tasks(slurm_msg_t *);",
            "static void _rpc_checkpoint_tasks(slurm_msg_t *);",
            "static void _rpc_complete_batch(slurm_msg_t *);",
            "static void _rpc_terminate_tasks(slurm_msg_t *);",
            "static void _rpc_timelimit(slurm_msg_t *);",
            "static void _rpc_reattach_tasks(slurm_msg_t *);",
            "static void _rpc_signal_job(slurm_msg_t *);",
            "static void _rpc_suspend_job(slurm_msg_t *msg);",
            "static void _rpc_terminate_job(slurm_msg_t *);",
            "static void _rpc_update_time(slurm_msg_t *);",
            "static void _rpc_shutdown(slurm_msg_t *msg);",
            "static void _rpc_reconfig(slurm_msg_t *msg);",
            "static void _rpc_reboot(slurm_msg_t *msg);",
            "static void _rpc_pid2jid(slurm_msg_t *msg);",
            "static int  _rpc_file_bcast(slurm_msg_t *msg);",
            "static int  _rpc_ping(slurm_msg_t *);",
            "static int  _rpc_health_check(slurm_msg_t *);",
            "static int  _rpc_acct_gather_update(slurm_msg_t *);",
            "static int  _rpc_acct_gather_energy(slurm_msg_t *);",
            "static int  _rpc_step_complete(slurm_msg_t *msg);",
            "static int  _rpc_step_complete_aggr(slurm_msg_t *msg);",
            "static int  _rpc_stat_jobacct(slurm_msg_t *msg);",
            "static int  _rpc_list_pids(slurm_msg_t *msg);",
            "static int  _rpc_daemon_status(slurm_msg_t *msg);",
            "static void _rpc_forward_data(slurm_msg_t *msg);",
            "static int  _rpc_network_callerid(slurm_msg_t *msg);",
            "static List waiters;",
            "static pthread_mutex_t launch_mutex = PTHREAD_MUTEX_INITIALIZER;",
            "static time_t startup = 0;",
            "static time_t last_slurmctld_msg = 0;",
            "static pthread_mutex_t job_limits_mutex = PTHREAD_MUTEX_INITIALIZER;",
            "static List job_limits_list = NULL;",
            "static bool job_limits_loaded = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic int  _kill_all_active_steps(uint32_t jobid, int sig, bool batch);\nstatic int  _terminate_all_steps(uint32_t jobid, bool batch);\nstatic void _rpc_launch_tasks(slurm_msg_t *);\nstatic void _rpc_abort_job(slurm_msg_t *);\nstatic void _rpc_prolog(slurm_msg_t *msg);\nstatic void _rpc_job_notify(slurm_msg_t *);\nstatic void _rpc_signal_tasks(slurm_msg_t *);\nstatic void _rpc_checkpoint_tasks(slurm_msg_t *);\nstatic void _rpc_complete_batch(slurm_msg_t *);\nstatic void _rpc_terminate_tasks(slurm_msg_t *);\nstatic void _rpc_timelimit(slurm_msg_t *);\nstatic void _rpc_reattach_tasks(slurm_msg_t *);\nstatic void _rpc_signal_job(slurm_msg_t *);\nstatic void _rpc_suspend_job(slurm_msg_t *msg);\nstatic void _rpc_terminate_job(slurm_msg_t *);\nstatic void _rpc_update_time(slurm_msg_t *);\nstatic void _rpc_shutdown(slurm_msg_t *msg);\nstatic void _rpc_reconfig(slurm_msg_t *msg);\nstatic void _rpc_reboot(slurm_msg_t *msg);\nstatic void _rpc_pid2jid(slurm_msg_t *msg);\nstatic int  _rpc_file_bcast(slurm_msg_t *msg);\nstatic int  _rpc_ping(slurm_msg_t *);\nstatic int  _rpc_health_check(slurm_msg_t *);\nstatic int  _rpc_acct_gather_update(slurm_msg_t *);\nstatic int  _rpc_acct_gather_energy(slurm_msg_t *);\nstatic int  _rpc_step_complete(slurm_msg_t *msg);\nstatic int  _rpc_step_complete_aggr(slurm_msg_t *msg);\nstatic int  _rpc_stat_jobacct(slurm_msg_t *msg);\nstatic int  _rpc_list_pids(slurm_msg_t *msg);\nstatic int  _rpc_daemon_status(slurm_msg_t *msg);\nstatic void _rpc_forward_data(slurm_msg_t *msg);\nstatic int  _rpc_network_callerid(slurm_msg_t *msg);\nstatic List waiters;\nstatic pthread_mutex_t launch_mutex = PTHREAD_MUTEX_INITIALIZER;\nstatic time_t startup = 0;\nstatic time_t last_slurmctld_msg = 0;\nstatic pthread_mutex_t job_limits_mutex = PTHREAD_MUTEX_INITIALIZER;\nstatic List job_limits_list = NULL;\nstatic bool job_limits_loaded = false;\n\nvoid\nslurmd_req(slurm_msg_t *msg)\n{\n\tint rc;\n\n\tif (msg == NULL) {\n\t\tif (startup == 0)\n\t\t\tstartup = time(NULL);\n\t\tFREE_NULL_LIST(waiters);\n\t\tslurm_mutex_lock(&job_limits_mutex);\n\t\tif (job_limits_list) {\n\t\t\tFREE_NULL_LIST(job_limits_list);\n\t\t\tjob_limits_loaded = false;\n\t\t}\n\t\tslurm_mutex_unlock(&job_limits_mutex);\n\t\treturn;\n\t}\n\n\tswitch (msg->msg_type) {\n\tcase REQUEST_LAUNCH_PROLOG:\n\t\tdebug2(\"Processing RPC: REQUEST_LAUNCH_PROLOG\");\n\t\t_rpc_prolog(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_BATCH_JOB_LAUNCH:\n\t\tdebug2(\"Processing RPC: REQUEST_BATCH_JOB_LAUNCH\");\n\t\t/* Mutex locking moved into _rpc_batch_job() due to\n\t\t * very slow prolog on Blue Gene system. Only batch\n\t\t * jobs are supported on Blue Gene (no job steps). */\n\t\t_rpc_batch_job(msg, true);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_LAUNCH_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_LAUNCH_TASKS\");\n\t\tslurm_mutex_lock(&launch_mutex);\n\t\t_rpc_launch_tasks(msg);\n\t\tslurm_mutex_unlock(&launch_mutex);\n\t\tbreak;\n\tcase REQUEST_SIGNAL_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_SIGNAL_TASKS\");\n\t\t_rpc_signal_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_CHECKPOINT_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_CHECKPOINT_TASKS\");\n\t\t_rpc_checkpoint_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_TERMINATE_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_TERMINATE_TASKS\");\n\t\t_rpc_terminate_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_KILL_PREEMPTED:\n\t\tdebug2(\"Processing RPC: REQUEST_KILL_PREEMPTED\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_timelimit(msg);\n\t\tbreak;\n\tcase REQUEST_KILL_TIMELIMIT:\n\t\tdebug2(\"Processing RPC: REQUEST_KILL_TIMELIMIT\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_timelimit(msg);\n\t\tbreak;\n\tcase REQUEST_REATTACH_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_REATTACH_TASKS\");\n\t\t_rpc_reattach_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_SIGNAL_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_SIGNAL_JOB\");\n\t\t_rpc_signal_job(msg);\n\t\tbreak;\n\tcase REQUEST_SUSPEND_INT:\n\t\tdebug2(\"Processing RPC: REQUEST_SUSPEND_INT\");\n\t\t_rpc_suspend_job(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ABORT_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_ABORT_JOB\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_abort_job(msg);\n\t\tbreak;\n\tcase REQUEST_TERMINATE_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_TERMINATE_JOB\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_terminate_job(msg);\n\t\tbreak;\n\tcase REQUEST_COMPLETE_BATCH_SCRIPT:\n\t\tdebug2(\"Processing RPC: REQUEST_COMPLETE_BATCH_SCRIPT\");\n\t\t_rpc_complete_batch(msg);\n\t\tbreak;\n\tcase REQUEST_UPDATE_JOB_TIME:\n\t\tdebug2(\"Processing RPC: REQUEST_UPDATE_JOB_TIME\");\n\t\t_rpc_update_time(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_SHUTDOWN:\n\t\tdebug2(\"Processing RPC: REQUEST_SHUTDOWN\");\n\t\t_rpc_shutdown(msg);\n\t\tbreak;\n\tcase REQUEST_RECONFIGURE:\n\t\tdebug2(\"Processing RPC: REQUEST_RECONFIGURE\");\n\t\t_rpc_reconfig(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_REBOOT_NODES:\n\t\tdebug2(\"Processing RPC: REQUEST_REBOOT_NODES\");\n\t\t_rpc_reboot(msg);\n\t\tbreak;\n\tcase REQUEST_NODE_REGISTRATION_STATUS:\n\t\tdebug2(\"Processing RPC: REQUEST_NODE_REGISTRATION_STATUS\");\n\t\t/* Treat as ping (for slurmctld agent, just return SUCCESS) */\n\t\trc = _rpc_ping(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t/* Then initiate a separate node registration */\n\t\tif (rc == SLURM_SUCCESS)\n\t\t\tsend_registration_msg(SLURM_SUCCESS, true);\n\t\tbreak;\n\tcase REQUEST_PING:\n\t\t_rpc_ping(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_HEALTH_CHECK:\n\t\tdebug2(\"Processing RPC: REQUEST_HEALTH_CHECK\");\n\t\t_rpc_health_check(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ACCT_GATHER_UPDATE:\n\t\tdebug2(\"Processing RPC: REQUEST_ACCT_GATHER_UPDATE\");\n\t\t_rpc_acct_gather_update(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ACCT_GATHER_ENERGY:\n\t\tdebug2(\"Processing RPC: REQUEST_ACCT_GATHER_ENERGY\");\n\t\t_rpc_acct_gather_energy(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_ID:\n\t\t_rpc_pid2jid(msg);\n\t\tbreak;\n\tcase REQUEST_FILE_BCAST:\n\t\trc = _rpc_file_bcast(msg);\n\t\tslurm_send_rc_msg(msg, rc);\n\t\tbreak;\n\tcase REQUEST_STEP_COMPLETE:\n\t\t(void) _rpc_step_complete(msg);\n\t\tbreak;\n\tcase REQUEST_STEP_COMPLETE_AGGR:\n\t\t(void) _rpc_step_complete_aggr(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_STEP_STAT:\n\t\t(void) _rpc_stat_jobacct(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_STEP_PIDS:\n\t\t(void) _rpc_list_pids(msg);\n\t\tbreak;\n\tcase REQUEST_DAEMON_STATUS:\n\t\t_rpc_daemon_status(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_NOTIFY:\n\t\t_rpc_job_notify(msg);\n\t\tbreak;\n\tcase REQUEST_FORWARD_DATA:\n\t\t_rpc_forward_data(msg);\n\t\tbreak;\n\tcase REQUEST_NETWORK_CALLERID:\n\t\tdebug2(\"Processing RPC: REQUEST_NETWORK_CALLERID\");\n\t\t_rpc_network_callerid(msg);\n\t\tbreak;\n\tcase MESSAGE_COMPOSITE:\n\t\terror(\"Processing RPC: MESSAGE_COMPOSITE: \"\n\t\t      \"This should never happen\");\n\t\tmsg_aggr_add_msg(msg, 0, NULL);\n\t\tbreak;\n\tcase RESPONSE_MESSAGE_COMPOSITE:\n\t\tdebug2(\"Processing RPC: RESPONSE_MESSAGE_COMPOSITE\");\n\t\tmsg_aggr_resp(msg);\n\t\tbreak;\n\tdefault:\n\t\terror(\"slurmd_req: invalid request msg type %d\",\n\t\t      msg->msg_type);\n\t\tslurm_send_rc_msg(msg, EINVAL);\n\t\tbreak;\n\t}\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_topo_fini",
          "args": [],
          "line": 1722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gres_plugin_fini",
          "args": [],
          "line": 1721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node_fini2",
          "args": [],
          "line": 1720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_auth_fini",
          "args": [],
          "line": 1719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_proctrack_fini",
          "args": [],
          "line": 1718
        },
        "resolved": true,
        "details": {
          "function_name": "slurm_proctrack_fini",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "142-153",
          "snippet": "extern int slurm_proctrack_fini(void)\n{\n\tint rc;\n\n\tif (!g_context)\n\t\treturn SLURM_SUCCESS;\n\n\tinit_run = false;\n\trc = plugin_context_destroy(g_context);\n\tg_context = NULL;\n\treturn rc;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static plugin_context_t *g_context = NULL;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic plugin_context_t *g_context = NULL;\nstatic bool init_run = false;\n\nextern int slurm_proctrack_fini(void)\n{\n\tint rc;\n\n\tif (!g_context)\n\t\treturn SLURM_SUCCESS;\n\n\tinit_run = false;\n\trc = plugin_context_destroy(g_context);\n\tg_context = NULL;\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_conf_destroy",
          "args": [],
          "line": 1717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurmd_task_fini",
          "args": [],
          "line": 1716
        },
        "resolved": true,
        "details": {
          "function_name": "slurmd_task_fini",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/task_plugin.c",
          "lines": "164-189",
          "snippet": "extern int slurmd_task_fini(void)\n{\n\tint i, rc = SLURM_SUCCESS;\n\n\tslurm_mutex_lock( &g_task_context_lock );\n\tif (!g_task_context)\n\t\tgoto done;\n\n\tinit_run = false;\n\tfor (i = 0; i < g_task_context_num; i++) {\n\t\tif (g_task_context[i]) {\n\t\t\tif (plugin_context_destroy(g_task_context[i]) !=\n\t\t\t    SLURM_SUCCESS) {\n\t\t\t\trc = SLURM_ERROR;\n\t\t\t}\n\t\t}\n\t}\n\n\txfree(ops);\n\txfree(g_task_context);\n\tg_task_context_num = -1;\n\ndone:\n\tslurm_mutex_unlock( &g_task_context_lock );\n\treturn rc;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/plugin.h\"",
            "#include <pthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static slurmd_task_ops_t *ops = NULL;",
            "static plugin_context_t\t**g_task_context = NULL;",
            "static int\t\t\tg_task_context_num = -1;",
            "static pthread_mutex_t\t\tg_task_context_lock = PTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/plugin.h\"\n#include <pthread.h>\n\nstatic slurmd_task_ops_t *ops = NULL;\nstatic plugin_context_t\t**g_task_context = NULL;\nstatic int\t\t\tg_task_context_num = -1;\nstatic pthread_mutex_t\t\tg_task_context_lock = PTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int slurmd_task_fini(void)\n{\n\tint i, rc = SLURM_SUCCESS;\n\n\tslurm_mutex_lock( &g_task_context_lock );\n\tif (!g_task_context)\n\t\tgoto done;\n\n\tinit_run = false;\n\tfor (i = 0; i < g_task_context_num; i++) {\n\t\tif (g_task_context[i]) {\n\t\t\tif (plugin_context_destroy(g_task_context[i]) !=\n\t\t\t    SLURM_SUCCESS) {\n\t\t\t\trc = SLURM_ERROR;\n\t\t\t}\n\t\t}\n\t}\n\n\txfree(ops);\n\txfree(g_task_context);\n\tg_task_context_num = -1;\n\ndone:\n\tslurm_mutex_unlock( &g_task_context_lock );\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "switch_fini",
          "args": [],
          "line": 1715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "save_cred_state",
          "args": [
            "conf->vctx"
          ],
          "line": 1714
        },
        "resolved": true,
        "details": {
          "function_name": "save_cred_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1742-1795",
          "snippet": "int save_cred_state(slurm_cred_ctx_t ctx)\n{\n\tchar *old_file, *new_file, *reg_file;\n\tint cred_fd = -1, error_code = SLURM_SUCCESS, rc;\n\tBuf buffer = NULL;\n\tstatic pthread_mutex_t state_mutex = PTHREAD_MUTEX_INITIALIZER;\n\n\told_file = xstrdup(conf->spooldir);\n\txstrcat(old_file, \"/cred_state.old\");\n\treg_file = xstrdup(conf->spooldir);\n\txstrcat(reg_file, \"/cred_state\");\n\tnew_file = xstrdup(conf->spooldir);\n\txstrcat(new_file, \"/cred_state.new\");\n\n\tslurm_mutex_lock(&state_mutex);\n\tif ((cred_fd = creat(new_file, 0600)) < 0) {\n\t\terror(\"creat(%s): %m\", new_file);\n\t\tif (errno == ENOSPC)\n\t\t\t_drain_node(\"SlurmdSpoolDir is full\");\n\t\terror_code = errno;\n\t\tgoto cleanup;\n\t}\n\tbuffer = init_buf(1024);\n\tslurm_cred_ctx_pack(ctx, buffer);\n\trc = write(cred_fd, get_buf_data(buffer), get_buf_offset(buffer));\n\tif (rc != get_buf_offset(buffer)) {\n\t\terror(\"write %s error %m\", new_file);\n\t\t(void) unlink(new_file);\n\t\tif ((rc < 0) && (errno == ENOSPC))\n\t\t\t_drain_node(\"SlurmdSpoolDir is full\");\n\t\terror_code = errno;\n\t\tgoto cleanup;\n\t}\n\t(void) unlink(old_file);\n\tif (link(reg_file, old_file))\n\t\tdebug4(\"unable to create link for %s -> %s: %m\",\n\t\t       reg_file, old_file);\n\t(void) unlink(reg_file);\n\tif (link(new_file, reg_file))\n\t\tdebug4(\"unable to create link for %s -> %s: %m\",\n\t\t       new_file, reg_file);\n\t(void) unlink(new_file);\n\ncleanup:\n\tslurm_mutex_unlock(&state_mutex);\n\txfree(old_file);\n\txfree(reg_file);\n\txfree(new_file);\n\tif (buffer)\n\t\tfree_buf(buffer);\n\tif (cred_fd > 0)\n\t\tclose(cred_fd);\n\treturn error_code;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static int       _restore_cred_state(slurm_cred_ctx_t ctx);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic int       _restore_cred_state(slurm_cred_ctx_t ctx);\n\nint save_cred_state(slurm_cred_ctx_t ctx)\n{\n\tchar *old_file, *new_file, *reg_file;\n\tint cred_fd = -1, error_code = SLURM_SUCCESS, rc;\n\tBuf buffer = NULL;\n\tstatic pthread_mutex_t state_mutex = PTHREAD_MUTEX_INITIALIZER;\n\n\told_file = xstrdup(conf->spooldir);\n\txstrcat(old_file, \"/cred_state.old\");\n\treg_file = xstrdup(conf->spooldir);\n\txstrcat(reg_file, \"/cred_state\");\n\tnew_file = xstrdup(conf->spooldir);\n\txstrcat(new_file, \"/cred_state.new\");\n\n\tslurm_mutex_lock(&state_mutex);\n\tif ((cred_fd = creat(new_file, 0600)) < 0) {\n\t\terror(\"creat(%s): %m\", new_file);\n\t\tif (errno == ENOSPC)\n\t\t\t_drain_node(\"SlurmdSpoolDir is full\");\n\t\terror_code = errno;\n\t\tgoto cleanup;\n\t}\n\tbuffer = init_buf(1024);\n\tslurm_cred_ctx_pack(ctx, buffer);\n\trc = write(cred_fd, get_buf_data(buffer), get_buf_offset(buffer));\n\tif (rc != get_buf_offset(buffer)) {\n\t\terror(\"write %s error %m\", new_file);\n\t\t(void) unlink(new_file);\n\t\tif ((rc < 0) && (errno == ENOSPC))\n\t\t\t_drain_node(\"SlurmdSpoolDir is full\");\n\t\terror_code = errno;\n\t\tgoto cleanup;\n\t}\n\t(void) unlink(old_file);\n\tif (link(reg_file, old_file))\n\t\tdebug4(\"unable to create link for %s -> %s: %m\",\n\t\t       reg_file, old_file);\n\t(void) unlink(reg_file);\n\tif (link(new_file, reg_file))\n\t\tdebug4(\"unable to create link for %s -> %s: %m\",\n\t\t       new_file, reg_file);\n\t(void) unlink(new_file);\n\ncleanup:\n\tslurm_mutex_unlock(&state_mutex);\n\txfree(old_file);\n\txfree(reg_file);\n\txfree(new_file);\n\tif (buffer)\n\t\tfree_buf(buffer);\n\tif (cred_fd > 0)\n\t\tclose(cred_fd);\n\treturn error_code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "acct_gather_profile_fini",
          "args": [],
          "line": 1713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jobacct_gather_fini",
          "args": [],
          "line": 1712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "switch_g_node_fini",
          "args": [],
          "line": 1711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "core_spec_g_fini",
          "args": [],
          "line": 1710
        },
        "resolved": true,
        "details": {
          "function_name": "core_spec_g_fini",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/core_spec_plugin.c",
          "lines": "144-169",
          "snippet": "extern int core_spec_g_fini(void)\n{\n\tint i, rc = SLURM_SUCCESS;\n\n\tslurm_mutex_lock(&g_core_spec_context_lock);\n\tif (!g_core_spec_context)\n\t\tgoto done;\n\n\tinit_run = false;\n\tfor (i = 0; i < g_core_spec_context_num; i++) {\n\t\tif (g_core_spec_context[i]) {\n\t\t\tif (plugin_context_destroy(g_core_spec_context[i])\n\t\t\t    != SLURM_SUCCESS) {\n\t\t\t\trc = SLURM_ERROR;\n\t\t\t}\n\t\t}\n\t}\n\n\txfree(ops);\n\txfree(g_core_spec_context);\n\tg_core_spec_context_num = -1;\n\ndone:\n\tslurm_mutex_unlock(&g_core_spec_context_lock);\n\treturn rc;\n}",
          "includes": [
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/plugin.h\"",
            "#include <pthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static core_spec_ops_t\t\t*ops = NULL;",
            "static plugin_context_t\t\t**g_core_spec_context = NULL;",
            "static int\t\t\tg_core_spec_context_num = -1;",
            "static pthread_mutex_t\t\tg_core_spec_context_lock =\n\t\t\t\t\tPTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/plugin.h\"\n#include <pthread.h>\n\nstatic core_spec_ops_t\t\t*ops = NULL;\nstatic plugin_context_t\t\t**g_core_spec_context = NULL;\nstatic int\t\t\tg_core_spec_context_num = -1;\nstatic pthread_mutex_t\t\tg_core_spec_context_lock =\n\t\t\t\t\tPTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int core_spec_g_fini(void)\n{\n\tint i, rc = SLURM_SUCCESS;\n\n\tslurm_mutex_lock(&g_core_spec_context_lock);\n\tif (!g_core_spec_context)\n\t\tgoto done;\n\n\tinit_run = false;\n\tfor (i = 0; i < g_core_spec_context_num; i++) {\n\t\tif (g_core_spec_context[i]) {\n\t\t\tif (plugin_context_destroy(g_core_spec_context[i])\n\t\t\t    != SLURM_SUCCESS) {\n\t\t\t\trc = SLURM_ERROR;\n\t\t\t}\n\t\t}\n\t}\n\n\txfree(ops);\n\txfree(g_core_spec_context);\n\tg_core_spec_context_num = -1;\n\ndone:\n\tslurm_mutex_unlock(&g_core_spec_context_lock);\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "node_features_g_fini",
          "args": [],
          "line": 1709
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _resource_spec_fini(void);\nstatic int       _slurmd_fini(void);\n\nstatic int\n_slurmd_fini(void)\n{\n\tnode_features_g_fini();\n\tcore_spec_g_fini();\n\tswitch_g_node_fini();\n\tjobacct_gather_fini();\n\tacct_gather_profile_fini();\n\tsave_cred_state(conf->vctx);\n\tswitch_fini();\n\tslurmd_task_fini();\n\tslurm_conf_destroy();\n\tslurm_proctrack_fini();\n\tslurm_auth_fini();\n\tnode_fini2();\n\tgres_plugin_fini();\n\tslurm_topo_fini();\n\tslurmd_req(NULL);\t/* purge memory allocated by slurmd_req() */\n\tfini_setproctitle();\n\tslurm_select_fini();\n\tspank_slurmd_exit();\n\tcpu_freq_fini();\n\t_resource_spec_fini();\n\tjob_container_fini();\n\tacct_gather_conf_destroy();\n\tfini_system_cgroup();\n\troute_fini();\n\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "_restore_cred_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1656-1693",
    "snippet": "static int\n_restore_cred_state(slurm_cred_ctx_t ctx)\n{\n\tchar *file_name = NULL, *data = NULL;\n\tuint32_t data_size = 0;\n\tint cred_fd, data_allocated, data_read = 0;\n\tBuf buffer = NULL;\n\n\tif ( (mkdir(conf->spooldir, 0755) < 0) && (errno != EEXIST) ) {\n\t\tfatal(\"mkdir(%s): %m\", conf->spooldir);\n\t\treturn SLURM_ERROR;\n\t}\n\n\tfile_name = xstrdup(conf->spooldir);\n\txstrcat(file_name, \"/cred_state\");\n\tcred_fd = open(file_name, O_RDONLY);\n\tif (cred_fd < 0)\n\t\tgoto cleanup;\n\n\tdata_allocated = 1024;\n\tdata = xmalloc(sizeof(char)*data_allocated);\n\twhile ((data_read = read(cred_fd, &data[data_size], 1024)) == 1024) {\n\t\tdata_size += data_read;\n\t\tdata_allocated += 1024;\n\t\txrealloc(data, data_allocated);\n\t}\n\tdata_size += data_read;\n\tclose(cred_fd);\n\tbuffer = create_buf(data, data_size);\n\n\tslurm_cred_ctx_unpack(ctx, buffer);\n\ncleanup:\n\txfree(file_name);\n\tif (buffer)\n\t\tfree_buf(buffer);\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static int       _restore_cred_state(slurm_cred_ctx_t ctx);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_buf",
          "args": [
            "buffer"
          ],
          "line": 1691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "file_name"
          ],
          "line": 1689
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_cred_ctx_unpack",
          "args": [
            "ctx",
            "buffer"
          ],
          "line": 1686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_buf",
          "args": [
            "data",
            "data_size"
          ],
          "line": 1684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "cred_fd"
          ],
          "line": 1683
        },
        "resolved": true,
        "details": {
          "function_name": "_file_bcast_close_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "3635-3640",
          "snippet": "static void _file_bcast_close_file(file_bcast_info_t *key)\n{\n\t_fb_wrlock();\n\tlist_delete_all(file_bcast_list, _bcast_find_in_list, key);\n\t_fb_wrunlock();\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int  _job_limits_match(void *x, void *key);",
            "static int  _step_limits_match(void *x, void *key);",
            "static int  _file_bcast_register_file(slurm_msg_t *msg,\n\t\t\t\t      file_bcast_info_t *key);",
            "static List file_bcast_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic int  _job_limits_match(void *x, void *key);\nstatic int  _step_limits_match(void *x, void *key);\nstatic int  _file_bcast_register_file(slurm_msg_t *msg,\n\t\t\t\t      file_bcast_info_t *key);\nstatic List file_bcast_list = NULL;\n\nstatic void _file_bcast_close_file(file_bcast_info_t *key)\n{\n\t_fb_wrlock();\n\tlist_delete_all(file_bcast_list, _bcast_find_in_list, key);\n\t_fb_wrunlock();\n}"
        }
      },
      {
        "call_info": {
          "callee": "xrealloc",
          "args": [
            "data",
            "data_allocated"
          ],
          "line": 1680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "cred_fd",
            "&data[data_size]",
            "1024"
          ],
          "line": 1677
        },
        "resolved": true,
        "details": {
          "function_name": "_file_read_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1149-1197",
          "snippet": "int _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "sizeof(char)*data_allocated"
          ],
          "line": 1676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "file_name",
            "O_RDONLY"
          ],
          "line": 1671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrcat",
          "args": [
            "file_name",
            "\"/cred_state\""
          ],
          "line": 1670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "conf->spooldir"
          ],
          "line": 1669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"mkdir(%s): %m\"",
            "conf->spooldir"
          ],
          "line": 1665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mkdir",
          "args": [
            "conf->spooldir",
            "0755"
          ],
          "line": 1664
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic int       _restore_cred_state(slurm_cred_ctx_t ctx);\n\nstatic int\n_restore_cred_state(slurm_cred_ctx_t ctx)\n{\n\tchar *file_name = NULL, *data = NULL;\n\tuint32_t data_size = 0;\n\tint cred_fd, data_allocated, data_read = 0;\n\tBuf buffer = NULL;\n\n\tif ( (mkdir(conf->spooldir, 0755) < 0) && (errno != EEXIST) ) {\n\t\tfatal(\"mkdir(%s): %m\", conf->spooldir);\n\t\treturn SLURM_ERROR;\n\t}\n\n\tfile_name = xstrdup(conf->spooldir);\n\txstrcat(file_name, \"/cred_state\");\n\tcred_fd = open(file_name, O_RDONLY);\n\tif (cred_fd < 0)\n\t\tgoto cleanup;\n\n\tdata_allocated = 1024;\n\tdata = xmalloc(sizeof(char)*data_allocated);\n\twhile ((data_read = read(cred_fd, &data[data_size], 1024)) == 1024) {\n\t\tdata_size += data_read;\n\t\tdata_allocated += 1024;\n\t\txrealloc(data, data_allocated);\n\t}\n\tdata_size += data_read;\n\tclose(cred_fd);\n\tbuffer = create_buf(data, data_size);\n\n\tslurm_cred_ctx_unpack(ctx, buffer);\n\ncleanup:\n\txfree(file_name);\n\tif (buffer)\n\t\tfree_buf(buffer);\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "_slurmd_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1480-1654",
    "snippet": "static int\n_slurmd_init(void)\n{\n\tstruct rlimit rlim;\n\tstruct stat stat_buf;\n\tuint32_t cpu_cnt;\n\n\t/*\n\t * Process commandline arguments first, since one option may be\n\t * an alternate location for the slurm config file.\n\t */\n\t_process_cmdline(*conf->argc, *conf->argv);\n\n\t/*\n\t * Build nodes table like in slurmctld\n\t * This is required by the topology stack\n\t * Node tables setup must precede _read_config() so that the\n\t * proper hostname is set.\n\t */\n\tslurm_conf_init(conf->conffile);\n\tinit_node_conf();\n\t/* slurm_select_init() must be called before\n\t * build_all_nodeline_info() to be called with proper argument. */\n\tif (slurm_select_init(1) != SLURM_SUCCESS )\n\t\treturn SLURM_FAILURE;\n\tbuild_all_nodeline_info(true);\n\tbuild_all_frontend_info(true);\n\n\t/*\n\t * Read global slurm config file, override necessary values from\n\t * defaults and command line.\n\t */\n\t_read_config();\n\n\tcpu_cnt = MAX(conf->conf_cpus, conf->block_map_size);\n\n\tif ((gres_plugin_init() != SLURM_SUCCESS) ||\n\t    (gres_plugin_node_config_load(cpu_cnt, conf->node_name, NULL)\n\t     != SLURM_SUCCESS))\n\t\treturn SLURM_FAILURE;\n\tif (slurm_topo_init() != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\n\t/*\n\t * Get and set slurmd topology information\n\t * Build node hash table first to speed up the topo build\n\t */\n\trehash_node();\n\tslurm_topo_build_config();\n\t_set_topo_info();\n\n\troute_init(conf->node_name);\n\n\t/*\n\t * Check for cpu frequency set capabilities on this node\n\t */\n\tcpu_freq_init(conf);\n\n\t/*\n\t * If configured, apply resource specialization\n\t */\n\t_resource_spec_init();\n\n\t_print_conf();\n\n\tif (slurm_proctrack_init() != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\tif (slurmd_task_init() != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\tif (slurm_auth_init(NULL) != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\tif (spank_slurmd_init() < 0)\n\t\treturn SLURM_FAILURE;\n\n\tif (getrlimit(RLIMIT_CPU, &rlim) == 0) {\n\t\trlim.rlim_cur = rlim.rlim_max;\n\t\tsetrlimit(RLIMIT_CPU, &rlim);\n\t\tif (rlim.rlim_max != RLIM_INFINITY) {\n\t\t\terror(\"Slurmd process CPU time limit is %d seconds\",\n\t\t\t      (int) rlim.rlim_max);\n\t\t}\n\t}\n\n\tif (getrlimit(RLIMIT_NOFILE, &rlim) == 0) {\n\t\trlim.rlim_cur = rlim.rlim_max;\n\t\tsetrlimit(RLIMIT_NOFILE, &rlim);\n\t}\n#ifndef NDEBUG\n\tif (getrlimit(RLIMIT_CORE, &rlim) == 0) {\n\t\trlim.rlim_cur = rlim.rlim_max;\n\t\tsetrlimit(RLIMIT_CORE, &rlim);\n\t}\n#endif /* !NDEBUG */\n\n\t/*\n\t * Create a context for verifying slurm job credentials\n\t */\n\tif (!(conf->vctx = slurm_cred_verifier_ctx_create(conf->pubkey)))\n\t\treturn SLURM_FAILURE;\n\tif (!xstrcmp(conf->select_type, \"select/serial\")) {\n\t\t/* Only cache credential for 5 seconds with select/serial\n\t\t * for shorter cache searches and higher throughput */\n\t\tslurm_cred_ctx_set(conf->vctx, SLURM_CRED_OPT_EXPIRY_WINDOW, 5);\n\t}\n\n\t/*\n\t * Create slurmd spool directory if necessary.\n\t */\n\tif (_set_slurmd_spooldir() < 0) {\n\t\terror(\"Unable to initialize slurmd spooldir\");\n\t\treturn SLURM_FAILURE;\n\t}\n\n\tif (conf->cleanstart) {\n\t\t/*\n\t\t * Need to kill any running slurmd's here\n\t\t */\n\t\t_kill_old_slurmd();\n\n\t\tstepd_cleanup_sockets(conf->spooldir, conf->node_name);\n\t\t_stepd_cleanup_batch_dirs(conf->spooldir, conf->node_name);\n\t}\n\n\tif (conf->daemonize) {\n\t\tbool success = false;\n\n\t\tif (conf->logfile && (conf->logfile[0] == '/')) {\n\t\t\tchar *slash_ptr, *work_dir;\n\t\t\twork_dir = xstrdup(conf->logfile);\n\t\t\tslash_ptr = strrchr(work_dir, '/');\n\t\t\tif (slash_ptr == work_dir)\n\t\t\t\twork_dir[1] = '\\0';\n\t\t\telse\n\t\t\t\tslash_ptr[0] = '\\0';\n\t\t\tif ((access(work_dir, W_OK) != 0) ||\n\t\t\t    (chdir(work_dir) < 0)) {\n\t\t\t\terror(\"Unable to chdir to %s\", work_dir);\n\t\t\t} else\n\t\t\t\tsuccess = true;\n\t\t\txfree(work_dir);\n\t\t}\n\n\t\tif (!success) {\n\t\t\tif ((access(conf->spooldir, W_OK) != 0) ||\n\t\t\t    (chdir(conf->spooldir) < 0)) {\n\t\t\t\terror(\"Unable to chdir to %s\", conf->spooldir);\n\t\t\t} else\n\t\t\t\tsuccess = true;\n\t\t}\n\n\t\tif (!success) {\n\t\t\tif ((access(\"/var/tmp\", W_OK) != 0) ||\n\t\t\t    (chdir(\"/var/tmp\") < 0)) {\n\t\t\t\terror(\"chdir(/var/tmp): %m\");\n\t\t\t\treturn SLURM_FAILURE;\n\t\t\t} else\n\t\t\t\tinfo(\"chdir to /var/tmp\");\n\t\t}\n\t}\n\n\tif ((devnull = open_cloexec(\"/dev/null\", O_RDWR)) < 0) {\n\t\terror(\"Unable to open /dev/null: %m\");\n\t\treturn SLURM_FAILURE;\n\t}\n\n\t/* make sure we have slurmstepd installed */\n\tif (stat(conf->stepd_loc, &stat_buf))\n\t\tfatal(\"Unable to find slurmstepd file at %s\", conf->stepd_loc);\n\tif (!S_ISREG(stat_buf.st_mode))\n\t\tfatal(\"slurmstepd not a file at %s\", conf->stepd_loc);\n\tif (conf->chos_loc && (access(conf->chos_loc, X_OK) != 0))\n\t\terror(\"Unable to execute ChosLoc at %s: %m\", conf->chos_loc);\n\n\treturn SLURM_SUCCESS;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int devnull = -1;",
      "slurmd_conf_t * conf = NULL;",
      "static void      _kill_old_slurmd(void);",
      "static void      _print_conf(void);",
      "static void      _read_config(void);",
      "static int       _resource_spec_init(void);",
      "static int       _set_slurmd_spooldir(void);",
      "static int       _set_topo_info(void);",
      "static int       _slurmd_init(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Unable to execute ChosLoc at %s: %m\"",
            "conf->chos_loc"
          ],
          "line": 1651
        },
        "resolved": true,
        "details": {
          "function_name": "_prolog_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "1386-1434",
          "snippet": "static void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _is_batch_job_finished(uint32_t job_id);",
            "static bool _job_still_running(uint32_t job_id);",
            "static void _launch_complete_add(uint32_t job_id);",
            "static void _launch_complete_log(char *type, uint32_t job_id);",
            "static void _launch_complete_rm(uint32_t job_id);",
            "static void _launch_complete_wait(uint32_t job_id);",
            "static bool _launch_job_test(uint32_t job_id);",
            "static void _note_batch_job_finished(uint32_t job_id);",
            "static bool _slurm_authorized_user(uid_t uid);",
            "static void _sync_messages_kill(kill_job_msg_t *req);",
            "static int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);",
            "static gids_t *_gids_cache_lookup(char *user, gid_t gid);",
            "static int  _add_starting_step(uint16_t type, void *req);",
            "static int  _remove_starting_step(uint16_t type, void *req);",
            "static void _add_job_running_prolog(uint32_t job_id);",
            "static void _remove_job_running_prolog(uint32_t job_id);",
            "static void _wait_for_job_running_prolog(uint32_t job_id);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic bool _is_batch_job_finished(uint32_t job_id);\nstatic bool _job_still_running(uint32_t job_id);\nstatic void _launch_complete_add(uint32_t job_id);\nstatic void _launch_complete_log(char *type, uint32_t job_id);\nstatic void _launch_complete_rm(uint32_t job_id);\nstatic void _launch_complete_wait(uint32_t job_id);\nstatic bool _launch_job_test(uint32_t job_id);\nstatic void _note_batch_job_finished(uint32_t job_id);\nstatic bool _slurm_authorized_user(uid_t uid);\nstatic void _sync_messages_kill(kill_job_msg_t *req);\nstatic int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);\nstatic gids_t *_gids_cache_lookup(char *user, gid_t gid);\nstatic int  _add_starting_step(uint16_t type, void *req);\nstatic int  _remove_starting_step(uint16_t type, void *req);\nstatic void _add_job_running_prolog(uint32_t job_id);\nstatic void _remove_job_running_prolog(uint32_t job_id);\nstatic void _wait_for_job_running_prolog(uint32_t job_id);\n\nstatic void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "conf->chos_loc",
            "X_OK"
          ],
          "line": 1650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"slurmstepd not a file at %s\"",
            "conf->stepd_loc"
          ],
          "line": 1649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "stat_buf.st_mode"
          ],
          "line": 1648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"Unable to find slurmstepd file at %s\"",
            "conf->stepd_loc"
          ],
          "line": 1647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "conf->stepd_loc",
            "&stat_buf"
          ],
          "line": 1646
        },
        "resolved": true,
        "details": {
          "function_name": "_wait_state_completed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "4259-4271",
          "snippet": "static void\n_wait_state_completed(uint32_t jobid, int max_delay)\n{\n\tint i;\n\n\tfor (i=0; i<max_delay; i++) {\n\t\tif (_steps_completed_now(jobid))\n\t\t\tbreak;\n\t\tsleep(1);\n\t}\n\tif (i >= max_delay)\n\t\terror(\"timed out waiting for job %u to complete\", jobid);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int  _prolog_is_running (uint32_t jobid);",
            "static int  _waiter_init (uint32_t jobid);",
            "static int  _waiter_complete (uint32_t jobid);",
            "static bool _steps_completed_now(uint32_t jobid);",
            "static void _wait_state_completed(uint32_t jobid, int max_delay);",
            "static uid_t _get_job_uid(uint32_t jobid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic int  _prolog_is_running (uint32_t jobid);\nstatic int  _waiter_init (uint32_t jobid);\nstatic int  _waiter_complete (uint32_t jobid);\nstatic bool _steps_completed_now(uint32_t jobid);\nstatic void _wait_state_completed(uint32_t jobid, int max_delay);\nstatic uid_t _get_job_uid(uint32_t jobid);\n\nstatic void\n_wait_state_completed(uint32_t jobid, int max_delay)\n{\n\tint i;\n\n\tfor (i=0; i<max_delay; i++) {\n\t\tif (_steps_completed_now(jobid))\n\t\t\tbreak;\n\t\tsleep(1);\n\t}\n\tif (i >= max_delay)\n\t\terror(\"timed out waiting for job %u to complete\", jobid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Unable to open /dev/null: %m\""
          ],
          "line": 1641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open_cloexec",
          "args": [
            "\"/dev/null\"",
            "O_RDWR"
          ],
          "line": 1640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"chdir to /var/tmp\""
          ],
          "line": 1636
        },
        "resolved": true,
        "details": {
          "function_name": "_free_file_bcast_info_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "3642-3648",
          "snippet": "static void _free_file_bcast_info_t(file_bcast_info_t *f)\n{\n\txfree(f->fname);\n\tif (f->fd)\n\t\tclose(f->fd);\n\txfree(f);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic void _free_file_bcast_info_t(file_bcast_info_t *f)\n{\n\txfree(f->fname);\n\tif (f->fd)\n\t\tclose(f->fd);\n\txfree(f);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"chdir(/var/tmp): %m\""
          ],
          "line": 1633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chdir",
          "args": [
            "\"/var/tmp\""
          ],
          "line": 1632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "\"/var/tmp\"",
            "W_OK"
          ],
          "line": 1631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chdir",
          "args": [
            "conf->spooldir"
          ],
          "line": 1624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "conf->spooldir",
            "W_OK"
          ],
          "line": 1623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "work_dir"
          ],
          "line": 1619
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "chdir",
          "args": [
            "work_dir"
          ],
          "line": 1615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "work_dir",
            "W_OK"
          ],
          "line": 1614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "work_dir",
            "'/'"
          ],
          "line": 1609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "conf->logfile"
          ],
          "line": 1608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_stepd_cleanup_batch_dirs",
          "args": [
            "conf->spooldir",
            "conf->node_name"
          ],
          "line": 1600
        },
        "resolved": true,
        "details": {
          "function_name": "_stepd_cleanup_batch_dirs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1440-1478",
          "snippet": "static void\n_stepd_cleanup_batch_dirs(const char *directory, const char *nodename)\n{\n\tchar dir_path[MAXPATHLEN], file_path[MAXPATHLEN];\n\tDIR *dp;\n\tstruct dirent *ent;\n\tstruct stat stat_buf;\n\n\t/*\n\t * Make sure that \"directory\" exists and is a directory.\n\t */\n\tif (stat(directory, &stat_buf) < 0) {\n\t\terror(\"SlurmdSpoolDir stat error %s: %m\", directory);\n\t\treturn;\n\t} else if (!S_ISDIR(stat_buf.st_mode)) {\n\t\terror(\"SlurmdSpoolDir is not a directory %s\", directory);\n\t\treturn;\n\t}\n\n\tif ((dp = opendir(directory)) == NULL) {\n\t\terror(\"SlurmdSpoolDir open error %s: %m\", directory);\n\t\treturn;\n\t}\n\n\twhile ((ent = readdir(dp)) != NULL) {\n\t\tif (!xstrncmp(ent->d_name, \"job\", 3) &&\n\t\t    (ent->d_name[3] >= '0') && (ent->d_name[3] <= '9')) {\n\t\t\tsnprintf(dir_path, sizeof(dir_path),\n\t\t\t\t \"%s/%s\", directory, ent->d_name);\n\t\t\tsnprintf(file_path, sizeof(file_path),\n\t\t\t\t \"%s/slurm_script\", dir_path);\n\t\t\tinfo(\"%s: Purging vestigial job script %s\",\n\t\t\t     __func__, file_path);\n\t\t\t(void) unlink(file_path);\n\t\t\t(void) rmdir(dir_path);\n\t\t}\n\t}\n\tclosedir(dp);\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic void\n_stepd_cleanup_batch_dirs(const char *directory, const char *nodename)\n{\n\tchar dir_path[MAXPATHLEN], file_path[MAXPATHLEN];\n\tDIR *dp;\n\tstruct dirent *ent;\n\tstruct stat stat_buf;\n\n\t/*\n\t * Make sure that \"directory\" exists and is a directory.\n\t */\n\tif (stat(directory, &stat_buf) < 0) {\n\t\terror(\"SlurmdSpoolDir stat error %s: %m\", directory);\n\t\treturn;\n\t} else if (!S_ISDIR(stat_buf.st_mode)) {\n\t\terror(\"SlurmdSpoolDir is not a directory %s\", directory);\n\t\treturn;\n\t}\n\n\tif ((dp = opendir(directory)) == NULL) {\n\t\terror(\"SlurmdSpoolDir open error %s: %m\", directory);\n\t\treturn;\n\t}\n\n\twhile ((ent = readdir(dp)) != NULL) {\n\t\tif (!xstrncmp(ent->d_name, \"job\", 3) &&\n\t\t    (ent->d_name[3] >= '0') && (ent->d_name[3] <= '9')) {\n\t\t\tsnprintf(dir_path, sizeof(dir_path),\n\t\t\t\t \"%s/%s\", directory, ent->d_name);\n\t\t\tsnprintf(file_path, sizeof(file_path),\n\t\t\t\t \"%s/slurm_script\", dir_path);\n\t\t\tinfo(\"%s: Purging vestigial job script %s\",\n\t\t\t     __func__, file_path);\n\t\t\t(void) unlink(file_path);\n\t\t\t(void) rmdir(dir_path);\n\t\t}\n\t}\n\tclosedir(dp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "stepd_cleanup_sockets",
          "args": [
            "conf->spooldir",
            "conf->node_name"
          ],
          "line": 1599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_kill_old_slurmd",
          "args": [],
          "line": 1597
        },
        "resolved": true,
        "details": {
          "function_name": "_kill_old_slurmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1890-1908",
          "snippet": "static void\n_kill_old_slurmd(void)\n{\n\tint fd;\n\tpid_t oldpid = read_pidfile(conf->pidfile, &fd);\n\tif (oldpid != (pid_t) 0) {\n\t\tinfo (\"killing old slurmd[%lu]\", (unsigned long) oldpid);\n\t\tkill(oldpid, SIGTERM);\n\n\t\t/*\n\t\t * Wait for previous daemon to terminate\n\t\t */\n\t\tif (fd_get_readw_lock(fd) < 0) {\n\t\t\tfatal (\"error getting readw lock on file %s: %m\",\n\t\t\t       conf->pidfile);\n\t\t}\n\t\t(void) close(fd); /* Ignore errors */\n\t}\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _kill_old_slurmd(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _kill_old_slurmd(void);\n\nstatic void\n_kill_old_slurmd(void)\n{\n\tint fd;\n\tpid_t oldpid = read_pidfile(conf->pidfile, &fd);\n\tif (oldpid != (pid_t) 0) {\n\t\tinfo (\"killing old slurmd[%lu]\", (unsigned long) oldpid);\n\t\tkill(oldpid, SIGTERM);\n\n\t\t/*\n\t\t * Wait for previous daemon to terminate\n\t\t */\n\t\tif (fd_get_readw_lock(fd) < 0) {\n\t\t\tfatal (\"error getting readw lock on file %s: %m\",\n\t\t\t       conf->pidfile);\n\t\t}\n\t\t(void) close(fd); /* Ignore errors */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Unable to initialize slurmd spooldir\""
          ],
          "line": 1589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_set_slurmd_spooldir",
          "args": [],
          "line": 1588
        },
        "resolved": true,
        "details": {
          "function_name": "_set_slurmd_spooldir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1862-1883",
          "snippet": "static int\n_set_slurmd_spooldir(void)\n{\n\tdebug3(\"initializing slurmd spool directory\");\n\n\tif (mkdir(conf->spooldir, 0755) < 0) {\n\t\tif (errno != EEXIST) {\n\t\t\tfatal(\"mkdir(%s): %m\", conf->spooldir);\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t}\n\n\t/*\n\t * Ensure spool directory permissions are correct.\n\t */\n\tif (chmod(conf->spooldir, 0755) < 0) {\n\t\terror(\"chmod(%s, 0755): %m\", conf->spooldir);\n\t\treturn SLURM_ERROR;\n\t}\n\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static int       _set_slurmd_spooldir(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic int       _set_slurmd_spooldir(void);\n\nstatic int\n_set_slurmd_spooldir(void)\n{\n\tdebug3(\"initializing slurmd spool directory\");\n\n\tif (mkdir(conf->spooldir, 0755) < 0) {\n\t\tif (errno != EEXIST) {\n\t\t\tfatal(\"mkdir(%s): %m\", conf->spooldir);\n\t\t\treturn SLURM_ERROR;\n\t\t}\n\t}\n\n\t/*\n\t * Ensure spool directory permissions are correct.\n\t */\n\tif (chmod(conf->spooldir, 0755) < 0) {\n\t\terror(\"chmod(%s, 0755): %m\", conf->spooldir);\n\t\treturn SLURM_ERROR;\n\t}\n\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_cred_ctx_set",
          "args": [
            "conf->vctx",
            "SLURM_CRED_OPT_EXPIRY_WINDOW",
            "5"
          ],
          "line": 1582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrcmp",
          "args": [
            "conf->select_type",
            "\"select/serial\""
          ],
          "line": 1579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_cred_verifier_ctx_create",
          "args": [
            "conf->pubkey"
          ],
          "line": 1577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setrlimit",
          "args": [
            "RLIMIT_CORE",
            "&rlim"
          ],
          "line": 1570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getrlimit",
          "args": [
            "RLIMIT_CORE",
            "&rlim"
          ],
          "line": 1568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setrlimit",
          "args": [
            "RLIMIT_NOFILE",
            "&rlim"
          ],
          "line": 1565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getrlimit",
          "args": [
            "RLIMIT_NOFILE",
            "&rlim"
          ],
          "line": 1563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setrlimit",
          "args": [
            "RLIMIT_CPU",
            "&rlim"
          ],
          "line": 1556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getrlimit",
          "args": [
            "RLIMIT_CPU",
            "&rlim"
          ],
          "line": 1554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spank_slurmd_init",
          "args": [],
          "line": 1551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_auth_init",
          "args": [
            "NULL"
          ],
          "line": 1549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurmd_task_init",
          "args": [],
          "line": 1547
        },
        "resolved": true,
        "details": {
          "function_name": "slurmd_task_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/task_plugin.c",
          "lines": "103-157",
          "snippet": "extern int slurmd_task_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"task\";\n\tchar *task_plugin_type = NULL;\n\tchar *last = NULL, *task_plugin_list, *type = NULL;\n\n\tif ( init_run && (g_task_context_num >= 0) )\n\t\treturn retval;\n\n\tslurm_mutex_lock( &g_task_context_lock );\n\n\tif ( g_task_context_num >= 0 )\n\t\tgoto done;\n\n\ttask_plugin_type = slurm_get_task_plugin();\n\tg_task_context_num = 0; /* mark it before anything else */\n\tif (task_plugin_type == NULL || task_plugin_type[0] == '\\0')\n\t\tgoto done;\n\n\ttask_plugin_list = task_plugin_type;\n\twhile ((type = strtok_r(task_plugin_list, \",\", &last))) {\n\t\txrealloc(ops,\n\t\t\t sizeof(slurmd_task_ops_t) * (g_task_context_num + 1));\n\t\txrealloc(g_task_context, (sizeof(plugin_context_t *)\n\t\t\t\t\t  * (g_task_context_num + 1)));\n\t\tif (xstrncmp(type, \"task/\", 5) == 0)\n\t\t\ttype += 5; /* backward compatibility */\n\t\ttype = xstrdup_printf(\"task/%s\", type);\n\t\tg_task_context[g_task_context_num] = plugin_context_create(\n\t\t\tplugin_type, type, (void **)&ops[g_task_context_num],\n\t\t\tsyms, sizeof(syms));\n\t\tif (!g_task_context[g_task_context_num]) {\n\t\t\terror(\"cannot create %s context for %s\",\n\t\t\t      plugin_type, type);\n\t\t\txfree(type);\n\t\t\tretval = SLURM_ERROR;\n\t\t\tbreak;\n\t\t}\n\n\t\txfree(type);\n\t\tg_task_context_num++;\n\t\ttask_plugin_list = NULL; /* for next iteration */\n\t}\n\tinit_run = true;\n\n done:\n\tslurm_mutex_unlock( &g_task_context_lock );\n\txfree(task_plugin_type);\n\n\tif (retval != SLURM_SUCCESS)\n\t\tslurmd_task_fini();\n\n\treturn retval;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/plugin.h\"",
            "#include <pthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *syms[] = {\n\t\"task_p_slurmd_batch_request\",\n\t\"task_p_slurmd_launch_request\",\n\t\"task_p_slurmd_reserve_resources\",\n\t\"task_p_slurmd_suspend_job\",\n\t\"task_p_slurmd_resume_job\",\n\t\"task_p_slurmd_release_resources\",\n\t\"task_p_pre_setuid\",\n\t\"task_p_pre_launch_priv\",\n\t\"task_p_pre_launch\",\n\t\"task_p_post_term\",\n\t\"task_p_post_step\",\n\t\"task_p_add_pid\",\n};",
            "static slurmd_task_ops_t *ops = NULL;",
            "static plugin_context_t\t**g_task_context = NULL;",
            "static int\t\t\tg_task_context_num = -1;",
            "static pthread_mutex_t\t\tg_task_context_lock = PTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/plugin.h\"\n#include <pthread.h>\n\nstatic const char *syms[] = {\n\t\"task_p_slurmd_batch_request\",\n\t\"task_p_slurmd_launch_request\",\n\t\"task_p_slurmd_reserve_resources\",\n\t\"task_p_slurmd_suspend_job\",\n\t\"task_p_slurmd_resume_job\",\n\t\"task_p_slurmd_release_resources\",\n\t\"task_p_pre_setuid\",\n\t\"task_p_pre_launch_priv\",\n\t\"task_p_pre_launch\",\n\t\"task_p_post_term\",\n\t\"task_p_post_step\",\n\t\"task_p_add_pid\",\n};\nstatic slurmd_task_ops_t *ops = NULL;\nstatic plugin_context_t\t**g_task_context = NULL;\nstatic int\t\t\tg_task_context_num = -1;\nstatic pthread_mutex_t\t\tg_task_context_lock = PTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int slurmd_task_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"task\";\n\tchar *task_plugin_type = NULL;\n\tchar *last = NULL, *task_plugin_list, *type = NULL;\n\n\tif ( init_run && (g_task_context_num >= 0) )\n\t\treturn retval;\n\n\tslurm_mutex_lock( &g_task_context_lock );\n\n\tif ( g_task_context_num >= 0 )\n\t\tgoto done;\n\n\ttask_plugin_type = slurm_get_task_plugin();\n\tg_task_context_num = 0; /* mark it before anything else */\n\tif (task_plugin_type == NULL || task_plugin_type[0] == '\\0')\n\t\tgoto done;\n\n\ttask_plugin_list = task_plugin_type;\n\twhile ((type = strtok_r(task_plugin_list, \",\", &last))) {\n\t\txrealloc(ops,\n\t\t\t sizeof(slurmd_task_ops_t) * (g_task_context_num + 1));\n\t\txrealloc(g_task_context, (sizeof(plugin_context_t *)\n\t\t\t\t\t  * (g_task_context_num + 1)));\n\t\tif (xstrncmp(type, \"task/\", 5) == 0)\n\t\t\ttype += 5; /* backward compatibility */\n\t\ttype = xstrdup_printf(\"task/%s\", type);\n\t\tg_task_context[g_task_context_num] = plugin_context_create(\n\t\t\tplugin_type, type, (void **)&ops[g_task_context_num],\n\t\t\tsyms, sizeof(syms));\n\t\tif (!g_task_context[g_task_context_num]) {\n\t\t\terror(\"cannot create %s context for %s\",\n\t\t\t      plugin_type, type);\n\t\t\txfree(type);\n\t\t\tretval = SLURM_ERROR;\n\t\t\tbreak;\n\t\t}\n\n\t\txfree(type);\n\t\tg_task_context_num++;\n\t\ttask_plugin_list = NULL; /* for next iteration */\n\t}\n\tinit_run = true;\n\n done:\n\tslurm_mutex_unlock( &g_task_context_lock );\n\txfree(task_plugin_type);\n\n\tif (retval != SLURM_SUCCESS)\n\t\tslurmd_task_fini();\n\n\treturn retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_proctrack_init",
          "args": [],
          "line": 1545
        },
        "resolved": true,
        "details": {
          "function_name": "slurm_proctrack_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/proctrack.c",
          "lines": "108-137",
          "snippet": "extern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/log.h\"",
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};",
            "static slurm_proctrack_ops_t ops;",
            "static plugin_context_t *g_context = NULL;",
            "static pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/log.h\"\n#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <pthread.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic const char *syms[] = {\n\t\"proctrack_p_create\",\n\t\"proctrack_p_add\",\n\t\"proctrack_p_signal\",\n\t\"proctrack_p_destroy\",\n\t\"proctrack_p_find\",\n\t\"proctrack_p_has_pid\",\n\t\"proctrack_p_wait\",\n\t\"proctrack_p_get_pids\"\n};\nstatic slurm_proctrack_ops_t ops;\nstatic plugin_context_t *g_context = NULL;\nstatic pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int slurm_proctrack_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"proctrack\";\n\tchar *type = NULL;\n\n\tif (init_run && g_context)\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_context_lock);\n\n\tif (g_context)\n\t\tgoto done;\n\n\ttype = slurm_get_proctrack_type();\n\tg_context = plugin_context_create(\n\t\tplugin_type, type, (void **)&ops, syms, sizeof(syms));\n\n\tif (!g_context) {\n\t\terror(\"cannot create %s context for %s\", plugin_type, type);\n\t\tretval = SLURM_ERROR;\n\t\tgoto done;\n\t}\n\tinit_run = true;\n\ndone:\n\tslurm_mutex_unlock(&g_context_lock);\n\txfree(type);\n\treturn retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_print_conf",
          "args": [],
          "line": 1543
        },
        "resolved": true,
        "details": {
          "function_name": "_print_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1298-1333",
          "snippet": "static void\n_print_config(void)\n{\n\tint days, hours, mins, secs;\n\tchar name[128];\n\n\tif (conf->cluster_name)\n\t\tprintf(\"ClusterName=%s \", conf->cluster_name);\n\n\tgethostname_short(name, sizeof(name));\n\tprintf(\"NodeName=%s \", name);\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n\tprintf(\"CPUs=%u Boards=%u SocketsPerBoard=%u CoresPerSocket=%u \"\n\t       \"ThreadsPerCore=%u \",\n\t       conf->actual_cpus, conf->actual_boards, conf->actual_sockets,\n\t       conf->actual_cores, conf->actual_threads);\n\n\tget_memory(&conf->real_memory_size);\n\tget_tmp_disk(&conf->tmp_disk_space, \"/tmp\");\n\tprintf(\"RealMemory=%u TmpDisk=%u\\n\",\n\t       conf->real_memory_size, conf->tmp_disk_space);\n\n\tget_up_time(&conf->up_time);\n\tsecs  =  conf->up_time % 60;\n\tmins  = (conf->up_time / 60) % 60;\n\thours = (conf->up_time / 3600) % 24;\n\tdays  = (conf->up_time / 86400);\n\tprintf(\"UpTime=%u-%2.2u:%2.2u:%2.2u\\n\", days, hours, mins, secs);\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _print_config(void);",
            "static void      _wait_for_all_threads(int secs);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _print_config(void);\nstatic void      _wait_for_all_threads(int secs);\n\nstatic void\n_print_config(void)\n{\n\tint days, hours, mins, secs;\n\tchar name[128];\n\n\tif (conf->cluster_name)\n\t\tprintf(\"ClusterName=%s \", conf->cluster_name);\n\n\tgethostname_short(name, sizeof(name));\n\tprintf(\"NodeName=%s \", name);\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n\tprintf(\"CPUs=%u Boards=%u SocketsPerBoard=%u CoresPerSocket=%u \"\n\t       \"ThreadsPerCore=%u \",\n\t       conf->actual_cpus, conf->actual_boards, conf->actual_sockets,\n\t       conf->actual_cores, conf->actual_threads);\n\n\tget_memory(&conf->real_memory_size);\n\tget_tmp_disk(&conf->tmp_disk_space, \"/tmp\");\n\tprintf(\"RealMemory=%u TmpDisk=%u\\n\",\n\t       conf->real_memory_size, conf->tmp_disk_space);\n\n\tget_up_time(&conf->up_time);\n\tsecs  =  conf->up_time % 60;\n\tmins  = (conf->up_time / 60) % 60;\n\thours = (conf->up_time / 3600) % 24;\n\tdays  = (conf->up_time / 86400);\n\tprintf(\"UpTime=%u-%2.2u:%2.2u:%2.2u\\n\", days, hours, mins, secs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_resource_spec_init",
          "args": [],
          "line": 1541
        },
        "resolved": true,
        "details": {
          "function_name": "_resource_spec_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2077-2085",
          "snippet": "static int _resource_spec_init(void)\n{\n\tfini_system_cgroup();\t/* Prevent memory leak */\n\tif (_core_spec_init() != SLURM_SUCCESS)\n\t\terror(\"Resource spec: core specialization disabled\");\n\tif (_memory_spec_init() != SLURM_SUCCESS)\n\t\terror(\"Resource spec: system cgroup memory limit disabled\");\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int       _core_spec_init(void);",
            "static int       _memory_spec_init(void);",
            "static int       _resource_spec_init(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic int       _core_spec_init(void);\nstatic int       _memory_spec_init(void);\nstatic int       _resource_spec_init(void);\n\nstatic int _resource_spec_init(void)\n{\n\tfini_system_cgroup();\t/* Prevent memory leak */\n\tif (_core_spec_init() != SLURM_SUCCESS)\n\t\terror(\"Resource spec: core specialization disabled\");\n\tif (_memory_spec_init() != SLURM_SUCCESS)\n\t\terror(\"Resource spec: system cgroup memory limit disabled\");\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_freq_init",
          "args": [
            "conf"
          ],
          "line": 1536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "route_init",
          "args": [
            "conf->node_name"
          ],
          "line": 1531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_set_topo_info",
          "args": [],
          "line": 1529
        },
        "resolved": true,
        "details": {
          "function_name": "_set_topo_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2004-2018",
          "snippet": "static int _set_topo_info(void)\n{\n\tint rc;\n\tchar * addr, * pattern;\n\n\trc = slurm_topo_get_node_addr(conf->node_name, &addr, &pattern);\n\tif ( rc == SLURM_SUCCESS ) {\n\t\txfree(conf->node_topo_addr);\n\t\txfree(conf->node_topo_pattern);\n\t\tconf->node_topo_addr = addr;\n\t\tconf->node_topo_pattern = pattern;\n\t}\n\n\treturn rc;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static int       _set_topo_info(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic int       _set_topo_info(void);\n\nstatic int _set_topo_info(void)\n{\n\tint rc;\n\tchar * addr, * pattern;\n\n\trc = slurm_topo_get_node_addr(conf->node_name, &addr, &pattern);\n\tif ( rc == SLURM_SUCCESS ) {\n\t\txfree(conf->node_topo_addr);\n\t\txfree(conf->node_topo_pattern);\n\t\tconf->node_topo_addr = addr;\n\t\tconf->node_topo_pattern = pattern;\n\t}\n\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_topo_build_config",
          "args": [],
          "line": 1528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rehash_node",
          "args": [],
          "line": 1527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_topo_init",
          "args": [],
          "line": 1520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gres_plugin_node_config_load",
          "args": [
            "cpu_cnt",
            "conf->node_name",
            "NULL"
          ],
          "line": 1517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gres_plugin_init",
          "args": [],
          "line": 1516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAX",
          "args": [
            "conf->conf_cpus",
            "conf->block_map_size"
          ],
          "line": 1514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_read_config",
          "args": [],
          "line": 1512
        },
        "resolved": true,
        "details": {
          "function_name": "_read_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "807-1050",
          "snippet": "static void\n_read_config(void)\n{\n\tchar *path_pubkey = NULL;\n\tslurm_ctl_conf_t *cf = NULL;\n\tint cc;\n#ifndef HAVE_FRONT_END\n\tbool cr_flag = false, gang_flag = false;\n#endif\n\n\tslurm_mutex_lock(&conf->config_mutex);\n\tcf = slurm_conf_lock();\n\n\txfree(conf->auth_info);\n\tconf->auth_info = xstrdup(cf->authinfo);\n\n\txfree(conf->chos_loc);\n\tconf->chos_loc = xstrdup(cf->chos_loc);\n\n\tconf->last_update = time(NULL);\n\n\tif (conf->conffile == NULL)\n\t\tconf->conffile = xstrdup(cf->slurm_conf);\n\n\tconf->slurm_user_id =  cf->slurm_user_id;\n\n\tconf->cr_type = cf->select_type_param;\n\n\tpath_pubkey = xstrdup(cf->job_credential_public_certificate);\n\n\tif (!conf->logfile)\n\t\tconf->logfile = xstrdup(cf->slurmd_logfile);\n\n#ifndef HAVE_FRONT_END\n\tif (!xstrcmp(cf->select_type, \"select/cons_res\"))\n\t\tcr_flag = true;\n\tif (!xstrcmp(cf->select_type, \"select/cray\") &&\n\t    (cf->select_type_param & CR_OTHER_CONS_RES))\n\t\tcr_flag = true;\n\n\tif (cf->preempt_mode & PREEMPT_MODE_GANG)\n\t\tgang_flag = true;\n#endif\n\n\tslurm_conf_unlock();\n\t/* node_name may already be set from a command line parameter */\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_nodename(conf->hostname);\n\t/* if we didn't match the form of the hostname already\n\t * stored in conf->hostname, check to see if we match any\n\t * valid aliases */\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_aliased_nodename();\n\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_nodename(\"localhost\");\n\n\tif (conf->node_name == NULL)\n\t\tfatal(\"Unable to determine this slurmd's NodeName\");\n\n\t_massage_pathname(&conf->logfile);\n\n\t/* set node_addr if relevant */\n\tif ((conf->node_addr == NULL) &&\n\t    (conf->node_addr = slurm_conf_get_nodeaddr(conf->hostname)) &&\n\t    (xstrcmp(conf->node_addr, conf->hostname) == 0)) {\n\t\txfree(conf->node_addr);\t/* Sets to NULL */\n\t}\n\n\tconf->port = slurm_conf_get_port(conf->node_name);\n\tslurm_conf_get_cpus_bsct(conf->node_name,\n\t\t\t\t &conf->conf_cpus, &conf->conf_boards,\n\t\t\t\t &conf->conf_sockets, &conf->conf_cores,\n\t\t\t\t &conf->conf_threads);\n\n\tslurm_conf_get_res_spec_info(conf->node_name,\n\t\t\t\t     &conf->cpu_spec_list,\n\t\t\t\t     &conf->core_spec_cnt,\n\t\t\t\t     &conf->mem_spec_limit);\n\n\t/* store hardware properties in slurmd_config */\n\txfree(conf->block_map);\n\txfree(conf->block_map_inv);\n\n\t_update_logging();\n\t_update_nice();\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n#ifdef HAVE_FRONT_END\n\t/*\n\t * When running with multiple frontends, the slurmd S:C:T values are not\n\t * relevant, hence ignored by both _register_front_ends (sets all to 1)\n\t * and validate_nodes_via_front_end (uses slurm.conf values).\n\t * Report actual hardware configuration, irrespective of FastSchedule.\n\t */\n\tconf->cpus    = conf->actual_cpus;\n\tconf->boards  = conf->actual_boards;\n\tconf->sockets = conf->actual_sockets;\n\tconf->cores   = conf->actual_cores;\n\tconf->threads = conf->actual_threads;\n#else\n\t/* If the actual resources on a node differ than what is in\n\t * the configuration file and we are using\n\t * cons_res or gang scheduling we have to use what is in the\n\t * configuration file because the slurmctld creates bitmaps\n\t * for scheduling before these nodes check in.\n\t */\n\tif (((cf->fast_schedule == 0) && !cr_flag && !gang_flag) ||\n\t    ((cf->fast_schedule == 1) &&\n\t     (conf->actual_cpus < conf->conf_cpus))) {\n\t\tconf->cpus    = conf->actual_cpus;\n\t\tconf->boards  = conf->actual_boards;\n\t\tconf->sockets = conf->actual_sockets;\n\t\tconf->cores   = conf->actual_cores;\n\t\tconf->threads = conf->actual_threads;\n\t} else if ((cf->fast_schedule == 1) && (cr_flag || gang_flag) &&\n\t\t   (conf->actual_sockets != conf->conf_sockets) &&\n\t\t   (conf->actual_cores != conf->conf_cores) &&\n\t\t   ((conf->actual_sockets * conf->actual_cores) ==\n\t\t    (conf->conf_sockets * conf->conf_cores))) {\n\t\t/* Socket and core count can be changed when KNL node reboots\n\t\t * in a different NUMA configuration */\n\t\tinfo(\"Node reconfigured socket/core boundaries \"\n\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw)\",\n\t\t     conf->conf_sockets, conf->actual_sockets,\n\t\t     conf->conf_cores, conf->actual_cores);\n\t\tconf->cpus    = conf->conf_cpus;\n\t\tconf->boards  = conf->conf_boards;\n\t\tconf->sockets = conf->actual_sockets;\n\t\tconf->cores   = conf->actual_cores;\n\t\tconf->threads = conf->conf_threads;\n\t} else {\n\t\tconf->cpus    = conf->conf_cpus;\n\t\tconf->boards  = conf->conf_boards;\n\t\tconf->sockets = conf->conf_sockets;\n\t\tconf->cores   = conf->conf_cores;\n\t\tconf->threads = conf->conf_threads;\n\t}\n\n\tif ((conf->cpus    != conf->actual_cpus)    ||\n\t    (conf->sockets != conf->actual_sockets) ||\n\t    (conf->cores   != conf->actual_cores)   ||\n\t    (conf->threads != conf->actual_threads)) {\n\t\tif (cf->fast_schedule) {\n\t\t\tinfo(\"Node configuration differs from hardware: \"\n\t\t\t     \"CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t     \"ThreadsPerCore=%u:%u(hw)\",\n\t\t\t     conf->cpus,    conf->actual_cpus,\n\t\t\t     conf->boards,  conf->actual_boards,\n\t\t\t     conf->sockets, conf->actual_sockets,\n\t\t\t     conf->cores,   conf->actual_cores,\n\t\t\t     conf->threads, conf->actual_threads);\n\t\t} else if ((cf->fast_schedule == 0) && (cr_flag || gang_flag)) {\n\t\t\terror(\"You are using cons_res or gang scheduling with \"\n\t\t\t      \"Fastschedule=0 and node configuration differs \"\n\t\t\t      \"from hardware.  The node configuration used \"\n\t\t\t      \"will be what is in the slurm.conf because of \"\n\t\t\t      \"the bitmaps the slurmctld must create before \"\n\t\t\t      \"the slurmd registers.\\n\"\n\t\t\t      \"   CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t      \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t      \"ThreadsPerCore=%u:%u(hw)\",\n\t\t\t      conf->cpus,    conf->actual_cpus,\n\t\t\t      conf->boards,  conf->actual_boards,\n\t\t\t      conf->sockets, conf->actual_sockets,\n\t\t\t      conf->cores,   conf->actual_cores,\n\t\t\t      conf->threads, conf->actual_threads);\n\t\t}\n\t}\n#endif\n\n\tget_memory(&conf->real_memory_size);\n\tget_up_time(&conf->up_time);\n\n\tcf = slurm_conf_lock();\n\tget_tmp_disk(&conf->tmp_disk_space, cf->tmp_fs);\n\t_free_and_set(conf->cluster_name, xstrdup(cf->cluster_name));\n\t_free_and_set(conf->epilog,   xstrdup(cf->epilog));\n\t_free_and_set(conf->prolog,   xstrdup(cf->prolog));\n\t_free_and_set(conf->tmpfs,    xstrdup(cf->tmp_fs));\n\t_free_and_set(conf->health_check_program,\n\t\t      xstrdup(cf->health_check_program));\n\t_free_and_set(conf->spooldir, xstrdup(cf->slurmd_spooldir));\n\t_massage_pathname(&conf->spooldir);\n\t_free_and_set(conf->pidfile,  xstrdup(cf->slurmd_pidfile));\n\t_massage_pathname(&conf->pidfile);\n\t_free_and_set(conf->plugstack,   xstrdup(cf->plugstack));\n\t_free_and_set(conf->select_type, xstrdup(cf->select_type));\n\t_free_and_set(conf->task_prolog, xstrdup(cf->task_prolog));\n\t_free_and_set(conf->task_epilog, xstrdup(cf->task_epilog));\n\t_free_and_set(conf->pubkey,   path_pubkey);\n\n\tconf->debug_flags = cf->debug_flags;\n\tconf->propagate_prio = cf->propagate_prio_process;\n\n\t_free_and_set(conf->job_acct_gather_freq,\n\t\t      xstrdup(cf->job_acct_gather_freq));\n\n\tconf->acct_freq_task = (uint16_t)NO_VAL;\n\tcc = acct_gather_parse_freq(PROFILE_TASK,\n\t\t\t\t    conf->job_acct_gather_freq);\n\tif (cc != -1)\n\t\tconf->acct_freq_task = cc;\n\n\t_free_and_set(conf->acct_gather_energy_type,\n\t\t      xstrdup(cf->acct_gather_energy_type));\n\t_free_and_set(conf->acct_gather_filesystem_type,\n\t\t      xstrdup(cf->acct_gather_filesystem_type));\n\t_free_and_set(conf->acct_gather_infiniband_type,\n\t\t      xstrdup(cf->acct_gather_infiniband_type));\n\t_free_and_set(conf->acct_gather_profile_type,\n\t\t      xstrdup(cf->acct_gather_profile_type));\n\t_free_and_set(conf->job_acct_gather_type,\n\t\t      xstrdup(cf->job_acct_gather_type));\n\t_free_and_set(conf->msg_aggr_params,\n\t\t      xstrdup(cf->msg_aggr_params));\n\t_set_msg_aggr_params();\n\n\tif ( (conf->node_name == NULL) ||\n\t     (conf->node_name[0] == '\\0') )\n\t\tfatal(\"Node name lookup failure\");\n\n\tif (cf->control_addr == NULL)\n\t\tfatal(\"Unable to establish controller machine\");\n\tif (cf->slurmctld_port == 0)\n\t\tfatal(\"Unable to establish controller port\");\n\tconf->slurmd_timeout = cf->slurmd_timeout;\n\tconf->kill_wait = cf->kill_wait;\n\tconf->use_pam = cf->use_pam;\n\tconf->task_plugin_param = cf->task_plugin_param;\n\n\tconf->mem_limit_enforce = cf->mem_limit_enforce;\n\tconf->health_check_interval = cf->health_check_interval;\n\n\tslurm_mutex_unlock(&conf->config_mutex);\n\tslurm_conf_unlock();\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _read_config(void);",
            "static void      _set_msg_aggr_params(void);",
            "static void      _update_logging(void);",
            "static void      _update_nice(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _read_config(void);\nstatic void      _set_msg_aggr_params(void);\nstatic void      _update_logging(void);\nstatic void      _update_nice(void);\n\nstatic void\n_read_config(void)\n{\n\tchar *path_pubkey = NULL;\n\tslurm_ctl_conf_t *cf = NULL;\n\tint cc;\n#ifndef HAVE_FRONT_END\n\tbool cr_flag = false, gang_flag = false;\n#endif\n\n\tslurm_mutex_lock(&conf->config_mutex);\n\tcf = slurm_conf_lock();\n\n\txfree(conf->auth_info);\n\tconf->auth_info = xstrdup(cf->authinfo);\n\n\txfree(conf->chos_loc);\n\tconf->chos_loc = xstrdup(cf->chos_loc);\n\n\tconf->last_update = time(NULL);\n\n\tif (conf->conffile == NULL)\n\t\tconf->conffile = xstrdup(cf->slurm_conf);\n\n\tconf->slurm_user_id =  cf->slurm_user_id;\n\n\tconf->cr_type = cf->select_type_param;\n\n\tpath_pubkey = xstrdup(cf->job_credential_public_certificate);\n\n\tif (!conf->logfile)\n\t\tconf->logfile = xstrdup(cf->slurmd_logfile);\n\n#ifndef HAVE_FRONT_END\n\tif (!xstrcmp(cf->select_type, \"select/cons_res\"))\n\t\tcr_flag = true;\n\tif (!xstrcmp(cf->select_type, \"select/cray\") &&\n\t    (cf->select_type_param & CR_OTHER_CONS_RES))\n\t\tcr_flag = true;\n\n\tif (cf->preempt_mode & PREEMPT_MODE_GANG)\n\t\tgang_flag = true;\n#endif\n\n\tslurm_conf_unlock();\n\t/* node_name may already be set from a command line parameter */\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_nodename(conf->hostname);\n\t/* if we didn't match the form of the hostname already\n\t * stored in conf->hostname, check to see if we match any\n\t * valid aliases */\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_aliased_nodename();\n\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_nodename(\"localhost\");\n\n\tif (conf->node_name == NULL)\n\t\tfatal(\"Unable to determine this slurmd's NodeName\");\n\n\t_massage_pathname(&conf->logfile);\n\n\t/* set node_addr if relevant */\n\tif ((conf->node_addr == NULL) &&\n\t    (conf->node_addr = slurm_conf_get_nodeaddr(conf->hostname)) &&\n\t    (xstrcmp(conf->node_addr, conf->hostname) == 0)) {\n\t\txfree(conf->node_addr);\t/* Sets to NULL */\n\t}\n\n\tconf->port = slurm_conf_get_port(conf->node_name);\n\tslurm_conf_get_cpus_bsct(conf->node_name,\n\t\t\t\t &conf->conf_cpus, &conf->conf_boards,\n\t\t\t\t &conf->conf_sockets, &conf->conf_cores,\n\t\t\t\t &conf->conf_threads);\n\n\tslurm_conf_get_res_spec_info(conf->node_name,\n\t\t\t\t     &conf->cpu_spec_list,\n\t\t\t\t     &conf->core_spec_cnt,\n\t\t\t\t     &conf->mem_spec_limit);\n\n\t/* store hardware properties in slurmd_config */\n\txfree(conf->block_map);\n\txfree(conf->block_map_inv);\n\n\t_update_logging();\n\t_update_nice();\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n#ifdef HAVE_FRONT_END\n\t/*\n\t * When running with multiple frontends, the slurmd S:C:T values are not\n\t * relevant, hence ignored by both _register_front_ends (sets all to 1)\n\t * and validate_nodes_via_front_end (uses slurm.conf values).\n\t * Report actual hardware configuration, irrespective of FastSchedule.\n\t */\n\tconf->cpus    = conf->actual_cpus;\n\tconf->boards  = conf->actual_boards;\n\tconf->sockets = conf->actual_sockets;\n\tconf->cores   = conf->actual_cores;\n\tconf->threads = conf->actual_threads;\n#else\n\t/* If the actual resources on a node differ than what is in\n\t * the configuration file and we are using\n\t * cons_res or gang scheduling we have to use what is in the\n\t * configuration file because the slurmctld creates bitmaps\n\t * for scheduling before these nodes check in.\n\t */\n\tif (((cf->fast_schedule == 0) && !cr_flag && !gang_flag) ||\n\t    ((cf->fast_schedule == 1) &&\n\t     (conf->actual_cpus < conf->conf_cpus))) {\n\t\tconf->cpus    = conf->actual_cpus;\n\t\tconf->boards  = conf->actual_boards;\n\t\tconf->sockets = conf->actual_sockets;\n\t\tconf->cores   = conf->actual_cores;\n\t\tconf->threads = conf->actual_threads;\n\t} else if ((cf->fast_schedule == 1) && (cr_flag || gang_flag) &&\n\t\t   (conf->actual_sockets != conf->conf_sockets) &&\n\t\t   (conf->actual_cores != conf->conf_cores) &&\n\t\t   ((conf->actual_sockets * conf->actual_cores) ==\n\t\t    (conf->conf_sockets * conf->conf_cores))) {\n\t\t/* Socket and core count can be changed when KNL node reboots\n\t\t * in a different NUMA configuration */\n\t\tinfo(\"Node reconfigured socket/core boundaries \"\n\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw)\",\n\t\t     conf->conf_sockets, conf->actual_sockets,\n\t\t     conf->conf_cores, conf->actual_cores);\n\t\tconf->cpus    = conf->conf_cpus;\n\t\tconf->boards  = conf->conf_boards;\n\t\tconf->sockets = conf->actual_sockets;\n\t\tconf->cores   = conf->actual_cores;\n\t\tconf->threads = conf->conf_threads;\n\t} else {\n\t\tconf->cpus    = conf->conf_cpus;\n\t\tconf->boards  = conf->conf_boards;\n\t\tconf->sockets = conf->conf_sockets;\n\t\tconf->cores   = conf->conf_cores;\n\t\tconf->threads = conf->conf_threads;\n\t}\n\n\tif ((conf->cpus    != conf->actual_cpus)    ||\n\t    (conf->sockets != conf->actual_sockets) ||\n\t    (conf->cores   != conf->actual_cores)   ||\n\t    (conf->threads != conf->actual_threads)) {\n\t\tif (cf->fast_schedule) {\n\t\t\tinfo(\"Node configuration differs from hardware: \"\n\t\t\t     \"CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t     \"ThreadsPerCore=%u:%u(hw)\",\n\t\t\t     conf->cpus,    conf->actual_cpus,\n\t\t\t     conf->boards,  conf->actual_boards,\n\t\t\t     conf->sockets, conf->actual_sockets,\n\t\t\t     conf->cores,   conf->actual_cores,\n\t\t\t     conf->threads, conf->actual_threads);\n\t\t} else if ((cf->fast_schedule == 0) && (cr_flag || gang_flag)) {\n\t\t\terror(\"You are using cons_res or gang scheduling with \"\n\t\t\t      \"Fastschedule=0 and node configuration differs \"\n\t\t\t      \"from hardware.  The node configuration used \"\n\t\t\t      \"will be what is in the slurm.conf because of \"\n\t\t\t      \"the bitmaps the slurmctld must create before \"\n\t\t\t      \"the slurmd registers.\\n\"\n\t\t\t      \"   CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t      \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t      \"ThreadsPerCore=%u:%u(hw)\",\n\t\t\t      conf->cpus,    conf->actual_cpus,\n\t\t\t      conf->boards,  conf->actual_boards,\n\t\t\t      conf->sockets, conf->actual_sockets,\n\t\t\t      conf->cores,   conf->actual_cores,\n\t\t\t      conf->threads, conf->actual_threads);\n\t\t}\n\t}\n#endif\n\n\tget_memory(&conf->real_memory_size);\n\tget_up_time(&conf->up_time);\n\n\tcf = slurm_conf_lock();\n\tget_tmp_disk(&conf->tmp_disk_space, cf->tmp_fs);\n\t_free_and_set(conf->cluster_name, xstrdup(cf->cluster_name));\n\t_free_and_set(conf->epilog,   xstrdup(cf->epilog));\n\t_free_and_set(conf->prolog,   xstrdup(cf->prolog));\n\t_free_and_set(conf->tmpfs,    xstrdup(cf->tmp_fs));\n\t_free_and_set(conf->health_check_program,\n\t\t      xstrdup(cf->health_check_program));\n\t_free_and_set(conf->spooldir, xstrdup(cf->slurmd_spooldir));\n\t_massage_pathname(&conf->spooldir);\n\t_free_and_set(conf->pidfile,  xstrdup(cf->slurmd_pidfile));\n\t_massage_pathname(&conf->pidfile);\n\t_free_and_set(conf->plugstack,   xstrdup(cf->plugstack));\n\t_free_and_set(conf->select_type, xstrdup(cf->select_type));\n\t_free_and_set(conf->task_prolog, xstrdup(cf->task_prolog));\n\t_free_and_set(conf->task_epilog, xstrdup(cf->task_epilog));\n\t_free_and_set(conf->pubkey,   path_pubkey);\n\n\tconf->debug_flags = cf->debug_flags;\n\tconf->propagate_prio = cf->propagate_prio_process;\n\n\t_free_and_set(conf->job_acct_gather_freq,\n\t\t      xstrdup(cf->job_acct_gather_freq));\n\n\tconf->acct_freq_task = (uint16_t)NO_VAL;\n\tcc = acct_gather_parse_freq(PROFILE_TASK,\n\t\t\t\t    conf->job_acct_gather_freq);\n\tif (cc != -1)\n\t\tconf->acct_freq_task = cc;\n\n\t_free_and_set(conf->acct_gather_energy_type,\n\t\t      xstrdup(cf->acct_gather_energy_type));\n\t_free_and_set(conf->acct_gather_filesystem_type,\n\t\t      xstrdup(cf->acct_gather_filesystem_type));\n\t_free_and_set(conf->acct_gather_infiniband_type,\n\t\t      xstrdup(cf->acct_gather_infiniband_type));\n\t_free_and_set(conf->acct_gather_profile_type,\n\t\t      xstrdup(cf->acct_gather_profile_type));\n\t_free_and_set(conf->job_acct_gather_type,\n\t\t      xstrdup(cf->job_acct_gather_type));\n\t_free_and_set(conf->msg_aggr_params,\n\t\t      xstrdup(cf->msg_aggr_params));\n\t_set_msg_aggr_params();\n\n\tif ( (conf->node_name == NULL) ||\n\t     (conf->node_name[0] == '\\0') )\n\t\tfatal(\"Node name lookup failure\");\n\n\tif (cf->control_addr == NULL)\n\t\tfatal(\"Unable to establish controller machine\");\n\tif (cf->slurmctld_port == 0)\n\t\tfatal(\"Unable to establish controller port\");\n\tconf->slurmd_timeout = cf->slurmd_timeout;\n\tconf->kill_wait = cf->kill_wait;\n\tconf->use_pam = cf->use_pam;\n\tconf->task_plugin_param = cf->task_plugin_param;\n\n\tconf->mem_limit_enforce = cf->mem_limit_enforce;\n\tconf->health_check_interval = cf->health_check_interval;\n\n\tslurm_mutex_unlock(&conf->config_mutex);\n\tslurm_conf_unlock();\n}"
        }
      },
      {
        "call_info": {
          "callee": "build_all_frontend_info",
          "args": [
            "true"
          ],
          "line": 1506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "build_all_nodeline_info",
          "args": [
            "true"
          ],
          "line": 1505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_select_init",
          "args": [
            "1"
          ],
          "line": 1503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_node_conf",
          "args": [],
          "line": 1500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_conf_init",
          "args": [
            "conf->conffile"
          ],
          "line": 1499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_process_cmdline",
          "args": [
            "*conf->argc",
            "*conf->argv"
          ],
          "line": 1491
        },
        "resolved": true,
        "details": {
          "function_name": "_process_cmdline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1335-1409",
          "snippet": "static void\n_process_cmdline(int ac, char **av)\n{\n\tint c;\n\tchar *tmp_char;\n\n\tconf->prog = xbasename(av[0]);\n\n\twhile ((c = getopt(ac, av, GETOPT_ARGS)) > 0) {\n\t\tswitch (c) {\n\t\tcase 'b':\n\t\t\tconf->boot_time = 1;\n\t\t\tbreak;\n\t\tcase 'c':\n\t\t\tconf->cleanstart = 1;\n\t\t\tbreak;\n\t\tcase 'C':\n\t\t\t_print_config();\n\t\t\texit(0);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\txfree(conf->stepd_loc);\n\t\t\tconf->stepd_loc = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'D':\n\t\t\tconf->daemonize = 0;\n\t\t\tbreak;\n\t\tcase 'f':\n\t\t\tconf->conffile = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'h':\n\t\t\t_usage();\n\t\t\texit(0);\n\t\t\tbreak;\n\t\tcase 'L':\n\t\t\tconf->logfile = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'M':\n\t\t\tconf->mlock_pages = 1;\n\t\t\tbreak;\n\t\tcase 'n':\n\t\t\tconf->nice = strtol(optarg, &tmp_char, 10);\n\t\t\tif (tmp_char[0] != '\\0') {\n\t\t\t\terror(\"Invalid option for -n option (nice \"\n\t\t\t\t      \"value), ignored\");\n\t\t\t\tconf->nice = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'N':\n\t\t\tconf->node_name = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'v':\n\t\t\tconf->debug_level++;\n\t\t\tconf->debug_level_set = 1;\n\t\t\tbreak;\n\t\tcase 'V':\n\t\t\tprint_slurm_version();\n\t\t\texit(0);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_usage();\n\t\t\texit(1);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/*\n\t *  If slurmstepd path wasn't overridden by command line, set\n\t *   it to the default here:\n\t */\n\tif (!conf->stepd_loc) {\n\t\tconf->stepd_loc =\n\t\t\txstrdup_printf(\"%s/sbin/slurmstepd\", SLURM_PREFIX);\n\t}\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [
            "#define GETOPT_ARGS\t\"bcCd:Df:hL:Mn:N:vV\""
          ],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _print_config(void);",
            "static void      _process_cmdline(int ac, char **av);",
            "static void      _usage(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\n#define GETOPT_ARGS\t\"bcCd:Df:hL:Mn:N:vV\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _print_config(void);\nstatic void      _process_cmdline(int ac, char **av);\nstatic void      _usage(void);\n\nstatic void\n_process_cmdline(int ac, char **av)\n{\n\tint c;\n\tchar *tmp_char;\n\n\tconf->prog = xbasename(av[0]);\n\n\twhile ((c = getopt(ac, av, GETOPT_ARGS)) > 0) {\n\t\tswitch (c) {\n\t\tcase 'b':\n\t\t\tconf->boot_time = 1;\n\t\t\tbreak;\n\t\tcase 'c':\n\t\t\tconf->cleanstart = 1;\n\t\t\tbreak;\n\t\tcase 'C':\n\t\t\t_print_config();\n\t\t\texit(0);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\txfree(conf->stepd_loc);\n\t\t\tconf->stepd_loc = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'D':\n\t\t\tconf->daemonize = 0;\n\t\t\tbreak;\n\t\tcase 'f':\n\t\t\tconf->conffile = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'h':\n\t\t\t_usage();\n\t\t\texit(0);\n\t\t\tbreak;\n\t\tcase 'L':\n\t\t\tconf->logfile = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'M':\n\t\t\tconf->mlock_pages = 1;\n\t\t\tbreak;\n\t\tcase 'n':\n\t\t\tconf->nice = strtol(optarg, &tmp_char, 10);\n\t\t\tif (tmp_char[0] != '\\0') {\n\t\t\t\terror(\"Invalid option for -n option (nice \"\n\t\t\t\t      \"value), ignored\");\n\t\t\t\tconf->nice = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'N':\n\t\t\tconf->node_name = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'v':\n\t\t\tconf->debug_level++;\n\t\t\tconf->debug_level_set = 1;\n\t\t\tbreak;\n\t\tcase 'V':\n\t\t\tprint_slurm_version();\n\t\t\texit(0);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_usage();\n\t\t\texit(1);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/*\n\t *  If slurmstepd path wasn't overridden by command line, set\n\t *   it to the default here:\n\t */\n\tif (!conf->stepd_loc) {\n\t\tconf->stepd_loc =\n\t\t\txstrdup_printf(\"%s/sbin/slurmstepd\", SLURM_PREFIX);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nint devnull = -1;\nslurmd_conf_t * conf = NULL;\nstatic void      _kill_old_slurmd(void);\nstatic void      _print_conf(void);\nstatic void      _read_config(void);\nstatic int       _resource_spec_init(void);\nstatic int       _set_slurmd_spooldir(void);\nstatic int       _set_topo_info(void);\nstatic int       _slurmd_init(void);\n\nstatic int\n_slurmd_init(void)\n{\n\tstruct rlimit rlim;\n\tstruct stat stat_buf;\n\tuint32_t cpu_cnt;\n\n\t/*\n\t * Process commandline arguments first, since one option may be\n\t * an alternate location for the slurm config file.\n\t */\n\t_process_cmdline(*conf->argc, *conf->argv);\n\n\t/*\n\t * Build nodes table like in slurmctld\n\t * This is required by the topology stack\n\t * Node tables setup must precede _read_config() so that the\n\t * proper hostname is set.\n\t */\n\tslurm_conf_init(conf->conffile);\n\tinit_node_conf();\n\t/* slurm_select_init() must be called before\n\t * build_all_nodeline_info() to be called with proper argument. */\n\tif (slurm_select_init(1) != SLURM_SUCCESS )\n\t\treturn SLURM_FAILURE;\n\tbuild_all_nodeline_info(true);\n\tbuild_all_frontend_info(true);\n\n\t/*\n\t * Read global slurm config file, override necessary values from\n\t * defaults and command line.\n\t */\n\t_read_config();\n\n\tcpu_cnt = MAX(conf->conf_cpus, conf->block_map_size);\n\n\tif ((gres_plugin_init() != SLURM_SUCCESS) ||\n\t    (gres_plugin_node_config_load(cpu_cnt, conf->node_name, NULL)\n\t     != SLURM_SUCCESS))\n\t\treturn SLURM_FAILURE;\n\tif (slurm_topo_init() != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\n\t/*\n\t * Get and set slurmd topology information\n\t * Build node hash table first to speed up the topo build\n\t */\n\trehash_node();\n\tslurm_topo_build_config();\n\t_set_topo_info();\n\n\troute_init(conf->node_name);\n\n\t/*\n\t * Check for cpu frequency set capabilities on this node\n\t */\n\tcpu_freq_init(conf);\n\n\t/*\n\t * If configured, apply resource specialization\n\t */\n\t_resource_spec_init();\n\n\t_print_conf();\n\n\tif (slurm_proctrack_init() != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\tif (slurmd_task_init() != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\tif (slurm_auth_init(NULL) != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\tif (spank_slurmd_init() < 0)\n\t\treturn SLURM_FAILURE;\n\n\tif (getrlimit(RLIMIT_CPU, &rlim) == 0) {\n\t\trlim.rlim_cur = rlim.rlim_max;\n\t\tsetrlimit(RLIMIT_CPU, &rlim);\n\t\tif (rlim.rlim_max != RLIM_INFINITY) {\n\t\t\terror(\"Slurmd process CPU time limit is %d seconds\",\n\t\t\t      (int) rlim.rlim_max);\n\t\t}\n\t}\n\n\tif (getrlimit(RLIMIT_NOFILE, &rlim) == 0) {\n\t\trlim.rlim_cur = rlim.rlim_max;\n\t\tsetrlimit(RLIMIT_NOFILE, &rlim);\n\t}\n#ifndef NDEBUG\n\tif (getrlimit(RLIMIT_CORE, &rlim) == 0) {\n\t\trlim.rlim_cur = rlim.rlim_max;\n\t\tsetrlimit(RLIMIT_CORE, &rlim);\n\t}\n#endif /* !NDEBUG */\n\n\t/*\n\t * Create a context for verifying slurm job credentials\n\t */\n\tif (!(conf->vctx = slurm_cred_verifier_ctx_create(conf->pubkey)))\n\t\treturn SLURM_FAILURE;\n\tif (!xstrcmp(conf->select_type, \"select/serial\")) {\n\t\t/* Only cache credential for 5 seconds with select/serial\n\t\t * for shorter cache searches and higher throughput */\n\t\tslurm_cred_ctx_set(conf->vctx, SLURM_CRED_OPT_EXPIRY_WINDOW, 5);\n\t}\n\n\t/*\n\t * Create slurmd spool directory if necessary.\n\t */\n\tif (_set_slurmd_spooldir() < 0) {\n\t\terror(\"Unable to initialize slurmd spooldir\");\n\t\treturn SLURM_FAILURE;\n\t}\n\n\tif (conf->cleanstart) {\n\t\t/*\n\t\t * Need to kill any running slurmd's here\n\t\t */\n\t\t_kill_old_slurmd();\n\n\t\tstepd_cleanup_sockets(conf->spooldir, conf->node_name);\n\t\t_stepd_cleanup_batch_dirs(conf->spooldir, conf->node_name);\n\t}\n\n\tif (conf->daemonize) {\n\t\tbool success = false;\n\n\t\tif (conf->logfile && (conf->logfile[0] == '/')) {\n\t\t\tchar *slash_ptr, *work_dir;\n\t\t\twork_dir = xstrdup(conf->logfile);\n\t\t\tslash_ptr = strrchr(work_dir, '/');\n\t\t\tif (slash_ptr == work_dir)\n\t\t\t\twork_dir[1] = '\\0';\n\t\t\telse\n\t\t\t\tslash_ptr[0] = '\\0';\n\t\t\tif ((access(work_dir, W_OK) != 0) ||\n\t\t\t    (chdir(work_dir) < 0)) {\n\t\t\t\terror(\"Unable to chdir to %s\", work_dir);\n\t\t\t} else\n\t\t\t\tsuccess = true;\n\t\t\txfree(work_dir);\n\t\t}\n\n\t\tif (!success) {\n\t\t\tif ((access(conf->spooldir, W_OK) != 0) ||\n\t\t\t    (chdir(conf->spooldir) < 0)) {\n\t\t\t\terror(\"Unable to chdir to %s\", conf->spooldir);\n\t\t\t} else\n\t\t\t\tsuccess = true;\n\t\t}\n\n\t\tif (!success) {\n\t\t\tif ((access(\"/var/tmp\", W_OK) != 0) ||\n\t\t\t    (chdir(\"/var/tmp\") < 0)) {\n\t\t\t\terror(\"chdir(/var/tmp): %m\");\n\t\t\t\treturn SLURM_FAILURE;\n\t\t\t} else\n\t\t\t\tinfo(\"chdir to /var/tmp\");\n\t\t}\n\t}\n\n\tif ((devnull = open_cloexec(\"/dev/null\", O_RDWR)) < 0) {\n\t\terror(\"Unable to open /dev/null: %m\");\n\t\treturn SLURM_FAILURE;\n\t}\n\n\t/* make sure we have slurmstepd installed */\n\tif (stat(conf->stepd_loc, &stat_buf))\n\t\tfatal(\"Unable to find slurmstepd file at %s\", conf->stepd_loc);\n\tif (!S_ISREG(stat_buf.st_mode))\n\t\tfatal(\"slurmstepd not a file at %s\", conf->stepd_loc);\n\tif (conf->chos_loc && (access(conf->chos_loc, X_OK) != 0))\n\t\terror(\"Unable to execute ChosLoc at %s: %m\", conf->chos_loc);\n\n\treturn SLURM_SUCCESS;\n}"
  },
  {
    "function_name": "_stepd_cleanup_batch_dirs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1440-1478",
    "snippet": "static void\n_stepd_cleanup_batch_dirs(const char *directory, const char *nodename)\n{\n\tchar dir_path[MAXPATHLEN], file_path[MAXPATHLEN];\n\tDIR *dp;\n\tstruct dirent *ent;\n\tstruct stat stat_buf;\n\n\t/*\n\t * Make sure that \"directory\" exists and is a directory.\n\t */\n\tif (stat(directory, &stat_buf) < 0) {\n\t\terror(\"SlurmdSpoolDir stat error %s: %m\", directory);\n\t\treturn;\n\t} else if (!S_ISDIR(stat_buf.st_mode)) {\n\t\terror(\"SlurmdSpoolDir is not a directory %s\", directory);\n\t\treturn;\n\t}\n\n\tif ((dp = opendir(directory)) == NULL) {\n\t\terror(\"SlurmdSpoolDir open error %s: %m\", directory);\n\t\treturn;\n\t}\n\n\twhile ((ent = readdir(dp)) != NULL) {\n\t\tif (!xstrncmp(ent->d_name, \"job\", 3) &&\n\t\t    (ent->d_name[3] >= '0') && (ent->d_name[3] <= '9')) {\n\t\t\tsnprintf(dir_path, sizeof(dir_path),\n\t\t\t\t \"%s/%s\", directory, ent->d_name);\n\t\t\tsnprintf(file_path, sizeof(file_path),\n\t\t\t\t \"%s/slurm_script\", dir_path);\n\t\t\tinfo(\"%s: Purging vestigial job script %s\",\n\t\t\t     __func__, file_path);\n\t\t\t(void) unlink(file_path);\n\t\t\t(void) rmdir(dir_path);\n\t\t}\n\t}\n\tclosedir(dp);\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "closedir",
          "args": [
            "dp"
          ],
          "line": 1477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rmdir",
          "args": [
            "dir_path"
          ],
          "line": 1474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "file_path"
          ],
          "line": 1473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"%s: Purging vestigial job script %s\"",
            "__func__",
            "file_path"
          ],
          "line": 1471
        },
        "resolved": true,
        "details": {
          "function_name": "_chk_cpuinfo_float",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "414-423",
          "snippet": "static int _chk_cpuinfo_float(char *buffer, char *keyword, float *val)\n{\n\tchar *valptr;\n\tif (_chk_cpuinfo_str(buffer, keyword, &valptr)) {\n\t\t*val = (float) strtod(valptr, (char **)NULL);\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nstatic int _chk_cpuinfo_float(char *buffer, char *keyword, float *val)\n{\n\tchar *valptr;\n\tif (_chk_cpuinfo_str(buffer, keyword, &valptr)) {\n\t\t*val = (float) strtod(valptr, (char **)NULL);\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "file_path",
            "sizeof(file_path)",
            "\"%s/slurm_script\"",
            "dir_path"
          ],
          "line": 1469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "dir_path",
            "sizeof(dir_path)",
            "\"%s/%s\"",
            "directory",
            "ent->d_name"
          ],
          "line": 1467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrncmp",
          "args": [
            "ent->d_name",
            "\"job\"",
            "3"
          ],
          "line": 1465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readdir",
          "args": [
            "dp"
          ],
          "line": 1464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"SlurmdSpoolDir open error %s: %m\"",
            "directory"
          ],
          "line": 1460
        },
        "resolved": true,
        "details": {
          "function_name": "_prolog_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "1386-1434",
          "snippet": "static void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _is_batch_job_finished(uint32_t job_id);",
            "static bool _job_still_running(uint32_t job_id);",
            "static void _launch_complete_add(uint32_t job_id);",
            "static void _launch_complete_log(char *type, uint32_t job_id);",
            "static void _launch_complete_rm(uint32_t job_id);",
            "static void _launch_complete_wait(uint32_t job_id);",
            "static bool _launch_job_test(uint32_t job_id);",
            "static void _note_batch_job_finished(uint32_t job_id);",
            "static bool _slurm_authorized_user(uid_t uid);",
            "static void _sync_messages_kill(kill_job_msg_t *req);",
            "static int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);",
            "static gids_t *_gids_cache_lookup(char *user, gid_t gid);",
            "static int  _add_starting_step(uint16_t type, void *req);",
            "static int  _remove_starting_step(uint16_t type, void *req);",
            "static void _add_job_running_prolog(uint32_t job_id);",
            "static void _remove_job_running_prolog(uint32_t job_id);",
            "static void _wait_for_job_running_prolog(uint32_t job_id);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic bool _is_batch_job_finished(uint32_t job_id);\nstatic bool _job_still_running(uint32_t job_id);\nstatic void _launch_complete_add(uint32_t job_id);\nstatic void _launch_complete_log(char *type, uint32_t job_id);\nstatic void _launch_complete_rm(uint32_t job_id);\nstatic void _launch_complete_wait(uint32_t job_id);\nstatic bool _launch_job_test(uint32_t job_id);\nstatic void _note_batch_job_finished(uint32_t job_id);\nstatic bool _slurm_authorized_user(uid_t uid);\nstatic void _sync_messages_kill(kill_job_msg_t *req);\nstatic int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);\nstatic gids_t *_gids_cache_lookup(char *user, gid_t gid);\nstatic int  _add_starting_step(uint16_t type, void *req);\nstatic int  _remove_starting_step(uint16_t type, void *req);\nstatic void _add_job_running_prolog(uint32_t job_id);\nstatic void _remove_job_running_prolog(uint32_t job_id);\nstatic void _wait_for_job_running_prolog(uint32_t job_id);\n\nstatic void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "opendir",
          "args": [
            "directory"
          ],
          "line": 1459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "stat_buf.st_mode"
          ],
          "line": 1454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "directory",
            "&stat_buf"
          ],
          "line": 1451
        },
        "resolved": true,
        "details": {
          "function_name": "_wait_state_completed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "4259-4271",
          "snippet": "static void\n_wait_state_completed(uint32_t jobid, int max_delay)\n{\n\tint i;\n\n\tfor (i=0; i<max_delay; i++) {\n\t\tif (_steps_completed_now(jobid))\n\t\t\tbreak;\n\t\tsleep(1);\n\t}\n\tif (i >= max_delay)\n\t\terror(\"timed out waiting for job %u to complete\", jobid);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int  _prolog_is_running (uint32_t jobid);",
            "static int  _waiter_init (uint32_t jobid);",
            "static int  _waiter_complete (uint32_t jobid);",
            "static bool _steps_completed_now(uint32_t jobid);",
            "static void _wait_state_completed(uint32_t jobid, int max_delay);",
            "static uid_t _get_job_uid(uint32_t jobid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic int  _prolog_is_running (uint32_t jobid);\nstatic int  _waiter_init (uint32_t jobid);\nstatic int  _waiter_complete (uint32_t jobid);\nstatic bool _steps_completed_now(uint32_t jobid);\nstatic void _wait_state_completed(uint32_t jobid, int max_delay);\nstatic uid_t _get_job_uid(uint32_t jobid);\n\nstatic void\n_wait_state_completed(uint32_t jobid, int max_delay)\n{\n\tint i;\n\n\tfor (i=0; i<max_delay; i++) {\n\t\tif (_steps_completed_now(jobid))\n\t\t\tbreak;\n\t\tsleep(1);\n\t}\n\tif (i >= max_delay)\n\t\terror(\"timed out waiting for job %u to complete\", jobid);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic void\n_stepd_cleanup_batch_dirs(const char *directory, const char *nodename)\n{\n\tchar dir_path[MAXPATHLEN], file_path[MAXPATHLEN];\n\tDIR *dp;\n\tstruct dirent *ent;\n\tstruct stat stat_buf;\n\n\t/*\n\t * Make sure that \"directory\" exists and is a directory.\n\t */\n\tif (stat(directory, &stat_buf) < 0) {\n\t\terror(\"SlurmdSpoolDir stat error %s: %m\", directory);\n\t\treturn;\n\t} else if (!S_ISDIR(stat_buf.st_mode)) {\n\t\terror(\"SlurmdSpoolDir is not a directory %s\", directory);\n\t\treturn;\n\t}\n\n\tif ((dp = opendir(directory)) == NULL) {\n\t\terror(\"SlurmdSpoolDir open error %s: %m\", directory);\n\t\treturn;\n\t}\n\n\twhile ((ent = readdir(dp)) != NULL) {\n\t\tif (!xstrncmp(ent->d_name, \"job\", 3) &&\n\t\t    (ent->d_name[3] >= '0') && (ent->d_name[3] <= '9')) {\n\t\t\tsnprintf(dir_path, sizeof(dir_path),\n\t\t\t\t \"%s/%s\", directory, ent->d_name);\n\t\t\tsnprintf(file_path, sizeof(file_path),\n\t\t\t\t \"%s/slurm_script\", dir_path);\n\t\t\tinfo(\"%s: Purging vestigial job script %s\",\n\t\t\t     __func__, file_path);\n\t\t\t(void) unlink(file_path);\n\t\t\t(void) rmdir(dir_path);\n\t\t}\n\t}\n\tclosedir(dp);\n}"
  },
  {
    "function_name": "_create_msg_socket",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1412-1438",
    "snippet": "static void\n_create_msg_socket(void)\n{\n\tchar* node_addr;\n\n\tslurm_fd_t ld = slurm_init_msg_engine_addrname_port(conf->node_addr,\n\t\t\t\t\t\t\t  conf->port);\n\tif (conf->node_addr == NULL)\n\t\tnode_addr = \"*\";\n\telse\n\t\tnode_addr = conf->node_addr;\n\n\tif (ld < 0) {\n\t\terror(\"Unable to bind listen port (%s:%d): %m\",\n\t\t      node_addr, conf->port);\n\t\texit(1);\n\t}\n\n\tfd_set_close_on_exec(ld);\n\n\tconf->lfd = ld;\n\n\tdebug3(\"successfully opened slurm listen port %s:%d\",\n\t       node_addr, conf->port);\n\n\treturn;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _create_msg_socket(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"successfully opened slurm listen port %s:%d\"",
            "node_addr",
            "conf->port"
          ],
          "line": 1434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fd_set_close_on_exec",
          "args": [
            "ld"
          ],
          "line": 1430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 1427
        },
        "resolved": true,
        "details": {
          "function_name": "_send_pending_exit_msgs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/mgr.c",
          "lines": "1890-1927",
          "snippet": "static int\n_send_pending_exit_msgs(stepd_step_rec_t *job)\n{\n\tint  i;\n\tint  nsent  = 0;\n\tint  status = 0;\n\tbool set    = false;\n\tuint32_t *tid;\n\n\t/*\n\t * Collect all exit codes with the same status into a\n\t * single message.\n\t */\n\ttid = xmalloc(sizeof(uint32_t) * job->node_tasks);\n\tfor (i = 0; i < job->node_tasks; i++) {\n\t\tstepd_step_task_info_t *t = job->task[i];\n\n\t\tif (!t->exited || t->esent)\n\t\t\tcontinue;\n\n\t\tif (!set) {\n\t\t\tstatus = t->estatus;\n\t\t\tset    = true;\n\t\t} else if (status != t->estatus)\n\t\t\tcontinue;\n\n\t\ttid[nsent++] = t->gtid;\n\t\tt->esent = true;\n\t}\n\n\tif (nsent) {\n\t\tdebug2(\"Aggregated %d task exit messages\", nsent);\n\t\t_send_exit_msg(job, tid, nsent, status);\n\t}\n\txfree(tid);\n\n\treturn nsent;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/ulimits.h\"",
            "#include \"src/slurmd/slurmstepd/pam_ses.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmstepd/task.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/reverse_tree.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/slurm_mpi.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/safeopen.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#    include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <pthread.h>",
            "#include <poll.h>",
            "#include <grp.h>",
            "#  include \"src/common/unsetenv.h\"",
            "#  include <sys/checkpnt.h>",
            "#  include <sys/prctl.h>",
            "#  include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void  _set_prio_process (stepd_step_rec_t *job);",
            "static void _set_job_log_prefix(stepd_step_rec_t *job);",
            "static int  _setup_normal_io(stepd_step_rec_t *job);",
            "static int  _slurmd_job_log_init(stepd_step_rec_t *job);",
            "static void _wait_for_io(stepd_step_rec_t *job);",
            "static int  _send_exit_msg(stepd_step_rec_t *job, uint32_t *tid, int n,\n\t\t\t   int status);",
            "static void _wait_for_children_slurmstepd(stepd_step_rec_t *job);",
            "static int  _send_pending_exit_msgs(stepd_step_rec_t *job);",
            "static void _send_step_complete_msgs(stepd_step_rec_t *job);",
            "static void _wait_for_all_tasks(stepd_step_rec_t *job);",
            "static void _setargs(stepd_step_rec_t *job);",
            "static void _random_sleep(stepd_step_rec_t *job);",
            "static char * _make_batch_dir(stepd_step_rec_t *job);",
            "static int    _send_complete_batch_script_msg(stepd_step_rec_t *job,\n\t\t\t\t\t      int err, int status);",
            "static int _initgroups(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/ulimits.h\"\n#include \"src/slurmd/slurmstepd/pam_ses.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmstepd/task.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/reverse_tree.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/slurm_mpi.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/safeopen.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/cbuf.h\"\n#include \"slurm/slurm_errno.h\"\n#    include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <string.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <pthread.h>\n#include <poll.h>\n#include <grp.h>\n#  include \"src/common/unsetenv.h\"\n#  include <sys/checkpnt.h>\n#  include <sys/prctl.h>\n#  include <sys/types.h>\n#  include \"config.h\"\n\nstatic void  _set_prio_process (stepd_step_rec_t *job);\nstatic void _set_job_log_prefix(stepd_step_rec_t *job);\nstatic int  _setup_normal_io(stepd_step_rec_t *job);\nstatic int  _slurmd_job_log_init(stepd_step_rec_t *job);\nstatic void _wait_for_io(stepd_step_rec_t *job);\nstatic int  _send_exit_msg(stepd_step_rec_t *job, uint32_t *tid, int n,\n\t\t\t   int status);\nstatic void _wait_for_children_slurmstepd(stepd_step_rec_t *job);\nstatic int  _send_pending_exit_msgs(stepd_step_rec_t *job);\nstatic void _send_step_complete_msgs(stepd_step_rec_t *job);\nstatic void _wait_for_all_tasks(stepd_step_rec_t *job);\nstatic void _setargs(stepd_step_rec_t *job);\nstatic void _random_sleep(stepd_step_rec_t *job);\nstatic char * _make_batch_dir(stepd_step_rec_t *job);\nstatic int    _send_complete_batch_script_msg(stepd_step_rec_t *job,\n\t\t\t\t\t      int err, int status);\nstatic int _initgroups(stepd_step_rec_t *job);\n\nstatic int\n_send_pending_exit_msgs(stepd_step_rec_t *job)\n{\n\tint  i;\n\tint  nsent  = 0;\n\tint  status = 0;\n\tbool set    = false;\n\tuint32_t *tid;\n\n\t/*\n\t * Collect all exit codes with the same status into a\n\t * single message.\n\t */\n\ttid = xmalloc(sizeof(uint32_t) * job->node_tasks);\n\tfor (i = 0; i < job->node_tasks; i++) {\n\t\tstepd_step_task_info_t *t = job->task[i];\n\n\t\tif (!t->exited || t->esent)\n\t\t\tcontinue;\n\n\t\tif (!set) {\n\t\t\tstatus = t->estatus;\n\t\t\tset    = true;\n\t\t} else if (status != t->estatus)\n\t\t\tcontinue;\n\n\t\ttid[nsent++] = t->gtid;\n\t\tt->esent = true;\n\t}\n\n\tif (nsent) {\n\t\tdebug2(\"Aggregated %d task exit messages\", nsent);\n\t\t_send_exit_msg(job, tid, nsent, status);\n\t}\n\txfree(tid);\n\n\treturn nsent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Unable to bind listen port (%s:%d): %m\"",
            "node_addr",
            "conf->port"
          ],
          "line": 1425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_init_msg_engine_addrname_port",
          "args": [
            "conf->node_addr",
            "conf->port"
          ],
          "line": 1417
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _create_msg_socket(void);\n\nstatic void\n_create_msg_socket(void)\n{\n\tchar* node_addr;\n\n\tslurm_fd_t ld = slurm_init_msg_engine_addrname_port(conf->node_addr,\n\t\t\t\t\t\t\t  conf->port);\n\tif (conf->node_addr == NULL)\n\t\tnode_addr = \"*\";\n\telse\n\t\tnode_addr = conf->node_addr;\n\n\tif (ld < 0) {\n\t\terror(\"Unable to bind listen port (%s:%d): %m\",\n\t\t      node_addr, conf->port);\n\t\texit(1);\n\t}\n\n\tfd_set_close_on_exec(ld);\n\n\tconf->lfd = ld;\n\n\tdebug3(\"successfully opened slurm listen port %s:%d\",\n\t       node_addr, conf->port);\n\n\treturn;\n}"
  },
  {
    "function_name": "_process_cmdline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1335-1409",
    "snippet": "static void\n_process_cmdline(int ac, char **av)\n{\n\tint c;\n\tchar *tmp_char;\n\n\tconf->prog = xbasename(av[0]);\n\n\twhile ((c = getopt(ac, av, GETOPT_ARGS)) > 0) {\n\t\tswitch (c) {\n\t\tcase 'b':\n\t\t\tconf->boot_time = 1;\n\t\t\tbreak;\n\t\tcase 'c':\n\t\t\tconf->cleanstart = 1;\n\t\t\tbreak;\n\t\tcase 'C':\n\t\t\t_print_config();\n\t\t\texit(0);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\txfree(conf->stepd_loc);\n\t\t\tconf->stepd_loc = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'D':\n\t\t\tconf->daemonize = 0;\n\t\t\tbreak;\n\t\tcase 'f':\n\t\t\tconf->conffile = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'h':\n\t\t\t_usage();\n\t\t\texit(0);\n\t\t\tbreak;\n\t\tcase 'L':\n\t\t\tconf->logfile = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'M':\n\t\t\tconf->mlock_pages = 1;\n\t\t\tbreak;\n\t\tcase 'n':\n\t\t\tconf->nice = strtol(optarg, &tmp_char, 10);\n\t\t\tif (tmp_char[0] != '\\0') {\n\t\t\t\terror(\"Invalid option for -n option (nice \"\n\t\t\t\t      \"value), ignored\");\n\t\t\t\tconf->nice = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'N':\n\t\t\tconf->node_name = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'v':\n\t\t\tconf->debug_level++;\n\t\t\tconf->debug_level_set = 1;\n\t\t\tbreak;\n\t\tcase 'V':\n\t\t\tprint_slurm_version();\n\t\t\texit(0);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_usage();\n\t\t\texit(1);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/*\n\t *  If slurmstepd path wasn't overridden by command line, set\n\t *   it to the default here:\n\t */\n\tif (!conf->stepd_loc) {\n\t\tconf->stepd_loc =\n\t\t\txstrdup_printf(\"%s/sbin/slurmstepd\", SLURM_PREFIX);\n\t}\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [
      "#define GETOPT_ARGS\t\"bcCd:Df:hL:Mn:N:vV\""
    ],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _print_config(void);",
      "static void      _process_cmdline(int ac, char **av);",
      "static void      _usage(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xstrdup_printf",
          "args": [
            "\"%s/sbin/slurmstepd\"",
            "SLURM_PREFIX"
          ],
          "line": 1407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 1396
        },
        "resolved": true,
        "details": {
          "function_name": "_send_pending_exit_msgs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/mgr.c",
          "lines": "1890-1927",
          "snippet": "static int\n_send_pending_exit_msgs(stepd_step_rec_t *job)\n{\n\tint  i;\n\tint  nsent  = 0;\n\tint  status = 0;\n\tbool set    = false;\n\tuint32_t *tid;\n\n\t/*\n\t * Collect all exit codes with the same status into a\n\t * single message.\n\t */\n\ttid = xmalloc(sizeof(uint32_t) * job->node_tasks);\n\tfor (i = 0; i < job->node_tasks; i++) {\n\t\tstepd_step_task_info_t *t = job->task[i];\n\n\t\tif (!t->exited || t->esent)\n\t\t\tcontinue;\n\n\t\tif (!set) {\n\t\t\tstatus = t->estatus;\n\t\t\tset    = true;\n\t\t} else if (status != t->estatus)\n\t\t\tcontinue;\n\n\t\ttid[nsent++] = t->gtid;\n\t\tt->esent = true;\n\t}\n\n\tif (nsent) {\n\t\tdebug2(\"Aggregated %d task exit messages\", nsent);\n\t\t_send_exit_msg(job, tid, nsent, status);\n\t}\n\txfree(tid);\n\n\treturn nsent;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/ulimits.h\"",
            "#include \"src/slurmd/slurmstepd/pam_ses.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmstepd/task.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/reverse_tree.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/slurm_mpi.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/safeopen.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#    include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <pthread.h>",
            "#include <poll.h>",
            "#include <grp.h>",
            "#  include \"src/common/unsetenv.h\"",
            "#  include <sys/checkpnt.h>",
            "#  include <sys/prctl.h>",
            "#  include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void  _set_prio_process (stepd_step_rec_t *job);",
            "static void _set_job_log_prefix(stepd_step_rec_t *job);",
            "static int  _setup_normal_io(stepd_step_rec_t *job);",
            "static int  _slurmd_job_log_init(stepd_step_rec_t *job);",
            "static void _wait_for_io(stepd_step_rec_t *job);",
            "static int  _send_exit_msg(stepd_step_rec_t *job, uint32_t *tid, int n,\n\t\t\t   int status);",
            "static void _wait_for_children_slurmstepd(stepd_step_rec_t *job);",
            "static int  _send_pending_exit_msgs(stepd_step_rec_t *job);",
            "static void _send_step_complete_msgs(stepd_step_rec_t *job);",
            "static void _wait_for_all_tasks(stepd_step_rec_t *job);",
            "static void _setargs(stepd_step_rec_t *job);",
            "static void _random_sleep(stepd_step_rec_t *job);",
            "static char * _make_batch_dir(stepd_step_rec_t *job);",
            "static int    _send_complete_batch_script_msg(stepd_step_rec_t *job,\n\t\t\t\t\t      int err, int status);",
            "static int _initgroups(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/ulimits.h\"\n#include \"src/slurmd/slurmstepd/pam_ses.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmstepd/task.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/reverse_tree.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/slurm_mpi.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/safeopen.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/cbuf.h\"\n#include \"slurm/slurm_errno.h\"\n#    include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <string.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <pthread.h>\n#include <poll.h>\n#include <grp.h>\n#  include \"src/common/unsetenv.h\"\n#  include <sys/checkpnt.h>\n#  include <sys/prctl.h>\n#  include <sys/types.h>\n#  include \"config.h\"\n\nstatic void  _set_prio_process (stepd_step_rec_t *job);\nstatic void _set_job_log_prefix(stepd_step_rec_t *job);\nstatic int  _setup_normal_io(stepd_step_rec_t *job);\nstatic int  _slurmd_job_log_init(stepd_step_rec_t *job);\nstatic void _wait_for_io(stepd_step_rec_t *job);\nstatic int  _send_exit_msg(stepd_step_rec_t *job, uint32_t *tid, int n,\n\t\t\t   int status);\nstatic void _wait_for_children_slurmstepd(stepd_step_rec_t *job);\nstatic int  _send_pending_exit_msgs(stepd_step_rec_t *job);\nstatic void _send_step_complete_msgs(stepd_step_rec_t *job);\nstatic void _wait_for_all_tasks(stepd_step_rec_t *job);\nstatic void _setargs(stepd_step_rec_t *job);\nstatic void _random_sleep(stepd_step_rec_t *job);\nstatic char * _make_batch_dir(stepd_step_rec_t *job);\nstatic int    _send_complete_batch_script_msg(stepd_step_rec_t *job,\n\t\t\t\t\t      int err, int status);\nstatic int _initgroups(stepd_step_rec_t *job);\n\nstatic int\n_send_pending_exit_msgs(stepd_step_rec_t *job)\n{\n\tint  i;\n\tint  nsent  = 0;\n\tint  status = 0;\n\tbool set    = false;\n\tuint32_t *tid;\n\n\t/*\n\t * Collect all exit codes with the same status into a\n\t * single message.\n\t */\n\ttid = xmalloc(sizeof(uint32_t) * job->node_tasks);\n\tfor (i = 0; i < job->node_tasks; i++) {\n\t\tstepd_step_task_info_t *t = job->task[i];\n\n\t\tif (!t->exited || t->esent)\n\t\t\tcontinue;\n\n\t\tif (!set) {\n\t\t\tstatus = t->estatus;\n\t\t\tset    = true;\n\t\t} else if (status != t->estatus)\n\t\t\tcontinue;\n\n\t\ttid[nsent++] = t->gtid;\n\t\tt->esent = true;\n\t}\n\n\tif (nsent) {\n\t\tdebug2(\"Aggregated %d task exit messages\", nsent);\n\t\t_send_exit_msg(job, tid, nsent, status);\n\t}\n\txfree(tid);\n\n\treturn nsent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_usage",
          "args": [],
          "line": 1395
        },
        "resolved": true,
        "details": {
          "function_name": "_usage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1838-1857",
          "snippet": "static void\n_usage(void)\n{\n\tfprintf(stderr, \"\\\nUsage: %s [OPTIONS]\\n\\\n   -b          Report node reboot now.\\n\\\n   -c          Force cleanup of slurmd shared memory.\\n\\\n   -C          Print node configuration information and exit.\\n\\\n   -d stepd    Pathname to the slurmstepd program.\\n\\\n   -D          Run daemon in foreground.\\n\\\n   -f config   Read configuration from the specified file.\\n\\\n   -h          Print this help message.\\n\\\n   -L logfile  Log messages to the file `logfile'.\\n\\\n   -M          Use mlock() to lock slurmd pages into memory.\\n\\\n   -n value    Run the daemon at the specified nice value.\\n\\\n   -N host     Run the daemon for specified hostname.\\n\\\n   -v          Verbose mode. Multiple -v's increase verbosity.\\n\\\n   -V          Print version information and exit.\\n\", conf->prog);\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _usage(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _usage(void);\n\nstatic void\n_usage(void)\n{\n\tfprintf(stderr, \"\\\nUsage: %s [OPTIONS]\\n\\\n   -b          Report node reboot now.\\n\\\n   -c          Force cleanup of slurmd shared memory.\\n\\\n   -C          Print node configuration information and exit.\\n\\\n   -d stepd    Pathname to the slurmstepd program.\\n\\\n   -D          Run daemon in foreground.\\n\\\n   -f config   Read configuration from the specified file.\\n\\\n   -h          Print this help message.\\n\\\n   -L logfile  Log messages to the file `logfile'.\\n\\\n   -M          Use mlock() to lock slurmd pages into memory.\\n\\\n   -n value    Run the daemon at the specified nice value.\\n\\\n   -N host     Run the daemon for specified hostname.\\n\\\n   -v          Verbose mode. Multiple -v's increase verbosity.\\n\\\n   -V          Print version information and exit.\\n\", conf->prog);\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_slurm_version",
          "args": [],
          "line": 1391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "optarg"
          ],
          "line": 1384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Invalid option for -n option (nice \"\n\t\t\t\t      \"value), ignored\""
          ],
          "line": 1378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "optarg",
            "&tmp_char",
            "10"
          ],
          "line": 1376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "optarg"
          ],
          "line": 1370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "optarg"
          ],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "optarg"
          ],
          "line": 1357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "conf->stepd_loc"
          ],
          "line": 1356
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_print_config",
          "args": [],
          "line": 1352
        },
        "resolved": true,
        "details": {
          "function_name": "_print_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1298-1333",
          "snippet": "static void\n_print_config(void)\n{\n\tint days, hours, mins, secs;\n\tchar name[128];\n\n\tif (conf->cluster_name)\n\t\tprintf(\"ClusterName=%s \", conf->cluster_name);\n\n\tgethostname_short(name, sizeof(name));\n\tprintf(\"NodeName=%s \", name);\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n\tprintf(\"CPUs=%u Boards=%u SocketsPerBoard=%u CoresPerSocket=%u \"\n\t       \"ThreadsPerCore=%u \",\n\t       conf->actual_cpus, conf->actual_boards, conf->actual_sockets,\n\t       conf->actual_cores, conf->actual_threads);\n\n\tget_memory(&conf->real_memory_size);\n\tget_tmp_disk(&conf->tmp_disk_space, \"/tmp\");\n\tprintf(\"RealMemory=%u TmpDisk=%u\\n\",\n\t       conf->real_memory_size, conf->tmp_disk_space);\n\n\tget_up_time(&conf->up_time);\n\tsecs  =  conf->up_time % 60;\n\tmins  = (conf->up_time / 60) % 60;\n\thours = (conf->up_time / 3600) % 24;\n\tdays  = (conf->up_time / 86400);\n\tprintf(\"UpTime=%u-%2.2u:%2.2u:%2.2u\\n\", days, hours, mins, secs);\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _print_config(void);",
            "static void      _wait_for_all_threads(int secs);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _print_config(void);\nstatic void      _wait_for_all_threads(int secs);\n\nstatic void\n_print_config(void)\n{\n\tint days, hours, mins, secs;\n\tchar name[128];\n\n\tif (conf->cluster_name)\n\t\tprintf(\"ClusterName=%s \", conf->cluster_name);\n\n\tgethostname_short(name, sizeof(name));\n\tprintf(\"NodeName=%s \", name);\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n\tprintf(\"CPUs=%u Boards=%u SocketsPerBoard=%u CoresPerSocket=%u \"\n\t       \"ThreadsPerCore=%u \",\n\t       conf->actual_cpus, conf->actual_boards, conf->actual_sockets,\n\t       conf->actual_cores, conf->actual_threads);\n\n\tget_memory(&conf->real_memory_size);\n\tget_tmp_disk(&conf->tmp_disk_space, \"/tmp\");\n\tprintf(\"RealMemory=%u TmpDisk=%u\\n\",\n\t       conf->real_memory_size, conf->tmp_disk_space);\n\n\tget_up_time(&conf->up_time);\n\tsecs  =  conf->up_time % 60;\n\tmins  = (conf->up_time / 60) % 60;\n\thours = (conf->up_time / 3600) % 24;\n\tdays  = (conf->up_time / 86400);\n\tprintf(\"UpTime=%u-%2.2u:%2.2u:%2.2u\\n\", days, hours, mins, secs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getopt",
          "args": [
            "ac",
            "av",
            "GETOPT_ARGS"
          ],
          "line": 1343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xbasename",
          "args": [
            "av[0]"
          ],
          "line": 1341
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\n#define GETOPT_ARGS\t\"bcCd:Df:hL:Mn:N:vV\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _print_config(void);\nstatic void      _process_cmdline(int ac, char **av);\nstatic void      _usage(void);\n\nstatic void\n_process_cmdline(int ac, char **av)\n{\n\tint c;\n\tchar *tmp_char;\n\n\tconf->prog = xbasename(av[0]);\n\n\twhile ((c = getopt(ac, av, GETOPT_ARGS)) > 0) {\n\t\tswitch (c) {\n\t\tcase 'b':\n\t\t\tconf->boot_time = 1;\n\t\t\tbreak;\n\t\tcase 'c':\n\t\t\tconf->cleanstart = 1;\n\t\t\tbreak;\n\t\tcase 'C':\n\t\t\t_print_config();\n\t\t\texit(0);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\txfree(conf->stepd_loc);\n\t\t\tconf->stepd_loc = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'D':\n\t\t\tconf->daemonize = 0;\n\t\t\tbreak;\n\t\tcase 'f':\n\t\t\tconf->conffile = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'h':\n\t\t\t_usage();\n\t\t\texit(0);\n\t\t\tbreak;\n\t\tcase 'L':\n\t\t\tconf->logfile = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'M':\n\t\t\tconf->mlock_pages = 1;\n\t\t\tbreak;\n\t\tcase 'n':\n\t\t\tconf->nice = strtol(optarg, &tmp_char, 10);\n\t\t\tif (tmp_char[0] != '\\0') {\n\t\t\t\terror(\"Invalid option for -n option (nice \"\n\t\t\t\t      \"value), ignored\");\n\t\t\t\tconf->nice = 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'N':\n\t\t\tconf->node_name = xstrdup(optarg);\n\t\t\tbreak;\n\t\tcase 'v':\n\t\t\tconf->debug_level++;\n\t\t\tconf->debug_level_set = 1;\n\t\t\tbreak;\n\t\tcase 'V':\n\t\t\tprint_slurm_version();\n\t\t\texit(0);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_usage();\n\t\t\texit(1);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/*\n\t *  If slurmstepd path wasn't overridden by command line, set\n\t *   it to the default here:\n\t */\n\tif (!conf->stepd_loc) {\n\t\tconf->stepd_loc =\n\t\t\txstrdup_printf(\"%s/sbin/slurmstepd\", SLURM_PREFIX);\n\t}\n}"
  },
  {
    "function_name": "_print_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1298-1333",
    "snippet": "static void\n_print_config(void)\n{\n\tint days, hours, mins, secs;\n\tchar name[128];\n\n\tif (conf->cluster_name)\n\t\tprintf(\"ClusterName=%s \", conf->cluster_name);\n\n\tgethostname_short(name, sizeof(name));\n\tprintf(\"NodeName=%s \", name);\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n\tprintf(\"CPUs=%u Boards=%u SocketsPerBoard=%u CoresPerSocket=%u \"\n\t       \"ThreadsPerCore=%u \",\n\t       conf->actual_cpus, conf->actual_boards, conf->actual_sockets,\n\t       conf->actual_cores, conf->actual_threads);\n\n\tget_memory(&conf->real_memory_size);\n\tget_tmp_disk(&conf->tmp_disk_space, \"/tmp\");\n\tprintf(\"RealMemory=%u TmpDisk=%u\\n\",\n\t       conf->real_memory_size, conf->tmp_disk_space);\n\n\tget_up_time(&conf->up_time);\n\tsecs  =  conf->up_time % 60;\n\tmins  = (conf->up_time / 60) % 60;\n\thours = (conf->up_time / 3600) % 24;\n\tdays  = (conf->up_time / 86400);\n\tprintf(\"UpTime=%u-%2.2u:%2.2u:%2.2u\\n\", days, hours, mins, secs);\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _print_config(void);",
      "static void      _wait_for_all_threads(int secs);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"UpTime=%u-%2.2u:%2.2u:%2.2u\\n\"",
            "days",
            "hours",
            "mins",
            "secs"
          ],
          "line": 1332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_up_time",
          "args": [
            "&conf->up_time"
          ],
          "line": 1327
        },
        "resolved": true,
        "details": {
          "function_name": "get_up_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "274-325",
          "snippet": "extern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"RealMemory=%u TmpDisk=%u\\n\"",
            "conf->real_memory_size",
            "conf->tmp_disk_space"
          ],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_tmp_disk",
          "args": [
            "&conf->tmp_disk_space",
            "\"/tmp\""
          ],
          "line": 1323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_memory",
          "args": [
            "&conf->real_memory_size"
          ],
          "line": 1322
        },
        "resolved": true,
        "details": {
          "function_name": "get_memory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "171-204",
          "snippet": "extern int\nget_memory(uint32_t *real_memory)\n{\n#ifdef HAVE__SYSTEM_CONFIGURATION\n\t*real_memory = _system_configuration.physmem / (1024 * 1024);\n#else\n#  ifdef _SC_PHYS_PAGES\n\tlong pages;\n\n\t*real_memory = 1;\n\tpages = sysconf(_SC_PHYS_PAGES);\n\tif (pages < 1) {\n\t\terror (\"get_memory: error running sysconf(_SC_PHYS_PAGES)\");\n\t\treturn EINVAL;\n\t}\n\t*real_memory = (uint32_t)((float)pages * (sysconf(_SC_PAGE_SIZE) /\n\t\t\t1048576.0)); /* Megabytes of memory */\n#  else  /* !_SC_PHYS_PAGES */\n#    if HAVE_SYSCTLBYNAME\n\tint mem;\n\tsize_t len = sizeof(mem);\n\tif (sysctlbyname(\"hw.physmem\", &mem, &len, NULL, 0) == -1) {\n\t\terror(\"get_memory: error running sysctl(HW_PHYSMEM)\");\n\t\treturn EINVAL;\n\t}\n\t*real_memory = mem;\n#    else /* !HAVE_SYSCTLBYNAME */\n\t*real_memory = 1;\n#    endif /* HAVE_SYSCTLBYNAME */\n#  endif /* _SC_PHYS_PAGES */\n#endif /* HAVE__SYSTEM_CONFIGURATION */\n\n\treturn 0;\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int\nget_memory(uint32_t *real_memory)\n{\n#ifdef HAVE__SYSTEM_CONFIGURATION\n\t*real_memory = _system_configuration.physmem / (1024 * 1024);\n#else\n#  ifdef _SC_PHYS_PAGES\n\tlong pages;\n\n\t*real_memory = 1;\n\tpages = sysconf(_SC_PHYS_PAGES);\n\tif (pages < 1) {\n\t\terror (\"get_memory: error running sysconf(_SC_PHYS_PAGES)\");\n\t\treturn EINVAL;\n\t}\n\t*real_memory = (uint32_t)((float)pages * (sysconf(_SC_PAGE_SIZE) /\n\t\t\t1048576.0)); /* Megabytes of memory */\n#  else  /* !_SC_PHYS_PAGES */\n#    if HAVE_SYSCTLBYNAME\n\tint mem;\n\tsize_t len = sizeof(mem);\n\tif (sysctlbyname(\"hw.physmem\", &mem, &len, NULL, 0) == -1) {\n\t\terror(\"get_memory: error running sysctl(HW_PHYSMEM)\");\n\t\treturn EINVAL;\n\t}\n\t*real_memory = mem;\n#    else /* !HAVE_SYSCTLBYNAME */\n\t*real_memory = 1;\n#    endif /* HAVE_SYSCTLBYNAME */\n#  endif /* _SC_PHYS_PAGES */\n#endif /* HAVE__SYSTEM_CONFIGURATION */\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"CPUs=%u Boards=%u SocketsPerBoard=%u CoresPerSocket=%u \"\n\t       \"ThreadsPerCore=%u \"",
            "conf->actual_cpus",
            "conf->actual_boards",
            "conf->actual_sockets",
            "conf->actual_cores",
            "conf->actual_threads"
          ],
          "line": 1317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpuinfo",
          "args": [
            "&conf->actual_cpus",
            "&conf->actual_boards",
            "&conf->actual_sockets",
            "&conf->actual_cores",
            "&conf->actual_threads",
            "&conf->block_map_size",
            "&conf->block_map",
            "&conf->block_map_inv"
          ],
          "line": 1310
        },
        "resolved": true,
        "details": {
          "function_name": "get_cpuinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcpuinfo.c",
          "lines": "438-744",
          "snippet": "extern int\nget_cpuinfo(uint16_t *p_cpus, uint16_t *p_boards,\n\t    uint16_t *p_sockets, uint16_t *p_cores, uint16_t *p_threads,\n\t    uint16_t *p_block_map_size,\n\t    uint16_t **p_block_map, uint16_t **p_block_map_inv)\n{\n\tint retval;\n\n\tuint16_t numproc;\n\tuint16_t numcpu\t   = 0;\t\t/* number of cpus seen */\n\tuint16_t numphys   = 0;\t\t/* number of unique \"physical id\"s */\n\tuint16_t numcores  = 0;\t\t/* number of unique \"cores id\"s */\n\n\tuint16_t maxsibs   = 0;\t\t/* maximum value of \"siblings\" */\n\tuint16_t maxcores  = 0;\t\t/* maximum value of \"cores\" */\n\tuint16_t minsibs   = 0xffff;\t/* minimum value of \"siblings\" */\n\tuint16_t mincores  = 0xffff;\t/* minimum value of \"cores\" */\n\n\tuint32_t maxcpuid  = 0;\t\t/* maximum CPU ID (\"processor\") */\n\tuint32_t maxphysid = 0;\t\t/* maximum \"physical id\" */\n\tuint32_t maxcoreid = 0;\t\t/* maximum \"core id\" */\n\tuint32_t mincpuid  = 0xffffffff;/* minimum CPU ID (\"processor\") */\n\tuint32_t minphysid = 0xffffffff;/* minimum \"physical id\" */\n\tuint32_t mincoreid = 0xffffffff;/* minimum \"core id\" */\n\tint i;\n#if defined (__sun)\n#if defined (_LP64)\n\tint64_t curcpu, val, sockets, cores, threads;\n#else\n\tint32_t curcpu, val, sockets, cores, threads;\n#endif\n\tint32_t chip_id, core_id, ncore_per_chip, ncpu_per_chip;\n#else\n\tFILE *cpu_info_file;\n\tchar buffer[128];\n\tuint16_t curcpu, sockets, cores, threads;\n#endif\n\n\tget_procs(&numproc);\n\t*p_cpus = numproc;\n\t*p_boards = 1;\t\t/* Boards not identified from /proc/cpuinfo */\n\t*p_sockets = numproc;\t/* initially all single core/thread */\n\t*p_cores   = 1;\n\t*p_threads = 1;\n\t*p_block_map_size = 0;\n\t*p_block_map      = NULL;\n\t*p_block_map_inv  = NULL;\n\n#if defined (__sun)\n\tkstat_ctl_t   *kc;\n\tkstat_t       *ksp;\n\tkstat_named_t *knp;\n\n\tkc = kstat_open();\n\tif (kc == NULL) {\n\t\terror (\"get speed: kstat error %d\", errno);\n\t\treturn errno;\n\t}\n#else\n\tcpu_info_file = fopen(_cpuinfo_path, \"r\");\n\tif (cpu_info_file == NULL) {\n\t\terror (\"get_cpuinfo: error %d opening %s\",\n\t\t\terrno, _cpuinfo_path);\n\t\treturn errno;\n\t}\n#endif\n\n\t/* Note: assumes all processor IDs are within [0:numproc-1] */\n\t/*       treats physical/core IDs as tokens, not indices */\n\tif (cpuinfo)\n\t\tmemset(cpuinfo, 0, numproc * sizeof(cpuinfo_t));\n\telse\n\t\tcpuinfo = xmalloc(numproc * sizeof(cpuinfo_t));\n\n#if defined (__sun)\n\tksp = kstat_lookup(kc, \"cpu_info\", -1, NULL);\n\tfor (; ksp != NULL; ksp = ksp->ks_next) {\n\t\tif (xstrcmp(ksp->ks_module, \"cpu_info\"))\n\t\t\tcontinue;\n\n\t\tnumcpu++;\n\t\tkstat_read(kc, ksp, NULL);\n\n\t\tknp = kstat_data_lookup(ksp, \"chip_id\");\n\t\tchip_id = knp->value.l;\n\t\tknp = kstat_data_lookup(ksp, \"core_id\");\n\t\tcore_id = knp->value.l;\n\t\tknp = kstat_data_lookup(ksp, \"ncore_per_chip\");\n\t\tncore_per_chip = knp->value.l;\n\t\tknp = kstat_data_lookup(ksp, \"ncpu_per_chip\");\n\t\tncpu_per_chip = knp->value.l;\n\n\t\tif (chip_id >= numproc) {\n\t\t\tdebug(\"cpuid is %ld (> %d), ignored\", curcpu, numproc);\n\t\t\tcontinue;\n\t\t}\n\n\t\tcpuinfo[chip_id].seen = 1;\n\t\tcpuinfo[chip_id].cpuid = chip_id;\n\n\t\tmaxcpuid = MAX(maxcpuid, chip_id);\n\t\tmincpuid = MIN(mincpuid, chip_id);\n\n\t\tfor (i = 0; i < numproc; i++) {\n\t\t\tif ((cpuinfo[i].coreid == core_id) &&\n\t\t\t    (cpuinfo[i].corecnt))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i == numproc) {\n\t\t\tnumcores++;\n\t\t} else {\n\t\t\tcpuinfo[i].corecnt++;\n\t\t}\n\n\t\tif (chip_id < numproc) {\n\t\t\tcpuinfo[chip_id].corecnt++;\n\t\t\tcpuinfo[chip_id].coreid = core_id;\n\t\t}\n\n\t\tmaxcoreid = MAX(maxcoreid, core_id);\n\t\tmincoreid = MIN(mincoreid, core_id);\n\n\t\tif (ncore_per_chip > numproc) {\n\t\t\tdebug(\"cores is %u (> %d), ignored\",\n\t\t\t      ncore_per_chip, numproc);\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tif (chip_id < numproc)\n\t\t\tcpuinfo[chip_id].cores = ncore_per_chip;\n\n\t\tmaxcores = MAX(maxcores, ncore_per_chip);\n\t\tmincores = MIN(mincores, ncore_per_chip);\n\t}\n#else\n\n\tcurcpu = 0;\n\twhile (fgets(buffer, sizeof(buffer), cpu_info_file) != NULL) {\n\t\tuint32_t val;\n\t\tif (_chk_cpuinfo_uint32(buffer, \"processor\", &val)) {\n\t\t\tcurcpu = numcpu;\n\t\t\tnumcpu++;\n\t\t\tif (curcpu >= numproc) {\n\t\t\t\tinfo(\"processor limit reached (%u >= %d)\",\n\t\t\t\t     curcpu, numproc);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tcpuinfo[curcpu].seen = 1;\n\t\t\tcpuinfo[curcpu].cpuid = val;\n\t\t\tmaxcpuid = MAX(maxcpuid, val);\n\t\t\tmincpuid = MIN(mincpuid, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"physical id\", &val)) {\n\t\t\t/* see if the ID has already been seen */\n\t\t\tfor (i=0; i<numproc; i++) {\n\t\t\t\tif ((cpuinfo[i].physid == val)\n\t\t\t\t&&  (cpuinfo[i].physcnt))\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (i == numproc) {\t\t/* new ID... */\n\t\t\t\tnumphys++;\t\t/* ...increment total */\n\t\t\t} else {\t\t\t/* existing ID... */\n\t\t\t\tcpuinfo[i].physcnt++;\t/* ...update ID cnt */\n\t\t\t}\n\n\t\t\tif (curcpu < numproc) {\n\t\t\t\tcpuinfo[curcpu].physcnt++;\n\t\t\t\tcpuinfo[curcpu].physid = val;\n\t\t\t}\n\n\t\t\tmaxphysid = MAX(maxphysid, val);\n\t\t\tminphysid = MIN(minphysid, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"core id\", &val)) {\n\t\t\t/* see if the ID has already been seen */\n\t\t\tfor (i = 0; i < numproc; i++) {\n\t\t\t\tif ((cpuinfo[i].coreid == val)\n\t\t\t\t&&  (cpuinfo[i].corecnt))\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (i == numproc) {\t\t/* new ID... */\n\t\t\t\tnumcores++;\t\t/* ...increment total */\n\t\t\t} else {\t\t\t/* existing ID... */\n\t\t\t\tcpuinfo[i].corecnt++;\t/* ...update ID cnt */\n\t\t\t}\n\n\t\t\tif (curcpu < numproc) {\n\t\t\t\tcpuinfo[curcpu].corecnt++;\n\t\t\t\tcpuinfo[curcpu].coreid = val;\n\t\t\t}\n\n\t\t\tmaxcoreid = MAX(maxcoreid, val);\n\t\t\tmincoreid = MIN(mincoreid, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"siblings\", &val)) {\n\t\t\t/* Note: this value is a count, not an index */\n\t\t    \tif (val > numproc) {\t/* out of bounds, ignore */\n\t\t\t\tdebug(\"siblings is %u (> %d), ignored\",\n\t\t\t\t\tval, numproc);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (curcpu < numproc)\n\t\t\t\tcpuinfo[curcpu].siblings = val;\n\t\t\tmaxsibs = MAX(maxsibs, val);\n\t\t\tminsibs = MIN(minsibs, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"cpu cores\", &val)) {\n\t\t\t/* Note: this value is a count, not an index */\n\t\t    \tif (val > numproc) {\t/* out of bounds, ignore */\n\t\t\t\tdebug(\"cores is %u (> %d), ignored\",\n\t\t\t\t\tval, numproc);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (curcpu < numproc)\n\t\t\t\tcpuinfo[curcpu].cores = val;\n\t\t\tmaxcores = MAX(maxcores, val);\n\t\t\tmincores = MIN(mincores, val);\n\t\t}\n\t}\n\n\tfclose(cpu_info_file);\n#endif\n\n\t/*** Sanity check ***/\n\tif (minsibs == 0) minsibs = 1;\t\t/* guaranteee non-zero */\n\tif (maxsibs == 0) {\n\t    \tminsibs = 1;\n\t    \tmaxsibs = 1;\n\t}\n\tif (maxcores == 0) {\t\t\t/* no core data */\n\t    \tmincores = 0;\n\t    \tmaxcores = 0;\n\t}\n\n\t/*** Compute Sockets/Cores/Threads ***/\n\tif ((minsibs == maxsibs) &&\t\t/* homogeneous system */\n\t    (mincores == maxcores)) {\n\t\tsockets = numphys; \t\t/* unique \"physical id\" */\n\t\tif (sockets <= 1) {\t\t/* verify single socket */\n\t\t\tsockets = numcpu / maxsibs; /* maximum \"siblings\" */\n\t\t}\n\t\tif (sockets == 0)\n\t\t\tsockets = 1;\t\t/* guarantee non-zero */\n\n\t\tcores = numcores / sockets;\t/* unique \"core id\" */\n\t\tcores = MAX(maxcores, cores);\t/* maximum \"cpu cores\" */\n\n\t\tif (cores == 0) {\n\t\t\tcores = numcpu / sockets;\t/* assume multi-core */\n\t\t\tif (cores > 1) {\n\t\t\t\tdebug3(\"Warning: cpuinfo missing 'core id' or \"\n\t\t\t\t\t\"'cpu cores' but assuming multi-core\");\n\t\t\t}\n\t\t}\n\t\tif (cores == 0)\n\t\t\tcores = 1;\t/* guarantee non-zero */\n\n\t\tthreads = numcpu / (sockets * cores); /* solve for threads */\n\t\tif (threads == 0)\n\t\t\tthreads = 1;\t/* guarantee non-zero */\n\t} else {\t\t\t\t/* heterogeneous system */\n\t\tsockets = numcpu;\n\t\tcores   = 1;\t\t\t/* one core per socket */\n\t\tthreads = 1;\t\t\t/* one core per core */\n\t}\n\n\t*p_sockets = sockets;\t\t/* update output parameters */\n\t*p_cores   = cores;\n\t*p_threads = threads;\n\n#if _DEBUG\n\t/*** Display raw data ***/\n\tdebug3(\"numcpu:     %u\", numcpu);\n\tdebug3(\"numphys:    %u\", numphys);\n\tdebug3(\"numcores:   %u\", numcores);\n\n\tdebug3(\"cores:      %u->%u\", mincores, maxcores);\n\tdebug3(\"sibs:       %u->%u\", minsibs,  maxsibs);\n\n\tdebug3(\"cpuid:      %u->%u\", mincpuid,  maxcpuid);\n\tdebug3(\"physid:     %u->%u\", minphysid, maxphysid);\n\tdebug3(\"coreid:     %u->%u\", mincoreid, maxcoreid);\n\n\tfor (i = 0; i < numproc; i++) {\n\t\tdebug3(\"CPU %d:\", i);\n\t\tdebug3(\" cpuid:    %u\", cpuinfo[i].cpuid);\n\t\tdebug3(\" seen:     %u\", cpuinfo[i].seen);\n\t\tdebug3(\" physid:   %u\", cpuinfo[i].physid);\n\t\tdebug3(\" physcnt:  %u\", cpuinfo[i].physcnt);\n\t\tdebug3(\" siblings: %u\", cpuinfo[i].siblings);\n\t\tdebug3(\" cores:    %u\", cpuinfo[i].cores);\n\t\tdebug3(\" coreid:   %u\", cpuinfo[i].coreid);\n\t\tdebug3(\" corecnt:  %u\\n\", cpuinfo[i].corecnt);\n\t}\n\n\tdebug3(\"Sockets:          %u\", sockets);\n\tdebug3(\"Cores per socket: %u\", cores);\n\tdebug3(\"Threads per core: %u\", threads);\n#endif\n\n\t*p_block_map_size = numcpu;\n\tretval = _compute_block_map(*p_block_map_size, p_block_map,\n\t\t\t\t    p_block_map_inv);\n\n\txfree(cpuinfo);\t\t/* done with raw cpuinfo data */\n\n\treturn retval;\n}",
          "includes": [
            "#include \"xcpuinfo.h\"",
            "#include <hwloc.h>",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <ctype.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define _DEBUG 0"
          ],
          "globals_used": [
            "uint16_t procs, boards, sockets, cores, threads=1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcpuinfo.h\"\n#include <hwloc.h>\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <ctype.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define _DEBUG 0\n\nuint16_t procs, boards, sockets, cores, threads=1;\n\nextern int\nget_cpuinfo(uint16_t *p_cpus, uint16_t *p_boards,\n\t    uint16_t *p_sockets, uint16_t *p_cores, uint16_t *p_threads,\n\t    uint16_t *p_block_map_size,\n\t    uint16_t **p_block_map, uint16_t **p_block_map_inv)\n{\n\tint retval;\n\n\tuint16_t numproc;\n\tuint16_t numcpu\t   = 0;\t\t/* number of cpus seen */\n\tuint16_t numphys   = 0;\t\t/* number of unique \"physical id\"s */\n\tuint16_t numcores  = 0;\t\t/* number of unique \"cores id\"s */\n\n\tuint16_t maxsibs   = 0;\t\t/* maximum value of \"siblings\" */\n\tuint16_t maxcores  = 0;\t\t/* maximum value of \"cores\" */\n\tuint16_t minsibs   = 0xffff;\t/* minimum value of \"siblings\" */\n\tuint16_t mincores  = 0xffff;\t/* minimum value of \"cores\" */\n\n\tuint32_t maxcpuid  = 0;\t\t/* maximum CPU ID (\"processor\") */\n\tuint32_t maxphysid = 0;\t\t/* maximum \"physical id\" */\n\tuint32_t maxcoreid = 0;\t\t/* maximum \"core id\" */\n\tuint32_t mincpuid  = 0xffffffff;/* minimum CPU ID (\"processor\") */\n\tuint32_t minphysid = 0xffffffff;/* minimum \"physical id\" */\n\tuint32_t mincoreid = 0xffffffff;/* minimum \"core id\" */\n\tint i;\n#if defined (__sun)\n#if defined (_LP64)\n\tint64_t curcpu, val, sockets, cores, threads;\n#else\n\tint32_t curcpu, val, sockets, cores, threads;\n#endif\n\tint32_t chip_id, core_id, ncore_per_chip, ncpu_per_chip;\n#else\n\tFILE *cpu_info_file;\n\tchar buffer[128];\n\tuint16_t curcpu, sockets, cores, threads;\n#endif\n\n\tget_procs(&numproc);\n\t*p_cpus = numproc;\n\t*p_boards = 1;\t\t/* Boards not identified from /proc/cpuinfo */\n\t*p_sockets = numproc;\t/* initially all single core/thread */\n\t*p_cores   = 1;\n\t*p_threads = 1;\n\t*p_block_map_size = 0;\n\t*p_block_map      = NULL;\n\t*p_block_map_inv  = NULL;\n\n#if defined (__sun)\n\tkstat_ctl_t   *kc;\n\tkstat_t       *ksp;\n\tkstat_named_t *knp;\n\n\tkc = kstat_open();\n\tif (kc == NULL) {\n\t\terror (\"get speed: kstat error %d\", errno);\n\t\treturn errno;\n\t}\n#else\n\tcpu_info_file = fopen(_cpuinfo_path, \"r\");\n\tif (cpu_info_file == NULL) {\n\t\terror (\"get_cpuinfo: error %d opening %s\",\n\t\t\terrno, _cpuinfo_path);\n\t\treturn errno;\n\t}\n#endif\n\n\t/* Note: assumes all processor IDs are within [0:numproc-1] */\n\t/*       treats physical/core IDs as tokens, not indices */\n\tif (cpuinfo)\n\t\tmemset(cpuinfo, 0, numproc * sizeof(cpuinfo_t));\n\telse\n\t\tcpuinfo = xmalloc(numproc * sizeof(cpuinfo_t));\n\n#if defined (__sun)\n\tksp = kstat_lookup(kc, \"cpu_info\", -1, NULL);\n\tfor (; ksp != NULL; ksp = ksp->ks_next) {\n\t\tif (xstrcmp(ksp->ks_module, \"cpu_info\"))\n\t\t\tcontinue;\n\n\t\tnumcpu++;\n\t\tkstat_read(kc, ksp, NULL);\n\n\t\tknp = kstat_data_lookup(ksp, \"chip_id\");\n\t\tchip_id = knp->value.l;\n\t\tknp = kstat_data_lookup(ksp, \"core_id\");\n\t\tcore_id = knp->value.l;\n\t\tknp = kstat_data_lookup(ksp, \"ncore_per_chip\");\n\t\tncore_per_chip = knp->value.l;\n\t\tknp = kstat_data_lookup(ksp, \"ncpu_per_chip\");\n\t\tncpu_per_chip = knp->value.l;\n\n\t\tif (chip_id >= numproc) {\n\t\t\tdebug(\"cpuid is %ld (> %d), ignored\", curcpu, numproc);\n\t\t\tcontinue;\n\t\t}\n\n\t\tcpuinfo[chip_id].seen = 1;\n\t\tcpuinfo[chip_id].cpuid = chip_id;\n\n\t\tmaxcpuid = MAX(maxcpuid, chip_id);\n\t\tmincpuid = MIN(mincpuid, chip_id);\n\n\t\tfor (i = 0; i < numproc; i++) {\n\t\t\tif ((cpuinfo[i].coreid == core_id) &&\n\t\t\t    (cpuinfo[i].corecnt))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i == numproc) {\n\t\t\tnumcores++;\n\t\t} else {\n\t\t\tcpuinfo[i].corecnt++;\n\t\t}\n\n\t\tif (chip_id < numproc) {\n\t\t\tcpuinfo[chip_id].corecnt++;\n\t\t\tcpuinfo[chip_id].coreid = core_id;\n\t\t}\n\n\t\tmaxcoreid = MAX(maxcoreid, core_id);\n\t\tmincoreid = MIN(mincoreid, core_id);\n\n\t\tif (ncore_per_chip > numproc) {\n\t\t\tdebug(\"cores is %u (> %d), ignored\",\n\t\t\t      ncore_per_chip, numproc);\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tif (chip_id < numproc)\n\t\t\tcpuinfo[chip_id].cores = ncore_per_chip;\n\n\t\tmaxcores = MAX(maxcores, ncore_per_chip);\n\t\tmincores = MIN(mincores, ncore_per_chip);\n\t}\n#else\n\n\tcurcpu = 0;\n\twhile (fgets(buffer, sizeof(buffer), cpu_info_file) != NULL) {\n\t\tuint32_t val;\n\t\tif (_chk_cpuinfo_uint32(buffer, \"processor\", &val)) {\n\t\t\tcurcpu = numcpu;\n\t\t\tnumcpu++;\n\t\t\tif (curcpu >= numproc) {\n\t\t\t\tinfo(\"processor limit reached (%u >= %d)\",\n\t\t\t\t     curcpu, numproc);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tcpuinfo[curcpu].seen = 1;\n\t\t\tcpuinfo[curcpu].cpuid = val;\n\t\t\tmaxcpuid = MAX(maxcpuid, val);\n\t\t\tmincpuid = MIN(mincpuid, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"physical id\", &val)) {\n\t\t\t/* see if the ID has already been seen */\n\t\t\tfor (i=0; i<numproc; i++) {\n\t\t\t\tif ((cpuinfo[i].physid == val)\n\t\t\t\t&&  (cpuinfo[i].physcnt))\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (i == numproc) {\t\t/* new ID... */\n\t\t\t\tnumphys++;\t\t/* ...increment total */\n\t\t\t} else {\t\t\t/* existing ID... */\n\t\t\t\tcpuinfo[i].physcnt++;\t/* ...update ID cnt */\n\t\t\t}\n\n\t\t\tif (curcpu < numproc) {\n\t\t\t\tcpuinfo[curcpu].physcnt++;\n\t\t\t\tcpuinfo[curcpu].physid = val;\n\t\t\t}\n\n\t\t\tmaxphysid = MAX(maxphysid, val);\n\t\t\tminphysid = MIN(minphysid, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"core id\", &val)) {\n\t\t\t/* see if the ID has already been seen */\n\t\t\tfor (i = 0; i < numproc; i++) {\n\t\t\t\tif ((cpuinfo[i].coreid == val)\n\t\t\t\t&&  (cpuinfo[i].corecnt))\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (i == numproc) {\t\t/* new ID... */\n\t\t\t\tnumcores++;\t\t/* ...increment total */\n\t\t\t} else {\t\t\t/* existing ID... */\n\t\t\t\tcpuinfo[i].corecnt++;\t/* ...update ID cnt */\n\t\t\t}\n\n\t\t\tif (curcpu < numproc) {\n\t\t\t\tcpuinfo[curcpu].corecnt++;\n\t\t\t\tcpuinfo[curcpu].coreid = val;\n\t\t\t}\n\n\t\t\tmaxcoreid = MAX(maxcoreid, val);\n\t\t\tmincoreid = MIN(mincoreid, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"siblings\", &val)) {\n\t\t\t/* Note: this value is a count, not an index */\n\t\t    \tif (val > numproc) {\t/* out of bounds, ignore */\n\t\t\t\tdebug(\"siblings is %u (> %d), ignored\",\n\t\t\t\t\tval, numproc);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (curcpu < numproc)\n\t\t\t\tcpuinfo[curcpu].siblings = val;\n\t\t\tmaxsibs = MAX(maxsibs, val);\n\t\t\tminsibs = MIN(minsibs, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"cpu cores\", &val)) {\n\t\t\t/* Note: this value is a count, not an index */\n\t\t    \tif (val > numproc) {\t/* out of bounds, ignore */\n\t\t\t\tdebug(\"cores is %u (> %d), ignored\",\n\t\t\t\t\tval, numproc);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (curcpu < numproc)\n\t\t\t\tcpuinfo[curcpu].cores = val;\n\t\t\tmaxcores = MAX(maxcores, val);\n\t\t\tmincores = MIN(mincores, val);\n\t\t}\n\t}\n\n\tfclose(cpu_info_file);\n#endif\n\n\t/*** Sanity check ***/\n\tif (minsibs == 0) minsibs = 1;\t\t/* guaranteee non-zero */\n\tif (maxsibs == 0) {\n\t    \tminsibs = 1;\n\t    \tmaxsibs = 1;\n\t}\n\tif (maxcores == 0) {\t\t\t/* no core data */\n\t    \tmincores = 0;\n\t    \tmaxcores = 0;\n\t}\n\n\t/*** Compute Sockets/Cores/Threads ***/\n\tif ((minsibs == maxsibs) &&\t\t/* homogeneous system */\n\t    (mincores == maxcores)) {\n\t\tsockets = numphys; \t\t/* unique \"physical id\" */\n\t\tif (sockets <= 1) {\t\t/* verify single socket */\n\t\t\tsockets = numcpu / maxsibs; /* maximum \"siblings\" */\n\t\t}\n\t\tif (sockets == 0)\n\t\t\tsockets = 1;\t\t/* guarantee non-zero */\n\n\t\tcores = numcores / sockets;\t/* unique \"core id\" */\n\t\tcores = MAX(maxcores, cores);\t/* maximum \"cpu cores\" */\n\n\t\tif (cores == 0) {\n\t\t\tcores = numcpu / sockets;\t/* assume multi-core */\n\t\t\tif (cores > 1) {\n\t\t\t\tdebug3(\"Warning: cpuinfo missing 'core id' or \"\n\t\t\t\t\t\"'cpu cores' but assuming multi-core\");\n\t\t\t}\n\t\t}\n\t\tif (cores == 0)\n\t\t\tcores = 1;\t/* guarantee non-zero */\n\n\t\tthreads = numcpu / (sockets * cores); /* solve for threads */\n\t\tif (threads == 0)\n\t\t\tthreads = 1;\t/* guarantee non-zero */\n\t} else {\t\t\t\t/* heterogeneous system */\n\t\tsockets = numcpu;\n\t\tcores   = 1;\t\t\t/* one core per socket */\n\t\tthreads = 1;\t\t\t/* one core per core */\n\t}\n\n\t*p_sockets = sockets;\t\t/* update output parameters */\n\t*p_cores   = cores;\n\t*p_threads = threads;\n\n#if _DEBUG\n\t/*** Display raw data ***/\n\tdebug3(\"numcpu:     %u\", numcpu);\n\tdebug3(\"numphys:    %u\", numphys);\n\tdebug3(\"numcores:   %u\", numcores);\n\n\tdebug3(\"cores:      %u->%u\", mincores, maxcores);\n\tdebug3(\"sibs:       %u->%u\", minsibs,  maxsibs);\n\n\tdebug3(\"cpuid:      %u->%u\", mincpuid,  maxcpuid);\n\tdebug3(\"physid:     %u->%u\", minphysid, maxphysid);\n\tdebug3(\"coreid:     %u->%u\", mincoreid, maxcoreid);\n\n\tfor (i = 0; i < numproc; i++) {\n\t\tdebug3(\"CPU %d:\", i);\n\t\tdebug3(\" cpuid:    %u\", cpuinfo[i].cpuid);\n\t\tdebug3(\" seen:     %u\", cpuinfo[i].seen);\n\t\tdebug3(\" physid:   %u\", cpuinfo[i].physid);\n\t\tdebug3(\" physcnt:  %u\", cpuinfo[i].physcnt);\n\t\tdebug3(\" siblings: %u\", cpuinfo[i].siblings);\n\t\tdebug3(\" cores:    %u\", cpuinfo[i].cores);\n\t\tdebug3(\" coreid:   %u\", cpuinfo[i].coreid);\n\t\tdebug3(\" corecnt:  %u\\n\", cpuinfo[i].corecnt);\n\t}\n\n\tdebug3(\"Sockets:          %u\", sockets);\n\tdebug3(\"Cores per socket: %u\", cores);\n\tdebug3(\"Threads per core: %u\", threads);\n#endif\n\n\t*p_block_map_size = numcpu;\n\tretval = _compute_block_map(*p_block_map_size, p_block_map,\n\t\t\t\t    p_block_map_inv);\n\n\txfree(cpuinfo);\t\t/* done with raw cpuinfo data */\n\n\treturn retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"NodeName=%s \"",
            "name"
          ],
          "line": 1308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gethostname_short",
          "args": [
            "name",
            "sizeof(name)"
          ],
          "line": 1307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ClusterName=%s \"",
            "conf->cluster_name"
          ],
          "line": 1305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _print_config(void);\nstatic void      _wait_for_all_threads(int secs);\n\nstatic void\n_print_config(void)\n{\n\tint days, hours, mins, secs;\n\tchar name[128];\n\n\tif (conf->cluster_name)\n\t\tprintf(\"ClusterName=%s \", conf->cluster_name);\n\n\tgethostname_short(name, sizeof(name));\n\tprintf(\"NodeName=%s \", name);\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n\tprintf(\"CPUs=%u Boards=%u SocketsPerBoard=%u CoresPerSocket=%u \"\n\t       \"ThreadsPerCore=%u \",\n\t       conf->actual_cpus, conf->actual_boards, conf->actual_sockets,\n\t       conf->actual_cores, conf->actual_threads);\n\n\tget_memory(&conf->real_memory_size);\n\tget_tmp_disk(&conf->tmp_disk_space, \"/tmp\");\n\tprintf(\"RealMemory=%u TmpDisk=%u\\n\",\n\t       conf->real_memory_size, conf->tmp_disk_space);\n\n\tget_up_time(&conf->up_time);\n\tsecs  =  conf->up_time % 60;\n\tmins  = (conf->up_time / 60) % 60;\n\thours = (conf->up_time / 3600) % 24;\n\tdays  = (conf->up_time / 86400);\n\tprintf(\"UpTime=%u-%2.2u:%2.2u:%2.2u\\n\", days, hours, mins, secs);\n}"
  },
  {
    "function_name": "_destroy_conf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1249-1296",
    "snippet": "static void\n_destroy_conf(void)\n{\n\tif (conf) {\n\t\txfree(conf->acct_gather_energy_type);\n\t\txfree(conf->acct_gather_filesystem_type);\n\t\txfree(conf->acct_gather_infiniband_type);\n\t\txfree(conf->acct_gather_profile_type);\n\t\txfree(conf->auth_info);\n\t\txfree(conf->block_map);\n\t\txfree(conf->block_map_inv);\n\t\txfree(conf->chos_loc);\n\t\txfree(conf->cluster_name);\n\t\txfree(conf->conffile);\n\t\txfree(conf->cpu_spec_list);\n\t\txfree(conf->epilog);\n\t\txfree(conf->health_check_program);\n\t\txfree(conf->hostname);\n\t\txfree(conf->job_acct_gather_freq);\n\t\txfree(conf->job_acct_gather_type);\n\t\txfree(conf->logfile);\n\t\txfree(conf->msg_aggr_params);\n\t\txfree(conf->node_name);\n\t\txfree(conf->node_addr);\n\t\txfree(conf->node_topo_addr);\n\t\txfree(conf->node_topo_pattern);\n\t\txfree(conf->pidfile);\n\t\txfree(conf->plugstack);\n\t\txfree(conf->prolog);\n\t\txfree(conf->pubkey);\n\t\txfree(conf->select_type);\n\t\txfree(conf->spooldir);\n\t\txfree(conf->stepd_loc);\n\t\txfree(conf->task_prolog);\n\t\txfree(conf->task_epilog);\n\t\txfree(conf->tmpfs);\n\t\tslurm_mutex_destroy(&conf->config_mutex);\n\t\tFREE_NULL_LIST(conf->starting_steps);\n\t\tslurm_mutex_destroy(&conf->starting_steps_lock);\n\t\tpthread_cond_destroy(&conf->starting_steps_cond);\n\t\tFREE_NULL_LIST(conf->prolog_running_jobs);\n\t\tslurm_mutex_destroy(&conf->prolog_running_lock);\n\t\tpthread_cond_destroy(&conf->prolog_running_cond);\n\t\tslurm_cred_ctx_destroy(conf->vctx);\n\t\txfree(conf);\n\t}\n\treturn;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _destroy_conf(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "conf"
          ],
          "line": 1293
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_cred_ctx_destroy",
          "args": [
            "conf->vctx"
          ],
          "line": 1292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_cond_destroy",
          "args": [
            "&conf->prolog_running_cond"
          ],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_mutex_destroy",
          "args": [
            "&conf->prolog_running_lock"
          ],
          "line": 1290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FREE_NULL_LIST",
          "args": [
            "conf->prolog_running_jobs"
          ],
          "line": 1289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_cond_destroy",
          "args": [
            "&conf->starting_steps_cond"
          ],
          "line": 1288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_mutex_destroy",
          "args": [
            "&conf->starting_steps_lock"
          ],
          "line": 1287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FREE_NULL_LIST",
          "args": [
            "conf->starting_steps"
          ],
          "line": 1286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_mutex_destroy",
          "args": [
            "&conf->config_mutex"
          ],
          "line": 1285
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _destroy_conf(void);\n\nstatic void\n_destroy_conf(void)\n{\n\tif (conf) {\n\t\txfree(conf->acct_gather_energy_type);\n\t\txfree(conf->acct_gather_filesystem_type);\n\t\txfree(conf->acct_gather_infiniband_type);\n\t\txfree(conf->acct_gather_profile_type);\n\t\txfree(conf->auth_info);\n\t\txfree(conf->block_map);\n\t\txfree(conf->block_map_inv);\n\t\txfree(conf->chos_loc);\n\t\txfree(conf->cluster_name);\n\t\txfree(conf->conffile);\n\t\txfree(conf->cpu_spec_list);\n\t\txfree(conf->epilog);\n\t\txfree(conf->health_check_program);\n\t\txfree(conf->hostname);\n\t\txfree(conf->job_acct_gather_freq);\n\t\txfree(conf->job_acct_gather_type);\n\t\txfree(conf->logfile);\n\t\txfree(conf->msg_aggr_params);\n\t\txfree(conf->node_name);\n\t\txfree(conf->node_addr);\n\t\txfree(conf->node_topo_addr);\n\t\txfree(conf->node_topo_pattern);\n\t\txfree(conf->pidfile);\n\t\txfree(conf->plugstack);\n\t\txfree(conf->prolog);\n\t\txfree(conf->pubkey);\n\t\txfree(conf->select_type);\n\t\txfree(conf->spooldir);\n\t\txfree(conf->stepd_loc);\n\t\txfree(conf->task_prolog);\n\t\txfree(conf->task_epilog);\n\t\txfree(conf->tmpfs);\n\t\tslurm_mutex_destroy(&conf->config_mutex);\n\t\tFREE_NULL_LIST(conf->starting_steps);\n\t\tslurm_mutex_destroy(&conf->starting_steps_lock);\n\t\tpthread_cond_destroy(&conf->starting_steps_cond);\n\t\tFREE_NULL_LIST(conf->prolog_running_jobs);\n\t\tslurm_mutex_destroy(&conf->prolog_running_lock);\n\t\tpthread_cond_destroy(&conf->prolog_running_cond);\n\t\tslurm_cred_ctx_destroy(conf->vctx);\n\t\txfree(conf);\n\t}\n\treturn;\n}"
  },
  {
    "function_name": "_init_conf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1220-1247",
    "snippet": "static void\n_init_conf(void)\n{\n\tchar  host[MAXHOSTNAMELEN];\n\tlog_options_t lopts = LOG_OPTS_INITIALIZER;\n\n\tif (gethostname_short(host, MAXHOSTNAMELEN) < 0) {\n\t\terror(\"Unable to get my hostname: %m\");\n\t\texit(1);\n\t}\n\tconf->hostname    = xstrdup(host);\n\tconf->daemonize   =  1;\n\tconf->lfd         = -1;\n\tconf->log_opts    = lopts;\n\tconf->debug_level = LOG_LEVEL_INFO;\n\tconf->pidfile     = xstrdup(DEFAULT_SLURMD_PIDFILE);\n\tconf->spooldir\t  = xstrdup(DEFAULT_SPOOLDIR);\n\n\tslurm_mutex_init(&conf->config_mutex);\n\n\tconf->starting_steps = list_create(destroy_starting_step);\n\tslurm_mutex_init(&conf->starting_steps_lock);\n\tpthread_cond_init(&conf->starting_steps_cond, NULL);\n\tconf->prolog_running_jobs = list_create(slurm_destroy_uint32_ptr);\n\tslurm_mutex_init(&conf->prolog_running_lock);\n\tpthread_cond_init(&conf->prolog_running_cond, NULL);\n\treturn;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _init_conf(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_cond_init",
          "args": [
            "&conf->prolog_running_cond",
            "NULL"
          ],
          "line": 1245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_mutex_init",
          "args": [
            "&conf->prolog_running_lock"
          ],
          "line": 1244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_create",
          "args": [
            "slurm_destroy_uint32_ptr"
          ],
          "line": 1243
        },
        "resolved": true,
        "details": {
          "function_name": "_script_list_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "178-210",
          "snippet": "static List _script_list_create (const char *pattern)\n{\n\tglob_t gl;\n\tsize_t i;\n\tList l = NULL;\n\n\tif (pattern == NULL)\n\t\treturn (NULL);\n\n\tint rc = glob (pattern, GLOB_ERR, _ef, &gl);\n\tswitch (rc) {\n\tcase 0:\n\t\tl = list_create ((ListDelF) _xfree_f);\n\t\tfor (i = 0; i < gl.gl_pathc; i++)\n\t\t\tlist_push (l, xstrdup (gl.gl_pathv[i]));\n\t\tbreak;\n\tcase GLOB_NOMATCH:\n\t\tbreak;\n\tcase GLOB_NOSPACE:\n\t\terror (\"run_script: glob(3): Out of memory\");\n\t\tbreak;\n\tcase GLOB_ABORTED:\n\t\terror (\"run_script: cannot read dir %s: %m\", pattern);\n\t\tbreak;\n\tdefault:\n\t\terror (\"Unknown glob(3) return code = %d\", rc);\n\t\tbreak;\n\t}\n\n\tglobfree (&gl);\n\n\treturn l;\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic List _script_list_create (const char *pattern)\n{\n\tglob_t gl;\n\tsize_t i;\n\tList l = NULL;\n\n\tif (pattern == NULL)\n\t\treturn (NULL);\n\n\tint rc = glob (pattern, GLOB_ERR, _ef, &gl);\n\tswitch (rc) {\n\tcase 0:\n\t\tl = list_create ((ListDelF) _xfree_f);\n\t\tfor (i = 0; i < gl.gl_pathc; i++)\n\t\t\tlist_push (l, xstrdup (gl.gl_pathv[i]));\n\t\tbreak;\n\tcase GLOB_NOMATCH:\n\t\tbreak;\n\tcase GLOB_NOSPACE:\n\t\terror (\"run_script: glob(3): Out of memory\");\n\t\tbreak;\n\tcase GLOB_ABORTED:\n\t\terror (\"run_script: cannot read dir %s: %m\", pattern);\n\t\tbreak;\n\tdefault:\n\t\terror (\"Unknown glob(3) return code = %d\", rc);\n\t\tbreak;\n\t}\n\n\tglobfree (&gl);\n\n\treturn l;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_cond_init",
          "args": [
            "&conf->starting_steps_cond",
            "NULL"
          ],
          "line": 1242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_mutex_init",
          "args": [
            "&conf->starting_steps_lock"
          ],
          "line": 1241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_mutex_init",
          "args": [
            "&conf->config_mutex"
          ],
          "line": 1238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "DEFAULT_SPOOLDIR"
          ],
          "line": 1236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "DEFAULT_SLURMD_PIDFILE"
          ],
          "line": 1235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "host"
          ],
          "line": 1230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 1228
        },
        "resolved": true,
        "details": {
          "function_name": "_send_pending_exit_msgs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/mgr.c",
          "lines": "1890-1927",
          "snippet": "static int\n_send_pending_exit_msgs(stepd_step_rec_t *job)\n{\n\tint  i;\n\tint  nsent  = 0;\n\tint  status = 0;\n\tbool set    = false;\n\tuint32_t *tid;\n\n\t/*\n\t * Collect all exit codes with the same status into a\n\t * single message.\n\t */\n\ttid = xmalloc(sizeof(uint32_t) * job->node_tasks);\n\tfor (i = 0; i < job->node_tasks; i++) {\n\t\tstepd_step_task_info_t *t = job->task[i];\n\n\t\tif (!t->exited || t->esent)\n\t\t\tcontinue;\n\n\t\tif (!set) {\n\t\t\tstatus = t->estatus;\n\t\t\tset    = true;\n\t\t} else if (status != t->estatus)\n\t\t\tcontinue;\n\n\t\ttid[nsent++] = t->gtid;\n\t\tt->esent = true;\n\t}\n\n\tif (nsent) {\n\t\tdebug2(\"Aggregated %d task exit messages\", nsent);\n\t\t_send_exit_msg(job, tid, nsent, status);\n\t}\n\txfree(tid);\n\n\treturn nsent;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/ulimits.h\"",
            "#include \"src/slurmd/slurmstepd/pam_ses.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmstepd/task.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/reverse_tree.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/slurm_mpi.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/safeopen.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#    include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <pthread.h>",
            "#include <poll.h>",
            "#include <grp.h>",
            "#  include \"src/common/unsetenv.h\"",
            "#  include <sys/checkpnt.h>",
            "#  include <sys/prctl.h>",
            "#  include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void  _set_prio_process (stepd_step_rec_t *job);",
            "static void _set_job_log_prefix(stepd_step_rec_t *job);",
            "static int  _setup_normal_io(stepd_step_rec_t *job);",
            "static int  _slurmd_job_log_init(stepd_step_rec_t *job);",
            "static void _wait_for_io(stepd_step_rec_t *job);",
            "static int  _send_exit_msg(stepd_step_rec_t *job, uint32_t *tid, int n,\n\t\t\t   int status);",
            "static void _wait_for_children_slurmstepd(stepd_step_rec_t *job);",
            "static int  _send_pending_exit_msgs(stepd_step_rec_t *job);",
            "static void _send_step_complete_msgs(stepd_step_rec_t *job);",
            "static void _wait_for_all_tasks(stepd_step_rec_t *job);",
            "static void _setargs(stepd_step_rec_t *job);",
            "static void _random_sleep(stepd_step_rec_t *job);",
            "static char * _make_batch_dir(stepd_step_rec_t *job);",
            "static int    _send_complete_batch_script_msg(stepd_step_rec_t *job,\n\t\t\t\t\t      int err, int status);",
            "static int _initgroups(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/ulimits.h\"\n#include \"src/slurmd/slurmstepd/pam_ses.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmstepd/task.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/reverse_tree.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/slurm_mpi.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/safeopen.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/cbuf.h\"\n#include \"slurm/slurm_errno.h\"\n#    include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <string.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <pthread.h>\n#include <poll.h>\n#include <grp.h>\n#  include \"src/common/unsetenv.h\"\n#  include <sys/checkpnt.h>\n#  include <sys/prctl.h>\n#  include <sys/types.h>\n#  include \"config.h\"\n\nstatic void  _set_prio_process (stepd_step_rec_t *job);\nstatic void _set_job_log_prefix(stepd_step_rec_t *job);\nstatic int  _setup_normal_io(stepd_step_rec_t *job);\nstatic int  _slurmd_job_log_init(stepd_step_rec_t *job);\nstatic void _wait_for_io(stepd_step_rec_t *job);\nstatic int  _send_exit_msg(stepd_step_rec_t *job, uint32_t *tid, int n,\n\t\t\t   int status);\nstatic void _wait_for_children_slurmstepd(stepd_step_rec_t *job);\nstatic int  _send_pending_exit_msgs(stepd_step_rec_t *job);\nstatic void _send_step_complete_msgs(stepd_step_rec_t *job);\nstatic void _wait_for_all_tasks(stepd_step_rec_t *job);\nstatic void _setargs(stepd_step_rec_t *job);\nstatic void _random_sleep(stepd_step_rec_t *job);\nstatic char * _make_batch_dir(stepd_step_rec_t *job);\nstatic int    _send_complete_batch_script_msg(stepd_step_rec_t *job,\n\t\t\t\t\t      int err, int status);\nstatic int _initgroups(stepd_step_rec_t *job);\n\nstatic int\n_send_pending_exit_msgs(stepd_step_rec_t *job)\n{\n\tint  i;\n\tint  nsent  = 0;\n\tint  status = 0;\n\tbool set    = false;\n\tuint32_t *tid;\n\n\t/*\n\t * Collect all exit codes with the same status into a\n\t * single message.\n\t */\n\ttid = xmalloc(sizeof(uint32_t) * job->node_tasks);\n\tfor (i = 0; i < job->node_tasks; i++) {\n\t\tstepd_step_task_info_t *t = job->task[i];\n\n\t\tif (!t->exited || t->esent)\n\t\t\tcontinue;\n\n\t\tif (!set) {\n\t\t\tstatus = t->estatus;\n\t\t\tset    = true;\n\t\t} else if (status != t->estatus)\n\t\t\tcontinue;\n\n\t\ttid[nsent++] = t->gtid;\n\t\tt->esent = true;\n\t}\n\n\tif (nsent) {\n\t\tdebug2(\"Aggregated %d task exit messages\", nsent);\n\t\t_send_exit_msg(job, tid, nsent, status);\n\t}\n\txfree(tid);\n\n\treturn nsent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Unable to get my hostname: %m\""
          ],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gethostname_short",
          "args": [
            "host",
            "MAXHOSTNAMELEN"
          ],
          "line": 1226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _init_conf(void);\n\nstatic void\n_init_conf(void)\n{\n\tchar  host[MAXHOSTNAMELEN];\n\tlog_options_t lopts = LOG_OPTS_INITIALIZER;\n\n\tif (gethostname_short(host, MAXHOSTNAMELEN) < 0) {\n\t\terror(\"Unable to get my hostname: %m\");\n\t\texit(1);\n\t}\n\tconf->hostname    = xstrdup(host);\n\tconf->daemonize   =  1;\n\tconf->lfd         = -1;\n\tconf->log_opts    = lopts;\n\tconf->debug_level = LOG_LEVEL_INFO;\n\tconf->pidfile     = xstrdup(DEFAULT_SLURMD_PIDFILE);\n\tconf->spooldir\t  = xstrdup(DEFAULT_SPOOLDIR);\n\n\tslurm_mutex_init(&conf->config_mutex);\n\n\tconf->starting_steps = list_create(destroy_starting_step);\n\tslurm_mutex_init(&conf->starting_steps_lock);\n\tpthread_cond_init(&conf->starting_steps_cond, NULL);\n\tconf->prolog_running_jobs = list_create(slurm_destroy_uint32_ptr);\n\tslurm_mutex_init(&conf->prolog_running_lock);\n\tpthread_cond_init(&conf->prolog_running_cond, NULL);\n\treturn;\n}"
  },
  {
    "function_name": "_print_conf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1139-1216",
    "snippet": "static void\n_print_conf(void)\n{\n\tslurm_ctl_conf_t *cf;\n\tchar *str, time_str[32];\n\tint i;\n\n\tcf = slurm_conf_lock();\n\tdebug3(\"NodeName    = %s\",       conf->node_name);\n\tdebug3(\"TopoAddr    = %s\",       conf->node_topo_addr);\n\tdebug3(\"TopoPattern = %s\",       conf->node_topo_pattern);\n\tdebug3(\"ClusterName = %s\",       conf->cluster_name);\n\tdebug3(\"Confile     = `%s'\",     conf->conffile);\n\tdebug3(\"Debug       = %d\",       cf->slurmd_debug);\n\tdebug3(\"CPUs        = %-2u (CF: %2u, HW: %2u)\",\n\t       conf->cpus,\n\t       conf->conf_cpus,\n\t       conf->actual_cpus);\n\tdebug3(\"Boards      = %-2u (CF: %2u, HW: %2u)\",\n\t       conf->boards,\n\t       conf->conf_boards,\n\t       conf->actual_boards);\n\tdebug3(\"Sockets     = %-2u (CF: %2u, HW: %2u)\",\n\t       conf->sockets,\n\t       conf->conf_sockets,\n\t       conf->actual_sockets);\n\tdebug3(\"Cores       = %-2u (CF: %2u, HW: %2u)\",\n\t       conf->cores,\n\t       conf->conf_cores,\n\t       conf->actual_cores);\n\tdebug3(\"Threads     = %-2u (CF: %2u, HW: %2u)\",\n\t       conf->threads,\n\t       conf->conf_threads,\n\t       conf->actual_threads);\n\n\tsecs2time_str((time_t)conf->up_time, time_str, sizeof(time_str));\n\tdebug3(\"UpTime      = %u = %s\", conf->up_time, time_str);\n\n\tstr = xmalloc(conf->block_map_size*5);\n\tstr[0] = '\\0';\n\tfor (i = 0; i < conf->block_map_size; i++) {\n\t\tchar id[10];\n\t\tsprintf(id, \"%u,\", conf->block_map[i]);\n\t\tstrcat(str, id);\n\t}\n\tstr[strlen(str)-1] = '\\0';\t\t/* trim trailing \",\" */\n\tdebug3(\"Block Map   = %s\", str);\n\tstr[0] = '\\0';\n\tfor (i = 0; i < conf->block_map_size; i++) {\n\t\tchar id[10];\n\t\tsprintf(id, \"%u,\", conf->block_map_inv[i]);\n\t\tstrcat(str, id);\n\t}\n\tstr[strlen(str)-1] = '\\0';\t\t/* trim trailing \",\" */\n\tdebug3(\"Inverse Map = %s\", str);\n\txfree(str);\n\tdebug3(\"RealMemory  = %u\",       conf->real_memory_size);\n\tdebug3(\"TmpDisk     = %u\",       conf->tmp_disk_space);\n\tdebug3(\"Epilog      = `%s'\",     conf->epilog);\n\tdebug3(\"Logfile     = `%s'\",     cf->slurmd_logfile);\n\tdebug3(\"HealthCheck = `%s'\",     conf->health_check_program);\n\tdebug3(\"NodeName    = %s\",       conf->node_name);\n\tdebug3(\"NodeAddr    = %s\",       conf->node_addr);\n\tdebug3(\"Port        = %u\",       conf->port);\n\tdebug3(\"Prolog      = `%s'\",     conf->prolog);\n\tdebug3(\"TmpFS       = `%s'\",     conf->tmpfs);\n\tdebug3(\"Public Cert = `%s'\",     conf->pubkey);\n\tdebug3(\"ChosLoc     = `%s'\",     conf->chos_loc);\n\tdebug3(\"Slurmstepd  = `%s'\",     conf->stepd_loc);\n\tdebug3(\"Spool Dir   = `%s'\",     conf->spooldir);\n\tdebug3(\"Pid File    = `%s'\",     conf->pidfile);\n\tdebug3(\"Slurm UID   = %u\",       conf->slurm_user_id);\n\tdebug3(\"TaskProlog  = `%s'\",     conf->task_prolog);\n\tdebug3(\"TaskEpilog  = `%s'\",     conf->task_epilog);\n\tdebug3(\"TaskPluginParam = %u\",   conf->task_plugin_param);\n\tdebug3(\"Use PAM     = %u\",       conf->use_pam);\n\tslurm_conf_unlock();\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _print_conf(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "slurm_conf_unlock",
          "args": [],
          "line": 1215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Use PAM     = %u\"",
            "conf->use_pam"
          ],
          "line": 1214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"TaskPluginParam = %u\"",
            "conf->task_plugin_param"
          ],
          "line": 1213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"TaskEpilog  = `%s'\"",
            "conf->task_epilog"
          ],
          "line": 1212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"TaskProlog  = `%s'\"",
            "conf->task_prolog"
          ],
          "line": 1211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Slurm UID   = %u\"",
            "conf->slurm_user_id"
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Pid File    = `%s'\"",
            "conf->pidfile"
          ],
          "line": 1209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Spool Dir   = `%s'\"",
            "conf->spooldir"
          ],
          "line": 1208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Slurmstepd  = `%s'\"",
            "conf->stepd_loc"
          ],
          "line": 1207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"ChosLoc     = `%s'\"",
            "conf->chos_loc"
          ],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Public Cert = `%s'\"",
            "conf->pubkey"
          ],
          "line": 1205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"TmpFS       = `%s'\"",
            "conf->tmpfs"
          ],
          "line": 1204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Prolog      = `%s'\"",
            "conf->prolog"
          ],
          "line": 1203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Port        = %u\"",
            "conf->port"
          ],
          "line": 1202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"NodeAddr    = %s\"",
            "conf->node_addr"
          ],
          "line": 1201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"NodeName    = %s\"",
            "conf->node_name"
          ],
          "line": 1200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"HealthCheck = `%s'\"",
            "conf->health_check_program"
          ],
          "line": 1199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Logfile     = `%s'\"",
            "cf->slurmd_logfile"
          ],
          "line": 1198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Epilog      = `%s'\"",
            "conf->epilog"
          ],
          "line": 1197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"TmpDisk     = %u\"",
            "conf->tmp_disk_space"
          ],
          "line": 1196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"RealMemory  = %u\"",
            "conf->real_memory_size"
          ],
          "line": 1195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "str"
          ],
          "line": 1194
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Inverse Map = %s\"",
            "str"
          ],
          "line": 1193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 1192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "str",
            "id"
          ],
          "line": 1190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "id",
            "\"%u,\"",
            "conf->block_map_inv[i]"
          ],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Block Map   = %s\"",
            "str"
          ],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 1184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "str",
            "id"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "id",
            "\"%u,\"",
            "conf->block_map[i]"
          ],
          "line": 1181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "conf->block_map_size*5"
          ],
          "line": 1177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"UpTime      = %u = %s\"",
            "conf->up_time",
            "time_str"
          ],
          "line": 1175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "secs2time_str",
          "args": [
            "(time_t)conf->up_time",
            "time_str",
            "sizeof(time_str)"
          ],
          "line": 1174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Threads     = %-2u (CF: %2u, HW: %2u)\"",
            "conf->threads",
            "conf->conf_threads",
            "conf->actual_threads"
          ],
          "line": 1169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Cores       = %-2u (CF: %2u, HW: %2u)\"",
            "conf->cores",
            "conf->conf_cores",
            "conf->actual_cores"
          ],
          "line": 1165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Sockets     = %-2u (CF: %2u, HW: %2u)\"",
            "conf->sockets",
            "conf->conf_sockets",
            "conf->actual_sockets"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Boards      = %-2u (CF: %2u, HW: %2u)\"",
            "conf->boards",
            "conf->conf_boards",
            "conf->actual_boards"
          ],
          "line": 1157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"CPUs        = %-2u (CF: %2u, HW: %2u)\"",
            "conf->cpus",
            "conf->conf_cpus",
            "conf->actual_cpus"
          ],
          "line": 1153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Debug       = %d\"",
            "cf->slurmd_debug"
          ],
          "line": 1152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Confile     = `%s'\"",
            "conf->conffile"
          ],
          "line": 1151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"ClusterName = %s\"",
            "conf->cluster_name"
          ],
          "line": 1150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"TopoPattern = %s\"",
            "conf->node_topo_pattern"
          ],
          "line": 1149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"TopoAddr    = %s\"",
            "conf->node_topo_addr"
          ],
          "line": 1148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"NodeName    = %s\"",
            "conf->node_name"
          ],
          "line": 1147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_conf_lock",
          "args": [],
          "line": 1146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _print_conf(void);\n\nstatic void\n_print_conf(void)\n{\n\tslurm_ctl_conf_t *cf;\n\tchar *str, time_str[32];\n\tint i;\n\n\tcf = slurm_conf_lock();\n\tdebug3(\"NodeName    = %s\",       conf->node_name);\n\tdebug3(\"TopoAddr    = %s\",       conf->node_topo_addr);\n\tdebug3(\"TopoPattern = %s\",       conf->node_topo_pattern);\n\tdebug3(\"ClusterName = %s\",       conf->cluster_name);\n\tdebug3(\"Confile     = `%s'\",     conf->conffile);\n\tdebug3(\"Debug       = %d\",       cf->slurmd_debug);\n\tdebug3(\"CPUs        = %-2u (CF: %2u, HW: %2u)\",\n\t       conf->cpus,\n\t       conf->conf_cpus,\n\t       conf->actual_cpus);\n\tdebug3(\"Boards      = %-2u (CF: %2u, HW: %2u)\",\n\t       conf->boards,\n\t       conf->conf_boards,\n\t       conf->actual_boards);\n\tdebug3(\"Sockets     = %-2u (CF: %2u, HW: %2u)\",\n\t       conf->sockets,\n\t       conf->conf_sockets,\n\t       conf->actual_sockets);\n\tdebug3(\"Cores       = %-2u (CF: %2u, HW: %2u)\",\n\t       conf->cores,\n\t       conf->conf_cores,\n\t       conf->actual_cores);\n\tdebug3(\"Threads     = %-2u (CF: %2u, HW: %2u)\",\n\t       conf->threads,\n\t       conf->conf_threads,\n\t       conf->actual_threads);\n\n\tsecs2time_str((time_t)conf->up_time, time_str, sizeof(time_str));\n\tdebug3(\"UpTime      = %u = %s\", conf->up_time, time_str);\n\n\tstr = xmalloc(conf->block_map_size*5);\n\tstr[0] = '\\0';\n\tfor (i = 0; i < conf->block_map_size; i++) {\n\t\tchar id[10];\n\t\tsprintf(id, \"%u,\", conf->block_map[i]);\n\t\tstrcat(str, id);\n\t}\n\tstr[strlen(str)-1] = '\\0';\t\t/* trim trailing \",\" */\n\tdebug3(\"Block Map   = %s\", str);\n\tstr[0] = '\\0';\n\tfor (i = 0; i < conf->block_map_size; i++) {\n\t\tchar id[10];\n\t\tsprintf(id, \"%u,\", conf->block_map_inv[i]);\n\t\tstrcat(str, id);\n\t}\n\tstr[strlen(str)-1] = '\\0';\t\t/* trim trailing \",\" */\n\tdebug3(\"Inverse Map = %s\", str);\n\txfree(str);\n\tdebug3(\"RealMemory  = %u\",       conf->real_memory_size);\n\tdebug3(\"TmpDisk     = %u\",       conf->tmp_disk_space);\n\tdebug3(\"Epilog      = `%s'\",     conf->epilog);\n\tdebug3(\"Logfile     = `%s'\",     cf->slurmd_logfile);\n\tdebug3(\"HealthCheck = `%s'\",     conf->health_check_program);\n\tdebug3(\"NodeName    = %s\",       conf->node_name);\n\tdebug3(\"NodeAddr    = %s\",       conf->node_addr);\n\tdebug3(\"Port        = %u\",       conf->port);\n\tdebug3(\"Prolog      = `%s'\",     conf->prolog);\n\tdebug3(\"TmpFS       = `%s'\",     conf->tmpfs);\n\tdebug3(\"Public Cert = `%s'\",     conf->pubkey);\n\tdebug3(\"ChosLoc     = `%s'\",     conf->chos_loc);\n\tdebug3(\"Slurmstepd  = `%s'\",     conf->stepd_loc);\n\tdebug3(\"Spool Dir   = `%s'\",     conf->spooldir);\n\tdebug3(\"Pid File    = `%s'\",     conf->pidfile);\n\tdebug3(\"Slurm UID   = %u\",       conf->slurm_user_id);\n\tdebug3(\"TaskProlog  = `%s'\",     conf->task_prolog);\n\tdebug3(\"TaskEpilog  = `%s'\",     conf->task_epilog);\n\tdebug3(\"TaskPluginParam = %u\",   conf->task_plugin_param);\n\tdebug3(\"Use PAM     = %u\",       conf->use_pam);\n\tslurm_conf_unlock();\n}"
  },
  {
    "function_name": "_reconfigure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "1052-1137",
    "snippet": "static void\n_reconfigure(void)\n{\n\tList steps;\n\tListIterator i;\n\tstep_loc_t *stepd;\n\tbool did_change;\n\n\t_reconfig = 0;\n\tslurm_conf_reinit(conf->conffile);\n\t_read_config();\n\n\t/*\n\t * Rebuild topology information and refresh slurmd topo infos\n\t */\n\tslurm_topo_build_config();\n\t_set_topo_info();\n\troute_g_reconfigure();\n\tcpu_freq_reconfig();\n\n\tmsg_aggr_sender_reconfig(conf->msg_aggr_window_time,\n\t\t\t\t conf->msg_aggr_window_msgs);\n\n\t/*\n\t * In case the administrator changed the cpu frequency set capabilities\n\t * on this node, rebuild the cpu frequency table information\n\t */\n\tcpu_freq_init(conf);\n\n\t/*\n\t * If configured, apply resource specialization\n\t */\n\t_resource_spec_init();\n\n\t_print_conf();\n\n\t/*\n\t * Make best effort at changing to new public key\n\t */\n\tslurm_cred_ctx_key_update(conf->vctx, conf->pubkey);\n\n\t/*\n\t * Purge the username -> grouplist cache.\n\t */\n\tgids_cache_purge();\n\n\t/* send reconfig to each stepd so they can refresh their log\n\t * file handle\n\t */\n\n\tsteps = stepd_available(conf->spooldir, conf->node_name);\n\ti = list_iterator_create(steps);\n\twhile ((stepd = list_next(i))) {\n\t\tint fd;\n\t\tfd = stepd_connect(stepd->directory, stepd->nodename,\n\t\t\t\t   stepd->jobid, stepd->stepid,\n\t\t\t\t   &stepd->protocol_version);\n\t\tif (fd == -1)\n\t\t\tcontinue;\n\n\t\tif (stepd_reconfig(fd, stepd->protocol_version)\n\t\t    != SLURM_SUCCESS)\n\t\t\tdebug(\"Reconfig jobid=%u.%u failed: %m\",\n\t\t\t      stepd->jobid, stepd->stepid);\n\t\tclose(fd);\n\t}\n\tlist_iterator_destroy(i);\n\tFREE_NULL_LIST(steps);\n\n\tgres_plugin_reconfig(&did_change);\n\t(void) switch_g_reconfig();\n\tcontainer_g_reconfig();\n\tif (did_change) {\n\t\tuint32_t cpu_cnt = MAX(conf->conf_cpus, conf->block_map_size);\n\t\t(void) gres_plugin_node_config_load(cpu_cnt, conf->node_name,\n\t\t\t\t\t\t    NULL);\n\t\tsend_registration_msg(SLURM_SUCCESS, false);\n\t}\n\n\t/* reconfigure energy */\n\tacct_gather_energy_g_set_data(ENERGY_DATA_RECONFIG, NULL);\n\n\t/*\n\t * XXX: reopen slurmd port?\n\t */\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static sig_atomic_t _reconfig = 0;",
      "static void      _print_conf(void);",
      "static void      _read_config(void);",
      "static void      _reconfigure(void);",
      "static int       _resource_spec_init(void);",
      "static int       _set_topo_info(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "acct_gather_energy_g_set_data",
          "args": [
            "ENERGY_DATA_RECONFIG",
            "NULL"
          ],
          "line": 1132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "send_registration_msg",
          "args": [
            "SLURM_SUCCESS",
            "false"
          ],
          "line": 1128
        },
        "resolved": true,
        "details": {
          "function_name": "send_registration_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "619-655",
          "snippet": "extern int\nsend_registration_msg(uint32_t status, bool startup)\n{\n\tint rc, ret_val = SLURM_SUCCESS;\n\tslurm_node_registration_status_msg_t *msg =\n\t\txmalloc (sizeof (slurm_node_registration_status_msg_t));\n\n\tmsg->startup = (uint16_t) startup;\n\t_fill_registration_msg(msg);\n\tmsg->status  = status;\n\n\tif (conf->msg_aggr_window_msgs > 1) {\n\t\tslurm_msg_t *req = xmalloc_nz(sizeof(slurm_msg_t));\n\n\t\tslurm_msg_t_init(req);\n\t\treq->msg_type = MESSAGE_NODE_REGISTRATION_STATUS;\n\t\treq->data     = msg;\n\n\t\tmsg_aggr_add_msg(req, 1, NULL);\n\t} else {\n\t\tslurm_msg_t req;\n\t\tslurm_msg_t_init(&req);\n\t\treq.msg_type = MESSAGE_NODE_REGISTRATION_STATUS;\n\t\treq.data     = msg;\n\n\t\tif (slurm_send_recv_controller_rc_msg(&req, &rc) < 0) {\n\t\t\terror(\"Unable to register: %m\");\n\t\t\tret_val = SLURM_FAILURE;\n\t\t}\n\t\tslurm_free_node_registration_status_msg(msg);\n\t}\n\n\tif (ret_val == SLURM_SUCCESS)\n\t\tsent_reg_time = time(NULL);\n\n\treturn ret_val;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static time_t sent_reg_time = (time_t) 0;",
            "static void      _fill_registration_msg(slurm_node_registration_status_msg_t *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic time_t sent_reg_time = (time_t) 0;\nstatic void      _fill_registration_msg(slurm_node_registration_status_msg_t *);\n\nextern int\nsend_registration_msg(uint32_t status, bool startup)\n{\n\tint rc, ret_val = SLURM_SUCCESS;\n\tslurm_node_registration_status_msg_t *msg =\n\t\txmalloc (sizeof (slurm_node_registration_status_msg_t));\n\n\tmsg->startup = (uint16_t) startup;\n\t_fill_registration_msg(msg);\n\tmsg->status  = status;\n\n\tif (conf->msg_aggr_window_msgs > 1) {\n\t\tslurm_msg_t *req = xmalloc_nz(sizeof(slurm_msg_t));\n\n\t\tslurm_msg_t_init(req);\n\t\treq->msg_type = MESSAGE_NODE_REGISTRATION_STATUS;\n\t\treq->data     = msg;\n\n\t\tmsg_aggr_add_msg(req, 1, NULL);\n\t} else {\n\t\tslurm_msg_t req;\n\t\tslurm_msg_t_init(&req);\n\t\treq.msg_type = MESSAGE_NODE_REGISTRATION_STATUS;\n\t\treq.data     = msg;\n\n\t\tif (slurm_send_recv_controller_rc_msg(&req, &rc) < 0) {\n\t\t\terror(\"Unable to register: %m\");\n\t\t\tret_val = SLURM_FAILURE;\n\t\t}\n\t\tslurm_free_node_registration_status_msg(msg);\n\t}\n\n\tif (ret_val == SLURM_SUCCESS)\n\t\tsent_reg_time = time(NULL);\n\n\treturn ret_val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gres_plugin_node_config_load",
          "args": [
            "cpu_cnt",
            "conf->node_name",
            "NULL"
          ],
          "line": 1126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAX",
          "args": [
            "conf->conf_cpus",
            "conf->block_map_size"
          ],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_g_reconfig",
          "args": [],
          "line": 1123
        },
        "resolved": true,
        "details": {
          "function_name": "container_g_reconfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/job_container_plugin.c",
          "lines": "261-272",
          "snippet": "extern void container_g_reconfig(void)\n{\n\tint i;\n\n\t(void) job_container_init();\n\n\tfor (i = 0; i < g_container_context_num;i++) {\n\t\t(*(ops[i].container_p_reconfig))();\n\t}\n\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/plugin.h\"",
            "#include <pthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static job_container_ops_t\t*ops = NULL;",
            "static int\t\t\tg_container_context_num = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/plugin.h\"\n#include <pthread.h>\n\nstatic job_container_ops_t\t*ops = NULL;\nstatic int\t\t\tg_container_context_num = -1;\n\nextern void container_g_reconfig(void)\n{\n\tint i;\n\n\t(void) job_container_init();\n\n\tfor (i = 0; i < g_container_context_num;i++) {\n\t\t(*(ops[i].container_p_reconfig))();\n\t}\n\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "switch_g_reconfig",
          "args": [],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gres_plugin_reconfig",
          "args": [
            "&did_change"
          ],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FREE_NULL_LIST",
          "args": [
            "steps"
          ],
          "line": 1119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_iterator_destroy",
          "args": [
            "i"
          ],
          "line": 1118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 1116
        },
        "resolved": true,
        "details": {
          "function_name": "_file_bcast_close_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "3635-3640",
          "snippet": "static void _file_bcast_close_file(file_bcast_info_t *key)\n{\n\t_fb_wrlock();\n\tlist_delete_all(file_bcast_list, _bcast_find_in_list, key);\n\t_fb_wrunlock();\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int  _job_limits_match(void *x, void *key);",
            "static int  _step_limits_match(void *x, void *key);",
            "static int  _file_bcast_register_file(slurm_msg_t *msg,\n\t\t\t\t      file_bcast_info_t *key);",
            "static List file_bcast_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic int  _job_limits_match(void *x, void *key);\nstatic int  _step_limits_match(void *x, void *key);\nstatic int  _file_bcast_register_file(slurm_msg_t *msg,\n\t\t\t\t      file_bcast_info_t *key);\nstatic List file_bcast_list = NULL;\n\nstatic void _file_bcast_close_file(file_bcast_info_t *key)\n{\n\t_fb_wrlock();\n\tlist_delete_all(file_bcast_list, _bcast_find_in_list, key);\n\t_fb_wrunlock();\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"Reconfig jobid=%u.%u failed: %m\"",
            "stepd->jobid",
            "stepd->stepid"
          ],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stepd_reconfig",
          "args": [
            "fd",
            "stepd->protocol_version"
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stepd_connect",
          "args": [
            "stepd->directory",
            "stepd->nodename",
            "stepd->jobid",
            "stepd->stepid",
            "&stepd->protocol_version"
          ],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_next",
          "args": [
            "i"
          ],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_iterator_create",
          "args": [
            "steps"
          ],
          "line": 1103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stepd_available",
          "args": [
            "conf->spooldir",
            "conf->node_name"
          ],
          "line": 1102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gids_cache_purge",
          "args": [],
          "line": 1096
        },
        "resolved": true,
        "details": {
          "function_name": "gids_cache_purge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "5895-5912",
          "snippet": "void\ngids_cache_purge(void)\n{\n\tint i;\n\tgids_cache_t *p, *q;\n\n\tslurm_mutex_lock(&gids_mutex);\n\tfor (i=0; i<GIDS_HASH_LEN; i++) {\n\t\tp = gids_hashtbl[i];\n\t\twhile (p) {\n\t\t\tq = p->next;\n\t\t\t_dealloc_gids_cache(p);\n\t\t\tp = q;\n\t\t}\n\t\tgids_hashtbl[i] = NULL;\n\t}\n\tslurm_mutex_unlock(&gids_mutex);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [
            "#define GIDS_HASH_LEN 64"
          ],
          "globals_used": [
            "static void _dealloc_gids(gids_t *p);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\n#define GIDS_HASH_LEN 64\n\nstatic void _dealloc_gids(gids_t *p);\n\nvoid\ngids_cache_purge(void)\n{\n\tint i;\n\tgids_cache_t *p, *q;\n\n\tslurm_mutex_lock(&gids_mutex);\n\tfor (i=0; i<GIDS_HASH_LEN; i++) {\n\t\tp = gids_hashtbl[i];\n\t\twhile (p) {\n\t\t\tq = p->next;\n\t\t\t_dealloc_gids_cache(p);\n\t\t\tp = q;\n\t\t}\n\t\tgids_hashtbl[i] = NULL;\n\t}\n\tslurm_mutex_unlock(&gids_mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_cred_ctx_key_update",
          "args": [
            "conf->vctx",
            "conf->pubkey"
          ],
          "line": 1091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_print_conf",
          "args": [],
          "line": 1086
        },
        "resolved": true,
        "details": {
          "function_name": "_print_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1298-1333",
          "snippet": "static void\n_print_config(void)\n{\n\tint days, hours, mins, secs;\n\tchar name[128];\n\n\tif (conf->cluster_name)\n\t\tprintf(\"ClusterName=%s \", conf->cluster_name);\n\n\tgethostname_short(name, sizeof(name));\n\tprintf(\"NodeName=%s \", name);\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n\tprintf(\"CPUs=%u Boards=%u SocketsPerBoard=%u CoresPerSocket=%u \"\n\t       \"ThreadsPerCore=%u \",\n\t       conf->actual_cpus, conf->actual_boards, conf->actual_sockets,\n\t       conf->actual_cores, conf->actual_threads);\n\n\tget_memory(&conf->real_memory_size);\n\tget_tmp_disk(&conf->tmp_disk_space, \"/tmp\");\n\tprintf(\"RealMemory=%u TmpDisk=%u\\n\",\n\t       conf->real_memory_size, conf->tmp_disk_space);\n\n\tget_up_time(&conf->up_time);\n\tsecs  =  conf->up_time % 60;\n\tmins  = (conf->up_time / 60) % 60;\n\thours = (conf->up_time / 3600) % 24;\n\tdays  = (conf->up_time / 86400);\n\tprintf(\"UpTime=%u-%2.2u:%2.2u:%2.2u\\n\", days, hours, mins, secs);\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _print_config(void);",
            "static void      _wait_for_all_threads(int secs);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _print_config(void);\nstatic void      _wait_for_all_threads(int secs);\n\nstatic void\n_print_config(void)\n{\n\tint days, hours, mins, secs;\n\tchar name[128];\n\n\tif (conf->cluster_name)\n\t\tprintf(\"ClusterName=%s \", conf->cluster_name);\n\n\tgethostname_short(name, sizeof(name));\n\tprintf(\"NodeName=%s \", name);\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n\tprintf(\"CPUs=%u Boards=%u SocketsPerBoard=%u CoresPerSocket=%u \"\n\t       \"ThreadsPerCore=%u \",\n\t       conf->actual_cpus, conf->actual_boards, conf->actual_sockets,\n\t       conf->actual_cores, conf->actual_threads);\n\n\tget_memory(&conf->real_memory_size);\n\tget_tmp_disk(&conf->tmp_disk_space, \"/tmp\");\n\tprintf(\"RealMemory=%u TmpDisk=%u\\n\",\n\t       conf->real_memory_size, conf->tmp_disk_space);\n\n\tget_up_time(&conf->up_time);\n\tsecs  =  conf->up_time % 60;\n\tmins  = (conf->up_time / 60) % 60;\n\thours = (conf->up_time / 3600) % 24;\n\tdays  = (conf->up_time / 86400);\n\tprintf(\"UpTime=%u-%2.2u:%2.2u:%2.2u\\n\", days, hours, mins, secs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_resource_spec_init",
          "args": [],
          "line": 1084
        },
        "resolved": true,
        "details": {
          "function_name": "_resource_spec_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2077-2085",
          "snippet": "static int _resource_spec_init(void)\n{\n\tfini_system_cgroup();\t/* Prevent memory leak */\n\tif (_core_spec_init() != SLURM_SUCCESS)\n\t\terror(\"Resource spec: core specialization disabled\");\n\tif (_memory_spec_init() != SLURM_SUCCESS)\n\t\terror(\"Resource spec: system cgroup memory limit disabled\");\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int       _core_spec_init(void);",
            "static int       _memory_spec_init(void);",
            "static int       _resource_spec_init(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic int       _core_spec_init(void);\nstatic int       _memory_spec_init(void);\nstatic int       _resource_spec_init(void);\n\nstatic int _resource_spec_init(void)\n{\n\tfini_system_cgroup();\t/* Prevent memory leak */\n\tif (_core_spec_init() != SLURM_SUCCESS)\n\t\terror(\"Resource spec: core specialization disabled\");\n\tif (_memory_spec_init() != SLURM_SUCCESS)\n\t\terror(\"Resource spec: system cgroup memory limit disabled\");\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_freq_init",
          "args": [
            "conf"
          ],
          "line": 1079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msg_aggr_sender_reconfig",
          "args": [
            "conf->msg_aggr_window_time",
            "conf->msg_aggr_window_msgs"
          ],
          "line": 1072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_freq_reconfig",
          "args": [],
          "line": 1070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "route_g_reconfigure",
          "args": [],
          "line": 1069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_set_topo_info",
          "args": [],
          "line": 1068
        },
        "resolved": true,
        "details": {
          "function_name": "_set_topo_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2004-2018",
          "snippet": "static int _set_topo_info(void)\n{\n\tint rc;\n\tchar * addr, * pattern;\n\n\trc = slurm_topo_get_node_addr(conf->node_name, &addr, &pattern);\n\tif ( rc == SLURM_SUCCESS ) {\n\t\txfree(conf->node_topo_addr);\n\t\txfree(conf->node_topo_pattern);\n\t\tconf->node_topo_addr = addr;\n\t\tconf->node_topo_pattern = pattern;\n\t}\n\n\treturn rc;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static int       _set_topo_info(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic int       _set_topo_info(void);\n\nstatic int _set_topo_info(void)\n{\n\tint rc;\n\tchar * addr, * pattern;\n\n\trc = slurm_topo_get_node_addr(conf->node_name, &addr, &pattern);\n\tif ( rc == SLURM_SUCCESS ) {\n\t\txfree(conf->node_topo_addr);\n\t\txfree(conf->node_topo_pattern);\n\t\tconf->node_topo_addr = addr;\n\t\tconf->node_topo_pattern = pattern;\n\t}\n\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_topo_build_config",
          "args": [],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_read_config",
          "args": [],
          "line": 1062
        },
        "resolved": true,
        "details": {
          "function_name": "_read_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "807-1050",
          "snippet": "static void\n_read_config(void)\n{\n\tchar *path_pubkey = NULL;\n\tslurm_ctl_conf_t *cf = NULL;\n\tint cc;\n#ifndef HAVE_FRONT_END\n\tbool cr_flag = false, gang_flag = false;\n#endif\n\n\tslurm_mutex_lock(&conf->config_mutex);\n\tcf = slurm_conf_lock();\n\n\txfree(conf->auth_info);\n\tconf->auth_info = xstrdup(cf->authinfo);\n\n\txfree(conf->chos_loc);\n\tconf->chos_loc = xstrdup(cf->chos_loc);\n\n\tconf->last_update = time(NULL);\n\n\tif (conf->conffile == NULL)\n\t\tconf->conffile = xstrdup(cf->slurm_conf);\n\n\tconf->slurm_user_id =  cf->slurm_user_id;\n\n\tconf->cr_type = cf->select_type_param;\n\n\tpath_pubkey = xstrdup(cf->job_credential_public_certificate);\n\n\tif (!conf->logfile)\n\t\tconf->logfile = xstrdup(cf->slurmd_logfile);\n\n#ifndef HAVE_FRONT_END\n\tif (!xstrcmp(cf->select_type, \"select/cons_res\"))\n\t\tcr_flag = true;\n\tif (!xstrcmp(cf->select_type, \"select/cray\") &&\n\t    (cf->select_type_param & CR_OTHER_CONS_RES))\n\t\tcr_flag = true;\n\n\tif (cf->preempt_mode & PREEMPT_MODE_GANG)\n\t\tgang_flag = true;\n#endif\n\n\tslurm_conf_unlock();\n\t/* node_name may already be set from a command line parameter */\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_nodename(conf->hostname);\n\t/* if we didn't match the form of the hostname already\n\t * stored in conf->hostname, check to see if we match any\n\t * valid aliases */\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_aliased_nodename();\n\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_nodename(\"localhost\");\n\n\tif (conf->node_name == NULL)\n\t\tfatal(\"Unable to determine this slurmd's NodeName\");\n\n\t_massage_pathname(&conf->logfile);\n\n\t/* set node_addr if relevant */\n\tif ((conf->node_addr == NULL) &&\n\t    (conf->node_addr = slurm_conf_get_nodeaddr(conf->hostname)) &&\n\t    (xstrcmp(conf->node_addr, conf->hostname) == 0)) {\n\t\txfree(conf->node_addr);\t/* Sets to NULL */\n\t}\n\n\tconf->port = slurm_conf_get_port(conf->node_name);\n\tslurm_conf_get_cpus_bsct(conf->node_name,\n\t\t\t\t &conf->conf_cpus, &conf->conf_boards,\n\t\t\t\t &conf->conf_sockets, &conf->conf_cores,\n\t\t\t\t &conf->conf_threads);\n\n\tslurm_conf_get_res_spec_info(conf->node_name,\n\t\t\t\t     &conf->cpu_spec_list,\n\t\t\t\t     &conf->core_spec_cnt,\n\t\t\t\t     &conf->mem_spec_limit);\n\n\t/* store hardware properties in slurmd_config */\n\txfree(conf->block_map);\n\txfree(conf->block_map_inv);\n\n\t_update_logging();\n\t_update_nice();\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n#ifdef HAVE_FRONT_END\n\t/*\n\t * When running with multiple frontends, the slurmd S:C:T values are not\n\t * relevant, hence ignored by both _register_front_ends (sets all to 1)\n\t * and validate_nodes_via_front_end (uses slurm.conf values).\n\t * Report actual hardware configuration, irrespective of FastSchedule.\n\t */\n\tconf->cpus    = conf->actual_cpus;\n\tconf->boards  = conf->actual_boards;\n\tconf->sockets = conf->actual_sockets;\n\tconf->cores   = conf->actual_cores;\n\tconf->threads = conf->actual_threads;\n#else\n\t/* If the actual resources on a node differ than what is in\n\t * the configuration file and we are using\n\t * cons_res or gang scheduling we have to use what is in the\n\t * configuration file because the slurmctld creates bitmaps\n\t * for scheduling before these nodes check in.\n\t */\n\tif (((cf->fast_schedule == 0) && !cr_flag && !gang_flag) ||\n\t    ((cf->fast_schedule == 1) &&\n\t     (conf->actual_cpus < conf->conf_cpus))) {\n\t\tconf->cpus    = conf->actual_cpus;\n\t\tconf->boards  = conf->actual_boards;\n\t\tconf->sockets = conf->actual_sockets;\n\t\tconf->cores   = conf->actual_cores;\n\t\tconf->threads = conf->actual_threads;\n\t} else if ((cf->fast_schedule == 1) && (cr_flag || gang_flag) &&\n\t\t   (conf->actual_sockets != conf->conf_sockets) &&\n\t\t   (conf->actual_cores != conf->conf_cores) &&\n\t\t   ((conf->actual_sockets * conf->actual_cores) ==\n\t\t    (conf->conf_sockets * conf->conf_cores))) {\n\t\t/* Socket and core count can be changed when KNL node reboots\n\t\t * in a different NUMA configuration */\n\t\tinfo(\"Node reconfigured socket/core boundaries \"\n\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw)\",\n\t\t     conf->conf_sockets, conf->actual_sockets,\n\t\t     conf->conf_cores, conf->actual_cores);\n\t\tconf->cpus    = conf->conf_cpus;\n\t\tconf->boards  = conf->conf_boards;\n\t\tconf->sockets = conf->actual_sockets;\n\t\tconf->cores   = conf->actual_cores;\n\t\tconf->threads = conf->conf_threads;\n\t} else {\n\t\tconf->cpus    = conf->conf_cpus;\n\t\tconf->boards  = conf->conf_boards;\n\t\tconf->sockets = conf->conf_sockets;\n\t\tconf->cores   = conf->conf_cores;\n\t\tconf->threads = conf->conf_threads;\n\t}\n\n\tif ((conf->cpus    != conf->actual_cpus)    ||\n\t    (conf->sockets != conf->actual_sockets) ||\n\t    (conf->cores   != conf->actual_cores)   ||\n\t    (conf->threads != conf->actual_threads)) {\n\t\tif (cf->fast_schedule) {\n\t\t\tinfo(\"Node configuration differs from hardware: \"\n\t\t\t     \"CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t     \"ThreadsPerCore=%u:%u(hw)\",\n\t\t\t     conf->cpus,    conf->actual_cpus,\n\t\t\t     conf->boards,  conf->actual_boards,\n\t\t\t     conf->sockets, conf->actual_sockets,\n\t\t\t     conf->cores,   conf->actual_cores,\n\t\t\t     conf->threads, conf->actual_threads);\n\t\t} else if ((cf->fast_schedule == 0) && (cr_flag || gang_flag)) {\n\t\t\terror(\"You are using cons_res or gang scheduling with \"\n\t\t\t      \"Fastschedule=0 and node configuration differs \"\n\t\t\t      \"from hardware.  The node configuration used \"\n\t\t\t      \"will be what is in the slurm.conf because of \"\n\t\t\t      \"the bitmaps the slurmctld must create before \"\n\t\t\t      \"the slurmd registers.\\n\"\n\t\t\t      \"   CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t      \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t      \"ThreadsPerCore=%u:%u(hw)\",\n\t\t\t      conf->cpus,    conf->actual_cpus,\n\t\t\t      conf->boards,  conf->actual_boards,\n\t\t\t      conf->sockets, conf->actual_sockets,\n\t\t\t      conf->cores,   conf->actual_cores,\n\t\t\t      conf->threads, conf->actual_threads);\n\t\t}\n\t}\n#endif\n\n\tget_memory(&conf->real_memory_size);\n\tget_up_time(&conf->up_time);\n\n\tcf = slurm_conf_lock();\n\tget_tmp_disk(&conf->tmp_disk_space, cf->tmp_fs);\n\t_free_and_set(conf->cluster_name, xstrdup(cf->cluster_name));\n\t_free_and_set(conf->epilog,   xstrdup(cf->epilog));\n\t_free_and_set(conf->prolog,   xstrdup(cf->prolog));\n\t_free_and_set(conf->tmpfs,    xstrdup(cf->tmp_fs));\n\t_free_and_set(conf->health_check_program,\n\t\t      xstrdup(cf->health_check_program));\n\t_free_and_set(conf->spooldir, xstrdup(cf->slurmd_spooldir));\n\t_massage_pathname(&conf->spooldir);\n\t_free_and_set(conf->pidfile,  xstrdup(cf->slurmd_pidfile));\n\t_massage_pathname(&conf->pidfile);\n\t_free_and_set(conf->plugstack,   xstrdup(cf->plugstack));\n\t_free_and_set(conf->select_type, xstrdup(cf->select_type));\n\t_free_and_set(conf->task_prolog, xstrdup(cf->task_prolog));\n\t_free_and_set(conf->task_epilog, xstrdup(cf->task_epilog));\n\t_free_and_set(conf->pubkey,   path_pubkey);\n\n\tconf->debug_flags = cf->debug_flags;\n\tconf->propagate_prio = cf->propagate_prio_process;\n\n\t_free_and_set(conf->job_acct_gather_freq,\n\t\t      xstrdup(cf->job_acct_gather_freq));\n\n\tconf->acct_freq_task = (uint16_t)NO_VAL;\n\tcc = acct_gather_parse_freq(PROFILE_TASK,\n\t\t\t\t    conf->job_acct_gather_freq);\n\tif (cc != -1)\n\t\tconf->acct_freq_task = cc;\n\n\t_free_and_set(conf->acct_gather_energy_type,\n\t\t      xstrdup(cf->acct_gather_energy_type));\n\t_free_and_set(conf->acct_gather_filesystem_type,\n\t\t      xstrdup(cf->acct_gather_filesystem_type));\n\t_free_and_set(conf->acct_gather_infiniband_type,\n\t\t      xstrdup(cf->acct_gather_infiniband_type));\n\t_free_and_set(conf->acct_gather_profile_type,\n\t\t      xstrdup(cf->acct_gather_profile_type));\n\t_free_and_set(conf->job_acct_gather_type,\n\t\t      xstrdup(cf->job_acct_gather_type));\n\t_free_and_set(conf->msg_aggr_params,\n\t\t      xstrdup(cf->msg_aggr_params));\n\t_set_msg_aggr_params();\n\n\tif ( (conf->node_name == NULL) ||\n\t     (conf->node_name[0] == '\\0') )\n\t\tfatal(\"Node name lookup failure\");\n\n\tif (cf->control_addr == NULL)\n\t\tfatal(\"Unable to establish controller machine\");\n\tif (cf->slurmctld_port == 0)\n\t\tfatal(\"Unable to establish controller port\");\n\tconf->slurmd_timeout = cf->slurmd_timeout;\n\tconf->kill_wait = cf->kill_wait;\n\tconf->use_pam = cf->use_pam;\n\tconf->task_plugin_param = cf->task_plugin_param;\n\n\tconf->mem_limit_enforce = cf->mem_limit_enforce;\n\tconf->health_check_interval = cf->health_check_interval;\n\n\tslurm_mutex_unlock(&conf->config_mutex);\n\tslurm_conf_unlock();\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _read_config(void);",
            "static void      _set_msg_aggr_params(void);",
            "static void      _update_logging(void);",
            "static void      _update_nice(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _read_config(void);\nstatic void      _set_msg_aggr_params(void);\nstatic void      _update_logging(void);\nstatic void      _update_nice(void);\n\nstatic void\n_read_config(void)\n{\n\tchar *path_pubkey = NULL;\n\tslurm_ctl_conf_t *cf = NULL;\n\tint cc;\n#ifndef HAVE_FRONT_END\n\tbool cr_flag = false, gang_flag = false;\n#endif\n\n\tslurm_mutex_lock(&conf->config_mutex);\n\tcf = slurm_conf_lock();\n\n\txfree(conf->auth_info);\n\tconf->auth_info = xstrdup(cf->authinfo);\n\n\txfree(conf->chos_loc);\n\tconf->chos_loc = xstrdup(cf->chos_loc);\n\n\tconf->last_update = time(NULL);\n\n\tif (conf->conffile == NULL)\n\t\tconf->conffile = xstrdup(cf->slurm_conf);\n\n\tconf->slurm_user_id =  cf->slurm_user_id;\n\n\tconf->cr_type = cf->select_type_param;\n\n\tpath_pubkey = xstrdup(cf->job_credential_public_certificate);\n\n\tif (!conf->logfile)\n\t\tconf->logfile = xstrdup(cf->slurmd_logfile);\n\n#ifndef HAVE_FRONT_END\n\tif (!xstrcmp(cf->select_type, \"select/cons_res\"))\n\t\tcr_flag = true;\n\tif (!xstrcmp(cf->select_type, \"select/cray\") &&\n\t    (cf->select_type_param & CR_OTHER_CONS_RES))\n\t\tcr_flag = true;\n\n\tif (cf->preempt_mode & PREEMPT_MODE_GANG)\n\t\tgang_flag = true;\n#endif\n\n\tslurm_conf_unlock();\n\t/* node_name may already be set from a command line parameter */\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_nodename(conf->hostname);\n\t/* if we didn't match the form of the hostname already\n\t * stored in conf->hostname, check to see if we match any\n\t * valid aliases */\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_aliased_nodename();\n\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_nodename(\"localhost\");\n\n\tif (conf->node_name == NULL)\n\t\tfatal(\"Unable to determine this slurmd's NodeName\");\n\n\t_massage_pathname(&conf->logfile);\n\n\t/* set node_addr if relevant */\n\tif ((conf->node_addr == NULL) &&\n\t    (conf->node_addr = slurm_conf_get_nodeaddr(conf->hostname)) &&\n\t    (xstrcmp(conf->node_addr, conf->hostname) == 0)) {\n\t\txfree(conf->node_addr);\t/* Sets to NULL */\n\t}\n\n\tconf->port = slurm_conf_get_port(conf->node_name);\n\tslurm_conf_get_cpus_bsct(conf->node_name,\n\t\t\t\t &conf->conf_cpus, &conf->conf_boards,\n\t\t\t\t &conf->conf_sockets, &conf->conf_cores,\n\t\t\t\t &conf->conf_threads);\n\n\tslurm_conf_get_res_spec_info(conf->node_name,\n\t\t\t\t     &conf->cpu_spec_list,\n\t\t\t\t     &conf->core_spec_cnt,\n\t\t\t\t     &conf->mem_spec_limit);\n\n\t/* store hardware properties in slurmd_config */\n\txfree(conf->block_map);\n\txfree(conf->block_map_inv);\n\n\t_update_logging();\n\t_update_nice();\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n#ifdef HAVE_FRONT_END\n\t/*\n\t * When running with multiple frontends, the slurmd S:C:T values are not\n\t * relevant, hence ignored by both _register_front_ends (sets all to 1)\n\t * and validate_nodes_via_front_end (uses slurm.conf values).\n\t * Report actual hardware configuration, irrespective of FastSchedule.\n\t */\n\tconf->cpus    = conf->actual_cpus;\n\tconf->boards  = conf->actual_boards;\n\tconf->sockets = conf->actual_sockets;\n\tconf->cores   = conf->actual_cores;\n\tconf->threads = conf->actual_threads;\n#else\n\t/* If the actual resources on a node differ than what is in\n\t * the configuration file and we are using\n\t * cons_res or gang scheduling we have to use what is in the\n\t * configuration file because the slurmctld creates bitmaps\n\t * for scheduling before these nodes check in.\n\t */\n\tif (((cf->fast_schedule == 0) && !cr_flag && !gang_flag) ||\n\t    ((cf->fast_schedule == 1) &&\n\t     (conf->actual_cpus < conf->conf_cpus))) {\n\t\tconf->cpus    = conf->actual_cpus;\n\t\tconf->boards  = conf->actual_boards;\n\t\tconf->sockets = conf->actual_sockets;\n\t\tconf->cores   = conf->actual_cores;\n\t\tconf->threads = conf->actual_threads;\n\t} else if ((cf->fast_schedule == 1) && (cr_flag || gang_flag) &&\n\t\t   (conf->actual_sockets != conf->conf_sockets) &&\n\t\t   (conf->actual_cores != conf->conf_cores) &&\n\t\t   ((conf->actual_sockets * conf->actual_cores) ==\n\t\t    (conf->conf_sockets * conf->conf_cores))) {\n\t\t/* Socket and core count can be changed when KNL node reboots\n\t\t * in a different NUMA configuration */\n\t\tinfo(\"Node reconfigured socket/core boundaries \"\n\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw)\",\n\t\t     conf->conf_sockets, conf->actual_sockets,\n\t\t     conf->conf_cores, conf->actual_cores);\n\t\tconf->cpus    = conf->conf_cpus;\n\t\tconf->boards  = conf->conf_boards;\n\t\tconf->sockets = conf->actual_sockets;\n\t\tconf->cores   = conf->actual_cores;\n\t\tconf->threads = conf->conf_threads;\n\t} else {\n\t\tconf->cpus    = conf->conf_cpus;\n\t\tconf->boards  = conf->conf_boards;\n\t\tconf->sockets = conf->conf_sockets;\n\t\tconf->cores   = conf->conf_cores;\n\t\tconf->threads = conf->conf_threads;\n\t}\n\n\tif ((conf->cpus    != conf->actual_cpus)    ||\n\t    (conf->sockets != conf->actual_sockets) ||\n\t    (conf->cores   != conf->actual_cores)   ||\n\t    (conf->threads != conf->actual_threads)) {\n\t\tif (cf->fast_schedule) {\n\t\t\tinfo(\"Node configuration differs from hardware: \"\n\t\t\t     \"CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t     \"ThreadsPerCore=%u:%u(hw)\",\n\t\t\t     conf->cpus,    conf->actual_cpus,\n\t\t\t     conf->boards,  conf->actual_boards,\n\t\t\t     conf->sockets, conf->actual_sockets,\n\t\t\t     conf->cores,   conf->actual_cores,\n\t\t\t     conf->threads, conf->actual_threads);\n\t\t} else if ((cf->fast_schedule == 0) && (cr_flag || gang_flag)) {\n\t\t\terror(\"You are using cons_res or gang scheduling with \"\n\t\t\t      \"Fastschedule=0 and node configuration differs \"\n\t\t\t      \"from hardware.  The node configuration used \"\n\t\t\t      \"will be what is in the slurm.conf because of \"\n\t\t\t      \"the bitmaps the slurmctld must create before \"\n\t\t\t      \"the slurmd registers.\\n\"\n\t\t\t      \"   CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t      \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t      \"ThreadsPerCore=%u:%u(hw)\",\n\t\t\t      conf->cpus,    conf->actual_cpus,\n\t\t\t      conf->boards,  conf->actual_boards,\n\t\t\t      conf->sockets, conf->actual_sockets,\n\t\t\t      conf->cores,   conf->actual_cores,\n\t\t\t      conf->threads, conf->actual_threads);\n\t\t}\n\t}\n#endif\n\n\tget_memory(&conf->real_memory_size);\n\tget_up_time(&conf->up_time);\n\n\tcf = slurm_conf_lock();\n\tget_tmp_disk(&conf->tmp_disk_space, cf->tmp_fs);\n\t_free_and_set(conf->cluster_name, xstrdup(cf->cluster_name));\n\t_free_and_set(conf->epilog,   xstrdup(cf->epilog));\n\t_free_and_set(conf->prolog,   xstrdup(cf->prolog));\n\t_free_and_set(conf->tmpfs,    xstrdup(cf->tmp_fs));\n\t_free_and_set(conf->health_check_program,\n\t\t      xstrdup(cf->health_check_program));\n\t_free_and_set(conf->spooldir, xstrdup(cf->slurmd_spooldir));\n\t_massage_pathname(&conf->spooldir);\n\t_free_and_set(conf->pidfile,  xstrdup(cf->slurmd_pidfile));\n\t_massage_pathname(&conf->pidfile);\n\t_free_and_set(conf->plugstack,   xstrdup(cf->plugstack));\n\t_free_and_set(conf->select_type, xstrdup(cf->select_type));\n\t_free_and_set(conf->task_prolog, xstrdup(cf->task_prolog));\n\t_free_and_set(conf->task_epilog, xstrdup(cf->task_epilog));\n\t_free_and_set(conf->pubkey,   path_pubkey);\n\n\tconf->debug_flags = cf->debug_flags;\n\tconf->propagate_prio = cf->propagate_prio_process;\n\n\t_free_and_set(conf->job_acct_gather_freq,\n\t\t      xstrdup(cf->job_acct_gather_freq));\n\n\tconf->acct_freq_task = (uint16_t)NO_VAL;\n\tcc = acct_gather_parse_freq(PROFILE_TASK,\n\t\t\t\t    conf->job_acct_gather_freq);\n\tif (cc != -1)\n\t\tconf->acct_freq_task = cc;\n\n\t_free_and_set(conf->acct_gather_energy_type,\n\t\t      xstrdup(cf->acct_gather_energy_type));\n\t_free_and_set(conf->acct_gather_filesystem_type,\n\t\t      xstrdup(cf->acct_gather_filesystem_type));\n\t_free_and_set(conf->acct_gather_infiniband_type,\n\t\t      xstrdup(cf->acct_gather_infiniband_type));\n\t_free_and_set(conf->acct_gather_profile_type,\n\t\t      xstrdup(cf->acct_gather_profile_type));\n\t_free_and_set(conf->job_acct_gather_type,\n\t\t      xstrdup(cf->job_acct_gather_type));\n\t_free_and_set(conf->msg_aggr_params,\n\t\t      xstrdup(cf->msg_aggr_params));\n\t_set_msg_aggr_params();\n\n\tif ( (conf->node_name == NULL) ||\n\t     (conf->node_name[0] == '\\0') )\n\t\tfatal(\"Node name lookup failure\");\n\n\tif (cf->control_addr == NULL)\n\t\tfatal(\"Unable to establish controller machine\");\n\tif (cf->slurmctld_port == 0)\n\t\tfatal(\"Unable to establish controller port\");\n\tconf->slurmd_timeout = cf->slurmd_timeout;\n\tconf->kill_wait = cf->kill_wait;\n\tconf->use_pam = cf->use_pam;\n\tconf->task_plugin_param = cf->task_plugin_param;\n\n\tconf->mem_limit_enforce = cf->mem_limit_enforce;\n\tconf->health_check_interval = cf->health_check_interval;\n\n\tslurm_mutex_unlock(&conf->config_mutex);\n\tslurm_conf_unlock();\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_conf_reinit",
          "args": [
            "conf->conffile"
          ],
          "line": 1061
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic sig_atomic_t _reconfig = 0;\nstatic void      _print_conf(void);\nstatic void      _read_config(void);\nstatic void      _reconfigure(void);\nstatic int       _resource_spec_init(void);\nstatic int       _set_topo_info(void);\n\nstatic void\n_reconfigure(void)\n{\n\tList steps;\n\tListIterator i;\n\tstep_loc_t *stepd;\n\tbool did_change;\n\n\t_reconfig = 0;\n\tslurm_conf_reinit(conf->conffile);\n\t_read_config();\n\n\t/*\n\t * Rebuild topology information and refresh slurmd topo infos\n\t */\n\tslurm_topo_build_config();\n\t_set_topo_info();\n\troute_g_reconfigure();\n\tcpu_freq_reconfig();\n\n\tmsg_aggr_sender_reconfig(conf->msg_aggr_window_time,\n\t\t\t\t conf->msg_aggr_window_msgs);\n\n\t/*\n\t * In case the administrator changed the cpu frequency set capabilities\n\t * on this node, rebuild the cpu frequency table information\n\t */\n\tcpu_freq_init(conf);\n\n\t/*\n\t * If configured, apply resource specialization\n\t */\n\t_resource_spec_init();\n\n\t_print_conf();\n\n\t/*\n\t * Make best effort at changing to new public key\n\t */\n\tslurm_cred_ctx_key_update(conf->vctx, conf->pubkey);\n\n\t/*\n\t * Purge the username -> grouplist cache.\n\t */\n\tgids_cache_purge();\n\n\t/* send reconfig to each stepd so they can refresh their log\n\t * file handle\n\t */\n\n\tsteps = stepd_available(conf->spooldir, conf->node_name);\n\ti = list_iterator_create(steps);\n\twhile ((stepd = list_next(i))) {\n\t\tint fd;\n\t\tfd = stepd_connect(stepd->directory, stepd->nodename,\n\t\t\t\t   stepd->jobid, stepd->stepid,\n\t\t\t\t   &stepd->protocol_version);\n\t\tif (fd == -1)\n\t\t\tcontinue;\n\n\t\tif (stepd_reconfig(fd, stepd->protocol_version)\n\t\t    != SLURM_SUCCESS)\n\t\t\tdebug(\"Reconfig jobid=%u.%u failed: %m\",\n\t\t\t      stepd->jobid, stepd->stepid);\n\t\tclose(fd);\n\t}\n\tlist_iterator_destroy(i);\n\tFREE_NULL_LIST(steps);\n\n\tgres_plugin_reconfig(&did_change);\n\t(void) switch_g_reconfig();\n\tcontainer_g_reconfig();\n\tif (did_change) {\n\t\tuint32_t cpu_cnt = MAX(conf->conf_cpus, conf->block_map_size);\n\t\t(void) gres_plugin_node_config_load(cpu_cnt, conf->node_name,\n\t\t\t\t\t\t    NULL);\n\t\tsend_registration_msg(SLURM_SUCCESS, false);\n\t}\n\n\t/* reconfigure energy */\n\tacct_gather_energy_g_set_data(ENERGY_DATA_RECONFIG, NULL);\n\n\t/*\n\t * XXX: reopen slurmd port?\n\t */\n}"
  },
  {
    "function_name": "_read_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "807-1050",
    "snippet": "static void\n_read_config(void)\n{\n\tchar *path_pubkey = NULL;\n\tslurm_ctl_conf_t *cf = NULL;\n\tint cc;\n#ifndef HAVE_FRONT_END\n\tbool cr_flag = false, gang_flag = false;\n#endif\n\n\tslurm_mutex_lock(&conf->config_mutex);\n\tcf = slurm_conf_lock();\n\n\txfree(conf->auth_info);\n\tconf->auth_info = xstrdup(cf->authinfo);\n\n\txfree(conf->chos_loc);\n\tconf->chos_loc = xstrdup(cf->chos_loc);\n\n\tconf->last_update = time(NULL);\n\n\tif (conf->conffile == NULL)\n\t\tconf->conffile = xstrdup(cf->slurm_conf);\n\n\tconf->slurm_user_id =  cf->slurm_user_id;\n\n\tconf->cr_type = cf->select_type_param;\n\n\tpath_pubkey = xstrdup(cf->job_credential_public_certificate);\n\n\tif (!conf->logfile)\n\t\tconf->logfile = xstrdup(cf->slurmd_logfile);\n\n#ifndef HAVE_FRONT_END\n\tif (!xstrcmp(cf->select_type, \"select/cons_res\"))\n\t\tcr_flag = true;\n\tif (!xstrcmp(cf->select_type, \"select/cray\") &&\n\t    (cf->select_type_param & CR_OTHER_CONS_RES))\n\t\tcr_flag = true;\n\n\tif (cf->preempt_mode & PREEMPT_MODE_GANG)\n\t\tgang_flag = true;\n#endif\n\n\tslurm_conf_unlock();\n\t/* node_name may already be set from a command line parameter */\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_nodename(conf->hostname);\n\t/* if we didn't match the form of the hostname already\n\t * stored in conf->hostname, check to see if we match any\n\t * valid aliases */\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_aliased_nodename();\n\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_nodename(\"localhost\");\n\n\tif (conf->node_name == NULL)\n\t\tfatal(\"Unable to determine this slurmd's NodeName\");\n\n\t_massage_pathname(&conf->logfile);\n\n\t/* set node_addr if relevant */\n\tif ((conf->node_addr == NULL) &&\n\t    (conf->node_addr = slurm_conf_get_nodeaddr(conf->hostname)) &&\n\t    (xstrcmp(conf->node_addr, conf->hostname) == 0)) {\n\t\txfree(conf->node_addr);\t/* Sets to NULL */\n\t}\n\n\tconf->port = slurm_conf_get_port(conf->node_name);\n\tslurm_conf_get_cpus_bsct(conf->node_name,\n\t\t\t\t &conf->conf_cpus, &conf->conf_boards,\n\t\t\t\t &conf->conf_sockets, &conf->conf_cores,\n\t\t\t\t &conf->conf_threads);\n\n\tslurm_conf_get_res_spec_info(conf->node_name,\n\t\t\t\t     &conf->cpu_spec_list,\n\t\t\t\t     &conf->core_spec_cnt,\n\t\t\t\t     &conf->mem_spec_limit);\n\n\t/* store hardware properties in slurmd_config */\n\txfree(conf->block_map);\n\txfree(conf->block_map_inv);\n\n\t_update_logging();\n\t_update_nice();\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n#ifdef HAVE_FRONT_END\n\t/*\n\t * When running with multiple frontends, the slurmd S:C:T values are not\n\t * relevant, hence ignored by both _register_front_ends (sets all to 1)\n\t * and validate_nodes_via_front_end (uses slurm.conf values).\n\t * Report actual hardware configuration, irrespective of FastSchedule.\n\t */\n\tconf->cpus    = conf->actual_cpus;\n\tconf->boards  = conf->actual_boards;\n\tconf->sockets = conf->actual_sockets;\n\tconf->cores   = conf->actual_cores;\n\tconf->threads = conf->actual_threads;\n#else\n\t/* If the actual resources on a node differ than what is in\n\t * the configuration file and we are using\n\t * cons_res or gang scheduling we have to use what is in the\n\t * configuration file because the slurmctld creates bitmaps\n\t * for scheduling before these nodes check in.\n\t */\n\tif (((cf->fast_schedule == 0) && !cr_flag && !gang_flag) ||\n\t    ((cf->fast_schedule == 1) &&\n\t     (conf->actual_cpus < conf->conf_cpus))) {\n\t\tconf->cpus    = conf->actual_cpus;\n\t\tconf->boards  = conf->actual_boards;\n\t\tconf->sockets = conf->actual_sockets;\n\t\tconf->cores   = conf->actual_cores;\n\t\tconf->threads = conf->actual_threads;\n\t} else if ((cf->fast_schedule == 1) && (cr_flag || gang_flag) &&\n\t\t   (conf->actual_sockets != conf->conf_sockets) &&\n\t\t   (conf->actual_cores != conf->conf_cores) &&\n\t\t   ((conf->actual_sockets * conf->actual_cores) ==\n\t\t    (conf->conf_sockets * conf->conf_cores))) {\n\t\t/* Socket and core count can be changed when KNL node reboots\n\t\t * in a different NUMA configuration */\n\t\tinfo(\"Node reconfigured socket/core boundaries \"\n\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw)\",\n\t\t     conf->conf_sockets, conf->actual_sockets,\n\t\t     conf->conf_cores, conf->actual_cores);\n\t\tconf->cpus    = conf->conf_cpus;\n\t\tconf->boards  = conf->conf_boards;\n\t\tconf->sockets = conf->actual_sockets;\n\t\tconf->cores   = conf->actual_cores;\n\t\tconf->threads = conf->conf_threads;\n\t} else {\n\t\tconf->cpus    = conf->conf_cpus;\n\t\tconf->boards  = conf->conf_boards;\n\t\tconf->sockets = conf->conf_sockets;\n\t\tconf->cores   = conf->conf_cores;\n\t\tconf->threads = conf->conf_threads;\n\t}\n\n\tif ((conf->cpus    != conf->actual_cpus)    ||\n\t    (conf->sockets != conf->actual_sockets) ||\n\t    (conf->cores   != conf->actual_cores)   ||\n\t    (conf->threads != conf->actual_threads)) {\n\t\tif (cf->fast_schedule) {\n\t\t\tinfo(\"Node configuration differs from hardware: \"\n\t\t\t     \"CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t     \"ThreadsPerCore=%u:%u(hw)\",\n\t\t\t     conf->cpus,    conf->actual_cpus,\n\t\t\t     conf->boards,  conf->actual_boards,\n\t\t\t     conf->sockets, conf->actual_sockets,\n\t\t\t     conf->cores,   conf->actual_cores,\n\t\t\t     conf->threads, conf->actual_threads);\n\t\t} else if ((cf->fast_schedule == 0) && (cr_flag || gang_flag)) {\n\t\t\terror(\"You are using cons_res or gang scheduling with \"\n\t\t\t      \"Fastschedule=0 and node configuration differs \"\n\t\t\t      \"from hardware.  The node configuration used \"\n\t\t\t      \"will be what is in the slurm.conf because of \"\n\t\t\t      \"the bitmaps the slurmctld must create before \"\n\t\t\t      \"the slurmd registers.\\n\"\n\t\t\t      \"   CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t      \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t      \"ThreadsPerCore=%u:%u(hw)\",\n\t\t\t      conf->cpus,    conf->actual_cpus,\n\t\t\t      conf->boards,  conf->actual_boards,\n\t\t\t      conf->sockets, conf->actual_sockets,\n\t\t\t      conf->cores,   conf->actual_cores,\n\t\t\t      conf->threads, conf->actual_threads);\n\t\t}\n\t}\n#endif\n\n\tget_memory(&conf->real_memory_size);\n\tget_up_time(&conf->up_time);\n\n\tcf = slurm_conf_lock();\n\tget_tmp_disk(&conf->tmp_disk_space, cf->tmp_fs);\n\t_free_and_set(conf->cluster_name, xstrdup(cf->cluster_name));\n\t_free_and_set(conf->epilog,   xstrdup(cf->epilog));\n\t_free_and_set(conf->prolog,   xstrdup(cf->prolog));\n\t_free_and_set(conf->tmpfs,    xstrdup(cf->tmp_fs));\n\t_free_and_set(conf->health_check_program,\n\t\t      xstrdup(cf->health_check_program));\n\t_free_and_set(conf->spooldir, xstrdup(cf->slurmd_spooldir));\n\t_massage_pathname(&conf->spooldir);\n\t_free_and_set(conf->pidfile,  xstrdup(cf->slurmd_pidfile));\n\t_massage_pathname(&conf->pidfile);\n\t_free_and_set(conf->plugstack,   xstrdup(cf->plugstack));\n\t_free_and_set(conf->select_type, xstrdup(cf->select_type));\n\t_free_and_set(conf->task_prolog, xstrdup(cf->task_prolog));\n\t_free_and_set(conf->task_epilog, xstrdup(cf->task_epilog));\n\t_free_and_set(conf->pubkey,   path_pubkey);\n\n\tconf->debug_flags = cf->debug_flags;\n\tconf->propagate_prio = cf->propagate_prio_process;\n\n\t_free_and_set(conf->job_acct_gather_freq,\n\t\t      xstrdup(cf->job_acct_gather_freq));\n\n\tconf->acct_freq_task = (uint16_t)NO_VAL;\n\tcc = acct_gather_parse_freq(PROFILE_TASK,\n\t\t\t\t    conf->job_acct_gather_freq);\n\tif (cc != -1)\n\t\tconf->acct_freq_task = cc;\n\n\t_free_and_set(conf->acct_gather_energy_type,\n\t\t      xstrdup(cf->acct_gather_energy_type));\n\t_free_and_set(conf->acct_gather_filesystem_type,\n\t\t      xstrdup(cf->acct_gather_filesystem_type));\n\t_free_and_set(conf->acct_gather_infiniband_type,\n\t\t      xstrdup(cf->acct_gather_infiniband_type));\n\t_free_and_set(conf->acct_gather_profile_type,\n\t\t      xstrdup(cf->acct_gather_profile_type));\n\t_free_and_set(conf->job_acct_gather_type,\n\t\t      xstrdup(cf->job_acct_gather_type));\n\t_free_and_set(conf->msg_aggr_params,\n\t\t      xstrdup(cf->msg_aggr_params));\n\t_set_msg_aggr_params();\n\n\tif ( (conf->node_name == NULL) ||\n\t     (conf->node_name[0] == '\\0') )\n\t\tfatal(\"Node name lookup failure\");\n\n\tif (cf->control_addr == NULL)\n\t\tfatal(\"Unable to establish controller machine\");\n\tif (cf->slurmctld_port == 0)\n\t\tfatal(\"Unable to establish controller port\");\n\tconf->slurmd_timeout = cf->slurmd_timeout;\n\tconf->kill_wait = cf->kill_wait;\n\tconf->use_pam = cf->use_pam;\n\tconf->task_plugin_param = cf->task_plugin_param;\n\n\tconf->mem_limit_enforce = cf->mem_limit_enforce;\n\tconf->health_check_interval = cf->health_check_interval;\n\n\tslurm_mutex_unlock(&conf->config_mutex);\n\tslurm_conf_unlock();\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _read_config(void);",
      "static void      _set_msg_aggr_params(void);",
      "static void      _update_logging(void);",
      "static void      _update_nice(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "slurm_conf_unlock",
          "args": [],
          "line": 1049
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_mutex_unlock",
          "args": [
            "&conf->config_mutex"
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"Unable to establish controller port\""
          ],
          "line": 1039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"Unable to establish controller machine\""
          ],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"Node name lookup failure\""
          ],
          "line": 1034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_set_msg_aggr_params",
          "args": [],
          "line": 1030
        },
        "resolved": true,
        "details": {
          "function_name": "_set_msg_aggr_params",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2056-2072",
          "snippet": "static void _set_msg_aggr_params(void)\n{\n\tconf->msg_aggr_window_time = _parse_msg_aggr_params(WINDOW_TIME,\n\t\t\t       conf->msg_aggr_params);\n\tconf->msg_aggr_window_msgs = _parse_msg_aggr_params(WINDOW_MSGS,\n\t\t\t       conf->msg_aggr_params);\n\n\tif (conf->msg_aggr_window_time == NO_VAL)\n\t\tconf->msg_aggr_window_time = DEFAULT_MSG_AGGR_WINDOW_TIME;\n\tif (conf->msg_aggr_window_msgs == NO_VAL)\n\t\tconf->msg_aggr_window_msgs = DEFAULT_MSG_AGGR_WINDOW_MSGS;\n\tif (conf->msg_aggr_window_msgs > 1) {\n\t\tinfo(\"Message aggregation enabled: WindowMsgs=%\"PRIu64\", WindowTime=%\"PRIu64,\n\t\t     conf->msg_aggr_window_msgs, conf->msg_aggr_window_time);\n\t} else\n\t\tinfo(\"Message aggregation disabled\");\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _set_msg_aggr_params(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _set_msg_aggr_params(void);\n\nstatic void _set_msg_aggr_params(void)\n{\n\tconf->msg_aggr_window_time = _parse_msg_aggr_params(WINDOW_TIME,\n\t\t\t       conf->msg_aggr_params);\n\tconf->msg_aggr_window_msgs = _parse_msg_aggr_params(WINDOW_MSGS,\n\t\t\t       conf->msg_aggr_params);\n\n\tif (conf->msg_aggr_window_time == NO_VAL)\n\t\tconf->msg_aggr_window_time = DEFAULT_MSG_AGGR_WINDOW_TIME;\n\tif (conf->msg_aggr_window_msgs == NO_VAL)\n\t\tconf->msg_aggr_window_msgs = DEFAULT_MSG_AGGR_WINDOW_MSGS;\n\tif (conf->msg_aggr_window_msgs > 1) {\n\t\tinfo(\"Message aggregation enabled: WindowMsgs=%\"PRIu64\", WindowTime=%\"PRIu64,\n\t\t     conf->msg_aggr_window_msgs, conf->msg_aggr_window_time);\n\t} else\n\t\tinfo(\"Message aggregation disabled\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->msg_aggr_params",
            "xstrdup(cf->msg_aggr_params)"
          ],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->msg_aggr_params"
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->job_acct_gather_type",
            "xstrdup(cf->job_acct_gather_type)"
          ],
          "line": 1026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->job_acct_gather_type"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->acct_gather_profile_type",
            "xstrdup(cf->acct_gather_profile_type)"
          ],
          "line": 1024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->acct_gather_profile_type"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->acct_gather_infiniband_type",
            "xstrdup(cf->acct_gather_infiniband_type)"
          ],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->acct_gather_infiniband_type"
          ],
          "line": 1023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->acct_gather_filesystem_type",
            "xstrdup(cf->acct_gather_filesystem_type)"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->acct_gather_filesystem_type"
          ],
          "line": 1021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->acct_gather_energy_type",
            "xstrdup(cf->acct_gather_energy_type)"
          ],
          "line": 1018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->acct_gather_energy_type"
          ],
          "line": 1019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acct_gather_parse_freq",
          "args": [
            "PROFILE_TASK",
            "conf->job_acct_gather_freq"
          ],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->job_acct_gather_freq",
            "xstrdup(cf->job_acct_gather_freq)"
          ],
          "line": 1009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->job_acct_gather_freq"
          ],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->pubkey",
            "path_pubkey"
          ],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->task_epilog",
            "xstrdup(cf->task_epilog)"
          ],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->task_epilog"
          ],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->task_prolog",
            "xstrdup(cf->task_prolog)"
          ],
          "line": 1002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->task_prolog"
          ],
          "line": 1002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->select_type",
            "xstrdup(cf->select_type)"
          ],
          "line": 1001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->select_type"
          ],
          "line": 1001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->plugstack",
            "xstrdup(cf->plugstack)"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->plugstack"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_massage_pathname",
          "args": [
            "&conf->pidfile"
          ],
          "line": 999
        },
        "resolved": true,
        "details": {
          "function_name": "_massage_pathname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "792-801",
          "snippet": "static void\n_massage_pathname(char **path)\n{\n\tif (path && *path) {\n\t\tif (conf->hostname)\n\t\t\txstrsubstitute(*path, \"%h\", conf->hostname);\n\t\tif (conf->node_name)\n\t\t\txstrsubstitute(*path, \"%n\", conf->node_name);\n\t}\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\n\nstatic void\n_massage_pathname(char **path)\n{\n\tif (path && *path) {\n\t\tif (conf->hostname)\n\t\t\txstrsubstitute(*path, \"%h\", conf->hostname);\n\t\tif (conf->node_name)\n\t\t\txstrsubstitute(*path, \"%n\", conf->node_name);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->pidfile",
            "xstrdup(cf->slurmd_pidfile)"
          ],
          "line": 998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->slurmd_pidfile"
          ],
          "line": 998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->spooldir",
            "xstrdup(cf->slurmd_spooldir)"
          ],
          "line": 996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->slurmd_spooldir"
          ],
          "line": 996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->health_check_program",
            "xstrdup(cf->health_check_program)"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->health_check_program"
          ],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->tmpfs",
            "xstrdup(cf->tmp_fs)"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->tmp_fs"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->prolog",
            "xstrdup(cf->prolog)"
          ],
          "line": 992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->prolog"
          ],
          "line": 992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->epilog",
            "xstrdup(cf->epilog)"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->epilog"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_free_and_set",
          "args": [
            "conf->cluster_name",
            "xstrdup(cf->cluster_name)"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->cluster_name"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_tmp_disk",
          "args": [
            "&conf->tmp_disk_space",
            "cf->tmp_fs"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_conf_lock",
          "args": [],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_up_time",
          "args": [
            "&conf->up_time"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "get_up_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "274-325",
          "snippet": "extern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_memory",
          "args": [
            "&conf->real_memory_size"
          ],
          "line": 985
        },
        "resolved": true,
        "details": {
          "function_name": "get_memory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "171-204",
          "snippet": "extern int\nget_memory(uint32_t *real_memory)\n{\n#ifdef HAVE__SYSTEM_CONFIGURATION\n\t*real_memory = _system_configuration.physmem / (1024 * 1024);\n#else\n#  ifdef _SC_PHYS_PAGES\n\tlong pages;\n\n\t*real_memory = 1;\n\tpages = sysconf(_SC_PHYS_PAGES);\n\tif (pages < 1) {\n\t\terror (\"get_memory: error running sysconf(_SC_PHYS_PAGES)\");\n\t\treturn EINVAL;\n\t}\n\t*real_memory = (uint32_t)((float)pages * (sysconf(_SC_PAGE_SIZE) /\n\t\t\t1048576.0)); /* Megabytes of memory */\n#  else  /* !_SC_PHYS_PAGES */\n#    if HAVE_SYSCTLBYNAME\n\tint mem;\n\tsize_t len = sizeof(mem);\n\tif (sysctlbyname(\"hw.physmem\", &mem, &len, NULL, 0) == -1) {\n\t\terror(\"get_memory: error running sysctl(HW_PHYSMEM)\");\n\t\treturn EINVAL;\n\t}\n\t*real_memory = mem;\n#    else /* !HAVE_SYSCTLBYNAME */\n\t*real_memory = 1;\n#    endif /* HAVE_SYSCTLBYNAME */\n#  endif /* _SC_PHYS_PAGES */\n#endif /* HAVE__SYSTEM_CONFIGURATION */\n\n\treturn 0;\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int\nget_memory(uint32_t *real_memory)\n{\n#ifdef HAVE__SYSTEM_CONFIGURATION\n\t*real_memory = _system_configuration.physmem / (1024 * 1024);\n#else\n#  ifdef _SC_PHYS_PAGES\n\tlong pages;\n\n\t*real_memory = 1;\n\tpages = sysconf(_SC_PHYS_PAGES);\n\tif (pages < 1) {\n\t\terror (\"get_memory: error running sysconf(_SC_PHYS_PAGES)\");\n\t\treturn EINVAL;\n\t}\n\t*real_memory = (uint32_t)((float)pages * (sysconf(_SC_PAGE_SIZE) /\n\t\t\t1048576.0)); /* Megabytes of memory */\n#  else  /* !_SC_PHYS_PAGES */\n#    if HAVE_SYSCTLBYNAME\n\tint mem;\n\tsize_t len = sizeof(mem);\n\tif (sysctlbyname(\"hw.physmem\", &mem, &len, NULL, 0) == -1) {\n\t\terror(\"get_memory: error running sysctl(HW_PHYSMEM)\");\n\t\treturn EINVAL;\n\t}\n\t*real_memory = mem;\n#    else /* !HAVE_SYSCTLBYNAME */\n\t*real_memory = 1;\n#    endif /* HAVE_SYSCTLBYNAME */\n#  endif /* _SC_PHYS_PAGES */\n#endif /* HAVE__SYSTEM_CONFIGURATION */\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"You are using cons_res or gang scheduling with \"\n\t\t\t      \"Fastschedule=0 and node configuration differs \"\n\t\t\t      \"from hardware.  The node configuration used \"\n\t\t\t      \"will be what is in the slurm.conf because of \"\n\t\t\t      \"the bitmaps the slurmctld must create before \"\n\t\t\t      \"the slurmd registers.\\n\"\n\t\t\t      \"   CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t      \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t      \"ThreadsPerCore=%u:%u(hw)\"",
            "conf->cpus",
            "conf->actual_cpus",
            "conf->boards",
            "conf->actual_boards",
            "conf->sockets",
            "conf->actual_sockets",
            "conf->cores",
            "conf->actual_cores",
            "conf->threads",
            "conf->actual_threads"
          ],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Node configuration differs from hardware: \"\n\t\t\t     \"CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t     \"ThreadsPerCore=%u:%u(hw)\"",
            "conf->cpus",
            "conf->actual_cpus",
            "conf->boards",
            "conf->actual_boards",
            "conf->sockets",
            "conf->actual_sockets",
            "conf->cores",
            "conf->actual_cores",
            "conf->threads",
            "conf->actual_threads"
          ],
          "line": 957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Node reconfigured socket/core boundaries \"\n\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw)\"",
            "conf->conf_sockets",
            "conf->actual_sockets",
            "conf->conf_cores",
            "conf->actual_cores"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "task_info_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/slurmstepd_job.c",
          "lines": "647-683",
          "snippet": "extern stepd_step_task_info_t *\ntask_info_create(int taskid, int gtaskid,\n\t\t char *ifname, char *ofname, char *efname)\n{\n\tstepd_step_task_info_t *t = xmalloc(sizeof(stepd_step_task_info_t));\n\n\txassert(taskid >= 0);\n\txassert(gtaskid >= 0);\n\n\tslurm_mutex_init(&t->mutex);\n\tslurm_mutex_lock(&t->mutex);\n\tt->state       = STEPD_STEP_TASK_INIT;\n\tt->id          = taskid;\n\tt->gtid\t       = gtaskid;\n\tt->pid         = (pid_t) -1;\n\tt->ifname      = ifname;\n\tt->ofname      = ofname;\n\tt->efname      = efname;\n\tt->stdin_fd    = -1;\n\tt->to_stdin    = -1;\n\tt->stdout_fd   = -1;\n\tt->from_stdout = -1;\n\tt->stderr_fd   = -1;\n\tt->from_stderr = -1;\n\tt->in          = NULL;\n\tt->out         = NULL;\n\tt->err         = NULL;\n\tt->killed_by_cmd = false;\n\tt->aborted     = false;\n\tt->esent       = false;\n\tt->exited      = false;\n\tt->estatus     = -1;\n\tt->argc\t       = 0;\n\tt->argv\t       = NULL;\n\tslurm_mutex_unlock(&t->mutex);\n\treturn t;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmstepd/multi_prog.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <grp.h>",
            "#  include <string.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void _job_init_task_info(stepd_step_rec_t *job, uint32_t **gtid,\n\t\t\t\tchar *ifname, char *ofname, char *efname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmstepd/multi_prog.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <grp.h>\n#  include <string.h>\n#  include \"config.h\"\n\nstatic void _job_init_task_info(stepd_step_rec_t *job, uint32_t **gtid,\n\t\t\t\tchar *ifname, char *ofname, char *efname);\n\nextern stepd_step_task_info_t *\ntask_info_create(int taskid, int gtaskid,\n\t\t char *ifname, char *ofname, char *efname)\n{\n\tstepd_step_task_info_t *t = xmalloc(sizeof(stepd_step_task_info_t));\n\n\txassert(taskid >= 0);\n\txassert(gtaskid >= 0);\n\n\tslurm_mutex_init(&t->mutex);\n\tslurm_mutex_lock(&t->mutex);\n\tt->state       = STEPD_STEP_TASK_INIT;\n\tt->id          = taskid;\n\tt->gtid\t       = gtaskid;\n\tt->pid         = (pid_t) -1;\n\tt->ifname      = ifname;\n\tt->ofname      = ofname;\n\tt->efname      = efname;\n\tt->stdin_fd    = -1;\n\tt->to_stdin    = -1;\n\tt->stdout_fd   = -1;\n\tt->from_stdout = -1;\n\tt->stderr_fd   = -1;\n\tt->from_stderr = -1;\n\tt->in          = NULL;\n\tt->out         = NULL;\n\tt->err         = NULL;\n\tt->killed_by_cmd = false;\n\tt->aborted     = false;\n\tt->esent       = false;\n\tt->exited      = false;\n\tt->estatus     = -1;\n\tt->argc\t       = 0;\n\tt->argv\t       = NULL;\n\tslurm_mutex_unlock(&t->mutex);\n\treturn t;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_cpuinfo",
          "args": [
            "&conf->actual_cpus",
            "&conf->actual_boards",
            "&conf->actual_sockets",
            "&conf->actual_cores",
            "&conf->actual_threads",
            "&conf->block_map_size",
            "&conf->block_map",
            "&conf->block_map_inv"
          ],
          "line": 894
        },
        "resolved": true,
        "details": {
          "function_name": "get_cpuinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcpuinfo.c",
          "lines": "438-744",
          "snippet": "extern int\nget_cpuinfo(uint16_t *p_cpus, uint16_t *p_boards,\n\t    uint16_t *p_sockets, uint16_t *p_cores, uint16_t *p_threads,\n\t    uint16_t *p_block_map_size,\n\t    uint16_t **p_block_map, uint16_t **p_block_map_inv)\n{\n\tint retval;\n\n\tuint16_t numproc;\n\tuint16_t numcpu\t   = 0;\t\t/* number of cpus seen */\n\tuint16_t numphys   = 0;\t\t/* number of unique \"physical id\"s */\n\tuint16_t numcores  = 0;\t\t/* number of unique \"cores id\"s */\n\n\tuint16_t maxsibs   = 0;\t\t/* maximum value of \"siblings\" */\n\tuint16_t maxcores  = 0;\t\t/* maximum value of \"cores\" */\n\tuint16_t minsibs   = 0xffff;\t/* minimum value of \"siblings\" */\n\tuint16_t mincores  = 0xffff;\t/* minimum value of \"cores\" */\n\n\tuint32_t maxcpuid  = 0;\t\t/* maximum CPU ID (\"processor\") */\n\tuint32_t maxphysid = 0;\t\t/* maximum \"physical id\" */\n\tuint32_t maxcoreid = 0;\t\t/* maximum \"core id\" */\n\tuint32_t mincpuid  = 0xffffffff;/* minimum CPU ID (\"processor\") */\n\tuint32_t minphysid = 0xffffffff;/* minimum \"physical id\" */\n\tuint32_t mincoreid = 0xffffffff;/* minimum \"core id\" */\n\tint i;\n#if defined (__sun)\n#if defined (_LP64)\n\tint64_t curcpu, val, sockets, cores, threads;\n#else\n\tint32_t curcpu, val, sockets, cores, threads;\n#endif\n\tint32_t chip_id, core_id, ncore_per_chip, ncpu_per_chip;\n#else\n\tFILE *cpu_info_file;\n\tchar buffer[128];\n\tuint16_t curcpu, sockets, cores, threads;\n#endif\n\n\tget_procs(&numproc);\n\t*p_cpus = numproc;\n\t*p_boards = 1;\t\t/* Boards not identified from /proc/cpuinfo */\n\t*p_sockets = numproc;\t/* initially all single core/thread */\n\t*p_cores   = 1;\n\t*p_threads = 1;\n\t*p_block_map_size = 0;\n\t*p_block_map      = NULL;\n\t*p_block_map_inv  = NULL;\n\n#if defined (__sun)\n\tkstat_ctl_t   *kc;\n\tkstat_t       *ksp;\n\tkstat_named_t *knp;\n\n\tkc = kstat_open();\n\tif (kc == NULL) {\n\t\terror (\"get speed: kstat error %d\", errno);\n\t\treturn errno;\n\t}\n#else\n\tcpu_info_file = fopen(_cpuinfo_path, \"r\");\n\tif (cpu_info_file == NULL) {\n\t\terror (\"get_cpuinfo: error %d opening %s\",\n\t\t\terrno, _cpuinfo_path);\n\t\treturn errno;\n\t}\n#endif\n\n\t/* Note: assumes all processor IDs are within [0:numproc-1] */\n\t/*       treats physical/core IDs as tokens, not indices */\n\tif (cpuinfo)\n\t\tmemset(cpuinfo, 0, numproc * sizeof(cpuinfo_t));\n\telse\n\t\tcpuinfo = xmalloc(numproc * sizeof(cpuinfo_t));\n\n#if defined (__sun)\n\tksp = kstat_lookup(kc, \"cpu_info\", -1, NULL);\n\tfor (; ksp != NULL; ksp = ksp->ks_next) {\n\t\tif (xstrcmp(ksp->ks_module, \"cpu_info\"))\n\t\t\tcontinue;\n\n\t\tnumcpu++;\n\t\tkstat_read(kc, ksp, NULL);\n\n\t\tknp = kstat_data_lookup(ksp, \"chip_id\");\n\t\tchip_id = knp->value.l;\n\t\tknp = kstat_data_lookup(ksp, \"core_id\");\n\t\tcore_id = knp->value.l;\n\t\tknp = kstat_data_lookup(ksp, \"ncore_per_chip\");\n\t\tncore_per_chip = knp->value.l;\n\t\tknp = kstat_data_lookup(ksp, \"ncpu_per_chip\");\n\t\tncpu_per_chip = knp->value.l;\n\n\t\tif (chip_id >= numproc) {\n\t\t\tdebug(\"cpuid is %ld (> %d), ignored\", curcpu, numproc);\n\t\t\tcontinue;\n\t\t}\n\n\t\tcpuinfo[chip_id].seen = 1;\n\t\tcpuinfo[chip_id].cpuid = chip_id;\n\n\t\tmaxcpuid = MAX(maxcpuid, chip_id);\n\t\tmincpuid = MIN(mincpuid, chip_id);\n\n\t\tfor (i = 0; i < numproc; i++) {\n\t\t\tif ((cpuinfo[i].coreid == core_id) &&\n\t\t\t    (cpuinfo[i].corecnt))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i == numproc) {\n\t\t\tnumcores++;\n\t\t} else {\n\t\t\tcpuinfo[i].corecnt++;\n\t\t}\n\n\t\tif (chip_id < numproc) {\n\t\t\tcpuinfo[chip_id].corecnt++;\n\t\t\tcpuinfo[chip_id].coreid = core_id;\n\t\t}\n\n\t\tmaxcoreid = MAX(maxcoreid, core_id);\n\t\tmincoreid = MIN(mincoreid, core_id);\n\n\t\tif (ncore_per_chip > numproc) {\n\t\t\tdebug(\"cores is %u (> %d), ignored\",\n\t\t\t      ncore_per_chip, numproc);\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tif (chip_id < numproc)\n\t\t\tcpuinfo[chip_id].cores = ncore_per_chip;\n\n\t\tmaxcores = MAX(maxcores, ncore_per_chip);\n\t\tmincores = MIN(mincores, ncore_per_chip);\n\t}\n#else\n\n\tcurcpu = 0;\n\twhile (fgets(buffer, sizeof(buffer), cpu_info_file) != NULL) {\n\t\tuint32_t val;\n\t\tif (_chk_cpuinfo_uint32(buffer, \"processor\", &val)) {\n\t\t\tcurcpu = numcpu;\n\t\t\tnumcpu++;\n\t\t\tif (curcpu >= numproc) {\n\t\t\t\tinfo(\"processor limit reached (%u >= %d)\",\n\t\t\t\t     curcpu, numproc);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tcpuinfo[curcpu].seen = 1;\n\t\t\tcpuinfo[curcpu].cpuid = val;\n\t\t\tmaxcpuid = MAX(maxcpuid, val);\n\t\t\tmincpuid = MIN(mincpuid, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"physical id\", &val)) {\n\t\t\t/* see if the ID has already been seen */\n\t\t\tfor (i=0; i<numproc; i++) {\n\t\t\t\tif ((cpuinfo[i].physid == val)\n\t\t\t\t&&  (cpuinfo[i].physcnt))\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (i == numproc) {\t\t/* new ID... */\n\t\t\t\tnumphys++;\t\t/* ...increment total */\n\t\t\t} else {\t\t\t/* existing ID... */\n\t\t\t\tcpuinfo[i].physcnt++;\t/* ...update ID cnt */\n\t\t\t}\n\n\t\t\tif (curcpu < numproc) {\n\t\t\t\tcpuinfo[curcpu].physcnt++;\n\t\t\t\tcpuinfo[curcpu].physid = val;\n\t\t\t}\n\n\t\t\tmaxphysid = MAX(maxphysid, val);\n\t\t\tminphysid = MIN(minphysid, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"core id\", &val)) {\n\t\t\t/* see if the ID has already been seen */\n\t\t\tfor (i = 0; i < numproc; i++) {\n\t\t\t\tif ((cpuinfo[i].coreid == val)\n\t\t\t\t&&  (cpuinfo[i].corecnt))\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (i == numproc) {\t\t/* new ID... */\n\t\t\t\tnumcores++;\t\t/* ...increment total */\n\t\t\t} else {\t\t\t/* existing ID... */\n\t\t\t\tcpuinfo[i].corecnt++;\t/* ...update ID cnt */\n\t\t\t}\n\n\t\t\tif (curcpu < numproc) {\n\t\t\t\tcpuinfo[curcpu].corecnt++;\n\t\t\t\tcpuinfo[curcpu].coreid = val;\n\t\t\t}\n\n\t\t\tmaxcoreid = MAX(maxcoreid, val);\n\t\t\tmincoreid = MIN(mincoreid, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"siblings\", &val)) {\n\t\t\t/* Note: this value is a count, not an index */\n\t\t    \tif (val > numproc) {\t/* out of bounds, ignore */\n\t\t\t\tdebug(\"siblings is %u (> %d), ignored\",\n\t\t\t\t\tval, numproc);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (curcpu < numproc)\n\t\t\t\tcpuinfo[curcpu].siblings = val;\n\t\t\tmaxsibs = MAX(maxsibs, val);\n\t\t\tminsibs = MIN(minsibs, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"cpu cores\", &val)) {\n\t\t\t/* Note: this value is a count, not an index */\n\t\t    \tif (val > numproc) {\t/* out of bounds, ignore */\n\t\t\t\tdebug(\"cores is %u (> %d), ignored\",\n\t\t\t\t\tval, numproc);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (curcpu < numproc)\n\t\t\t\tcpuinfo[curcpu].cores = val;\n\t\t\tmaxcores = MAX(maxcores, val);\n\t\t\tmincores = MIN(mincores, val);\n\t\t}\n\t}\n\n\tfclose(cpu_info_file);\n#endif\n\n\t/*** Sanity check ***/\n\tif (minsibs == 0) minsibs = 1;\t\t/* guaranteee non-zero */\n\tif (maxsibs == 0) {\n\t    \tminsibs = 1;\n\t    \tmaxsibs = 1;\n\t}\n\tif (maxcores == 0) {\t\t\t/* no core data */\n\t    \tmincores = 0;\n\t    \tmaxcores = 0;\n\t}\n\n\t/*** Compute Sockets/Cores/Threads ***/\n\tif ((minsibs == maxsibs) &&\t\t/* homogeneous system */\n\t    (mincores == maxcores)) {\n\t\tsockets = numphys; \t\t/* unique \"physical id\" */\n\t\tif (sockets <= 1) {\t\t/* verify single socket */\n\t\t\tsockets = numcpu / maxsibs; /* maximum \"siblings\" */\n\t\t}\n\t\tif (sockets == 0)\n\t\t\tsockets = 1;\t\t/* guarantee non-zero */\n\n\t\tcores = numcores / sockets;\t/* unique \"core id\" */\n\t\tcores = MAX(maxcores, cores);\t/* maximum \"cpu cores\" */\n\n\t\tif (cores == 0) {\n\t\t\tcores = numcpu / sockets;\t/* assume multi-core */\n\t\t\tif (cores > 1) {\n\t\t\t\tdebug3(\"Warning: cpuinfo missing 'core id' or \"\n\t\t\t\t\t\"'cpu cores' but assuming multi-core\");\n\t\t\t}\n\t\t}\n\t\tif (cores == 0)\n\t\t\tcores = 1;\t/* guarantee non-zero */\n\n\t\tthreads = numcpu / (sockets * cores); /* solve for threads */\n\t\tif (threads == 0)\n\t\t\tthreads = 1;\t/* guarantee non-zero */\n\t} else {\t\t\t\t/* heterogeneous system */\n\t\tsockets = numcpu;\n\t\tcores   = 1;\t\t\t/* one core per socket */\n\t\tthreads = 1;\t\t\t/* one core per core */\n\t}\n\n\t*p_sockets = sockets;\t\t/* update output parameters */\n\t*p_cores   = cores;\n\t*p_threads = threads;\n\n#if _DEBUG\n\t/*** Display raw data ***/\n\tdebug3(\"numcpu:     %u\", numcpu);\n\tdebug3(\"numphys:    %u\", numphys);\n\tdebug3(\"numcores:   %u\", numcores);\n\n\tdebug3(\"cores:      %u->%u\", mincores, maxcores);\n\tdebug3(\"sibs:       %u->%u\", minsibs,  maxsibs);\n\n\tdebug3(\"cpuid:      %u->%u\", mincpuid,  maxcpuid);\n\tdebug3(\"physid:     %u->%u\", minphysid, maxphysid);\n\tdebug3(\"coreid:     %u->%u\", mincoreid, maxcoreid);\n\n\tfor (i = 0; i < numproc; i++) {\n\t\tdebug3(\"CPU %d:\", i);\n\t\tdebug3(\" cpuid:    %u\", cpuinfo[i].cpuid);\n\t\tdebug3(\" seen:     %u\", cpuinfo[i].seen);\n\t\tdebug3(\" physid:   %u\", cpuinfo[i].physid);\n\t\tdebug3(\" physcnt:  %u\", cpuinfo[i].physcnt);\n\t\tdebug3(\" siblings: %u\", cpuinfo[i].siblings);\n\t\tdebug3(\" cores:    %u\", cpuinfo[i].cores);\n\t\tdebug3(\" coreid:   %u\", cpuinfo[i].coreid);\n\t\tdebug3(\" corecnt:  %u\\n\", cpuinfo[i].corecnt);\n\t}\n\n\tdebug3(\"Sockets:          %u\", sockets);\n\tdebug3(\"Cores per socket: %u\", cores);\n\tdebug3(\"Threads per core: %u\", threads);\n#endif\n\n\t*p_block_map_size = numcpu;\n\tretval = _compute_block_map(*p_block_map_size, p_block_map,\n\t\t\t\t    p_block_map_inv);\n\n\txfree(cpuinfo);\t\t/* done with raw cpuinfo data */\n\n\treturn retval;\n}",
          "includes": [
            "#include \"xcpuinfo.h\"",
            "#include <hwloc.h>",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <ctype.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define _DEBUG 0"
          ],
          "globals_used": [
            "uint16_t procs, boards, sockets, cores, threads=1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcpuinfo.h\"\n#include <hwloc.h>\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <ctype.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define _DEBUG 0\n\nuint16_t procs, boards, sockets, cores, threads=1;\n\nextern int\nget_cpuinfo(uint16_t *p_cpus, uint16_t *p_boards,\n\t    uint16_t *p_sockets, uint16_t *p_cores, uint16_t *p_threads,\n\t    uint16_t *p_block_map_size,\n\t    uint16_t **p_block_map, uint16_t **p_block_map_inv)\n{\n\tint retval;\n\n\tuint16_t numproc;\n\tuint16_t numcpu\t   = 0;\t\t/* number of cpus seen */\n\tuint16_t numphys   = 0;\t\t/* number of unique \"physical id\"s */\n\tuint16_t numcores  = 0;\t\t/* number of unique \"cores id\"s */\n\n\tuint16_t maxsibs   = 0;\t\t/* maximum value of \"siblings\" */\n\tuint16_t maxcores  = 0;\t\t/* maximum value of \"cores\" */\n\tuint16_t minsibs   = 0xffff;\t/* minimum value of \"siblings\" */\n\tuint16_t mincores  = 0xffff;\t/* minimum value of \"cores\" */\n\n\tuint32_t maxcpuid  = 0;\t\t/* maximum CPU ID (\"processor\") */\n\tuint32_t maxphysid = 0;\t\t/* maximum \"physical id\" */\n\tuint32_t maxcoreid = 0;\t\t/* maximum \"core id\" */\n\tuint32_t mincpuid  = 0xffffffff;/* minimum CPU ID (\"processor\") */\n\tuint32_t minphysid = 0xffffffff;/* minimum \"physical id\" */\n\tuint32_t mincoreid = 0xffffffff;/* minimum \"core id\" */\n\tint i;\n#if defined (__sun)\n#if defined (_LP64)\n\tint64_t curcpu, val, sockets, cores, threads;\n#else\n\tint32_t curcpu, val, sockets, cores, threads;\n#endif\n\tint32_t chip_id, core_id, ncore_per_chip, ncpu_per_chip;\n#else\n\tFILE *cpu_info_file;\n\tchar buffer[128];\n\tuint16_t curcpu, sockets, cores, threads;\n#endif\n\n\tget_procs(&numproc);\n\t*p_cpus = numproc;\n\t*p_boards = 1;\t\t/* Boards not identified from /proc/cpuinfo */\n\t*p_sockets = numproc;\t/* initially all single core/thread */\n\t*p_cores   = 1;\n\t*p_threads = 1;\n\t*p_block_map_size = 0;\n\t*p_block_map      = NULL;\n\t*p_block_map_inv  = NULL;\n\n#if defined (__sun)\n\tkstat_ctl_t   *kc;\n\tkstat_t       *ksp;\n\tkstat_named_t *knp;\n\n\tkc = kstat_open();\n\tif (kc == NULL) {\n\t\terror (\"get speed: kstat error %d\", errno);\n\t\treturn errno;\n\t}\n#else\n\tcpu_info_file = fopen(_cpuinfo_path, \"r\");\n\tif (cpu_info_file == NULL) {\n\t\terror (\"get_cpuinfo: error %d opening %s\",\n\t\t\terrno, _cpuinfo_path);\n\t\treturn errno;\n\t}\n#endif\n\n\t/* Note: assumes all processor IDs are within [0:numproc-1] */\n\t/*       treats physical/core IDs as tokens, not indices */\n\tif (cpuinfo)\n\t\tmemset(cpuinfo, 0, numproc * sizeof(cpuinfo_t));\n\telse\n\t\tcpuinfo = xmalloc(numproc * sizeof(cpuinfo_t));\n\n#if defined (__sun)\n\tksp = kstat_lookup(kc, \"cpu_info\", -1, NULL);\n\tfor (; ksp != NULL; ksp = ksp->ks_next) {\n\t\tif (xstrcmp(ksp->ks_module, \"cpu_info\"))\n\t\t\tcontinue;\n\n\t\tnumcpu++;\n\t\tkstat_read(kc, ksp, NULL);\n\n\t\tknp = kstat_data_lookup(ksp, \"chip_id\");\n\t\tchip_id = knp->value.l;\n\t\tknp = kstat_data_lookup(ksp, \"core_id\");\n\t\tcore_id = knp->value.l;\n\t\tknp = kstat_data_lookup(ksp, \"ncore_per_chip\");\n\t\tncore_per_chip = knp->value.l;\n\t\tknp = kstat_data_lookup(ksp, \"ncpu_per_chip\");\n\t\tncpu_per_chip = knp->value.l;\n\n\t\tif (chip_id >= numproc) {\n\t\t\tdebug(\"cpuid is %ld (> %d), ignored\", curcpu, numproc);\n\t\t\tcontinue;\n\t\t}\n\n\t\tcpuinfo[chip_id].seen = 1;\n\t\tcpuinfo[chip_id].cpuid = chip_id;\n\n\t\tmaxcpuid = MAX(maxcpuid, chip_id);\n\t\tmincpuid = MIN(mincpuid, chip_id);\n\n\t\tfor (i = 0; i < numproc; i++) {\n\t\t\tif ((cpuinfo[i].coreid == core_id) &&\n\t\t\t    (cpuinfo[i].corecnt))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i == numproc) {\n\t\t\tnumcores++;\n\t\t} else {\n\t\t\tcpuinfo[i].corecnt++;\n\t\t}\n\n\t\tif (chip_id < numproc) {\n\t\t\tcpuinfo[chip_id].corecnt++;\n\t\t\tcpuinfo[chip_id].coreid = core_id;\n\t\t}\n\n\t\tmaxcoreid = MAX(maxcoreid, core_id);\n\t\tmincoreid = MIN(mincoreid, core_id);\n\n\t\tif (ncore_per_chip > numproc) {\n\t\t\tdebug(\"cores is %u (> %d), ignored\",\n\t\t\t      ncore_per_chip, numproc);\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tif (chip_id < numproc)\n\t\t\tcpuinfo[chip_id].cores = ncore_per_chip;\n\n\t\tmaxcores = MAX(maxcores, ncore_per_chip);\n\t\tmincores = MIN(mincores, ncore_per_chip);\n\t}\n#else\n\n\tcurcpu = 0;\n\twhile (fgets(buffer, sizeof(buffer), cpu_info_file) != NULL) {\n\t\tuint32_t val;\n\t\tif (_chk_cpuinfo_uint32(buffer, \"processor\", &val)) {\n\t\t\tcurcpu = numcpu;\n\t\t\tnumcpu++;\n\t\t\tif (curcpu >= numproc) {\n\t\t\t\tinfo(\"processor limit reached (%u >= %d)\",\n\t\t\t\t     curcpu, numproc);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tcpuinfo[curcpu].seen = 1;\n\t\t\tcpuinfo[curcpu].cpuid = val;\n\t\t\tmaxcpuid = MAX(maxcpuid, val);\n\t\t\tmincpuid = MIN(mincpuid, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"physical id\", &val)) {\n\t\t\t/* see if the ID has already been seen */\n\t\t\tfor (i=0; i<numproc; i++) {\n\t\t\t\tif ((cpuinfo[i].physid == val)\n\t\t\t\t&&  (cpuinfo[i].physcnt))\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (i == numproc) {\t\t/* new ID... */\n\t\t\t\tnumphys++;\t\t/* ...increment total */\n\t\t\t} else {\t\t\t/* existing ID... */\n\t\t\t\tcpuinfo[i].physcnt++;\t/* ...update ID cnt */\n\t\t\t}\n\n\t\t\tif (curcpu < numproc) {\n\t\t\t\tcpuinfo[curcpu].physcnt++;\n\t\t\t\tcpuinfo[curcpu].physid = val;\n\t\t\t}\n\n\t\t\tmaxphysid = MAX(maxphysid, val);\n\t\t\tminphysid = MIN(minphysid, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"core id\", &val)) {\n\t\t\t/* see if the ID has already been seen */\n\t\t\tfor (i = 0; i < numproc; i++) {\n\t\t\t\tif ((cpuinfo[i].coreid == val)\n\t\t\t\t&&  (cpuinfo[i].corecnt))\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (i == numproc) {\t\t/* new ID... */\n\t\t\t\tnumcores++;\t\t/* ...increment total */\n\t\t\t} else {\t\t\t/* existing ID... */\n\t\t\t\tcpuinfo[i].corecnt++;\t/* ...update ID cnt */\n\t\t\t}\n\n\t\t\tif (curcpu < numproc) {\n\t\t\t\tcpuinfo[curcpu].corecnt++;\n\t\t\t\tcpuinfo[curcpu].coreid = val;\n\t\t\t}\n\n\t\t\tmaxcoreid = MAX(maxcoreid, val);\n\t\t\tmincoreid = MIN(mincoreid, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"siblings\", &val)) {\n\t\t\t/* Note: this value is a count, not an index */\n\t\t    \tif (val > numproc) {\t/* out of bounds, ignore */\n\t\t\t\tdebug(\"siblings is %u (> %d), ignored\",\n\t\t\t\t\tval, numproc);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (curcpu < numproc)\n\t\t\t\tcpuinfo[curcpu].siblings = val;\n\t\t\tmaxsibs = MAX(maxsibs, val);\n\t\t\tminsibs = MIN(minsibs, val);\n\t\t} else if (_chk_cpuinfo_uint32(buffer, \"cpu cores\", &val)) {\n\t\t\t/* Note: this value is a count, not an index */\n\t\t    \tif (val > numproc) {\t/* out of bounds, ignore */\n\t\t\t\tdebug(\"cores is %u (> %d), ignored\",\n\t\t\t\t\tval, numproc);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (curcpu < numproc)\n\t\t\t\tcpuinfo[curcpu].cores = val;\n\t\t\tmaxcores = MAX(maxcores, val);\n\t\t\tmincores = MIN(mincores, val);\n\t\t}\n\t}\n\n\tfclose(cpu_info_file);\n#endif\n\n\t/*** Sanity check ***/\n\tif (minsibs == 0) minsibs = 1;\t\t/* guaranteee non-zero */\n\tif (maxsibs == 0) {\n\t    \tminsibs = 1;\n\t    \tmaxsibs = 1;\n\t}\n\tif (maxcores == 0) {\t\t\t/* no core data */\n\t    \tmincores = 0;\n\t    \tmaxcores = 0;\n\t}\n\n\t/*** Compute Sockets/Cores/Threads ***/\n\tif ((minsibs == maxsibs) &&\t\t/* homogeneous system */\n\t    (mincores == maxcores)) {\n\t\tsockets = numphys; \t\t/* unique \"physical id\" */\n\t\tif (sockets <= 1) {\t\t/* verify single socket */\n\t\t\tsockets = numcpu / maxsibs; /* maximum \"siblings\" */\n\t\t}\n\t\tif (sockets == 0)\n\t\t\tsockets = 1;\t\t/* guarantee non-zero */\n\n\t\tcores = numcores / sockets;\t/* unique \"core id\" */\n\t\tcores = MAX(maxcores, cores);\t/* maximum \"cpu cores\" */\n\n\t\tif (cores == 0) {\n\t\t\tcores = numcpu / sockets;\t/* assume multi-core */\n\t\t\tif (cores > 1) {\n\t\t\t\tdebug3(\"Warning: cpuinfo missing 'core id' or \"\n\t\t\t\t\t\"'cpu cores' but assuming multi-core\");\n\t\t\t}\n\t\t}\n\t\tif (cores == 0)\n\t\t\tcores = 1;\t/* guarantee non-zero */\n\n\t\tthreads = numcpu / (sockets * cores); /* solve for threads */\n\t\tif (threads == 0)\n\t\t\tthreads = 1;\t/* guarantee non-zero */\n\t} else {\t\t\t\t/* heterogeneous system */\n\t\tsockets = numcpu;\n\t\tcores   = 1;\t\t\t/* one core per socket */\n\t\tthreads = 1;\t\t\t/* one core per core */\n\t}\n\n\t*p_sockets = sockets;\t\t/* update output parameters */\n\t*p_cores   = cores;\n\t*p_threads = threads;\n\n#if _DEBUG\n\t/*** Display raw data ***/\n\tdebug3(\"numcpu:     %u\", numcpu);\n\tdebug3(\"numphys:    %u\", numphys);\n\tdebug3(\"numcores:   %u\", numcores);\n\n\tdebug3(\"cores:      %u->%u\", mincores, maxcores);\n\tdebug3(\"sibs:       %u->%u\", minsibs,  maxsibs);\n\n\tdebug3(\"cpuid:      %u->%u\", mincpuid,  maxcpuid);\n\tdebug3(\"physid:     %u->%u\", minphysid, maxphysid);\n\tdebug3(\"coreid:     %u->%u\", mincoreid, maxcoreid);\n\n\tfor (i = 0; i < numproc; i++) {\n\t\tdebug3(\"CPU %d:\", i);\n\t\tdebug3(\" cpuid:    %u\", cpuinfo[i].cpuid);\n\t\tdebug3(\" seen:     %u\", cpuinfo[i].seen);\n\t\tdebug3(\" physid:   %u\", cpuinfo[i].physid);\n\t\tdebug3(\" physcnt:  %u\", cpuinfo[i].physcnt);\n\t\tdebug3(\" siblings: %u\", cpuinfo[i].siblings);\n\t\tdebug3(\" cores:    %u\", cpuinfo[i].cores);\n\t\tdebug3(\" coreid:   %u\", cpuinfo[i].coreid);\n\t\tdebug3(\" corecnt:  %u\\n\", cpuinfo[i].corecnt);\n\t}\n\n\tdebug3(\"Sockets:          %u\", sockets);\n\tdebug3(\"Cores per socket: %u\", cores);\n\tdebug3(\"Threads per core: %u\", threads);\n#endif\n\n\t*p_block_map_size = numcpu;\n\tretval = _compute_block_map(*p_block_map_size, p_block_map,\n\t\t\t\t    p_block_map_inv);\n\n\txfree(cpuinfo);\t\t/* done with raw cpuinfo data */\n\n\treturn retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_update_nice",
          "args": [],
          "line": 892
        },
        "resolved": true,
        "details": {
          "function_name": "_update_nice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1959-1973",
          "snippet": "static void _update_nice(void)\n{\n\tint cur_nice;\n\tid_t pid;\n\n\tif (conf->nice == 0)\t/* No change */\n\t\treturn;\n\n\tpid = getpid();\n\tcur_nice = getpriority(PRIO_PROCESS, pid);\n\tif (cur_nice == conf->nice)\n\t\treturn;\n\tif (setpriority(PRIO_PROCESS, pid, conf->nice))\n\t\terror(\"Unable to reset nice value to %d: %m\", conf->nice);\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _update_nice(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _update_nice(void);\n\nstatic void _update_nice(void)\n{\n\tint cur_nice;\n\tid_t pid;\n\n\tif (conf->nice == 0)\t/* No change */\n\t\treturn;\n\n\tpid = getpid();\n\tcur_nice = getpriority(PRIO_PROCESS, pid);\n\tif (cur_nice == conf->nice)\n\t\treturn;\n\tif (setpriority(PRIO_PROCESS, pid, conf->nice))\n\t\terror(\"Unable to reset nice value to %d: %m\", conf->nice);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_update_logging",
          "args": [],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "_update_logging",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1911-1956",
          "snippet": "static void _update_logging(void)\n{\n\tlog_options_t *o = &conf->log_opts;\n\tslurm_ctl_conf_t *cf;\n\n\t/* Preserve execute line verbose arguments (if any) */\n\tcf = slurm_conf_lock();\n\tif (!conf->debug_level_set && (cf->slurmd_debug != (uint16_t) NO_VAL))\n\t\tconf->debug_level = cf->slurmd_debug;\n\tconf->log_fmt = cf->log_fmt;\n\tslurm_conf_unlock();\n\n\to->stderr_level  = conf->debug_level;\n\to->logfile_level = conf->debug_level;\n\to->syslog_level  = conf->debug_level;\n\n\t/*\n\t * If daemonizing, turn off stderr logging -- also, if\n\t * logging to a file, turn off syslog.\n\t *\n\t * Otherwise, if remaining in foreground, turn off logging\n\t * to syslog (but keep logfile level)\n\t */\n\tif (conf->daemonize) {\n\t\to->stderr_level = LOG_LEVEL_QUIET;\n\t\tif (conf->logfile)\n\t\t\to->syslog_level = LOG_LEVEL_FATAL;\n\t} else\n\t\to->syslog_level  = LOG_LEVEL_QUIET;\n\n\tlog_alter(conf->log_opts, SYSLOG_FACILITY_DAEMON, conf->logfile);\n\tlog_set_timefmt(conf->log_fmt);\n\n\t/* If logging to syslog and running in\n\t * MULTIPLE_SLURMD mode add my node_name\n\t * in the name tag for syslog.\n\t */\n#if defined(MULTIPLE_SLURMD)\n\tif (conf->logfile == NULL) {\n\t\tchar buf[64];\n\n\t\tsnprintf(buf, sizeof(buf), \"slurmd-%s\", conf->node_name);\n\t\tlog_set_argv0(buf);\n\t}\n#endif\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _update_logging(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _update_logging(void);\n\nstatic void _update_logging(void)\n{\n\tlog_options_t *o = &conf->log_opts;\n\tslurm_ctl_conf_t *cf;\n\n\t/* Preserve execute line verbose arguments (if any) */\n\tcf = slurm_conf_lock();\n\tif (!conf->debug_level_set && (cf->slurmd_debug != (uint16_t) NO_VAL))\n\t\tconf->debug_level = cf->slurmd_debug;\n\tconf->log_fmt = cf->log_fmt;\n\tslurm_conf_unlock();\n\n\to->stderr_level  = conf->debug_level;\n\to->logfile_level = conf->debug_level;\n\to->syslog_level  = conf->debug_level;\n\n\t/*\n\t * If daemonizing, turn off stderr logging -- also, if\n\t * logging to a file, turn off syslog.\n\t *\n\t * Otherwise, if remaining in foreground, turn off logging\n\t * to syslog (but keep logfile level)\n\t */\n\tif (conf->daemonize) {\n\t\to->stderr_level = LOG_LEVEL_QUIET;\n\t\tif (conf->logfile)\n\t\t\to->syslog_level = LOG_LEVEL_FATAL;\n\t} else\n\t\to->syslog_level  = LOG_LEVEL_QUIET;\n\n\tlog_alter(conf->log_opts, SYSLOG_FACILITY_DAEMON, conf->logfile);\n\tlog_set_timefmt(conf->log_fmt);\n\n\t/* If logging to syslog and running in\n\t * MULTIPLE_SLURMD mode add my node_name\n\t * in the name tag for syslog.\n\t */\n#if defined(MULTIPLE_SLURMD)\n\tif (conf->logfile == NULL) {\n\t\tchar buf[64];\n\n\t\tsnprintf(buf, sizeof(buf), \"slurmd-%s\", conf->node_name);\n\t\tlog_set_argv0(buf);\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "conf->block_map_inv"
          ],
          "line": 889
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_conf_get_res_spec_info",
          "args": [
            "conf->node_name",
            "&conf->cpu_spec_list",
            "&conf->core_spec_cnt",
            "&conf->mem_spec_limit"
          ],
          "line": 882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_conf_get_cpus_bsct",
          "args": [
            "conf->node_name",
            "&conf->conf_cpus",
            "&conf->conf_boards",
            "&conf->conf_sockets",
            "&conf->conf_cores",
            "&conf->conf_threads"
          ],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_conf_get_port",
          "args": [
            "conf->node_name"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrcmp",
          "args": [
            "conf->node_addr",
            "conf->hostname"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_conf_get_nodeaddr",
          "args": [
            "conf->hostname"
          ],
          "line": 871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"Unable to determine this slurmd's NodeName\""
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_conf_get_nodename",
          "args": [
            "\"localhost\""
          ],
          "line": 862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_conf_get_aliased_nodename",
          "args": [],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_conf_get_nodename",
          "args": [
            "conf->hostname"
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_conf_unlock",
          "args": [],
          "line": 851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrcmp",
          "args": [
            "cf->select_type",
            "\"select/cray\""
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrcmp",
          "args": [
            "cf->select_type",
            "\"select/cons_res\""
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->slurmd_logfile"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->job_credential_public_certificate"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->slurm_conf"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->chos_loc"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cf->authinfo"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_conf_lock",
          "args": [],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_mutex_lock",
          "args": [
            "&conf->config_mutex"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _read_config(void);\nstatic void      _set_msg_aggr_params(void);\nstatic void      _update_logging(void);\nstatic void      _update_nice(void);\n\nstatic void\n_read_config(void)\n{\n\tchar *path_pubkey = NULL;\n\tslurm_ctl_conf_t *cf = NULL;\n\tint cc;\n#ifndef HAVE_FRONT_END\n\tbool cr_flag = false, gang_flag = false;\n#endif\n\n\tslurm_mutex_lock(&conf->config_mutex);\n\tcf = slurm_conf_lock();\n\n\txfree(conf->auth_info);\n\tconf->auth_info = xstrdup(cf->authinfo);\n\n\txfree(conf->chos_loc);\n\tconf->chos_loc = xstrdup(cf->chos_loc);\n\n\tconf->last_update = time(NULL);\n\n\tif (conf->conffile == NULL)\n\t\tconf->conffile = xstrdup(cf->slurm_conf);\n\n\tconf->slurm_user_id =  cf->slurm_user_id;\n\n\tconf->cr_type = cf->select_type_param;\n\n\tpath_pubkey = xstrdup(cf->job_credential_public_certificate);\n\n\tif (!conf->logfile)\n\t\tconf->logfile = xstrdup(cf->slurmd_logfile);\n\n#ifndef HAVE_FRONT_END\n\tif (!xstrcmp(cf->select_type, \"select/cons_res\"))\n\t\tcr_flag = true;\n\tif (!xstrcmp(cf->select_type, \"select/cray\") &&\n\t    (cf->select_type_param & CR_OTHER_CONS_RES))\n\t\tcr_flag = true;\n\n\tif (cf->preempt_mode & PREEMPT_MODE_GANG)\n\t\tgang_flag = true;\n#endif\n\n\tslurm_conf_unlock();\n\t/* node_name may already be set from a command line parameter */\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_nodename(conf->hostname);\n\t/* if we didn't match the form of the hostname already\n\t * stored in conf->hostname, check to see if we match any\n\t * valid aliases */\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_aliased_nodename();\n\n\tif (conf->node_name == NULL)\n\t\tconf->node_name = slurm_conf_get_nodename(\"localhost\");\n\n\tif (conf->node_name == NULL)\n\t\tfatal(\"Unable to determine this slurmd's NodeName\");\n\n\t_massage_pathname(&conf->logfile);\n\n\t/* set node_addr if relevant */\n\tif ((conf->node_addr == NULL) &&\n\t    (conf->node_addr = slurm_conf_get_nodeaddr(conf->hostname)) &&\n\t    (xstrcmp(conf->node_addr, conf->hostname) == 0)) {\n\t\txfree(conf->node_addr);\t/* Sets to NULL */\n\t}\n\n\tconf->port = slurm_conf_get_port(conf->node_name);\n\tslurm_conf_get_cpus_bsct(conf->node_name,\n\t\t\t\t &conf->conf_cpus, &conf->conf_boards,\n\t\t\t\t &conf->conf_sockets, &conf->conf_cores,\n\t\t\t\t &conf->conf_threads);\n\n\tslurm_conf_get_res_spec_info(conf->node_name,\n\t\t\t\t     &conf->cpu_spec_list,\n\t\t\t\t     &conf->core_spec_cnt,\n\t\t\t\t     &conf->mem_spec_limit);\n\n\t/* store hardware properties in slurmd_config */\n\txfree(conf->block_map);\n\txfree(conf->block_map_inv);\n\n\t_update_logging();\n\t_update_nice();\n\n\tget_cpuinfo(&conf->actual_cpus,\n\t\t    &conf->actual_boards,\n\t            &conf->actual_sockets,\n\t            &conf->actual_cores,\n\t            &conf->actual_threads,\n\t            &conf->block_map_size,\n\t            &conf->block_map, &conf->block_map_inv);\n#ifdef HAVE_FRONT_END\n\t/*\n\t * When running with multiple frontends, the slurmd S:C:T values are not\n\t * relevant, hence ignored by both _register_front_ends (sets all to 1)\n\t * and validate_nodes_via_front_end (uses slurm.conf values).\n\t * Report actual hardware configuration, irrespective of FastSchedule.\n\t */\n\tconf->cpus    = conf->actual_cpus;\n\tconf->boards  = conf->actual_boards;\n\tconf->sockets = conf->actual_sockets;\n\tconf->cores   = conf->actual_cores;\n\tconf->threads = conf->actual_threads;\n#else\n\t/* If the actual resources on a node differ than what is in\n\t * the configuration file and we are using\n\t * cons_res or gang scheduling we have to use what is in the\n\t * configuration file because the slurmctld creates bitmaps\n\t * for scheduling before these nodes check in.\n\t */\n\tif (((cf->fast_schedule == 0) && !cr_flag && !gang_flag) ||\n\t    ((cf->fast_schedule == 1) &&\n\t     (conf->actual_cpus < conf->conf_cpus))) {\n\t\tconf->cpus    = conf->actual_cpus;\n\t\tconf->boards  = conf->actual_boards;\n\t\tconf->sockets = conf->actual_sockets;\n\t\tconf->cores   = conf->actual_cores;\n\t\tconf->threads = conf->actual_threads;\n\t} else if ((cf->fast_schedule == 1) && (cr_flag || gang_flag) &&\n\t\t   (conf->actual_sockets != conf->conf_sockets) &&\n\t\t   (conf->actual_cores != conf->conf_cores) &&\n\t\t   ((conf->actual_sockets * conf->actual_cores) ==\n\t\t    (conf->conf_sockets * conf->conf_cores))) {\n\t\t/* Socket and core count can be changed when KNL node reboots\n\t\t * in a different NUMA configuration */\n\t\tinfo(\"Node reconfigured socket/core boundaries \"\n\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw)\",\n\t\t     conf->conf_sockets, conf->actual_sockets,\n\t\t     conf->conf_cores, conf->actual_cores);\n\t\tconf->cpus    = conf->conf_cpus;\n\t\tconf->boards  = conf->conf_boards;\n\t\tconf->sockets = conf->actual_sockets;\n\t\tconf->cores   = conf->actual_cores;\n\t\tconf->threads = conf->conf_threads;\n\t} else {\n\t\tconf->cpus    = conf->conf_cpus;\n\t\tconf->boards  = conf->conf_boards;\n\t\tconf->sockets = conf->conf_sockets;\n\t\tconf->cores   = conf->conf_cores;\n\t\tconf->threads = conf->conf_threads;\n\t}\n\n\tif ((conf->cpus    != conf->actual_cpus)    ||\n\t    (conf->sockets != conf->actual_sockets) ||\n\t    (conf->cores   != conf->actual_cores)   ||\n\t    (conf->threads != conf->actual_threads)) {\n\t\tif (cf->fast_schedule) {\n\t\t\tinfo(\"Node configuration differs from hardware: \"\n\t\t\t     \"CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t     \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t     \"ThreadsPerCore=%u:%u(hw)\",\n\t\t\t     conf->cpus,    conf->actual_cpus,\n\t\t\t     conf->boards,  conf->actual_boards,\n\t\t\t     conf->sockets, conf->actual_sockets,\n\t\t\t     conf->cores,   conf->actual_cores,\n\t\t\t     conf->threads, conf->actual_threads);\n\t\t} else if ((cf->fast_schedule == 0) && (cr_flag || gang_flag)) {\n\t\t\terror(\"You are using cons_res or gang scheduling with \"\n\t\t\t      \"Fastschedule=0 and node configuration differs \"\n\t\t\t      \"from hardware.  The node configuration used \"\n\t\t\t      \"will be what is in the slurm.conf because of \"\n\t\t\t      \"the bitmaps the slurmctld must create before \"\n\t\t\t      \"the slurmd registers.\\n\"\n\t\t\t      \"   CPUs=%u:%u(hw) Boards=%u:%u(hw) \"\n\t\t\t      \"SocketsPerBoard=%u:%u(hw) CoresPerSocket=%u:%u(hw) \"\n\t\t\t      \"ThreadsPerCore=%u:%u(hw)\",\n\t\t\t      conf->cpus,    conf->actual_cpus,\n\t\t\t      conf->boards,  conf->actual_boards,\n\t\t\t      conf->sockets, conf->actual_sockets,\n\t\t\t      conf->cores,   conf->actual_cores,\n\t\t\t      conf->threads, conf->actual_threads);\n\t\t}\n\t}\n#endif\n\n\tget_memory(&conf->real_memory_size);\n\tget_up_time(&conf->up_time);\n\n\tcf = slurm_conf_lock();\n\tget_tmp_disk(&conf->tmp_disk_space, cf->tmp_fs);\n\t_free_and_set(conf->cluster_name, xstrdup(cf->cluster_name));\n\t_free_and_set(conf->epilog,   xstrdup(cf->epilog));\n\t_free_and_set(conf->prolog,   xstrdup(cf->prolog));\n\t_free_and_set(conf->tmpfs,    xstrdup(cf->tmp_fs));\n\t_free_and_set(conf->health_check_program,\n\t\t      xstrdup(cf->health_check_program));\n\t_free_and_set(conf->spooldir, xstrdup(cf->slurmd_spooldir));\n\t_massage_pathname(&conf->spooldir);\n\t_free_and_set(conf->pidfile,  xstrdup(cf->slurmd_pidfile));\n\t_massage_pathname(&conf->pidfile);\n\t_free_and_set(conf->plugstack,   xstrdup(cf->plugstack));\n\t_free_and_set(conf->select_type, xstrdup(cf->select_type));\n\t_free_and_set(conf->task_prolog, xstrdup(cf->task_prolog));\n\t_free_and_set(conf->task_epilog, xstrdup(cf->task_epilog));\n\t_free_and_set(conf->pubkey,   path_pubkey);\n\n\tconf->debug_flags = cf->debug_flags;\n\tconf->propagate_prio = cf->propagate_prio_process;\n\n\t_free_and_set(conf->job_acct_gather_freq,\n\t\t      xstrdup(cf->job_acct_gather_freq));\n\n\tconf->acct_freq_task = (uint16_t)NO_VAL;\n\tcc = acct_gather_parse_freq(PROFILE_TASK,\n\t\t\t\t    conf->job_acct_gather_freq);\n\tif (cc != -1)\n\t\tconf->acct_freq_task = cc;\n\n\t_free_and_set(conf->acct_gather_energy_type,\n\t\t      xstrdup(cf->acct_gather_energy_type));\n\t_free_and_set(conf->acct_gather_filesystem_type,\n\t\t      xstrdup(cf->acct_gather_filesystem_type));\n\t_free_and_set(conf->acct_gather_infiniband_type,\n\t\t      xstrdup(cf->acct_gather_infiniband_type));\n\t_free_and_set(conf->acct_gather_profile_type,\n\t\t      xstrdup(cf->acct_gather_profile_type));\n\t_free_and_set(conf->job_acct_gather_type,\n\t\t      xstrdup(cf->job_acct_gather_type));\n\t_free_and_set(conf->msg_aggr_params,\n\t\t      xstrdup(cf->msg_aggr_params));\n\t_set_msg_aggr_params();\n\n\tif ( (conf->node_name == NULL) ||\n\t     (conf->node_name[0] == '\\0') )\n\t\tfatal(\"Node name lookup failure\");\n\n\tif (cf->control_addr == NULL)\n\t\tfatal(\"Unable to establish controller machine\");\n\tif (cf->slurmctld_port == 0)\n\t\tfatal(\"Unable to establish controller port\");\n\tconf->slurmd_timeout = cf->slurmd_timeout;\n\tconf->kill_wait = cf->kill_wait;\n\tconf->use_pam = cf->use_pam;\n\tconf->task_plugin_param = cf->task_plugin_param;\n\n\tconf->mem_limit_enforce = cf->mem_limit_enforce;\n\tconf->health_check_interval = cf->health_check_interval;\n\n\tslurm_mutex_unlock(&conf->config_mutex);\n\tslurm_conf_unlock();\n}"
  },
  {
    "function_name": "_massage_pathname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "792-801",
    "snippet": "static void\n_massage_pathname(char **path)\n{\n\tif (path && *path) {\n\t\tif (conf->hostname)\n\t\t\txstrsubstitute(*path, \"%h\", conf->hostname);\n\t\tif (conf->node_name)\n\t\t\txstrsubstitute(*path, \"%n\", conf->node_name);\n\t}\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xstrsubstitute",
          "args": [
            "*path",
            "\"%n\"",
            "conf->node_name"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrsubstitute",
          "args": [
            "*path",
            "\"%h\"",
            "conf->hostname"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\n\nstatic void\n_massage_pathname(char **path)\n{\n\tif (path && *path) {\n\t\tif (conf->hostname)\n\t\t\txstrsubstitute(*path, \"%h\", conf->hostname);\n\t\tif (conf->node_name)\n\t\t\txstrsubstitute(*path, \"%n\", conf->node_name);\n\t}\n}"
  },
  {
    "function_name": "_fill_registration_msg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "657-786",
    "snippet": "static void\n_fill_registration_msg(slurm_node_registration_status_msg_t *msg)\n{\n\tList steps;\n\tListIterator i;\n\tstep_loc_t *stepd;\n\tint  n;\n\tchar *arch, *os;\n\tstruct utsname buf;\n\tstatic bool first_msg = true;\n\tstatic time_t slurmd_start_time = 0;\n\tBuf gres_info;\n\n\tmsg->node_name   = xstrdup (conf->node_name);\n\tmsg->version     = xstrdup (PACKAGE_VERSION);\n\n\tmsg->cpus\t = conf->cpus;\n\tmsg->boards\t = conf->boards;\n\tmsg->sockets\t = conf->sockets;\n\tmsg->cores\t = conf->cores;\n\tmsg->threads\t = conf->threads;\n\tif (res_abs_cpus[0] == '\\0')\n\t\tmsg->cpu_spec_list = NULL;\n\telse\n\t\tmsg->cpu_spec_list = xstrdup (res_abs_cpus);\n\tmsg->real_memory = conf->real_memory_size;\n\tmsg->tmp_disk    = conf->tmp_disk_space;\n\tmsg->hash_val    = slurm_get_hash_val();\n\tget_cpu_load(&msg->cpu_load);\n\tget_free_mem(&msg->free_mem);\n\n\tgres_info = init_buf(1024);\n\tif (gres_plugin_node_config_pack(gres_info) != SLURM_SUCCESS)\n\t\terror(\"error packing gres configuration\");\n\telse\n\t\tmsg->gres_info   = gres_info;\n\n\tget_up_time(&conf->up_time);\n\tmsg->up_time     = conf->up_time;\n\tif (slurmd_start_time == 0)\n\t\tslurmd_start_time = time(NULL);\n\tmsg->slurmd_start_time = slurmd_start_time;\n\n\tnode_features_g_node_state(&msg->features_avail, &msg->features_active);\n\n\tif (first_msg) {\n\t\tfirst_msg = false;\n\t\tinfo(\"CPUs=%u Boards=%u Sockets=%u Cores=%u Threads=%u \"\n\t\t     \"Memory=%u TmpDisk=%u Uptime=%u CPUSpecList=%s \"\n\t\t     \"FeaturesAvail=%s FeaturesActive=%s\",\n\t\t     msg->cpus, msg->boards, msg->sockets, msg->cores,\n\t\t     msg->threads, msg->real_memory, msg->tmp_disk,\n\t\t     msg->up_time, msg->cpu_spec_list, msg->features_avail,\n\t\t     msg->features_active);\n\t} else {\n\t\tdebug3(\"CPUs=%u Boards=%u Sockets=%u Cores=%u Threads=%u \"\n\t\t       \"Memory=%u TmpDisk=%u Uptime=%u CPUSpecList=%s \"\n\t\t       \"FeaturesAvail=%s FeaturesActive=%s\",\n\t\t       msg->cpus, msg->boards, msg->sockets, msg->cores,\n\t\t       msg->threads, msg->real_memory, msg->tmp_disk,\n\t\t       msg->up_time, msg->cpu_spec_list, msg->features_avail,\n\t\t       msg->features_active);\n\t}\n\tuname(&buf);\n\tif ((arch = getenv(\"SLURM_ARCH\")))\n\t\tmsg->arch = xstrdup(arch);\n\telse\n\t\tmsg->arch = xstrdup(buf.machine);\n\tif ((os = getenv(\"SLURM_OS\")))\n\t\tmsg->os   = xstrdup(os);\n\telse\n\t\tmsg->os = xstrdup(buf.sysname);\n\n\tif (msg->startup) {\n\t\tif (switch_g_alloc_node_info(&msg->switch_nodeinfo))\n\t\t\terror(\"switch_g_alloc_node_info: %m\");\n\t\tif (switch_g_build_node_info(msg->switch_nodeinfo))\n\t\t\terror(\"switch_g_build_node_info: %m\");\n\t}\n\n\tsteps = stepd_available(conf->spooldir, conf->node_name);\n\tmsg->job_count = list_count(steps);\n\tmsg->job_id    = xmalloc(msg->job_count * sizeof(*msg->job_id));\n\t/* Note: Running batch jobs will have step_id == NO_VAL */\n\tmsg->step_id   = xmalloc(msg->job_count * sizeof(*msg->step_id));\n\n\ti = list_iterator_create(steps);\n\tn = 0;\n\twhile ((stepd = list_next(i))) {\n\t\tint fd;\n\t\tfd = stepd_connect(stepd->directory, stepd->nodename,\n\t\t\t\t   stepd->jobid, stepd->stepid,\n\t\t\t\t   &stepd->protocol_version);\n\t\tif (fd == -1) {\n\t\t\t--(msg->job_count);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (stepd_state(fd, stepd->protocol_version)\n\t\t    == SLURMSTEPD_NOT_RUNNING) {\n\t\t\tdebug(\"stale domain socket for stepd %u.%u \",\n\t\t\t      stepd->jobid, stepd->stepid);\n\t\t\t--(msg->job_count);\n\t\t\tclose(fd);\n\t\t\tcontinue;\n\t\t}\n\n\t\tclose(fd);\n\t\tif (stepd->stepid == NO_VAL) {\n\t\t\tdebug(\"%s: found apparently running job %u\",\n\t\t\t      __func__, stepd->jobid);\n\t\t} else {\n\t\t\tdebug(\"%s: found apparently running step %u.%u\",\n\t\t\t      __func__, stepd->jobid, stepd->stepid);\n\t\t}\n\t\tmsg->job_id[n]  = stepd->jobid;\n\t\tmsg->step_id[n] = stepd->stepid;\n\t\tn++;\n\t}\n\tlist_iterator_destroy(i);\n\tFREE_NULL_LIST(steps);\n\n\tif (!msg->energy)\n\t\tmsg->energy = acct_gather_energy_alloc(1);\n\tacct_gather_energy_g_get_data(ENERGY_DATA_NODE_ENERGY, msg->energy);\n\n\tmsg->timestamp = time(NULL);\n\n\treturn;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static char\tres_abs_cpus[MAX_CPUSTR];",
      "static void      _fill_registration_msg(slurm_node_registration_status_msg_t *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "time",
          "args": [
            "NULL"
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "get_up_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "274-325",
          "snippet": "extern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "acct_gather_energy_g_get_data",
          "args": [
            "ENERGY_DATA_NODE_ENERGY",
            "msg->energy"
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acct_gather_energy_alloc",
          "args": [
            "1"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FREE_NULL_LIST",
          "args": [
            "steps"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_iterator_destroy",
          "args": [
            "i"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"%s: found apparently running step %u.%u\"",
            "__func__",
            "stepd->jobid",
            "stepd->stepid"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"%s: found apparently running job %u\"",
            "__func__",
            "stepd->jobid"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "_file_bcast_close_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "3635-3640",
          "snippet": "static void _file_bcast_close_file(file_bcast_info_t *key)\n{\n\t_fb_wrlock();\n\tlist_delete_all(file_bcast_list, _bcast_find_in_list, key);\n\t_fb_wrunlock();\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int  _job_limits_match(void *x, void *key);",
            "static int  _step_limits_match(void *x, void *key);",
            "static int  _file_bcast_register_file(slurm_msg_t *msg,\n\t\t\t\t      file_bcast_info_t *key);",
            "static List file_bcast_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic int  _job_limits_match(void *x, void *key);\nstatic int  _step_limits_match(void *x, void *key);\nstatic int  _file_bcast_register_file(slurm_msg_t *msg,\n\t\t\t\t      file_bcast_info_t *key);\nstatic List file_bcast_list = NULL;\n\nstatic void _file_bcast_close_file(file_bcast_info_t *key)\n{\n\t_fb_wrlock();\n\tlist_delete_all(file_bcast_list, _bcast_find_in_list, key);\n\t_fb_wrunlock();\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"stale domain socket for stepd %u.%u \"",
            "stepd->jobid",
            "stepd->stepid"
          ],
          "line": 757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stepd_state",
          "args": [
            "fd",
            "stepd->protocol_version"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stepd_connect",
          "args": [
            "stepd->directory",
            "stepd->nodename",
            "stepd->jobid",
            "stepd->stepid",
            "&stepd->protocol_version"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_next",
          "args": [
            "i"
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_iterator_create",
          "args": [
            "steps"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "msg->job_count * sizeof(*msg->step_id)"
          ],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "msg->job_count * sizeof(*msg->job_id)"
          ],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_count",
          "args": [
            "steps"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stepd_available",
          "args": [
            "conf->spooldir",
            "conf->node_name"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"switch_g_build_node_info: %m\""
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "switch_g_build_node_info",
          "args": [
            "msg->switch_nodeinfo"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"switch_g_alloc_node_info: %m\""
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "switch_g_alloc_node_info",
          "args": [
            "&msg->switch_nodeinfo"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "buf.sysname"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "os"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"SLURM_OS\""
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "buf.machine"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "arch"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"SLURM_ARCH\""
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uname",
          "args": [
            "&buf"
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"CPUs=%u Boards=%u Sockets=%u Cores=%u Threads=%u \"\n\t\t       \"Memory=%u TmpDisk=%u Uptime=%u CPUSpecList=%s \"\n\t\t       \"FeaturesAvail=%s FeaturesActive=%s\"",
            "msg->cpus",
            "msg->boards",
            "msg->sockets",
            "msg->cores",
            "msg->threads",
            "msg->real_memory",
            "msg->tmp_disk",
            "msg->up_time",
            "msg->cpu_spec_list",
            "msg->features_avail",
            "msg->features_active"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"CPUs=%u Boards=%u Sockets=%u Cores=%u Threads=%u \"\n\t\t     \"Memory=%u TmpDisk=%u Uptime=%u CPUSpecList=%s \"\n\t\t     \"FeaturesAvail=%s FeaturesActive=%s\"",
            "msg->cpus",
            "msg->boards",
            "msg->sockets",
            "msg->cores",
            "msg->threads",
            "msg->real_memory",
            "msg->tmp_disk",
            "msg->up_time",
            "msg->cpu_spec_list",
            "msg->features_avail",
            "msg->features_active"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node_features_g_node_state",
          "args": [
            "&msg->features_avail",
            "&msg->features_active"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"error packing gres configuration\""
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gres_plugin_node_config_pack",
          "args": [
            "gres_info"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_buf",
          "args": [
            "1024"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_free_mem",
          "args": [
            "&msg->free_mem"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "get_free_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "365-382",
          "snippet": "extern int get_free_mem(uint32_t *free_mem)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__) || defined(__CYGWIN__)\n\t/* Not sure how to get CPU load on above systems.\n\t * Perhaps some method below works. */\n\t*free_mem = 0;\n#else\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*free_mem = 0;\n\t\treturn errno;\n\t}\n\n\t*free_mem = (((uint64_t )info.freeram)*info.mem_unit)/(1024*1024);\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int get_free_mem(uint32_t *free_mem)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__) || defined(__CYGWIN__)\n\t/* Not sure how to get CPU load on above systems.\n\t * Perhaps some method below works. */\n\t*free_mem = 0;\n#else\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*free_mem = 0;\n\t\treturn errno;\n\t}\n\n\t*free_mem = (((uint64_t )info.freeram)*info.mem_unit)/(1024*1024);\n#endif\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_cpu_load",
          "args": [
            "&msg->cpu_load"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "get_cpu_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "327-363",
          "snippet": "extern int get_cpu_load(uint32_t *cpu_load)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\t/* Not sure how to get CPU load on above systems.\n\t * Perhaps some method below works. */\n\t*cpu_load = 0;\n#elif defined(__CYGWIN__)\n\tFILE *load_file;\n\tchar buffer[128];\n\tchar *space;\n\tchar *_load_path = \"/proc/loadavg\";\n\n\tif (!(load_file = fopen(_load_path, \"r\"))) {\n\t\terror(\"get_cpu_load: error %d opening %s\", errno, _load_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), load_file) &&\n\t    (space = strchr(buffer, ' '))) {\n\t\t*cpu_load = atof(space + 1) * 100.0;\n\t} else\n\t\t*cpu_load = 0;\n\n\tfclose(load_file);\n#else\n\tstruct sysinfo info;\n\tfloat shift_float = (float) (1 << SI_LOAD_SHIFT);\n\n\tif (sysinfo(&info) < 0) {\n\t\t*cpu_load = 0;\n\t\treturn errno;\n\t}\n\n\t*cpu_load = (info.loads[1] / shift_float) * 100.0;\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int get_cpu_load(uint32_t *cpu_load)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\t/* Not sure how to get CPU load on above systems.\n\t * Perhaps some method below works. */\n\t*cpu_load = 0;\n#elif defined(__CYGWIN__)\n\tFILE *load_file;\n\tchar buffer[128];\n\tchar *space;\n\tchar *_load_path = \"/proc/loadavg\";\n\n\tif (!(load_file = fopen(_load_path, \"r\"))) {\n\t\terror(\"get_cpu_load: error %d opening %s\", errno, _load_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), load_file) &&\n\t    (space = strchr(buffer, ' '))) {\n\t\t*cpu_load = atof(space + 1) * 100.0;\n\t} else\n\t\t*cpu_load = 0;\n\n\tfclose(load_file);\n#else\n\tstruct sysinfo info;\n\tfloat shift_float = (float) (1 << SI_LOAD_SHIFT);\n\n\tif (sysinfo(&info) < 0) {\n\t\t*cpu_load = 0;\n\t\treturn errno;\n\t}\n\n\t*cpu_load = (info.loads[1] / shift_float) * 100.0;\n#endif\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_get_hash_val",
          "args": [],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "res_abs_cpus"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "PACKAGE_VERSION"
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "conf->node_name"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic char\tres_abs_cpus[MAX_CPUSTR];\nstatic void      _fill_registration_msg(slurm_node_registration_status_msg_t *);\n\nstatic void\n_fill_registration_msg(slurm_node_registration_status_msg_t *msg)\n{\n\tList steps;\n\tListIterator i;\n\tstep_loc_t *stepd;\n\tint  n;\n\tchar *arch, *os;\n\tstruct utsname buf;\n\tstatic bool first_msg = true;\n\tstatic time_t slurmd_start_time = 0;\n\tBuf gres_info;\n\n\tmsg->node_name   = xstrdup (conf->node_name);\n\tmsg->version     = xstrdup (PACKAGE_VERSION);\n\n\tmsg->cpus\t = conf->cpus;\n\tmsg->boards\t = conf->boards;\n\tmsg->sockets\t = conf->sockets;\n\tmsg->cores\t = conf->cores;\n\tmsg->threads\t = conf->threads;\n\tif (res_abs_cpus[0] == '\\0')\n\t\tmsg->cpu_spec_list = NULL;\n\telse\n\t\tmsg->cpu_spec_list = xstrdup (res_abs_cpus);\n\tmsg->real_memory = conf->real_memory_size;\n\tmsg->tmp_disk    = conf->tmp_disk_space;\n\tmsg->hash_val    = slurm_get_hash_val();\n\tget_cpu_load(&msg->cpu_load);\n\tget_free_mem(&msg->free_mem);\n\n\tgres_info = init_buf(1024);\n\tif (gres_plugin_node_config_pack(gres_info) != SLURM_SUCCESS)\n\t\terror(\"error packing gres configuration\");\n\telse\n\t\tmsg->gres_info   = gres_info;\n\n\tget_up_time(&conf->up_time);\n\tmsg->up_time     = conf->up_time;\n\tif (slurmd_start_time == 0)\n\t\tslurmd_start_time = time(NULL);\n\tmsg->slurmd_start_time = slurmd_start_time;\n\n\tnode_features_g_node_state(&msg->features_avail, &msg->features_active);\n\n\tif (first_msg) {\n\t\tfirst_msg = false;\n\t\tinfo(\"CPUs=%u Boards=%u Sockets=%u Cores=%u Threads=%u \"\n\t\t     \"Memory=%u TmpDisk=%u Uptime=%u CPUSpecList=%s \"\n\t\t     \"FeaturesAvail=%s FeaturesActive=%s\",\n\t\t     msg->cpus, msg->boards, msg->sockets, msg->cores,\n\t\t     msg->threads, msg->real_memory, msg->tmp_disk,\n\t\t     msg->up_time, msg->cpu_spec_list, msg->features_avail,\n\t\t     msg->features_active);\n\t} else {\n\t\tdebug3(\"CPUs=%u Boards=%u Sockets=%u Cores=%u Threads=%u \"\n\t\t       \"Memory=%u TmpDisk=%u Uptime=%u CPUSpecList=%s \"\n\t\t       \"FeaturesAvail=%s FeaturesActive=%s\",\n\t\t       msg->cpus, msg->boards, msg->sockets, msg->cores,\n\t\t       msg->threads, msg->real_memory, msg->tmp_disk,\n\t\t       msg->up_time, msg->cpu_spec_list, msg->features_avail,\n\t\t       msg->features_active);\n\t}\n\tuname(&buf);\n\tif ((arch = getenv(\"SLURM_ARCH\")))\n\t\tmsg->arch = xstrdup(arch);\n\telse\n\t\tmsg->arch = xstrdup(buf.machine);\n\tif ((os = getenv(\"SLURM_OS\")))\n\t\tmsg->os   = xstrdup(os);\n\telse\n\t\tmsg->os = xstrdup(buf.sysname);\n\n\tif (msg->startup) {\n\t\tif (switch_g_alloc_node_info(&msg->switch_nodeinfo))\n\t\t\terror(\"switch_g_alloc_node_info: %m\");\n\t\tif (switch_g_build_node_info(msg->switch_nodeinfo))\n\t\t\terror(\"switch_g_build_node_info: %m\");\n\t}\n\n\tsteps = stepd_available(conf->spooldir, conf->node_name);\n\tmsg->job_count = list_count(steps);\n\tmsg->job_id    = xmalloc(msg->job_count * sizeof(*msg->job_id));\n\t/* Note: Running batch jobs will have step_id == NO_VAL */\n\tmsg->step_id   = xmalloc(msg->job_count * sizeof(*msg->step_id));\n\n\ti = list_iterator_create(steps);\n\tn = 0;\n\twhile ((stepd = list_next(i))) {\n\t\tint fd;\n\t\tfd = stepd_connect(stepd->directory, stepd->nodename,\n\t\t\t\t   stepd->jobid, stepd->stepid,\n\t\t\t\t   &stepd->protocol_version);\n\t\tif (fd == -1) {\n\t\t\t--(msg->job_count);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (stepd_state(fd, stepd->protocol_version)\n\t\t    == SLURMSTEPD_NOT_RUNNING) {\n\t\t\tdebug(\"stale domain socket for stepd %u.%u \",\n\t\t\t      stepd->jobid, stepd->stepid);\n\t\t\t--(msg->job_count);\n\t\t\tclose(fd);\n\t\t\tcontinue;\n\t\t}\n\n\t\tclose(fd);\n\t\tif (stepd->stepid == NO_VAL) {\n\t\t\tdebug(\"%s: found apparently running job %u\",\n\t\t\t      __func__, stepd->jobid);\n\t\t} else {\n\t\t\tdebug(\"%s: found apparently running step %u.%u\",\n\t\t\t      __func__, stepd->jobid, stepd->stepid);\n\t\t}\n\t\tmsg->job_id[n]  = stepd->jobid;\n\t\tmsg->step_id[n] = stepd->stepid;\n\t\tn++;\n\t}\n\tlist_iterator_destroy(i);\n\tFREE_NULL_LIST(steps);\n\n\tif (!msg->energy)\n\t\tmsg->energy = acct_gather_energy_alloc(1);\n\tacct_gather_energy_g_get_data(ENERGY_DATA_NODE_ENERGY, msg->energy);\n\n\tmsg->timestamp = time(NULL);\n\n\treturn;\n}"
  },
  {
    "function_name": "send_registration_msg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "619-655",
    "snippet": "extern int\nsend_registration_msg(uint32_t status, bool startup)\n{\n\tint rc, ret_val = SLURM_SUCCESS;\n\tslurm_node_registration_status_msg_t *msg =\n\t\txmalloc (sizeof (slurm_node_registration_status_msg_t));\n\n\tmsg->startup = (uint16_t) startup;\n\t_fill_registration_msg(msg);\n\tmsg->status  = status;\n\n\tif (conf->msg_aggr_window_msgs > 1) {\n\t\tslurm_msg_t *req = xmalloc_nz(sizeof(slurm_msg_t));\n\n\t\tslurm_msg_t_init(req);\n\t\treq->msg_type = MESSAGE_NODE_REGISTRATION_STATUS;\n\t\treq->data     = msg;\n\n\t\tmsg_aggr_add_msg(req, 1, NULL);\n\t} else {\n\t\tslurm_msg_t req;\n\t\tslurm_msg_t_init(&req);\n\t\treq.msg_type = MESSAGE_NODE_REGISTRATION_STATUS;\n\t\treq.data     = msg;\n\n\t\tif (slurm_send_recv_controller_rc_msg(&req, &rc) < 0) {\n\t\t\terror(\"Unable to register: %m\");\n\t\t\tret_val = SLURM_FAILURE;\n\t\t}\n\t\tslurm_free_node_registration_status_msg(msg);\n\t}\n\n\tif (ret_val == SLURM_SUCCESS)\n\t\tsent_reg_time = time(NULL);\n\n\treturn ret_val;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static time_t sent_reg_time = (time_t) 0;",
      "static void      _fill_registration_msg(slurm_node_registration_status_msg_t *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "time",
          "args": [
            "NULL"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "get_up_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "274-325",
          "snippet": "extern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_free_node_registration_status_msg",
          "args": [
            "msg"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Unable to register: %m\""
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_send_recv_controller_rc_msg",
          "args": [
            "&req",
            "&rc"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_msg_t_init",
          "args": [
            "&req"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msg_aggr_add_msg",
          "args": [
            "req",
            "1",
            "NULL"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_msg_t_init",
          "args": [
            "req"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc_nz",
          "args": [
            "sizeof(slurm_msg_t)"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_fill_registration_msg",
          "args": [
            "msg"
          ],
          "line": 627
        },
        "resolved": true,
        "details": {
          "function_name": "_fill_registration_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "657-786",
          "snippet": "static void\n_fill_registration_msg(slurm_node_registration_status_msg_t *msg)\n{\n\tList steps;\n\tListIterator i;\n\tstep_loc_t *stepd;\n\tint  n;\n\tchar *arch, *os;\n\tstruct utsname buf;\n\tstatic bool first_msg = true;\n\tstatic time_t slurmd_start_time = 0;\n\tBuf gres_info;\n\n\tmsg->node_name   = xstrdup (conf->node_name);\n\tmsg->version     = xstrdup (PACKAGE_VERSION);\n\n\tmsg->cpus\t = conf->cpus;\n\tmsg->boards\t = conf->boards;\n\tmsg->sockets\t = conf->sockets;\n\tmsg->cores\t = conf->cores;\n\tmsg->threads\t = conf->threads;\n\tif (res_abs_cpus[0] == '\\0')\n\t\tmsg->cpu_spec_list = NULL;\n\telse\n\t\tmsg->cpu_spec_list = xstrdup (res_abs_cpus);\n\tmsg->real_memory = conf->real_memory_size;\n\tmsg->tmp_disk    = conf->tmp_disk_space;\n\tmsg->hash_val    = slurm_get_hash_val();\n\tget_cpu_load(&msg->cpu_load);\n\tget_free_mem(&msg->free_mem);\n\n\tgres_info = init_buf(1024);\n\tif (gres_plugin_node_config_pack(gres_info) != SLURM_SUCCESS)\n\t\terror(\"error packing gres configuration\");\n\telse\n\t\tmsg->gres_info   = gres_info;\n\n\tget_up_time(&conf->up_time);\n\tmsg->up_time     = conf->up_time;\n\tif (slurmd_start_time == 0)\n\t\tslurmd_start_time = time(NULL);\n\tmsg->slurmd_start_time = slurmd_start_time;\n\n\tnode_features_g_node_state(&msg->features_avail, &msg->features_active);\n\n\tif (first_msg) {\n\t\tfirst_msg = false;\n\t\tinfo(\"CPUs=%u Boards=%u Sockets=%u Cores=%u Threads=%u \"\n\t\t     \"Memory=%u TmpDisk=%u Uptime=%u CPUSpecList=%s \"\n\t\t     \"FeaturesAvail=%s FeaturesActive=%s\",\n\t\t     msg->cpus, msg->boards, msg->sockets, msg->cores,\n\t\t     msg->threads, msg->real_memory, msg->tmp_disk,\n\t\t     msg->up_time, msg->cpu_spec_list, msg->features_avail,\n\t\t     msg->features_active);\n\t} else {\n\t\tdebug3(\"CPUs=%u Boards=%u Sockets=%u Cores=%u Threads=%u \"\n\t\t       \"Memory=%u TmpDisk=%u Uptime=%u CPUSpecList=%s \"\n\t\t       \"FeaturesAvail=%s FeaturesActive=%s\",\n\t\t       msg->cpus, msg->boards, msg->sockets, msg->cores,\n\t\t       msg->threads, msg->real_memory, msg->tmp_disk,\n\t\t       msg->up_time, msg->cpu_spec_list, msg->features_avail,\n\t\t       msg->features_active);\n\t}\n\tuname(&buf);\n\tif ((arch = getenv(\"SLURM_ARCH\")))\n\t\tmsg->arch = xstrdup(arch);\n\telse\n\t\tmsg->arch = xstrdup(buf.machine);\n\tif ((os = getenv(\"SLURM_OS\")))\n\t\tmsg->os   = xstrdup(os);\n\telse\n\t\tmsg->os = xstrdup(buf.sysname);\n\n\tif (msg->startup) {\n\t\tif (switch_g_alloc_node_info(&msg->switch_nodeinfo))\n\t\t\terror(\"switch_g_alloc_node_info: %m\");\n\t\tif (switch_g_build_node_info(msg->switch_nodeinfo))\n\t\t\terror(\"switch_g_build_node_info: %m\");\n\t}\n\n\tsteps = stepd_available(conf->spooldir, conf->node_name);\n\tmsg->job_count = list_count(steps);\n\tmsg->job_id    = xmalloc(msg->job_count * sizeof(*msg->job_id));\n\t/* Note: Running batch jobs will have step_id == NO_VAL */\n\tmsg->step_id   = xmalloc(msg->job_count * sizeof(*msg->step_id));\n\n\ti = list_iterator_create(steps);\n\tn = 0;\n\twhile ((stepd = list_next(i))) {\n\t\tint fd;\n\t\tfd = stepd_connect(stepd->directory, stepd->nodename,\n\t\t\t\t   stepd->jobid, stepd->stepid,\n\t\t\t\t   &stepd->protocol_version);\n\t\tif (fd == -1) {\n\t\t\t--(msg->job_count);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (stepd_state(fd, stepd->protocol_version)\n\t\t    == SLURMSTEPD_NOT_RUNNING) {\n\t\t\tdebug(\"stale domain socket for stepd %u.%u \",\n\t\t\t      stepd->jobid, stepd->stepid);\n\t\t\t--(msg->job_count);\n\t\t\tclose(fd);\n\t\t\tcontinue;\n\t\t}\n\n\t\tclose(fd);\n\t\tif (stepd->stepid == NO_VAL) {\n\t\t\tdebug(\"%s: found apparently running job %u\",\n\t\t\t      __func__, stepd->jobid);\n\t\t} else {\n\t\t\tdebug(\"%s: found apparently running step %u.%u\",\n\t\t\t      __func__, stepd->jobid, stepd->stepid);\n\t\t}\n\t\tmsg->job_id[n]  = stepd->jobid;\n\t\tmsg->step_id[n] = stepd->stepid;\n\t\tn++;\n\t}\n\tlist_iterator_destroy(i);\n\tFREE_NULL_LIST(steps);\n\n\tif (!msg->energy)\n\t\tmsg->energy = acct_gather_energy_alloc(1);\n\tacct_gather_energy_g_get_data(ENERGY_DATA_NODE_ENERGY, msg->energy);\n\n\tmsg->timestamp = time(NULL);\n\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static char\tres_abs_cpus[MAX_CPUSTR];",
            "static void      _fill_registration_msg(slurm_node_registration_status_msg_t *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic char\tres_abs_cpus[MAX_CPUSTR];\nstatic void      _fill_registration_msg(slurm_node_registration_status_msg_t *);\n\nstatic void\n_fill_registration_msg(slurm_node_registration_status_msg_t *msg)\n{\n\tList steps;\n\tListIterator i;\n\tstep_loc_t *stepd;\n\tint  n;\n\tchar *arch, *os;\n\tstruct utsname buf;\n\tstatic bool first_msg = true;\n\tstatic time_t slurmd_start_time = 0;\n\tBuf gres_info;\n\n\tmsg->node_name   = xstrdup (conf->node_name);\n\tmsg->version     = xstrdup (PACKAGE_VERSION);\n\n\tmsg->cpus\t = conf->cpus;\n\tmsg->boards\t = conf->boards;\n\tmsg->sockets\t = conf->sockets;\n\tmsg->cores\t = conf->cores;\n\tmsg->threads\t = conf->threads;\n\tif (res_abs_cpus[0] == '\\0')\n\t\tmsg->cpu_spec_list = NULL;\n\telse\n\t\tmsg->cpu_spec_list = xstrdup (res_abs_cpus);\n\tmsg->real_memory = conf->real_memory_size;\n\tmsg->tmp_disk    = conf->tmp_disk_space;\n\tmsg->hash_val    = slurm_get_hash_val();\n\tget_cpu_load(&msg->cpu_load);\n\tget_free_mem(&msg->free_mem);\n\n\tgres_info = init_buf(1024);\n\tif (gres_plugin_node_config_pack(gres_info) != SLURM_SUCCESS)\n\t\terror(\"error packing gres configuration\");\n\telse\n\t\tmsg->gres_info   = gres_info;\n\n\tget_up_time(&conf->up_time);\n\tmsg->up_time     = conf->up_time;\n\tif (slurmd_start_time == 0)\n\t\tslurmd_start_time = time(NULL);\n\tmsg->slurmd_start_time = slurmd_start_time;\n\n\tnode_features_g_node_state(&msg->features_avail, &msg->features_active);\n\n\tif (first_msg) {\n\t\tfirst_msg = false;\n\t\tinfo(\"CPUs=%u Boards=%u Sockets=%u Cores=%u Threads=%u \"\n\t\t     \"Memory=%u TmpDisk=%u Uptime=%u CPUSpecList=%s \"\n\t\t     \"FeaturesAvail=%s FeaturesActive=%s\",\n\t\t     msg->cpus, msg->boards, msg->sockets, msg->cores,\n\t\t     msg->threads, msg->real_memory, msg->tmp_disk,\n\t\t     msg->up_time, msg->cpu_spec_list, msg->features_avail,\n\t\t     msg->features_active);\n\t} else {\n\t\tdebug3(\"CPUs=%u Boards=%u Sockets=%u Cores=%u Threads=%u \"\n\t\t       \"Memory=%u TmpDisk=%u Uptime=%u CPUSpecList=%s \"\n\t\t       \"FeaturesAvail=%s FeaturesActive=%s\",\n\t\t       msg->cpus, msg->boards, msg->sockets, msg->cores,\n\t\t       msg->threads, msg->real_memory, msg->tmp_disk,\n\t\t       msg->up_time, msg->cpu_spec_list, msg->features_avail,\n\t\t       msg->features_active);\n\t}\n\tuname(&buf);\n\tif ((arch = getenv(\"SLURM_ARCH\")))\n\t\tmsg->arch = xstrdup(arch);\n\telse\n\t\tmsg->arch = xstrdup(buf.machine);\n\tif ((os = getenv(\"SLURM_OS\")))\n\t\tmsg->os   = xstrdup(os);\n\telse\n\t\tmsg->os = xstrdup(buf.sysname);\n\n\tif (msg->startup) {\n\t\tif (switch_g_alloc_node_info(&msg->switch_nodeinfo))\n\t\t\terror(\"switch_g_alloc_node_info: %m\");\n\t\tif (switch_g_build_node_info(msg->switch_nodeinfo))\n\t\t\terror(\"switch_g_build_node_info: %m\");\n\t}\n\n\tsteps = stepd_available(conf->spooldir, conf->node_name);\n\tmsg->job_count = list_count(steps);\n\tmsg->job_id    = xmalloc(msg->job_count * sizeof(*msg->job_id));\n\t/* Note: Running batch jobs will have step_id == NO_VAL */\n\tmsg->step_id   = xmalloc(msg->job_count * sizeof(*msg->step_id));\n\n\ti = list_iterator_create(steps);\n\tn = 0;\n\twhile ((stepd = list_next(i))) {\n\t\tint fd;\n\t\tfd = stepd_connect(stepd->directory, stepd->nodename,\n\t\t\t\t   stepd->jobid, stepd->stepid,\n\t\t\t\t   &stepd->protocol_version);\n\t\tif (fd == -1) {\n\t\t\t--(msg->job_count);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (stepd_state(fd, stepd->protocol_version)\n\t\t    == SLURMSTEPD_NOT_RUNNING) {\n\t\t\tdebug(\"stale domain socket for stepd %u.%u \",\n\t\t\t      stepd->jobid, stepd->stepid);\n\t\t\t--(msg->job_count);\n\t\t\tclose(fd);\n\t\t\tcontinue;\n\t\t}\n\n\t\tclose(fd);\n\t\tif (stepd->stepid == NO_VAL) {\n\t\t\tdebug(\"%s: found apparently running job %u\",\n\t\t\t      __func__, stepd->jobid);\n\t\t} else {\n\t\t\tdebug(\"%s: found apparently running step %u.%u\",\n\t\t\t      __func__, stepd->jobid, stepd->stepid);\n\t\t}\n\t\tmsg->job_id[n]  = stepd->jobid;\n\t\tmsg->step_id[n] = stepd->stepid;\n\t\tn++;\n\t}\n\tlist_iterator_destroy(i);\n\tFREE_NULL_LIST(steps);\n\n\tif (!msg->energy)\n\t\tmsg->energy = acct_gather_energy_alloc(1);\n\tacct_gather_energy_g_get_data(ENERGY_DATA_NODE_ENERGY, msg->energy);\n\n\tmsg->timestamp = time(NULL);\n\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "sizeof (slurm_node_registration_status_msg_t)"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic time_t sent_reg_time = (time_t) 0;\nstatic void      _fill_registration_msg(slurm_node_registration_status_msg_t *);\n\nextern int\nsend_registration_msg(uint32_t status, bool startup)\n{\n\tint rc, ret_val = SLURM_SUCCESS;\n\tslurm_node_registration_status_msg_t *msg =\n\t\txmalloc (sizeof (slurm_node_registration_status_msg_t));\n\n\tmsg->startup = (uint16_t) startup;\n\t_fill_registration_msg(msg);\n\tmsg->status  = status;\n\n\tif (conf->msg_aggr_window_msgs > 1) {\n\t\tslurm_msg_t *req = xmalloc_nz(sizeof(slurm_msg_t));\n\n\t\tslurm_msg_t_init(req);\n\t\treq->msg_type = MESSAGE_NODE_REGISTRATION_STATUS;\n\t\treq->data     = msg;\n\n\t\tmsg_aggr_add_msg(req, 1, NULL);\n\t} else {\n\t\tslurm_msg_t req;\n\t\tslurm_msg_t_init(&req);\n\t\treq.msg_type = MESSAGE_NODE_REGISTRATION_STATUS;\n\t\treq.data     = msg;\n\n\t\tif (slurm_send_recv_controller_rc_msg(&req, &rc) < 0) {\n\t\t\terror(\"Unable to register: %m\");\n\t\t\tret_val = SLURM_FAILURE;\n\t\t}\n\t\tslurm_free_node_registration_status_msg(msg);\n\t}\n\n\tif (ret_val == SLURM_SUCCESS)\n\t\tsent_reg_time = time(NULL);\n\n\treturn ret_val;\n}"
  },
  {
    "function_name": "_service_connection",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "585-617",
    "snippet": "static void *\n_service_connection(void *arg)\n{\n\tconn_t *con = (conn_t *) arg;\n\tslurm_msg_t *msg = xmalloc(sizeof(slurm_msg_t));\n\tint rc = SLURM_SUCCESS;\n\n\tdebug3(\"in the service_connection\");\n\tslurm_msg_t_init(msg);\n\tif ((rc = slurm_receive_msg_and_forward(con->fd, con->cli_addr, msg, 0))\n\t   != SLURM_SUCCESS) {\n\t\terror(\"service_connection: slurm_receive_msg: %m\");\n\t\t/* if this fails we need to make sure the nodes we forward\n\t\t   to are taken care of and sent back. This way the control\n\t\t   also has a better idea what happened to us */\n\t\tslurm_send_rc_msg(msg, rc);\n\t\tgoto cleanup;\n\t}\n\tdebug2(\"got this type of message %d\", msg->msg_type);\n\n\tif (msg->msg_type != MESSAGE_COMPOSITE)\n\t\tslurmd_req(msg);\n\ncleanup:\n\tif ((msg->conn_fd >= 0) && slurm_close(msg->conn_fd) < 0)\n\t\terror (\"close(%d): %m\", con->fd);\n\n\txfree(con->cli_addr);\n\txfree(con);\n\tslurm_free_msg(msg);\n\t_decrement_thd_count();\n\treturn NULL;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void      _decrement_thd_count(void);",
      "static void     *_registration_engine(void *arg);",
      "static void     *_service_connection(void *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_decrement_thd_count",
          "args": [],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "_decrement_thd_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "487-495",
          "snippet": "static void\n_decrement_thd_count(void)\n{\n\tslurm_mutex_lock(&active_mutex);\n\tif (active_threads > 0)\n\t\tactive_threads--;\n\tpthread_cond_signal(&active_cond);\n\tslurm_mutex_unlock(&active_mutex);\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int             active_threads = 0;",
            "static pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;",
            "static pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;",
            "static void      _decrement_thd_count(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic int             active_threads = 0;\nstatic pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;\nstatic pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;\nstatic void      _decrement_thd_count(void);\n\nstatic void\n_decrement_thd_count(void)\n{\n\tslurm_mutex_lock(&active_mutex);\n\tif (active_threads > 0)\n\t\tactive_threads--;\n\tpthread_cond_signal(&active_cond);\n\tslurm_mutex_unlock(&active_mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_free_msg",
          "args": [
            "msg"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "con"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"close(%d): %m\"",
            "con->fd"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "_prolog_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "1386-1434",
          "snippet": "static void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _is_batch_job_finished(uint32_t job_id);",
            "static bool _job_still_running(uint32_t job_id);",
            "static void _launch_complete_add(uint32_t job_id);",
            "static void _launch_complete_log(char *type, uint32_t job_id);",
            "static void _launch_complete_rm(uint32_t job_id);",
            "static void _launch_complete_wait(uint32_t job_id);",
            "static bool _launch_job_test(uint32_t job_id);",
            "static void _note_batch_job_finished(uint32_t job_id);",
            "static bool _slurm_authorized_user(uid_t uid);",
            "static void _sync_messages_kill(kill_job_msg_t *req);",
            "static int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);",
            "static gids_t *_gids_cache_lookup(char *user, gid_t gid);",
            "static int  _add_starting_step(uint16_t type, void *req);",
            "static int  _remove_starting_step(uint16_t type, void *req);",
            "static void _add_job_running_prolog(uint32_t job_id);",
            "static void _remove_job_running_prolog(uint32_t job_id);",
            "static void _wait_for_job_running_prolog(uint32_t job_id);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic bool _is_batch_job_finished(uint32_t job_id);\nstatic bool _job_still_running(uint32_t job_id);\nstatic void _launch_complete_add(uint32_t job_id);\nstatic void _launch_complete_log(char *type, uint32_t job_id);\nstatic void _launch_complete_rm(uint32_t job_id);\nstatic void _launch_complete_wait(uint32_t job_id);\nstatic bool _launch_job_test(uint32_t job_id);\nstatic void _note_batch_job_finished(uint32_t job_id);\nstatic bool _slurm_authorized_user(uid_t uid);\nstatic void _sync_messages_kill(kill_job_msg_t *req);\nstatic int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);\nstatic gids_t *_gids_cache_lookup(char *user, gid_t gid);\nstatic int  _add_starting_step(uint16_t type, void *req);\nstatic int  _remove_starting_step(uint16_t type, void *req);\nstatic void _add_job_running_prolog(uint32_t job_id);\nstatic void _remove_job_running_prolog(uint32_t job_id);\nstatic void _wait_for_job_running_prolog(uint32_t job_id);\n\nstatic void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_close",
          "args": [
            "msg->conn_fd"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurmd_req",
          "args": [
            "msg"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "slurmd_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "278-458",
          "snippet": "void\nslurmd_req(slurm_msg_t *msg)\n{\n\tint rc;\n\n\tif (msg == NULL) {\n\t\tif (startup == 0)\n\t\t\tstartup = time(NULL);\n\t\tFREE_NULL_LIST(waiters);\n\t\tslurm_mutex_lock(&job_limits_mutex);\n\t\tif (job_limits_list) {\n\t\t\tFREE_NULL_LIST(job_limits_list);\n\t\t\tjob_limits_loaded = false;\n\t\t}\n\t\tslurm_mutex_unlock(&job_limits_mutex);\n\t\treturn;\n\t}\n\n\tswitch (msg->msg_type) {\n\tcase REQUEST_LAUNCH_PROLOG:\n\t\tdebug2(\"Processing RPC: REQUEST_LAUNCH_PROLOG\");\n\t\t_rpc_prolog(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_BATCH_JOB_LAUNCH:\n\t\tdebug2(\"Processing RPC: REQUEST_BATCH_JOB_LAUNCH\");\n\t\t/* Mutex locking moved into _rpc_batch_job() due to\n\t\t * very slow prolog on Blue Gene system. Only batch\n\t\t * jobs are supported on Blue Gene (no job steps). */\n\t\t_rpc_batch_job(msg, true);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_LAUNCH_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_LAUNCH_TASKS\");\n\t\tslurm_mutex_lock(&launch_mutex);\n\t\t_rpc_launch_tasks(msg);\n\t\tslurm_mutex_unlock(&launch_mutex);\n\t\tbreak;\n\tcase REQUEST_SIGNAL_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_SIGNAL_TASKS\");\n\t\t_rpc_signal_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_CHECKPOINT_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_CHECKPOINT_TASKS\");\n\t\t_rpc_checkpoint_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_TERMINATE_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_TERMINATE_TASKS\");\n\t\t_rpc_terminate_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_KILL_PREEMPTED:\n\t\tdebug2(\"Processing RPC: REQUEST_KILL_PREEMPTED\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_timelimit(msg);\n\t\tbreak;\n\tcase REQUEST_KILL_TIMELIMIT:\n\t\tdebug2(\"Processing RPC: REQUEST_KILL_TIMELIMIT\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_timelimit(msg);\n\t\tbreak;\n\tcase REQUEST_REATTACH_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_REATTACH_TASKS\");\n\t\t_rpc_reattach_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_SIGNAL_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_SIGNAL_JOB\");\n\t\t_rpc_signal_job(msg);\n\t\tbreak;\n\tcase REQUEST_SUSPEND_INT:\n\t\tdebug2(\"Processing RPC: REQUEST_SUSPEND_INT\");\n\t\t_rpc_suspend_job(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ABORT_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_ABORT_JOB\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_abort_job(msg);\n\t\tbreak;\n\tcase REQUEST_TERMINATE_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_TERMINATE_JOB\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_terminate_job(msg);\n\t\tbreak;\n\tcase REQUEST_COMPLETE_BATCH_SCRIPT:\n\t\tdebug2(\"Processing RPC: REQUEST_COMPLETE_BATCH_SCRIPT\");\n\t\t_rpc_complete_batch(msg);\n\t\tbreak;\n\tcase REQUEST_UPDATE_JOB_TIME:\n\t\tdebug2(\"Processing RPC: REQUEST_UPDATE_JOB_TIME\");\n\t\t_rpc_update_time(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_SHUTDOWN:\n\t\tdebug2(\"Processing RPC: REQUEST_SHUTDOWN\");\n\t\t_rpc_shutdown(msg);\n\t\tbreak;\n\tcase REQUEST_RECONFIGURE:\n\t\tdebug2(\"Processing RPC: REQUEST_RECONFIGURE\");\n\t\t_rpc_reconfig(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_REBOOT_NODES:\n\t\tdebug2(\"Processing RPC: REQUEST_REBOOT_NODES\");\n\t\t_rpc_reboot(msg);\n\t\tbreak;\n\tcase REQUEST_NODE_REGISTRATION_STATUS:\n\t\tdebug2(\"Processing RPC: REQUEST_NODE_REGISTRATION_STATUS\");\n\t\t/* Treat as ping (for slurmctld agent, just return SUCCESS) */\n\t\trc = _rpc_ping(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t/* Then initiate a separate node registration */\n\t\tif (rc == SLURM_SUCCESS)\n\t\t\tsend_registration_msg(SLURM_SUCCESS, true);\n\t\tbreak;\n\tcase REQUEST_PING:\n\t\t_rpc_ping(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_HEALTH_CHECK:\n\t\tdebug2(\"Processing RPC: REQUEST_HEALTH_CHECK\");\n\t\t_rpc_health_check(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ACCT_GATHER_UPDATE:\n\t\tdebug2(\"Processing RPC: REQUEST_ACCT_GATHER_UPDATE\");\n\t\t_rpc_acct_gather_update(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ACCT_GATHER_ENERGY:\n\t\tdebug2(\"Processing RPC: REQUEST_ACCT_GATHER_ENERGY\");\n\t\t_rpc_acct_gather_energy(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_ID:\n\t\t_rpc_pid2jid(msg);\n\t\tbreak;\n\tcase REQUEST_FILE_BCAST:\n\t\trc = _rpc_file_bcast(msg);\n\t\tslurm_send_rc_msg(msg, rc);\n\t\tbreak;\n\tcase REQUEST_STEP_COMPLETE:\n\t\t(void) _rpc_step_complete(msg);\n\t\tbreak;\n\tcase REQUEST_STEP_COMPLETE_AGGR:\n\t\t(void) _rpc_step_complete_aggr(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_STEP_STAT:\n\t\t(void) _rpc_stat_jobacct(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_STEP_PIDS:\n\t\t(void) _rpc_list_pids(msg);\n\t\tbreak;\n\tcase REQUEST_DAEMON_STATUS:\n\t\t_rpc_daemon_status(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_NOTIFY:\n\t\t_rpc_job_notify(msg);\n\t\tbreak;\n\tcase REQUEST_FORWARD_DATA:\n\t\t_rpc_forward_data(msg);\n\t\tbreak;\n\tcase REQUEST_NETWORK_CALLERID:\n\t\tdebug2(\"Processing RPC: REQUEST_NETWORK_CALLERID\");\n\t\t_rpc_network_callerid(msg);\n\t\tbreak;\n\tcase MESSAGE_COMPOSITE:\n\t\terror(\"Processing RPC: MESSAGE_COMPOSITE: \"\n\t\t      \"This should never happen\");\n\t\tmsg_aggr_add_msg(msg, 0, NULL);\n\t\tbreak;\n\tcase RESPONSE_MESSAGE_COMPOSITE:\n\t\tdebug2(\"Processing RPC: RESPONSE_MESSAGE_COMPOSITE\");\n\t\tmsg_aggr_resp(msg);\n\t\tbreak;\n\tdefault:\n\t\terror(\"slurmd_req: invalid request msg type %d\",\n\t\t      msg->msg_type);\n\t\tslurm_send_rc_msg(msg, EINVAL);\n\t\tbreak;\n\t}\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int  _kill_all_active_steps(uint32_t jobid, int sig, bool batch);",
            "static int  _terminate_all_steps(uint32_t jobid, bool batch);",
            "static void _rpc_launch_tasks(slurm_msg_t *);",
            "static void _rpc_abort_job(slurm_msg_t *);",
            "static void _rpc_prolog(slurm_msg_t *msg);",
            "static void _rpc_job_notify(slurm_msg_t *);",
            "static void _rpc_signal_tasks(slurm_msg_t *);",
            "static void _rpc_checkpoint_tasks(slurm_msg_t *);",
            "static void _rpc_complete_batch(slurm_msg_t *);",
            "static void _rpc_terminate_tasks(slurm_msg_t *);",
            "static void _rpc_timelimit(slurm_msg_t *);",
            "static void _rpc_reattach_tasks(slurm_msg_t *);",
            "static void _rpc_signal_job(slurm_msg_t *);",
            "static void _rpc_suspend_job(slurm_msg_t *msg);",
            "static void _rpc_terminate_job(slurm_msg_t *);",
            "static void _rpc_update_time(slurm_msg_t *);",
            "static void _rpc_shutdown(slurm_msg_t *msg);",
            "static void _rpc_reconfig(slurm_msg_t *msg);",
            "static void _rpc_reboot(slurm_msg_t *msg);",
            "static void _rpc_pid2jid(slurm_msg_t *msg);",
            "static int  _rpc_file_bcast(slurm_msg_t *msg);",
            "static int  _rpc_ping(slurm_msg_t *);",
            "static int  _rpc_health_check(slurm_msg_t *);",
            "static int  _rpc_acct_gather_update(slurm_msg_t *);",
            "static int  _rpc_acct_gather_energy(slurm_msg_t *);",
            "static int  _rpc_step_complete(slurm_msg_t *msg);",
            "static int  _rpc_step_complete_aggr(slurm_msg_t *msg);",
            "static int  _rpc_stat_jobacct(slurm_msg_t *msg);",
            "static int  _rpc_list_pids(slurm_msg_t *msg);",
            "static int  _rpc_daemon_status(slurm_msg_t *msg);",
            "static void _rpc_forward_data(slurm_msg_t *msg);",
            "static int  _rpc_network_callerid(slurm_msg_t *msg);",
            "static List waiters;",
            "static pthread_mutex_t launch_mutex = PTHREAD_MUTEX_INITIALIZER;",
            "static time_t startup = 0;",
            "static time_t last_slurmctld_msg = 0;",
            "static pthread_mutex_t job_limits_mutex = PTHREAD_MUTEX_INITIALIZER;",
            "static List job_limits_list = NULL;",
            "static bool job_limits_loaded = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic int  _kill_all_active_steps(uint32_t jobid, int sig, bool batch);\nstatic int  _terminate_all_steps(uint32_t jobid, bool batch);\nstatic void _rpc_launch_tasks(slurm_msg_t *);\nstatic void _rpc_abort_job(slurm_msg_t *);\nstatic void _rpc_prolog(slurm_msg_t *msg);\nstatic void _rpc_job_notify(slurm_msg_t *);\nstatic void _rpc_signal_tasks(slurm_msg_t *);\nstatic void _rpc_checkpoint_tasks(slurm_msg_t *);\nstatic void _rpc_complete_batch(slurm_msg_t *);\nstatic void _rpc_terminate_tasks(slurm_msg_t *);\nstatic void _rpc_timelimit(slurm_msg_t *);\nstatic void _rpc_reattach_tasks(slurm_msg_t *);\nstatic void _rpc_signal_job(slurm_msg_t *);\nstatic void _rpc_suspend_job(slurm_msg_t *msg);\nstatic void _rpc_terminate_job(slurm_msg_t *);\nstatic void _rpc_update_time(slurm_msg_t *);\nstatic void _rpc_shutdown(slurm_msg_t *msg);\nstatic void _rpc_reconfig(slurm_msg_t *msg);\nstatic void _rpc_reboot(slurm_msg_t *msg);\nstatic void _rpc_pid2jid(slurm_msg_t *msg);\nstatic int  _rpc_file_bcast(slurm_msg_t *msg);\nstatic int  _rpc_ping(slurm_msg_t *);\nstatic int  _rpc_health_check(slurm_msg_t *);\nstatic int  _rpc_acct_gather_update(slurm_msg_t *);\nstatic int  _rpc_acct_gather_energy(slurm_msg_t *);\nstatic int  _rpc_step_complete(slurm_msg_t *msg);\nstatic int  _rpc_step_complete_aggr(slurm_msg_t *msg);\nstatic int  _rpc_stat_jobacct(slurm_msg_t *msg);\nstatic int  _rpc_list_pids(slurm_msg_t *msg);\nstatic int  _rpc_daemon_status(slurm_msg_t *msg);\nstatic void _rpc_forward_data(slurm_msg_t *msg);\nstatic int  _rpc_network_callerid(slurm_msg_t *msg);\nstatic List waiters;\nstatic pthread_mutex_t launch_mutex = PTHREAD_MUTEX_INITIALIZER;\nstatic time_t startup = 0;\nstatic time_t last_slurmctld_msg = 0;\nstatic pthread_mutex_t job_limits_mutex = PTHREAD_MUTEX_INITIALIZER;\nstatic List job_limits_list = NULL;\nstatic bool job_limits_loaded = false;\n\nvoid\nslurmd_req(slurm_msg_t *msg)\n{\n\tint rc;\n\n\tif (msg == NULL) {\n\t\tif (startup == 0)\n\t\t\tstartup = time(NULL);\n\t\tFREE_NULL_LIST(waiters);\n\t\tslurm_mutex_lock(&job_limits_mutex);\n\t\tif (job_limits_list) {\n\t\t\tFREE_NULL_LIST(job_limits_list);\n\t\t\tjob_limits_loaded = false;\n\t\t}\n\t\tslurm_mutex_unlock(&job_limits_mutex);\n\t\treturn;\n\t}\n\n\tswitch (msg->msg_type) {\n\tcase REQUEST_LAUNCH_PROLOG:\n\t\tdebug2(\"Processing RPC: REQUEST_LAUNCH_PROLOG\");\n\t\t_rpc_prolog(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_BATCH_JOB_LAUNCH:\n\t\tdebug2(\"Processing RPC: REQUEST_BATCH_JOB_LAUNCH\");\n\t\t/* Mutex locking moved into _rpc_batch_job() due to\n\t\t * very slow prolog on Blue Gene system. Only batch\n\t\t * jobs are supported on Blue Gene (no job steps). */\n\t\t_rpc_batch_job(msg, true);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_LAUNCH_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_LAUNCH_TASKS\");\n\t\tslurm_mutex_lock(&launch_mutex);\n\t\t_rpc_launch_tasks(msg);\n\t\tslurm_mutex_unlock(&launch_mutex);\n\t\tbreak;\n\tcase REQUEST_SIGNAL_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_SIGNAL_TASKS\");\n\t\t_rpc_signal_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_CHECKPOINT_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_CHECKPOINT_TASKS\");\n\t\t_rpc_checkpoint_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_TERMINATE_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_TERMINATE_TASKS\");\n\t\t_rpc_terminate_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_KILL_PREEMPTED:\n\t\tdebug2(\"Processing RPC: REQUEST_KILL_PREEMPTED\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_timelimit(msg);\n\t\tbreak;\n\tcase REQUEST_KILL_TIMELIMIT:\n\t\tdebug2(\"Processing RPC: REQUEST_KILL_TIMELIMIT\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_timelimit(msg);\n\t\tbreak;\n\tcase REQUEST_REATTACH_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_REATTACH_TASKS\");\n\t\t_rpc_reattach_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_SIGNAL_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_SIGNAL_JOB\");\n\t\t_rpc_signal_job(msg);\n\t\tbreak;\n\tcase REQUEST_SUSPEND_INT:\n\t\tdebug2(\"Processing RPC: REQUEST_SUSPEND_INT\");\n\t\t_rpc_suspend_job(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ABORT_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_ABORT_JOB\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_abort_job(msg);\n\t\tbreak;\n\tcase REQUEST_TERMINATE_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_TERMINATE_JOB\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_terminate_job(msg);\n\t\tbreak;\n\tcase REQUEST_COMPLETE_BATCH_SCRIPT:\n\t\tdebug2(\"Processing RPC: REQUEST_COMPLETE_BATCH_SCRIPT\");\n\t\t_rpc_complete_batch(msg);\n\t\tbreak;\n\tcase REQUEST_UPDATE_JOB_TIME:\n\t\tdebug2(\"Processing RPC: REQUEST_UPDATE_JOB_TIME\");\n\t\t_rpc_update_time(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_SHUTDOWN:\n\t\tdebug2(\"Processing RPC: REQUEST_SHUTDOWN\");\n\t\t_rpc_shutdown(msg);\n\t\tbreak;\n\tcase REQUEST_RECONFIGURE:\n\t\tdebug2(\"Processing RPC: REQUEST_RECONFIGURE\");\n\t\t_rpc_reconfig(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_REBOOT_NODES:\n\t\tdebug2(\"Processing RPC: REQUEST_REBOOT_NODES\");\n\t\t_rpc_reboot(msg);\n\t\tbreak;\n\tcase REQUEST_NODE_REGISTRATION_STATUS:\n\t\tdebug2(\"Processing RPC: REQUEST_NODE_REGISTRATION_STATUS\");\n\t\t/* Treat as ping (for slurmctld agent, just return SUCCESS) */\n\t\trc = _rpc_ping(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t/* Then initiate a separate node registration */\n\t\tif (rc == SLURM_SUCCESS)\n\t\t\tsend_registration_msg(SLURM_SUCCESS, true);\n\t\tbreak;\n\tcase REQUEST_PING:\n\t\t_rpc_ping(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_HEALTH_CHECK:\n\t\tdebug2(\"Processing RPC: REQUEST_HEALTH_CHECK\");\n\t\t_rpc_health_check(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ACCT_GATHER_UPDATE:\n\t\tdebug2(\"Processing RPC: REQUEST_ACCT_GATHER_UPDATE\");\n\t\t_rpc_acct_gather_update(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ACCT_GATHER_ENERGY:\n\t\tdebug2(\"Processing RPC: REQUEST_ACCT_GATHER_ENERGY\");\n\t\t_rpc_acct_gather_energy(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_ID:\n\t\t_rpc_pid2jid(msg);\n\t\tbreak;\n\tcase REQUEST_FILE_BCAST:\n\t\trc = _rpc_file_bcast(msg);\n\t\tslurm_send_rc_msg(msg, rc);\n\t\tbreak;\n\tcase REQUEST_STEP_COMPLETE:\n\t\t(void) _rpc_step_complete(msg);\n\t\tbreak;\n\tcase REQUEST_STEP_COMPLETE_AGGR:\n\t\t(void) _rpc_step_complete_aggr(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_STEP_STAT:\n\t\t(void) _rpc_stat_jobacct(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_STEP_PIDS:\n\t\t(void) _rpc_list_pids(msg);\n\t\tbreak;\n\tcase REQUEST_DAEMON_STATUS:\n\t\t_rpc_daemon_status(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_NOTIFY:\n\t\t_rpc_job_notify(msg);\n\t\tbreak;\n\tcase REQUEST_FORWARD_DATA:\n\t\t_rpc_forward_data(msg);\n\t\tbreak;\n\tcase REQUEST_NETWORK_CALLERID:\n\t\tdebug2(\"Processing RPC: REQUEST_NETWORK_CALLERID\");\n\t\t_rpc_network_callerid(msg);\n\t\tbreak;\n\tcase MESSAGE_COMPOSITE:\n\t\terror(\"Processing RPC: MESSAGE_COMPOSITE: \"\n\t\t      \"This should never happen\");\n\t\tmsg_aggr_add_msg(msg, 0, NULL);\n\t\tbreak;\n\tcase RESPONSE_MESSAGE_COMPOSITE:\n\t\tdebug2(\"Processing RPC: RESPONSE_MESSAGE_COMPOSITE\");\n\t\tmsg_aggr_resp(msg);\n\t\tbreak;\n\tdefault:\n\t\terror(\"slurmd_req: invalid request msg type %d\",\n\t\t      msg->msg_type);\n\t\tslurm_send_rc_msg(msg, EINVAL);\n\t\tbreak;\n\t}\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"got this type of message %d\"",
            "msg->msg_type"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_send_rc_msg",
          "args": [
            "msg",
            "rc"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"service_connection: slurm_receive_msg: %m\""
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_receive_msg_and_forward",
          "args": [
            "con->fd",
            "con->cli_addr",
            "msg",
            "0"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_msg_t_init",
          "args": [
            "msg"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"in the service_connection\""
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "sizeof(slurm_msg_t)"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic void      _decrement_thd_count(void);\nstatic void     *_registration_engine(void *arg);\nstatic void     *_service_connection(void *);\n\nstatic void *\n_service_connection(void *arg)\n{\n\tconn_t *con = (conn_t *) arg;\n\tslurm_msg_t *msg = xmalloc(sizeof(slurm_msg_t));\n\tint rc = SLURM_SUCCESS;\n\n\tdebug3(\"in the service_connection\");\n\tslurm_msg_t_init(msg);\n\tif ((rc = slurm_receive_msg_and_forward(con->fd, con->cli_addr, msg, 0))\n\t   != SLURM_SUCCESS) {\n\t\terror(\"service_connection: slurm_receive_msg: %m\");\n\t\t/* if this fails we need to make sure the nodes we forward\n\t\t   to are taken care of and sent back. This way the control\n\t\t   also has a better idea what happened to us */\n\t\tslurm_send_rc_msg(msg, rc);\n\t\tgoto cleanup;\n\t}\n\tdebug2(\"got this type of message %d\", msg->msg_type);\n\n\tif (msg->msg_type != MESSAGE_COMPOSITE)\n\t\tslurmd_req(msg);\n\ncleanup:\n\tif ((msg->conn_fd >= 0) && slurm_close(msg->conn_fd) < 0)\n\t\terror (\"close(%d): %m\", con->fd);\n\n\txfree(con->cli_addr);\n\txfree(con);\n\tslurm_free_msg(msg);\n\t_decrement_thd_count();\n\treturn NULL;\n}"
  },
  {
    "function_name": "_handle_connection",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "543-583",
    "snippet": "static void\n_handle_connection(slurm_fd_t fd, slurm_addr_t *cli)\n{\n\tint            rc;\n\tpthread_attr_t attr;\n\tpthread_t      id;\n\tconn_t         *arg = xmalloc(sizeof(conn_t));\n\tint            retries = 0;\n\n\targ->fd       = fd;\n\targ->cli_addr = cli;\n\n\tslurm_attr_init(&attr);\n\trc = pthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);\n\tif (rc != 0) {\n\t\terrno = rc;\n\t\txfree(arg);\n\t\terror(\"Unable to set detachstate on attr: %m\");\n\t\tslurm_attr_destroy(&attr);\n\t\treturn;\n\t}\n\n\tfd_set_close_on_exec(fd);\n\n\t_increment_thd_count();\n\twhile (pthread_create(&id, &attr, &_service_connection, (void *)arg)) {\n\t\terror(\"msg_engine: pthread_create: %m\");\n\t\tif (++retries > 3) {\n\t\t\terror(\"running service_connection without starting \"\n\t\t\t      \"a new thread slurmd will be \"\n\t\t\t      \"unresponsive until done\");\n\n\t\t\t_service_connection((void *) arg);\n\t\t\tinfo(\"slurmd should be responsive now\");\n\t\t\tbreak;\n\t\t}\n\t\tusleep(10);\t/* sleep and again */\n\t}\n\n\treturn;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void      _increment_thd_count(void);",
      "static void     *_registration_engine(void *arg);",
      "static void     *_service_connection(void *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "usleep",
          "args": [
            "10"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"slurmd should be responsive now\""
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "_free_file_bcast_info_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "3642-3648",
          "snippet": "static void _free_file_bcast_info_t(file_bcast_info_t *f)\n{\n\txfree(f->fname);\n\tif (f->fd)\n\t\tclose(f->fd);\n\txfree(f);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic void _free_file_bcast_info_t(file_bcast_info_t *f)\n{\n\txfree(f->fname);\n\tif (f->fd)\n\t\tclose(f->fd);\n\txfree(f);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_service_connection",
          "args": [
            "(void *) arg"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "_service_connection",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "585-617",
          "snippet": "static void *\n_service_connection(void *arg)\n{\n\tconn_t *con = (conn_t *) arg;\n\tslurm_msg_t *msg = xmalloc(sizeof(slurm_msg_t));\n\tint rc = SLURM_SUCCESS;\n\n\tdebug3(\"in the service_connection\");\n\tslurm_msg_t_init(msg);\n\tif ((rc = slurm_receive_msg_and_forward(con->fd, con->cli_addr, msg, 0))\n\t   != SLURM_SUCCESS) {\n\t\terror(\"service_connection: slurm_receive_msg: %m\");\n\t\t/* if this fails we need to make sure the nodes we forward\n\t\t   to are taken care of and sent back. This way the control\n\t\t   also has a better idea what happened to us */\n\t\tslurm_send_rc_msg(msg, rc);\n\t\tgoto cleanup;\n\t}\n\tdebug2(\"got this type of message %d\", msg->msg_type);\n\n\tif (msg->msg_type != MESSAGE_COMPOSITE)\n\t\tslurmd_req(msg);\n\ncleanup:\n\tif ((msg->conn_fd >= 0) && slurm_close(msg->conn_fd) < 0)\n\t\terror (\"close(%d): %m\", con->fd);\n\n\txfree(con->cli_addr);\n\txfree(con);\n\tslurm_free_msg(msg);\n\t_decrement_thd_count();\n\treturn NULL;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void      _decrement_thd_count(void);",
            "static void     *_registration_engine(void *arg);",
            "static void     *_service_connection(void *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic void      _decrement_thd_count(void);\nstatic void     *_registration_engine(void *arg);\nstatic void     *_service_connection(void *);\n\nstatic void *\n_service_connection(void *arg)\n{\n\tconn_t *con = (conn_t *) arg;\n\tslurm_msg_t *msg = xmalloc(sizeof(slurm_msg_t));\n\tint rc = SLURM_SUCCESS;\n\n\tdebug3(\"in the service_connection\");\n\tslurm_msg_t_init(msg);\n\tif ((rc = slurm_receive_msg_and_forward(con->fd, con->cli_addr, msg, 0))\n\t   != SLURM_SUCCESS) {\n\t\terror(\"service_connection: slurm_receive_msg: %m\");\n\t\t/* if this fails we need to make sure the nodes we forward\n\t\t   to are taken care of and sent back. This way the control\n\t\t   also has a better idea what happened to us */\n\t\tslurm_send_rc_msg(msg, rc);\n\t\tgoto cleanup;\n\t}\n\tdebug2(\"got this type of message %d\", msg->msg_type);\n\n\tif (msg->msg_type != MESSAGE_COMPOSITE)\n\t\tslurmd_req(msg);\n\ncleanup:\n\tif ((msg->conn_fd >= 0) && slurm_close(msg->conn_fd) < 0)\n\t\terror (\"close(%d): %m\", con->fd);\n\n\txfree(con->cli_addr);\n\txfree(con);\n\tslurm_free_msg(msg);\n\t_decrement_thd_count();\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"running service_connection without starting \"\n\t\t\t      \"a new thread slurmd will be \"\n\t\t\t      \"unresponsive until done\""
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"msg_engine: pthread_create: %m\""
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_create",
          "args": [
            "&id",
            "&attr",
            "&_service_connection",
            "(void *)arg"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_increment_thd_count",
          "args": [],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "_increment_thd_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "497-513",
          "snippet": "static void\n_increment_thd_count(void)\n{\n\tbool logged = false;\n\n\tslurm_mutex_lock(&active_mutex);\n\twhile (active_threads >= MAX_THREADS) {\n\t\tif (!logged) {\n\t\t\tinfo(\"active_threads == MAX_THREADS(%d)\",\n\t\t\t     MAX_THREADS);\n\t\t\tlogged = true;\n\t\t}\n\t\tpthread_cond_wait(&active_cond, &active_mutex);\n\t}\n\tactive_threads++;\n\tslurm_mutex_unlock(&active_mutex);\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [
            "#define MAX_THREADS\t\t256"
          ],
          "globals_used": [
            "static int             active_threads = 0;",
            "static pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;",
            "static pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;",
            "static void      _increment_thd_count(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\n#define MAX_THREADS\t\t256\n\nstatic int             active_threads = 0;\nstatic pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;\nstatic pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;\nstatic void      _increment_thd_count(void);\n\nstatic void\n_increment_thd_count(void)\n{\n\tbool logged = false;\n\n\tslurm_mutex_lock(&active_mutex);\n\twhile (active_threads >= MAX_THREADS) {\n\t\tif (!logged) {\n\t\t\tinfo(\"active_threads == MAX_THREADS(%d)\",\n\t\t\t     MAX_THREADS);\n\t\t\tlogged = true;\n\t\t}\n\t\tpthread_cond_wait(&active_cond, &active_mutex);\n\t}\n\tactive_threads++;\n\tslurm_mutex_unlock(&active_mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fd_set_close_on_exec",
          "args": [
            "fd"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_attr_destroy",
          "args": [
            "&attr"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Unable to set detachstate on attr: %m\""
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "arg"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_attr_setdetachstate",
          "args": [
            "&attr",
            "PTHREAD_CREATE_DETACHED"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_attr_init",
          "args": [
            "&attr"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "sizeof(conn_t)"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic void      _increment_thd_count(void);\nstatic void     *_registration_engine(void *arg);\nstatic void     *_service_connection(void *);\n\nstatic void\n_handle_connection(slurm_fd_t fd, slurm_addr_t *cli)\n{\n\tint            rc;\n\tpthread_attr_t attr;\n\tpthread_t      id;\n\tconn_t         *arg = xmalloc(sizeof(conn_t));\n\tint            retries = 0;\n\n\targ->fd       = fd;\n\targ->cli_addr = cli;\n\n\tslurm_attr_init(&attr);\n\trc = pthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);\n\tif (rc != 0) {\n\t\terrno = rc;\n\t\txfree(arg);\n\t\terror(\"Unable to set detachstate on attr: %m\");\n\t\tslurm_attr_destroy(&attr);\n\t\treturn;\n\t}\n\n\tfd_set_close_on_exec(fd);\n\n\t_increment_thd_count();\n\twhile (pthread_create(&id, &attr, &_service_connection, (void *)arg)) {\n\t\terror(\"msg_engine: pthread_create: %m\");\n\t\tif (++retries > 3) {\n\t\t\terror(\"running service_connection without starting \"\n\t\t\t      \"a new thread slurmd will be \"\n\t\t\t      \"unresponsive until done\");\n\n\t\t\t_service_connection((void *) arg);\n\t\t\tinfo(\"slurmd should be responsive now\");\n\t\t\tbreak;\n\t\t}\n\t\tusleep(10);\t/* sleep and again */\n\t}\n\n\treturn;\n}"
  },
  {
    "function_name": "_wait_for_all_threads",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "516-541",
    "snippet": "static void\n_wait_for_all_threads(int secs)\n{\n\tstruct timespec ts;\n\tint rc;\n\n\tts.tv_sec  = time(NULL);\n\tts.tv_nsec = 0;\n\tts.tv_sec += secs;\n\n\tslurm_mutex_lock(&active_mutex);\n\twhile (active_threads > 0) {\n\t\tverbose(\"waiting on %d active threads\", active_threads);\n\t\trc = pthread_cond_timedwait(&active_cond, &active_mutex, &ts);\n\t\tif (rc == ETIMEDOUT) {\n\t\t\terror(\"Timeout waiting for completion of %d threads\",\n\t\t\t      active_threads);\n\t\t\tpthread_cond_signal(&active_cond);\n\t\t\tslurm_mutex_unlock(&active_mutex);\n\t\t\treturn;\n\t\t}\n\t}\n\tpthread_cond_signal(&active_cond);\n\tslurm_mutex_unlock(&active_mutex);\n\tverbose(\"all threads complete\");\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int             active_threads = 0;",
      "static pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;",
      "static pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;",
      "static void      _wait_for_all_threads(int secs);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "verbose",
          "args": [
            "\"all threads complete\""
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_mutex_unlock",
          "args": [
            "&active_mutex"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_cond_signal",
          "args": [
            "&active_cond"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_mutex_unlock",
          "args": [
            "&active_mutex"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_cond_signal",
          "args": [
            "&active_cond"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Timeout waiting for completion of %d threads\"",
            "active_threads"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "_prolog_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "1386-1434",
          "snippet": "static void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _is_batch_job_finished(uint32_t job_id);",
            "static bool _job_still_running(uint32_t job_id);",
            "static void _launch_complete_add(uint32_t job_id);",
            "static void _launch_complete_log(char *type, uint32_t job_id);",
            "static void _launch_complete_rm(uint32_t job_id);",
            "static void _launch_complete_wait(uint32_t job_id);",
            "static bool _launch_job_test(uint32_t job_id);",
            "static void _note_batch_job_finished(uint32_t job_id);",
            "static bool _slurm_authorized_user(uid_t uid);",
            "static void _sync_messages_kill(kill_job_msg_t *req);",
            "static int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);",
            "static gids_t *_gids_cache_lookup(char *user, gid_t gid);",
            "static int  _add_starting_step(uint16_t type, void *req);",
            "static int  _remove_starting_step(uint16_t type, void *req);",
            "static void _add_job_running_prolog(uint32_t job_id);",
            "static void _remove_job_running_prolog(uint32_t job_id);",
            "static void _wait_for_job_running_prolog(uint32_t job_id);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic bool _is_batch_job_finished(uint32_t job_id);\nstatic bool _job_still_running(uint32_t job_id);\nstatic void _launch_complete_add(uint32_t job_id);\nstatic void _launch_complete_log(char *type, uint32_t job_id);\nstatic void _launch_complete_rm(uint32_t job_id);\nstatic void _launch_complete_wait(uint32_t job_id);\nstatic bool _launch_job_test(uint32_t job_id);\nstatic void _note_batch_job_finished(uint32_t job_id);\nstatic bool _slurm_authorized_user(uid_t uid);\nstatic void _sync_messages_kill(kill_job_msg_t *req);\nstatic int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);\nstatic gids_t *_gids_cache_lookup(char *user, gid_t gid);\nstatic int  _add_starting_step(uint16_t type, void *req);\nstatic int  _remove_starting_step(uint16_t type, void *req);\nstatic void _add_job_running_prolog(uint32_t job_id);\nstatic void _remove_job_running_prolog(uint32_t job_id);\nstatic void _wait_for_job_running_prolog(uint32_t job_id);\n\nstatic void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_cond_timedwait",
          "args": [
            "&active_cond",
            "&active_mutex",
            "&ts"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "verbose",
          "args": [
            "\"waiting on %d active threads\"",
            "active_threads"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_mutex_lock",
          "args": [
            "&active_mutex"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "NULL"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "get_up_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "274-325",
          "snippet": "extern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic int             active_threads = 0;\nstatic pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;\nstatic pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;\nstatic void      _wait_for_all_threads(int secs);\n\nstatic void\n_wait_for_all_threads(int secs)\n{\n\tstruct timespec ts;\n\tint rc;\n\n\tts.tv_sec  = time(NULL);\n\tts.tv_nsec = 0;\n\tts.tv_sec += secs;\n\n\tslurm_mutex_lock(&active_mutex);\n\twhile (active_threads > 0) {\n\t\tverbose(\"waiting on %d active threads\", active_threads);\n\t\trc = pthread_cond_timedwait(&active_cond, &active_mutex, &ts);\n\t\tif (rc == ETIMEDOUT) {\n\t\t\terror(\"Timeout waiting for completion of %d threads\",\n\t\t\t      active_threads);\n\t\t\tpthread_cond_signal(&active_cond);\n\t\t\tslurm_mutex_unlock(&active_mutex);\n\t\t\treturn;\n\t\t}\n\t}\n\tpthread_cond_signal(&active_cond);\n\tslurm_mutex_unlock(&active_mutex);\n\tverbose(\"all threads complete\");\n}"
  },
  {
    "function_name": "_increment_thd_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "497-513",
    "snippet": "static void\n_increment_thd_count(void)\n{\n\tbool logged = false;\n\n\tslurm_mutex_lock(&active_mutex);\n\twhile (active_threads >= MAX_THREADS) {\n\t\tif (!logged) {\n\t\t\tinfo(\"active_threads == MAX_THREADS(%d)\",\n\t\t\t     MAX_THREADS);\n\t\t\tlogged = true;\n\t\t}\n\t\tpthread_cond_wait(&active_cond, &active_mutex);\n\t}\n\tactive_threads++;\n\tslurm_mutex_unlock(&active_mutex);\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [
      "#define MAX_THREADS\t\t256"
    ],
    "globals_used": [
      "static int             active_threads = 0;",
      "static pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;",
      "static pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;",
      "static void      _increment_thd_count(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "slurm_mutex_unlock",
          "args": [
            "&active_mutex"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_cond_wait",
          "args": [
            "&active_cond",
            "&active_mutex"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"active_threads == MAX_THREADS(%d)\"",
            "MAX_THREADS"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "_task_info_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/slurmstepd_job.c",
          "lines": "222-232",
          "snippet": "static void\n_task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog)\n{\n\tslurm_mutex_lock(&t->mutex);\n\tslurm_mutex_unlock(&t->mutex);\n\tslurm_mutex_destroy(&t->mutex);\n\tif (multi_prog) {\n\t\txfree(t->argv);\n\t} /* otherwise, t->argv is a pointer to job->argv */\n\txfree(t);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmstepd/multi_prog.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <grp.h>",
            "#  include <string.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void _task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmstepd/multi_prog.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <grp.h>\n#  include <string.h>\n#  include \"config.h\"\n\nstatic void _task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog);\n\nstatic void\n_task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog)\n{\n\tslurm_mutex_lock(&t->mutex);\n\tslurm_mutex_unlock(&t->mutex);\n\tslurm_mutex_destroy(&t->mutex);\n\tif (multi_prog) {\n\t\txfree(t->argv);\n\t} /* otherwise, t->argv is a pointer to job->argv */\n\txfree(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_mutex_lock",
          "args": [
            "&active_mutex"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\n#define MAX_THREADS\t\t256\n\nstatic int             active_threads = 0;\nstatic pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;\nstatic pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;\nstatic void      _increment_thd_count(void);\n\nstatic void\n_increment_thd_count(void)\n{\n\tbool logged = false;\n\n\tslurm_mutex_lock(&active_mutex);\n\twhile (active_threads >= MAX_THREADS) {\n\t\tif (!logged) {\n\t\t\tinfo(\"active_threads == MAX_THREADS(%d)\",\n\t\t\t     MAX_THREADS);\n\t\t\tlogged = true;\n\t\t}\n\t\tpthread_cond_wait(&active_cond, &active_mutex);\n\t}\n\tactive_threads++;\n\tslurm_mutex_unlock(&active_mutex);\n}"
  },
  {
    "function_name": "_decrement_thd_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "487-495",
    "snippet": "static void\n_decrement_thd_count(void)\n{\n\tslurm_mutex_lock(&active_mutex);\n\tif (active_threads > 0)\n\t\tactive_threads--;\n\tpthread_cond_signal(&active_cond);\n\tslurm_mutex_unlock(&active_mutex);\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int             active_threads = 0;",
      "static pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;",
      "static pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;",
      "static void      _decrement_thd_count(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "slurm_mutex_unlock",
          "args": [
            "&active_mutex"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_cond_signal",
          "args": [
            "&active_cond"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_mutex_lock",
          "args": [
            "&active_mutex"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic int             active_threads = 0;\nstatic pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;\nstatic pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;\nstatic void      _decrement_thd_count(void);\n\nstatic void\n_decrement_thd_count(void)\n{\n\tslurm_mutex_lock(&active_mutex);\n\tif (active_threads > 0)\n\t\tactive_threads--;\n\tpthread_cond_signal(&active_cond);\n\tslurm_mutex_unlock(&active_mutex);\n}"
  },
  {
    "function_name": "_msg_engine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "454-485",
    "snippet": "static void\n_msg_engine(void)\n{\n\tslurm_addr_t *cli;\n\tslurm_fd_t sock;\n\n\tmsg_pthread = pthread_self();\n\tslurmd_req(NULL);\t/* initialize timer */\n\twhile (!_shutdown) {\n\t\tif (_reconfig) {\n\t\t\tverbose(\"got reconfigure request\");\n\t\t\t_wait_for_all_threads(5); /* Wait for RPCs to finish */\n\t\t\t_reconfigure();\n\t\t}\n\n\t\tcli = xmalloc (sizeof (slurm_addr_t));\n\t\tif ((sock = slurm_accept_msg_conn(conf->lfd, cli)) >= 0) {\n\t\t\t_handle_connection(sock, cli);\n\t\t\tcontinue;\n\t\t}\n\t\t/*\n\t\t *  Otherwise, accept() failed.\n\t\t */\n\t\txfree (cli);\n\t\tif (errno == EINTR)\n\t\t\tcontinue;\n\t\terror(\"accept: %m\");\n\t}\n\tverbose(\"got shutdown request\");\n\tslurm_shutdown_msg_engine(conf->lfd);\n\treturn;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static sig_atomic_t _shutdown = 0;",
      "static sig_atomic_t _reconfig = 0;",
      "static pthread_t msg_pthread = (pthread_t) 0;",
      "static void      _msg_engine(void);",
      "static void      _reconfigure(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "slurm_shutdown_msg_engine",
          "args": [
            "conf->lfd"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "verbose",
          "args": [
            "\"got shutdown request\""
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"accept: %m\""
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "cli"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_handle_connection",
          "args": [
            "sock",
            "cli"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "_handle_connection",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "543-583",
          "snippet": "static void\n_handle_connection(slurm_fd_t fd, slurm_addr_t *cli)\n{\n\tint            rc;\n\tpthread_attr_t attr;\n\tpthread_t      id;\n\tconn_t         *arg = xmalloc(sizeof(conn_t));\n\tint            retries = 0;\n\n\targ->fd       = fd;\n\targ->cli_addr = cli;\n\n\tslurm_attr_init(&attr);\n\trc = pthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);\n\tif (rc != 0) {\n\t\terrno = rc;\n\t\txfree(arg);\n\t\terror(\"Unable to set detachstate on attr: %m\");\n\t\tslurm_attr_destroy(&attr);\n\t\treturn;\n\t}\n\n\tfd_set_close_on_exec(fd);\n\n\t_increment_thd_count();\n\twhile (pthread_create(&id, &attr, &_service_connection, (void *)arg)) {\n\t\terror(\"msg_engine: pthread_create: %m\");\n\t\tif (++retries > 3) {\n\t\t\terror(\"running service_connection without starting \"\n\t\t\t      \"a new thread slurmd will be \"\n\t\t\t      \"unresponsive until done\");\n\n\t\t\t_service_connection((void *) arg);\n\t\t\tinfo(\"slurmd should be responsive now\");\n\t\t\tbreak;\n\t\t}\n\t\tusleep(10);\t/* sleep and again */\n\t}\n\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void      _increment_thd_count(void);",
            "static void     *_registration_engine(void *arg);",
            "static void     *_service_connection(void *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic void      _increment_thd_count(void);\nstatic void     *_registration_engine(void *arg);\nstatic void     *_service_connection(void *);\n\nstatic void\n_handle_connection(slurm_fd_t fd, slurm_addr_t *cli)\n{\n\tint            rc;\n\tpthread_attr_t attr;\n\tpthread_t      id;\n\tconn_t         *arg = xmalloc(sizeof(conn_t));\n\tint            retries = 0;\n\n\targ->fd       = fd;\n\targ->cli_addr = cli;\n\n\tslurm_attr_init(&attr);\n\trc = pthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);\n\tif (rc != 0) {\n\t\terrno = rc;\n\t\txfree(arg);\n\t\terror(\"Unable to set detachstate on attr: %m\");\n\t\tslurm_attr_destroy(&attr);\n\t\treturn;\n\t}\n\n\tfd_set_close_on_exec(fd);\n\n\t_increment_thd_count();\n\twhile (pthread_create(&id, &attr, &_service_connection, (void *)arg)) {\n\t\terror(\"msg_engine: pthread_create: %m\");\n\t\tif (++retries > 3) {\n\t\t\terror(\"running service_connection without starting \"\n\t\t\t      \"a new thread slurmd will be \"\n\t\t\t      \"unresponsive until done\");\n\n\t\t\t_service_connection((void *) arg);\n\t\t\tinfo(\"slurmd should be responsive now\");\n\t\t\tbreak;\n\t\t}\n\t\tusleep(10);\t/* sleep and again */\n\t}\n\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_accept_msg_conn",
          "args": [
            "conf->lfd",
            "cli"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "sizeof (slurm_addr_t)"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_reconfigure",
          "args": [],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "_reconfigure",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1052-1137",
          "snippet": "static void\n_reconfigure(void)\n{\n\tList steps;\n\tListIterator i;\n\tstep_loc_t *stepd;\n\tbool did_change;\n\n\t_reconfig = 0;\n\tslurm_conf_reinit(conf->conffile);\n\t_read_config();\n\n\t/*\n\t * Rebuild topology information and refresh slurmd topo infos\n\t */\n\tslurm_topo_build_config();\n\t_set_topo_info();\n\troute_g_reconfigure();\n\tcpu_freq_reconfig();\n\n\tmsg_aggr_sender_reconfig(conf->msg_aggr_window_time,\n\t\t\t\t conf->msg_aggr_window_msgs);\n\n\t/*\n\t * In case the administrator changed the cpu frequency set capabilities\n\t * on this node, rebuild the cpu frequency table information\n\t */\n\tcpu_freq_init(conf);\n\n\t/*\n\t * If configured, apply resource specialization\n\t */\n\t_resource_spec_init();\n\n\t_print_conf();\n\n\t/*\n\t * Make best effort at changing to new public key\n\t */\n\tslurm_cred_ctx_key_update(conf->vctx, conf->pubkey);\n\n\t/*\n\t * Purge the username -> grouplist cache.\n\t */\n\tgids_cache_purge();\n\n\t/* send reconfig to each stepd so they can refresh their log\n\t * file handle\n\t */\n\n\tsteps = stepd_available(conf->spooldir, conf->node_name);\n\ti = list_iterator_create(steps);\n\twhile ((stepd = list_next(i))) {\n\t\tint fd;\n\t\tfd = stepd_connect(stepd->directory, stepd->nodename,\n\t\t\t\t   stepd->jobid, stepd->stepid,\n\t\t\t\t   &stepd->protocol_version);\n\t\tif (fd == -1)\n\t\t\tcontinue;\n\n\t\tif (stepd_reconfig(fd, stepd->protocol_version)\n\t\t    != SLURM_SUCCESS)\n\t\t\tdebug(\"Reconfig jobid=%u.%u failed: %m\",\n\t\t\t      stepd->jobid, stepd->stepid);\n\t\tclose(fd);\n\t}\n\tlist_iterator_destroy(i);\n\tFREE_NULL_LIST(steps);\n\n\tgres_plugin_reconfig(&did_change);\n\t(void) switch_g_reconfig();\n\tcontainer_g_reconfig();\n\tif (did_change) {\n\t\tuint32_t cpu_cnt = MAX(conf->conf_cpus, conf->block_map_size);\n\t\t(void) gres_plugin_node_config_load(cpu_cnt, conf->node_name,\n\t\t\t\t\t\t    NULL);\n\t\tsend_registration_msg(SLURM_SUCCESS, false);\n\t}\n\n\t/* reconfigure energy */\n\tacct_gather_energy_g_set_data(ENERGY_DATA_RECONFIG, NULL);\n\n\t/*\n\t * XXX: reopen slurmd port?\n\t */\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static sig_atomic_t _reconfig = 0;",
            "static void      _print_conf(void);",
            "static void      _read_config(void);",
            "static void      _reconfigure(void);",
            "static int       _resource_spec_init(void);",
            "static int       _set_topo_info(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic sig_atomic_t _reconfig = 0;\nstatic void      _print_conf(void);\nstatic void      _read_config(void);\nstatic void      _reconfigure(void);\nstatic int       _resource_spec_init(void);\nstatic int       _set_topo_info(void);\n\nstatic void\n_reconfigure(void)\n{\n\tList steps;\n\tListIterator i;\n\tstep_loc_t *stepd;\n\tbool did_change;\n\n\t_reconfig = 0;\n\tslurm_conf_reinit(conf->conffile);\n\t_read_config();\n\n\t/*\n\t * Rebuild topology information and refresh slurmd topo infos\n\t */\n\tslurm_topo_build_config();\n\t_set_topo_info();\n\troute_g_reconfigure();\n\tcpu_freq_reconfig();\n\n\tmsg_aggr_sender_reconfig(conf->msg_aggr_window_time,\n\t\t\t\t conf->msg_aggr_window_msgs);\n\n\t/*\n\t * In case the administrator changed the cpu frequency set capabilities\n\t * on this node, rebuild the cpu frequency table information\n\t */\n\tcpu_freq_init(conf);\n\n\t/*\n\t * If configured, apply resource specialization\n\t */\n\t_resource_spec_init();\n\n\t_print_conf();\n\n\t/*\n\t * Make best effort at changing to new public key\n\t */\n\tslurm_cred_ctx_key_update(conf->vctx, conf->pubkey);\n\n\t/*\n\t * Purge the username -> grouplist cache.\n\t */\n\tgids_cache_purge();\n\n\t/* send reconfig to each stepd so they can refresh their log\n\t * file handle\n\t */\n\n\tsteps = stepd_available(conf->spooldir, conf->node_name);\n\ti = list_iterator_create(steps);\n\twhile ((stepd = list_next(i))) {\n\t\tint fd;\n\t\tfd = stepd_connect(stepd->directory, stepd->nodename,\n\t\t\t\t   stepd->jobid, stepd->stepid,\n\t\t\t\t   &stepd->protocol_version);\n\t\tif (fd == -1)\n\t\t\tcontinue;\n\n\t\tif (stepd_reconfig(fd, stepd->protocol_version)\n\t\t    != SLURM_SUCCESS)\n\t\t\tdebug(\"Reconfig jobid=%u.%u failed: %m\",\n\t\t\t      stepd->jobid, stepd->stepid);\n\t\tclose(fd);\n\t}\n\tlist_iterator_destroy(i);\n\tFREE_NULL_LIST(steps);\n\n\tgres_plugin_reconfig(&did_change);\n\t(void) switch_g_reconfig();\n\tcontainer_g_reconfig();\n\tif (did_change) {\n\t\tuint32_t cpu_cnt = MAX(conf->conf_cpus, conf->block_map_size);\n\t\t(void) gres_plugin_node_config_load(cpu_cnt, conf->node_name,\n\t\t\t\t\t\t    NULL);\n\t\tsend_registration_msg(SLURM_SUCCESS, false);\n\t}\n\n\t/* reconfigure energy */\n\tacct_gather_energy_g_set_data(ENERGY_DATA_RECONFIG, NULL);\n\n\t/*\n\t * XXX: reopen slurmd port?\n\t */\n}"
        }
      },
      {
        "call_info": {
          "callee": "_wait_for_all_threads",
          "args": [
            "5"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "_wait_for_all_threads",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "516-541",
          "snippet": "static void\n_wait_for_all_threads(int secs)\n{\n\tstruct timespec ts;\n\tint rc;\n\n\tts.tv_sec  = time(NULL);\n\tts.tv_nsec = 0;\n\tts.tv_sec += secs;\n\n\tslurm_mutex_lock(&active_mutex);\n\twhile (active_threads > 0) {\n\t\tverbose(\"waiting on %d active threads\", active_threads);\n\t\trc = pthread_cond_timedwait(&active_cond, &active_mutex, &ts);\n\t\tif (rc == ETIMEDOUT) {\n\t\t\terror(\"Timeout waiting for completion of %d threads\",\n\t\t\t      active_threads);\n\t\t\tpthread_cond_signal(&active_cond);\n\t\t\tslurm_mutex_unlock(&active_mutex);\n\t\t\treturn;\n\t\t}\n\t}\n\tpthread_cond_signal(&active_cond);\n\tslurm_mutex_unlock(&active_mutex);\n\tverbose(\"all threads complete\");\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int             active_threads = 0;",
            "static pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;",
            "static pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;",
            "static void      _wait_for_all_threads(int secs);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic int             active_threads = 0;\nstatic pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;\nstatic pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;\nstatic void      _wait_for_all_threads(int secs);\n\nstatic void\n_wait_for_all_threads(int secs)\n{\n\tstruct timespec ts;\n\tint rc;\n\n\tts.tv_sec  = time(NULL);\n\tts.tv_nsec = 0;\n\tts.tv_sec += secs;\n\n\tslurm_mutex_lock(&active_mutex);\n\twhile (active_threads > 0) {\n\t\tverbose(\"waiting on %d active threads\", active_threads);\n\t\trc = pthread_cond_timedwait(&active_cond, &active_mutex, &ts);\n\t\tif (rc == ETIMEDOUT) {\n\t\t\terror(\"Timeout waiting for completion of %d threads\",\n\t\t\t      active_threads);\n\t\t\tpthread_cond_signal(&active_cond);\n\t\t\tslurm_mutex_unlock(&active_mutex);\n\t\t\treturn;\n\t\t}\n\t}\n\tpthread_cond_signal(&active_cond);\n\tslurm_mutex_unlock(&active_mutex);\n\tverbose(\"all threads complete\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "verbose",
          "args": [
            "\"got reconfigure request\""
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurmd_req",
          "args": [
            "NULL"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "slurmd_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "278-458",
          "snippet": "void\nslurmd_req(slurm_msg_t *msg)\n{\n\tint rc;\n\n\tif (msg == NULL) {\n\t\tif (startup == 0)\n\t\t\tstartup = time(NULL);\n\t\tFREE_NULL_LIST(waiters);\n\t\tslurm_mutex_lock(&job_limits_mutex);\n\t\tif (job_limits_list) {\n\t\t\tFREE_NULL_LIST(job_limits_list);\n\t\t\tjob_limits_loaded = false;\n\t\t}\n\t\tslurm_mutex_unlock(&job_limits_mutex);\n\t\treturn;\n\t}\n\n\tswitch (msg->msg_type) {\n\tcase REQUEST_LAUNCH_PROLOG:\n\t\tdebug2(\"Processing RPC: REQUEST_LAUNCH_PROLOG\");\n\t\t_rpc_prolog(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_BATCH_JOB_LAUNCH:\n\t\tdebug2(\"Processing RPC: REQUEST_BATCH_JOB_LAUNCH\");\n\t\t/* Mutex locking moved into _rpc_batch_job() due to\n\t\t * very slow prolog on Blue Gene system. Only batch\n\t\t * jobs are supported on Blue Gene (no job steps). */\n\t\t_rpc_batch_job(msg, true);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_LAUNCH_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_LAUNCH_TASKS\");\n\t\tslurm_mutex_lock(&launch_mutex);\n\t\t_rpc_launch_tasks(msg);\n\t\tslurm_mutex_unlock(&launch_mutex);\n\t\tbreak;\n\tcase REQUEST_SIGNAL_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_SIGNAL_TASKS\");\n\t\t_rpc_signal_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_CHECKPOINT_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_CHECKPOINT_TASKS\");\n\t\t_rpc_checkpoint_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_TERMINATE_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_TERMINATE_TASKS\");\n\t\t_rpc_terminate_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_KILL_PREEMPTED:\n\t\tdebug2(\"Processing RPC: REQUEST_KILL_PREEMPTED\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_timelimit(msg);\n\t\tbreak;\n\tcase REQUEST_KILL_TIMELIMIT:\n\t\tdebug2(\"Processing RPC: REQUEST_KILL_TIMELIMIT\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_timelimit(msg);\n\t\tbreak;\n\tcase REQUEST_REATTACH_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_REATTACH_TASKS\");\n\t\t_rpc_reattach_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_SIGNAL_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_SIGNAL_JOB\");\n\t\t_rpc_signal_job(msg);\n\t\tbreak;\n\tcase REQUEST_SUSPEND_INT:\n\t\tdebug2(\"Processing RPC: REQUEST_SUSPEND_INT\");\n\t\t_rpc_suspend_job(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ABORT_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_ABORT_JOB\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_abort_job(msg);\n\t\tbreak;\n\tcase REQUEST_TERMINATE_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_TERMINATE_JOB\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_terminate_job(msg);\n\t\tbreak;\n\tcase REQUEST_COMPLETE_BATCH_SCRIPT:\n\t\tdebug2(\"Processing RPC: REQUEST_COMPLETE_BATCH_SCRIPT\");\n\t\t_rpc_complete_batch(msg);\n\t\tbreak;\n\tcase REQUEST_UPDATE_JOB_TIME:\n\t\tdebug2(\"Processing RPC: REQUEST_UPDATE_JOB_TIME\");\n\t\t_rpc_update_time(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_SHUTDOWN:\n\t\tdebug2(\"Processing RPC: REQUEST_SHUTDOWN\");\n\t\t_rpc_shutdown(msg);\n\t\tbreak;\n\tcase REQUEST_RECONFIGURE:\n\t\tdebug2(\"Processing RPC: REQUEST_RECONFIGURE\");\n\t\t_rpc_reconfig(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_REBOOT_NODES:\n\t\tdebug2(\"Processing RPC: REQUEST_REBOOT_NODES\");\n\t\t_rpc_reboot(msg);\n\t\tbreak;\n\tcase REQUEST_NODE_REGISTRATION_STATUS:\n\t\tdebug2(\"Processing RPC: REQUEST_NODE_REGISTRATION_STATUS\");\n\t\t/* Treat as ping (for slurmctld agent, just return SUCCESS) */\n\t\trc = _rpc_ping(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t/* Then initiate a separate node registration */\n\t\tif (rc == SLURM_SUCCESS)\n\t\t\tsend_registration_msg(SLURM_SUCCESS, true);\n\t\tbreak;\n\tcase REQUEST_PING:\n\t\t_rpc_ping(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_HEALTH_CHECK:\n\t\tdebug2(\"Processing RPC: REQUEST_HEALTH_CHECK\");\n\t\t_rpc_health_check(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ACCT_GATHER_UPDATE:\n\t\tdebug2(\"Processing RPC: REQUEST_ACCT_GATHER_UPDATE\");\n\t\t_rpc_acct_gather_update(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ACCT_GATHER_ENERGY:\n\t\tdebug2(\"Processing RPC: REQUEST_ACCT_GATHER_ENERGY\");\n\t\t_rpc_acct_gather_energy(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_ID:\n\t\t_rpc_pid2jid(msg);\n\t\tbreak;\n\tcase REQUEST_FILE_BCAST:\n\t\trc = _rpc_file_bcast(msg);\n\t\tslurm_send_rc_msg(msg, rc);\n\t\tbreak;\n\tcase REQUEST_STEP_COMPLETE:\n\t\t(void) _rpc_step_complete(msg);\n\t\tbreak;\n\tcase REQUEST_STEP_COMPLETE_AGGR:\n\t\t(void) _rpc_step_complete_aggr(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_STEP_STAT:\n\t\t(void) _rpc_stat_jobacct(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_STEP_PIDS:\n\t\t(void) _rpc_list_pids(msg);\n\t\tbreak;\n\tcase REQUEST_DAEMON_STATUS:\n\t\t_rpc_daemon_status(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_NOTIFY:\n\t\t_rpc_job_notify(msg);\n\t\tbreak;\n\tcase REQUEST_FORWARD_DATA:\n\t\t_rpc_forward_data(msg);\n\t\tbreak;\n\tcase REQUEST_NETWORK_CALLERID:\n\t\tdebug2(\"Processing RPC: REQUEST_NETWORK_CALLERID\");\n\t\t_rpc_network_callerid(msg);\n\t\tbreak;\n\tcase MESSAGE_COMPOSITE:\n\t\terror(\"Processing RPC: MESSAGE_COMPOSITE: \"\n\t\t      \"This should never happen\");\n\t\tmsg_aggr_add_msg(msg, 0, NULL);\n\t\tbreak;\n\tcase RESPONSE_MESSAGE_COMPOSITE:\n\t\tdebug2(\"Processing RPC: RESPONSE_MESSAGE_COMPOSITE\");\n\t\tmsg_aggr_resp(msg);\n\t\tbreak;\n\tdefault:\n\t\terror(\"slurmd_req: invalid request msg type %d\",\n\t\t      msg->msg_type);\n\t\tslurm_send_rc_msg(msg, EINVAL);\n\t\tbreak;\n\t}\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int  _kill_all_active_steps(uint32_t jobid, int sig, bool batch);",
            "static int  _terminate_all_steps(uint32_t jobid, bool batch);",
            "static void _rpc_launch_tasks(slurm_msg_t *);",
            "static void _rpc_abort_job(slurm_msg_t *);",
            "static void _rpc_prolog(slurm_msg_t *msg);",
            "static void _rpc_job_notify(slurm_msg_t *);",
            "static void _rpc_signal_tasks(slurm_msg_t *);",
            "static void _rpc_checkpoint_tasks(slurm_msg_t *);",
            "static void _rpc_complete_batch(slurm_msg_t *);",
            "static void _rpc_terminate_tasks(slurm_msg_t *);",
            "static void _rpc_timelimit(slurm_msg_t *);",
            "static void _rpc_reattach_tasks(slurm_msg_t *);",
            "static void _rpc_signal_job(slurm_msg_t *);",
            "static void _rpc_suspend_job(slurm_msg_t *msg);",
            "static void _rpc_terminate_job(slurm_msg_t *);",
            "static void _rpc_update_time(slurm_msg_t *);",
            "static void _rpc_shutdown(slurm_msg_t *msg);",
            "static void _rpc_reconfig(slurm_msg_t *msg);",
            "static void _rpc_reboot(slurm_msg_t *msg);",
            "static void _rpc_pid2jid(slurm_msg_t *msg);",
            "static int  _rpc_file_bcast(slurm_msg_t *msg);",
            "static int  _rpc_ping(slurm_msg_t *);",
            "static int  _rpc_health_check(slurm_msg_t *);",
            "static int  _rpc_acct_gather_update(slurm_msg_t *);",
            "static int  _rpc_acct_gather_energy(slurm_msg_t *);",
            "static int  _rpc_step_complete(slurm_msg_t *msg);",
            "static int  _rpc_step_complete_aggr(slurm_msg_t *msg);",
            "static int  _rpc_stat_jobacct(slurm_msg_t *msg);",
            "static int  _rpc_list_pids(slurm_msg_t *msg);",
            "static int  _rpc_daemon_status(slurm_msg_t *msg);",
            "static void _rpc_forward_data(slurm_msg_t *msg);",
            "static int  _rpc_network_callerid(slurm_msg_t *msg);",
            "static List waiters;",
            "static pthread_mutex_t launch_mutex = PTHREAD_MUTEX_INITIALIZER;",
            "static time_t startup = 0;",
            "static time_t last_slurmctld_msg = 0;",
            "static pthread_mutex_t job_limits_mutex = PTHREAD_MUTEX_INITIALIZER;",
            "static List job_limits_list = NULL;",
            "static bool job_limits_loaded = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic int  _kill_all_active_steps(uint32_t jobid, int sig, bool batch);\nstatic int  _terminate_all_steps(uint32_t jobid, bool batch);\nstatic void _rpc_launch_tasks(slurm_msg_t *);\nstatic void _rpc_abort_job(slurm_msg_t *);\nstatic void _rpc_prolog(slurm_msg_t *msg);\nstatic void _rpc_job_notify(slurm_msg_t *);\nstatic void _rpc_signal_tasks(slurm_msg_t *);\nstatic void _rpc_checkpoint_tasks(slurm_msg_t *);\nstatic void _rpc_complete_batch(slurm_msg_t *);\nstatic void _rpc_terminate_tasks(slurm_msg_t *);\nstatic void _rpc_timelimit(slurm_msg_t *);\nstatic void _rpc_reattach_tasks(slurm_msg_t *);\nstatic void _rpc_signal_job(slurm_msg_t *);\nstatic void _rpc_suspend_job(slurm_msg_t *msg);\nstatic void _rpc_terminate_job(slurm_msg_t *);\nstatic void _rpc_update_time(slurm_msg_t *);\nstatic void _rpc_shutdown(slurm_msg_t *msg);\nstatic void _rpc_reconfig(slurm_msg_t *msg);\nstatic void _rpc_reboot(slurm_msg_t *msg);\nstatic void _rpc_pid2jid(slurm_msg_t *msg);\nstatic int  _rpc_file_bcast(slurm_msg_t *msg);\nstatic int  _rpc_ping(slurm_msg_t *);\nstatic int  _rpc_health_check(slurm_msg_t *);\nstatic int  _rpc_acct_gather_update(slurm_msg_t *);\nstatic int  _rpc_acct_gather_energy(slurm_msg_t *);\nstatic int  _rpc_step_complete(slurm_msg_t *msg);\nstatic int  _rpc_step_complete_aggr(slurm_msg_t *msg);\nstatic int  _rpc_stat_jobacct(slurm_msg_t *msg);\nstatic int  _rpc_list_pids(slurm_msg_t *msg);\nstatic int  _rpc_daemon_status(slurm_msg_t *msg);\nstatic void _rpc_forward_data(slurm_msg_t *msg);\nstatic int  _rpc_network_callerid(slurm_msg_t *msg);\nstatic List waiters;\nstatic pthread_mutex_t launch_mutex = PTHREAD_MUTEX_INITIALIZER;\nstatic time_t startup = 0;\nstatic time_t last_slurmctld_msg = 0;\nstatic pthread_mutex_t job_limits_mutex = PTHREAD_MUTEX_INITIALIZER;\nstatic List job_limits_list = NULL;\nstatic bool job_limits_loaded = false;\n\nvoid\nslurmd_req(slurm_msg_t *msg)\n{\n\tint rc;\n\n\tif (msg == NULL) {\n\t\tif (startup == 0)\n\t\t\tstartup = time(NULL);\n\t\tFREE_NULL_LIST(waiters);\n\t\tslurm_mutex_lock(&job_limits_mutex);\n\t\tif (job_limits_list) {\n\t\t\tFREE_NULL_LIST(job_limits_list);\n\t\t\tjob_limits_loaded = false;\n\t\t}\n\t\tslurm_mutex_unlock(&job_limits_mutex);\n\t\treturn;\n\t}\n\n\tswitch (msg->msg_type) {\n\tcase REQUEST_LAUNCH_PROLOG:\n\t\tdebug2(\"Processing RPC: REQUEST_LAUNCH_PROLOG\");\n\t\t_rpc_prolog(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_BATCH_JOB_LAUNCH:\n\t\tdebug2(\"Processing RPC: REQUEST_BATCH_JOB_LAUNCH\");\n\t\t/* Mutex locking moved into _rpc_batch_job() due to\n\t\t * very slow prolog on Blue Gene system. Only batch\n\t\t * jobs are supported on Blue Gene (no job steps). */\n\t\t_rpc_batch_job(msg, true);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_LAUNCH_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_LAUNCH_TASKS\");\n\t\tslurm_mutex_lock(&launch_mutex);\n\t\t_rpc_launch_tasks(msg);\n\t\tslurm_mutex_unlock(&launch_mutex);\n\t\tbreak;\n\tcase REQUEST_SIGNAL_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_SIGNAL_TASKS\");\n\t\t_rpc_signal_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_CHECKPOINT_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_CHECKPOINT_TASKS\");\n\t\t_rpc_checkpoint_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_TERMINATE_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_TERMINATE_TASKS\");\n\t\t_rpc_terminate_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_KILL_PREEMPTED:\n\t\tdebug2(\"Processing RPC: REQUEST_KILL_PREEMPTED\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_timelimit(msg);\n\t\tbreak;\n\tcase REQUEST_KILL_TIMELIMIT:\n\t\tdebug2(\"Processing RPC: REQUEST_KILL_TIMELIMIT\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_timelimit(msg);\n\t\tbreak;\n\tcase REQUEST_REATTACH_TASKS:\n\t\tdebug2(\"Processing RPC: REQUEST_REATTACH_TASKS\");\n\t\t_rpc_reattach_tasks(msg);\n\t\tbreak;\n\tcase REQUEST_SIGNAL_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_SIGNAL_JOB\");\n\t\t_rpc_signal_job(msg);\n\t\tbreak;\n\tcase REQUEST_SUSPEND_INT:\n\t\tdebug2(\"Processing RPC: REQUEST_SUSPEND_INT\");\n\t\t_rpc_suspend_job(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ABORT_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_ABORT_JOB\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_abort_job(msg);\n\t\tbreak;\n\tcase REQUEST_TERMINATE_JOB:\n\t\tdebug2(\"Processing RPC: REQUEST_TERMINATE_JOB\");\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t_rpc_terminate_job(msg);\n\t\tbreak;\n\tcase REQUEST_COMPLETE_BATCH_SCRIPT:\n\t\tdebug2(\"Processing RPC: REQUEST_COMPLETE_BATCH_SCRIPT\");\n\t\t_rpc_complete_batch(msg);\n\t\tbreak;\n\tcase REQUEST_UPDATE_JOB_TIME:\n\t\tdebug2(\"Processing RPC: REQUEST_UPDATE_JOB_TIME\");\n\t\t_rpc_update_time(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_SHUTDOWN:\n\t\tdebug2(\"Processing RPC: REQUEST_SHUTDOWN\");\n\t\t_rpc_shutdown(msg);\n\t\tbreak;\n\tcase REQUEST_RECONFIGURE:\n\t\tdebug2(\"Processing RPC: REQUEST_RECONFIGURE\");\n\t\t_rpc_reconfig(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_REBOOT_NODES:\n\t\tdebug2(\"Processing RPC: REQUEST_REBOOT_NODES\");\n\t\t_rpc_reboot(msg);\n\t\tbreak;\n\tcase REQUEST_NODE_REGISTRATION_STATUS:\n\t\tdebug2(\"Processing RPC: REQUEST_NODE_REGISTRATION_STATUS\");\n\t\t/* Treat as ping (for slurmctld agent, just return SUCCESS) */\n\t\trc = _rpc_ping(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\t/* Then initiate a separate node registration */\n\t\tif (rc == SLURM_SUCCESS)\n\t\t\tsend_registration_msg(SLURM_SUCCESS, true);\n\t\tbreak;\n\tcase REQUEST_PING:\n\t\t_rpc_ping(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_HEALTH_CHECK:\n\t\tdebug2(\"Processing RPC: REQUEST_HEALTH_CHECK\");\n\t\t_rpc_health_check(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ACCT_GATHER_UPDATE:\n\t\tdebug2(\"Processing RPC: REQUEST_ACCT_GATHER_UPDATE\");\n\t\t_rpc_acct_gather_update(msg);\n\t\tlast_slurmctld_msg = time(NULL);\n\t\tbreak;\n\tcase REQUEST_ACCT_GATHER_ENERGY:\n\t\tdebug2(\"Processing RPC: REQUEST_ACCT_GATHER_ENERGY\");\n\t\t_rpc_acct_gather_energy(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_ID:\n\t\t_rpc_pid2jid(msg);\n\t\tbreak;\n\tcase REQUEST_FILE_BCAST:\n\t\trc = _rpc_file_bcast(msg);\n\t\tslurm_send_rc_msg(msg, rc);\n\t\tbreak;\n\tcase REQUEST_STEP_COMPLETE:\n\t\t(void) _rpc_step_complete(msg);\n\t\tbreak;\n\tcase REQUEST_STEP_COMPLETE_AGGR:\n\t\t(void) _rpc_step_complete_aggr(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_STEP_STAT:\n\t\t(void) _rpc_stat_jobacct(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_STEP_PIDS:\n\t\t(void) _rpc_list_pids(msg);\n\t\tbreak;\n\tcase REQUEST_DAEMON_STATUS:\n\t\t_rpc_daemon_status(msg);\n\t\tbreak;\n\tcase REQUEST_JOB_NOTIFY:\n\t\t_rpc_job_notify(msg);\n\t\tbreak;\n\tcase REQUEST_FORWARD_DATA:\n\t\t_rpc_forward_data(msg);\n\t\tbreak;\n\tcase REQUEST_NETWORK_CALLERID:\n\t\tdebug2(\"Processing RPC: REQUEST_NETWORK_CALLERID\");\n\t\t_rpc_network_callerid(msg);\n\t\tbreak;\n\tcase MESSAGE_COMPOSITE:\n\t\terror(\"Processing RPC: MESSAGE_COMPOSITE: \"\n\t\t      \"This should never happen\");\n\t\tmsg_aggr_add_msg(msg, 0, NULL);\n\t\tbreak;\n\tcase RESPONSE_MESSAGE_COMPOSITE:\n\t\tdebug2(\"Processing RPC: RESPONSE_MESSAGE_COMPOSITE\");\n\t\tmsg_aggr_resp(msg);\n\t\tbreak;\n\tdefault:\n\t\terror(\"slurmd_req: invalid request msg type %d\",\n\t\t      msg->msg_type);\n\t\tslurm_send_rc_msg(msg, EINVAL);\n\t\tbreak;\n\t}\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_self",
          "args": [],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic sig_atomic_t _shutdown = 0;\nstatic sig_atomic_t _reconfig = 0;\nstatic pthread_t msg_pthread = (pthread_t) 0;\nstatic void      _msg_engine(void);\nstatic void      _reconfigure(void);\n\nstatic void\n_msg_engine(void)\n{\n\tslurm_addr_t *cli;\n\tslurm_fd_t sock;\n\n\tmsg_pthread = pthread_self();\n\tslurmd_req(NULL);\t/* initialize timer */\n\twhile (!_shutdown) {\n\t\tif (_reconfig) {\n\t\t\tverbose(\"got reconfigure request\");\n\t\t\t_wait_for_all_threads(5); /* Wait for RPCs to finish */\n\t\t\t_reconfigure();\n\t\t}\n\n\t\tcli = xmalloc (sizeof (slurm_addr_t));\n\t\tif ((sock = slurm_accept_msg_conn(conf->lfd, cli)) >= 0) {\n\t\t\t_handle_connection(sock, cli);\n\t\t\tcontinue;\n\t\t}\n\t\t/*\n\t\t *  Otherwise, accept() failed.\n\t\t */\n\t\txfree (cli);\n\t\tif (errno == EINTR)\n\t\t\tcontinue;\n\t\terror(\"accept: %m\");\n\t}\n\tverbose(\"got shutdown request\");\n\tslurm_shutdown_msg_engine(conf->lfd);\n\treturn;\n}"
  },
  {
    "function_name": "_registration_engine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "433-452",
    "snippet": "static void *\n_registration_engine(void *arg)\n{\n\t_increment_thd_count();\n\n\twhile (!_shutdown) {\n\t\tif ((sent_reg_time == (time_t) 0) &&\n\t\t    (send_registration_msg(SLURM_SUCCESS, true) !=\n\t\t     SLURM_SUCCESS)) {\n\t\t\tdebug(\"Unable to register with slurm controller, \"\n\t\t\t      \"retrying\");\n\t\t} else if (_shutdown || sent_reg_time) {\n\t\t\tbreak;\n\t\t}\n\t\tsleep(1);\n\t}\n\n\t_decrement_thd_count();\n\treturn NULL;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static sig_atomic_t _shutdown = 0;",
      "static time_t sent_reg_time = (time_t) 0;",
      "static void      _decrement_thd_count(void);",
      "static void      _increment_thd_count(void);",
      "static void     *_registration_engine(void *arg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_decrement_thd_count",
          "args": [],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "_decrement_thd_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "487-495",
          "snippet": "static void\n_decrement_thd_count(void)\n{\n\tslurm_mutex_lock(&active_mutex);\n\tif (active_threads > 0)\n\t\tactive_threads--;\n\tpthread_cond_signal(&active_cond);\n\tslurm_mutex_unlock(&active_mutex);\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int             active_threads = 0;",
            "static pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;",
            "static pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;",
            "static void      _decrement_thd_count(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic int             active_threads = 0;\nstatic pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;\nstatic pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;\nstatic void      _decrement_thd_count(void);\n\nstatic void\n_decrement_thd_count(void)\n{\n\tslurm_mutex_lock(&active_mutex);\n\tif (active_threads > 0)\n\t\tactive_threads--;\n\tpthread_cond_signal(&active_cond);\n\tslurm_mutex_unlock(&active_mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sleep",
          "args": [
            "1"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "_random_sleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/mgr.c",
          "lines": "664-678",
          "snippet": "static void\n_random_sleep(stepd_step_rec_t *job)\n{\n#if !defined HAVE_FRONT_END\n\tlong int delay = 0;\n\tlong int max   = (slurm_get_tcp_timeout() * job->nnodes);\n\n\tmax = MIN(max, 5000);\n\tsrand48((long int) (job->jobid + job->nodeid));\n\n\tdelay = lrand48() % ( max + 1 );\n\tdebug3(\"delaying %ldms\", delay);\n\tpoll(NULL, 0, delay);\n#endif\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/ulimits.h\"",
            "#include \"src/slurmd/slurmstepd/pam_ses.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmstepd/task.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/reverse_tree.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/slurm_mpi.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/safeopen.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#    include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <pthread.h>",
            "#include <poll.h>",
            "#include <grp.h>",
            "#  include \"src/common/unsetenv.h\"",
            "#  include <sys/checkpnt.h>",
            "#  include <sys/prctl.h>",
            "#  include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void  _set_prio_process (stepd_step_rec_t *job);",
            "static void _set_job_log_prefix(stepd_step_rec_t *job);",
            "static int  _setup_normal_io(stepd_step_rec_t *job);",
            "static int  _slurmd_job_log_init(stepd_step_rec_t *job);",
            "static void _wait_for_io(stepd_step_rec_t *job);",
            "static void _wait_for_children_slurmstepd(stepd_step_rec_t *job);",
            "static int  _send_pending_exit_msgs(stepd_step_rec_t *job);",
            "static void _send_step_complete_msgs(stepd_step_rec_t *job);",
            "static void _wait_for_all_tasks(stepd_step_rec_t *job);",
            "static void _setargs(stepd_step_rec_t *job);",
            "static void _random_sleep(stepd_step_rec_t *job);",
            "static char * _make_batch_dir(stepd_step_rec_t *job);",
            "static int _initgroups(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/ulimits.h\"\n#include \"src/slurmd/slurmstepd/pam_ses.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmstepd/task.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/reverse_tree.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/slurm_mpi.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/safeopen.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/cbuf.h\"\n#include \"slurm/slurm_errno.h\"\n#    include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <string.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <pthread.h>\n#include <poll.h>\n#include <grp.h>\n#  include \"src/common/unsetenv.h\"\n#  include <sys/checkpnt.h>\n#  include <sys/prctl.h>\n#  include <sys/types.h>\n#  include \"config.h\"\n\nstatic void  _set_prio_process (stepd_step_rec_t *job);\nstatic void _set_job_log_prefix(stepd_step_rec_t *job);\nstatic int  _setup_normal_io(stepd_step_rec_t *job);\nstatic int  _slurmd_job_log_init(stepd_step_rec_t *job);\nstatic void _wait_for_io(stepd_step_rec_t *job);\nstatic void _wait_for_children_slurmstepd(stepd_step_rec_t *job);\nstatic int  _send_pending_exit_msgs(stepd_step_rec_t *job);\nstatic void _send_step_complete_msgs(stepd_step_rec_t *job);\nstatic void _wait_for_all_tasks(stepd_step_rec_t *job);\nstatic void _setargs(stepd_step_rec_t *job);\nstatic void _random_sleep(stepd_step_rec_t *job);\nstatic char * _make_batch_dir(stepd_step_rec_t *job);\nstatic int _initgroups(stepd_step_rec_t *job);\n\nstatic void\n_random_sleep(stepd_step_rec_t *job)\n{\n#if !defined HAVE_FRONT_END\n\tlong int delay = 0;\n\tlong int max   = (slurm_get_tcp_timeout() * job->nnodes);\n\n\tmax = MIN(max, 5000);\n\tsrand48((long int) (job->jobid + job->nodeid));\n\n\tdelay = lrand48() % ( max + 1 );\n\tdebug3(\"delaying %ldms\", delay);\n\tpoll(NULL, 0, delay);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"Unable to register with slurm controller, \"\n\t\t\t      \"retrying\""
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "pdebug_stop_current",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/pdebug.c",
          "lines": "120-139",
          "snippet": "void\npdebug_stop_current(stepd_step_rec_t *job)\n{\n\t/*\n\t * Stop the task on exec for TotalView to connect\n\t */\n\tif ( (job->task_flags & TASK_PARALLEL_DEBUG)\n#ifdef BSD\n\t     && (_PTRACE(PT_TRACE_ME, 0, (caddr_t)0, 0) < 0) )\n#elif defined(PT_TRACE_ME)\n\t     && (_PTRACE(PT_TRACE_ME, 0, NULL, 0) < 0) )\n#elif defined(__sun)\n\t     && (_PTRACE(0, 0, NULL, 0) < 0))\n#elif defined(__CYGWIN__)\n\t     && 0)\n#else\n\t     && (_PTRACE(PTRACE_TRACEME, 0, NULL, 0) < 0) )\n#endif\n\t\terror(\"ptrace: %m\");\n}",
          "includes": [
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"pdebug.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"pdebug.h\"\n\nvoid\npdebug_stop_current(stepd_step_rec_t *job)\n{\n\t/*\n\t * Stop the task on exec for TotalView to connect\n\t */\n\tif ( (job->task_flags & TASK_PARALLEL_DEBUG)\n#ifdef BSD\n\t     && (_PTRACE(PT_TRACE_ME, 0, (caddr_t)0, 0) < 0) )\n#elif defined(PT_TRACE_ME)\n\t     && (_PTRACE(PT_TRACE_ME, 0, NULL, 0) < 0) )\n#elif defined(__sun)\n\t     && (_PTRACE(0, 0, NULL, 0) < 0))\n#elif defined(__CYGWIN__)\n\t     && 0)\n#else\n\t     && (_PTRACE(PTRACE_TRACEME, 0, NULL, 0) < 0) )\n#endif\n\t\terror(\"ptrace: %m\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "send_registration_msg",
          "args": [
            "SLURM_SUCCESS",
            "true"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "send_registration_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "619-655",
          "snippet": "extern int\nsend_registration_msg(uint32_t status, bool startup)\n{\n\tint rc, ret_val = SLURM_SUCCESS;\n\tslurm_node_registration_status_msg_t *msg =\n\t\txmalloc (sizeof (slurm_node_registration_status_msg_t));\n\n\tmsg->startup = (uint16_t) startup;\n\t_fill_registration_msg(msg);\n\tmsg->status  = status;\n\n\tif (conf->msg_aggr_window_msgs > 1) {\n\t\tslurm_msg_t *req = xmalloc_nz(sizeof(slurm_msg_t));\n\n\t\tslurm_msg_t_init(req);\n\t\treq->msg_type = MESSAGE_NODE_REGISTRATION_STATUS;\n\t\treq->data     = msg;\n\n\t\tmsg_aggr_add_msg(req, 1, NULL);\n\t} else {\n\t\tslurm_msg_t req;\n\t\tslurm_msg_t_init(&req);\n\t\treq.msg_type = MESSAGE_NODE_REGISTRATION_STATUS;\n\t\treq.data     = msg;\n\n\t\tif (slurm_send_recv_controller_rc_msg(&req, &rc) < 0) {\n\t\t\terror(\"Unable to register: %m\");\n\t\t\tret_val = SLURM_FAILURE;\n\t\t}\n\t\tslurm_free_node_registration_status_msg(msg);\n\t}\n\n\tif (ret_val == SLURM_SUCCESS)\n\t\tsent_reg_time = time(NULL);\n\n\treturn ret_val;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static time_t sent_reg_time = (time_t) 0;",
            "static void      _fill_registration_msg(slurm_node_registration_status_msg_t *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic time_t sent_reg_time = (time_t) 0;\nstatic void      _fill_registration_msg(slurm_node_registration_status_msg_t *);\n\nextern int\nsend_registration_msg(uint32_t status, bool startup)\n{\n\tint rc, ret_val = SLURM_SUCCESS;\n\tslurm_node_registration_status_msg_t *msg =\n\t\txmalloc (sizeof (slurm_node_registration_status_msg_t));\n\n\tmsg->startup = (uint16_t) startup;\n\t_fill_registration_msg(msg);\n\tmsg->status  = status;\n\n\tif (conf->msg_aggr_window_msgs > 1) {\n\t\tslurm_msg_t *req = xmalloc_nz(sizeof(slurm_msg_t));\n\n\t\tslurm_msg_t_init(req);\n\t\treq->msg_type = MESSAGE_NODE_REGISTRATION_STATUS;\n\t\treq->data     = msg;\n\n\t\tmsg_aggr_add_msg(req, 1, NULL);\n\t} else {\n\t\tslurm_msg_t req;\n\t\tslurm_msg_t_init(&req);\n\t\treq.msg_type = MESSAGE_NODE_REGISTRATION_STATUS;\n\t\treq.data     = msg;\n\n\t\tif (slurm_send_recv_controller_rc_msg(&req, &rc) < 0) {\n\t\t\terror(\"Unable to register: %m\");\n\t\t\tret_val = SLURM_FAILURE;\n\t\t}\n\t\tslurm_free_node_registration_status_msg(msg);\n\t}\n\n\tif (ret_val == SLURM_SUCCESS)\n\t\tsent_reg_time = time(NULL);\n\n\treturn ret_val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_increment_thd_count",
          "args": [],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "_increment_thd_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "497-513",
          "snippet": "static void\n_increment_thd_count(void)\n{\n\tbool logged = false;\n\n\tslurm_mutex_lock(&active_mutex);\n\twhile (active_threads >= MAX_THREADS) {\n\t\tif (!logged) {\n\t\t\tinfo(\"active_threads == MAX_THREADS(%d)\",\n\t\t\t     MAX_THREADS);\n\t\t\tlogged = true;\n\t\t}\n\t\tpthread_cond_wait(&active_cond, &active_mutex);\n\t}\n\tactive_threads++;\n\tslurm_mutex_unlock(&active_mutex);\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [
            "#define MAX_THREADS\t\t256"
          ],
          "globals_used": [
            "static int             active_threads = 0;",
            "static pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;",
            "static pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;",
            "static void      _increment_thd_count(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\n#define MAX_THREADS\t\t256\n\nstatic int             active_threads = 0;\nstatic pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;\nstatic pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;\nstatic void      _increment_thd_count(void);\n\nstatic void\n_increment_thd_count(void)\n{\n\tbool logged = false;\n\n\tslurm_mutex_lock(&active_mutex);\n\twhile (active_threads >= MAX_THREADS) {\n\t\tif (!logged) {\n\t\t\tinfo(\"active_threads == MAX_THREADS(%d)\",\n\t\t\t     MAX_THREADS);\n\t\t\tlogged = true;\n\t\t}\n\t\tpthread_cond_wait(&active_cond, &active_mutex);\n\t}\n\tactive_threads++;\n\tslurm_mutex_unlock(&active_mutex);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic sig_atomic_t _shutdown = 0;\nstatic time_t sent_reg_time = (time_t) 0;\nstatic void      _decrement_thd_count(void);\nstatic void      _increment_thd_count(void);\nstatic void     *_registration_engine(void *arg);\n\nstatic void *\n_registration_engine(void *arg)\n{\n\t_increment_thd_count();\n\n\twhile (!_shutdown) {\n\t\tif ((sent_reg_time == (time_t) 0) &&\n\t\t    (send_registration_msg(SLURM_SUCCESS, true) !=\n\t\t     SLURM_SUCCESS)) {\n\t\t\tdebug(\"Unable to register with slurm controller, \"\n\t\t\t      \"retrying\");\n\t\t} else if (_shutdown || sent_reg_time) {\n\t\t\tbreak;\n\t\t}\n\t\tsleep(1);\n\t}\n\n\t_decrement_thd_count();\n\treturn NULL;\n}"
  },
  {
    "function_name": "_spawn_registration_engine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "403-428",
    "snippet": "static void\n_spawn_registration_engine(void)\n{\n\tint            rc;\n\tpthread_attr_t attr;\n\tpthread_t      id;\n\tint            retries = 0;\n\n\tslurm_attr_init(&attr);\n\trc = pthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);\n\tif (rc != 0) {\n\t\terrno = rc;\n\t\tfatal(\"Unable to set detachstate on attr: %m\");\n\t\tslurm_attr_destroy(&attr);\n\t\treturn;\n\t}\n\n\twhile (pthread_create(&id, &attr, &_registration_engine, NULL)) {\n\t\terror(\"msg_engine: pthread_create: %m\");\n\t\tif (++retries > 3)\n\t\t\tfatal(\"msg_engine: pthread_create: %m\");\n\t\tusleep(10);\t/* sleep and again */\n\t}\n\n\treturn;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void      _spawn_registration_engine(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "usleep",
          "args": [
            "10"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"msg_engine: pthread_create: %m\""
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"msg_engine: pthread_create: %m\""
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_create",
          "args": [
            "&id",
            "&attr",
            "&_registration_engine",
            "NULL"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_attr_destroy",
          "args": [
            "&attr"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"Unable to set detachstate on attr: %m\""
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_attr_setdetachstate",
          "args": [
            "&attr",
            "PTHREAD_CREATE_DETACHED"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_attr_init",
          "args": [
            "&attr"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic void      _spawn_registration_engine(void);\n\nstatic void\n_spawn_registration_engine(void)\n{\n\tint            rc;\n\tpthread_attr_t attr;\n\tpthread_t      id;\n\tint            retries = 0;\n\n\tslurm_attr_init(&attr);\n\trc = pthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);\n\tif (rc != 0) {\n\t\terrno = rc;\n\t\tfatal(\"Unable to set detachstate on attr: %m\");\n\t\tslurm_attr_destroy(&attr);\n\t\treturn;\n\t}\n\n\twhile (pthread_create(&id, &attr, &_registration_engine, NULL)) {\n\t\terror(\"msg_engine: pthread_create: %m\");\n\t\tif (++retries > 3)\n\t\t\tfatal(\"msg_engine: pthread_create: %m\");\n\t\tusleep(10);\t/* sleep and again */\n\t}\n\n\treturn;\n}"
  },
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
    "lines": "212-401",
    "snippet": "int\nmain (int argc, char *argv[])\n{\n\tint i, pidfd;\n\tint blocked_signals[] = {SIGPIPE, 0};\n\tint cc;\n\tchar *oom_value;\n\tuint32_t slurmd_uid = 0;\n\tuint32_t curr_uid = 0;\n\tchar time_stamp[256];\n\tlog_options_t lopts = LOG_OPTS_INITIALIZER;\n\n\t/* NOTE: logfile is NULL at this point */\n\tlog_init(argv[0], lopts, LOG_DAEMON, NULL);\n\n\t/*\n\t * Make sure we have no extra open files which\n\t * would be propagated to spawned tasks.\n\t */\n\tcc = sysconf(_SC_OPEN_MAX);\n\tfor (i = 3; i < cc; i++)\n\t\tclose(i);\n\n\t/*\n\t * Drop supplementary groups.\n\t */\n\tif (geteuid() == 0) {\n\t\tif (setgroups(0, NULL) != 0) {\n\t\t\tfatal(\"Failed to drop supplementary groups, \"\n\t\t\t      \"setgroups: %m\");\n\t\t}\n\t} else {\n\t\tdebug(\"Not running as root. Can't drop supplementary groups\");\n\t}\n\n\t/*\n\t * Create and set default values for the slurmd global\n\t * config variable \"conf\"\n\t */\n\tconf = xmalloc(sizeof(slurmd_conf_t));\n\t_init_conf();\n\tconf->argv = &argv;\n\tconf->argc = &argc;\n\n\tif (_slurmd_init() < 0) {\n\t\terror( \"slurmd initialization failed\" );\n\t\tfflush( NULL );\n\t\texit(1);\n\t}\n\n\tslurmd_uid = slurm_get_slurmd_user_id();\n\tcurr_uid = getuid();\n\tif (curr_uid != slurmd_uid) {\n\t\tstruct passwd *pw = NULL;\n\t\tchar *slurmd_user = NULL;\n\t\tchar *curr_user = NULL;\n\n\t\t/* since when you do a getpwuid you get a pointer to a\n\t\t * structure you have to do a xstrdup on the first\n\t\t * call or your information will just get over\n\t\t * written.  This is a memory leak, but a fatal is\n\t\t * called right after so it isn't that big of a deal.\n\t\t */\n\t\tif ((pw = getpwuid(slurmd_uid)))\n\t\t\tslurmd_user = xstrdup(pw->pw_name);\n\t\tif ((pw = getpwuid(curr_uid)))\n\t\t\tcurr_user = pw->pw_name;\n\n\t\tfatal(\"You are running slurmd as something \"\n\t\t      \"other than user %s(%d).  If you want to \"\n\t\t      \"run as this user add SlurmdUser=%s \"\n\t\t      \"to the slurm.conf file.\",\n\t\t      slurmd_user, slurmd_uid, curr_user);\n\t}\n\tinit_setproctitle(argc, argv);\n\n\txsignal(SIGTERM, &_term_handler);\n\txsignal(SIGINT,  &_term_handler);\n\txsignal(SIGHUP,  &_hup_handler );\n\txsignal_block(blocked_signals);\n\n\tdebug3(\"slurmd initialization successful\");\n\n\t/*\n\t * Become a daemon if desired.\n\t * Do not chdir(\"/\") or close all fd's\n\t */\n\tif (conf->daemonize) {\n\t\tif (daemon(1,1) == -1)\n\t\t\terror(\"Couldn't daemonize slurmd: %m\");\n\t}\n\ttest_core_limit();\n\tinfo(\"slurmd version %s started\", SLURM_VERSION_STRING);\n\tdebug3(\"finished daemonize\");\n\n\tif ((oom_value = getenv(\"SLURMD_OOM_ADJ\"))) {\n\t\ti = atoi(oom_value);\n\t\tdebug(\"Setting slurmd oom_adj to %d\", i);\n\t\tset_oom_adj(i);\n\t}\n\n\t_kill_old_slurmd();\n\n\tif (conf->mlock_pages) {\n\t\t/*\n\t\t * Call mlockall() if available to ensure slurmd\n\t\t *  doesn't get swapped out\n\t\t */\n#ifdef _POSIX_MEMLOCK\n\t\tif (mlockall (MCL_FUTURE | MCL_CURRENT) < 0)\n\t\t\terror (\"failed to mlock() slurmd pages: %m\");\n#else\n\t\terror (\"mlockall() system call does not appear to be available\");\n#endif /* _POSIX_MEMLOCK */\n\t}\n\n\n\t/*\n\t * Restore any saved revoked credential information\n\t */\n\tif (!conf->cleanstart && (_restore_cred_state(conf->vctx) < 0))\n\t\treturn SLURM_FAILURE;\n\n\tif (jobacct_gather_init() != SLURM_SUCCESS)\n\t\tfatal(\"Unable to initialize jobacct_gather\");\n\tif (job_container_init() < 0)\n\t\tfatal(\"Unable to initialize job_container plugin.\");\n\tif (container_g_restore(conf->spooldir, !conf->cleanstart))\n\t\terror(\"Unable to restore job_container state.\");\n\tif (core_spec_g_init() < 0)\n\t\tfatal(\"Unable to initialize core specialization plugin.\");\n\tif (switch_g_node_init() < 0)\n\t\tfatal(\"Unable to initialize interconnect.\");\n\tif (node_features_g_init() != SLURM_SUCCESS )\n\t\tfatal( \"failed to initialize node_features plugin\");\t\n\tif (conf->cleanstart && switch_g_clear_node_state())\n\t\tfatal(\"Unable to clear interconnect state.\");\n\tswitch_g_slurmd_init();\n\tfile_bcast_init();\n\n\t_create_msg_socket();\n\n\tconf->pid = getpid();\n\t/* This has to happen after daemon(), which closes all fd's,\n\t * so we keep the write lock of the pidfile. */\n\tpidfd = create_pidfile(conf->pidfile, 0);\n\n\trfc2822_timestamp(time_stamp, sizeof(time_stamp));\n\tinfo(\"%s started on %s\", slurm_prog_name, time_stamp);\n\n\t_install_fork_handlers();\n\tlist_install_fork_handlers();\n\tslurm_conf_install_fork_handlers();\n\trecord_launched_jobs();\n\n\t/*\n\t * Initialize any plugins\n\t */\n\tif (slurmd_plugstack_init())\n\t\tfatal(\"failed to initialize slurmd_plugstack\");\n\n\t/* Wait for a successfull health check if HealthCheckInterval != 0 */\n\t_wait_health_check();\n\n\t_spawn_registration_engine();\n\tmsg_aggr_sender_init(conf->hostname, conf->port,\n\t\t\t     conf->msg_aggr_window_time,\n\t\t\t     conf->msg_aggr_window_msgs);\n\t_msg_engine();\n\n\t/*\n\t * Close fd here, otherwise we'll deadlock since create_pidfile()\n\t * flocks the pidfile.\n\t */\n\tif (pidfd >= 0)\t\t\t/* valid pidfd, non-error */\n\t\t(void) close(pidfd);\t/* Ignore errors */\n\tif (unlink(conf->pidfile) < 0)\n\t\terror(\"Unable to remove pidfile `%s': %m\", conf->pidfile);\n\n\t_wait_for_all_threads(120);\n\t_slurmd_fini();\n\t_destroy_conf();\n\tslurm_crypto_fini();\t/* must be after _destroy_conf() */\n\tgids_cache_purge();\n\tfile_bcast_purge();\n\n\tinfo(\"Slurmd shutdown completing\");\n\tlog_fini();\n       \treturn 0;\n}",
    "includes": [
      "#include \"src/slurmd/common/xcpuinfo.h\"",
      "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
      "#include \"src/slurmd/common/slurmd_cgroup.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/common/setproctitle.h\"",
      "#include \"src/slurmd/common/set_oomadj.h\"",
      "#include \"src/slurmd/common/run_script.h\"",
      "#include \"src/slurmd/slurmd/req.h\"",
      "#include \"src/slurmd/common/proctrack.h\"",
      "#include \"src/slurmd/common/job_container_plugin.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmd/common/core_spec_plugin.h\"",
      "#include \"src/common/xsignal.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/slurmd/common/task_plugin.h\"",
      "#include \"src/common/switch.h\"",
      "#include \"src/common/stepd_api.h\"",
      "#include \"src/common/slurm_topology.h\"",
      "#include \"src/common/slurm_strcasestr.h\"",
      "#include \"src/common/slurm_route.h\"",
      "#include \"src/common/slurm_protocol_api.h\"",
      "#include \"src/common/slurm_mcs.h\"",
      "#include \"src/common/slurm_jobacct_gather.h\"",
      "#include \"src/common/slurm_acct_gather_energy.h\"",
      "#include \"src/common/slurm_cred.h\"",
      "#include \"src/common/slurm_auth.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/proc_args.h\"",
      "#include \"src/common/plugstack.h\"",
      "#include \"src/common/parse_time.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/pack.h\"",
      "#include \"src/common/node_select.h\"",
      "#include \"src/common/node_features.h\"",
      "#include \"src/common/node_conf.h\"",
      "#include \"src/common/msg_aggr.h\"",
      "#include \"src/common/macros.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/list.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include \"src/common/gres.h\"",
      "#include \"src/common/forward.h\"",
      "#include \"src/common/fd.h\"",
      "#include \"src/common/daemonize.h\"",
      "#include \"src/common/cpu_frequency.h\"",
      "#include \"src/common/bitstring.h\"",
      "#include <unistd.h>",
      "#include <sys/utsname.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/resource.h>",
      "#include <sys/param.h>",
      "#include <sys/mman.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <grp.h>",
      "#include <fcntl.h>",
      "#include <dlfcn.h>",
      "#include <dirent.h>",
      "#  include <hwloc.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "slurmd_conf_t * conf = NULL;",
      "static void      _create_msg_socket(void);",
      "static void      _destroy_conf(void);",
      "static void      _hup_handler(int);",
      "static void      _init_conf(void);",
      "static void      _install_fork_handlers(void);",
      "static void      _kill_old_slurmd(void);",
      "static void      _msg_engine(void);",
      "static int       _slurmd_init(void);",
      "static int       _slurmd_fini(void);",
      "static void      _spawn_registration_engine(void);",
      "static void      _term_handler(int);",
      "static void      _wait_health_check(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_fini",
          "args": [],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Slurmd shutdown completing\""
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "_free_file_bcast_info_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "3642-3648",
          "snippet": "static void _free_file_bcast_info_t(file_bcast_info_t *f)\n{\n\txfree(f->fname);\n\tif (f->fd)\n\t\tclose(f->fd);\n\txfree(f);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic void _free_file_bcast_info_t(file_bcast_info_t *f)\n{\n\txfree(f->fname);\n\tif (f->fd)\n\t\tclose(f->fd);\n\txfree(f);\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_bcast_purge",
          "args": [],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "file_bcast_purge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "3680-3685",
          "snippet": "void file_bcast_purge(void)\n{\n\t_fb_wrlock();\n\tlist_destroy(file_bcast_list);\n\t/* destroying list before exit, no need to unlock */\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static List file_bcast_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic List file_bcast_list = NULL;\n\nvoid file_bcast_purge(void)\n{\n\t_fb_wrlock();\n\tlist_destroy(file_bcast_list);\n\t/* destroying list before exit, no need to unlock */\n}"
        }
      },
      {
        "call_info": {
          "callee": "gids_cache_purge",
          "args": [],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "gids_cache_purge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "5895-5912",
          "snippet": "void\ngids_cache_purge(void)\n{\n\tint i;\n\tgids_cache_t *p, *q;\n\n\tslurm_mutex_lock(&gids_mutex);\n\tfor (i=0; i<GIDS_HASH_LEN; i++) {\n\t\tp = gids_hashtbl[i];\n\t\twhile (p) {\n\t\t\tq = p->next;\n\t\t\t_dealloc_gids_cache(p);\n\t\t\tp = q;\n\t\t}\n\t\tgids_hashtbl[i] = NULL;\n\t}\n\tslurm_mutex_unlock(&gids_mutex);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [
            "#define GIDS_HASH_LEN 64"
          ],
          "globals_used": [
            "static void _dealloc_gids(gids_t *p);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\n#define GIDS_HASH_LEN 64\n\nstatic void _dealloc_gids(gids_t *p);\n\nvoid\ngids_cache_purge(void)\n{\n\tint i;\n\tgids_cache_t *p, *q;\n\n\tslurm_mutex_lock(&gids_mutex);\n\tfor (i=0; i<GIDS_HASH_LEN; i++) {\n\t\tp = gids_hashtbl[i];\n\t\twhile (p) {\n\t\t\tq = p->next;\n\t\t\t_dealloc_gids_cache(p);\n\t\t\tp = q;\n\t\t}\n\t\tgids_hashtbl[i] = NULL;\n\t}\n\tslurm_mutex_unlock(&gids_mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_crypto_fini",
          "args": [],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_destroy_conf",
          "args": [],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "_destroy_conf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1249-1296",
          "snippet": "static void\n_destroy_conf(void)\n{\n\tif (conf) {\n\t\txfree(conf->acct_gather_energy_type);\n\t\txfree(conf->acct_gather_filesystem_type);\n\t\txfree(conf->acct_gather_infiniband_type);\n\t\txfree(conf->acct_gather_profile_type);\n\t\txfree(conf->auth_info);\n\t\txfree(conf->block_map);\n\t\txfree(conf->block_map_inv);\n\t\txfree(conf->chos_loc);\n\t\txfree(conf->cluster_name);\n\t\txfree(conf->conffile);\n\t\txfree(conf->cpu_spec_list);\n\t\txfree(conf->epilog);\n\t\txfree(conf->health_check_program);\n\t\txfree(conf->hostname);\n\t\txfree(conf->job_acct_gather_freq);\n\t\txfree(conf->job_acct_gather_type);\n\t\txfree(conf->logfile);\n\t\txfree(conf->msg_aggr_params);\n\t\txfree(conf->node_name);\n\t\txfree(conf->node_addr);\n\t\txfree(conf->node_topo_addr);\n\t\txfree(conf->node_topo_pattern);\n\t\txfree(conf->pidfile);\n\t\txfree(conf->plugstack);\n\t\txfree(conf->prolog);\n\t\txfree(conf->pubkey);\n\t\txfree(conf->select_type);\n\t\txfree(conf->spooldir);\n\t\txfree(conf->stepd_loc);\n\t\txfree(conf->task_prolog);\n\t\txfree(conf->task_epilog);\n\t\txfree(conf->tmpfs);\n\t\tslurm_mutex_destroy(&conf->config_mutex);\n\t\tFREE_NULL_LIST(conf->starting_steps);\n\t\tslurm_mutex_destroy(&conf->starting_steps_lock);\n\t\tpthread_cond_destroy(&conf->starting_steps_cond);\n\t\tFREE_NULL_LIST(conf->prolog_running_jobs);\n\t\tslurm_mutex_destroy(&conf->prolog_running_lock);\n\t\tpthread_cond_destroy(&conf->prolog_running_cond);\n\t\tslurm_cred_ctx_destroy(conf->vctx);\n\t\txfree(conf);\n\t}\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _destroy_conf(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _destroy_conf(void);\n\nstatic void\n_destroy_conf(void)\n{\n\tif (conf) {\n\t\txfree(conf->acct_gather_energy_type);\n\t\txfree(conf->acct_gather_filesystem_type);\n\t\txfree(conf->acct_gather_infiniband_type);\n\t\txfree(conf->acct_gather_profile_type);\n\t\txfree(conf->auth_info);\n\t\txfree(conf->block_map);\n\t\txfree(conf->block_map_inv);\n\t\txfree(conf->chos_loc);\n\t\txfree(conf->cluster_name);\n\t\txfree(conf->conffile);\n\t\txfree(conf->cpu_spec_list);\n\t\txfree(conf->epilog);\n\t\txfree(conf->health_check_program);\n\t\txfree(conf->hostname);\n\t\txfree(conf->job_acct_gather_freq);\n\t\txfree(conf->job_acct_gather_type);\n\t\txfree(conf->logfile);\n\t\txfree(conf->msg_aggr_params);\n\t\txfree(conf->node_name);\n\t\txfree(conf->node_addr);\n\t\txfree(conf->node_topo_addr);\n\t\txfree(conf->node_topo_pattern);\n\t\txfree(conf->pidfile);\n\t\txfree(conf->plugstack);\n\t\txfree(conf->prolog);\n\t\txfree(conf->pubkey);\n\t\txfree(conf->select_type);\n\t\txfree(conf->spooldir);\n\t\txfree(conf->stepd_loc);\n\t\txfree(conf->task_prolog);\n\t\txfree(conf->task_epilog);\n\t\txfree(conf->tmpfs);\n\t\tslurm_mutex_destroy(&conf->config_mutex);\n\t\tFREE_NULL_LIST(conf->starting_steps);\n\t\tslurm_mutex_destroy(&conf->starting_steps_lock);\n\t\tpthread_cond_destroy(&conf->starting_steps_cond);\n\t\tFREE_NULL_LIST(conf->prolog_running_jobs);\n\t\tslurm_mutex_destroy(&conf->prolog_running_lock);\n\t\tpthread_cond_destroy(&conf->prolog_running_cond);\n\t\tslurm_cred_ctx_destroy(conf->vctx);\n\t\txfree(conf);\n\t}\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_slurmd_fini",
          "args": [],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "_slurmd_fini",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1706-1735",
          "snippet": "static int\n_slurmd_fini(void)\n{\n\tnode_features_g_fini();\n\tcore_spec_g_fini();\n\tswitch_g_node_fini();\n\tjobacct_gather_fini();\n\tacct_gather_profile_fini();\n\tsave_cred_state(conf->vctx);\n\tswitch_fini();\n\tslurmd_task_fini();\n\tslurm_conf_destroy();\n\tslurm_proctrack_fini();\n\tslurm_auth_fini();\n\tnode_fini2();\n\tgres_plugin_fini();\n\tslurm_topo_fini();\n\tslurmd_req(NULL);\t/* purge memory allocated by slurmd_req() */\n\tfini_setproctitle();\n\tslurm_select_fini();\n\tspank_slurmd_exit();\n\tcpu_freq_fini();\n\t_resource_spec_fini();\n\tjob_container_fini();\n\tacct_gather_conf_destroy();\n\tfini_system_cgroup();\n\troute_fini();\n\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _resource_spec_fini(void);",
            "static int       _slurmd_fini(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _resource_spec_fini(void);\nstatic int       _slurmd_fini(void);\n\nstatic int\n_slurmd_fini(void)\n{\n\tnode_features_g_fini();\n\tcore_spec_g_fini();\n\tswitch_g_node_fini();\n\tjobacct_gather_fini();\n\tacct_gather_profile_fini();\n\tsave_cred_state(conf->vctx);\n\tswitch_fini();\n\tslurmd_task_fini();\n\tslurm_conf_destroy();\n\tslurm_proctrack_fini();\n\tslurm_auth_fini();\n\tnode_fini2();\n\tgres_plugin_fini();\n\tslurm_topo_fini();\n\tslurmd_req(NULL);\t/* purge memory allocated by slurmd_req() */\n\tfini_setproctitle();\n\tslurm_select_fini();\n\tspank_slurmd_exit();\n\tcpu_freq_fini();\n\t_resource_spec_fini();\n\tjob_container_fini();\n\tacct_gather_conf_destroy();\n\tfini_system_cgroup();\n\troute_fini();\n\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_wait_for_all_threads",
          "args": [
            "120"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "_wait_for_all_threads",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "516-541",
          "snippet": "static void\n_wait_for_all_threads(int secs)\n{\n\tstruct timespec ts;\n\tint rc;\n\n\tts.tv_sec  = time(NULL);\n\tts.tv_nsec = 0;\n\tts.tv_sec += secs;\n\n\tslurm_mutex_lock(&active_mutex);\n\twhile (active_threads > 0) {\n\t\tverbose(\"waiting on %d active threads\", active_threads);\n\t\trc = pthread_cond_timedwait(&active_cond, &active_mutex, &ts);\n\t\tif (rc == ETIMEDOUT) {\n\t\t\terror(\"Timeout waiting for completion of %d threads\",\n\t\t\t      active_threads);\n\t\t\tpthread_cond_signal(&active_cond);\n\t\t\tslurm_mutex_unlock(&active_mutex);\n\t\t\treturn;\n\t\t}\n\t}\n\tpthread_cond_signal(&active_cond);\n\tslurm_mutex_unlock(&active_mutex);\n\tverbose(\"all threads complete\");\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int             active_threads = 0;",
            "static pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;",
            "static pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;",
            "static void      _wait_for_all_threads(int secs);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic int             active_threads = 0;\nstatic pthread_mutex_t active_mutex   = PTHREAD_MUTEX_INITIALIZER;\nstatic pthread_cond_t  active_cond    = PTHREAD_COND_INITIALIZER;\nstatic void      _wait_for_all_threads(int secs);\n\nstatic void\n_wait_for_all_threads(int secs)\n{\n\tstruct timespec ts;\n\tint rc;\n\n\tts.tv_sec  = time(NULL);\n\tts.tv_nsec = 0;\n\tts.tv_sec += secs;\n\n\tslurm_mutex_lock(&active_mutex);\n\twhile (active_threads > 0) {\n\t\tverbose(\"waiting on %d active threads\", active_threads);\n\t\trc = pthread_cond_timedwait(&active_cond, &active_mutex, &ts);\n\t\tif (rc == ETIMEDOUT) {\n\t\t\terror(\"Timeout waiting for completion of %d threads\",\n\t\t\t      active_threads);\n\t\t\tpthread_cond_signal(&active_cond);\n\t\t\tslurm_mutex_unlock(&active_mutex);\n\t\t\treturn;\n\t\t}\n\t}\n\tpthread_cond_signal(&active_cond);\n\tslurm_mutex_unlock(&active_mutex);\n\tverbose(\"all threads complete\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Unable to remove pidfile `%s': %m\"",
            "conf->pidfile"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "_prolog_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "1386-1434",
          "snippet": "static void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _is_batch_job_finished(uint32_t job_id);",
            "static bool _job_still_running(uint32_t job_id);",
            "static void _launch_complete_add(uint32_t job_id);",
            "static void _launch_complete_log(char *type, uint32_t job_id);",
            "static void _launch_complete_rm(uint32_t job_id);",
            "static void _launch_complete_wait(uint32_t job_id);",
            "static bool _launch_job_test(uint32_t job_id);",
            "static void _note_batch_job_finished(uint32_t job_id);",
            "static bool _slurm_authorized_user(uid_t uid);",
            "static void _sync_messages_kill(kill_job_msg_t *req);",
            "static int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);",
            "static gids_t *_gids_cache_lookup(char *user, gid_t gid);",
            "static int  _add_starting_step(uint16_t type, void *req);",
            "static int  _remove_starting_step(uint16_t type, void *req);",
            "static void _add_job_running_prolog(uint32_t job_id);",
            "static void _remove_job_running_prolog(uint32_t job_id);",
            "static void _wait_for_job_running_prolog(uint32_t job_id);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic bool _is_batch_job_finished(uint32_t job_id);\nstatic bool _job_still_running(uint32_t job_id);\nstatic void _launch_complete_add(uint32_t job_id);\nstatic void _launch_complete_log(char *type, uint32_t job_id);\nstatic void _launch_complete_rm(uint32_t job_id);\nstatic void _launch_complete_wait(uint32_t job_id);\nstatic bool _launch_job_test(uint32_t job_id);\nstatic void _note_batch_job_finished(uint32_t job_id);\nstatic bool _slurm_authorized_user(uid_t uid);\nstatic void _sync_messages_kill(kill_job_msg_t *req);\nstatic int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);\nstatic gids_t *_gids_cache_lookup(char *user, gid_t gid);\nstatic int  _add_starting_step(uint16_t type, void *req);\nstatic int  _remove_starting_step(uint16_t type, void *req);\nstatic void _add_job_running_prolog(uint32_t job_id);\nstatic void _remove_job_running_prolog(uint32_t job_id);\nstatic void _wait_for_job_running_prolog(uint32_t job_id);\n\nstatic void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "conf->pidfile"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "pidfd"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "_file_bcast_close_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "3635-3640",
          "snippet": "static void _file_bcast_close_file(file_bcast_info_t *key)\n{\n\t_fb_wrlock();\n\tlist_delete_all(file_bcast_list, _bcast_find_in_list, key);\n\t_fb_wrunlock();\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int  _job_limits_match(void *x, void *key);",
            "static int  _step_limits_match(void *x, void *key);",
            "static int  _file_bcast_register_file(slurm_msg_t *msg,\n\t\t\t\t      file_bcast_info_t *key);",
            "static List file_bcast_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic int  _job_limits_match(void *x, void *key);\nstatic int  _step_limits_match(void *x, void *key);\nstatic int  _file_bcast_register_file(slurm_msg_t *msg,\n\t\t\t\t      file_bcast_info_t *key);\nstatic List file_bcast_list = NULL;\n\nstatic void _file_bcast_close_file(file_bcast_info_t *key)\n{\n\t_fb_wrlock();\n\tlist_delete_all(file_bcast_list, _bcast_find_in_list, key);\n\t_fb_wrunlock();\n}"
        }
      },
      {
        "call_info": {
          "callee": "_msg_engine",
          "args": [],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "_msg_engine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "454-485",
          "snippet": "static void\n_msg_engine(void)\n{\n\tslurm_addr_t *cli;\n\tslurm_fd_t sock;\n\n\tmsg_pthread = pthread_self();\n\tslurmd_req(NULL);\t/* initialize timer */\n\twhile (!_shutdown) {\n\t\tif (_reconfig) {\n\t\t\tverbose(\"got reconfigure request\");\n\t\t\t_wait_for_all_threads(5); /* Wait for RPCs to finish */\n\t\t\t_reconfigure();\n\t\t}\n\n\t\tcli = xmalloc (sizeof (slurm_addr_t));\n\t\tif ((sock = slurm_accept_msg_conn(conf->lfd, cli)) >= 0) {\n\t\t\t_handle_connection(sock, cli);\n\t\t\tcontinue;\n\t\t}\n\t\t/*\n\t\t *  Otherwise, accept() failed.\n\t\t */\n\t\txfree (cli);\n\t\tif (errno == EINTR)\n\t\t\tcontinue;\n\t\terror(\"accept: %m\");\n\t}\n\tverbose(\"got shutdown request\");\n\tslurm_shutdown_msg_engine(conf->lfd);\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static sig_atomic_t _shutdown = 0;",
            "static sig_atomic_t _reconfig = 0;",
            "static pthread_t msg_pthread = (pthread_t) 0;",
            "static void      _msg_engine(void);",
            "static void      _reconfigure(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic sig_atomic_t _shutdown = 0;\nstatic sig_atomic_t _reconfig = 0;\nstatic pthread_t msg_pthread = (pthread_t) 0;\nstatic void      _msg_engine(void);\nstatic void      _reconfigure(void);\n\nstatic void\n_msg_engine(void)\n{\n\tslurm_addr_t *cli;\n\tslurm_fd_t sock;\n\n\tmsg_pthread = pthread_self();\n\tslurmd_req(NULL);\t/* initialize timer */\n\twhile (!_shutdown) {\n\t\tif (_reconfig) {\n\t\t\tverbose(\"got reconfigure request\");\n\t\t\t_wait_for_all_threads(5); /* Wait for RPCs to finish */\n\t\t\t_reconfigure();\n\t\t}\n\n\t\tcli = xmalloc (sizeof (slurm_addr_t));\n\t\tif ((sock = slurm_accept_msg_conn(conf->lfd, cli)) >= 0) {\n\t\t\t_handle_connection(sock, cli);\n\t\t\tcontinue;\n\t\t}\n\t\t/*\n\t\t *  Otherwise, accept() failed.\n\t\t */\n\t\txfree (cli);\n\t\tif (errno == EINTR)\n\t\t\tcontinue;\n\t\terror(\"accept: %m\");\n\t}\n\tverbose(\"got shutdown request\");\n\tslurm_shutdown_msg_engine(conf->lfd);\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "msg_aggr_sender_init",
          "args": [
            "conf->hostname",
            "conf->port",
            "conf->msg_aggr_window_time",
            "conf->msg_aggr_window_msgs"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_spawn_registration_engine",
          "args": [],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "_spawn_registration_engine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "403-428",
          "snippet": "static void\n_spawn_registration_engine(void)\n{\n\tint            rc;\n\tpthread_attr_t attr;\n\tpthread_t      id;\n\tint            retries = 0;\n\n\tslurm_attr_init(&attr);\n\trc = pthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);\n\tif (rc != 0) {\n\t\terrno = rc;\n\t\tfatal(\"Unable to set detachstate on attr: %m\");\n\t\tslurm_attr_destroy(&attr);\n\t\treturn;\n\t}\n\n\twhile (pthread_create(&id, &attr, &_registration_engine, NULL)) {\n\t\terror(\"msg_engine: pthread_create: %m\");\n\t\tif (++retries > 3)\n\t\t\tfatal(\"msg_engine: pthread_create: %m\");\n\t\tusleep(10);\t/* sleep and again */\n\t}\n\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void      _spawn_registration_engine(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic void      _spawn_registration_engine(void);\n\nstatic void\n_spawn_registration_engine(void)\n{\n\tint            rc;\n\tpthread_attr_t attr;\n\tpthread_t      id;\n\tint            retries = 0;\n\n\tslurm_attr_init(&attr);\n\trc = pthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);\n\tif (rc != 0) {\n\t\terrno = rc;\n\t\tfatal(\"Unable to set detachstate on attr: %m\");\n\t\tslurm_attr_destroy(&attr);\n\t\treturn;\n\t}\n\n\twhile (pthread_create(&id, &attr, &_registration_engine, NULL)) {\n\t\terror(\"msg_engine: pthread_create: %m\");\n\t\tif (++retries > 3)\n\t\t\tfatal(\"msg_engine: pthread_create: %m\");\n\t\tusleep(10);\t/* sleep and again */\n\t}\n\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_wait_health_check",
          "args": [],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "_wait_health_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "2337-2351",
          "snippet": "static void _wait_health_check(void)\n{\n\tint last_check_time = 0;\n\twhile (!_shutdown && (conf->health_check_interval != 0) ) {\n\t\tif (time(NULL) - last_check_time > HEALTH_RETRY_DELAY) {\n\t\t\tif (run_script_health_check() == SLURM_SUCCESS) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tlast_check_time = time(NULL);\n\t\t\tinfo (\"Health Check failed, retrying in %ds...\",\n\t\t\t\tHEALTH_RETRY_DELAY);\n\t\t}\n\t\tusleep(10000);\n\t}\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [
            "#define HEALTH_RETRY_DELAY 10"
          ],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static sig_atomic_t _shutdown = 0;",
            "static void      _wait_health_check(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\n#define HEALTH_RETRY_DELAY 10\n\nslurmd_conf_t * conf = NULL;\nstatic sig_atomic_t _shutdown = 0;\nstatic void      _wait_health_check(void);\n\nstatic void _wait_health_check(void)\n{\n\tint last_check_time = 0;\n\twhile (!_shutdown && (conf->health_check_interval != 0) ) {\n\t\tif (time(NULL) - last_check_time > HEALTH_RETRY_DELAY) {\n\t\t\tif (run_script_health_check() == SLURM_SUCCESS) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tlast_check_time = time(NULL);\n\t\t\tinfo (\"Health Check failed, retrying in %ds...\",\n\t\t\t\tHEALTH_RETRY_DELAY);\n\t\t}\n\t\tusleep(10000);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"failed to initialize slurmd_plugstack\""
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurmd_plugstack_init",
          "args": [],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "slurmd_plugstack_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd_plugstack.c",
          "lines": "99-152",
          "snippet": "extern int slurmd_plugstack_init(void)\n{\n\tint rc = SLURM_SUCCESS;\n\tchar *last = NULL, *names;\n\tchar *plugin_type = \"slurmd_plugstack\";\n\tchar *type;\n\n\tif (init_run && (g_context_cnt >= 0))\n\t\treturn rc;\n\n\tslurm_mutex_lock(&g_context_lock);\n\tif (g_context_cnt >= 0)\n\t\tgoto fini;\n\n\tslurmd_plugstack_list = slurm_get_slurmd_plugstack();\n\tg_context_cnt = 0;\n\tif ((slurmd_plugstack_list == NULL) ||\n\t    (slurmd_plugstack_list[0] == '\\0'))\n\t\tgoto fini;\n\n\tnames = slurmd_plugstack_list;\n\twhile ((type = strtok_r(names, \",\", &last))) {\n\t\txrealloc(ops, (sizeof(slurmd_plugstack_ops_t) *\n\t\t\t      (g_context_cnt + 1)));\n\t\txrealloc(g_context,\n\t\t\t (sizeof(plugin_context_t *) * (g_context_cnt + 1)));\n\t\tif (xstrncmp(type, \"slurmd/\", 10) == 0)\n\t\t\ttype += 10; /* backward compatibility */\n\t\ttype = xstrdup_printf(\"slurmd/%s\", type);\n\t\tg_context[g_context_cnt] = plugin_context_create(\n\t\t\tplugin_type, type, (void **)&ops[g_context_cnt],\n\t\t\tsyms, sizeof(syms));\n\t\tif (!g_context[g_context_cnt]) {\n\t\t\terror(\"cannot create %s context for %s\",\n\t\t\t      plugin_type, type);\n\t\t\trc = SLURM_ERROR;\n\t\t\txfree(type);\n\t\t\tbreak;\n\t\t}\n\n\t\txfree(type);\n\t\tg_context_cnt++;\n\t\tnames = NULL; /* for next iteration */\n\t}\n\tinit_run = true;\n\nfini:\n\tslurm_mutex_unlock(&g_context_lock);\n\n\tif (rc != SLURM_SUCCESS)\n\t\tslurmd_plugstack_fini();\n\n\treturn rc;\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/plugin.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <stdio.h>",
            "#  include <string.h>",
            "#  include <stdint.h>",
            "#  include <unistd.h>",
            "#  include <sys/types.h>",
            "#      include <stdint.h>",
            "#    include <inttypes.h>",
            "#    include <unistd.h>",
            "#    include <sys/types.h>",
            "#    include <string.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *syms[] = {\n\t/* NO FUNCTIONS */\n};",
            "static int g_context_cnt = -1;",
            "static slurmd_plugstack_ops_t *ops = NULL;",
            "static plugin_context_t **g_context = NULL;",
            "static char *slurmd_plugstack_list = NULL;",
            "static pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/plugin.h\"\n#include \"src/common/macros.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <stdio.h>\n#  include <string.h>\n#  include <stdint.h>\n#  include <unistd.h>\n#  include <sys/types.h>\n#      include <stdint.h>\n#    include <inttypes.h>\n#    include <unistd.h>\n#    include <sys/types.h>\n#    include <string.h>\n#  include \"config.h\"\n\nstatic const char *syms[] = {\n\t/* NO FUNCTIONS */\n};\nstatic int g_context_cnt = -1;\nstatic slurmd_plugstack_ops_t *ops = NULL;\nstatic plugin_context_t **g_context = NULL;\nstatic char *slurmd_plugstack_list = NULL;\nstatic pthread_mutex_t g_context_lock = PTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int slurmd_plugstack_init(void)\n{\n\tint rc = SLURM_SUCCESS;\n\tchar *last = NULL, *names;\n\tchar *plugin_type = \"slurmd_plugstack\";\n\tchar *type;\n\n\tif (init_run && (g_context_cnt >= 0))\n\t\treturn rc;\n\n\tslurm_mutex_lock(&g_context_lock);\n\tif (g_context_cnt >= 0)\n\t\tgoto fini;\n\n\tslurmd_plugstack_list = slurm_get_slurmd_plugstack();\n\tg_context_cnt = 0;\n\tif ((slurmd_plugstack_list == NULL) ||\n\t    (slurmd_plugstack_list[0] == '\\0'))\n\t\tgoto fini;\n\n\tnames = slurmd_plugstack_list;\n\twhile ((type = strtok_r(names, \",\", &last))) {\n\t\txrealloc(ops, (sizeof(slurmd_plugstack_ops_t) *\n\t\t\t      (g_context_cnt + 1)));\n\t\txrealloc(g_context,\n\t\t\t (sizeof(plugin_context_t *) * (g_context_cnt + 1)));\n\t\tif (xstrncmp(type, \"slurmd/\", 10) == 0)\n\t\t\ttype += 10; /* backward compatibility */\n\t\ttype = xstrdup_printf(\"slurmd/%s\", type);\n\t\tg_context[g_context_cnt] = plugin_context_create(\n\t\t\tplugin_type, type, (void **)&ops[g_context_cnt],\n\t\t\tsyms, sizeof(syms));\n\t\tif (!g_context[g_context_cnt]) {\n\t\t\terror(\"cannot create %s context for %s\",\n\t\t\t      plugin_type, type);\n\t\t\trc = SLURM_ERROR;\n\t\t\txfree(type);\n\t\t\tbreak;\n\t\t}\n\n\t\txfree(type);\n\t\tg_context_cnt++;\n\t\tnames = NULL; /* for next iteration */\n\t}\n\tinit_run = true;\n\nfini:\n\tslurm_mutex_unlock(&g_context_lock);\n\n\tif (rc != SLURM_SUCCESS)\n\t\tslurmd_plugstack_fini();\n\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "record_launched_jobs",
          "args": [],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "record_launched_jobs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "4512-4525",
          "snippet": "extern void record_launched_jobs(void)\n{\n\tList steps;\n\tListIterator i;\n\tstep_loc_t *stepd;\n\n\tsteps = stepd_available(conf->spooldir, conf->node_name);\n\ti = list_iterator_create(steps);\n\twhile ((stepd = list_next(i))) {\n\t\t_launch_complete_add(stepd->jobid);\n\t}\n\tlist_iterator_destroy(i);\n\tFREE_NULL_LIST(steps);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int  _prolog_is_running (uint32_t jobid);",
            "static int  _waiter_init (uint32_t jobid);",
            "static int  _waiter_complete (uint32_t jobid);",
            "static bool _steps_completed_now(uint32_t jobid);",
            "static uid_t _get_job_uid(uint32_t jobid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic int  _prolog_is_running (uint32_t jobid);\nstatic int  _waiter_init (uint32_t jobid);\nstatic int  _waiter_complete (uint32_t jobid);\nstatic bool _steps_completed_now(uint32_t jobid);\nstatic uid_t _get_job_uid(uint32_t jobid);\n\nextern void record_launched_jobs(void)\n{\n\tList steps;\n\tListIterator i;\n\tstep_loc_t *stepd;\n\n\tsteps = stepd_available(conf->spooldir, conf->node_name);\n\ti = list_iterator_create(steps);\n\twhile ((stepd = list_next(i))) {\n\t\t_launch_complete_add(stepd->jobid);\n\t}\n\tlist_iterator_destroy(i);\n\tFREE_NULL_LIST(steps);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slurm_conf_install_fork_handlers",
          "args": [],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_install_fork_handlers",
          "args": [],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_install_fork_handlers",
          "args": [],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "_install_fork_handlers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1991-1999",
          "snippet": "static void _install_fork_handlers(void)\n{\n\tint err;\n\n\terr = pthread_atfork(&_atfork_prepare, &_atfork_final, &_atfork_final);\n\tif (err) error (\"pthread_atfork: %m\");\n\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void      _atfork_final(void);",
            "static void      _atfork_prepare(void);",
            "static void      _install_fork_handlers(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nstatic void      _atfork_final(void);\nstatic void      _atfork_prepare(void);\nstatic void      _install_fork_handlers(void);\n\nstatic void _install_fork_handlers(void)\n{\n\tint err;\n\n\terr = pthread_atfork(&_atfork_prepare, &_atfork_final, &_atfork_final);\n\tif (err) error (\"pthread_atfork: %m\");\n\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"%s started on %s\"",
            "slurm_prog_name",
            "time_stamp"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "_chk_cpuinfo_float",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "414-423",
          "snippet": "static int _chk_cpuinfo_float(char *buffer, char *keyword, float *val)\n{\n\tchar *valptr;\n\tif (_chk_cpuinfo_str(buffer, keyword, &valptr)) {\n\t\t*val = (float) strtod(valptr, (char **)NULL);\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nstatic int _chk_cpuinfo_float(char *buffer, char *keyword, float *val)\n{\n\tchar *valptr;\n\tif (_chk_cpuinfo_str(buffer, keyword, &valptr)) {\n\t\t*val = (float) strtod(valptr, (char **)NULL);\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "rfc2822_timestamp",
          "args": [
            "time_stamp",
            "sizeof(time_stamp)"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_pidfile",
          "args": [
            "conf->pidfile",
            "0"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_create_msg_socket",
          "args": [],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "_create_msg_socket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1412-1438",
          "snippet": "static void\n_create_msg_socket(void)\n{\n\tchar* node_addr;\n\n\tslurm_fd_t ld = slurm_init_msg_engine_addrname_port(conf->node_addr,\n\t\t\t\t\t\t\t  conf->port);\n\tif (conf->node_addr == NULL)\n\t\tnode_addr = \"*\";\n\telse\n\t\tnode_addr = conf->node_addr;\n\n\tif (ld < 0) {\n\t\terror(\"Unable to bind listen port (%s:%d): %m\",\n\t\t      node_addr, conf->port);\n\t\texit(1);\n\t}\n\n\tfd_set_close_on_exec(ld);\n\n\tconf->lfd = ld;\n\n\tdebug3(\"successfully opened slurm listen port %s:%d\",\n\t       node_addr, conf->port);\n\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _create_msg_socket(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _create_msg_socket(void);\n\nstatic void\n_create_msg_socket(void)\n{\n\tchar* node_addr;\n\n\tslurm_fd_t ld = slurm_init_msg_engine_addrname_port(conf->node_addr,\n\t\t\t\t\t\t\t  conf->port);\n\tif (conf->node_addr == NULL)\n\t\tnode_addr = \"*\";\n\telse\n\t\tnode_addr = conf->node_addr;\n\n\tif (ld < 0) {\n\t\terror(\"Unable to bind listen port (%s:%d): %m\",\n\t\t      node_addr, conf->port);\n\t\texit(1);\n\t}\n\n\tfd_set_close_on_exec(ld);\n\n\tconf->lfd = ld;\n\n\tdebug3(\"successfully opened slurm listen port %s:%d\",\n\t       node_addr, conf->port);\n\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_bcast_init",
          "args": [],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "file_bcast_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "3674-3678",
          "snippet": "void file_bcast_init(void)\n{\n\t/* skip locks during slurmd init */\n\tfile_bcast_list = list_create((ListDelF) _free_file_bcast_info_t);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static List file_bcast_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic List file_bcast_list = NULL;\n\nvoid file_bcast_init(void)\n{\n\t/* skip locks during slurmd init */\n\tfile_bcast_list = list_create((ListDelF) _free_file_bcast_info_t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "switch_g_slurmd_init",
          "args": [],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"Unable to clear interconnect state.\""
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "switch_g_clear_node_state",
          "args": [],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"failed to initialize node_features plugin\""
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node_features_g_init",
          "args": [],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"Unable to initialize interconnect.\""
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "switch_g_node_init",
          "args": [],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"Unable to initialize core specialization plugin.\""
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "core_spec_g_init",
          "args": [],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "core_spec_g_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/core_spec_plugin.c",
          "lines": "77-137",
          "snippet": "extern int core_spec_g_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"core_spec\";\n\tchar *core_spec_plugin_type = NULL;\n\tchar *last = NULL, *core_spec_plugin_list, *core_spec = NULL;\n\n\tif (init_run && (g_core_spec_context_num >= 0))\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_core_spec_context_lock);\n\n\tif (g_core_spec_context_num >= 0)\n\t\tgoto done;\n\n\tcore_spec_plugin_type = slurm_get_core_spec_plugin();\n\tg_core_spec_context_num = 0; /* mark it before anything else */\n\tif ((core_spec_plugin_type == NULL) ||\n\t    (core_spec_plugin_type[0] == '\\0'))\n\t\tgoto done;\n\n\tcore_spec_plugin_list = core_spec_plugin_type;\n\twhile ((core_spec =\n\t\tstrtok_r(core_spec_plugin_list, \",\", &last))) {\n\t\txrealloc(ops,\n\t\t\t sizeof(core_spec_ops_t) *\n\t\t\t (g_core_spec_context_num + 1));\n\t\txrealloc(g_core_spec_context, (sizeof(plugin_context_t *)\n\t\t\t\t\t  * (g_core_spec_context_num + 1)));\n\t\tif (xstrncmp(core_spec, \"core_spec/\", 10) == 0)\n\t\t\tcore_spec += 10; /* backward compatibility */\n\t\tcore_spec = xstrdup_printf(\"core_spec/%s\",\n\t\t\t\t\t       core_spec);\n\t\tg_core_spec_context[g_core_spec_context_num] =\n\t\t\tplugin_context_create(\n\t\t\t\tplugin_type, core_spec,\n\t\t\t\t(void **)&ops[g_core_spec_context_num],\n\t\t\t\tsyms, sizeof(syms));\n\t\tif (!g_core_spec_context[g_core_spec_context_num]) {\n\t\t\terror(\"cannot create %s context for %s\",\n\t\t\t      plugin_type, core_spec);\n\t\t\txfree(core_spec);\n\t\t\tretval = SLURM_ERROR;\n\t\t\tbreak;\n\t\t}\n\n\t\txfree(core_spec);\n\t\tg_core_spec_context_num++;\n\t\tcore_spec_plugin_list = NULL; /* for next iteration */\n\t}\n\tinit_run = true;\n\n done:\n\tslurm_mutex_unlock(&g_core_spec_context_lock);\n\txfree(core_spec_plugin_type);\n\n\tif (retval != SLURM_SUCCESS)\n\t\tcore_spec_g_fini();\n\n\treturn retval;\n}",
          "includes": [
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/plugin.h\"",
            "#include <pthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *syms[] = {\n\t\"core_spec_p_set\",\n\t\"core_spec_p_clear\",\n\t\"core_spec_p_suspend\",\n\t\"core_spec_p_resume\",\n};",
            "static core_spec_ops_t\t\t*ops = NULL;",
            "static plugin_context_t\t\t**g_core_spec_context = NULL;",
            "static int\t\t\tg_core_spec_context_num = -1;",
            "static pthread_mutex_t\t\tg_core_spec_context_lock =\n\t\t\t\t\tPTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/plugin.h\"\n#include <pthread.h>\n\nstatic const char *syms[] = {\n\t\"core_spec_p_set\",\n\t\"core_spec_p_clear\",\n\t\"core_spec_p_suspend\",\n\t\"core_spec_p_resume\",\n};\nstatic core_spec_ops_t\t\t*ops = NULL;\nstatic plugin_context_t\t\t**g_core_spec_context = NULL;\nstatic int\t\t\tg_core_spec_context_num = -1;\nstatic pthread_mutex_t\t\tg_core_spec_context_lock =\n\t\t\t\t\tPTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int core_spec_g_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"core_spec\";\n\tchar *core_spec_plugin_type = NULL;\n\tchar *last = NULL, *core_spec_plugin_list, *core_spec = NULL;\n\n\tif (init_run && (g_core_spec_context_num >= 0))\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_core_spec_context_lock);\n\n\tif (g_core_spec_context_num >= 0)\n\t\tgoto done;\n\n\tcore_spec_plugin_type = slurm_get_core_spec_plugin();\n\tg_core_spec_context_num = 0; /* mark it before anything else */\n\tif ((core_spec_plugin_type == NULL) ||\n\t    (core_spec_plugin_type[0] == '\\0'))\n\t\tgoto done;\n\n\tcore_spec_plugin_list = core_spec_plugin_type;\n\twhile ((core_spec =\n\t\tstrtok_r(core_spec_plugin_list, \",\", &last))) {\n\t\txrealloc(ops,\n\t\t\t sizeof(core_spec_ops_t) *\n\t\t\t (g_core_spec_context_num + 1));\n\t\txrealloc(g_core_spec_context, (sizeof(plugin_context_t *)\n\t\t\t\t\t  * (g_core_spec_context_num + 1)));\n\t\tif (xstrncmp(core_spec, \"core_spec/\", 10) == 0)\n\t\t\tcore_spec += 10; /* backward compatibility */\n\t\tcore_spec = xstrdup_printf(\"core_spec/%s\",\n\t\t\t\t\t       core_spec);\n\t\tg_core_spec_context[g_core_spec_context_num] =\n\t\t\tplugin_context_create(\n\t\t\t\tplugin_type, core_spec,\n\t\t\t\t(void **)&ops[g_core_spec_context_num],\n\t\t\t\tsyms, sizeof(syms));\n\t\tif (!g_core_spec_context[g_core_spec_context_num]) {\n\t\t\terror(\"cannot create %s context for %s\",\n\t\t\t      plugin_type, core_spec);\n\t\t\txfree(core_spec);\n\t\t\tretval = SLURM_ERROR;\n\t\t\tbreak;\n\t\t}\n\n\t\txfree(core_spec);\n\t\tg_core_spec_context_num++;\n\t\tcore_spec_plugin_list = NULL; /* for next iteration */\n\t}\n\tinit_run = true;\n\n done:\n\tslurm_mutex_unlock(&g_core_spec_context_lock);\n\txfree(core_spec_plugin_type);\n\n\tif (retval != SLURM_SUCCESS)\n\t\tcore_spec_g_fini();\n\n\treturn retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Unable to restore job_container state.\""
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_g_restore",
          "args": [
            "conf->spooldir",
            "!conf->cleanstart"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "container_g_restore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/job_container_plugin.c",
          "lines": "245-258",
          "snippet": "extern int container_g_restore(char * dir_name, bool recover)\n{\n\tint i, rc = SLURM_SUCCESS;\n\n\tif (job_container_init())\n\t\treturn SLURM_ERROR;\n\n\tfor (i = 0; ((i < g_container_context_num) && (rc == SLURM_SUCCESS));\n\t     i++) {\n\t\trc = (*(ops[i].container_p_restore))(dir_name, recover);\n\t}\n\n\treturn rc;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/plugin.h\"",
            "#include <pthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static job_container_ops_t\t*ops = NULL;",
            "static int\t\t\tg_container_context_num = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/plugin.h\"\n#include <pthread.h>\n\nstatic job_container_ops_t\t*ops = NULL;\nstatic int\t\t\tg_container_context_num = -1;\n\nextern int container_g_restore(char * dir_name, bool recover)\n{\n\tint i, rc = SLURM_SUCCESS;\n\n\tif (job_container_init())\n\t\treturn SLURM_ERROR;\n\n\tfor (i = 0; ((i < g_container_context_num) && (rc == SLURM_SUCCESS));\n\t     i++) {\n\t\trc = (*(ops[i].container_p_restore))(dir_name, recover);\n\t}\n\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"Unable to initialize job_container plugin.\""
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "job_container_init",
          "args": [],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "job_container_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/job_container_plugin.c",
          "lines": "83-143",
          "snippet": "extern int job_container_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"job_container\";\n\tchar *container_plugin_type = NULL;\n\tchar *last = NULL, *job_container_plugin_list, *job_container = NULL;\n\n\tif (init_run && (g_container_context_num >= 0))\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_container_context_lock);\n\n\tif (g_container_context_num >= 0)\n\t\tgoto done;\n\n\tcontainer_plugin_type = slurm_get_job_container_plugin();\n\tg_container_context_num = 0; /* mark it before anything else */\n\tif ((container_plugin_type == NULL) ||\n\t    (container_plugin_type[0] == '\\0'))\n\t\tgoto done;\n\n\tjob_container_plugin_list = container_plugin_type;\n\twhile ((job_container =\n\t\tstrtok_r(job_container_plugin_list, \",\", &last))) {\n\t\txrealloc(ops,\n\t\t\t sizeof(job_container_ops_t) *\n\t\t\t (g_container_context_num + 1));\n\t\txrealloc(g_container_context, (sizeof(plugin_context_t *)\n\t\t\t\t\t  * (g_container_context_num + 1)));\n\t\tif (xstrncmp(job_container, \"job_container/\", 14) == 0)\n\t\t\tjob_container += 14; /* backward compatibility */\n\t\tjob_container = xstrdup_printf(\"job_container/%s\",\n\t\t\t\t\t       job_container);\n\t\tg_container_context[g_container_context_num] =\n\t\t\tplugin_context_create(\n\t\t\t\tplugin_type, job_container,\n\t\t\t\t(void **)&ops[g_container_context_num],\n\t\t\t\tsyms, sizeof(syms));\n\t\tif (!g_container_context[g_container_context_num]) {\n\t\t\terror(\"cannot create %s context for %s\",\n\t\t\t      plugin_type, job_container);\n\t\t\txfree(job_container);\n\t\t\tretval = SLURM_ERROR;\n\t\t\tbreak;\n\t\t}\n\n\t\txfree(job_container);\n\t\tg_container_context_num++;\n\t\tjob_container_plugin_list = NULL; /* for next iteration */\n\t}\n\tinit_run = true;\n\n done:\n\tslurm_mutex_unlock(&g_container_context_lock);\n\txfree(container_plugin_type);\n\n\tif (retval != SLURM_SUCCESS)\n\t\tjob_container_fini();\n\n\treturn retval;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/plugrack.h\"",
            "#include \"src/common/plugin.h\"",
            "#include <pthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *syms[] = {\n\t\"container_p_create\",\n\t\"container_p_add_cont\",\n\t\"container_p_add_pid\",\n\t\"container_p_delete\",\n\t\"container_p_restore\",\n\t\"container_p_reconfig\",\n};",
            "static job_container_ops_t\t*ops = NULL;",
            "static plugin_context_t\t\t**g_container_context = NULL;",
            "static int\t\t\tg_container_context_num = -1;",
            "static pthread_mutex_t\t\tg_container_context_lock =\n\t\t\t\t\tPTHREAD_MUTEX_INITIALIZER;",
            "static bool init_run = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/plugrack.h\"\n#include \"src/common/plugin.h\"\n#include <pthread.h>\n\nstatic const char *syms[] = {\n\t\"container_p_create\",\n\t\"container_p_add_cont\",\n\t\"container_p_add_pid\",\n\t\"container_p_delete\",\n\t\"container_p_restore\",\n\t\"container_p_reconfig\",\n};\nstatic job_container_ops_t\t*ops = NULL;\nstatic plugin_context_t\t\t**g_container_context = NULL;\nstatic int\t\t\tg_container_context_num = -1;\nstatic pthread_mutex_t\t\tg_container_context_lock =\n\t\t\t\t\tPTHREAD_MUTEX_INITIALIZER;\nstatic bool init_run = false;\n\nextern int job_container_init(void)\n{\n\tint retval = SLURM_SUCCESS;\n\tchar *plugin_type = \"job_container\";\n\tchar *container_plugin_type = NULL;\n\tchar *last = NULL, *job_container_plugin_list, *job_container = NULL;\n\n\tif (init_run && (g_container_context_num >= 0))\n\t\treturn retval;\n\n\tslurm_mutex_lock(&g_container_context_lock);\n\n\tif (g_container_context_num >= 0)\n\t\tgoto done;\n\n\tcontainer_plugin_type = slurm_get_job_container_plugin();\n\tg_container_context_num = 0; /* mark it before anything else */\n\tif ((container_plugin_type == NULL) ||\n\t    (container_plugin_type[0] == '\\0'))\n\t\tgoto done;\n\n\tjob_container_plugin_list = container_plugin_type;\n\twhile ((job_container =\n\t\tstrtok_r(job_container_plugin_list, \",\", &last))) {\n\t\txrealloc(ops,\n\t\t\t sizeof(job_container_ops_t) *\n\t\t\t (g_container_context_num + 1));\n\t\txrealloc(g_container_context, (sizeof(plugin_context_t *)\n\t\t\t\t\t  * (g_container_context_num + 1)));\n\t\tif (xstrncmp(job_container, \"job_container/\", 14) == 0)\n\t\t\tjob_container += 14; /* backward compatibility */\n\t\tjob_container = xstrdup_printf(\"job_container/%s\",\n\t\t\t\t\t       job_container);\n\t\tg_container_context[g_container_context_num] =\n\t\t\tplugin_context_create(\n\t\t\t\tplugin_type, job_container,\n\t\t\t\t(void **)&ops[g_container_context_num],\n\t\t\t\tsyms, sizeof(syms));\n\t\tif (!g_container_context[g_container_context_num]) {\n\t\t\terror(\"cannot create %s context for %s\",\n\t\t\t      plugin_type, job_container);\n\t\t\txfree(job_container);\n\t\t\tretval = SLURM_ERROR;\n\t\t\tbreak;\n\t\t}\n\n\t\txfree(job_container);\n\t\tg_container_context_num++;\n\t\tjob_container_plugin_list = NULL; /* for next iteration */\n\t}\n\tinit_run = true;\n\n done:\n\tslurm_mutex_unlock(&g_container_context_lock);\n\txfree(container_plugin_type);\n\n\tif (retval != SLURM_SUCCESS)\n\t\tjob_container_fini();\n\n\treturn retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"Unable to initialize jobacct_gather\""
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jobacct_gather_init",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_restore_cred_state",
          "args": [
            "conf->vctx"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "_restore_cred_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1656-1693",
          "snippet": "static int\n_restore_cred_state(slurm_cred_ctx_t ctx)\n{\n\tchar *file_name = NULL, *data = NULL;\n\tuint32_t data_size = 0;\n\tint cred_fd, data_allocated, data_read = 0;\n\tBuf buffer = NULL;\n\n\tif ( (mkdir(conf->spooldir, 0755) < 0) && (errno != EEXIST) ) {\n\t\tfatal(\"mkdir(%s): %m\", conf->spooldir);\n\t\treturn SLURM_ERROR;\n\t}\n\n\tfile_name = xstrdup(conf->spooldir);\n\txstrcat(file_name, \"/cred_state\");\n\tcred_fd = open(file_name, O_RDONLY);\n\tif (cred_fd < 0)\n\t\tgoto cleanup;\n\n\tdata_allocated = 1024;\n\tdata = xmalloc(sizeof(char)*data_allocated);\n\twhile ((data_read = read(cred_fd, &data[data_size], 1024)) == 1024) {\n\t\tdata_size += data_read;\n\t\tdata_allocated += 1024;\n\t\txrealloc(data, data_allocated);\n\t}\n\tdata_size += data_read;\n\tclose(cred_fd);\n\tbuffer = create_buf(data, data_size);\n\n\tslurm_cred_ctx_unpack(ctx, buffer);\n\ncleanup:\n\txfree(file_name);\n\tif (buffer)\n\t\tfree_buf(buffer);\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static int       _restore_cred_state(slurm_cred_ctx_t ctx);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic int       _restore_cred_state(slurm_cred_ctx_t ctx);\n\nstatic int\n_restore_cred_state(slurm_cred_ctx_t ctx)\n{\n\tchar *file_name = NULL, *data = NULL;\n\tuint32_t data_size = 0;\n\tint cred_fd, data_allocated, data_read = 0;\n\tBuf buffer = NULL;\n\n\tif ( (mkdir(conf->spooldir, 0755) < 0) && (errno != EEXIST) ) {\n\t\tfatal(\"mkdir(%s): %m\", conf->spooldir);\n\t\treturn SLURM_ERROR;\n\t}\n\n\tfile_name = xstrdup(conf->spooldir);\n\txstrcat(file_name, \"/cred_state\");\n\tcred_fd = open(file_name, O_RDONLY);\n\tif (cred_fd < 0)\n\t\tgoto cleanup;\n\n\tdata_allocated = 1024;\n\tdata = xmalloc(sizeof(char)*data_allocated);\n\twhile ((data_read = read(cred_fd, &data[data_size], 1024)) == 1024) {\n\t\tdata_size += data_read;\n\t\tdata_allocated += 1024;\n\t\txrealloc(data, data_allocated);\n\t}\n\tdata_size += data_read;\n\tclose(cred_fd);\n\tbuffer = create_buf(data, data_size);\n\n\tslurm_cred_ctx_unpack(ctx, buffer);\n\ncleanup:\n\txfree(file_name);\n\tif (buffer)\n\t\tfree_buf(buffer);\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"mlockall() system call does not appear to be available\""
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"failed to mlock() slurmd pages: %m\""
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlockall",
          "args": [
            "MCL_FUTURE | MCL_CURRENT"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_kill_old_slurmd",
          "args": [],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "_kill_old_slurmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1890-1908",
          "snippet": "static void\n_kill_old_slurmd(void)\n{\n\tint fd;\n\tpid_t oldpid = read_pidfile(conf->pidfile, &fd);\n\tif (oldpid != (pid_t) 0) {\n\t\tinfo (\"killing old slurmd[%lu]\", (unsigned long) oldpid);\n\t\tkill(oldpid, SIGTERM);\n\n\t\t/*\n\t\t * Wait for previous daemon to terminate\n\t\t */\n\t\tif (fd_get_readw_lock(fd) < 0) {\n\t\t\tfatal (\"error getting readw lock on file %s: %m\",\n\t\t\t       conf->pidfile);\n\t\t}\n\t\t(void) close(fd); /* Ignore errors */\n\t}\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _kill_old_slurmd(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _kill_old_slurmd(void);\n\nstatic void\n_kill_old_slurmd(void)\n{\n\tint fd;\n\tpid_t oldpid = read_pidfile(conf->pidfile, &fd);\n\tif (oldpid != (pid_t) 0) {\n\t\tinfo (\"killing old slurmd[%lu]\", (unsigned long) oldpid);\n\t\tkill(oldpid, SIGTERM);\n\n\t\t/*\n\t\t * Wait for previous daemon to terminate\n\t\t */\n\t\tif (fd_get_readw_lock(fd) < 0) {\n\t\t\tfatal (\"error getting readw lock on file %s: %m\",\n\t\t\t       conf->pidfile);\n\t\t}\n\t\t(void) close(fd); /* Ignore errors */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_oom_adj",
          "args": [
            "i"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "set_oom_adj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/set_oomadj.c",
          "lines": "93-98",
          "snippet": "extern int set_oom_adj(int adj)\n{\n\t/* FreeBSD does not handle OOM the same way Linux does */\n\t(void) adj; /* unused argument */\n\treturn 0;\n}",
          "includes": [
            "#include \"src/common/log.h\"",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/common/log.h\"\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n\nextern int set_oom_adj(int adj)\n{\n\t/* FreeBSD does not handle OOM the same way Linux does */\n\t(void) adj; /* unused argument */\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"Setting slurmd oom_adj to %d\"",
            "i"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "pdebug_wake_process",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/pdebug.c",
          "lines": "187-199",
          "snippet": "void pdebug_wake_process(stepd_step_rec_t *job, pid_t pid)\n{\n\tif ((job->task_flags & TASK_PARALLEL_DEBUG) && (pid > (pid_t) 0)) {\n\t\tif (_pid_to_wake(pid)) {\n\t\t\tif (kill(pid, SIGCONT) < 0)\n\t\t\t\terror(\"kill(%lu): %m\", (unsigned long) pid);\n\t\t\telse\n\t\t\t\tdebug(\"woke pid %lu\", (unsigned long) pid);\n\t\t} else {\n\t\t\tdebug(\"pid %lu not stopped\", (unsigned long) pid);\n\t\t}\n\t}\n}",
          "includes": [
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"pdebug.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"pdebug.h\"\n\nvoid pdebug_wake_process(stepd_step_rec_t *job, pid_t pid)\n{\n\tif ((job->task_flags & TASK_PARALLEL_DEBUG) && (pid > (pid_t) 0)) {\n\t\tif (_pid_to_wake(pid)) {\n\t\t\tif (kill(pid, SIGCONT) < 0)\n\t\t\t\terror(\"kill(%lu): %m\", (unsigned long) pid);\n\t\t\telse\n\t\t\t\tdebug(\"woke pid %lu\", (unsigned long) pid);\n\t\t} else {\n\t\t\tdebug(\"pid %lu not stopped\", (unsigned long) pid);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "oom_value"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"SLURMD_OOM_ADJ\""
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"finished daemonize\""
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"slurmd version %s started\"",
            "SLURM_VERSION_STRING"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "_task_info_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/slurmstepd_job.c",
          "lines": "222-232",
          "snippet": "static void\n_task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog)\n{\n\tslurm_mutex_lock(&t->mutex);\n\tslurm_mutex_unlock(&t->mutex);\n\tslurm_mutex_destroy(&t->mutex);\n\tif (multi_prog) {\n\t\txfree(t->argv);\n\t} /* otherwise, t->argv is a pointer to job->argv */\n\txfree(t);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmstepd/multi_prog.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include <sys/types.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <grp.h>",
            "#  include <string.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void _task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmstepd/multi_prog.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include <sys/types.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <grp.h>\n#  include <string.h>\n#  include \"config.h\"\n\nstatic void _task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog);\n\nstatic void\n_task_info_destroy(stepd_step_task_info_t *t, uint16_t multi_prog)\n{\n\tslurm_mutex_lock(&t->mutex);\n\tslurm_mutex_unlock(&t->mutex);\n\tslurm_mutex_destroy(&t->mutex);\n\tif (multi_prog) {\n\t\txfree(t->argv);\n\t} /* otherwise, t->argv is a pointer to job->argv */\n\txfree(t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_core_limit",
          "args": [],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Couldn't daemonize slurmd: %m\""
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "daemon",
          "args": [
            "1",
            "1"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "_handle_daemon_pid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/req.c",
          "lines": "1383-1391",
          "snippet": "static int\n_handle_daemon_pid(int fd, stepd_step_rec_t *job)\n{\n\tsafe_write(fd, &job->jmgr_pid, sizeof(pid_t));\n\n\treturn SLURM_SUCCESS;\nrwfail:\n\treturn SLURM_FAILURE;\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/timers.h\"",
            "#include \"src/common/checkpoint.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_acct_gather.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include <stdlib.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int _handle_state(int fd, stepd_step_rec_t *job);",
            "static int _handle_info(int fd, stepd_step_rec_t *job);",
            "static int _handle_mem_limits(int fd, stepd_step_rec_t *job);",
            "static int _handle_uid(int fd, stepd_step_rec_t *job);",
            "static int _handle_nodeid(int fd, stepd_step_rec_t *job);",
            "static int _handle_pid_in_container(int fd, stepd_step_rec_t *job);",
            "static int _handle_add_extern_pid(int fd, stepd_step_rec_t *job);",
            "static int _handle_daemon_pid(int fd, stepd_step_rec_t *job);",
            "static int _handle_task_info(int fd, stepd_step_rec_t *job);",
            "static int _handle_list_pids(int fd, stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/timers.h\"\n#include \"src/common/checkpoint.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_acct_gather.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/cpu_frequency.h\"\n#include <stdlib.h>\n#include <time.h>\n#include <signal.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#  include \"config.h\"\n\nstatic int _handle_state(int fd, stepd_step_rec_t *job);\nstatic int _handle_info(int fd, stepd_step_rec_t *job);\nstatic int _handle_mem_limits(int fd, stepd_step_rec_t *job);\nstatic int _handle_uid(int fd, stepd_step_rec_t *job);\nstatic int _handle_nodeid(int fd, stepd_step_rec_t *job);\nstatic int _handle_pid_in_container(int fd, stepd_step_rec_t *job);\nstatic int _handle_add_extern_pid(int fd, stepd_step_rec_t *job);\nstatic int _handle_daemon_pid(int fd, stepd_step_rec_t *job);\nstatic int _handle_task_info(int fd, stepd_step_rec_t *job);\nstatic int _handle_list_pids(int fd, stepd_step_rec_t *job);\n\nstatic int\n_handle_daemon_pid(int fd, stepd_step_rec_t *job)\n{\n\tsafe_write(fd, &job->jmgr_pid, sizeof(pid_t));\n\n\treturn SLURM_SUCCESS;\nrwfail:\n\treturn SLURM_FAILURE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"slurmd initialization successful\""
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xsignal_block",
          "args": [
            "blocked_signals"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xsignal",
          "args": [
            "SIGHUP",
            "&_hup_handler"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xsignal",
          "args": [
            "SIGINT",
            "&_term_handler"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xsignal",
          "args": [
            "SIGTERM",
            "&_term_handler"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_setproctitle",
          "args": [
            "argc",
            "argv"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "init_setproctitle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/setproctitle.c",
          "lines": "263-328",
          "snippet": "void\ninit_setproctitle(int argc, char *argv[])\n{\n#if SETPROCTITLE_STRATEGY == PS_USE_CLOBBER_ARGV\n\tchar *end_of_area = NULL;\n\tint i;\n#endif\n\n\tsave_argc = argc;\n\tsave_argv = argv;\n\n#if defined(__NetBSD__) || defined(__FreeBSD__)\n\tsetprogname (argv[0]);\n#else\n\t_init__progname (argv[0]);\n#endif\n\n#if SETPROCTITLE_STRATEGY == PS_USE_CLOBBER_ARGV\n\t/*\n\t * If we're going to overwrite the argv area, count the available\n\t * space.  Also move the environment to make additional room.\n\t */\n\n\t/*\n\t * check for contiguous argv strings\n\t */\n\tfor (i = 0; i < argc; i++) {\n\t\tif (i == 0 || end_of_area + 1 == argv[i])\n\t\t\tend_of_area = argv[i] + strlen(argv[i]);\n\t}\n\n\t/* probably can't happen? */\n\tif (end_of_area == NULL) {\n\t\tps_buffer = NULL;\n\t\tps_buffer_size = 0;\n\t\treturn;\n\t}\n\n\t/*\n\t * check for contiguous environ strings following argv\n\t */\n\tfor (i = 0; environ[i] != NULL; i++) {\n\t\tif (end_of_area + 1 == environ[i])\n\t\t\tend_of_area = environ[i] + strlen(environ[i]);\n\t}\n\n\tps_buffer = argv[0];\n\tps_buffer_size = end_of_area - argv[0] - 1;\n\n\t/*\n\t * Duplicate and move the environment out of the way\n\t */\n\tnew_environ = malloc(sizeof(char *) * (i + 1));\n\tif (!new_environ) {\n\t\tfprintf(stderr, \"ERROR: [%s:%d] %s: %s\\n\",\n\t\t\t__FILE__, __LINE__, \"init_setproctitle\",\n\t\t\tstrerror(errno));\n\t\tabort();\n\t}\n\tfor (i = 0; environ[i] != NULL; i++) {\n\t\tnew_environ[i] = strdup(environ[i]);\n\t}\n\tnew_environ[i] = NULL;\n\tenviron = new_environ;\n#endif /* PS_USE_CLOBBER_ARGV */\n}",
          "includes": [
            "#include <sys/exec.h>",
            "#include <machine/vmparam.h>\t/* for old BSD */",
            "#include <sys/pstat.h>\t\t/* for HP-UX */",
            "#include \"src/common/strlcpy.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#    include \"src/common/malloc.h\"",
            "#  include \"config.h\""
          ],
          "macros_used": [
            "#define PS_USE_CLOBBER_ARGV\t\t4"
          ],
          "globals_used": [
            "extern char **environ;",
            "static int\tsave_argc;",
            "static char **save_argv;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/exec.h>\n#include <machine/vmparam.h>\t/* for old BSD */\n#include <sys/pstat.h>\t\t/* for HP-UX */\n#include \"src/common/strlcpy.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n#    include \"src/common/malloc.h\"\n#  include \"config.h\"\n\n#define PS_USE_CLOBBER_ARGV\t\t4\n\nextern char **environ;\nstatic int\tsave_argc;\nstatic char **save_argv;\n\nvoid\ninit_setproctitle(int argc, char *argv[])\n{\n#if SETPROCTITLE_STRATEGY == PS_USE_CLOBBER_ARGV\n\tchar *end_of_area = NULL;\n\tint i;\n#endif\n\n\tsave_argc = argc;\n\tsave_argv = argv;\n\n#if defined(__NetBSD__) || defined(__FreeBSD__)\n\tsetprogname (argv[0]);\n#else\n\t_init__progname (argv[0]);\n#endif\n\n#if SETPROCTITLE_STRATEGY == PS_USE_CLOBBER_ARGV\n\t/*\n\t * If we're going to overwrite the argv area, count the available\n\t * space.  Also move the environment to make additional room.\n\t */\n\n\t/*\n\t * check for contiguous argv strings\n\t */\n\tfor (i = 0; i < argc; i++) {\n\t\tif (i == 0 || end_of_area + 1 == argv[i])\n\t\t\tend_of_area = argv[i] + strlen(argv[i]);\n\t}\n\n\t/* probably can't happen? */\n\tif (end_of_area == NULL) {\n\t\tps_buffer = NULL;\n\t\tps_buffer_size = 0;\n\t\treturn;\n\t}\n\n\t/*\n\t * check for contiguous environ strings following argv\n\t */\n\tfor (i = 0; environ[i] != NULL; i++) {\n\t\tif (end_of_area + 1 == environ[i])\n\t\t\tend_of_area = environ[i] + strlen(environ[i]);\n\t}\n\n\tps_buffer = argv[0];\n\tps_buffer_size = end_of_area - argv[0] - 1;\n\n\t/*\n\t * Duplicate and move the environment out of the way\n\t */\n\tnew_environ = malloc(sizeof(char *) * (i + 1));\n\tif (!new_environ) {\n\t\tfprintf(stderr, \"ERROR: [%s:%d] %s: %s\\n\",\n\t\t\t__FILE__, __LINE__, \"init_setproctitle\",\n\t\t\tstrerror(errno));\n\t\tabort();\n\t}\n\tfor (i = 0; environ[i] != NULL; i++) {\n\t\tnew_environ[i] = strdup(environ[i]);\n\t}\n\tnew_environ[i] = NULL;\n\tenviron = new_environ;\n#endif /* PS_USE_CLOBBER_ARGV */\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"You are running slurmd as something \"\n\t\t      \"other than user %s(%d).  If you want to \"\n\t\t      \"run as this user add SlurmdUser=%s \"\n\t\t      \"to the slurm.conf file.\"",
            "slurmd_user",
            "slurmd_uid",
            "curr_user"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpwuid",
          "args": [
            "curr_uid"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "pw->pw_name"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpwuid",
          "args": [
            "slurmd_uid"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_get_slurmd_user_id",
          "args": [],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "_send_pending_exit_msgs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/mgr.c",
          "lines": "1890-1927",
          "snippet": "static int\n_send_pending_exit_msgs(stepd_step_rec_t *job)\n{\n\tint  i;\n\tint  nsent  = 0;\n\tint  status = 0;\n\tbool set    = false;\n\tuint32_t *tid;\n\n\t/*\n\t * Collect all exit codes with the same status into a\n\t * single message.\n\t */\n\ttid = xmalloc(sizeof(uint32_t) * job->node_tasks);\n\tfor (i = 0; i < job->node_tasks; i++) {\n\t\tstepd_step_task_info_t *t = job->task[i];\n\n\t\tif (!t->exited || t->esent)\n\t\t\tcontinue;\n\n\t\tif (!set) {\n\t\t\tstatus = t->estatus;\n\t\t\tset    = true;\n\t\t} else if (status != t->estatus)\n\t\t\tcontinue;\n\n\t\ttid[nsent++] = t->gtid;\n\t\tt->esent = true;\n\t}\n\n\tif (nsent) {\n\t\tdebug2(\"Aggregated %d task exit messages\", nsent);\n\t\t_send_exit_msg(job, tid, nsent, status);\n\t}\n\txfree(tid);\n\n\treturn nsent;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/ulimits.h\"",
            "#include \"src/slurmd/slurmstepd/pam_ses.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmstepd/task.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/reverse_tree.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/slurm_mpi.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/safeopen.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#    include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <pthread.h>",
            "#include <poll.h>",
            "#include <grp.h>",
            "#  include \"src/common/unsetenv.h\"",
            "#  include <sys/checkpnt.h>",
            "#  include <sys/prctl.h>",
            "#  include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void  _set_prio_process (stepd_step_rec_t *job);",
            "static void _set_job_log_prefix(stepd_step_rec_t *job);",
            "static int  _setup_normal_io(stepd_step_rec_t *job);",
            "static int  _slurmd_job_log_init(stepd_step_rec_t *job);",
            "static void _wait_for_io(stepd_step_rec_t *job);",
            "static int  _send_exit_msg(stepd_step_rec_t *job, uint32_t *tid, int n,\n\t\t\t   int status);",
            "static void _wait_for_children_slurmstepd(stepd_step_rec_t *job);",
            "static int  _send_pending_exit_msgs(stepd_step_rec_t *job);",
            "static void _send_step_complete_msgs(stepd_step_rec_t *job);",
            "static void _wait_for_all_tasks(stepd_step_rec_t *job);",
            "static void _setargs(stepd_step_rec_t *job);",
            "static void _random_sleep(stepd_step_rec_t *job);",
            "static char * _make_batch_dir(stepd_step_rec_t *job);",
            "static int    _send_complete_batch_script_msg(stepd_step_rec_t *job,\n\t\t\t\t\t      int err, int status);",
            "static int _initgroups(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/ulimits.h\"\n#include \"src/slurmd/slurmstepd/pam_ses.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmstepd/task.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/reverse_tree.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/slurm_mpi.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/safeopen.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/cbuf.h\"\n#include \"slurm/slurm_errno.h\"\n#    include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <string.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <pthread.h>\n#include <poll.h>\n#include <grp.h>\n#  include \"src/common/unsetenv.h\"\n#  include <sys/checkpnt.h>\n#  include <sys/prctl.h>\n#  include <sys/types.h>\n#  include \"config.h\"\n\nstatic void  _set_prio_process (stepd_step_rec_t *job);\nstatic void _set_job_log_prefix(stepd_step_rec_t *job);\nstatic int  _setup_normal_io(stepd_step_rec_t *job);\nstatic int  _slurmd_job_log_init(stepd_step_rec_t *job);\nstatic void _wait_for_io(stepd_step_rec_t *job);\nstatic int  _send_exit_msg(stepd_step_rec_t *job, uint32_t *tid, int n,\n\t\t\t   int status);\nstatic void _wait_for_children_slurmstepd(stepd_step_rec_t *job);\nstatic int  _send_pending_exit_msgs(stepd_step_rec_t *job);\nstatic void _send_step_complete_msgs(stepd_step_rec_t *job);\nstatic void _wait_for_all_tasks(stepd_step_rec_t *job);\nstatic void _setargs(stepd_step_rec_t *job);\nstatic void _random_sleep(stepd_step_rec_t *job);\nstatic char * _make_batch_dir(stepd_step_rec_t *job);\nstatic int    _send_complete_batch_script_msg(stepd_step_rec_t *job,\n\t\t\t\t\t      int err, int status);\nstatic int _initgroups(stepd_step_rec_t *job);\n\nstatic int\n_send_pending_exit_msgs(stepd_step_rec_t *job)\n{\n\tint  i;\n\tint  nsent  = 0;\n\tint  status = 0;\n\tbool set    = false;\n\tuint32_t *tid;\n\n\t/*\n\t * Collect all exit codes with the same status into a\n\t * single message.\n\t */\n\ttid = xmalloc(sizeof(uint32_t) * job->node_tasks);\n\tfor (i = 0; i < job->node_tasks; i++) {\n\t\tstepd_step_task_info_t *t = job->task[i];\n\n\t\tif (!t->exited || t->esent)\n\t\t\tcontinue;\n\n\t\tif (!set) {\n\t\t\tstatus = t->estatus;\n\t\t\tset    = true;\n\t\t} else if (status != t->estatus)\n\t\t\tcontinue;\n\n\t\ttid[nsent++] = t->gtid;\n\t\tt->esent = true;\n\t}\n\n\tif (nsent) {\n\t\tdebug2(\"Aggregated %d task exit messages\", nsent);\n\t\t_send_exit_msg(job, tid, nsent, status);\n\t}\n\txfree(tid);\n\n\treturn nsent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "NULL"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"slurmd initialization failed\""
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_slurmd_init",
          "args": [],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "_slurmd_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1480-1654",
          "snippet": "static int\n_slurmd_init(void)\n{\n\tstruct rlimit rlim;\n\tstruct stat stat_buf;\n\tuint32_t cpu_cnt;\n\n\t/*\n\t * Process commandline arguments first, since one option may be\n\t * an alternate location for the slurm config file.\n\t */\n\t_process_cmdline(*conf->argc, *conf->argv);\n\n\t/*\n\t * Build nodes table like in slurmctld\n\t * This is required by the topology stack\n\t * Node tables setup must precede _read_config() so that the\n\t * proper hostname is set.\n\t */\n\tslurm_conf_init(conf->conffile);\n\tinit_node_conf();\n\t/* slurm_select_init() must be called before\n\t * build_all_nodeline_info() to be called with proper argument. */\n\tif (slurm_select_init(1) != SLURM_SUCCESS )\n\t\treturn SLURM_FAILURE;\n\tbuild_all_nodeline_info(true);\n\tbuild_all_frontend_info(true);\n\n\t/*\n\t * Read global slurm config file, override necessary values from\n\t * defaults and command line.\n\t */\n\t_read_config();\n\n\tcpu_cnt = MAX(conf->conf_cpus, conf->block_map_size);\n\n\tif ((gres_plugin_init() != SLURM_SUCCESS) ||\n\t    (gres_plugin_node_config_load(cpu_cnt, conf->node_name, NULL)\n\t     != SLURM_SUCCESS))\n\t\treturn SLURM_FAILURE;\n\tif (slurm_topo_init() != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\n\t/*\n\t * Get and set slurmd topology information\n\t * Build node hash table first to speed up the topo build\n\t */\n\trehash_node();\n\tslurm_topo_build_config();\n\t_set_topo_info();\n\n\troute_init(conf->node_name);\n\n\t/*\n\t * Check for cpu frequency set capabilities on this node\n\t */\n\tcpu_freq_init(conf);\n\n\t/*\n\t * If configured, apply resource specialization\n\t */\n\t_resource_spec_init();\n\n\t_print_conf();\n\n\tif (slurm_proctrack_init() != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\tif (slurmd_task_init() != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\tif (slurm_auth_init(NULL) != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\tif (spank_slurmd_init() < 0)\n\t\treturn SLURM_FAILURE;\n\n\tif (getrlimit(RLIMIT_CPU, &rlim) == 0) {\n\t\trlim.rlim_cur = rlim.rlim_max;\n\t\tsetrlimit(RLIMIT_CPU, &rlim);\n\t\tif (rlim.rlim_max != RLIM_INFINITY) {\n\t\t\terror(\"Slurmd process CPU time limit is %d seconds\",\n\t\t\t      (int) rlim.rlim_max);\n\t\t}\n\t}\n\n\tif (getrlimit(RLIMIT_NOFILE, &rlim) == 0) {\n\t\trlim.rlim_cur = rlim.rlim_max;\n\t\tsetrlimit(RLIMIT_NOFILE, &rlim);\n\t}\n#ifndef NDEBUG\n\tif (getrlimit(RLIMIT_CORE, &rlim) == 0) {\n\t\trlim.rlim_cur = rlim.rlim_max;\n\t\tsetrlimit(RLIMIT_CORE, &rlim);\n\t}\n#endif /* !NDEBUG */\n\n\t/*\n\t * Create a context for verifying slurm job credentials\n\t */\n\tif (!(conf->vctx = slurm_cred_verifier_ctx_create(conf->pubkey)))\n\t\treturn SLURM_FAILURE;\n\tif (!xstrcmp(conf->select_type, \"select/serial\")) {\n\t\t/* Only cache credential for 5 seconds with select/serial\n\t\t * for shorter cache searches and higher throughput */\n\t\tslurm_cred_ctx_set(conf->vctx, SLURM_CRED_OPT_EXPIRY_WINDOW, 5);\n\t}\n\n\t/*\n\t * Create slurmd spool directory if necessary.\n\t */\n\tif (_set_slurmd_spooldir() < 0) {\n\t\terror(\"Unable to initialize slurmd spooldir\");\n\t\treturn SLURM_FAILURE;\n\t}\n\n\tif (conf->cleanstart) {\n\t\t/*\n\t\t * Need to kill any running slurmd's here\n\t\t */\n\t\t_kill_old_slurmd();\n\n\t\tstepd_cleanup_sockets(conf->spooldir, conf->node_name);\n\t\t_stepd_cleanup_batch_dirs(conf->spooldir, conf->node_name);\n\t}\n\n\tif (conf->daemonize) {\n\t\tbool success = false;\n\n\t\tif (conf->logfile && (conf->logfile[0] == '/')) {\n\t\t\tchar *slash_ptr, *work_dir;\n\t\t\twork_dir = xstrdup(conf->logfile);\n\t\t\tslash_ptr = strrchr(work_dir, '/');\n\t\t\tif (slash_ptr == work_dir)\n\t\t\t\twork_dir[1] = '\\0';\n\t\t\telse\n\t\t\t\tslash_ptr[0] = '\\0';\n\t\t\tif ((access(work_dir, W_OK) != 0) ||\n\t\t\t    (chdir(work_dir) < 0)) {\n\t\t\t\terror(\"Unable to chdir to %s\", work_dir);\n\t\t\t} else\n\t\t\t\tsuccess = true;\n\t\t\txfree(work_dir);\n\t\t}\n\n\t\tif (!success) {\n\t\t\tif ((access(conf->spooldir, W_OK) != 0) ||\n\t\t\t    (chdir(conf->spooldir) < 0)) {\n\t\t\t\terror(\"Unable to chdir to %s\", conf->spooldir);\n\t\t\t} else\n\t\t\t\tsuccess = true;\n\t\t}\n\n\t\tif (!success) {\n\t\t\tif ((access(\"/var/tmp\", W_OK) != 0) ||\n\t\t\t    (chdir(\"/var/tmp\") < 0)) {\n\t\t\t\terror(\"chdir(/var/tmp): %m\");\n\t\t\t\treturn SLURM_FAILURE;\n\t\t\t} else\n\t\t\t\tinfo(\"chdir to /var/tmp\");\n\t\t}\n\t}\n\n\tif ((devnull = open_cloexec(\"/dev/null\", O_RDWR)) < 0) {\n\t\terror(\"Unable to open /dev/null: %m\");\n\t\treturn SLURM_FAILURE;\n\t}\n\n\t/* make sure we have slurmstepd installed */\n\tif (stat(conf->stepd_loc, &stat_buf))\n\t\tfatal(\"Unable to find slurmstepd file at %s\", conf->stepd_loc);\n\tif (!S_ISREG(stat_buf.st_mode))\n\t\tfatal(\"slurmstepd not a file at %s\", conf->stepd_loc);\n\tif (conf->chos_loc && (access(conf->chos_loc, X_OK) != 0))\n\t\terror(\"Unable to execute ChosLoc at %s: %m\", conf->chos_loc);\n\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int devnull = -1;",
            "slurmd_conf_t * conf = NULL;",
            "static void      _kill_old_slurmd(void);",
            "static void      _print_conf(void);",
            "static void      _read_config(void);",
            "static int       _resource_spec_init(void);",
            "static int       _set_slurmd_spooldir(void);",
            "static int       _set_topo_info(void);",
            "static int       _slurmd_init(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nint devnull = -1;\nslurmd_conf_t * conf = NULL;\nstatic void      _kill_old_slurmd(void);\nstatic void      _print_conf(void);\nstatic void      _read_config(void);\nstatic int       _resource_spec_init(void);\nstatic int       _set_slurmd_spooldir(void);\nstatic int       _set_topo_info(void);\nstatic int       _slurmd_init(void);\n\nstatic int\n_slurmd_init(void)\n{\n\tstruct rlimit rlim;\n\tstruct stat stat_buf;\n\tuint32_t cpu_cnt;\n\n\t/*\n\t * Process commandline arguments first, since one option may be\n\t * an alternate location for the slurm config file.\n\t */\n\t_process_cmdline(*conf->argc, *conf->argv);\n\n\t/*\n\t * Build nodes table like in slurmctld\n\t * This is required by the topology stack\n\t * Node tables setup must precede _read_config() so that the\n\t * proper hostname is set.\n\t */\n\tslurm_conf_init(conf->conffile);\n\tinit_node_conf();\n\t/* slurm_select_init() must be called before\n\t * build_all_nodeline_info() to be called with proper argument. */\n\tif (slurm_select_init(1) != SLURM_SUCCESS )\n\t\treturn SLURM_FAILURE;\n\tbuild_all_nodeline_info(true);\n\tbuild_all_frontend_info(true);\n\n\t/*\n\t * Read global slurm config file, override necessary values from\n\t * defaults and command line.\n\t */\n\t_read_config();\n\n\tcpu_cnt = MAX(conf->conf_cpus, conf->block_map_size);\n\n\tif ((gres_plugin_init() != SLURM_SUCCESS) ||\n\t    (gres_plugin_node_config_load(cpu_cnt, conf->node_name, NULL)\n\t     != SLURM_SUCCESS))\n\t\treturn SLURM_FAILURE;\n\tif (slurm_topo_init() != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\n\t/*\n\t * Get and set slurmd topology information\n\t * Build node hash table first to speed up the topo build\n\t */\n\trehash_node();\n\tslurm_topo_build_config();\n\t_set_topo_info();\n\n\troute_init(conf->node_name);\n\n\t/*\n\t * Check for cpu frequency set capabilities on this node\n\t */\n\tcpu_freq_init(conf);\n\n\t/*\n\t * If configured, apply resource specialization\n\t */\n\t_resource_spec_init();\n\n\t_print_conf();\n\n\tif (slurm_proctrack_init() != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\tif (slurmd_task_init() != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\tif (slurm_auth_init(NULL) != SLURM_SUCCESS)\n\t\treturn SLURM_FAILURE;\n\tif (spank_slurmd_init() < 0)\n\t\treturn SLURM_FAILURE;\n\n\tif (getrlimit(RLIMIT_CPU, &rlim) == 0) {\n\t\trlim.rlim_cur = rlim.rlim_max;\n\t\tsetrlimit(RLIMIT_CPU, &rlim);\n\t\tif (rlim.rlim_max != RLIM_INFINITY) {\n\t\t\terror(\"Slurmd process CPU time limit is %d seconds\",\n\t\t\t      (int) rlim.rlim_max);\n\t\t}\n\t}\n\n\tif (getrlimit(RLIMIT_NOFILE, &rlim) == 0) {\n\t\trlim.rlim_cur = rlim.rlim_max;\n\t\tsetrlimit(RLIMIT_NOFILE, &rlim);\n\t}\n#ifndef NDEBUG\n\tif (getrlimit(RLIMIT_CORE, &rlim) == 0) {\n\t\trlim.rlim_cur = rlim.rlim_max;\n\t\tsetrlimit(RLIMIT_CORE, &rlim);\n\t}\n#endif /* !NDEBUG */\n\n\t/*\n\t * Create a context for verifying slurm job credentials\n\t */\n\tif (!(conf->vctx = slurm_cred_verifier_ctx_create(conf->pubkey)))\n\t\treturn SLURM_FAILURE;\n\tif (!xstrcmp(conf->select_type, \"select/serial\")) {\n\t\t/* Only cache credential for 5 seconds with select/serial\n\t\t * for shorter cache searches and higher throughput */\n\t\tslurm_cred_ctx_set(conf->vctx, SLURM_CRED_OPT_EXPIRY_WINDOW, 5);\n\t}\n\n\t/*\n\t * Create slurmd spool directory if necessary.\n\t */\n\tif (_set_slurmd_spooldir() < 0) {\n\t\terror(\"Unable to initialize slurmd spooldir\");\n\t\treturn SLURM_FAILURE;\n\t}\n\n\tif (conf->cleanstart) {\n\t\t/*\n\t\t * Need to kill any running slurmd's here\n\t\t */\n\t\t_kill_old_slurmd();\n\n\t\tstepd_cleanup_sockets(conf->spooldir, conf->node_name);\n\t\t_stepd_cleanup_batch_dirs(conf->spooldir, conf->node_name);\n\t}\n\n\tif (conf->daemonize) {\n\t\tbool success = false;\n\n\t\tif (conf->logfile && (conf->logfile[0] == '/')) {\n\t\t\tchar *slash_ptr, *work_dir;\n\t\t\twork_dir = xstrdup(conf->logfile);\n\t\t\tslash_ptr = strrchr(work_dir, '/');\n\t\t\tif (slash_ptr == work_dir)\n\t\t\t\twork_dir[1] = '\\0';\n\t\t\telse\n\t\t\t\tslash_ptr[0] = '\\0';\n\t\t\tif ((access(work_dir, W_OK) != 0) ||\n\t\t\t    (chdir(work_dir) < 0)) {\n\t\t\t\terror(\"Unable to chdir to %s\", work_dir);\n\t\t\t} else\n\t\t\t\tsuccess = true;\n\t\t\txfree(work_dir);\n\t\t}\n\n\t\tif (!success) {\n\t\t\tif ((access(conf->spooldir, W_OK) != 0) ||\n\t\t\t    (chdir(conf->spooldir) < 0)) {\n\t\t\t\terror(\"Unable to chdir to %s\", conf->spooldir);\n\t\t\t} else\n\t\t\t\tsuccess = true;\n\t\t}\n\n\t\tif (!success) {\n\t\t\tif ((access(\"/var/tmp\", W_OK) != 0) ||\n\t\t\t    (chdir(\"/var/tmp\") < 0)) {\n\t\t\t\terror(\"chdir(/var/tmp): %m\");\n\t\t\t\treturn SLURM_FAILURE;\n\t\t\t} else\n\t\t\t\tinfo(\"chdir to /var/tmp\");\n\t\t}\n\t}\n\n\tif ((devnull = open_cloexec(\"/dev/null\", O_RDWR)) < 0) {\n\t\terror(\"Unable to open /dev/null: %m\");\n\t\treturn SLURM_FAILURE;\n\t}\n\n\t/* make sure we have slurmstepd installed */\n\tif (stat(conf->stepd_loc, &stat_buf))\n\t\tfatal(\"Unable to find slurmstepd file at %s\", conf->stepd_loc);\n\tif (!S_ISREG(stat_buf.st_mode))\n\t\tfatal(\"slurmstepd not a file at %s\", conf->stepd_loc);\n\tif (conf->chos_loc && (access(conf->chos_loc, X_OK) != 0))\n\t\terror(\"Unable to execute ChosLoc at %s: %m\", conf->chos_loc);\n\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_init_conf",
          "args": [],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "_init_conf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/slurmd.c",
          "lines": "1220-1247",
          "snippet": "static void\n_init_conf(void)\n{\n\tchar  host[MAXHOSTNAMELEN];\n\tlog_options_t lopts = LOG_OPTS_INITIALIZER;\n\n\tif (gethostname_short(host, MAXHOSTNAMELEN) < 0) {\n\t\terror(\"Unable to get my hostname: %m\");\n\t\texit(1);\n\t}\n\tconf->hostname    = xstrdup(host);\n\tconf->daemonize   =  1;\n\tconf->lfd         = -1;\n\tconf->log_opts    = lopts;\n\tconf->debug_level = LOG_LEVEL_INFO;\n\tconf->pidfile     = xstrdup(DEFAULT_SLURMD_PIDFILE);\n\tconf->spooldir\t  = xstrdup(DEFAULT_SPOOLDIR);\n\n\tslurm_mutex_init(&conf->config_mutex);\n\n\tconf->starting_steps = list_create(destroy_starting_step);\n\tslurm_mutex_init(&conf->starting_steps_lock);\n\tpthread_cond_init(&conf->starting_steps_cond, NULL);\n\tconf->prolog_running_jobs = list_create(slurm_destroy_uint32_ptr);\n\tslurm_mutex_init(&conf->prolog_running_lock);\n\tpthread_cond_init(&conf->prolog_running_cond, NULL);\n\treturn;\n}",
          "includes": [
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/slurmd/slurmd_plugstack.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/slurmd/req.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_topology.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_route.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_mcs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/proc_args.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/parse_time.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/pack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/node_conf.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/daemonize.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/bitstring.h\"",
            "#include <unistd.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#include <sys/param.h>",
            "#include <sys/mman.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <dlfcn.h>",
            "#include <dirent.h>",
            "#  include <hwloc.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "slurmd_conf_t * conf = NULL;",
            "static void      _init_conf(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _init_conf(void);\n\nstatic void\n_init_conf(void)\n{\n\tchar  host[MAXHOSTNAMELEN];\n\tlog_options_t lopts = LOG_OPTS_INITIALIZER;\n\n\tif (gethostname_short(host, MAXHOSTNAMELEN) < 0) {\n\t\terror(\"Unable to get my hostname: %m\");\n\t\texit(1);\n\t}\n\tconf->hostname    = xstrdup(host);\n\tconf->daemonize   =  1;\n\tconf->lfd         = -1;\n\tconf->log_opts    = lopts;\n\tconf->debug_level = LOG_LEVEL_INFO;\n\tconf->pidfile     = xstrdup(DEFAULT_SLURMD_PIDFILE);\n\tconf->spooldir\t  = xstrdup(DEFAULT_SPOOLDIR);\n\n\tslurm_mutex_init(&conf->config_mutex);\n\n\tconf->starting_steps = list_create(destroy_starting_step);\n\tslurm_mutex_init(&conf->starting_steps_lock);\n\tpthread_cond_init(&conf->starting_steps_cond, NULL);\n\tconf->prolog_running_jobs = list_create(slurm_destroy_uint32_ptr);\n\tslurm_mutex_init(&conf->prolog_running_lock);\n\tpthread_cond_init(&conf->prolog_running_cond, NULL);\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "sizeof(slurmd_conf_t)"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"Not running as root. Can't drop supplementary groups\""
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "pdebug_stop_current",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/pdebug.c",
          "lines": "120-139",
          "snippet": "void\npdebug_stop_current(stepd_step_rec_t *job)\n{\n\t/*\n\t * Stop the task on exec for TotalView to connect\n\t */\n\tif ( (job->task_flags & TASK_PARALLEL_DEBUG)\n#ifdef BSD\n\t     && (_PTRACE(PT_TRACE_ME, 0, (caddr_t)0, 0) < 0) )\n#elif defined(PT_TRACE_ME)\n\t     && (_PTRACE(PT_TRACE_ME, 0, NULL, 0) < 0) )\n#elif defined(__sun)\n\t     && (_PTRACE(0, 0, NULL, 0) < 0))\n#elif defined(__CYGWIN__)\n\t     && 0)\n#else\n\t     && (_PTRACE(PTRACE_TRACEME, 0, NULL, 0) < 0) )\n#endif\n\t\terror(\"ptrace: %m\");\n}",
          "includes": [
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"pdebug.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"pdebug.h\"\n\nvoid\npdebug_stop_current(stepd_step_rec_t *job)\n{\n\t/*\n\t * Stop the task on exec for TotalView to connect\n\t */\n\tif ( (job->task_flags & TASK_PARALLEL_DEBUG)\n#ifdef BSD\n\t     && (_PTRACE(PT_TRACE_ME, 0, (caddr_t)0, 0) < 0) )\n#elif defined(PT_TRACE_ME)\n\t     && (_PTRACE(PT_TRACE_ME, 0, NULL, 0) < 0) )\n#elif defined(__sun)\n\t     && (_PTRACE(0, 0, NULL, 0) < 0))\n#elif defined(__CYGWIN__)\n\t     && 0)\n#else\n\t     && (_PTRACE(PTRACE_TRACEME, 0, NULL, 0) < 0) )\n#endif\n\t\terror(\"ptrace: %m\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"Failed to drop supplementary groups, \"\n\t\t\t      \"setgroups: %m\""
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setgroups",
          "args": [
            "0",
            "NULL"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysconf",
          "args": [
            "_SC_OPEN_MAX"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_init",
          "args": [
            "argv[0]",
            "lopts",
            "LOG_DAEMON",
            "NULL"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/slurmd/slurmd_plugstack.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/slurmd/req.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_topology.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_route.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_mcs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/proc_args.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/parse_time.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/pack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/node_conf.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/daemonize.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/bitstring.h\"\n#include <unistd.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#include <sys/param.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <dlfcn.h>\n#include <dirent.h>\n#  include <hwloc.h>\n#  include \"config.h\"\n\nslurmd_conf_t * conf = NULL;\nstatic void      _create_msg_socket(void);\nstatic void      _destroy_conf(void);\nstatic void      _hup_handler(int);\nstatic void      _init_conf(void);\nstatic void      _install_fork_handlers(void);\nstatic void      _kill_old_slurmd(void);\nstatic void      _msg_engine(void);\nstatic int       _slurmd_init(void);\nstatic int       _slurmd_fini(void);\nstatic void      _spawn_registration_engine(void);\nstatic void      _term_handler(int);\nstatic void      _wait_health_check(void);\n\nint\nmain (int argc, char *argv[])\n{\n\tint i, pidfd;\n\tint blocked_signals[] = {SIGPIPE, 0};\n\tint cc;\n\tchar *oom_value;\n\tuint32_t slurmd_uid = 0;\n\tuint32_t curr_uid = 0;\n\tchar time_stamp[256];\n\tlog_options_t lopts = LOG_OPTS_INITIALIZER;\n\n\t/* NOTE: logfile is NULL at this point */\n\tlog_init(argv[0], lopts, LOG_DAEMON, NULL);\n\n\t/*\n\t * Make sure we have no extra open files which\n\t * would be propagated to spawned tasks.\n\t */\n\tcc = sysconf(_SC_OPEN_MAX);\n\tfor (i = 3; i < cc; i++)\n\t\tclose(i);\n\n\t/*\n\t * Drop supplementary groups.\n\t */\n\tif (geteuid() == 0) {\n\t\tif (setgroups(0, NULL) != 0) {\n\t\t\tfatal(\"Failed to drop supplementary groups, \"\n\t\t\t      \"setgroups: %m\");\n\t\t}\n\t} else {\n\t\tdebug(\"Not running as root. Can't drop supplementary groups\");\n\t}\n\n\t/*\n\t * Create and set default values for the slurmd global\n\t * config variable \"conf\"\n\t */\n\tconf = xmalloc(sizeof(slurmd_conf_t));\n\t_init_conf();\n\tconf->argv = &argv;\n\tconf->argc = &argc;\n\n\tif (_slurmd_init() < 0) {\n\t\terror( \"slurmd initialization failed\" );\n\t\tfflush( NULL );\n\t\texit(1);\n\t}\n\n\tslurmd_uid = slurm_get_slurmd_user_id();\n\tcurr_uid = getuid();\n\tif (curr_uid != slurmd_uid) {\n\t\tstruct passwd *pw = NULL;\n\t\tchar *slurmd_user = NULL;\n\t\tchar *curr_user = NULL;\n\n\t\t/* since when you do a getpwuid you get a pointer to a\n\t\t * structure you have to do a xstrdup on the first\n\t\t * call or your information will just get over\n\t\t * written.  This is a memory leak, but a fatal is\n\t\t * called right after so it isn't that big of a deal.\n\t\t */\n\t\tif ((pw = getpwuid(slurmd_uid)))\n\t\t\tslurmd_user = xstrdup(pw->pw_name);\n\t\tif ((pw = getpwuid(curr_uid)))\n\t\t\tcurr_user = pw->pw_name;\n\n\t\tfatal(\"You are running slurmd as something \"\n\t\t      \"other than user %s(%d).  If you want to \"\n\t\t      \"run as this user add SlurmdUser=%s \"\n\t\t      \"to the slurm.conf file.\",\n\t\t      slurmd_user, slurmd_uid, curr_user);\n\t}\n\tinit_setproctitle(argc, argv);\n\n\txsignal(SIGTERM, &_term_handler);\n\txsignal(SIGINT,  &_term_handler);\n\txsignal(SIGHUP,  &_hup_handler );\n\txsignal_block(blocked_signals);\n\n\tdebug3(\"slurmd initialization successful\");\n\n\t/*\n\t * Become a daemon if desired.\n\t * Do not chdir(\"/\") or close all fd's\n\t */\n\tif (conf->daemonize) {\n\t\tif (daemon(1,1) == -1)\n\t\t\terror(\"Couldn't daemonize slurmd: %m\");\n\t}\n\ttest_core_limit();\n\tinfo(\"slurmd version %s started\", SLURM_VERSION_STRING);\n\tdebug3(\"finished daemonize\");\n\n\tif ((oom_value = getenv(\"SLURMD_OOM_ADJ\"))) {\n\t\ti = atoi(oom_value);\n\t\tdebug(\"Setting slurmd oom_adj to %d\", i);\n\t\tset_oom_adj(i);\n\t}\n\n\t_kill_old_slurmd();\n\n\tif (conf->mlock_pages) {\n\t\t/*\n\t\t * Call mlockall() if available to ensure slurmd\n\t\t *  doesn't get swapped out\n\t\t */\n#ifdef _POSIX_MEMLOCK\n\t\tif (mlockall (MCL_FUTURE | MCL_CURRENT) < 0)\n\t\t\terror (\"failed to mlock() slurmd pages: %m\");\n#else\n\t\terror (\"mlockall() system call does not appear to be available\");\n#endif /* _POSIX_MEMLOCK */\n\t}\n\n\n\t/*\n\t * Restore any saved revoked credential information\n\t */\n\tif (!conf->cleanstart && (_restore_cred_state(conf->vctx) < 0))\n\t\treturn SLURM_FAILURE;\n\n\tif (jobacct_gather_init() != SLURM_SUCCESS)\n\t\tfatal(\"Unable to initialize jobacct_gather\");\n\tif (job_container_init() < 0)\n\t\tfatal(\"Unable to initialize job_container plugin.\");\n\tif (container_g_restore(conf->spooldir, !conf->cleanstart))\n\t\terror(\"Unable to restore job_container state.\");\n\tif (core_spec_g_init() < 0)\n\t\tfatal(\"Unable to initialize core specialization plugin.\");\n\tif (switch_g_node_init() < 0)\n\t\tfatal(\"Unable to initialize interconnect.\");\n\tif (node_features_g_init() != SLURM_SUCCESS )\n\t\tfatal( \"failed to initialize node_features plugin\");\t\n\tif (conf->cleanstart && switch_g_clear_node_state())\n\t\tfatal(\"Unable to clear interconnect state.\");\n\tswitch_g_slurmd_init();\n\tfile_bcast_init();\n\n\t_create_msg_socket();\n\n\tconf->pid = getpid();\n\t/* This has to happen after daemon(), which closes all fd's,\n\t * so we keep the write lock of the pidfile. */\n\tpidfd = create_pidfile(conf->pidfile, 0);\n\n\trfc2822_timestamp(time_stamp, sizeof(time_stamp));\n\tinfo(\"%s started on %s\", slurm_prog_name, time_stamp);\n\n\t_install_fork_handlers();\n\tlist_install_fork_handlers();\n\tslurm_conf_install_fork_handlers();\n\trecord_launched_jobs();\n\n\t/*\n\t * Initialize any plugins\n\t */\n\tif (slurmd_plugstack_init())\n\t\tfatal(\"failed to initialize slurmd_plugstack\");\n\n\t/* Wait for a successfull health check if HealthCheckInterval != 0 */\n\t_wait_health_check();\n\n\t_spawn_registration_engine();\n\tmsg_aggr_sender_init(conf->hostname, conf->port,\n\t\t\t     conf->msg_aggr_window_time,\n\t\t\t     conf->msg_aggr_window_msgs);\n\t_msg_engine();\n\n\t/*\n\t * Close fd here, otherwise we'll deadlock since create_pidfile()\n\t * flocks the pidfile.\n\t */\n\tif (pidfd >= 0)\t\t\t/* valid pidfd, non-error */\n\t\t(void) close(pidfd);\t/* Ignore errors */\n\tif (unlink(conf->pidfile) < 0)\n\t\terror(\"Unable to remove pidfile `%s': %m\", conf->pidfile);\n\n\t_wait_for_all_threads(120);\n\t_slurmd_fini();\n\t_destroy_conf();\n\tslurm_crypto_fini();\t/* must be after _destroy_conf() */\n\tgids_cache_purge();\n\tfile_bcast_purge();\n\n\tinfo(\"Slurmd shutdown completing\");\n\tlog_fini();\n       \treturn 0;\n}"
  }
]