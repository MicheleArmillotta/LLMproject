[
  {
    "function_name": "_file_read_content",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "1149-1197",
    "snippet": "int _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "size_t _file_getsize(int fd);",
      "int _file_read_content(char* file_path, char** content, size_t *csize);",
      "int _file_write_content(char* file_path, char* content, size_t csize);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 1194
        },
        "resolved": true,
        "details": {
          "function_name": "io_close_local_fds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "1463-1487",
          "snippet": "void\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static bool _task_writable(eio_obj_t *);",
            "static bool _task_readable(eio_obj_t *);",
            "static int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);",
            "static void *_io_thr(void *arg);",
            "static void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);",
            "static bool _incoming_buf_free(stepd_step_rec_t *job);",
            "static bool _outgoing_buf_free(stepd_step_rec_t *job);",
            "static int  _send_connection_okay_response(stepd_step_rec_t *job);",
            "static struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic bool _task_writable(eio_obj_t *);\nstatic bool _task_readable(eio_obj_t *);\nstatic int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);\nstatic void *_io_thr(void *arg);\nstatic void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);\nstatic bool _incoming_buf_free(stepd_step_rec_t *job);\nstatic bool _outgoing_buf_free(stepd_step_rec_t *job);\nstatic int  _send_connection_okay_response(stepd_step_rec_t *job);\nstatic struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);\n\nvoid\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}"
        }
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "fd",
            "buf",
            "fsize"
          ],
          "line": 1183
        },
        "resolved": true,
        "details": {
          "function_name": "_file_read_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1149-1197",
          "snippet": "int _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "(fsize+1)*sizeof(char)"
          ],
          "line": 1180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_file_getsize",
          "args": [
            "fd"
          ],
          "line": 1173
        },
        "resolved": true,
        "details": {
          "function_name": "_file_getsize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "843-871",
          "snippet": "size_t _file_getsize(int fd)\n{\n\tint rc;\n\tsize_t fsize;\n\toff_t offset;\n\tchar c;\n\n\t/* store current position and rewind */\n\toffset = lseek(fd, 0, SEEK_CUR);\n\tif (offset < 0)\n\t\treturn -1;\n\tlseek(fd, 0, SEEK_SET);\n\n\t/* get file size */\n\tfsize=0;\n\tdo {\n\t\trc = read(fd, (void*)&c, 1);\n\t\tif (rc > 0)\n\t\t\tfsize++;\n\t} while ((rc < 0 && errno == EINTR) || rc > 0);\n\n\t/* restore position */\n\tlseek(fd, offset, SEEK_SET);\n\n\tif (rc < 0)\n\t\treturn -1;\n\telse\n\t\treturn fsize;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\n\nsize_t _file_getsize(int fd)\n{\n\tint rc;\n\tsize_t fsize;\n\toff_t offset;\n\tchar c;\n\n\t/* store current position and rewind */\n\toffset = lseek(fd, 0, SEEK_CUR);\n\tif (offset < 0)\n\t\treturn -1;\n\tlseek(fd, 0, SEEK_SET);\n\n\t/* get file size */\n\tfsize=0;\n\tdo {\n\t\trc = read(fd, (void*)&c, 1);\n\t\tif (rc > 0)\n\t\t\tfsize++;\n\t} while ((rc < 0 && errno == EINTR) || rc > 0);\n\n\t/* restore position */\n\tlseek(fd, offset, SEEK_SET);\n\n\tif (rc < 0)\n\t\treturn -1;\n\telse\n\t\treturn fsize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to open '%s' for reading : %m\"",
            "__func__",
            "file_path"
          ],
          "line": 1167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "file_path",
            "O_RDONLY",
            "0700"
          ],
          "line": 1165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
  },
  {
    "function_name": "_file_write_content",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "1116-1147",
    "snippet": "int _file_write_content(char* file_path, char* content, size_t csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* write content */\n\tdo {\n\t\trc = write(fd, content, csize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* check read size */\n\tif (rc < csize) {\n\t\tdebug2(\"%s: unable to write %lu bytes to file '%s' : %m\",\n\t\t\t__func__, (long unsigned int) csize, file_path);\n\t\tfstatus = XCGROUP_ERROR;\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "size_t _file_getsize(int fd);",
      "int _file_read_content(char* file_path, char** content, size_t *csize);",
      "int _file_write_content(char* file_path, char* content, size_t csize);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 1144
        },
        "resolved": true,
        "details": {
          "function_name": "io_close_local_fds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "1463-1487",
          "snippet": "void\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static bool _task_writable(eio_obj_t *);",
            "static bool _task_readable(eio_obj_t *);",
            "static int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);",
            "static void *_io_thr(void *arg);",
            "static void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);",
            "static bool _incoming_buf_free(stepd_step_rec_t *job);",
            "static bool _outgoing_buf_free(stepd_step_rec_t *job);",
            "static int  _send_connection_okay_response(stepd_step_rec_t *job);",
            "static struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic bool _task_writable(eio_obj_t *);\nstatic bool _task_readable(eio_obj_t *);\nstatic int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);\nstatic void *_io_thr(void *arg);\nstatic void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);\nstatic bool _incoming_buf_free(stepd_step_rec_t *job);\nstatic bool _outgoing_buf_free(stepd_step_rec_t *job);\nstatic int  _send_connection_okay_response(stepd_step_rec_t *job);\nstatic struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);\n\nvoid\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to write %lu bytes to file '%s' : %m\"",
            "__func__",
            "(long unsigned int) csize",
            "file_path"
          ],
          "line": 1137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "write",
          "args": [
            "fd",
            "content",
            "csize"
          ],
          "line": 1132
        },
        "resolved": true,
        "details": {
          "function_name": "_file_write_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1116-1147",
          "snippet": "int _file_write_content(char* file_path, char* content, size_t csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* write content */\n\tdo {\n\t\trc = write(fd, content, csize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* check read size */\n\tif (rc < csize) {\n\t\tdebug2(\"%s: unable to write %lu bytes to file '%s' : %m\",\n\t\t\t__func__, (long unsigned int) csize, file_path);\n\t\tfstatus = XCGROUP_ERROR;\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to open '%s' for writing : %m\"",
            "__func__",
            "file_path"
          ],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "file_path",
            "O_WRONLY",
            "0700"
          ],
          "line": 1123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_write_content(char* file_path, char* content, size_t csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* write content */\n\tdo {\n\t\trc = write(fd, content, csize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* check read size */\n\tif (rc < csize) {\n\t\tdebug2(\"%s: unable to write %lu bytes to file '%s' : %m\",\n\t\t\t__func__, (long unsigned int) csize, file_path);\n\t\tfstatus = XCGROUP_ERROR;\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
  },
  {
    "function_name": "_file_read_uint32s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "1045-1114",
    "snippet": "int _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb)\n{\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\tchar* p;\n\n\tuint32_t* pa=NULL;\n\tint i;\n\n\t/* check input pointers */\n\tif (pvalues == NULL || pnb == NULL)\n\t\treturn XCGROUP_ERROR;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\tclose(fd);\n\tbuf[fsize]='\\0';\n\n\t/* count values (splitted by \\n) */\n\ti=0;\n\tif (rc > 0) {\n\t\tp = buf;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\ti++;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* build uint32_t list */\n\tif (i > 0) {\n\t\tpa = (uint32_t*) xmalloc(sizeof(uint32_t) * i);\n\t\tp = buf;\n\t\ti = 0;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\tsscanf(p, \"%u\", pa+i);\n\t\t\tp = index(p, '\\n') + 1;\n\t\t\ti++;\n\t\t}\n\t}\n\n\t/* free buffer */\n\txfree(buf);\n\n\t/* set output values */\n\t*pvalues = pa;\n\t*pnb = i;\n\n\treturn XCGROUP_SUCCESS;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "size_t _file_getsize(int fd);",
      "int _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb);",
      "int _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "buf"
          ],
          "line": 1107
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "p",
            "'\\n'"
          ],
          "line": 1101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "p",
            "\"%u\"",
            "pa+i"
          ],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "p",
            "'\\n'"
          ],
          "line": 1099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "sizeof(uint32_t) * i"
          ],
          "line": 1096
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "p",
            "'\\n'"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "p",
            "'\\n'"
          ],
          "line": 1088
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 1081
        },
        "resolved": true,
        "details": {
          "function_name": "io_close_local_fds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "1463-1487",
          "snippet": "void\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static bool _task_writable(eio_obj_t *);",
            "static bool _task_readable(eio_obj_t *);",
            "static int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);",
            "static void *_io_thr(void *arg);",
            "static void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);",
            "static bool _incoming_buf_free(stepd_step_rec_t *job);",
            "static bool _outgoing_buf_free(stepd_step_rec_t *job);",
            "static int  _send_connection_okay_response(stepd_step_rec_t *job);",
            "static struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic bool _task_writable(eio_obj_t *);\nstatic bool _task_readable(eio_obj_t *);\nstatic int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);\nstatic void *_io_thr(void *arg);\nstatic void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);\nstatic bool _incoming_buf_free(stepd_step_rec_t *job);\nstatic bool _outgoing_buf_free(stepd_step_rec_t *job);\nstatic int  _send_connection_okay_response(stepd_step_rec_t *job);\nstatic struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);\n\nvoid\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}"
        }
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "fd",
            "buf",
            "fsize"
          ],
          "line": 1079
        },
        "resolved": true,
        "details": {
          "function_name": "_file_read_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1149-1197",
          "snippet": "int _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "(fsize+1)*sizeof(char)"
          ],
          "line": 1077
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_file_getsize",
          "args": [
            "fd"
          ],
          "line": 1070
        },
        "resolved": true,
        "details": {
          "function_name": "_file_getsize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "843-871",
          "snippet": "size_t _file_getsize(int fd)\n{\n\tint rc;\n\tsize_t fsize;\n\toff_t offset;\n\tchar c;\n\n\t/* store current position and rewind */\n\toffset = lseek(fd, 0, SEEK_CUR);\n\tif (offset < 0)\n\t\treturn -1;\n\tlseek(fd, 0, SEEK_SET);\n\n\t/* get file size */\n\tfsize=0;\n\tdo {\n\t\trc = read(fd, (void*)&c, 1);\n\t\tif (rc > 0)\n\t\t\tfsize++;\n\t} while ((rc < 0 && errno == EINTR) || rc > 0);\n\n\t/* restore position */\n\tlseek(fd, offset, SEEK_SET);\n\n\tif (rc < 0)\n\t\treturn -1;\n\telse\n\t\treturn fsize;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\n\nsize_t _file_getsize(int fd)\n{\n\tint rc;\n\tsize_t fsize;\n\toff_t offset;\n\tchar c;\n\n\t/* store current position and rewind */\n\toffset = lseek(fd, 0, SEEK_CUR);\n\tif (offset < 0)\n\t\treturn -1;\n\tlseek(fd, 0, SEEK_SET);\n\n\t/* get file size */\n\tfsize=0;\n\tdo {\n\t\trc = read(fd, (void*)&c, 1);\n\t\tif (rc > 0)\n\t\t\tfsize++;\n\t} while ((rc < 0 && errno == EINTR) || rc > 0);\n\n\t/* restore position */\n\tlseek(fd, offset, SEEK_SET);\n\n\tif (rc < 0)\n\t\treturn -1;\n\telse\n\t\treturn fsize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to open '%s' for reading : %m\"",
            "__func__",
            "file_path"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "file_path",
            "O_RDONLY",
            "0700"
          ],
          "line": 1062
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb);\nint _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb);\n\nint _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb)\n{\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\tchar* p;\n\n\tuint32_t* pa=NULL;\n\tint i;\n\n\t/* check input pointers */\n\tif (pvalues == NULL || pnb == NULL)\n\t\treturn XCGROUP_ERROR;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\tclose(fd);\n\tbuf[fsize]='\\0';\n\n\t/* count values (splitted by \\n) */\n\ti=0;\n\tif (rc > 0) {\n\t\tp = buf;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\ti++;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* build uint32_t list */\n\tif (i > 0) {\n\t\tpa = (uint32_t*) xmalloc(sizeof(uint32_t) * i);\n\t\tp = buf;\n\t\ti = 0;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\tsscanf(p, \"%u\", pa+i);\n\t\t\tp = index(p, '\\n') + 1;\n\t\t\ti++;\n\t\t}\n\t}\n\n\t/* free buffer */\n\txfree(buf);\n\n\t/* set output values */\n\t*pvalues = pa;\n\t*pnb = i;\n\n\treturn XCGROUP_SUCCESS;\n}"
  },
  {
    "function_name": "_file_write_uint32s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "995-1043",
    "snippet": "int _file_write_uint32s(char* file_path, uint32_t* values, int nb)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\tchar tstr[256];\n\tuint32_t value;\n\tint i;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* add one value per line */\n\tfstatus = XCGROUP_SUCCESS;\n\tfor (i=0 ; i < nb ; i++) {\n\n\t\tvalue = values[i];\n\n\t\trc = snprintf(tstr, sizeof(tstr), \"%u\", value);\n\t\tif (rc < 0) {\n\t\t\tdebug2(\"unable to build %u string value, skipping\",\n\t\t\t       value);\n\t\t\tfstatus = XCGROUP_ERROR;\n\t\t\tcontinue;\n\t\t}\n\n\t\tdo {\n\t\t\trc = write(fd, tstr, strlen(tstr)+1);\n\t\t}\n\t\twhile (rc < 0 && errno == EINTR);\n\t\tif (rc < 1) {\n\t\t\tdebug2(\"%s: unable to add value '%s' to file '%s' : %m\",\n\t\t\t\t__func__, tstr, file_path);\n\t\t\tif (errno != ESRCH)\n\t\t\t\tfstatus = XCGROUP_ERROR;\n\t\t}\n\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "size_t _file_getsize(int fd);",
      "int _file_write_uint32s(char* file_path, uint32_t* values, int nb);",
      "int _file_write_uint64s(char* file_path, uint64_t* values, int nb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 1040
        },
        "resolved": true,
        "details": {
          "function_name": "io_close_local_fds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "1463-1487",
          "snippet": "void\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static bool _task_writable(eio_obj_t *);",
            "static bool _task_readable(eio_obj_t *);",
            "static int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);",
            "static void *_io_thr(void *arg);",
            "static void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);",
            "static bool _incoming_buf_free(stepd_step_rec_t *job);",
            "static bool _outgoing_buf_free(stepd_step_rec_t *job);",
            "static int  _send_connection_okay_response(stepd_step_rec_t *job);",
            "static struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic bool _task_writable(eio_obj_t *);\nstatic bool _task_readable(eio_obj_t *);\nstatic int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);\nstatic void *_io_thr(void *arg);\nstatic void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);\nstatic bool _incoming_buf_free(stepd_step_rec_t *job);\nstatic bool _outgoing_buf_free(stepd_step_rec_t *job);\nstatic int  _send_connection_okay_response(stepd_step_rec_t *job);\nstatic struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);\n\nvoid\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to add value '%s' to file '%s' : %m\"",
            "__func__",
            "tstr",
            "file_path"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "write",
          "args": [
            "fd",
            "tstr",
            "strlen(tstr)+1"
          ],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "_file_write_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1116-1147",
          "snippet": "int _file_write_content(char* file_path, char* content, size_t csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* write content */\n\tdo {\n\t\trc = write(fd, content, csize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* check read size */\n\tif (rc < csize) {\n\t\tdebug2(\"%s: unable to write %lu bytes to file '%s' : %m\",\n\t\t\t__func__, (long unsigned int) csize, file_path);\n\t\tfstatus = XCGROUP_ERROR;\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_write_content(char* file_path, char* content, size_t csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* write content */\n\tdo {\n\t\trc = write(fd, content, csize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* check read size */\n\tif (rc < csize) {\n\t\tdebug2(\"%s: unable to write %lu bytes to file '%s' : %m\",\n\t\t\t__func__, (long unsigned int) csize, file_path);\n\t\tfstatus = XCGROUP_ERROR;\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "tstr"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"unable to build %u string value, skipping\"",
            "value"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "tstr",
            "sizeof(tstr)",
            "\"%u\"",
            "value"
          ],
          "line": 1018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to open '%s' for writing : %m\"",
            "__func__",
            "file_path"
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "file_path",
            "O_WRONLY",
            "0700"
          ],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_write_uint32s(char* file_path, uint32_t* values, int nb);\nint _file_write_uint64s(char* file_path, uint64_t* values, int nb);\n\nint _file_write_uint32s(char* file_path, uint32_t* values, int nb)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\tchar tstr[256];\n\tuint32_t value;\n\tint i;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* add one value per line */\n\tfstatus = XCGROUP_SUCCESS;\n\tfor (i=0 ; i < nb ; i++) {\n\n\t\tvalue = values[i];\n\n\t\trc = snprintf(tstr, sizeof(tstr), \"%u\", value);\n\t\tif (rc < 0) {\n\t\t\tdebug2(\"unable to build %u string value, skipping\",\n\t\t\t       value);\n\t\t\tfstatus = XCGROUP_ERROR;\n\t\t\tcontinue;\n\t\t}\n\n\t\tdo {\n\t\t\trc = write(fd, tstr, strlen(tstr)+1);\n\t\t}\n\t\twhile (rc < 0 && errno == EINTR);\n\t\tif (rc < 1) {\n\t\t\tdebug2(\"%s: unable to add value '%s' to file '%s' : %m\",\n\t\t\t\t__func__, tstr, file_path);\n\t\t\tif (errno != ESRCH)\n\t\t\t\tfstatus = XCGROUP_ERROR;\n\t\t}\n\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
  },
  {
    "function_name": "_file_read_uint64s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "923-993",
    "snippet": "int _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb)\n{\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\tchar* p;\n\n\tuint64_t* pa=NULL;\n\tint i;\n\n\t/* check input pointers */\n\tif (pvalues == NULL || pnb == NULL)\n\t\treturn XCGROUP_ERROR;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\tclose(fd);\n\tbuf[fsize]='\\0';\n\n\t/* count values (splitted by \\n) */\n\ti=0;\n\tif (rc > 0) {\n\t\tp = buf;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\ti++;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* build uint64_t list */\n\tif (i > 0) {\n\t\tpa = (uint64_t*) xmalloc(sizeof(uint64_t) * i);\n\t\tp = buf;\n\t\ti = 0;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\tlong long unsigned int ll_tmp;\n\t\t\tsscanf(p, \"%llu\", &ll_tmp);\n\t\t\tpa[i++] = ll_tmp;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* free buffer */\n\txfree(buf);\n\n\t/* set output values */\n\t*pvalues = pa;\n\t*pnb = i;\n\n\treturn XCGROUP_SUCCESS;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "size_t _file_getsize(int fd);",
      "int _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb);",
      "int _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "buf"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "p",
            "'\\n'"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "p",
            "\"%llu\"",
            "&ll_tmp"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "p",
            "'\\n'"
          ],
          "line": 977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "sizeof(uint64_t) * i"
          ],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "p",
            "'\\n'"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "p",
            "'\\n'"
          ],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 959
        },
        "resolved": true,
        "details": {
          "function_name": "io_close_local_fds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "1463-1487",
          "snippet": "void\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static bool _task_writable(eio_obj_t *);",
            "static bool _task_readable(eio_obj_t *);",
            "static int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);",
            "static void *_io_thr(void *arg);",
            "static void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);",
            "static bool _incoming_buf_free(stepd_step_rec_t *job);",
            "static bool _outgoing_buf_free(stepd_step_rec_t *job);",
            "static int  _send_connection_okay_response(stepd_step_rec_t *job);",
            "static struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic bool _task_writable(eio_obj_t *);\nstatic bool _task_readable(eio_obj_t *);\nstatic int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);\nstatic void *_io_thr(void *arg);\nstatic void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);\nstatic bool _incoming_buf_free(stepd_step_rec_t *job);\nstatic bool _outgoing_buf_free(stepd_step_rec_t *job);\nstatic int  _send_connection_okay_response(stepd_step_rec_t *job);\nstatic struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);\n\nvoid\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}"
        }
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "fd",
            "buf",
            "fsize"
          ],
          "line": 957
        },
        "resolved": true,
        "details": {
          "function_name": "_file_read_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1149-1197",
          "snippet": "int _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "(fsize+1)*sizeof(char)"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_file_getsize",
          "args": [
            "fd"
          ],
          "line": 948
        },
        "resolved": true,
        "details": {
          "function_name": "_file_getsize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "843-871",
          "snippet": "size_t _file_getsize(int fd)\n{\n\tint rc;\n\tsize_t fsize;\n\toff_t offset;\n\tchar c;\n\n\t/* store current position and rewind */\n\toffset = lseek(fd, 0, SEEK_CUR);\n\tif (offset < 0)\n\t\treturn -1;\n\tlseek(fd, 0, SEEK_SET);\n\n\t/* get file size */\n\tfsize=0;\n\tdo {\n\t\trc = read(fd, (void*)&c, 1);\n\t\tif (rc > 0)\n\t\t\tfsize++;\n\t} while ((rc < 0 && errno == EINTR) || rc > 0);\n\n\t/* restore position */\n\tlseek(fd, offset, SEEK_SET);\n\n\tif (rc < 0)\n\t\treturn -1;\n\telse\n\t\treturn fsize;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\n\nsize_t _file_getsize(int fd)\n{\n\tint rc;\n\tsize_t fsize;\n\toff_t offset;\n\tchar c;\n\n\t/* store current position and rewind */\n\toffset = lseek(fd, 0, SEEK_CUR);\n\tif (offset < 0)\n\t\treturn -1;\n\tlseek(fd, 0, SEEK_SET);\n\n\t/* get file size */\n\tfsize=0;\n\tdo {\n\t\trc = read(fd, (void*)&c, 1);\n\t\tif (rc > 0)\n\t\t\tfsize++;\n\t} while ((rc < 0 && errno == EINTR) || rc > 0);\n\n\t/* restore position */\n\tlseek(fd, offset, SEEK_SET);\n\n\tif (rc < 0)\n\t\treturn -1;\n\telse\n\t\treturn fsize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to open '%s' for reading : %m\"",
            "__func__",
            "file_path"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "file_path",
            "O_RDONLY",
            "0700"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb);\nint _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb);\n\nint _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb)\n{\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\tchar* p;\n\n\tuint64_t* pa=NULL;\n\tint i;\n\n\t/* check input pointers */\n\tif (pvalues == NULL || pnb == NULL)\n\t\treturn XCGROUP_ERROR;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\tclose(fd);\n\tbuf[fsize]='\\0';\n\n\t/* count values (splitted by \\n) */\n\ti=0;\n\tif (rc > 0) {\n\t\tp = buf;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\ti++;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* build uint64_t list */\n\tif (i > 0) {\n\t\tpa = (uint64_t*) xmalloc(sizeof(uint64_t) * i);\n\t\tp = buf;\n\t\ti = 0;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\tlong long unsigned int ll_tmp;\n\t\t\tsscanf(p, \"%llu\", &ll_tmp);\n\t\t\tpa[i++] = ll_tmp;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* free buffer */\n\txfree(buf);\n\n\t/* set output values */\n\t*pvalues = pa;\n\t*pnb = i;\n\n\treturn XCGROUP_SUCCESS;\n}"
  },
  {
    "function_name": "_file_write_uint64s",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "873-921",
    "snippet": "int _file_write_uint64s(char* file_path, uint64_t* values, int nb)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\tchar tstr[256];\n\tuint64_t value;\n\tint i;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* add one value per line */\n\tfstatus = XCGROUP_SUCCESS;\n\tfor (i=0 ; i < nb ; i++) {\n\n\t\tvalue = values[i];\n\n\t\trc = snprintf(tstr, sizeof(tstr), \"%\"PRIu64\"\", value);\n\t\tif (rc < 0) {\n\t\t\tdebug2(\"unable to build %\"PRIu64\" string value, \"\n\t\t\t       \"skipping\", value);\n\t\t\tfstatus = XCGROUP_ERROR;\n\t\t\tcontinue;\n\t\t}\n\n\t\tdo {\n\t\t\trc = write(fd, tstr, strlen(tstr)+1);\n\t\t}\n\t\twhile (rc < 0 && errno == EINTR);\n\t\tif (rc < 1) {\n\t\t\tdebug2(\"%s: unable to add value '%s' to file '%s' : %m\",\n\t\t\t\t__func__, tstr, file_path);\n\t\t\tif (errno != ESRCH)\n\t\t\t\tfstatus = XCGROUP_ERROR;\n\t\t}\n\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "size_t _file_getsize(int fd);",
      "int _file_write_uint32s(char* file_path, uint32_t* values, int nb);",
      "int _file_write_uint64s(char* file_path, uint64_t* values, int nb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "io_close_local_fds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "1463-1487",
          "snippet": "void\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static bool _task_writable(eio_obj_t *);",
            "static bool _task_readable(eio_obj_t *);",
            "static int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);",
            "static void *_io_thr(void *arg);",
            "static void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);",
            "static bool _incoming_buf_free(stepd_step_rec_t *job);",
            "static bool _outgoing_buf_free(stepd_step_rec_t *job);",
            "static int  _send_connection_okay_response(stepd_step_rec_t *job);",
            "static struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic bool _task_writable(eio_obj_t *);\nstatic bool _task_readable(eio_obj_t *);\nstatic int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);\nstatic void *_io_thr(void *arg);\nstatic void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);\nstatic bool _incoming_buf_free(stepd_step_rec_t *job);\nstatic bool _outgoing_buf_free(stepd_step_rec_t *job);\nstatic int  _send_connection_okay_response(stepd_step_rec_t *job);\nstatic struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);\n\nvoid\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to add value '%s' to file '%s' : %m\"",
            "__func__",
            "tstr",
            "file_path"
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "write",
          "args": [
            "fd",
            "tstr",
            "strlen(tstr)+1"
          ],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "_file_write_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1116-1147",
          "snippet": "int _file_write_content(char* file_path, char* content, size_t csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* write content */\n\tdo {\n\t\trc = write(fd, content, csize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* check read size */\n\tif (rc < csize) {\n\t\tdebug2(\"%s: unable to write %lu bytes to file '%s' : %m\",\n\t\t\t__func__, (long unsigned int) csize, file_path);\n\t\tfstatus = XCGROUP_ERROR;\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_write_content(char* file_path, char* content, size_t csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* write content */\n\tdo {\n\t\trc = write(fd, content, csize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* check read size */\n\tif (rc < csize) {\n\t\tdebug2(\"%s: unable to write %lu bytes to file '%s' : %m\",\n\t\t\t__func__, (long unsigned int) csize, file_path);\n\t\tfstatus = XCGROUP_ERROR;\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "tstr"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"unable to build %\"PRIu64\" string value, \"\n\t\t\t       \"skipping\"",
            "value"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "tstr",
            "sizeof(tstr)",
            "\"%\"PRIu64\"\"",
            "value"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to open '%s' for writing : %m\"",
            "__func__",
            "file_path"
          ],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "file_path",
            "O_WRONLY",
            "0700"
          ],
          "line": 883
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_write_uint32s(char* file_path, uint32_t* values, int nb);\nint _file_write_uint64s(char* file_path, uint64_t* values, int nb);\n\nint _file_write_uint64s(char* file_path, uint64_t* values, int nb)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\tchar tstr[256];\n\tuint64_t value;\n\tint i;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* add one value per line */\n\tfstatus = XCGROUP_SUCCESS;\n\tfor (i=0 ; i < nb ; i++) {\n\n\t\tvalue = values[i];\n\n\t\trc = snprintf(tstr, sizeof(tstr), \"%\"PRIu64\"\", value);\n\t\tif (rc < 0) {\n\t\t\tdebug2(\"unable to build %\"PRIu64\" string value, \"\n\t\t\t       \"skipping\", value);\n\t\t\tfstatus = XCGROUP_ERROR;\n\t\t\tcontinue;\n\t\t}\n\n\t\tdo {\n\t\t\trc = write(fd, tstr, strlen(tstr)+1);\n\t\t}\n\t\twhile (rc < 0 && errno == EINTR);\n\t\tif (rc < 1) {\n\t\t\tdebug2(\"%s: unable to add value '%s' to file '%s' : %m\",\n\t\t\t\t__func__, tstr, file_path);\n\t\t\tif (errno != ESRCH)\n\t\t\t\tfstatus = XCGROUP_ERROR;\n\t\t}\n\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
  },
  {
    "function_name": "_file_getsize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "843-871",
    "snippet": "size_t _file_getsize(int fd)\n{\n\tint rc;\n\tsize_t fsize;\n\toff_t offset;\n\tchar c;\n\n\t/* store current position and rewind */\n\toffset = lseek(fd, 0, SEEK_CUR);\n\tif (offset < 0)\n\t\treturn -1;\n\tlseek(fd, 0, SEEK_SET);\n\n\t/* get file size */\n\tfsize=0;\n\tdo {\n\t\trc = read(fd, (void*)&c, 1);\n\t\tif (rc > 0)\n\t\t\tfsize++;\n\t} while ((rc < 0 && errno == EINTR) || rc > 0);\n\n\t/* restore position */\n\tlseek(fd, offset, SEEK_SET);\n\n\tif (rc < 0)\n\t\treturn -1;\n\telse\n\t\treturn fsize;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "size_t _file_getsize(int fd);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "fd",
            "offset",
            "SEEK_SET"
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "fd",
            "(void*)&c",
            "1"
          ],
          "line": 859
        },
        "resolved": true,
        "details": {
          "function_name": "_file_read_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1149-1197",
          "snippet": "int _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "fd",
            "0",
            "SEEK_SET"
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "fd",
            "0",
            "SEEK_CUR"
          ],
          "line": 851
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\n\nsize_t _file_getsize(int fd)\n{\n\tint rc;\n\tsize_t fsize;\n\toff_t offset;\n\tchar c;\n\n\t/* store current position and rewind */\n\toffset = lseek(fd, 0, SEEK_CUR);\n\tif (offset < 0)\n\t\treturn -1;\n\tlseek(fd, 0, SEEK_SET);\n\n\t/* get file size */\n\tfsize=0;\n\tdo {\n\t\trc = read(fd, (void*)&c, 1);\n\t\tif (rc > 0)\n\t\t\tfsize++;\n\t} while ((rc < 0 && errno == EINTR) || rc > 0);\n\n\t/* restore position */\n\tlseek(fd, offset, SEEK_SET);\n\n\tif (rc < 0)\n\t\treturn -1;\n\telse\n\t\treturn fsize;\n}"
  },
  {
    "function_name": "xcgroup_move_process",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "822-832",
    "snippet": "int xcgroup_move_process (xcgroup_t *cg, pid_t pid)\n{\n\tchar *path = _cgroup_procs_writable_path(cg);\n\n\tif (!path)\n\t\treturn cgroup_move_process_by_task (cg, pid);\n\n\txfree(path);\n\n\treturn xcgroup_set_uint32_param (cg, \"cgroup.procs\", pid);\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_set_uint32_param",
          "args": [
            "cg",
            "\"cgroup.procs\"",
            "pid"
          ],
          "line": 831
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_set_uint32_param",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "694-715",
          "snippet": "int xcgroup_set_uint32_param(xcgroup_t* cg, char* param, uint32_t value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_uint32s(file_path, &value, 1);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%u' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%u' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_set_uint32_param(xcgroup_t* cg, char* param, uint32_t value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_uint32s(file_path, &value, 1);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%u' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%u' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "path"
          ],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cgroup_move_process_by_task",
          "args": [
            "cg",
            "pid"
          ],
          "line": 827
        },
        "resolved": true,
        "details": {
          "function_name": "cgroup_move_process_by_task",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "797-820",
          "snippet": "static int cgroup_move_process_by_task (xcgroup_t *cg, pid_t pid)\n{\n\tDIR *dir;\n\tstruct dirent *entry;\n\tchar path[PATH_MAX];\n\n\tif (snprintf(path, PATH_MAX, \"/proc/%d/task\", (int) pid) >= PATH_MAX) {\n\t\terror(\"xcgroup: move_process_by_task: path overflow!\");\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\tdir = opendir(path);\n\tif (!dir) {\n\t\terror(\"%s: opendir(%s): %m\", __func__, path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\twhile ((entry = readdir(dir))) {\n\t\tif (entry->d_name[0] != '.')\n\t\t\txcgroup_set_param(cg, \"tasks\", entry->d_name);\n\t}\n\tclosedir(dir);\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nstatic int cgroup_move_process_by_task (xcgroup_t *cg, pid_t pid)\n{\n\tDIR *dir;\n\tstruct dirent *entry;\n\tchar path[PATH_MAX];\n\n\tif (snprintf(path, PATH_MAX, \"/proc/%d/task\", (int) pid) >= PATH_MAX) {\n\t\terror(\"xcgroup: move_process_by_task: path overflow!\");\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\tdir = opendir(path);\n\tif (!dir) {\n\t\terror(\"%s: opendir(%s): %m\", __func__, path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\twhile ((entry = readdir(dir))) {\n\t\tif (entry->d_name[0] != '.')\n\t\t\txcgroup_set_param(cg, \"tasks\", entry->d_name);\n\t}\n\tclosedir(dir);\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_cgroup_procs_writable_path",
          "args": [
            "cg"
          ],
          "line": 824
        },
        "resolved": true,
        "details": {
          "function_name": "_cgroup_procs_writable_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "562-565",
          "snippet": "static char *_cgroup_procs_writable_path (xcgroup_t *cg)\n{\n\treturn _cgroup_procs_check(cg, S_IWUSR);\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nstatic char *_cgroup_procs_writable_path (xcgroup_t *cg)\n{\n\treturn _cgroup_procs_check(cg, S_IWUSR);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_move_process (xcgroup_t *cg, pid_t pid)\n{\n\tchar *path = _cgroup_procs_writable_path(cg);\n\n\tif (!path)\n\t\treturn cgroup_move_process_by_task (cg, pid);\n\n\txfree(path);\n\n\treturn xcgroup_set_uint32_param (cg, \"cgroup.procs\", pid);\n}"
  },
  {
    "function_name": "cgroup_move_process_by_task",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "797-820",
    "snippet": "static int cgroup_move_process_by_task (xcgroup_t *cg, pid_t pid)\n{\n\tDIR *dir;\n\tstruct dirent *entry;\n\tchar path[PATH_MAX];\n\n\tif (snprintf(path, PATH_MAX, \"/proc/%d/task\", (int) pid) >= PATH_MAX) {\n\t\terror(\"xcgroup: move_process_by_task: path overflow!\");\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\tdir = opendir(path);\n\tif (!dir) {\n\t\terror(\"%s: opendir(%s): %m\", __func__, path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\twhile ((entry = readdir(dir))) {\n\t\tif (entry->d_name[0] != '.')\n\t\t\txcgroup_set_param(cg, \"tasks\", entry->d_name);\n\t}\n\tclosedir(dir);\n\treturn XCGROUP_SUCCESS;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [
      "#define PATH_MAX 256"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "closedir",
          "args": [
            "dir"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xcgroup_set_param",
          "args": [
            "cg",
            "\"tasks\"",
            "entry->d_name"
          ],
          "line": 816
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_set_param",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "653-674",
          "snippet": "int xcgroup_set_param(xcgroup_t* cg, char* param, char* content)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_content(file_path, content, strlen(content));\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_set_param(xcgroup_t* cg, char* param, char* content)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_content(file_path, content, strlen(content));\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "readdir",
          "args": [
            "dir"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"%s: opendir(%s): %m\"",
            "__func__",
            "path"
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opendir",
          "args": [
            "path"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"xcgroup: move_process_by_task: path overflow!\""
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "path",
            "PATH_MAX",
            "\"/proc/%d/task\"",
            "(int) pid"
          ],
          "line": 803
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nstatic int cgroup_move_process_by_task (xcgroup_t *cg, pid_t pid)\n{\n\tDIR *dir;\n\tstruct dirent *entry;\n\tchar path[PATH_MAX];\n\n\tif (snprintf(path, PATH_MAX, \"/proc/%d/task\", (int) pid) >= PATH_MAX) {\n\t\terror(\"xcgroup: move_process_by_task: path overflow!\");\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\tdir = opendir(path);\n\tif (!dir) {\n\t\terror(\"%s: opendir(%s): %m\", __func__, path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\twhile ((entry = readdir(dir))) {\n\t\tif (entry->d_name[0] != '.')\n\t\t\txcgroup_set_param(cg, \"tasks\", entry->d_name);\n\t}\n\tclosedir(dir);\n\treturn XCGROUP_SUCCESS;\n}"
  },
  {
    "function_name": "xcgroup_get_uint64_param",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "768-795",
    "snippet": "int xcgroup_get_uint64_param(xcgroup_t* cg, char* param, uint64_t* value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\tuint64_t* values;\n\tint vnb;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t}\n\telse {\n\t\tfstatus = _file_read_uint64s(file_path, &values, &vnb);\n\t\tif (fstatus != XCGROUP_SUCCESS) {\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t\t} else if (vnb < 1) {\n\t\t\tdebug2(\"%s: empty parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t\t} else {\n\t\t\t*value = values[0];\n\t\t\txfree(values);\n\t\t\tfstatus = XCGROUP_SUCCESS;\n\t\t}\n\t}\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [
      "#define PATH_MAX 256"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "values"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: empty parameter '%s' for '%s'\"",
            "__func__",
            "param",
            "cpath"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to get parameter '%s' for '%s'\"",
            "__func__",
            "param",
            "cpath"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_file_read_uint64s",
          "args": [
            "file_path",
            "&values",
            "&vnb"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "_file_read_uint64s",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "923-993",
          "snippet": "int _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb)\n{\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\tchar* p;\n\n\tuint64_t* pa=NULL;\n\tint i;\n\n\t/* check input pointers */\n\tif (pvalues == NULL || pnb == NULL)\n\t\treturn XCGROUP_ERROR;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\tclose(fd);\n\tbuf[fsize]='\\0';\n\n\t/* count values (splitted by \\n) */\n\ti=0;\n\tif (rc > 0) {\n\t\tp = buf;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\ti++;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* build uint64_t list */\n\tif (i > 0) {\n\t\tpa = (uint64_t*) xmalloc(sizeof(uint64_t) * i);\n\t\tp = buf;\n\t\ti = 0;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\tlong long unsigned int ll_tmp;\n\t\t\tsscanf(p, \"%llu\", &ll_tmp);\n\t\t\tpa[i++] = ll_tmp;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* free buffer */\n\txfree(buf);\n\n\t/* set output values */\n\t*pvalues = pa;\n\t*pnb = i;\n\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb);",
            "int _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb);\nint _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb);\n\nint _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb)\n{\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\tchar* p;\n\n\tuint64_t* pa=NULL;\n\tint i;\n\n\t/* check input pointers */\n\tif (pvalues == NULL || pnb == NULL)\n\t\treturn XCGROUP_ERROR;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\tclose(fd);\n\tbuf[fsize]='\\0';\n\n\t/* count values (splitted by \\n) */\n\ti=0;\n\tif (rc > 0) {\n\t\tp = buf;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\ti++;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* build uint64_t list */\n\tif (i > 0) {\n\t\tpa = (uint64_t*) xmalloc(sizeof(uint64_t) * i);\n\t\tp = buf;\n\t\ti = 0;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\tlong long unsigned int ll_tmp;\n\t\t\tsscanf(p, \"%llu\", &ll_tmp);\n\t\t\tpa[i++] = ll_tmp;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* free buffer */\n\txfree(buf);\n\n\t/* set output values */\n\t*pvalues = pa;\n\t*pnb = i;\n\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\"",
            "cpath",
            "param"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "file_path",
            "PATH_MAX",
            "\"%s/%s\"",
            "cpath",
            "param"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_get_uint64_param(xcgroup_t* cg, char* param, uint64_t* value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\tuint64_t* values;\n\tint vnb;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t}\n\telse {\n\t\tfstatus = _file_read_uint64s(file_path, &values, &vnb);\n\t\tif (fstatus != XCGROUP_SUCCESS) {\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t\t} else if (vnb < 1) {\n\t\t\tdebug2(\"%s: empty parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t\t} else {\n\t\t\t*value = values[0];\n\t\t\txfree(values);\n\t\t\tfstatus = XCGROUP_SUCCESS;\n\t\t}\n\t}\n\treturn fstatus;\n}"
  },
  {
    "function_name": "xcgroup_set_uint64_param",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "745-766",
    "snippet": "int xcgroup_set_uint64_param(xcgroup_t* cg, char* param, uint64_t value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_uint64s(file_path, &value, 1);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%\"PRIu64\"' for \"\n\t\t\t\"'%s'\", __func__, param, value, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%\"PRIu64\"' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [
      "#define PATH_MAX 256"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"%s: parameter '%s' set to '%\"PRIu64\"' for '%s'\"",
            "__func__",
            "param",
            "value",
            "cpath"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to set parameter '%s' to '%\"PRIu64\"' for \"\n\t\t\t\"'%s'\"",
            "__func__",
            "param",
            "value",
            "cpath"
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_file_write_uint64s",
          "args": [
            "file_path",
            "&value",
            "1"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "_file_write_uint64s",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "873-921",
          "snippet": "int _file_write_uint64s(char* file_path, uint64_t* values, int nb)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\tchar tstr[256];\n\tuint64_t value;\n\tint i;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* add one value per line */\n\tfstatus = XCGROUP_SUCCESS;\n\tfor (i=0 ; i < nb ; i++) {\n\n\t\tvalue = values[i];\n\n\t\trc = snprintf(tstr, sizeof(tstr), \"%\"PRIu64\"\", value);\n\t\tif (rc < 0) {\n\t\t\tdebug2(\"unable to build %\"PRIu64\" string value, \"\n\t\t\t       \"skipping\", value);\n\t\t\tfstatus = XCGROUP_ERROR;\n\t\t\tcontinue;\n\t\t}\n\n\t\tdo {\n\t\t\trc = write(fd, tstr, strlen(tstr)+1);\n\t\t}\n\t\twhile (rc < 0 && errno == EINTR);\n\t\tif (rc < 1) {\n\t\t\tdebug2(\"%s: unable to add value '%s' to file '%s' : %m\",\n\t\t\t\t__func__, tstr, file_path);\n\t\t\tif (errno != ESRCH)\n\t\t\t\tfstatus = XCGROUP_ERROR;\n\t\t}\n\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_write_uint32s(char* file_path, uint32_t* values, int nb);",
            "int _file_write_uint64s(char* file_path, uint64_t* values, int nb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_write_uint32s(char* file_path, uint32_t* values, int nb);\nint _file_write_uint64s(char* file_path, uint64_t* values, int nb);\n\nint _file_write_uint64s(char* file_path, uint64_t* values, int nb)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\tchar tstr[256];\n\tuint64_t value;\n\tint i;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* add one value per line */\n\tfstatus = XCGROUP_SUCCESS;\n\tfor (i=0 ; i < nb ; i++) {\n\n\t\tvalue = values[i];\n\n\t\trc = snprintf(tstr, sizeof(tstr), \"%\"PRIu64\"\", value);\n\t\tif (rc < 0) {\n\t\t\tdebug2(\"unable to build %\"PRIu64\" string value, \"\n\t\t\t       \"skipping\", value);\n\t\t\tfstatus = XCGROUP_ERROR;\n\t\t\tcontinue;\n\t\t}\n\n\t\tdo {\n\t\t\trc = write(fd, tstr, strlen(tstr)+1);\n\t\t}\n\t\twhile (rc < 0 && errno == EINTR);\n\t\tif (rc < 1) {\n\t\t\tdebug2(\"%s: unable to add value '%s' to file '%s' : %m\",\n\t\t\t\t__func__, tstr, file_path);\n\t\t\tif (errno != ESRCH)\n\t\t\t\tfstatus = XCGROUP_ERROR;\n\t\t}\n\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\"",
            "cpath",
            "param"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "file_path",
            "PATH_MAX",
            "\"%s/%s\"",
            "cpath",
            "param"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_set_uint64_param(xcgroup_t* cg, char* param, uint64_t value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_uint64s(file_path, &value, 1);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%\"PRIu64\"' for \"\n\t\t\t\"'%s'\", __func__, param, value, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%\"PRIu64\"' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\n\treturn fstatus;\n}"
  },
  {
    "function_name": "xcgroup_get_uint32_param",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "717-743",
    "snippet": "int xcgroup_get_uint32_param(xcgroup_t* cg, char* param, uint32_t* value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\tuint32_t* values;\n\tint vnb;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t} else {\n\t\tfstatus = _file_read_uint32s(file_path, &values, &vnb);\n\t\tif (fstatus != XCGROUP_SUCCESS) {\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t\t} else if (vnb < 1) {\n\t\t\tdebug2(\"%s: empty parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t\t} else {\n\t\t\t*value = values[0];\n\t\t\txfree(values);\n\t\t\tfstatus = XCGROUP_SUCCESS;\n\t\t}\n\t}\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [
      "#define PATH_MAX 256"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "values"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: empty parameter '%s' for '%s'\"",
            "__func__",
            "param",
            "cpath"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to get parameter '%s' for '%s'\"",
            "__func__",
            "param",
            "cpath"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_file_read_uint32s",
          "args": [
            "file_path",
            "&values",
            "&vnb"
          ],
          "line": 729
        },
        "resolved": true,
        "details": {
          "function_name": "_file_read_uint32s",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1045-1114",
          "snippet": "int _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb)\n{\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\tchar* p;\n\n\tuint32_t* pa=NULL;\n\tint i;\n\n\t/* check input pointers */\n\tif (pvalues == NULL || pnb == NULL)\n\t\treturn XCGROUP_ERROR;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\tclose(fd);\n\tbuf[fsize]='\\0';\n\n\t/* count values (splitted by \\n) */\n\ti=0;\n\tif (rc > 0) {\n\t\tp = buf;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\ti++;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* build uint32_t list */\n\tif (i > 0) {\n\t\tpa = (uint32_t*) xmalloc(sizeof(uint32_t) * i);\n\t\tp = buf;\n\t\ti = 0;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\tsscanf(p, \"%u\", pa+i);\n\t\t\tp = index(p, '\\n') + 1;\n\t\t\ti++;\n\t\t}\n\t}\n\n\t/* free buffer */\n\txfree(buf);\n\n\t/* set output values */\n\t*pvalues = pa;\n\t*pnb = i;\n\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb);",
            "int _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb);\nint _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb);\n\nint _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb)\n{\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\tchar* p;\n\n\tuint32_t* pa=NULL;\n\tint i;\n\n\t/* check input pointers */\n\tif (pvalues == NULL || pnb == NULL)\n\t\treturn XCGROUP_ERROR;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\tclose(fd);\n\tbuf[fsize]='\\0';\n\n\t/* count values (splitted by \\n) */\n\ti=0;\n\tif (rc > 0) {\n\t\tp = buf;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\ti++;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* build uint32_t list */\n\tif (i > 0) {\n\t\tpa = (uint32_t*) xmalloc(sizeof(uint32_t) * i);\n\t\tp = buf;\n\t\ti = 0;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\tsscanf(p, \"%u\", pa+i);\n\t\t\tp = index(p, '\\n') + 1;\n\t\t\ti++;\n\t\t}\n\t}\n\n\t/* free buffer */\n\txfree(buf);\n\n\t/* set output values */\n\t*pvalues = pa;\n\t*pnb = i;\n\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\"",
            "cpath",
            "param"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "file_path",
            "PATH_MAX",
            "\"%s/%s\"",
            "cpath",
            "param"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_get_uint32_param(xcgroup_t* cg, char* param, uint32_t* value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\tuint32_t* values;\n\tint vnb;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t} else {\n\t\tfstatus = _file_read_uint32s(file_path, &values, &vnb);\n\t\tif (fstatus != XCGROUP_SUCCESS) {\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t\t} else if (vnb < 1) {\n\t\t\tdebug2(\"%s: empty parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t\t} else {\n\t\t\t*value = values[0];\n\t\t\txfree(values);\n\t\t\tfstatus = XCGROUP_SUCCESS;\n\t\t}\n\t}\n\treturn fstatus;\n}"
  },
  {
    "function_name": "xcgroup_set_uint32_param",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "694-715",
    "snippet": "int xcgroup_set_uint32_param(xcgroup_t* cg, char* param, uint32_t value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_uint32s(file_path, &value, 1);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%u' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%u' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [
      "#define PATH_MAX 256"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"%s: parameter '%s' set to '%u' for '%s'\"",
            "__func__",
            "param",
            "value",
            "cpath"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to set parameter '%s' to '%u' for '%s'\"",
            "__func__",
            "param",
            "value",
            "cpath"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_file_write_uint32s",
          "args": [
            "file_path",
            "&value",
            "1"
          ],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "_file_write_uint32s",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "995-1043",
          "snippet": "int _file_write_uint32s(char* file_path, uint32_t* values, int nb)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\tchar tstr[256];\n\tuint32_t value;\n\tint i;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* add one value per line */\n\tfstatus = XCGROUP_SUCCESS;\n\tfor (i=0 ; i < nb ; i++) {\n\n\t\tvalue = values[i];\n\n\t\trc = snprintf(tstr, sizeof(tstr), \"%u\", value);\n\t\tif (rc < 0) {\n\t\t\tdebug2(\"unable to build %u string value, skipping\",\n\t\t\t       value);\n\t\t\tfstatus = XCGROUP_ERROR;\n\t\t\tcontinue;\n\t\t}\n\n\t\tdo {\n\t\t\trc = write(fd, tstr, strlen(tstr)+1);\n\t\t}\n\t\twhile (rc < 0 && errno == EINTR);\n\t\tif (rc < 1) {\n\t\t\tdebug2(\"%s: unable to add value '%s' to file '%s' : %m\",\n\t\t\t\t__func__, tstr, file_path);\n\t\t\tif (errno != ESRCH)\n\t\t\t\tfstatus = XCGROUP_ERROR;\n\t\t}\n\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_write_uint32s(char* file_path, uint32_t* values, int nb);",
            "int _file_write_uint64s(char* file_path, uint64_t* values, int nb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_write_uint32s(char* file_path, uint32_t* values, int nb);\nint _file_write_uint64s(char* file_path, uint64_t* values, int nb);\n\nint _file_write_uint32s(char* file_path, uint32_t* values, int nb)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\tchar tstr[256];\n\tuint32_t value;\n\tint i;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* add one value per line */\n\tfstatus = XCGROUP_SUCCESS;\n\tfor (i=0 ; i < nb ; i++) {\n\n\t\tvalue = values[i];\n\n\t\trc = snprintf(tstr, sizeof(tstr), \"%u\", value);\n\t\tif (rc < 0) {\n\t\t\tdebug2(\"unable to build %u string value, skipping\",\n\t\t\t       value);\n\t\t\tfstatus = XCGROUP_ERROR;\n\t\t\tcontinue;\n\t\t}\n\n\t\tdo {\n\t\t\trc = write(fd, tstr, strlen(tstr)+1);\n\t\t}\n\t\twhile (rc < 0 && errno == EINTR);\n\t\tif (rc < 1) {\n\t\t\tdebug2(\"%s: unable to add value '%s' to file '%s' : %m\",\n\t\t\t\t__func__, tstr, file_path);\n\t\t\tif (errno != ESRCH)\n\t\t\t\tfstatus = XCGROUP_ERROR;\n\t\t}\n\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\"",
            "cpath",
            "param"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "file_path",
            "PATH_MAX",
            "\"%s/%s\"",
            "cpath",
            "param"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_set_uint32_param(xcgroup_t* cg, char* param, uint32_t value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_uint32s(file_path, &value, 1);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%u' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%u' for '%s'\",\n\t\t\t__func__, param, value, cpath);\n\n\treturn fstatus;\n}"
  },
  {
    "function_name": "xcgroup_get_param",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "676-692",
    "snippet": "int xcgroup_get_param(xcgroup_t* cg, char* param, char **content, size_t *csize)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t} else {\n\t\tfstatus = _file_read_content(file_path, content, csize);\n\t\tif (fstatus != XCGROUP_SUCCESS)\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t}\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [
      "#define PATH_MAX 256"
    ],
    "globals_used": [
      "int _file_read_content(char* file_path, char** content, size_t *csize);",
      "int _file_write_content(char* file_path, char* content, size_t csize);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to get parameter '%s' for '%s'\"",
            "__func__",
            "param",
            "cpath"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_file_read_content",
          "args": [
            "file_path",
            "content",
            "csize"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "_file_read_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1149-1197",
          "snippet": "int _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\"",
            "cpath",
            "param"
          ],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "file_path",
            "PATH_MAX",
            "\"%s/%s\"",
            "cpath",
            "param"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint xcgroup_get_param(xcgroup_t* cg, char* param, char **content, size_t *csize)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t} else {\n\t\tfstatus = _file_read_content(file_path, content, csize);\n\t\tif (fstatus != XCGROUP_SUCCESS)\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t}\n\treturn fstatus;\n}"
  },
  {
    "function_name": "xcgroup_set_param",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "653-674",
    "snippet": "int xcgroup_set_param(xcgroup_t* cg, char* param, char* content)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_content(file_path, content, strlen(content));\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [
      "#define PATH_MAX 256"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"%s: parameter '%s' set to '%s' for '%s'\"",
            "__func__",
            "param",
            "content",
            "cpath"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to set parameter '%s' to '%s' for '%s'\"",
            "__func__",
            "param",
            "content",
            "cpath"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_file_write_content",
          "args": [
            "file_path",
            "content",
            "strlen(content)"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "_file_write_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1116-1147",
          "snippet": "int _file_write_content(char* file_path, char* content, size_t csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* write content */\n\tdo {\n\t\trc = write(fd, content, csize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* check read size */\n\tif (rc < csize) {\n\t\tdebug2(\"%s: unable to write %lu bytes to file '%s' : %m\",\n\t\t\t__func__, (long unsigned int) csize, file_path);\n\t\tfstatus = XCGROUP_ERROR;\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_write_content(char* file_path, char* content, size_t csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* write content */\n\tdo {\n\t\trc = write(fd, content, csize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* check read size */\n\tif (rc < csize) {\n\t\tdebug2(\"%s: unable to write %lu bytes to file '%s' : %m\",\n\t\t\t__func__, (long unsigned int) csize, file_path);\n\t\tfstatus = XCGROUP_ERROR;\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "content"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\"",
            "cpath",
            "param"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "file_path",
            "PATH_MAX",
            "\"%s/%s\"",
            "cpath",
            "param"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_set_param(xcgroup_t* cg, char* param, char* content)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_content(file_path, content, strlen(content));\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\n\treturn fstatus;\n}"
  },
  {
    "function_name": "xcgroup_set_params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "602-651",
    "snippet": "int xcgroup_set_params(xcgroup_t* cg, char* parameters)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\tchar* params;\n\tchar* value;\n\tchar* p;\n\tchar* next;\n\n\tparams = (char*) xstrdup(parameters);\n\n\tp = params;\n\twhile (p != NULL && *p != '\\0') {\n\t\tnext = index(p, ' ');\n\t\tif (next) {\n\t\t\t*next='\\0';\n\t\t\tnext++;\n\t\t\twhile (*next == ' ')\n\t\t\t\tnext++;\n\t\t}\n\t\tvalue = index(p, '=');\n\t\tif (value != NULL) {\n\t\t\t*value='\\0';\n\t\t\tvalue++;\n\t\t\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, p)\n\t\t\t     >= PATH_MAX) {\n\t\t\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t\t\t       \" parameter '%s' : %m\", cpath, p);\n\t\t\t\tgoto next_loop;\n\t\t\t}\n\t\t\tfstatus = _file_write_content(file_path, value,\n\t\t\t\t\t\t      strlen(value));\n\t\t\tif (fstatus != XCGROUP_SUCCESS)\n\t\t\t\tdebug2(\"%s: unable to set parameter '%s' to \"\n\t\t\t\t\t\"'%s' for '%s'\", __func__, p, value,\n\t\t\t\t\tcpath);\n\t\t\telse\n\t\t\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t\t\t__func__, p, value, cpath);\n\t\t} else\n\t\t\tdebug2(\"%s: bad parameters format for entry '%s'\",\n\t\t\t\t__func__, p);\n\tnext_loop:\n\t\tp = next;\n\t}\n\n\txfree(params);\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [
      "#define PATH_MAX 256"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "params"
          ],
          "line": 649
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: bad parameters format for entry '%s'\"",
            "__func__",
            "p"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"%s: parameter '%s' set to '%s' for '%s'\"",
            "__func__",
            "p",
            "value",
            "cpath"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to set parameter '%s' to \"\n\t\t\t\t\t\"'%s' for '%s'\"",
            "__func__",
            "p",
            "value",
            "cpath"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_file_write_content",
          "args": [
            "file_path",
            "value",
            "strlen(value)"
          ],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "_file_write_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1116-1147",
          "snippet": "int _file_write_content(char* file_path, char* content, size_t csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* write content */\n\tdo {\n\t\trc = write(fd, content, csize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* check read size */\n\tif (rc < csize) {\n\t\tdebug2(\"%s: unable to write %lu bytes to file '%s' : %m\",\n\t\t\t__func__, (long unsigned int) csize, file_path);\n\t\tfstatus = XCGROUP_ERROR;\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_write_content(char* file_path, char* content, size_t csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* write content */\n\tdo {\n\t\trc = write(fd, content, csize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* check read size */\n\tif (rc < csize) {\n\t\tdebug2(\"%s: unable to write %lu bytes to file '%s' : %m\",\n\t\t\t__func__, (long unsigned int) csize, file_path);\n\t\tfstatus = XCGROUP_ERROR;\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"unable to build filepath for '%s' and\"\n\t\t\t\t       \" parameter '%s' : %m\"",
            "cpath",
            "p"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "file_path",
            "PATH_MAX",
            "\"%s/%s\"",
            "cpath",
            "p"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "p",
            "'='"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "p",
            "' '"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "parameters"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_set_params(xcgroup_t* cg, char* parameters)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\tchar* params;\n\tchar* value;\n\tchar* p;\n\tchar* next;\n\n\tparams = (char*) xstrdup(parameters);\n\n\tp = params;\n\twhile (p != NULL && *p != '\\0') {\n\t\tnext = index(p, ' ');\n\t\tif (next) {\n\t\t\t*next='\\0';\n\t\t\tnext++;\n\t\t\twhile (*next == ' ')\n\t\t\t\tnext++;\n\t\t}\n\t\tvalue = index(p, '=');\n\t\tif (value != NULL) {\n\t\t\t*value='\\0';\n\t\t\tvalue++;\n\t\t\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, p)\n\t\t\t     >= PATH_MAX) {\n\t\t\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t\t\t       \" parameter '%s' : %m\", cpath, p);\n\t\t\t\tgoto next_loop;\n\t\t\t}\n\t\t\tfstatus = _file_write_content(file_path, value,\n\t\t\t\t\t\t      strlen(value));\n\t\t\tif (fstatus != XCGROUP_SUCCESS)\n\t\t\t\tdebug2(\"%s: unable to set parameter '%s' to \"\n\t\t\t\t\t\"'%s' for '%s'\", __func__, p, value,\n\t\t\t\t\tcpath);\n\t\t\telse\n\t\t\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t\t\t__func__, p, value, cpath);\n\t\t} else\n\t\t\tdebug2(\"%s: bad parameters format for entry '%s'\",\n\t\t\t\t__func__, p);\n\tnext_loop:\n\t\tp = next;\n\t}\n\n\txfree(params);\n\treturn fstatus;\n}"
  },
  {
    "function_name": "xcgroup_get_pids",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "584-600",
    "snippet": "int xcgroup_get_pids(xcgroup_t* cg, pid_t **pids, int *npids)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar* path = NULL;\n\n\tif (pids == NULL || npids == NULL)\n\t\treturn SLURM_ERROR;\n\n\tpath = _cgroup_procs_readable_path(cg);\n\n\tfstatus = _file_read_uint32s(path, (uint32_t**)pids, npids);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to get pids of '%s'\", __func__, cg->path);\n\n\txfree(path);\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "path"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to get pids of '%s'\"",
            "__func__",
            "cg->path"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_file_read_uint32s",
          "args": [
            "path",
            "(uint32_t**)pids",
            "npids"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "_file_read_uint32s",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1045-1114",
          "snippet": "int _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb)\n{\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\tchar* p;\n\n\tuint32_t* pa=NULL;\n\tint i;\n\n\t/* check input pointers */\n\tif (pvalues == NULL || pnb == NULL)\n\t\treturn XCGROUP_ERROR;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\tclose(fd);\n\tbuf[fsize]='\\0';\n\n\t/* count values (splitted by \\n) */\n\ti=0;\n\tif (rc > 0) {\n\t\tp = buf;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\ti++;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* build uint32_t list */\n\tif (i > 0) {\n\t\tpa = (uint32_t*) xmalloc(sizeof(uint32_t) * i);\n\t\tp = buf;\n\t\ti = 0;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\tsscanf(p, \"%u\", pa+i);\n\t\t\tp = index(p, '\\n') + 1;\n\t\t\ti++;\n\t\t}\n\t}\n\n\t/* free buffer */\n\txfree(buf);\n\n\t/* set output values */\n\t*pvalues = pa;\n\t*pnb = i;\n\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb);",
            "int _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb);\nint _file_read_uint64s(char* file_path, uint64_t** pvalues, int* pnb);\n\nint _file_read_uint32s(char* file_path, uint32_t** pvalues, int* pnb)\n{\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\tchar* p;\n\n\tuint32_t* pa=NULL;\n\tint i;\n\n\t/* check input pointers */\n\tif (pvalues == NULL || pnb == NULL)\n\t\treturn XCGROUP_ERROR;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\tclose(fd);\n\tbuf[fsize]='\\0';\n\n\t/* count values (splitted by \\n) */\n\ti=0;\n\tif (rc > 0) {\n\t\tp = buf;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\ti++;\n\t\t\tp = index(p, '\\n') + 1;\n\t\t}\n\t}\n\n\t/* build uint32_t list */\n\tif (i > 0) {\n\t\tpa = (uint32_t*) xmalloc(sizeof(uint32_t) * i);\n\t\tp = buf;\n\t\ti = 0;\n\t\twhile (index(p, '\\n') != NULL) {\n\t\t\tsscanf(p, \"%u\", pa+i);\n\t\t\tp = index(p, '\\n') + 1;\n\t\t\ti++;\n\t\t}\n\t}\n\n\t/* free buffer */\n\txfree(buf);\n\n\t/* set output values */\n\t*pvalues = pa;\n\t*pnb = i;\n\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_cgroup_procs_readable_path",
          "args": [
            "cg"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "_cgroup_procs_readable_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "557-560",
          "snippet": "static char *_cgroup_procs_readable_path (xcgroup_t *cg)\n{\n\treturn _cgroup_procs_check(cg, S_IRUSR);\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nstatic char *_cgroup_procs_readable_path (xcgroup_t *cg)\n{\n\treturn _cgroup_procs_check(cg, S_IRUSR);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_get_pids(xcgroup_t* cg, pid_t **pids, int *npids)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar* path = NULL;\n\n\tif (pids == NULL || npids == NULL)\n\t\treturn SLURM_ERROR;\n\n\tpath = _cgroup_procs_readable_path(cg);\n\n\tfstatus = _file_read_uint32s(path, (uint32_t**)pids, npids);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to get pids of '%s'\", __func__, cg->path);\n\n\txfree(path);\n\treturn fstatus;\n}"
  },
  {
    "function_name": "xcgroup_add_pids",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "569-580",
    "snippet": "int xcgroup_add_pids(xcgroup_t* cg, pid_t* pids, int npids)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar* path = _cgroup_procs_writable_path(cg);\n\n\tfstatus = _file_write_uint32s(path, (uint32_t*)pids, npids);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to add pids to '%s'\", __func__, cg->path);\n\n\txfree(path);\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "path"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to add pids to '%s'\"",
            "__func__",
            "cg->path"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_file_write_uint32s",
          "args": [
            "path",
            "(uint32_t*)pids",
            "npids"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "_file_write_uint32s",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "995-1043",
          "snippet": "int _file_write_uint32s(char* file_path, uint32_t* values, int nb)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\tchar tstr[256];\n\tuint32_t value;\n\tint i;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* add one value per line */\n\tfstatus = XCGROUP_SUCCESS;\n\tfor (i=0 ; i < nb ; i++) {\n\n\t\tvalue = values[i];\n\n\t\trc = snprintf(tstr, sizeof(tstr), \"%u\", value);\n\t\tif (rc < 0) {\n\t\t\tdebug2(\"unable to build %u string value, skipping\",\n\t\t\t       value);\n\t\t\tfstatus = XCGROUP_ERROR;\n\t\t\tcontinue;\n\t\t}\n\n\t\tdo {\n\t\t\trc = write(fd, tstr, strlen(tstr)+1);\n\t\t}\n\t\twhile (rc < 0 && errno == EINTR);\n\t\tif (rc < 1) {\n\t\t\tdebug2(\"%s: unable to add value '%s' to file '%s' : %m\",\n\t\t\t\t__func__, tstr, file_path);\n\t\t\tif (errno != ESRCH)\n\t\t\t\tfstatus = XCGROUP_ERROR;\n\t\t}\n\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_write_uint32s(char* file_path, uint32_t* values, int nb);",
            "int _file_write_uint64s(char* file_path, uint64_t* values, int nb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_write_uint32s(char* file_path, uint32_t* values, int nb);\nint _file_write_uint64s(char* file_path, uint64_t* values, int nb);\n\nint _file_write_uint32s(char* file_path, uint32_t* values, int nb)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\tchar tstr[256];\n\tuint32_t value;\n\tint i;\n\n\t/* open file for writing */\n\tfd = open(file_path, O_WRONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for writing : %m\",\n\t\t\t__func__, file_path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/* add one value per line */\n\tfstatus = XCGROUP_SUCCESS;\n\tfor (i=0 ; i < nb ; i++) {\n\n\t\tvalue = values[i];\n\n\t\trc = snprintf(tstr, sizeof(tstr), \"%u\", value);\n\t\tif (rc < 0) {\n\t\t\tdebug2(\"unable to build %u string value, skipping\",\n\t\t\t       value);\n\t\t\tfstatus = XCGROUP_ERROR;\n\t\t\tcontinue;\n\t\t}\n\n\t\tdo {\n\t\t\trc = write(fd, tstr, strlen(tstr)+1);\n\t\t}\n\t\twhile (rc < 0 && errno == EINTR);\n\t\tif (rc < 1) {\n\t\t\tdebug2(\"%s: unable to add value '%s' to file '%s' : %m\",\n\t\t\t\t__func__, tstr, file_path);\n\t\t\tif (errno != ESRCH)\n\t\t\t\tfstatus = XCGROUP_ERROR;\n\t\t}\n\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_cgroup_procs_writable_path",
          "args": [
            "cg"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "_cgroup_procs_writable_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "562-565",
          "snippet": "static char *_cgroup_procs_writable_path (xcgroup_t *cg)\n{\n\treturn _cgroup_procs_check(cg, S_IWUSR);\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nstatic char *_cgroup_procs_writable_path (xcgroup_t *cg)\n{\n\treturn _cgroup_procs_check(cg, S_IWUSR);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_add_pids(xcgroup_t* cg, pid_t* pids, int npids)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar* path = _cgroup_procs_writable_path(cg);\n\n\tfstatus = _file_write_uint32s(path, (uint32_t*)pids, npids);\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to add pids to '%s'\", __func__, cg->path);\n\n\txfree(path);\n\treturn fstatus;\n}"
  },
  {
    "function_name": "_cgroup_procs_writable_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "562-565",
    "snippet": "static char *_cgroup_procs_writable_path (xcgroup_t *cg)\n{\n\treturn _cgroup_procs_check(cg, S_IWUSR);\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_cgroup_procs_check",
          "args": [
            "cg",
            "S_IWUSR"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "_cgroup_procs_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "544-555",
          "snippet": "static char *_cgroup_procs_check (xcgroup_t *cg, int check_mode)\n{\n\tstruct stat st;\n\t// If possible use cgroup.procs to add the processes atomically\n\tchar *path = xstrdup_printf(\"%s/%s\", cg->path, \"cgroup.procs\");\n\tif (!((stat (path, &st) >= 0) && (st.st_mode & check_mode))) {\n\t\txfree(path);\n\t\tpath = xstrdup_printf(\"%s/%s\", cg->path, \"tasks\");\n\t}\n\n\treturn path;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nstatic char *_cgroup_procs_check (xcgroup_t *cg, int check_mode)\n{\n\tstruct stat st;\n\t// If possible use cgroup.procs to add the processes atomically\n\tchar *path = xstrdup_printf(\"%s/%s\", cg->path, \"cgroup.procs\");\n\tif (!((stat (path, &st) >= 0) && (st.st_mode & check_mode))) {\n\t\txfree(path);\n\t\tpath = xstrdup_printf(\"%s/%s\", cg->path, \"tasks\");\n\t}\n\n\treturn path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nstatic char *_cgroup_procs_writable_path (xcgroup_t *cg)\n{\n\treturn _cgroup_procs_check(cg, S_IWUSR);\n}"
  },
  {
    "function_name": "_cgroup_procs_readable_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "557-560",
    "snippet": "static char *_cgroup_procs_readable_path (xcgroup_t *cg)\n{\n\treturn _cgroup_procs_check(cg, S_IRUSR);\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_cgroup_procs_check",
          "args": [
            "cg",
            "S_IRUSR"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "_cgroup_procs_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "544-555",
          "snippet": "static char *_cgroup_procs_check (xcgroup_t *cg, int check_mode)\n{\n\tstruct stat st;\n\t// If possible use cgroup.procs to add the processes atomically\n\tchar *path = xstrdup_printf(\"%s/%s\", cg->path, \"cgroup.procs\");\n\tif (!((stat (path, &st) >= 0) && (st.st_mode & check_mode))) {\n\t\txfree(path);\n\t\tpath = xstrdup_printf(\"%s/%s\", cg->path, \"tasks\");\n\t}\n\n\treturn path;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nstatic char *_cgroup_procs_check (xcgroup_t *cg, int check_mode)\n{\n\tstruct stat st;\n\t// If possible use cgroup.procs to add the processes atomically\n\tchar *path = xstrdup_printf(\"%s/%s\", cg->path, \"cgroup.procs\");\n\tif (!((stat (path, &st) >= 0) && (st.st_mode & check_mode))) {\n\t\txfree(path);\n\t\tpath = xstrdup_printf(\"%s/%s\", cg->path, \"tasks\");\n\t}\n\n\treturn path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nstatic char *_cgroup_procs_readable_path (xcgroup_t *cg)\n{\n\treturn _cgroup_procs_check(cg, S_IRUSR);\n}"
  },
  {
    "function_name": "_cgroup_procs_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "544-555",
    "snippet": "static char *_cgroup_procs_check (xcgroup_t *cg, int check_mode)\n{\n\tstruct stat st;\n\t// If possible use cgroup.procs to add the processes atomically\n\tchar *path = xstrdup_printf(\"%s/%s\", cg->path, \"cgroup.procs\");\n\tif (!((stat (path, &st) >= 0) && (st.st_mode & check_mode))) {\n\t\txfree(path);\n\t\tpath = xstrdup_printf(\"%s/%s\", cg->path, \"tasks\");\n\t}\n\n\treturn path;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xstrdup_printf",
          "args": [
            "\"%s/%s\"",
            "cg->path",
            "\"tasks\""
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "path"
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&st"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "_set_job_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/mgr.c",
          "lines": "986-992",
          "snippet": "static void _set_job_state(stepd_step_rec_t *job, slurmstepd_state_t new_state)\n{\n\tslurm_mutex_lock(&job->state_mutex);\n\tjob->state = new_state;\n\tpthread_cond_signal(&job->state_cond);\n\tslurm_mutex_unlock(&job->state_mutex);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/ulimits.h\"",
            "#include \"src/slurmd/slurmstepd/pam_ses.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmstepd/task.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/reverse_tree.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/slurm_mpi.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/safeopen.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#    include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <pthread.h>",
            "#include <poll.h>",
            "#include <grp.h>",
            "#  include \"src/common/unsetenv.h\"",
            "#  include <sys/checkpnt.h>",
            "#  include <sys/prctl.h>",
            "#  include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void  _set_prio_process (stepd_step_rec_t *job);",
            "static void _set_job_log_prefix(stepd_step_rec_t *job);",
            "static int  _setup_normal_io(stepd_step_rec_t *job);",
            "static int  _reclaim_privileges(struct priv_state *state);",
            "static int  _slurmd_job_log_init(stepd_step_rec_t *job);",
            "static void _wait_for_io(stepd_step_rec_t *job);",
            "static void _wait_for_children_slurmstepd(stepd_step_rec_t *job);",
            "static int  _send_pending_exit_msgs(stepd_step_rec_t *job);",
            "static void _send_step_complete_msgs(stepd_step_rec_t *job);",
            "static void _set_job_state(stepd_step_rec_t *job, slurmstepd_state_t new_state);",
            "static void _wait_for_all_tasks(stepd_step_rec_t *job);",
            "static void _setargs(stepd_step_rec_t *job);",
            "static void _random_sleep(stepd_step_rec_t *job);",
            "static char * _make_batch_dir(stepd_step_rec_t *job);",
            "static int _initgroups(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/ulimits.h\"\n#include \"src/slurmd/slurmstepd/pam_ses.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmstepd/task.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/reverse_tree.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/slurm_mpi.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/safeopen.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/cbuf.h\"\n#include \"slurm/slurm_errno.h\"\n#    include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <string.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <pthread.h>\n#include <poll.h>\n#include <grp.h>\n#  include \"src/common/unsetenv.h\"\n#  include <sys/checkpnt.h>\n#  include <sys/prctl.h>\n#  include <sys/types.h>\n#  include \"config.h\"\n\nstatic void  _set_prio_process (stepd_step_rec_t *job);\nstatic void _set_job_log_prefix(stepd_step_rec_t *job);\nstatic int  _setup_normal_io(stepd_step_rec_t *job);\nstatic int  _reclaim_privileges(struct priv_state *state);\nstatic int  _slurmd_job_log_init(stepd_step_rec_t *job);\nstatic void _wait_for_io(stepd_step_rec_t *job);\nstatic void _wait_for_children_slurmstepd(stepd_step_rec_t *job);\nstatic int  _send_pending_exit_msgs(stepd_step_rec_t *job);\nstatic void _send_step_complete_msgs(stepd_step_rec_t *job);\nstatic void _set_job_state(stepd_step_rec_t *job, slurmstepd_state_t new_state);\nstatic void _wait_for_all_tasks(stepd_step_rec_t *job);\nstatic void _setargs(stepd_step_rec_t *job);\nstatic void _random_sleep(stepd_step_rec_t *job);\nstatic char * _make_batch_dir(stepd_step_rec_t *job);\nstatic int _initgroups(stepd_step_rec_t *job);\n\nstatic void _set_job_state(stepd_step_rec_t *job, slurmstepd_state_t new_state)\n{\n\tslurm_mutex_lock(&job->state_mutex);\n\tjob->state = new_state;\n\tpthread_cond_signal(&job->state_cond);\n\tslurm_mutex_unlock(&job->state_mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xstrdup_printf",
          "args": [
            "\"%s/%s\"",
            "cg->path",
            "\"cgroup.procs\""
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nstatic char *_cgroup_procs_check (xcgroup_t *cg, int check_mode)\n{\n\tstruct stat st;\n\t// If possible use cgroup.procs to add the processes atomically\n\tchar *path = xstrdup_printf(\"%s/%s\", cg->path, \"cgroup.procs\");\n\tif (!((stat (path, &st) >= 0) && (st.st_mode & check_mode))) {\n\t\txfree(path);\n\t\tpath = xstrdup_printf(\"%s/%s\", cg->path, \"tasks\");\n\t}\n\n\treturn path;\n}"
  },
  {
    "function_name": "xcgroup_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "531-542",
    "snippet": "int xcgroup_delete(xcgroup_t* cg)\n{\n\t/*\n\t *  Simply delete cgroup with rmdir(2). If cgroup doesn't\n\t *   exist, do not propagate error back to caller.\n\t */\n\tif (cg && cg->path && (rmdir(cg->path) < 0) && (errno != ENOENT)) {\n\t\tdebug2(\"%s: rmdir(%s): %m\", __func__, cg->path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\treturn XCGROUP_SUCCESS;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: rmdir(%s): %m\"",
            "__func__",
            "cg->path"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rmdir",
          "args": [
            "cg->path"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_delete(xcgroup_t* cg)\n{\n\t/*\n\t *  Simply delete cgroup with rmdir(2). If cgroup doesn't\n\t *   exist, do not propagate error back to caller.\n\t */\n\tif (cg && cg->path && (rmdir(cg->path) < 0) && (errno != ENOENT)) {\n\t\tdebug2(\"%s: rmdir(%s): %m\", __func__, cg->path);\n\t\treturn XCGROUP_ERROR;\n\t}\n\treturn XCGROUP_SUCCESS;\n}"
  },
  {
    "function_name": "xcgroup_load",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "497-529",
    "snippet": "int xcgroup_load(xcgroup_ns_t* cgns, xcgroup_t* cg, char* uri)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\tstruct stat buf;\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\tif (stat((const char*)file_path, &buf)) {\n\t\tdebug2(\"%s: unable to get cgroup '%s' entry '%s' properties\"\n\t\t       \": %m\", __func__, cgns->mnt_point, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = buf.st_uid;\n\tcg->gid = buf.st_gid;\n\n\t/* read the content of the notify flag */\n\txcgroup_get_uint32_param(cg, \"notify_on_release\", &(cg->notify));\n\n\treturn XCGROUP_SUCCESS;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [
      "#define PATH_MAX 256"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_get_uint32_param",
          "args": [
            "cg",
            "\"notify_on_release\"",
            "&(cg->notify)"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_get_uint32_param",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "717-743",
          "snippet": "int xcgroup_get_uint32_param(xcgroup_t* cg, char* param, uint32_t* value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\tuint32_t* values;\n\tint vnb;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t} else {\n\t\tfstatus = _file_read_uint32s(file_path, &values, &vnb);\n\t\tif (fstatus != XCGROUP_SUCCESS) {\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t\t} else if (vnb < 1) {\n\t\t\tdebug2(\"%s: empty parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t\t} else {\n\t\t\t*value = values[0];\n\t\t\txfree(values);\n\t\t\tfstatus = XCGROUP_SUCCESS;\n\t\t}\n\t}\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_get_uint32_param(xcgroup_t* cg, char* param, uint32_t* value)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\tuint32_t* values;\n\tint vnb;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t} else {\n\t\tfstatus = _file_read_uint32s(file_path, &values, &vnb);\n\t\tif (fstatus != XCGROUP_SUCCESS) {\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t\t} else if (vnb < 1) {\n\t\t\tdebug2(\"%s: empty parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t\t} else {\n\t\t\t*value = values[0];\n\t\t\txfree(values);\n\t\t\tfstatus = XCGROUP_SUCCESS;\n\t\t}\n\t}\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "file_path"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "uri"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to get cgroup '%s' entry '%s' properties\"\n\t\t       \": %m\"",
            "__func__",
            "cgns->mnt_point",
            "file_path"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "(const char*)file_path",
            "&buf"
          ],
          "line": 512
        },
        "resolved": true,
        "details": {
          "function_name": "_set_job_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/mgr.c",
          "lines": "986-992",
          "snippet": "static void _set_job_state(stepd_step_rec_t *job, slurmstepd_state_t new_state)\n{\n\tslurm_mutex_lock(&job->state_mutex);\n\tjob->state = new_state;\n\tpthread_cond_signal(&job->state_cond);\n\tslurm_mutex_unlock(&job->state_mutex);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"",
            "#include \"src/slurmd/slurmstepd/ulimits.h\"",
            "#include \"src/slurmd/slurmstepd/pam_ses.h\"",
            "#include \"src/slurmd/slurmstepd/req.h\"",
            "#include \"src/slurmd/slurmstepd/pdebug.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmstepd/task.h\"",
            "#include \"src/slurmd/slurmstepd/mgr.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/common/xcpuinfo.h\"",
            "#include \"src/slurmd/common/set_oomadj.h\"",
            "#include \"src/slurmd/common/reverse_tree.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmd_cgroup.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/setproctitle.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/common/core_spec_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/switch.h\"",
            "#include \"src/common/slurm_mpi.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_acct_gather_profile.h\"",
            "#include \"src/common/safeopen.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#    include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <pthread.h>",
            "#include <poll.h>",
            "#include <grp.h>",
            "#  include \"src/common/unsetenv.h\"",
            "#  include <sys/checkpnt.h>",
            "#  include <sys/prctl.h>",
            "#  include <sys/types.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void  _set_prio_process (stepd_step_rec_t *job);",
            "static void _set_job_log_prefix(stepd_step_rec_t *job);",
            "static int  _setup_normal_io(stepd_step_rec_t *job);",
            "static int  _reclaim_privileges(struct priv_state *state);",
            "static int  _slurmd_job_log_init(stepd_step_rec_t *job);",
            "static void _wait_for_io(stepd_step_rec_t *job);",
            "static void _wait_for_children_slurmstepd(stepd_step_rec_t *job);",
            "static int  _send_pending_exit_msgs(stepd_step_rec_t *job);",
            "static void _send_step_complete_msgs(stepd_step_rec_t *job);",
            "static void _set_job_state(stepd_step_rec_t *job, slurmstepd_state_t new_state);",
            "static void _wait_for_all_tasks(stepd_step_rec_t *job);",
            "static void _setargs(stepd_step_rec_t *job);",
            "static void _random_sleep(stepd_step_rec_t *job);",
            "static char * _make_batch_dir(stepd_step_rec_t *job);",
            "static int _initgroups(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/step_terminate_monitor.h\"\n#include \"src/slurmd/slurmstepd/ulimits.h\"\n#include \"src/slurmd/slurmstepd/pam_ses.h\"\n#include \"src/slurmd/slurmstepd/req.h\"\n#include \"src/slurmd/slurmstepd/pdebug.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmstepd/task.h\"\n#include \"src/slurmd/slurmstepd/mgr.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/common/xcpuinfo.h\"\n#include \"src/slurmd/common/set_oomadj.h\"\n#include \"src/slurmd/common/reverse_tree.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmd_cgroup.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/setproctitle.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/common/core_spec_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/switch.h\"\n#include \"src/common/slurm_mpi.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_acct_gather_profile.h\"\n#include \"src/common/safeopen.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/cbuf.h\"\n#include \"slurm/slurm_errno.h\"\n#    include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <string.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <pthread.h>\n#include <poll.h>\n#include <grp.h>\n#  include \"src/common/unsetenv.h\"\n#  include <sys/checkpnt.h>\n#  include <sys/prctl.h>\n#  include <sys/types.h>\n#  include \"config.h\"\n\nstatic void  _set_prio_process (stepd_step_rec_t *job);\nstatic void _set_job_log_prefix(stepd_step_rec_t *job);\nstatic int  _setup_normal_io(stepd_step_rec_t *job);\nstatic int  _reclaim_privileges(struct priv_state *state);\nstatic int  _slurmd_job_log_init(stepd_step_rec_t *job);\nstatic void _wait_for_io(stepd_step_rec_t *job);\nstatic void _wait_for_children_slurmstepd(stepd_step_rec_t *job);\nstatic int  _send_pending_exit_msgs(stepd_step_rec_t *job);\nstatic void _send_step_complete_msgs(stepd_step_rec_t *job);\nstatic void _set_job_state(stepd_step_rec_t *job, slurmstepd_state_t new_state);\nstatic void _wait_for_all_tasks(stepd_step_rec_t *job);\nstatic void _setargs(stepd_step_rec_t *job);\nstatic void _random_sleep(stepd_step_rec_t *job);\nstatic char * _make_batch_dir(stepd_step_rec_t *job);\nstatic int _initgroups(stepd_step_rec_t *job);\n\nstatic void _set_job_state(stepd_step_rec_t *job, slurmstepd_state_t new_state)\n{\n\tslurm_mutex_lock(&job->state_mutex);\n\tjob->state = new_state;\n\tpthread_cond_signal(&job->state_cond);\n\tslurm_mutex_unlock(&job->state_mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\"",
            "uri",
            "cgns->subsystems"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "file_path",
            "PATH_MAX",
            "\"%s%s\"",
            "cgns->mnt_point",
            "uri"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_load(xcgroup_ns_t* cgns, xcgroup_t* cg, char* uri)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\tstruct stat buf;\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\tif (stat((const char*)file_path, &buf)) {\n\t\tdebug2(\"%s: unable to get cgroup '%s' entry '%s' properties\"\n\t\t       \": %m\", __func__, cgns->mnt_point, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = buf.st_uid;\n\tcg->gid = buf.st_gid;\n\n\t/* read the content of the notify flag */\n\txcgroup_get_uint32_param(cg, \"notify_on_release\", &(cg->notify));\n\n\treturn XCGROUP_SUCCESS;\n}"
  },
  {
    "function_name": "xcgroup_instantiate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "442-495",
    "snippet": "int xcgroup_instantiate(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tmode_t cmask;\n\tmode_t omask;\n\n\txcgroup_ns_t* cgns;\n\tchar* file_path;\n\tuid_t uid;\n\tgid_t gid;\n\tint create_only;\n\tuint32_t notify;\n\n\t/* init variables based on input cgroup */\n\tcgns = cg->ns;\n\tfile_path = cg->path;\n\tuid = cg->uid;\n\tgid = cg->gid;\n\tcreate_only = 0;\n\tnotify = cg->notify;\n\n\t/* save current mask and apply working one */\n\tcmask = S_IWGRP | S_IWOTH;\n\tomask = umask(cmask);\n\n\t/* build cgroup */\n \tif (mkdir(file_path, 0755)) {\n\t\tif (create_only || errno != EEXIST) {\n\t\t\tdebug2(\"%s: unable to create cgroup '%s' : %m\",\n\t\t\t       __func__, file_path);\n\t\t\tumask(omask);\n\t\t\treturn fstatus;\n\t\t}\n\t}\n\tumask(omask);\n\n\t/* change cgroup ownership as requested */\n\tif (chown(file_path, uid, gid)) {\n\t\tdebug2(\"%s: unable to chown %d:%d cgroup '%s' : %m\",\n\t\t       __func__, uid, gid, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* following operations failure might not result in a general\n\t * failure so set output status to success */\n\tfstatus = XCGROUP_SUCCESS;\n\n\t/* set notify on release flag */\n\tif (notify == 1 && cgns->notify_prog)\n\t\txcgroup_set_params(cg, \"notify_on_release=1\");\n\telse\n\t\txcgroup_set_params(cg, \"notify_on_release=0\");\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_set_params",
          "args": [
            "cg",
            "\"notify_on_release=0\""
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_set_params",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "602-651",
          "snippet": "int xcgroup_set_params(xcgroup_t* cg, char* parameters)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\tchar* params;\n\tchar* value;\n\tchar* p;\n\tchar* next;\n\n\tparams = (char*) xstrdup(parameters);\n\n\tp = params;\n\twhile (p != NULL && *p != '\\0') {\n\t\tnext = index(p, ' ');\n\t\tif (next) {\n\t\t\t*next='\\0';\n\t\t\tnext++;\n\t\t\twhile (*next == ' ')\n\t\t\t\tnext++;\n\t\t}\n\t\tvalue = index(p, '=');\n\t\tif (value != NULL) {\n\t\t\t*value='\\0';\n\t\t\tvalue++;\n\t\t\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, p)\n\t\t\t     >= PATH_MAX) {\n\t\t\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t\t\t       \" parameter '%s' : %m\", cpath, p);\n\t\t\t\tgoto next_loop;\n\t\t\t}\n\t\t\tfstatus = _file_write_content(file_path, value,\n\t\t\t\t\t\t      strlen(value));\n\t\t\tif (fstatus != XCGROUP_SUCCESS)\n\t\t\t\tdebug2(\"%s: unable to set parameter '%s' to \"\n\t\t\t\t\t\"'%s' for '%s'\", __func__, p, value,\n\t\t\t\t\tcpath);\n\t\t\telse\n\t\t\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t\t\t__func__, p, value, cpath);\n\t\t} else\n\t\t\tdebug2(\"%s: bad parameters format for entry '%s'\",\n\t\t\t\t__func__, p);\n\tnext_loop:\n\t\tp = next;\n\t}\n\n\txfree(params);\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_set_params(xcgroup_t* cg, char* parameters)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\tchar* params;\n\tchar* value;\n\tchar* p;\n\tchar* next;\n\n\tparams = (char*) xstrdup(parameters);\n\n\tp = params;\n\twhile (p != NULL && *p != '\\0') {\n\t\tnext = index(p, ' ');\n\t\tif (next) {\n\t\t\t*next='\\0';\n\t\t\tnext++;\n\t\t\twhile (*next == ' ')\n\t\t\t\tnext++;\n\t\t}\n\t\tvalue = index(p, '=');\n\t\tif (value != NULL) {\n\t\t\t*value='\\0';\n\t\t\tvalue++;\n\t\t\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, p)\n\t\t\t     >= PATH_MAX) {\n\t\t\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t\t\t       \" parameter '%s' : %m\", cpath, p);\n\t\t\t\tgoto next_loop;\n\t\t\t}\n\t\t\tfstatus = _file_write_content(file_path, value,\n\t\t\t\t\t\t      strlen(value));\n\t\t\tif (fstatus != XCGROUP_SUCCESS)\n\t\t\t\tdebug2(\"%s: unable to set parameter '%s' to \"\n\t\t\t\t\t\"'%s' for '%s'\", __func__, p, value,\n\t\t\t\t\tcpath);\n\t\t\telse\n\t\t\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t\t\t__func__, p, value, cpath);\n\t\t} else\n\t\t\tdebug2(\"%s: bad parameters format for entry '%s'\",\n\t\t\t\t__func__, p);\n\tnext_loop:\n\t\tp = next;\n\t}\n\n\txfree(params);\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to chown %d:%d cgroup '%s' : %m\"",
            "__func__",
            "uid",
            "gid",
            "file_path"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chown",
          "args": [
            "file_path",
            "uid",
            "gid"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "umask",
          "args": [
            "omask"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "set_umask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/ulimits.c",
          "lines": "181-199",
          "snippet": "extern int\nset_umask(stepd_step_rec_t *job)\n{\n\tmode_t mask;\n\tchar *val;\n\n\tif (!(val = getenvp(job->env, \"SLURM_UMASK\"))) {\n\t\tif (job->stepid != SLURM_EXTERN_CONT)\n\t\t\tdebug(\"Couldn't find SLURM_UMASK in environment\");\n\t\treturn SLURM_ERROR;\n\t}\n\n\tmask = strtol(val, (char **)NULL, 8);\n\tif ((job->stepid == SLURM_EXTERN_CONT) ||\n\t    (job->stepid == SLURM_BATCH_SCRIPT))\n\t\tunsetenvp(job->env, \"SLURM_UMASK\");\n\tumask(mask);\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/slurm_rlimits_info.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/strlcpy.h\"",
            "#include \"src/common/env.h\" /* For unsetenvp() */",
            "#include \"src/common/log.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/slurm_rlimits_info.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/strlcpy.h\"\n#include \"src/common/env.h\" /* For unsetenvp() */\n#include \"src/common/log.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#  include \"config.h\"\n\nextern int\nset_umask(stepd_step_rec_t *job)\n{\n\tmode_t mask;\n\tchar *val;\n\n\tif (!(val = getenvp(job->env, \"SLURM_UMASK\"))) {\n\t\tif (job->stepid != SLURM_EXTERN_CONT)\n\t\t\tdebug(\"Couldn't find SLURM_UMASK in environment\");\n\t\treturn SLURM_ERROR;\n\t}\n\n\tmask = strtol(val, (char **)NULL, 8);\n\tif ((job->stepid == SLURM_EXTERN_CONT) ||\n\t    (job->stepid == SLURM_BATCH_SCRIPT))\n\t\tunsetenvp(job->env, \"SLURM_UMASK\");\n\tumask(mask);\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: unable to create cgroup '%s' : %m\"",
            "__func__",
            "file_path"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mkdir",
          "args": [
            "file_path",
            "0755"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_instantiate(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tmode_t cmask;\n\tmode_t omask;\n\n\txcgroup_ns_t* cgns;\n\tchar* file_path;\n\tuid_t uid;\n\tgid_t gid;\n\tint create_only;\n\tuint32_t notify;\n\n\t/* init variables based on input cgroup */\n\tcgns = cg->ns;\n\tfile_path = cg->path;\n\tuid = cg->uid;\n\tgid = cg->gid;\n\tcreate_only = 0;\n\tnotify = cg->notify;\n\n\t/* save current mask and apply working one */\n\tcmask = S_IWGRP | S_IWOTH;\n\tomask = umask(cmask);\n\n\t/* build cgroup */\n \tif (mkdir(file_path, 0755)) {\n\t\tif (create_only || errno != EEXIST) {\n\t\t\tdebug2(\"%s: unable to create cgroup '%s' : %m\",\n\t\t\t       __func__, file_path);\n\t\t\tumask(omask);\n\t\t\treturn fstatus;\n\t\t}\n\t}\n\tumask(omask);\n\n\t/* change cgroup ownership as requested */\n\tif (chown(file_path, uid, gid)) {\n\t\tdebug2(\"%s: unable to chown %d:%d cgroup '%s' : %m\",\n\t\t       __func__, uid, gid, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* following operations failure might not result in a general\n\t * failure so set output status to success */\n\tfstatus = XCGROUP_SUCCESS;\n\n\t/* set notify on release flag */\n\tif (notify == 1 && cgns->notify_prog)\n\t\txcgroup_set_params(cg, \"notify_on_release=1\");\n\telse\n\t\txcgroup_set_params(cg, \"notify_on_release=0\");\n\treturn fstatus;\n}"
  },
  {
    "function_name": "xcgroup_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "428-440",
    "snippet": "int xcgroup_unlock(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\n\tif (flock(cg->fd,  LOCK_UN) < 0) {\n\t\tdebug2(\"%s: error unlocking cgroup '%s' : %m\",\n\t\t       __func__, cg->path);\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\tclose(cg->fd);\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "size_t _file_getsize(int fd);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "cg->fd"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "io_close_local_fds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "1463-1487",
          "snippet": "void\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static bool _task_writable(eio_obj_t *);",
            "static bool _task_readable(eio_obj_t *);",
            "static int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);",
            "static void *_io_thr(void *arg);",
            "static void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);",
            "static bool _incoming_buf_free(stepd_step_rec_t *job);",
            "static bool _outgoing_buf_free(stepd_step_rec_t *job);",
            "static int  _send_connection_okay_response(stepd_step_rec_t *job);",
            "static struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic bool _task_writable(eio_obj_t *);\nstatic bool _task_readable(eio_obj_t *);\nstatic int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);\nstatic void *_io_thr(void *arg);\nstatic void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);\nstatic bool _incoming_buf_free(stepd_step_rec_t *job);\nstatic bool _outgoing_buf_free(stepd_step_rec_t *job);\nstatic int  _send_connection_okay_response(stepd_step_rec_t *job);\nstatic struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);\n\nvoid\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: error unlocking cgroup '%s' : %m\"",
            "__func__",
            "cg->path"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flock",
          "args": [
            "cg->fd",
            "LOCK_UN"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\n\nint xcgroup_unlock(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\n\tif (flock(cg->fd,  LOCK_UN) < 0) {\n\t\tdebug2(\"%s: error unlocking cgroup '%s' : %m\",\n\t\t       __func__, cg->path);\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\tclose(cg->fd);\n\treturn fstatus;\n}"
  },
  {
    "function_name": "xcgroup_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "405-426",
    "snippet": "int xcgroup_lock(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\n\tif (cg->path == NULL)\n\t\treturn fstatus;\n\n\tif ((cg->fd = open(cg->path, O_RDONLY)) < 0) {\n\t\tdebug2(\"%s: error from open of cgroup '%s' : %m\",\n\t\t       __func__, cg->path);\n\t\treturn fstatus;\n\t}\n\n\tif (flock(cg->fd,  LOCK_EX) < 0) {\n\t\tdebug2(\"%s: error locking cgroup '%s' : %m\",\n\t\t       __func__, cg->path);\n\t\tclose(cg->fd);\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "size_t _file_getsize(int fd);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "cg->fd"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "io_close_local_fds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "1463-1487",
          "snippet": "void\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static bool _task_writable(eio_obj_t *);",
            "static bool _task_readable(eio_obj_t *);",
            "static int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);",
            "static void *_io_thr(void *arg);",
            "static void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);",
            "static void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);",
            "static bool _incoming_buf_free(stepd_step_rec_t *job);",
            "static bool _outgoing_buf_free(stepd_step_rec_t *job);",
            "static int  _send_connection_okay_response(stepd_step_rec_t *job);",
            "static struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic bool _task_writable(eio_obj_t *);\nstatic bool _task_readable(eio_obj_t *);\nstatic int _send_io_init_msg(int sock, srun_key_t *key, stepd_step_rec_t *job);\nstatic void *_io_thr(void *arg);\nstatic void _free_outgoing_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_incoming_msg(struct io_buf *msg, stepd_step_rec_t *job);\nstatic void _free_all_outgoing_msgs(List msg_queue, stepd_step_rec_t *job);\nstatic bool _incoming_buf_free(stepd_step_rec_t *job);\nstatic bool _outgoing_buf_free(stepd_step_rec_t *job);\nstatic int  _send_connection_okay_response(stepd_step_rec_t *job);\nstatic struct io_buf *_build_connection_okay_message(stepd_step_rec_t *job);\n\nvoid\nio_close_local_fds(stepd_step_rec_t *job)\n{\n\tListIterator clients;\n\teio_obj_t *eio;\n\tint rc;\n\tstruct client_io_info *client;\n\n\tif (job == NULL || job->clients == NULL)\n\t\treturn;\n\n\tclients = list_iterator_create(job->clients);\n\twhile((eio = list_next(clients))) {\n\t\tclient = (struct client_io_info *)eio->arg;\n\t\tif (client->is_local_file) {\n\t\t\tif (eio->fd >= 0) {\n\t\t\t\tdo {\n\t\t\t\t\trc = close(eio->fd);\n\t\t\t\t} while (rc == -1 && errno == EINTR);\n\t\t\t\teio->fd = -1;\n\t\t\t}\n\t\t}\n\t}\n\tlist_iterator_destroy(clients);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: error locking cgroup '%s' : %m\"",
            "__func__",
            "cg->path"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flock",
          "args": [
            "cg->fd",
            "LOCK_EX"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"%s: error from open of cgroup '%s' : %m\"",
            "__func__",
            "cg->path"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "cg->path",
            "O_RDONLY"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\n\nint xcgroup_lock(xcgroup_t* cg)\n{\n\tint fstatus = XCGROUP_ERROR;\n\n\tif (cg->path == NULL)\n\t\treturn fstatus;\n\n\tif ((cg->fd = open(cg->path, O_RDONLY)) < 0) {\n\t\tdebug2(\"%s: error from open of cgroup '%s' : %m\",\n\t\t       __func__, cg->path);\n\t\treturn fstatus;\n\t}\n\n\tif (flock(cg->fd,  LOCK_EX) < 0) {\n\t\tdebug2(\"%s: error locking cgroup '%s' : %m\",\n\t\t       __func__, cg->path);\n\t\tclose(cg->fd);\n\t} else\n\t\tfstatus = XCGROUP_SUCCESS;\n\n\treturn fstatus;\n}"
  },
  {
    "function_name": "xcgroup_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "396-403",
    "snippet": "void xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "cg->path"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nvoid xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}"
  },
  {
    "function_name": "xcgroup_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "371-394",
    "snippet": "int xcgroup_create(xcgroup_ns_t* cgns, xcgroup_t* cg,\n\t\t   char* uri, uid_t uid,  gid_t gid)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = uid;\n\tcg->gid = gid;\n\tcg->notify = 1;\n\n\treturn XCGROUP_SUCCESS;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [
      "#define PATH_MAX 256"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "file_path"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "uri"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\"",
            "uri",
            "cgns->subsystems"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "file_path",
            "PATH_MAX",
            "\"%s%s\"",
            "cgns->mnt_point",
            "uri"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_create(xcgroup_ns_t* cgns, xcgroup_t* cg,\n\t\t   char* uri, uid_t uid,  gid_t gid)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = uid;\n\tcg->gid = gid;\n\tcg->notify = 1;\n\n\treturn XCGROUP_SUCCESS;\n}"
  },
  {
    "function_name": "xcgroup_ns_load",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "352-361",
    "snippet": "int xcgroup_ns_load(slurm_cgroup_conf_t *conf, xcgroup_ns_t *cgns, char *subsys)\n{\n\tcgns->mnt_point = xstrdup_printf(\"%s/%s\",\n\t\t\t\t\t conf->cgroup_mountpoint, subsys);\n\tcgns->mnt_args = NULL;\n\tcgns->subsystems = xstrdup(subsys);\n\tcgns->notify_prog = xstrdup_printf(\"%s/release_%s\",\n\t\t\t\t\t   conf->cgroup_release_agent, subsys);\n\treturn XCGROUP_SUCCESS;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xstrdup_printf",
          "args": [
            "\"%s/release_%s\"",
            "conf->cgroup_release_agent",
            "subsys"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "subsys"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup_printf",
          "args": [
            "\"%s/%s\"",
            "conf->cgroup_mountpoint",
            "subsys"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_ns_load(slurm_cgroup_conf_t *conf, xcgroup_ns_t *cgns, char *subsys)\n{\n\tcgns->mnt_point = xstrdup_printf(\"%s/%s\",\n\t\t\t\t\t conf->cgroup_mountpoint, subsys);\n\tcgns->mnt_args = NULL;\n\tcgns->subsystems = xstrdup(subsys);\n\tcgns->notify_prog = xstrdup_printf(\"%s/release_%s\",\n\t\t\t\t\t   conf->cgroup_release_agent, subsys);\n\treturn XCGROUP_SUCCESS;\n}"
  },
  {
    "function_name": "xcgroup_ns_find_by_pid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "295-350",
    "snippet": "int xcgroup_ns_find_by_pid(xcgroup_ns_t* cgns, xcgroup_t* cg, pid_t pid)\n{\n\tint fstatus = SLURM_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* buf;\n\tsize_t fsize;\n\tchar* p;\n\tchar* e;\n\tchar* entry;\n\tchar* subsys;\n\n\t/* build pid cgroup meta filepath */\n\tif (snprintf(file_path, PATH_MAX, \"/proc/%u/cgroup\",\n\t\t      pid) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup meta filepath for pid=%u : %m\",\n\t\t       pid);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/*\n\t * read file content\n\t * multiple lines of the form :\n\t * num_mask:subsystems:relative_path\n\t */\n\tfstatus = _file_read_content(file_path, &buf, &fsize);\n\tif (fstatus == XCGROUP_SUCCESS) {\n\t\tfstatus = XCGROUP_ERROR;\n\t\tp = buf;\n\t\twhile ((e = index(p, '\\n')) != NULL) {\n\t\t\t*e='\\0';\n\t\t\t/* get subsystems entry */\n\t\t\tsubsys = index(p, ':');\n\t\t\tp = e + 1;\n\t\t\tif (subsys == NULL)\n\t\t\t\tcontinue;\n\t\t\tsubsys++;\n\t\t\t/* get relative path entry */\n\t\t\tentry = index(subsys, ':');\n\t\t\tif (entry == NULL)\n\t\t\t\tcontinue;\n\t\t\t*entry='\\0';\n\t\t\t/* check subsystem versus ns one */\n\t\t\tif (xstrcmp(cgns->subsystems, subsys) != 0) {\n\t\t\t\tdebug(\"skipping cgroup subsys %s(%s)\",\n\t\t\t\t      subsys, cgns->subsystems);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tentry++;\n\t\t\tfstatus = xcgroup_load(cgns, cg, entry);\n\t\t\tbreak;\n\t\t}\n\t\txfree(buf);\n\t}\n\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [
      "#define PATH_MAX 256"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "buf"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_load",
          "args": [
            "cgns",
            "cg",
            "entry"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "497-529",
          "snippet": "int xcgroup_load(xcgroup_ns_t* cgns, xcgroup_t* cg, char* uri)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\tstruct stat buf;\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\tif (stat((const char*)file_path, &buf)) {\n\t\tdebug2(\"%s: unable to get cgroup '%s' entry '%s' properties\"\n\t\t       \": %m\", __func__, cgns->mnt_point, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = buf.st_uid;\n\tcg->gid = buf.st_gid;\n\n\t/* read the content of the notify flag */\n\txcgroup_get_uint32_param(cg, \"notify_on_release\", &(cg->notify));\n\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_load(xcgroup_ns_t* cgns, xcgroup_t* cg, char* uri)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\tstruct stat buf;\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\tif (stat((const char*)file_path, &buf)) {\n\t\tdebug2(\"%s: unable to get cgroup '%s' entry '%s' properties\"\n\t\t       \": %m\", __func__, cgns->mnt_point, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = buf.st_uid;\n\tcg->gid = buf.st_gid;\n\n\t/* read the content of the notify flag */\n\txcgroup_get_uint32_param(cg, \"notify_on_release\", &(cg->notify));\n\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"skipping cgroup subsys %s(%s)\"",
            "subsys",
            "cgns->subsystems"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrcmp",
          "args": [
            "cgns->subsystems",
            "subsys"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "subsys",
            "':'"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "p",
            "':'"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "p",
            "'\\n'"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_file_read_content",
          "args": [
            "file_path",
            "&buf",
            "&fsize"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "_file_read_content",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "1149-1197",
          "snippet": "int _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "size_t _file_getsize(int fd);",
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nsize_t _file_getsize(int fd);\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint _file_read_content(char* file_path, char** content, size_t *csize)\n{\n\tint fstatus;\n\tint rc;\n\tint fd;\n\n\tsize_t fsize;\n\tchar* buf;\n\n\tfstatus = XCGROUP_ERROR;\n\n\t/* check input pointers */\n\tif (content == NULL || csize == NULL)\n\t\treturn fstatus;\n\n\t/* open file for reading */\n\tfd = open(file_path, O_RDONLY, 0700);\n\tif (fd < 0) {\n\t\tdebug2(\"%s: unable to open '%s' for reading : %m\",\n\t\t\t__func__, file_path);\n\t\treturn fstatus;\n\t}\n\n\t/* get file size */\n\tfsize=_file_getsize(fd);\n\tif (fsize == -1) {\n\t\tclose(fd);\n\t\treturn fstatus;\n\t}\n\n\t/* read file contents */\n\tbuf = (char*) xmalloc((fsize+1)*sizeof(char));\n\tbuf[fsize]='\\0';\n\tdo {\n\t\trc = read(fd, buf, fsize);\n\t} while (rc < 0 && errno == EINTR);\n\n\t/* set output values */\n\tif (rc >= 0) {\n\t\t*content = buf;\n\t\t*csize = rc;\n\t\tfstatus = XCGROUP_SUCCESS;\n\t}\n\n\t/* close file */\n\tclose(fd);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"unable to build cgroup meta filepath for pid=%u : %m\"",
            "pid"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "file_path",
            "PATH_MAX",
            "\"/proc/%u/cgroup\"",
            "pid"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_ns_find_by_pid(xcgroup_ns_t* cgns, xcgroup_t* cg, pid_t pid)\n{\n\tint fstatus = SLURM_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* buf;\n\tsize_t fsize;\n\tchar* p;\n\tchar* e;\n\tchar* entry;\n\tchar* subsys;\n\n\t/* build pid cgroup meta filepath */\n\tif (snprintf(file_path, PATH_MAX, \"/proc/%u/cgroup\",\n\t\t      pid) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup meta filepath for pid=%u : %m\",\n\t\t       pid);\n\t\treturn XCGROUP_ERROR;\n\t}\n\n\t/*\n\t * read file content\n\t * multiple lines of the form :\n\t * num_mask:subsystems:relative_path\n\t */\n\tfstatus = _file_read_content(file_path, &buf, &fsize);\n\tif (fstatus == XCGROUP_SUCCESS) {\n\t\tfstatus = XCGROUP_ERROR;\n\t\tp = buf;\n\t\twhile ((e = index(p, '\\n')) != NULL) {\n\t\t\t*e='\\0';\n\t\t\t/* get subsystems entry */\n\t\t\tsubsys = index(p, ':');\n\t\t\tp = e + 1;\n\t\t\tif (subsys == NULL)\n\t\t\t\tcontinue;\n\t\t\tsubsys++;\n\t\t\t/* get relative path entry */\n\t\t\tentry = index(subsys, ':');\n\t\t\tif (entry == NULL)\n\t\t\t\tcontinue;\n\t\t\t*entry='\\0';\n\t\t\t/* check subsystem versus ns one */\n\t\t\tif (xstrcmp(cgns->subsystems, subsys) != 0) {\n\t\t\t\tdebug(\"skipping cgroup subsys %s(%s)\",\n\t\t\t\t      subsys, cgns->subsystems);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tentry++;\n\t\t\tfstatus = xcgroup_load(cgns, cg, entry);\n\t\t\tbreak;\n\t\t}\n\t\txfree(buf);\n\t}\n\n\treturn fstatus;\n}"
  },
  {
    "function_name": "xcgroup_ns_is_available",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "264-285",
    "snippet": "int xcgroup_ns_is_available(xcgroup_ns_t* cgns)\n{\n\tint fstatus = 0;\n\tchar* value;\n\tsize_t s;\n\txcgroup_t cg;\n\n\tif (xcgroup_create(cgns, &cg, \"/\", 0, 0) == XCGROUP_ERROR)\n\t\treturn 0;\n\n\tif (xcgroup_get_param(&cg, \"release_agent\",\n\t\t\t      &value, &s) != XCGROUP_SUCCESS)\n\t\tfstatus = 0;\n\telse {\n\t\txfree(value);\n\t\tfstatus = 1;\n\t}\n\n\txcgroup_destroy(&cg);\n\n\treturn fstatus;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_destroy",
          "args": [
            "&cg"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "396-403",
          "snippet": "void xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nvoid xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "value"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_get_param",
          "args": [
            "&cg",
            "\"release_agent\"",
            "&value",
            "&s"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_get_param",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "676-692",
          "snippet": "int xcgroup_get_param(xcgroup_t* cg, char* param, char **content, size_t *csize)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t} else {\n\t\tfstatus = _file_read_content(file_path, content, csize);\n\t\tif (fstatus != XCGROUP_SUCCESS)\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t}\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [
            "int _file_read_content(char* file_path, char** content, size_t *csize);",
            "int _file_write_content(char* file_path, char* content, size_t csize);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint _file_read_content(char* file_path, char** content, size_t *csize);\nint _file_write_content(char* file_path, char* content, size_t csize);\n\nint xcgroup_get_param(xcgroup_t* cg, char* param, char **content, size_t *csize)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t} else {\n\t\tfstatus = _file_read_content(file_path, content, csize);\n\t\tif (fstatus != XCGROUP_SUCCESS)\n\t\t\tdebug2(\"%s: unable to get parameter '%s' for '%s'\",\n\t\t\t\t__func__, param, cpath);\n\t}\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_create",
          "args": [
            "cgns",
            "&cg",
            "\"/\"",
            "0",
            "0"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "371-394",
          "snippet": "int xcgroup_create(xcgroup_ns_t* cgns, xcgroup_t* cg,\n\t\t   char* uri, uid_t uid,  gid_t gid)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = uid;\n\tcg->gid = gid;\n\tcg->notify = 1;\n\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_create(xcgroup_ns_t* cgns, xcgroup_t* cg,\n\t\t   char* uri, uid_t uid,  gid_t gid)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = uid;\n\tcg->gid = gid;\n\tcg->notify = 1;\n\n\treturn XCGROUP_SUCCESS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_ns_is_available(xcgroup_ns_t* cgns)\n{\n\tint fstatus = 0;\n\tchar* value;\n\tsize_t s;\n\txcgroup_t cg;\n\n\tif (xcgroup_create(cgns, &cg, \"/\", 0, 0) == XCGROUP_ERROR)\n\t\treturn 0;\n\n\tif (xcgroup_get_param(&cg, \"release_agent\",\n\t\t\t      &value, &s) != XCGROUP_SUCCESS)\n\t\tfstatus = 0;\n\telse {\n\t\txfree(value);\n\t\tfstatus = 1;\n\t}\n\n\txcgroup_destroy(&cg);\n\n\treturn fstatus;\n}"
  },
  {
    "function_name": "xcgroup_ns_umount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "250-255",
    "snippet": "int xcgroup_ns_umount(xcgroup_ns_t* cgns)\n{\n\tif (umount(cgns->mnt_point))\n\t\treturn XCGROUP_ERROR;\n\treturn XCGROUP_SUCCESS;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "umount",
          "args": [
            "cgns->mnt_point"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_ns_umount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "250-255",
          "snippet": "int xcgroup_ns_umount(xcgroup_ns_t* cgns)\n{\n\tif (umount(cgns->mnt_point))\n\t\treturn XCGROUP_ERROR;\n\treturn XCGROUP_SUCCESS;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_ns_umount(xcgroup_ns_t* cgns)\n{\n\tif (umount(cgns->mnt_point))\n\t\treturn XCGROUP_ERROR;\n\treturn XCGROUP_SUCCESS;\n}"
  },
  {
    "function_name": "xcgroup_ns_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "150-239",
    "snippet": "int xcgroup_ns_mount(xcgroup_ns_t* cgns)\n{\n\tint fstatus;\n\tchar* options;\n\tchar opt_combined[1024];\n\n\tchar* mnt_point;\n\tchar* p;\n\n\txcgroup_t cg;\n\n\tmode_t cmask;\n\tmode_t omask;\n\n\tcmask = S_IWGRP | S_IWOTH;\n\tomask = umask(cmask);\n\n\tfstatus = mkdir(cgns->mnt_point, 0755);\n\tif (fstatus && errno != EEXIST) {\n\t\tif (cgns->mnt_point[0] != '/') {\n\t\t\tdebug(\"unable to create cgroup ns directory '%s'\"\n\t\t\t      \" : do not start with '/'\", cgns->mnt_point);\n\t\t\tumask(omask);\n\t\t\treturn XCGROUP_ERROR;\n\t\t}\n\t\tmnt_point = xstrdup(cgns->mnt_point);\n\t\tp = mnt_point;\n\t\twhile ((p = index(p+1, '/')) != NULL) {\n\t\t\t*p = '\\0';\n\t\t\tfstatus = mkdir(mnt_point, 0755);\n\t\t\tif (fstatus && errno != EEXIST) {\n\t\t\t\tdebug(\"unable to create cgroup ns required \"\n\t\t\t\t      \"directory '%s'\", mnt_point);\n\t\t\t\txfree(mnt_point);\n\t\t\t\tumask(omask);\n\t\t\t\treturn XCGROUP_ERROR;\n\t\t\t}\n\t\t\t*p='/';\n\t\t}\n\t\txfree(mnt_point);\n\t\tfstatus = mkdir(cgns->mnt_point, 0755);\n\t}\n\n\tif (fstatus && errno != EEXIST) {\n\t\tdebug(\"unable to create cgroup ns directory '%s'\"\n\t\t      \" : %m\", cgns->mnt_point);\n\t\tumask(omask);\n\t\treturn XCGROUP_ERROR;\n\t}\n\tumask(omask);\n\n\tif (cgns->mnt_args == NULL ||\n\t    strlen(cgns->mnt_args) == 0)\n\t\toptions = cgns->subsystems;\n\telse {\n\t\tif (snprintf(opt_combined, sizeof(opt_combined), \"%s,%s\",\n\t\t\t     cgns->subsystems, cgns->mnt_args)\n\t\t    >= sizeof(opt_combined)) {\n\t\t\tdebug2(\"unable to build cgroup options string\");\n\t\t\treturn XCGROUP_ERROR;\n\t\t}\n\t\toptions = opt_combined;\n\t}\n\n#if defined(__FreeBSD__)\n\tif (mount(\"cgroup\", cgns->mnt_point,\n\t\t  MS_NOSUID|MS_NOEXEC|MS_NODEV, options))\n#else\n\tif (mount(\"cgroup\", cgns->mnt_point, \"cgroup\",\n\t\t  MS_NOSUID|MS_NOEXEC|MS_NODEV, options))\n#endif\n\t\treturn XCGROUP_ERROR;\n\telse {\n\t\t/* FIXME: this only gets set when we aren't mounted at\n\t\t   all.  Since we never umount this may only be loaded\n\t\t   at startup the first time.\n\t\t*/\n\n\t\t/* we then set the release_agent if necessary */\n\t\tif (cgns->notify_prog) {\n\t\t\tif (xcgroup_create(cgns, &cg, \"/\", 0, 0) ==\n\t\t\t     XCGROUP_ERROR)\n\t\t\t\treturn XCGROUP_SUCCESS;\n\t\t\txcgroup_set_param(&cg, \"release_agent\",\n\t\t\t\t\t  cgns->notify_prog);\n\t\t\txcgroup_destroy(&cg);\n\t\t}\n\t\treturn XCGROUP_SUCCESS;\n\t}\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_destroy",
          "args": [
            "&cg"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "396-403",
          "snippet": "void xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nvoid xcgroup_destroy(xcgroup_t* cg)\n{\n\tcg->ns = NULL;\n\txfree(cg->name);\n\txfree(cg->path);\n\tcg->uid = -1;\n\tcg->gid = -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_set_param",
          "args": [
            "&cg",
            "\"release_agent\"",
            "cgns->notify_prog"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_set_param",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "653-674",
          "snippet": "int xcgroup_set_param(xcgroup_t* cg, char* param, char* content)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_content(file_path, content, strlen(content));\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_set_param(xcgroup_t* cg, char* param, char* content)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\tchar* cpath = cg->path;\n\n\tif (snprintf(file_path, PATH_MAX, \"%s/%s\", cpath, param) >= PATH_MAX) {\n\t\tdebug2(\"unable to build filepath for '%s' and\"\n\t\t       \" parameter '%s' : %m\", cpath, param);\n\t\treturn fstatus;\n\t}\n\n\tfstatus = _file_write_content(file_path, content, strlen(content));\n\tif (fstatus != XCGROUP_SUCCESS)\n\t\tdebug2(\"%s: unable to set parameter '%s' to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\telse\n\t\tdebug3(\"%s: parameter '%s' set to '%s' for '%s'\",\n\t\t\t__func__, param, content, cpath);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_create",
          "args": [
            "cgns",
            "&cg",
            "\"/\"",
            "0",
            "0"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "371-394",
          "snippet": "int xcgroup_create(xcgroup_ns_t* cgns, xcgroup_t* cg,\n\t\t   char* uri, uid_t uid,  gid_t gid)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = uid;\n\tcg->gid = gid;\n\tcg->notify = 1;\n\n\treturn XCGROUP_SUCCESS;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [
            "#define PATH_MAX 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\n#define PATH_MAX 256\n\nint xcgroup_create(xcgroup_ns_t* cgns, xcgroup_t* cg,\n\t\t   char* uri, uid_t uid,  gid_t gid)\n{\n\tint fstatus = XCGROUP_ERROR;\n\tchar file_path[PATH_MAX];\n\n\t/* build cgroup absolute path*/\n\tif (snprintf(file_path, PATH_MAX, \"%s%s\", cgns->mnt_point,\n\t\t      uri) >= PATH_MAX) {\n\t\tdebug2(\"unable to build cgroup '%s' absolute path in ns '%s' \"\n\t\t       \": %m\", uri, cgns->subsystems);\n\t\treturn fstatus;\n\t}\n\n\t/* fill xcgroup structure */\n\tcg->ns = cgns;\n\tcg->name = xstrdup(uri);\n\tcg->path = xstrdup(file_path);\n\tcg->uid = uid;\n\tcg->gid = gid;\n\tcg->notify = 1;\n\n\treturn XCGROUP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mount",
          "args": [
            "\"cgroup\"",
            "cgns->mnt_point",
            "\"cgroup\"",
            "MS_NOSUID|MS_NOEXEC|MS_NODEV",
            "options"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mount",
          "args": [
            "\"cgroup\"",
            "cgns->mnt_point",
            "MS_NOSUID|MS_NOEXEC|MS_NODEV",
            "options"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"unable to build cgroup options string\""
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "opt_combined",
            "sizeof(opt_combined)",
            "\"%s,%s\"",
            "cgns->subsystems",
            "cgns->mnt_args"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "cgns->mnt_args"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "umask",
          "args": [
            "omask"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "set_umask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/ulimits.c",
          "lines": "181-199",
          "snippet": "extern int\nset_umask(stepd_step_rec_t *job)\n{\n\tmode_t mask;\n\tchar *val;\n\n\tif (!(val = getenvp(job->env, \"SLURM_UMASK\"))) {\n\t\tif (job->stepid != SLURM_EXTERN_CONT)\n\t\t\tdebug(\"Couldn't find SLURM_UMASK in environment\");\n\t\treturn SLURM_ERROR;\n\t}\n\n\tmask = strtol(val, (char **)NULL, 8);\n\tif ((job->stepid == SLURM_EXTERN_CONT) ||\n\t    (job->stepid == SLURM_BATCH_SCRIPT))\n\t\tunsetenvp(job->env, \"SLURM_UMASK\");\n\tumask(mask);\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/slurm_rlimits_info.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/strlcpy.h\"",
            "#include \"src/common/env.h\" /* For unsetenvp() */",
            "#include \"src/common/log.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/resource.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/slurm_rlimits_info.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/strlcpy.h\"\n#include \"src/common/env.h\" /* For unsetenvp() */\n#include \"src/common/log.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/resource.h>\n#  include \"config.h\"\n\nextern int\nset_umask(stepd_step_rec_t *job)\n{\n\tmode_t mask;\n\tchar *val;\n\n\tif (!(val = getenvp(job->env, \"SLURM_UMASK\"))) {\n\t\tif (job->stepid != SLURM_EXTERN_CONT)\n\t\t\tdebug(\"Couldn't find SLURM_UMASK in environment\");\n\t\treturn SLURM_ERROR;\n\t}\n\n\tmask = strtol(val, (char **)NULL, 8);\n\tif ((job->stepid == SLURM_EXTERN_CONT) ||\n\t    (job->stepid == SLURM_BATCH_SCRIPT))\n\t\tunsetenvp(job->env, \"SLURM_UMASK\");\n\tumask(mask);\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"unable to create cgroup ns directory '%s'\"\n\t\t      \" : %m\"",
            "cgns->mnt_point"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "pdebug_wake_process",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/pdebug.c",
          "lines": "187-199",
          "snippet": "void pdebug_wake_process(stepd_step_rec_t *job, pid_t pid)\n{\n\tif ((job->task_flags & TASK_PARALLEL_DEBUG) && (pid > (pid_t) 0)) {\n\t\tif (_pid_to_wake(pid)) {\n\t\t\tif (kill(pid, SIGCONT) < 0)\n\t\t\t\terror(\"kill(%lu): %m\", (unsigned long) pid);\n\t\t\telse\n\t\t\t\tdebug(\"woke pid %lu\", (unsigned long) pid);\n\t\t} else {\n\t\t\tdebug(\"pid %lu not stopped\", (unsigned long) pid);\n\t\t}\n\t}\n}",
          "includes": [
            "#  include <linux/sched.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"pdebug.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <linux/sched.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"pdebug.h\"\n\nvoid pdebug_wake_process(stepd_step_rec_t *job, pid_t pid)\n{\n\tif ((job->task_flags & TASK_PARALLEL_DEBUG) && (pid > (pid_t) 0)) {\n\t\tif (_pid_to_wake(pid)) {\n\t\t\tif (kill(pid, SIGCONT) < 0)\n\t\t\t\terror(\"kill(%lu): %m\", (unsigned long) pid);\n\t\t\telse\n\t\t\t\tdebug(\"woke pid %lu\", (unsigned long) pid);\n\t\t} else {\n\t\t\tdebug(\"pid %lu not stopped\", (unsigned long) pid);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mkdir",
          "args": [
            "cgns->mnt_point",
            "0755"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "mnt_point"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mkdir",
          "args": [
            "mnt_point",
            "0755"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "p+1",
            "'/'"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "cgns->mnt_point"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mkdir",
          "args": [
            "cgns->mnt_point",
            "0755"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_ns_mount(xcgroup_ns_t* cgns)\n{\n\tint fstatus;\n\tchar* options;\n\tchar opt_combined[1024];\n\n\tchar* mnt_point;\n\tchar* p;\n\n\txcgroup_t cg;\n\n\tmode_t cmask;\n\tmode_t omask;\n\n\tcmask = S_IWGRP | S_IWOTH;\n\tomask = umask(cmask);\n\n\tfstatus = mkdir(cgns->mnt_point, 0755);\n\tif (fstatus && errno != EEXIST) {\n\t\tif (cgns->mnt_point[0] != '/') {\n\t\t\tdebug(\"unable to create cgroup ns directory '%s'\"\n\t\t\t      \" : do not start with '/'\", cgns->mnt_point);\n\t\t\tumask(omask);\n\t\t\treturn XCGROUP_ERROR;\n\t\t}\n\t\tmnt_point = xstrdup(cgns->mnt_point);\n\t\tp = mnt_point;\n\t\twhile ((p = index(p+1, '/')) != NULL) {\n\t\t\t*p = '\\0';\n\t\t\tfstatus = mkdir(mnt_point, 0755);\n\t\t\tif (fstatus && errno != EEXIST) {\n\t\t\t\tdebug(\"unable to create cgroup ns required \"\n\t\t\t\t      \"directory '%s'\", mnt_point);\n\t\t\t\txfree(mnt_point);\n\t\t\t\tumask(omask);\n\t\t\t\treturn XCGROUP_ERROR;\n\t\t\t}\n\t\t\t*p='/';\n\t\t}\n\t\txfree(mnt_point);\n\t\tfstatus = mkdir(cgns->mnt_point, 0755);\n\t}\n\n\tif (fstatus && errno != EEXIST) {\n\t\tdebug(\"unable to create cgroup ns directory '%s'\"\n\t\t      \" : %m\", cgns->mnt_point);\n\t\tumask(omask);\n\t\treturn XCGROUP_ERROR;\n\t}\n\tumask(omask);\n\n\tif (cgns->mnt_args == NULL ||\n\t    strlen(cgns->mnt_args) == 0)\n\t\toptions = cgns->subsystems;\n\telse {\n\t\tif (snprintf(opt_combined, sizeof(opt_combined), \"%s,%s\",\n\t\t\t     cgns->subsystems, cgns->mnt_args)\n\t\t    >= sizeof(opt_combined)) {\n\t\t\tdebug2(\"unable to build cgroup options string\");\n\t\t\treturn XCGROUP_ERROR;\n\t\t}\n\t\toptions = opt_combined;\n\t}\n\n#if defined(__FreeBSD__)\n\tif (mount(\"cgroup\", cgns->mnt_point,\n\t\t  MS_NOSUID|MS_NOEXEC|MS_NODEV, options))\n#else\n\tif (mount(\"cgroup\", cgns->mnt_point, \"cgroup\",\n\t\t  MS_NOSUID|MS_NOEXEC|MS_NODEV, options))\n#endif\n\t\treturn XCGROUP_ERROR;\n\telse {\n\t\t/* FIXME: this only gets set when we aren't mounted at\n\t\t   all.  Since we never umount this may only be loaded\n\t\t   at startup the first time.\n\t\t*/\n\n\t\t/* we then set the release_agent if necessary */\n\t\tif (cgns->notify_prog) {\n\t\t\tif (xcgroup_create(cgns, &cg, \"/\", 0, 0) ==\n\t\t\t     XCGROUP_ERROR)\n\t\t\t\treturn XCGROUP_SUCCESS;\n\t\t\txcgroup_set_param(&cg, \"release_agent\",\n\t\t\t\t\t  cgns->notify_prog);\n\t\t\txcgroup_destroy(&cg);\n\t\t}\n\t\treturn XCGROUP_SUCCESS;\n\t}\n}"
  },
  {
    "function_name": "xcgroup_ns_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "133-139",
    "snippet": "void xcgroup_ns_destroy(xcgroup_ns_t* cgns)\n{\n\txfree(cgns->mnt_point);\n\txfree(cgns->mnt_args);\n\txfree(cgns->subsystems);\n\txfree(cgns->notify_prog);\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "cgns->notify_prog"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nvoid xcgroup_ns_destroy(xcgroup_ns_t* cgns)\n{\n\txfree(cgns->mnt_point);\n\txfree(cgns->mnt_args);\n\txfree(cgns->subsystems);\n\txfree(cgns->notify_prog);\n}"
  },
  {
    "function_name": "xcgroup_ns_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
    "lines": "97-128",
    "snippet": "int xcgroup_ns_create(slurm_cgroup_conf_t *conf,\n\t\t      xcgroup_ns_t *cgns, char *mnt_args, char *subsys) {\n\n\tcgns->mnt_point = xstrdup_printf(\"%s/%s\",\n\t\t\t\t\t conf->cgroup_mountpoint, subsys);\n\tcgns->mnt_args = xstrdup(mnt_args);\n\tcgns->subsystems = xstrdup(subsys);\n\tcgns->notify_prog = xstrdup_printf(\"%s/release_%s\",\n\t\t\t\t\t   conf->cgroup_release_agent, subsys);\n\n\t/* check that freezer cgroup namespace is available */\n\tif (!xcgroup_ns_is_available(cgns)) {\n\t\tif (conf->cgroup_automount) {\n\t\t\tif (xcgroup_ns_mount(cgns)) {\n\t\t\t\terror(\"unable to mount %s cgroup \"\n\t\t\t\t      \"namespace: %s\",\n\t\t\t\t      subsys, slurm_strerror(errno));\n\t\t\t\tgoto clean;\n\t\t\t}\n\t\t\tinfo(\"cgroup namespace '%s' is now mounted\", subsys);\n\t\t} else {\n\t\t\terror(\"cgroup namespace '%s' not mounted. aborting\",\n\t\t\t      subsys);\n\t\t\tgoto clean;\n\t\t}\n\t}\n\n\treturn XCGROUP_SUCCESS;\nclean:\n\txcgroup_ns_destroy(cgns);\n\treturn XCGROUP_ERROR;\n}",
    "includes": [
      "#include \"xcgroup.h\"",
      "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/log.h\"",
      "#include \"slurm/slurm_errno.h\"",
      "#include \"slurm/slurm.h\"",
      "#include <sys/mount.h>",
      "#include <dirent.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/file.h>",
      "#  include <inttypes.h>",
      "#  include <stdint.h>",
      "#   include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcgroup_ns_destroy",
          "args": [
            "cgns"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_ns_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "133-139",
          "snippet": "void xcgroup_ns_destroy(xcgroup_ns_t* cgns)\n{\n\txfree(cgns->mnt_point);\n\txfree(cgns->mnt_args);\n\txfree(cgns->subsystems);\n\txfree(cgns->notify_prog);\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nvoid xcgroup_ns_destroy(xcgroup_ns_t* cgns)\n{\n\txfree(cgns->mnt_point);\n\txfree(cgns->mnt_args);\n\txfree(cgns->subsystems);\n\txfree(cgns->notify_prog);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"cgroup namespace '%s' not mounted. aborting\"",
            "subsys"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "_task_write_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/io.c",
          "lines": "641-650",
          "snippet": "static int\n_task_write_error(eio_obj_t *obj, List objs)\n{\n\tdebug4(\"Called _task_write_error, closing fd %d\", obj->fd);\n\n\tclose(obj->fd);\n\tobj->fd = -1;\n\n\treturn SLURM_SUCCESS;\n}",
          "includes": [
            "#include \"src/slurmd/slurmstepd/slurmstepd.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmstepd/io.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xsignal.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/write_labelled_message.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/net.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/io_hdr.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/eio.h\"",
            "#include \"src/common/cbuf.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <poll.h>",
            "#  include <utmp.h>",
            "#  include <pty.h>",
            "#  include <stdlib.h>",
            "#  include <string.h>",
            "#  include <unistd.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _client_readable(eio_obj_t *);",
            "static bool _client_writable(eio_obj_t *);",
            "static int  _client_read(eio_obj_t *, List);",
            "static int  _client_write(eio_obj_t *, List);",
            "static bool _local_file_writable(eio_obj_t *);",
            "static int  _local_file_write(eio_obj_t *, List);",
            "static bool _task_writable(eio_obj_t *);",
            "static int  _task_write(eio_obj_t *, List);",
            "static int _task_write_error(eio_obj_t *obj, List objs);",
            "static bool _task_readable(eio_obj_t *);",
            "static int  _task_read(eio_obj_t *, List);",
            "static void _route_msg_task_to_client(eio_obj_t *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmstepd/slurmstepd.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmstepd/io.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xsignal.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/write_labelled_message.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/net.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/io_hdr.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/eio.h\"\n#include \"src/common/cbuf.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <poll.h>\n#  include <utmp.h>\n#  include <pty.h>\n#  include <stdlib.h>\n#  include <string.h>\n#  include <unistd.h>\n#  include \"config.h\"\n\nstatic bool _client_readable(eio_obj_t *);\nstatic bool _client_writable(eio_obj_t *);\nstatic int  _client_read(eio_obj_t *, List);\nstatic int  _client_write(eio_obj_t *, List);\nstatic bool _local_file_writable(eio_obj_t *);\nstatic int  _local_file_write(eio_obj_t *, List);\nstatic bool _task_writable(eio_obj_t *);\nstatic int  _task_write(eio_obj_t *, List);\nstatic int _task_write_error(eio_obj_t *obj, List objs);\nstatic bool _task_readable(eio_obj_t *);\nstatic int  _task_read(eio_obj_t *, List);\nstatic void _route_msg_task_to_client(eio_obj_t *obj);\n\nstatic int\n_task_write_error(eio_obj_t *obj, List objs)\n{\n\tdebug4(\"Called _task_write_error, closing fd %d\", obj->fd);\n\n\tclose(obj->fd);\n\tobj->fd = -1;\n\n\treturn SLURM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"cgroup namespace '%s' is now mounted\"",
            "subsys"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "xcpuinfo_mac_to_abs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcpuinfo.c",
          "lines": "1047-1051",
          "snippet": "int\nxcpuinfo_mac_to_abs(char* lrange,char** prange)\n{\n\treturn _ranges_conv(lrange,prange,1);\n}",
          "includes": [
            "#include \"xcpuinfo.h\"",
            "#include <hwloc.h>",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <ctype.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int _map_to_range(uint16_t *map, uint16_t map_size, char** prange);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xcpuinfo.h\"\n#include <hwloc.h>\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <ctype.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nstatic int _map_to_range(uint16_t *map, uint16_t map_size, char** prange);\n\nint\nxcpuinfo_mac_to_abs(char* lrange,char** prange)\n{\n\treturn _ranges_conv(lrange,prange,1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"unable to mount %s cgroup \"\n\t\t\t\t      \"namespace: %s\"",
            "subsys",
            "slurm_strerror(errno)"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slurm_strerror",
          "args": [
            "errno"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xcgroup_ns_mount",
          "args": [
            "cgns"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_ns_mount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "150-239",
          "snippet": "int xcgroup_ns_mount(xcgroup_ns_t* cgns)\n{\n\tint fstatus;\n\tchar* options;\n\tchar opt_combined[1024];\n\n\tchar* mnt_point;\n\tchar* p;\n\n\txcgroup_t cg;\n\n\tmode_t cmask;\n\tmode_t omask;\n\n\tcmask = S_IWGRP | S_IWOTH;\n\tomask = umask(cmask);\n\n\tfstatus = mkdir(cgns->mnt_point, 0755);\n\tif (fstatus && errno != EEXIST) {\n\t\tif (cgns->mnt_point[0] != '/') {\n\t\t\tdebug(\"unable to create cgroup ns directory '%s'\"\n\t\t\t      \" : do not start with '/'\", cgns->mnt_point);\n\t\t\tumask(omask);\n\t\t\treturn XCGROUP_ERROR;\n\t\t}\n\t\tmnt_point = xstrdup(cgns->mnt_point);\n\t\tp = mnt_point;\n\t\twhile ((p = index(p+1, '/')) != NULL) {\n\t\t\t*p = '\\0';\n\t\t\tfstatus = mkdir(mnt_point, 0755);\n\t\t\tif (fstatus && errno != EEXIST) {\n\t\t\t\tdebug(\"unable to create cgroup ns required \"\n\t\t\t\t      \"directory '%s'\", mnt_point);\n\t\t\t\txfree(mnt_point);\n\t\t\t\tumask(omask);\n\t\t\t\treturn XCGROUP_ERROR;\n\t\t\t}\n\t\t\t*p='/';\n\t\t}\n\t\txfree(mnt_point);\n\t\tfstatus = mkdir(cgns->mnt_point, 0755);\n\t}\n\n\tif (fstatus && errno != EEXIST) {\n\t\tdebug(\"unable to create cgroup ns directory '%s'\"\n\t\t      \" : %m\", cgns->mnt_point);\n\t\tumask(omask);\n\t\treturn XCGROUP_ERROR;\n\t}\n\tumask(omask);\n\n\tif (cgns->mnt_args == NULL ||\n\t    strlen(cgns->mnt_args) == 0)\n\t\toptions = cgns->subsystems;\n\telse {\n\t\tif (snprintf(opt_combined, sizeof(opt_combined), \"%s,%s\",\n\t\t\t     cgns->subsystems, cgns->mnt_args)\n\t\t    >= sizeof(opt_combined)) {\n\t\t\tdebug2(\"unable to build cgroup options string\");\n\t\t\treturn XCGROUP_ERROR;\n\t\t}\n\t\toptions = opt_combined;\n\t}\n\n#if defined(__FreeBSD__)\n\tif (mount(\"cgroup\", cgns->mnt_point,\n\t\t  MS_NOSUID|MS_NOEXEC|MS_NODEV, options))\n#else\n\tif (mount(\"cgroup\", cgns->mnt_point, \"cgroup\",\n\t\t  MS_NOSUID|MS_NOEXEC|MS_NODEV, options))\n#endif\n\t\treturn XCGROUP_ERROR;\n\telse {\n\t\t/* FIXME: this only gets set when we aren't mounted at\n\t\t   all.  Since we never umount this may only be loaded\n\t\t   at startup the first time.\n\t\t*/\n\n\t\t/* we then set the release_agent if necessary */\n\t\tif (cgns->notify_prog) {\n\t\t\tif (xcgroup_create(cgns, &cg, \"/\", 0, 0) ==\n\t\t\t     XCGROUP_ERROR)\n\t\t\t\treturn XCGROUP_SUCCESS;\n\t\t\txcgroup_set_param(&cg, \"release_agent\",\n\t\t\t\t\t  cgns->notify_prog);\n\t\t\txcgroup_destroy(&cg);\n\t\t}\n\t\treturn XCGROUP_SUCCESS;\n\t}\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_ns_mount(xcgroup_ns_t* cgns)\n{\n\tint fstatus;\n\tchar* options;\n\tchar opt_combined[1024];\n\n\tchar* mnt_point;\n\tchar* p;\n\n\txcgroup_t cg;\n\n\tmode_t cmask;\n\tmode_t omask;\n\n\tcmask = S_IWGRP | S_IWOTH;\n\tomask = umask(cmask);\n\n\tfstatus = mkdir(cgns->mnt_point, 0755);\n\tif (fstatus && errno != EEXIST) {\n\t\tif (cgns->mnt_point[0] != '/') {\n\t\t\tdebug(\"unable to create cgroup ns directory '%s'\"\n\t\t\t      \" : do not start with '/'\", cgns->mnt_point);\n\t\t\tumask(omask);\n\t\t\treturn XCGROUP_ERROR;\n\t\t}\n\t\tmnt_point = xstrdup(cgns->mnt_point);\n\t\tp = mnt_point;\n\t\twhile ((p = index(p+1, '/')) != NULL) {\n\t\t\t*p = '\\0';\n\t\t\tfstatus = mkdir(mnt_point, 0755);\n\t\t\tif (fstatus && errno != EEXIST) {\n\t\t\t\tdebug(\"unable to create cgroup ns required \"\n\t\t\t\t      \"directory '%s'\", mnt_point);\n\t\t\t\txfree(mnt_point);\n\t\t\t\tumask(omask);\n\t\t\t\treturn XCGROUP_ERROR;\n\t\t\t}\n\t\t\t*p='/';\n\t\t}\n\t\txfree(mnt_point);\n\t\tfstatus = mkdir(cgns->mnt_point, 0755);\n\t}\n\n\tif (fstatus && errno != EEXIST) {\n\t\tdebug(\"unable to create cgroup ns directory '%s'\"\n\t\t      \" : %m\", cgns->mnt_point);\n\t\tumask(omask);\n\t\treturn XCGROUP_ERROR;\n\t}\n\tumask(omask);\n\n\tif (cgns->mnt_args == NULL ||\n\t    strlen(cgns->mnt_args) == 0)\n\t\toptions = cgns->subsystems;\n\telse {\n\t\tif (snprintf(opt_combined, sizeof(opt_combined), \"%s,%s\",\n\t\t\t     cgns->subsystems, cgns->mnt_args)\n\t\t    >= sizeof(opt_combined)) {\n\t\t\tdebug2(\"unable to build cgroup options string\");\n\t\t\treturn XCGROUP_ERROR;\n\t\t}\n\t\toptions = opt_combined;\n\t}\n\n#if defined(__FreeBSD__)\n\tif (mount(\"cgroup\", cgns->mnt_point,\n\t\t  MS_NOSUID|MS_NOEXEC|MS_NODEV, options))\n#else\n\tif (mount(\"cgroup\", cgns->mnt_point, \"cgroup\",\n\t\t  MS_NOSUID|MS_NOEXEC|MS_NODEV, options))\n#endif\n\t\treturn XCGROUP_ERROR;\n\telse {\n\t\t/* FIXME: this only gets set when we aren't mounted at\n\t\t   all.  Since we never umount this may only be loaded\n\t\t   at startup the first time.\n\t\t*/\n\n\t\t/* we then set the release_agent if necessary */\n\t\tif (cgns->notify_prog) {\n\t\t\tif (xcgroup_create(cgns, &cg, \"/\", 0, 0) ==\n\t\t\t     XCGROUP_ERROR)\n\t\t\t\treturn XCGROUP_SUCCESS;\n\t\t\txcgroup_set_param(&cg, \"release_agent\",\n\t\t\t\t\t  cgns->notify_prog);\n\t\t\txcgroup_destroy(&cg);\n\t\t}\n\t\treturn XCGROUP_SUCCESS;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcgroup_ns_is_available",
          "args": [
            "cgns"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "xcgroup_ns_is_available",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/xcgroup.c",
          "lines": "264-285",
          "snippet": "int xcgroup_ns_is_available(xcgroup_ns_t* cgns)\n{\n\tint fstatus = 0;\n\tchar* value;\n\tsize_t s;\n\txcgroup_t cg;\n\n\tif (xcgroup_create(cgns, &cg, \"/\", 0, 0) == XCGROUP_ERROR)\n\t\treturn 0;\n\n\tif (xcgroup_get_param(&cg, \"release_agent\",\n\t\t\t      &value, &s) != XCGROUP_SUCCESS)\n\t\tfstatus = 0;\n\telse {\n\t\txfree(value);\n\t\tfstatus = 1;\n\t}\n\n\txcgroup_destroy(&cg);\n\n\treturn fstatus;\n}",
          "includes": [
            "#include \"xcgroup.h\"",
            "#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/log.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include \"slurm/slurm.h\"",
            "#include <sys/mount.h>",
            "#include <dirent.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/file.h>",
            "#  include <inttypes.h>",
            "#  include <stdint.h>",
            "#   include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_ns_is_available(xcgroup_ns_t* cgns)\n{\n\tint fstatus = 0;\n\tchar* value;\n\tsize_t s;\n\txcgroup_t cg;\n\n\tif (xcgroup_create(cgns, &cg, \"/\", 0, 0) == XCGROUP_ERROR)\n\t\treturn 0;\n\n\tif (xcgroup_get_param(&cg, \"release_agent\",\n\t\t\t      &value, &s) != XCGROUP_SUCCESS)\n\t\tfstatus = 0;\n\telse {\n\t\txfree(value);\n\t\tfstatus = 1;\n\t}\n\n\txcgroup_destroy(&cg);\n\n\treturn fstatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xstrdup_printf",
          "args": [
            "\"%s/release_%s\"",
            "conf->cgroup_release_agent",
            "subsys"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "subsys"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "mnt_args"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup_printf",
          "args": [
            "\"%s/%s\"",
            "conf->cgroup_mountpoint",
            "subsys"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xcgroup.h\"\n#include \"src/slurmd/slurmstepd/slurmstepd_job.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/log.h\"\n#include \"slurm/slurm_errno.h\"\n#include \"slurm/slurm.h\"\n#include <sys/mount.h>\n#include <dirent.h>\n#include <strings.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/file.h>\n#  include <inttypes.h>\n#  include <stdint.h>\n#   include \"config.h\"\n\nint xcgroup_ns_create(slurm_cgroup_conf_t *conf,\n\t\t      xcgroup_ns_t *cgns, char *mnt_args, char *subsys) {\n\n\tcgns->mnt_point = xstrdup_printf(\"%s/%s\",\n\t\t\t\t\t conf->cgroup_mountpoint, subsys);\n\tcgns->mnt_args = xstrdup(mnt_args);\n\tcgns->subsystems = xstrdup(subsys);\n\tcgns->notify_prog = xstrdup_printf(\"%s/release_%s\",\n\t\t\t\t\t   conf->cgroup_release_agent, subsys);\n\n\t/* check that freezer cgroup namespace is available */\n\tif (!xcgroup_ns_is_available(cgns)) {\n\t\tif (conf->cgroup_automount) {\n\t\t\tif (xcgroup_ns_mount(cgns)) {\n\t\t\t\terror(\"unable to mount %s cgroup \"\n\t\t\t\t      \"namespace: %s\",\n\t\t\t\t      subsys, slurm_strerror(errno));\n\t\t\t\tgoto clean;\n\t\t\t}\n\t\t\tinfo(\"cgroup namespace '%s' is now mounted\", subsys);\n\t\t} else {\n\t\t\terror(\"cgroup namespace '%s' not mounted. aborting\",\n\t\t\t      subsys);\n\t\t\tgoto clean;\n\t\t}\n\t}\n\n\treturn XCGROUP_SUCCESS;\nclean:\n\txcgroup_ns_destroy(cgns);\n\treturn XCGROUP_ERROR;\n}"
  }
]