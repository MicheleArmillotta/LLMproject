[
  {
    "function_name": "get_speed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
    "lines": "431-469",
    "snippet": "extern int\nget_speed(float *speed)\n{\n#if defined (__sun)\n\tkstat_ctl_t   *kc;\n\tkstat_t       *ksp;\n\tkstat_named_t *knp;\n\n\tkc = kstat_open();\n\tif (kc == NULL) {\n\t\terror (\"get speed: kstat error %d\", errno);\n\t\treturn errno;\n\t}\n\n\tksp = kstat_lookup(kc, \"cpu_info\", -1, NULL);\n\tkstat_read(kc, ksp, NULL);\n\tknp = kstat_data_lookup(ksp, \"clock_MHz\");\n\n\t*speed = knp->value.l;\n#else\n\tFILE *cpu_info_file;\n\tchar buffer[128];\n\tchar* _cpuinfo_path = \"/proc/cpuinfo\";\n\n\t*speed = 1.0;\n\tcpu_info_file = fopen(_cpuinfo_path, \"r\");\n\tif (cpu_info_file == NULL) {\n\t\terror(\"get_speed: error %d opening %s\", errno, _cpuinfo_path);\n\t\treturn errno;\n\t}\n\n\twhile (fgets(buffer, sizeof(buffer), cpu_info_file) != NULL) {\n\t\t_chk_cpuinfo_float(buffer, \"cpu MHz\", speed);\n\t}\n\n\tfclose(cpu_info_file);\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmctld/slurmctld.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include <unistd.h>",
      "# include <kstat.h>",
      "#  include <sys/vfs.h>",
      "#  include <sys/statfs.h>",
      "#  include <sys/statvfs.h>",
      "#include <sys/utsname.h>",
      "#  include <sys/sysinfo.h>",
      "#  include <sys/times.h> /* for times(3) */",
      "#  include <sys/types.h>",
      "#  include <sys/times.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "# include <sys/sysctl.h>",
      "#include <sys/types.h>",
      "# include <sys/dr.h>",
      "# include <sys/systemcfg.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "cpu_info_file"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_chk_cpuinfo_float",
          "args": [
            "buffer",
            "\"cpu MHz\"",
            "speed"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "_chk_cpuinfo_float",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "414-423",
          "snippet": "static int _chk_cpuinfo_float(char *buffer, char *keyword, float *val)\n{\n\tchar *valptr;\n\tif (_chk_cpuinfo_str(buffer, keyword, &valptr)) {\n\t\t*val = (float) strtod(valptr, (char **)NULL);\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nstatic int _chk_cpuinfo_float(char *buffer, char *keyword, float *val)\n{\n\tchar *valptr;\n\tif (_chk_cpuinfo_str(buffer, keyword, &valptr)) {\n\t\t*val = (float) strtod(valptr, (char **)NULL);\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fgets",
          "args": [
            "buffer",
            "sizeof(buffer)",
            "cpu_info_file"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"get_speed: error %d opening %s\"",
            "errno",
            "_cpuinfo_path"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "_cpuinfo_path",
            "\"r\""
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstat_data_lookup",
          "args": [
            "ksp",
            "\"clock_MHz\""
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstat_read",
          "args": [
            "kc",
            "ksp",
            "NULL"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstat_lookup",
          "args": [
            "kc",
            "\"cpu_info\"",
            "-1",
            "NULL"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"get speed: kstat error %d\"",
            "errno"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "_prolog_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "1386-1434",
          "snippet": "static void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _is_batch_job_finished(uint32_t job_id);",
            "static bool _job_still_running(uint32_t job_id);",
            "static void _launch_complete_add(uint32_t job_id);",
            "static void _launch_complete_log(char *type, uint32_t job_id);",
            "static void _launch_complete_rm(uint32_t job_id);",
            "static void _launch_complete_wait(uint32_t job_id);",
            "static bool _launch_job_test(uint32_t job_id);",
            "static void _note_batch_job_finished(uint32_t job_id);",
            "static bool _slurm_authorized_user(uid_t uid);",
            "static void _sync_messages_kill(kill_job_msg_t *req);",
            "static int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);",
            "static gids_t *_gids_cache_lookup(char *user, gid_t gid);",
            "static int  _add_starting_step(uint16_t type, void *req);",
            "static int  _remove_starting_step(uint16_t type, void *req);",
            "static void _add_job_running_prolog(uint32_t job_id);",
            "static void _remove_job_running_prolog(uint32_t job_id);",
            "static void _wait_for_job_running_prolog(uint32_t job_id);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic bool _is_batch_job_finished(uint32_t job_id);\nstatic bool _job_still_running(uint32_t job_id);\nstatic void _launch_complete_add(uint32_t job_id);\nstatic void _launch_complete_log(char *type, uint32_t job_id);\nstatic void _launch_complete_rm(uint32_t job_id);\nstatic void _launch_complete_wait(uint32_t job_id);\nstatic bool _launch_job_test(uint32_t job_id);\nstatic void _note_batch_job_finished(uint32_t job_id);\nstatic bool _slurm_authorized_user(uid_t uid);\nstatic void _sync_messages_kill(kill_job_msg_t *req);\nstatic int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);\nstatic gids_t *_gids_cache_lookup(char *user, gid_t gid);\nstatic int  _add_starting_step(uint16_t type, void *req);\nstatic int  _remove_starting_step(uint16_t type, void *req);\nstatic void _add_job_running_prolog(uint32_t job_id);\nstatic void _remove_job_running_prolog(uint32_t job_id);\nstatic void _wait_for_job_running_prolog(uint32_t job_id);\n\nstatic void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstat_open",
          "args": [],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int\nget_speed(float *speed)\n{\n#if defined (__sun)\n\tkstat_ctl_t   *kc;\n\tkstat_t       *ksp;\n\tkstat_named_t *knp;\n\n\tkc = kstat_open();\n\tif (kc == NULL) {\n\t\terror (\"get speed: kstat error %d\", errno);\n\t\treturn errno;\n\t}\n\n\tksp = kstat_lookup(kc, \"cpu_info\", -1, NULL);\n\tkstat_read(kc, ksp, NULL);\n\tknp = kstat_data_lookup(ksp, \"clock_MHz\");\n\n\t*speed = knp->value.l;\n#else\n\tFILE *cpu_info_file;\n\tchar buffer[128];\n\tchar* _cpuinfo_path = \"/proc/cpuinfo\";\n\n\t*speed = 1.0;\n\tcpu_info_file = fopen(_cpuinfo_path, \"r\");\n\tif (cpu_info_file == NULL) {\n\t\terror(\"get_speed: error %d opening %s\", errno, _cpuinfo_path);\n\t\treturn errno;\n\t}\n\n\twhile (fgets(buffer, sizeof(buffer), cpu_info_file) != NULL) {\n\t\t_chk_cpuinfo_float(buffer, \"cpu MHz\", speed);\n\t}\n\n\tfclose(cpu_info_file);\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "_chk_cpuinfo_float",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
    "lines": "414-423",
    "snippet": "static int _chk_cpuinfo_float(char *buffer, char *keyword, float *val)\n{\n\tchar *valptr;\n\tif (_chk_cpuinfo_str(buffer, keyword, &valptr)) {\n\t\t*val = (float) strtod(valptr, (char **)NULL);\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n}",
    "includes": [
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmctld/slurmctld.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include <unistd.h>",
      "# include <kstat.h>",
      "#  include <sys/vfs.h>",
      "#  include <sys/statfs.h>",
      "#  include <sys/statvfs.h>",
      "#include <sys/utsname.h>",
      "#  include <sys/sysinfo.h>",
      "#  include <sys/times.h> /* for times(3) */",
      "#  include <sys/types.h>",
      "#  include <sys/times.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "# include <sys/sysctl.h>",
      "#include <sys/types.h>",
      "# include <sys/dr.h>",
      "# include <sys/systemcfg.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtod",
          "args": [
            "valptr",
            "(char **)NULL"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_chk_cpuinfo_str",
          "args": [
            "buffer",
            "keyword",
            "&valptr"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "_chk_cpuinfo_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
          "lines": "393-404",
          "snippet": "static int _chk_cpuinfo_str(char *buffer, char *keyword, char **valptr)\n{\n\tchar *ptr;\n\tif (xstrncmp(buffer, keyword, strlen(keyword)))\n\t\treturn false;\n\n\tptr = strstr(buffer, \":\");\n\tif (ptr != NULL)\n\t\tptr++;\n\t*valptr = ptr;\n\treturn true;\n}",
          "includes": [
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/slurmctld/slurmctld.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/parse_spec.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include <unistd.h>",
            "# include <kstat.h>",
            "#  include <sys/vfs.h>",
            "#  include <sys/statfs.h>",
            "#  include <sys/statvfs.h>",
            "#include <sys/utsname.h>",
            "#  include <sys/sysinfo.h>",
            "#  include <sys/times.h> /* for times(3) */",
            "#  include <sys/types.h>",
            "#  include <sys/times.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "# include <sys/sysctl.h>",
            "#include <sys/types.h>",
            "# include <sys/dr.h>",
            "# include <sys/systemcfg.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nstatic int _chk_cpuinfo_str(char *buffer, char *keyword, char **valptr)\n{\n\tchar *ptr;\n\tif (xstrncmp(buffer, keyword, strlen(keyword)))\n\t\treturn false;\n\n\tptr = strstr(buffer, \":\");\n\tif (ptr != NULL)\n\t\tptr++;\n\t*valptr = ptr;\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nstatic int _chk_cpuinfo_float(char *buffer, char *keyword, float *val)\n{\n\tchar *valptr;\n\tif (_chk_cpuinfo_str(buffer, keyword, &valptr)) {\n\t\t*val = (float) strtod(valptr, (char **)NULL);\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n}"
  },
  {
    "function_name": "_chk_cpuinfo_str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
    "lines": "393-404",
    "snippet": "static int _chk_cpuinfo_str(char *buffer, char *keyword, char **valptr)\n{\n\tchar *ptr;\n\tif (xstrncmp(buffer, keyword, strlen(keyword)))\n\t\treturn false;\n\n\tptr = strstr(buffer, \":\");\n\tif (ptr != NULL)\n\t\tptr++;\n\t*valptr = ptr;\n\treturn true;\n}",
    "includes": [
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmctld/slurmctld.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include <unistd.h>",
      "# include <kstat.h>",
      "#  include <sys/vfs.h>",
      "#  include <sys/statfs.h>",
      "#  include <sys/statvfs.h>",
      "#include <sys/utsname.h>",
      "#  include <sys/sysinfo.h>",
      "#  include <sys/times.h> /* for times(3) */",
      "#  include <sys/types.h>",
      "#  include <sys/times.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "# include <sys/sysctl.h>",
      "#include <sys/types.h>",
      "# include <sys/dr.h>",
      "# include <sys/systemcfg.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "buffer",
            "\":\""
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrncmp",
          "args": [
            "buffer",
            "keyword",
            "strlen(keyword)"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "keyword"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nstatic int _chk_cpuinfo_str(char *buffer, char *keyword, char **valptr)\n{\n\tchar *ptr;\n\tif (xstrncmp(buffer, keyword, strlen(keyword)))\n\t\treturn false;\n\n\tptr = strstr(buffer, \":\");\n\tif (ptr != NULL)\n\t\tptr++;\n\t*valptr = ptr;\n\treturn true;\n}"
  },
  {
    "function_name": "get_free_mem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
    "lines": "365-382",
    "snippet": "extern int get_free_mem(uint32_t *free_mem)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__) || defined(__CYGWIN__)\n\t/* Not sure how to get CPU load on above systems.\n\t * Perhaps some method below works. */\n\t*free_mem = 0;\n#else\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*free_mem = 0;\n\t\treturn errno;\n\t}\n\n\t*free_mem = (((uint64_t )info.freeram)*info.mem_unit)/(1024*1024);\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmctld/slurmctld.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include <unistd.h>",
      "# include <kstat.h>",
      "#  include <sys/vfs.h>",
      "#  include <sys/statfs.h>",
      "#  include <sys/statvfs.h>",
      "#include <sys/utsname.h>",
      "#  include <sys/sysinfo.h>",
      "#  include <sys/times.h> /* for times(3) */",
      "#  include <sys/types.h>",
      "#  include <sys/times.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "# include <sys/sysctl.h>",
      "#include <sys/types.h>",
      "# include <sys/dr.h>",
      "# include <sys/systemcfg.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysinfo",
          "args": [
            "&info"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int get_free_mem(uint32_t *free_mem)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__) || defined(__CYGWIN__)\n\t/* Not sure how to get CPU load on above systems.\n\t * Perhaps some method below works. */\n\t*free_mem = 0;\n#else\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*free_mem = 0;\n\t\treturn errno;\n\t}\n\n\t*free_mem = (((uint64_t )info.freeram)*info.mem_unit)/(1024*1024);\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "get_cpu_load",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
    "lines": "327-363",
    "snippet": "extern int get_cpu_load(uint32_t *cpu_load)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\t/* Not sure how to get CPU load on above systems.\n\t * Perhaps some method below works. */\n\t*cpu_load = 0;\n#elif defined(__CYGWIN__)\n\tFILE *load_file;\n\tchar buffer[128];\n\tchar *space;\n\tchar *_load_path = \"/proc/loadavg\";\n\n\tif (!(load_file = fopen(_load_path, \"r\"))) {\n\t\terror(\"get_cpu_load: error %d opening %s\", errno, _load_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), load_file) &&\n\t    (space = strchr(buffer, ' '))) {\n\t\t*cpu_load = atof(space + 1) * 100.0;\n\t} else\n\t\t*cpu_load = 0;\n\n\tfclose(load_file);\n#else\n\tstruct sysinfo info;\n\tfloat shift_float = (float) (1 << SI_LOAD_SHIFT);\n\n\tif (sysinfo(&info) < 0) {\n\t\t*cpu_load = 0;\n\t\treturn errno;\n\t}\n\n\t*cpu_load = (info.loads[1] / shift_float) * 100.0;\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmctld/slurmctld.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include <unistd.h>",
      "# include <kstat.h>",
      "#  include <sys/vfs.h>",
      "#  include <sys/statfs.h>",
      "#  include <sys/statvfs.h>",
      "#include <sys/utsname.h>",
      "#  include <sys/sysinfo.h>",
      "#  include <sys/times.h> /* for times(3) */",
      "#  include <sys/types.h>",
      "#  include <sys/times.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "# include <sys/sysctl.h>",
      "#include <sys/types.h>",
      "# include <sys/dr.h>",
      "# include <sys/systemcfg.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysinfo",
          "args": [
            "&info"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "load_file"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atof",
          "args": [
            "space + 1"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "buffer",
            "' '"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fgets",
          "args": [
            "buffer",
            "sizeof(buffer)",
            "load_file"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"get_cpu_load: error %d opening %s\"",
            "errno",
            "_load_path"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "_load_path",
            "\"r\""
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int get_cpu_load(uint32_t *cpu_load)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\t/* Not sure how to get CPU load on above systems.\n\t * Perhaps some method below works. */\n\t*cpu_load = 0;\n#elif defined(__CYGWIN__)\n\tFILE *load_file;\n\tchar buffer[128];\n\tchar *space;\n\tchar *_load_path = \"/proc/loadavg\";\n\n\tif (!(load_file = fopen(_load_path, \"r\"))) {\n\t\terror(\"get_cpu_load: error %d opening %s\", errno, _load_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), load_file) &&\n\t    (space = strchr(buffer, ' '))) {\n\t\t*cpu_load = atof(space + 1) * 100.0;\n\t} else\n\t\t*cpu_load = 0;\n\n\tfclose(load_file);\n#else\n\tstruct sysinfo info;\n\tfloat shift_float = (float) (1 << SI_LOAD_SHIFT);\n\n\tif (sysinfo(&info) < 0) {\n\t\t*cpu_load = 0;\n\t\treturn errno;\n\t}\n\n\t*cpu_load = (info.loads[1] / shift_float) * 100.0;\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "get_up_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
    "lines": "274-325",
    "snippet": "extern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmctld/slurmctld.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include <unistd.h>",
      "# include <kstat.h>",
      "#  include <sys/vfs.h>",
      "#  include <sys/statfs.h>",
      "#  include <sys/statvfs.h>",
      "#include <sys/utsname.h>",
      "#  include <sys/sysinfo.h>",
      "#  include <sys/times.h> /* for times(3) */",
      "#  include <sys/types.h>",
      "#  include <sys/times.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "# include <sys/sysctl.h>",
      "#include <sys/types.h>",
      "# include <sys/dr.h>",
      "# include <sys/systemcfg.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysinfo",
          "args": [
            "&info"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "uptime_file"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "buffer"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fgets",
          "args": [
            "buffer",
            "sizeof(buffer)",
            "uptime_file"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"get_up_time: error %d opening %s\"",
            "errno",
            "_uptime_path"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "_uptime_path",
            "\"r\""
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysconf",
          "args": [
            "_SC_CLK_TCK"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "times",
          "args": [
            "&buf"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int get_up_time(uint32_t *up_time)\n{\n#if defined(HAVE_AIX) || defined(__sun) || defined(__APPLE__) || defined(__NetBSD__) || defined(__FreeBSD__)\n\tclock_t tm;\n\tstruct tms buf;\n\n\ttm = times(&buf);\n\tif (tm == (clock_t) -1) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\t*up_time = tm / sysconf(_SC_CLK_TCK);\n#elif defined(__CYGWIN__)\n\tFILE *uptime_file;\n\tchar buffer[128];\n\tchar* _uptime_path = \"/proc/uptime\";\n\n\tif (!(uptime_file = fopen(_uptime_path, \"r\"))) {\n\t\terror(\"get_up_time: error %d opening %s\", errno, _uptime_path);\n\t\treturn errno;\n\t}\n\n\tif (fgets(buffer, sizeof(buffer), uptime_file))\n\t\t*up_time = atoi(buffer);\n\n\tfclose(uptime_file);\n#else\n\t/* NOTE for Linux: The return value of times() may overflow the\n\t * possible range of type clock_t. There is also an offset of\n\t * 429 million seconds on some implementations. We just use the\n\t * simpler sysinfo() function instead. */\n\tstruct sysinfo info;\n\n\tif (sysinfo(&info) < 0) {\n\t\t*up_time = 0;\n\t\treturn errno;\n\t}\n\n\n\tif (conf->boot_time) {\n\t\t/* Make node look like it rebooted when slurmd started */\n\t\tstatic uint32_t orig_uptime = 0;\n\t\tif (orig_uptime == 0)\n\t\t\torig_uptime = info.uptime;\n\t\t*up_time = info.uptime - orig_uptime;\n\t} else {\n\t\t*up_time = info.uptime;\n\t}\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "get_memory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
    "lines": "171-204",
    "snippet": "extern int\nget_memory(uint32_t *real_memory)\n{\n#ifdef HAVE__SYSTEM_CONFIGURATION\n\t*real_memory = _system_configuration.physmem / (1024 * 1024);\n#else\n#  ifdef _SC_PHYS_PAGES\n\tlong pages;\n\n\t*real_memory = 1;\n\tpages = sysconf(_SC_PHYS_PAGES);\n\tif (pages < 1) {\n\t\terror (\"get_memory: error running sysconf(_SC_PHYS_PAGES)\");\n\t\treturn EINVAL;\n\t}\n\t*real_memory = (uint32_t)((float)pages * (sysconf(_SC_PAGE_SIZE) /\n\t\t\t1048576.0)); /* Megabytes of memory */\n#  else  /* !_SC_PHYS_PAGES */\n#    if HAVE_SYSCTLBYNAME\n\tint mem;\n\tsize_t len = sizeof(mem);\n\tif (sysctlbyname(\"hw.physmem\", &mem, &len, NULL, 0) == -1) {\n\t\terror(\"get_memory: error running sysctl(HW_PHYSMEM)\");\n\t\treturn EINVAL;\n\t}\n\t*real_memory = mem;\n#    else /* !HAVE_SYSCTLBYNAME */\n\t*real_memory = 1;\n#    endif /* HAVE_SYSCTLBYNAME */\n#  endif /* _SC_PHYS_PAGES */\n#endif /* HAVE__SYSTEM_CONFIGURATION */\n\n\treturn 0;\n}",
    "includes": [
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmctld/slurmctld.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include <unistd.h>",
      "# include <kstat.h>",
      "#  include <sys/vfs.h>",
      "#  include <sys/statfs.h>",
      "#  include <sys/statvfs.h>",
      "#include <sys/utsname.h>",
      "#  include <sys/sysinfo.h>",
      "#  include <sys/times.h> /* for times(3) */",
      "#  include <sys/types.h>",
      "#  include <sys/times.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "# include <sys/sysctl.h>",
      "#include <sys/types.h>",
      "# include <sys/dr.h>",
      "# include <sys/systemcfg.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"get_memory: error running sysctl(HW_PHYSMEM)\""
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysctlbyname",
          "args": [
            "\"hw.physmem\"",
            "&mem",
            "&len",
            "NULL",
            "0"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysconf",
          "args": [
            "_SC_PAGE_SIZE"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"get_memory: error running sysconf(_SC_PHYS_PAGES)\""
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysconf",
          "args": [
            "_SC_PHYS_PAGES"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nextern int\nget_memory(uint32_t *real_memory)\n{\n#ifdef HAVE__SYSTEM_CONFIGURATION\n\t*real_memory = _system_configuration.physmem / (1024 * 1024);\n#else\n#  ifdef _SC_PHYS_PAGES\n\tlong pages;\n\n\t*real_memory = 1;\n\tpages = sysconf(_SC_PHYS_PAGES);\n\tif (pages < 1) {\n\t\terror (\"get_memory: error running sysconf(_SC_PHYS_PAGES)\");\n\t\treturn EINVAL;\n\t}\n\t*real_memory = (uint32_t)((float)pages * (sysconf(_SC_PAGE_SIZE) /\n\t\t\t1048576.0)); /* Megabytes of memory */\n#  else  /* !_SC_PHYS_PAGES */\n#    if HAVE_SYSCTLBYNAME\n\tint mem;\n\tsize_t len = sizeof(mem);\n\tif (sysctlbyname(\"hw.physmem\", &mem, &len, NULL, 0) == -1) {\n\t\terror(\"get_memory: error running sysctl(HW_PHYSMEM)\");\n\t\treturn EINVAL;\n\t}\n\t*real_memory = mem;\n#    else /* !HAVE_SYSCTLBYNAME */\n\t*real_memory = 1;\n#    endif /* HAVE_SYSCTLBYNAME */\n#  endif /* _SC_PHYS_PAGES */\n#endif /* HAVE__SYSTEM_CONFIGURATION */\n\n\treturn 0;\n}"
  },
  {
    "function_name": "get_mach_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
    "lines": "152-162",
    "snippet": "extern int\nget_mach_name(char *node_name)\n{\n    int error_code;\n\n    error_code = gethostname_short(node_name, MAX_SLURM_NAME);\n    if (error_code != 0)\n\terror (\"get_mach_name: gethostname_short error %d\", error_code);\n\n    return error_code;\n}",
    "includes": [
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmctld/slurmctld.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include <unistd.h>",
      "# include <kstat.h>",
      "#  include <sys/vfs.h>",
      "#  include <sys/statfs.h>",
      "#  include <sys/statvfs.h>",
      "#include <sys/utsname.h>",
      "#  include <sys/sysinfo.h>",
      "#  include <sys/times.h> /* for times(3) */",
      "#  include <sys/types.h>",
      "#  include <sys/times.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "# include <sys/sysctl.h>",
      "#include <sys/types.h>",
      "# include <sys/dr.h>",
      "# include <sys/systemcfg.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int error_code = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"get_mach_name: gethostname_short error %d\"",
            "error_code"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "_prolog_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "1386-1434",
          "snippet": "static void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _is_batch_job_finished(uint32_t job_id);",
            "static bool _job_still_running(uint32_t job_id);",
            "static void _launch_complete_add(uint32_t job_id);",
            "static void _launch_complete_log(char *type, uint32_t job_id);",
            "static void _launch_complete_rm(uint32_t job_id);",
            "static void _launch_complete_wait(uint32_t job_id);",
            "static bool _launch_job_test(uint32_t job_id);",
            "static void _note_batch_job_finished(uint32_t job_id);",
            "static bool _slurm_authorized_user(uid_t uid);",
            "static void _sync_messages_kill(kill_job_msg_t *req);",
            "static int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);",
            "static gids_t *_gids_cache_lookup(char *user, gid_t gid);",
            "static int  _add_starting_step(uint16_t type, void *req);",
            "static int  _remove_starting_step(uint16_t type, void *req);",
            "static void _add_job_running_prolog(uint32_t job_id);",
            "static void _remove_job_running_prolog(uint32_t job_id);",
            "static void _wait_for_job_running_prolog(uint32_t job_id);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic bool _is_batch_job_finished(uint32_t job_id);\nstatic bool _job_still_running(uint32_t job_id);\nstatic void _launch_complete_add(uint32_t job_id);\nstatic void _launch_complete_log(char *type, uint32_t job_id);\nstatic void _launch_complete_rm(uint32_t job_id);\nstatic void _launch_complete_wait(uint32_t job_id);\nstatic bool _launch_job_test(uint32_t job_id);\nstatic void _note_batch_job_finished(uint32_t job_id);\nstatic bool _slurm_authorized_user(uid_t uid);\nstatic void _sync_messages_kill(kill_job_msg_t *req);\nstatic int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);\nstatic gids_t *_gids_cache_lookup(char *user, gid_t gid);\nstatic int  _add_starting_step(uint16_t type, void *req);\nstatic int  _remove_starting_step(uint16_t type, void *req);\nstatic void _add_job_running_prolog(uint32_t job_id);\nstatic void _remove_job_running_prolog(uint32_t job_id);\nstatic void _wait_for_job_running_prolog(uint32_t job_id);\n\nstatic void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gethostname_short",
          "args": [
            "node_name",
            "MAX_SLURM_NAME"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nint error_code = 0;\n\nextern int\nget_mach_name(char *node_name)\n{\n    int error_code;\n\n    error_code = gethostname_short(node_name, MAX_SLURM_NAME);\n    if (error_code != 0)\n\terror (\"get_mach_name: gethostname_short error %d\", error_code);\n\n    return error_code;\n}"
  },
  {
    "function_name": "get_os_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/get_mach_stat.c",
    "lines": "119-142",
    "snippet": "extern int\nget_os_name(char *os_name)\n{\n\tint error_code;\n\tstruct utsname sys_info;\n\n\tstrcpy(os_name, \"UNKNOWN\");\n\terror_code = uname(&sys_info);\n\tif (error_code != 0) {\n\t\terror (\"get_os_name: uname error %d\", error_code);\n\t\treturn error_code;\n\t}\n\n\tif ((strlen(sys_info.sysname) + strlen(sys_info.release) + 2) >=\n\t\tMAX_OS_LEN) {\n\t\terror (\"get_os_name: OS name too long\");\n\t\treturn error_code;\n\t}\n\n\tstrcpy(os_name, sys_info.sysname);\n\tstrcat(os_name, \".\");\n\tstrcat(os_name, sys_info.release);\n\treturn 0;\n}",
    "includes": [
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
      "#include \"src/slurmctld/slurmctld.h\"",
      "#include \"src/common/read_config.h\"",
      "#include \"src/common/parse_spec.h\"",
      "#include \"src/common/log.h\"",
      "#include \"src/common/hostlist.h\"",
      "#include <unistd.h>",
      "# include <kstat.h>",
      "#  include <sys/vfs.h>",
      "#  include <sys/statfs.h>",
      "#  include <sys/statvfs.h>",
      "#include <sys/utsname.h>",
      "#  include <sys/sysinfo.h>",
      "#  include <sys/times.h> /* for times(3) */",
      "#  include <sys/types.h>",
      "#  include <sys/times.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "# include <sys/sysctl.h>",
      "#include <sys/types.h>",
      "# include <sys/dr.h>",
      "# include <sys/systemcfg.h>",
      "#  include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int error_code = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "os_name",
            "sys_info.release"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "os_name",
            "\".\""
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "os_name",
            "sys_info.sysname"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"get_os_name: OS name too long\""
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "sys_info.release"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "sys_info.sysname"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"get_os_name: uname error %d\"",
            "error_code"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "_prolog_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmd/req.c",
          "lines": "1386-1434",
          "snippet": "static void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}",
          "includes": [
            "#include \"src/slurmd/common/task_plugin.h\"",
            "#include \"src/slurmd/common/slurmstepd_init.h\"",
            "#include \"src/slurmd/common/reverse_tree_math.h\"",
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/proctrack.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include \"src/slurmd/slurmd/get_mach_stat.h\"",
            "#include \"src/bcast/file_bcast.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/util-net.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/common/stepd_api.h\"",
            "#include \"src/common/slurm_strcasestr.h\"",
            "#include \"src/common/slurm_protocol_interface.h\"",
            "#include \"src/common/slurm_protocol_api.h\"",
            "#include \"src/common/slurm_protocol_defs.h\"",
            "#include \"src/common/slurm_jobacct_gather.h\"",
            "#include \"src/common/slurm_acct_gather_energy.h\"",
            "#include \"src/common/slurm_cred.h\"",
            "#include \"src/common/slurm_auth.h\"",
            "#include \"src/common/siphash.h\"",
            "#include \"src/common/read_config.h\"",
            "#include \"src/common/plugstack.h\"",
            "#include \"src/common/node_select.h\"",
            "#include \"src/common/node_features.h\"",
            "#include \"src/common/msg_aggr.h\"",
            "#include \"src/common/macros.h\"",
            "#include \"src/common/log.h\"",
            "#include \"src/common/list.h\"",
            "#include \"src/common/hostlist.h\"",
            "#include \"src/common/gres.h\"",
            "#include \"src/common/forward.h\"",
            "#include \"src/common/fd.h\"",
            "#include \"src/common/env.h\"",
            "#include \"src/common/cpu_frequency.h\"",
            "#include \"src/common/callerid.h\"",
            "#include <utime.h>",
            "#include <unistd.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <poll.h>",
            "#include <sys/param.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool _is_batch_job_finished(uint32_t job_id);",
            "static bool _job_still_running(uint32_t job_id);",
            "static void _launch_complete_add(uint32_t job_id);",
            "static void _launch_complete_log(char *type, uint32_t job_id);",
            "static void _launch_complete_rm(uint32_t job_id);",
            "static void _launch_complete_wait(uint32_t job_id);",
            "static bool _launch_job_test(uint32_t job_id);",
            "static void _note_batch_job_finished(uint32_t job_id);",
            "static bool _slurm_authorized_user(uid_t uid);",
            "static void _sync_messages_kill(kill_job_msg_t *req);",
            "static int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);",
            "static gids_t *_gids_cache_lookup(char *user, gid_t gid);",
            "static int  _add_starting_step(uint16_t type, void *req);",
            "static int  _remove_starting_step(uint16_t type, void *req);",
            "static void _add_job_running_prolog(uint32_t job_id);",
            "static void _remove_job_running_prolog(uint32_t job_id);",
            "static void _wait_for_job_running_prolog(uint32_t job_id);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/task_plugin.h\"\n#include \"src/slurmd/common/slurmstepd_init.h\"\n#include \"src/slurmd/common/reverse_tree_math.h\"\n#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/proctrack.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/bcast/file_bcast.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/util-net.h\"\n#include \"src/common/uid.h\"\n#include \"src/common/stepd_api.h\"\n#include \"src/common/slurm_strcasestr.h\"\n#include \"src/common/slurm_protocol_interface.h\"\n#include \"src/common/slurm_protocol_api.h\"\n#include \"src/common/slurm_protocol_defs.h\"\n#include \"src/common/slurm_jobacct_gather.h\"\n#include \"src/common/slurm_acct_gather_energy.h\"\n#include \"src/common/slurm_cred.h\"\n#include \"src/common/slurm_auth.h\"\n#include \"src/common/siphash.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/plugstack.h\"\n#include \"src/common/node_select.h\"\n#include \"src/common/node_features.h\"\n#include \"src/common/msg_aggr.h\"\n#include \"src/common/macros.h\"\n#include \"src/common/log.h\"\n#include \"src/common/list.h\"\n#include \"src/common/hostlist.h\"\n#include \"src/common/gres.h\"\n#include \"src/common/forward.h\"\n#include \"src/common/fd.h\"\n#include \"src/common/env.h\"\n#include \"src/common/cpu_frequency.h\"\n#include \"src/common/callerid.h\"\n#include <utime.h>\n#include <unistd.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <poll.h>\n#include <sys/param.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sched.h>\n#include <pthread.h>\n#include <grp.h>\n#include <fcntl.h>\n#  include \"config.h\"\n\nstatic bool _is_batch_job_finished(uint32_t job_id);\nstatic bool _job_still_running(uint32_t job_id);\nstatic void _launch_complete_add(uint32_t job_id);\nstatic void _launch_complete_log(char *type, uint32_t job_id);\nstatic void _launch_complete_rm(uint32_t job_id);\nstatic void _launch_complete_wait(uint32_t job_id);\nstatic bool _launch_job_test(uint32_t job_id);\nstatic void _note_batch_job_finished(uint32_t job_id);\nstatic bool _slurm_authorized_user(uid_t uid);\nstatic void _sync_messages_kill(kill_job_msg_t *req);\nstatic int  _valid_sbcast_cred(file_bcast_msg_t *req, uid_t req_uid,\n\t\t\t       uint16_t block_no, uint32_t *job_id);\nstatic gids_t *_gids_cache_lookup(char *user, gid_t gid);\nstatic int  _add_starting_step(uint16_t type, void *req);\nstatic int  _remove_starting_step(uint16_t type, void *req);\nstatic void _add_job_running_prolog(uint32_t job_id);\nstatic void _remove_job_running_prolog(uint32_t job_id);\nstatic void _wait_for_job_running_prolog(uint32_t job_id);\n\nstatic void\n_prolog_error(batch_job_launch_msg_t *req, int rc)\n{\n\tchar *err_name_ptr, err_name[256], path_name[MAXPATHLEN];\n\tchar *fmt_char;\n\tint fd;\n\n\tif (req->std_err || req->std_out) {\n\t\tif (req->std_err)\n\t\t\tstrncpy(err_name, req->std_err, sizeof(err_name));\n\t\telse\n\t\t\tstrncpy(err_name, req->std_out, sizeof(err_name));\n\t\tif ((fmt_char = strchr(err_name, (int) '%')) &&\n\t\t    (fmt_char[1] == 'j') && !strchr(fmt_char+1, (int) '%')) {\n\t\t\tchar tmp_name[256];\n\t\t\tfmt_char[1] = 'u';\n\t\t\tsnprintf(tmp_name, sizeof(tmp_name), err_name,\n\t\t\t\t req->job_id);\n\t\t\tstrncpy(err_name, tmp_name, sizeof(err_name));\n\t\t}\n\t} else {\n\t\tsnprintf(err_name, sizeof(err_name), \"slurm-%u.out\",\n\t\t\t req->job_id);\n\t}\n\terr_name_ptr = err_name;\n\tif (err_name_ptr[0] == '/')\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s\", err_name_ptr);\n\telse if (req->work_dir)\n\t\tsnprintf(path_name, MAXPATHLEN, \"%s/%s\",\n\t\t\treq->work_dir, err_name_ptr);\n\telse\n\t\tsnprintf(path_name, MAXPATHLEN, \"/%s\", err_name_ptr);\n\n\tif ((fd = open(path_name, (O_CREAT|O_APPEND|O_WRONLY), 0644)) == -1) {\n\t\terror(\"Unable to open %s: %s\", path_name,\n\t\t      slurm_strerror(errno));\n\t\treturn;\n\t}\n\tsnprintf(err_name, sizeof(err_name),\n\t\t \"Error running slurm prolog: %d\\n\", WEXITSTATUS(rc));\n\tsafe_write(fd, err_name, strlen(err_name));\n\tif (fchown(fd, (uid_t) req->uid, (gid_t) req->gid) == -1) {\n\t\tsnprintf(err_name, sizeof(err_name),\n\t\t\t \"Couldn't change fd owner to %u:%u: %m\\n\",\n\t\t\t req->uid, req->gid);\n\t}\nrwfail:\n\tclose(fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "uname",
          "args": [
            "&sys_info"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "os_name",
            "\"UNKNOWN\""
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/slurmd/slurmd/slurmd.h\"\n#include \"src/slurmd/slurmd/get_mach_stat.h\"\n#include \"src/slurmctld/slurmctld.h\"\n#include \"src/common/read_config.h\"\n#include \"src/common/parse_spec.h\"\n#include \"src/common/log.h\"\n#include \"src/common/hostlist.h\"\n#include <unistd.h>\n# include <kstat.h>\n#  include <sys/vfs.h>\n#  include <sys/statfs.h>\n#  include <sys/statvfs.h>\n#include <sys/utsname.h>\n#  include <sys/sysinfo.h>\n#  include <sys/times.h> /* for times(3) */\n#  include <sys/types.h>\n#  include <sys/times.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n# include <sys/sysctl.h>\n#include <sys/types.h>\n# include <sys/dr.h>\n# include <sys/systemcfg.h>\n#  include \"config.h\"\n\nint error_code = 0;\n\nextern int\nget_os_name(char *os_name)\n{\n\tint error_code;\n\tstruct utsname sys_info;\n\n\tstrcpy(os_name, \"UNKNOWN\");\n\terror_code = uname(&sys_info);\n\tif (error_code != 0) {\n\t\terror (\"get_os_name: uname error %d\", error_code);\n\t\treturn error_code;\n\t}\n\n\tif ((strlen(sys_info.sysname) + strlen(sys_info.release) + 2) >=\n\t\tMAX_OS_LEN) {\n\t\terror (\"get_os_name: OS name too long\");\n\t\treturn error_code;\n\t}\n\n\tstrcpy(os_name, sys_info.sysname);\n\tstrcat(os_name, \".\");\n\tstrcat(os_name, sys_info.release);\n\treturn 0;\n}"
  }
]