[
  {
    "function_name": "is_path_escaped",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/fname.c",
    "lines": "341-371",
    "snippet": "char *\nis_path_escaped(char *p)\n{\n\tchar *buf;\n\tbool t;\n\tint i;\n\n\tif (p == NULL)\n\t\treturn NULL;\n\n\tbuf = xmalloc((strlen(p) + 1) * sizeof(char));\n\tt = false;\n\ti = 0;\n\n\twhile (*p) {\n\t\tif (*p == '\\\\') {\n\t\t\tt = true;\n\t\t\t++p;\n\t\t\tcontinue;\n\t\t}\n\t\tbuf[i] = *p;\n\t\t++i;\n\t\t++p;\n\t}\n\n\tif (t == false) {\n\t\txfree(buf);\n\t\treturn NULL;\n\t}\n\treturn buf;\n}",
    "includes": [
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/xassert.h\"",
      "#include \"src/common/uid.h\"",
      "#include \"src/slurmd/slurmstepd/fname.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <ctype.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "buf"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "(strlen(p) + 1) * sizeof(char)"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "p"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/uid.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n\nchar *\nis_path_escaped(char *p)\n{\n\tchar *buf;\n\tbool t;\n\tint i;\n\n\tif (p == NULL)\n\t\treturn NULL;\n\n\tbuf = xmalloc((strlen(p) + 1) * sizeof(char));\n\tt = false;\n\ti = 0;\n\n\twhile (*p) {\n\t\tif (*p == '\\\\') {\n\t\t\tt = true;\n\t\t\t++p;\n\t\t\tcontinue;\n\t\t}\n\t\tbuf[i] = *p;\n\t\t++i;\n\t\t++p;\n\t}\n\n\tif (t == false) {\n\t\txfree(buf);\n\t\treturn NULL;\n\t}\n\treturn buf;\n}"
  },
  {
    "function_name": "fname_single_task_io",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/fname.c",
    "lines": "322-333",
    "snippet": "int fname_single_task_io (const char *fmt)\n{\n\tunsigned long taskid;\n\tchar *p;\n\n\ttaskid = strtoul (fmt, &p, 10);\n\n\tif (*p == '\\0')\n\t\treturn (int)taskid;\n\n\treturn -1;\n}",
    "includes": [
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/xassert.h\"",
      "#include \"src/common/uid.h\"",
      "#include \"src/slurmd/slurmstepd/fname.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <ctype.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);",
      "static char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);",
      "static char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "fmt",
            "&p",
            "10"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/uid.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n\nstatic void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);\nstatic char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);\nstatic char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);\n\nint fname_single_task_io (const char *fmt)\n{\n\tunsigned long taskid;\n\tchar *p;\n\n\ttaskid = strtoul (fmt, &p, 10);\n\n\tif (*p == '\\0')\n\t\treturn (int)taskid;\n\n\treturn -1;\n}"
  },
  {
    "function_name": "_batch_path_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/fname.c",
    "lines": "259-317",
    "snippet": "static void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid)\n{\n\n\tswitch (**p) {\n\tcase 'a':  /* '%a' => array task id   */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid,\n\t\t\t   job->array_task_id);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'A':  /* '%A' => array master job id */\n\t\txmemcat(*name, *q, *p - 1);\n\t\tif (job->array_task_id == NO_VAL)\n\t\t\txstrfmtcat(*name, \"%0*u\", wid, job->jobid);\n\t\telse\n\t\t\txstrfmtcat(*name, \"%0*u\",wid, job->array_job_id);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'J':  /* '%J' => jobid.stepid */\n\tcase 'j':  /* '%j' => jobid        */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, job->jobid);\n\t\tif ((**p == 'J') && (job->stepid != NO_VAL))\n\t\t\txstrfmtcat(*name, \".%u\", job->stepid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'n':  /* '%n' => nodeid         */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, job->nodeid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'N':  /* '%N' => node name      */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%s\", conf->hostname);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 's':  /* '%s' => step id        */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, job->stepid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 't':  /* '%t' => taskid         */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, taskid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'u':  /* '%u' => user name      */\n\t\tif (!job->user_name)\n\t\t\tjob->user_name = uid_to_string(job->uid);\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%s\", job->user_name);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/xassert.h\"",
      "#include \"src/common/uid.h\"",
      "#include \"src/slurmd/slurmstepd/fname.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <ctype.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);",
      "static char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);",
      "static char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\"%s\"",
            "job->user_name"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "*name",
            "*q",
            "*p - 1"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_to_string",
          "args": [
            "job->uid"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\"%0*u\"",
            "wid",
            "taskid"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "*name",
            "*q",
            "*p - 1"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\"%0*u\"",
            "wid",
            "job->stepid"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "*name",
            "*q",
            "*p - 1"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\"%s\"",
            "conf->hostname"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "*name",
            "*q",
            "*p - 1"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\"%0*u\"",
            "wid",
            "job->nodeid"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "*name",
            "*q",
            "*p - 1"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\".%u\"",
            "job->stepid"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\"%0*u\"",
            "wid",
            "job->jobid"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "*name",
            "*q",
            "*p - 1"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\"%0*u\"",
            "wid",
            "job->array_job_id"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\"%0*u\"",
            "wid",
            "job->jobid"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "*name",
            "*q",
            "*p - 1"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\"%0*u\"",
            "wid",
            "job->array_task_id"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "*name",
            "*q",
            "*p - 1"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/uid.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n\nstatic void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);\nstatic char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);\nstatic char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);\n\nstatic void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid)\n{\n\n\tswitch (**p) {\n\tcase 'a':  /* '%a' => array task id   */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid,\n\t\t\t   job->array_task_id);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'A':  /* '%A' => array master job id */\n\t\txmemcat(*name, *q, *p - 1);\n\t\tif (job->array_task_id == NO_VAL)\n\t\t\txstrfmtcat(*name, \"%0*u\", wid, job->jobid);\n\t\telse\n\t\t\txstrfmtcat(*name, \"%0*u\",wid, job->array_job_id);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'J':  /* '%J' => jobid.stepid */\n\tcase 'j':  /* '%j' => jobid        */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, job->jobid);\n\t\tif ((**p == 'J') && (job->stepid != NO_VAL))\n\t\t\txstrfmtcat(*name, \".%u\", job->stepid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'n':  /* '%n' => nodeid         */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, job->nodeid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'N':  /* '%N' => node name      */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%s\", conf->hostname);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 's':  /* '%s' => step id        */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, job->stepid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 't':  /* '%t' => taskid         */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, taskid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'u':  /* '%u' => user name      */\n\t\tif (!job->user_name)\n\t\t\tjob->user_name = uid_to_string(job->uid);\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%s\", job->user_name);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "_step_path_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/fname.c",
    "lines": "207-253",
    "snippet": "static void _step_path_check(char **p, char **q, char **name, unsigned int wid,\n\t\t\t     bool double_p, stepd_step_rec_t *job, int taskid,\n\t\t\t     int offset)\n{\n\tswitch (**p) {\n\tcase '%': /* This is in case there is a 3rd %, ie. %%% */\n\t\txmemcat(*name, *q, *p - 1);\n\t\t*q = *p;\n\t\tbreak;\n\tcase 't':  /* '%t' => taskid         */\n\t\txmemcat(*name, *q, *p - offset);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%0*u\", wid, taskid);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tcase 'n':  /* '%n' => nodeid         */\n\t\txmemcat(*name, *q, *p - offset);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%0*u\", wid, job->nodeid);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tcase 'N':  /* '%N' => node name      */\n\t\txmemcat(*name, *q, *p - offset);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%s\", conf->hostname);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tcase 'u':  /* '%u' => user name      */\n\t\tif (!job->user_name)\n\t\t\tjob->user_name = uid_to_string(job->uid);\n\t\txmemcat(*name, *q, *p - 1);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%s\", job->user_name);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/xassert.h\"",
      "#include \"src/common/uid.h\"",
      "#include \"src/slurmd/slurmstepd/fname.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <ctype.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);",
      "static char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);",
      "static char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);",
      "static void _step_path_check(char **p, char **q, char **name, unsigned int wid,\n\t\t\t     bool double_p, stepd_step_rec_t *job, int taskid,\n\t\t\t     int offset);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\"%s\"",
            "job->user_name"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "*name",
            "*q",
            "*p - 1"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_to_string",
          "args": [
            "job->uid"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\"%s\"",
            "conf->hostname"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "*name",
            "*q",
            "*p - offset"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\"%0*u\"",
            "wid",
            "job->nodeid"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "*name",
            "*q",
            "*p - offset"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrfmtcat",
          "args": [
            "*name",
            "\"%0*u\"",
            "wid",
            "taskid"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "*name",
            "*q",
            "*p - offset"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "*name",
            "*q",
            "*p - 1"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/uid.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n\nstatic void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);\nstatic char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);\nstatic char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);\nstatic void _step_path_check(char **p, char **q, char **name, unsigned int wid,\n\t\t\t     bool double_p, stepd_step_rec_t *job, int taskid,\n\t\t\t     int offset);\n\nstatic void _step_path_check(char **p, char **q, char **name, unsigned int wid,\n\t\t\t     bool double_p, stepd_step_rec_t *job, int taskid,\n\t\t\t     int offset)\n{\n\tswitch (**p) {\n\tcase '%': /* This is in case there is a 3rd %, ie. %%% */\n\t\txmemcat(*name, *q, *p - 1);\n\t\t*q = *p;\n\t\tbreak;\n\tcase 't':  /* '%t' => taskid         */\n\t\txmemcat(*name, *q, *p - offset);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%0*u\", wid, taskid);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tcase 'n':  /* '%n' => nodeid         */\n\t\txmemcat(*name, *q, *p - offset);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%0*u\", wid, job->nodeid);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tcase 'N':  /* '%N' => node name      */\n\t\txmemcat(*name, *q, *p - offset);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%s\", conf->hostname);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tcase 'u':  /* '%u' => user name      */\n\t\tif (!job->user_name)\n\t\t\tjob->user_name = uid_to_string(job->uid);\n\t\txmemcat(*name, *q, *p - 1);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%s\", job->user_name);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "_create_step_fname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/fname.c",
    "lines": "157-201",
    "snippet": "static char *_create_step_fname (char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid)\n{\n\n\tunsigned int wid   = 0;\n\tchar *p, *q;\n\tbool double_p = false;\n\tint str_offset = 1;\n\n\tq = p = path;\n\twhile (*p != '\\0') {\n\t\tif (*p == '%') {\n\t\t\tif (*(p+1) == '%') {\n\t\t\t\tp++;\n\t\t\t\tdouble_p = true;\n\t\t\t}\n\n\t\t\tif (isdigit(*(++p))) {\n\t\t\t\tunsigned long in_width = 0;\n\t\t\t\tif ((in_width = strtoul(p, &p, 10)) ==\n\t\t\t\t    MAX_WIDTH) {\n\t\t\t\t\t/* Remove % and double digit 10 */\n\t\t\t\t\tstr_offset = 3;\n\t\t\t\t} else\n\t\t\t\t\tstr_offset = 2;\n\t\t\t\twid = (unsigned int)in_width;\n\t\t\t\tif (*p == '\\0')\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t\t_step_path_check(&p, &q, &name, wid, double_p,\n\t\t\t\t\t job, taskid, str_offset);\n\t\t\twid = 0;\n\t\t} else\n\t\t\tp++;\n\t\tdouble_p = false;\n\t\tstr_offset = 1;\n\n\t}\n\n\tif (q != p)\n\t\txmemcat(name, q, p);\n\n\treturn name;\n}",
    "includes": [
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/xassert.h\"",
      "#include \"src/common/uid.h\"",
      "#include \"src/slurmd/slurmstepd/fname.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <ctype.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define MAX_WIDTH 10"
    ],
    "globals_used": [
      "static void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);",
      "static char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);",
      "static char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "name",
            "q",
            "p"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_step_path_check",
          "args": [
            "&p",
            "&q",
            "&name",
            "wid",
            "double_p",
            "job",
            "taskid",
            "str_offset"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "_step_path_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/fname.c",
          "lines": "207-253",
          "snippet": "static void _step_path_check(char **p, char **q, char **name, unsigned int wid,\n\t\t\t     bool double_p, stepd_step_rec_t *job, int taskid,\n\t\t\t     int offset)\n{\n\tswitch (**p) {\n\tcase '%': /* This is in case there is a 3rd %, ie. %%% */\n\t\txmemcat(*name, *q, *p - 1);\n\t\t*q = *p;\n\t\tbreak;\n\tcase 't':  /* '%t' => taskid         */\n\t\txmemcat(*name, *q, *p - offset);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%0*u\", wid, taskid);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tcase 'n':  /* '%n' => nodeid         */\n\t\txmemcat(*name, *q, *p - offset);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%0*u\", wid, job->nodeid);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tcase 'N':  /* '%N' => node name      */\n\t\txmemcat(*name, *q, *p - offset);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%s\", conf->hostname);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tcase 'u':  /* '%u' => user name      */\n\t\tif (!job->user_name)\n\t\t\tjob->user_name = uid_to_string(job->uid);\n\t\txmemcat(*name, *q, *p - 1);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%s\", job->user_name);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <ctype.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);",
            "static char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);",
            "static char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);",
            "static void _step_path_check(char **p, char **q, char **name, unsigned int wid,\n\t\t\t     bool double_p, stepd_step_rec_t *job, int taskid,\n\t\t\t     int offset);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/uid.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n\nstatic void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);\nstatic char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);\nstatic char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);\nstatic void _step_path_check(char **p, char **q, char **name, unsigned int wid,\n\t\t\t     bool double_p, stepd_step_rec_t *job, int taskid,\n\t\t\t     int offset);\n\nstatic void _step_path_check(char **p, char **q, char **name, unsigned int wid,\n\t\t\t     bool double_p, stepd_step_rec_t *job, int taskid,\n\t\t\t     int offset)\n{\n\tswitch (**p) {\n\tcase '%': /* This is in case there is a 3rd %, ie. %%% */\n\t\txmemcat(*name, *q, *p - 1);\n\t\t*q = *p;\n\t\tbreak;\n\tcase 't':  /* '%t' => taskid         */\n\t\txmemcat(*name, *q, *p - offset);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%0*u\", wid, taskid);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tcase 'n':  /* '%n' => nodeid         */\n\t\txmemcat(*name, *q, *p - offset);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%0*u\", wid, job->nodeid);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tcase 'N':  /* '%N' => node name      */\n\t\txmemcat(*name, *q, *p - offset);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%s\", conf->hostname);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tcase 'u':  /* '%u' => user name      */\n\t\tif (!job->user_name)\n\t\t\tjob->user_name = uid_to_string(job->uid);\n\t\txmemcat(*name, *q, *p - 1);\n\t\tif (!double_p) {\n\t\t\txstrfmtcat(*name, \"%s\", job->user_name);\n\t\t\t(*p)++;\n\t\t}\n\t\t*q = (*p)++;\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "p",
            "&p",
            "10"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*(++p)"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/uid.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n\n#define MAX_WIDTH 10\n\nstatic void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);\nstatic char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);\nstatic char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);\n\nstatic char *_create_step_fname (char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid)\n{\n\n\tunsigned int wid   = 0;\n\tchar *p, *q;\n\tbool double_p = false;\n\tint str_offset = 1;\n\n\tq = p = path;\n\twhile (*p != '\\0') {\n\t\tif (*p == '%') {\n\t\t\tif (*(p+1) == '%') {\n\t\t\t\tp++;\n\t\t\t\tdouble_p = true;\n\t\t\t}\n\n\t\t\tif (isdigit(*(++p))) {\n\t\t\t\tunsigned long in_width = 0;\n\t\t\t\tif ((in_width = strtoul(p, &p, 10)) ==\n\t\t\t\t    MAX_WIDTH) {\n\t\t\t\t\t/* Remove % and double digit 10 */\n\t\t\t\t\tstr_offset = 3;\n\t\t\t\t} else\n\t\t\t\t\tstr_offset = 2;\n\t\t\t\twid = (unsigned int)in_width;\n\t\t\t\tif (*p == '\\0')\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t\t_step_path_check(&p, &q, &name, wid, double_p,\n\t\t\t\t\t job, taskid, str_offset);\n\t\t\twid = 0;\n\t\t} else\n\t\t\tp++;\n\t\tdouble_p = false;\n\t\tstr_offset = 1;\n\n\t}\n\n\tif (q != p)\n\t\txmemcat(name, q, p);\n\n\treturn name;\n}"
  },
  {
    "function_name": "_create_batch_fname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/fname.c",
    "lines": "117-155",
    "snippet": "static char *_create_batch_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid)\n{\n\tunsigned int wid   = 0;\n\tchar *p, *q;\n\tq = p = path;\n\n\twhile (*p != '\\0') {\n\t\tif (*p == '%') {\n\t\t\tif (*(p+1) == '%') {\n\t\t\t\tp++;\n\t\t\t\txmemcat(name, q, p);\n\t\t\t\tq = ++p;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (isdigit(*(++p))) {\n\t\t\t\tunsigned long in_width = 0;\n\t\t\t\txmemcat(name, q, p - 1);\n\t\t\t\tif ((in_width = strtoul(p, &p, 10)) >\n\t\t\t\t    MAX_WIDTH) {\n\t\t\t\t\twid = MAX_WIDTH;\n\t\t\t\t} else\n\t\t\t\t\twid = (unsigned int)in_width;\n\t\t\t\tq = p - 1;\n\t\t\t\tif (*p == '\\0')\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t_batch_path_check(&p, &q, &name, wid, job, taskid);\n\t\t\twid = 0;\n\t\t} else\n\t\t\tp++;\n\t}\n\n\tif (q != p)\n\t\txmemcat(name, q, p);\n\n\treturn name;\n}",
    "includes": [
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/xassert.h\"",
      "#include \"src/common/uid.h\"",
      "#include \"src/slurmd/slurmstepd/fname.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <ctype.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define MAX_WIDTH 10"
    ],
    "globals_used": [
      "static void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);",
      "static char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);",
      "static char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "name",
            "q",
            "p"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_batch_path_check",
          "args": [
            "&p",
            "&q",
            "&name",
            "wid",
            "job",
            "taskid"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "_batch_path_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/fname.c",
          "lines": "259-317",
          "snippet": "static void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid)\n{\n\n\tswitch (**p) {\n\tcase 'a':  /* '%a' => array task id   */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid,\n\t\t\t   job->array_task_id);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'A':  /* '%A' => array master job id */\n\t\txmemcat(*name, *q, *p - 1);\n\t\tif (job->array_task_id == NO_VAL)\n\t\t\txstrfmtcat(*name, \"%0*u\", wid, job->jobid);\n\t\telse\n\t\t\txstrfmtcat(*name, \"%0*u\",wid, job->array_job_id);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'J':  /* '%J' => jobid.stepid */\n\tcase 'j':  /* '%j' => jobid        */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, job->jobid);\n\t\tif ((**p == 'J') && (job->stepid != NO_VAL))\n\t\t\txstrfmtcat(*name, \".%u\", job->stepid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'n':  /* '%n' => nodeid         */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, job->nodeid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'N':  /* '%N' => node name      */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%s\", conf->hostname);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 's':  /* '%s' => step id        */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, job->stepid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 't':  /* '%t' => taskid         */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, taskid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'u':  /* '%u' => user name      */\n\t\tif (!job->user_name)\n\t\t\tjob->user_name = uid_to_string(job->uid);\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%s\", job->user_name);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <ctype.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);",
            "static char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);",
            "static char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/uid.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n\nstatic void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);\nstatic char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);\nstatic char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);\n\nstatic void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid)\n{\n\n\tswitch (**p) {\n\tcase 'a':  /* '%a' => array task id   */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid,\n\t\t\t   job->array_task_id);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'A':  /* '%A' => array master job id */\n\t\txmemcat(*name, *q, *p - 1);\n\t\tif (job->array_task_id == NO_VAL)\n\t\t\txstrfmtcat(*name, \"%0*u\", wid, job->jobid);\n\t\telse\n\t\t\txstrfmtcat(*name, \"%0*u\",wid, job->array_job_id);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'J':  /* '%J' => jobid.stepid */\n\tcase 'j':  /* '%j' => jobid        */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, job->jobid);\n\t\tif ((**p == 'J') && (job->stepid != NO_VAL))\n\t\t\txstrfmtcat(*name, \".%u\", job->stepid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'n':  /* '%n' => nodeid         */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, job->nodeid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'N':  /* '%N' => node name      */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%s\", conf->hostname);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 's':  /* '%s' => step id        */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, job->stepid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 't':  /* '%t' => taskid         */\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%0*u\", wid, taskid);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tcase 'u':  /* '%u' => user name      */\n\t\tif (!job->user_name)\n\t\t\tjob->user_name = uid_to_string(job->uid);\n\t\txmemcat(*name, *q, *p - 1);\n\t\txstrfmtcat(*name, \"%s\", job->user_name);\n\t\t*q = ++(*p);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "p",
            "&p",
            "10"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "name",
            "q",
            "p - 1"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*(++p)"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmemcat",
          "args": [
            "name",
            "q",
            "p"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/uid.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n\n#define MAX_WIDTH 10\n\nstatic void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);\nstatic char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);\nstatic char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);\n\nstatic char *_create_batch_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid)\n{\n\tunsigned int wid   = 0;\n\tchar *p, *q;\n\tq = p = path;\n\n\twhile (*p != '\\0') {\n\t\tif (*p == '%') {\n\t\t\tif (*(p+1) == '%') {\n\t\t\t\tp++;\n\t\t\t\txmemcat(name, q, p);\n\t\t\t\tq = ++p;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (isdigit(*(++p))) {\n\t\t\t\tunsigned long in_width = 0;\n\t\t\t\txmemcat(name, q, p - 1);\n\t\t\t\tif ((in_width = strtoul(p, &p, 10)) >\n\t\t\t\t    MAX_WIDTH) {\n\t\t\t\t\twid = MAX_WIDTH;\n\t\t\t\t} else\n\t\t\t\t\twid = (unsigned int)in_width;\n\t\t\t\tq = p - 1;\n\t\t\t\tif (*p == '\\0')\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t_batch_path_check(&p, &q, &name, wid, job, taskid);\n\t\t\twid = 0;\n\t\t} else\n\t\t\tp++;\n\t}\n\n\tif (q != p)\n\t\txmemcat(name, q, p);\n\n\treturn name;\n}"
  },
  {
    "function_name": "fname_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/fname.c",
    "lines": "76-115",
    "snippet": "char *\nfname_create(stepd_step_rec_t *job, const char *format, int taskid)\n{\n\tchar *name = NULL;\n\tchar *orig = xstrdup(format);\n\tint id;\n\tchar *esc;\n\n\tif (((id = fname_single_task_io (format)) >= 0) && (taskid != id))\n\t\treturn (xstrdup (\"/dev/null\"));\n\n\tesc = is_path_escaped(orig);\n\n\t/* If format doesn't specify an absolute pathname, use cwd\n\t */\n\tif (orig[0] != '/') {\n\t\txstrcat(name, job->cwd);\n\t\tif (esc) {\n\t\t\txstrcat(name, esc);\n\t\t\tgoto fini;\n\t\t}\n\t\tif (name[strlen(name)-1] != '/')\n\t\t\txstrcatchar(name, '/');\n\t}\n\n\tif (esc) {\n\t\t/* esc is malloc */\n\t\tname = esc;\n\t\tgoto fini;\n\t}\n\n\tif (job->batch)\n\t\tname = _create_batch_fname(name, orig, job, taskid);\n\telse\n\t\tname = _create_step_fname(name, orig, job, taskid);\n\nfini:\n\txfree(orig);\n\treturn name;\n}",
    "includes": [
      "#include \"src/common/xstring.h\"",
      "#include \"src/common/xmalloc.h\"",
      "#include \"src/common/xassert.h\"",
      "#include \"src/common/uid.h\"",
      "#include \"src/slurmd/slurmstepd/fname.h\"",
      "#include \"src/slurmd/slurmd/slurmd.h\"",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <ctype.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);",
      "static char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);",
      "static char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "orig"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "_xfree_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/common/run_script.c",
          "lines": "167-170",
          "snippet": "static void _xfree_f (void *x)\n{\n\txfree (x);\n}",
          "includes": [
            "#include \"src/slurmd/common/run_script.h\"",
            "#include \"src/slurmd/common/job_container_plugin.h\"",
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/list.h\"",
            "#include \"slurm/slurm_errno.h\"",
            "#include <glob.h>",
            "#include <string.h>",
            "#include <sys/errno.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <poll.h>",
            "#  include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/slurmd/common/run_script.h\"\n#include \"src/slurmd/common/job_container_plugin.h\"\n#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/list.h\"\n#include \"slurm/slurm_errno.h\"\n#include <glob.h>\n#include <string.h>\n#include <sys/errno.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <poll.h>\n#  include \"config.h\"\n\nstatic void _xfree_f (void *x)\n{\n\txfree (x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_create_step_fname",
          "args": [
            "name",
            "orig",
            "job",
            "taskid"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "_create_step_fname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/fname.c",
          "lines": "157-201",
          "snippet": "static char *_create_step_fname (char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid)\n{\n\n\tunsigned int wid   = 0;\n\tchar *p, *q;\n\tbool double_p = false;\n\tint str_offset = 1;\n\n\tq = p = path;\n\twhile (*p != '\\0') {\n\t\tif (*p == '%') {\n\t\t\tif (*(p+1) == '%') {\n\t\t\t\tp++;\n\t\t\t\tdouble_p = true;\n\t\t\t}\n\n\t\t\tif (isdigit(*(++p))) {\n\t\t\t\tunsigned long in_width = 0;\n\t\t\t\tif ((in_width = strtoul(p, &p, 10)) ==\n\t\t\t\t    MAX_WIDTH) {\n\t\t\t\t\t/* Remove % and double digit 10 */\n\t\t\t\t\tstr_offset = 3;\n\t\t\t\t} else\n\t\t\t\t\tstr_offset = 2;\n\t\t\t\twid = (unsigned int)in_width;\n\t\t\t\tif (*p == '\\0')\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t\t_step_path_check(&p, &q, &name, wid, double_p,\n\t\t\t\t\t job, taskid, str_offset);\n\t\t\twid = 0;\n\t\t} else\n\t\t\tp++;\n\t\tdouble_p = false;\n\t\tstr_offset = 1;\n\n\t}\n\n\tif (q != p)\n\t\txmemcat(name, q, p);\n\n\treturn name;\n}",
          "includes": [
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <ctype.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define MAX_WIDTH 10"
          ],
          "globals_used": [
            "static void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);",
            "static char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);",
            "static char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/uid.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n\n#define MAX_WIDTH 10\n\nstatic void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);\nstatic char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);\nstatic char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);\n\nstatic char *_create_step_fname (char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid)\n{\n\n\tunsigned int wid   = 0;\n\tchar *p, *q;\n\tbool double_p = false;\n\tint str_offset = 1;\n\n\tq = p = path;\n\twhile (*p != '\\0') {\n\t\tif (*p == '%') {\n\t\t\tif (*(p+1) == '%') {\n\t\t\t\tp++;\n\t\t\t\tdouble_p = true;\n\t\t\t}\n\n\t\t\tif (isdigit(*(++p))) {\n\t\t\t\tunsigned long in_width = 0;\n\t\t\t\tif ((in_width = strtoul(p, &p, 10)) ==\n\t\t\t\t    MAX_WIDTH) {\n\t\t\t\t\t/* Remove % and double digit 10 */\n\t\t\t\t\tstr_offset = 3;\n\t\t\t\t} else\n\t\t\t\t\tstr_offset = 2;\n\t\t\t\twid = (unsigned int)in_width;\n\t\t\t\tif (*p == '\\0')\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t\t_step_path_check(&p, &q, &name, wid, double_p,\n\t\t\t\t\t job, taskid, str_offset);\n\t\t\twid = 0;\n\t\t} else\n\t\t\tp++;\n\t\tdouble_p = false;\n\t\tstr_offset = 1;\n\n\t}\n\n\tif (q != p)\n\t\txmemcat(name, q, p);\n\n\treturn name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_create_batch_fname",
          "args": [
            "name",
            "orig",
            "job",
            "taskid"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "_create_batch_fname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/fname.c",
          "lines": "117-155",
          "snippet": "static char *_create_batch_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid)\n{\n\tunsigned int wid   = 0;\n\tchar *p, *q;\n\tq = p = path;\n\n\twhile (*p != '\\0') {\n\t\tif (*p == '%') {\n\t\t\tif (*(p+1) == '%') {\n\t\t\t\tp++;\n\t\t\t\txmemcat(name, q, p);\n\t\t\t\tq = ++p;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (isdigit(*(++p))) {\n\t\t\t\tunsigned long in_width = 0;\n\t\t\t\txmemcat(name, q, p - 1);\n\t\t\t\tif ((in_width = strtoul(p, &p, 10)) >\n\t\t\t\t    MAX_WIDTH) {\n\t\t\t\t\twid = MAX_WIDTH;\n\t\t\t\t} else\n\t\t\t\t\twid = (unsigned int)in_width;\n\t\t\t\tq = p - 1;\n\t\t\t\tif (*p == '\\0')\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t_batch_path_check(&p, &q, &name, wid, job, taskid);\n\t\t\twid = 0;\n\t\t} else\n\t\t\tp++;\n\t}\n\n\tif (q != p)\n\t\txmemcat(name, q, p);\n\n\treturn name;\n}",
          "includes": [
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <ctype.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define MAX_WIDTH 10"
          ],
          "globals_used": [
            "static void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);",
            "static char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);",
            "static char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/uid.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n\n#define MAX_WIDTH 10\n\nstatic void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);\nstatic char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);\nstatic char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);\n\nstatic char *_create_batch_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid)\n{\n\tunsigned int wid   = 0;\n\tchar *p, *q;\n\tq = p = path;\n\n\twhile (*p != '\\0') {\n\t\tif (*p == '%') {\n\t\t\tif (*(p+1) == '%') {\n\t\t\t\tp++;\n\t\t\t\txmemcat(name, q, p);\n\t\t\t\tq = ++p;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (isdigit(*(++p))) {\n\t\t\t\tunsigned long in_width = 0;\n\t\t\t\txmemcat(name, q, p - 1);\n\t\t\t\tif ((in_width = strtoul(p, &p, 10)) >\n\t\t\t\t    MAX_WIDTH) {\n\t\t\t\t\twid = MAX_WIDTH;\n\t\t\t\t} else\n\t\t\t\t\twid = (unsigned int)in_width;\n\t\t\t\tq = p - 1;\n\t\t\t\tif (*p == '\\0')\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t_batch_path_check(&p, &q, &name, wid, job, taskid);\n\t\t\twid = 0;\n\t\t} else\n\t\t\tp++;\n\t}\n\n\tif (q != p)\n\t\txmemcat(name, q, p);\n\n\treturn name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xstrcatchar",
          "args": [
            "name",
            "'/'"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrcat",
          "args": [
            "name",
            "esc"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrcat",
          "args": [
            "name",
            "job->cwd"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_path_escaped",
          "args": [
            "orig"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "is_path_escaped",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/fname.c",
          "lines": "341-371",
          "snippet": "char *\nis_path_escaped(char *p)\n{\n\tchar *buf;\n\tbool t;\n\tint i;\n\n\tif (p == NULL)\n\t\treturn NULL;\n\n\tbuf = xmalloc((strlen(p) + 1) * sizeof(char));\n\tt = false;\n\ti = 0;\n\n\twhile (*p) {\n\t\tif (*p == '\\\\') {\n\t\t\tt = true;\n\t\t\t++p;\n\t\t\tcontinue;\n\t\t}\n\t\tbuf[i] = *p;\n\t\t++i;\n\t\t++p;\n\t}\n\n\tif (t == false) {\n\t\txfree(buf);\n\t\treturn NULL;\n\t}\n\treturn buf;\n}",
          "includes": [
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <ctype.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/uid.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n\nchar *\nis_path_escaped(char *p)\n{\n\tchar *buf;\n\tbool t;\n\tint i;\n\n\tif (p == NULL)\n\t\treturn NULL;\n\n\tbuf = xmalloc((strlen(p) + 1) * sizeof(char));\n\tt = false;\n\ti = 0;\n\n\twhile (*p) {\n\t\tif (*p == '\\\\') {\n\t\t\tt = true;\n\t\t\t++p;\n\t\t\tcontinue;\n\t\t}\n\t\tbuf[i] = *p;\n\t\t++i;\n\t\t++p;\n\t}\n\n\tif (t == false) {\n\t\txfree(buf);\n\t\treturn NULL;\n\t}\n\treturn buf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"/dev/null\""
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname_single_task_io",
          "args": [
            "format"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "fname_single_task_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-10030/repo/src/slurmd/slurmstepd/fname.c",
          "lines": "322-333",
          "snippet": "int fname_single_task_io (const char *fmt)\n{\n\tunsigned long taskid;\n\tchar *p;\n\n\ttaskid = strtoul (fmt, &p, 10);\n\n\tif (*p == '\\0')\n\t\treturn (int)taskid;\n\n\treturn -1;\n}",
          "includes": [
            "#include \"src/common/xstring.h\"",
            "#include \"src/common/xmalloc.h\"",
            "#include \"src/common/xassert.h\"",
            "#include \"src/common/uid.h\"",
            "#include \"src/slurmd/slurmstepd/fname.h\"",
            "#include \"src/slurmd/slurmd/slurmd.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <ctype.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);",
            "static char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);",
            "static char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/uid.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n\nstatic void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);\nstatic char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);\nstatic char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);\n\nint fname_single_task_io (const char *fmt)\n{\n\tunsigned long taskid;\n\tchar *p;\n\n\ttaskid = strtoul (fmt, &p, 10);\n\n\tif (*p == '\\0')\n\t\treturn (int)taskid;\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "format"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/common/xstring.h\"\n#include \"src/common/xmalloc.h\"\n#include \"src/common/xassert.h\"\n#include \"src/common/uid.h\"\n#include \"src/slurmd/slurmstepd/fname.h\"\n#include \"src/slurmd/slurmd/slurmd.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <ctype.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n\nstatic void _batch_path_check(char **p, char **q, char **name,\n\t\t\t      unsigned int wid, stepd_step_rec_t *job,\n\t\t\t      int taskid);\nstatic char * _create_batch_fname(char *name, char *path,\n\t\t\t\t  stepd_step_rec_t *job, int taskid);\nstatic char * _create_step_fname(char *name, char *path, stepd_step_rec_t *job,\n\t\t\t\t int taskid);\n\nchar *\nfname_create(stepd_step_rec_t *job, const char *format, int taskid)\n{\n\tchar *name = NULL;\n\tchar *orig = xstrdup(format);\n\tint id;\n\tchar *esc;\n\n\tif (((id = fname_single_task_io (format)) >= 0) && (taskid != id))\n\t\treturn (xstrdup (\"/dev/null\"));\n\n\tesc = is_path_escaped(orig);\n\n\t/* If format doesn't specify an absolute pathname, use cwd\n\t */\n\tif (orig[0] != '/') {\n\t\txstrcat(name, job->cwd);\n\t\tif (esc) {\n\t\t\txstrcat(name, esc);\n\t\t\tgoto fini;\n\t\t}\n\t\tif (name[strlen(name)-1] != '/')\n\t\t\txstrcatchar(name, '/');\n\t}\n\n\tif (esc) {\n\t\t/* esc is malloc */\n\t\tname = esc;\n\t\tgoto fini;\n\t}\n\n\tif (job->batch)\n\t\tname = _create_batch_fname(name, orig, job, taskid);\n\telse\n\t\tname = _create_step_fname(name, orig, job, taskid);\n\nfini:\n\txfree(orig);\n\treturn name;\n}"
  }
]