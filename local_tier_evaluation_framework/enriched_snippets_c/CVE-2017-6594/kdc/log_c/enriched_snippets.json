[
  {
    "function_name": "dc_log(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/log.c",
    "lines": "86-97",
    "snippet": "oid\nkdc_log(krb5_context context,\n\tkrb5_kdc_configuration *config,\n\tint level, const char *fmt, ...)\n{\n    va_list ap;\n    char *s;\n    va_start(ap, fmt);\n    s = kdc_log_msg_va(context, config, level, fmt, ap);\n    if(s) free(s);\n    va_end(ap);\n}",
    "includes": [
      "include \"kdc_locl.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a_end(",
          "args": [
            "p)"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ree(",
          "args": [
            ")"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dc_log_msg_va(",
          "args": [
            "ontext,",
            "onfig,",
            "evel,",
            "mt,",
            "p)"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "dc_log_msg_va(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/log.c",
          "lines": "63-71",
          "snippet": "har*\nkdc_log_msg_va(krb5_context context,\n\t       krb5_kdc_configuration *config,\n\t       int level, const char *fmt, va_list ap)\n{\n    char *msg;\n    krb5_vlog_msg(context, config->logf, &msg, level, fmt, ap);\n    return msg;\n}",
          "includes": [
            "include \"kdc_locl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"kdc_locl.h\"\n\nhar*\nkdc_log_msg_va(krb5_context context,\n\t       krb5_kdc_configuration *config,\n\t       int level, const char *fmt, va_list ap)\n{\n    char *msg;\n    krb5_vlog_msg(context, config->logf, &msg, level, fmt, ap);\n    return msg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "a_start(",
          "args": [
            "p,",
            "mt)"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"kdc_locl.h\"\n\noid\nkdc_log(krb5_context context,\n\tkrb5_kdc_configuration *config,\n\tint level, const char *fmt, ...)\n{\n    va_list ap;\n    char *s;\n    va_start(ap, fmt);\n    s = kdc_log_msg_va(context, config, level, fmt, ap);\n    if(s) free(s);\n    va_end(ap);\n}"
  },
  {
    "function_name": "dc_log_msg(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/log.c",
    "lines": "73-84",
    "snippet": "har*\nkdc_log_msg(krb5_context context,\n\t    krb5_kdc_configuration *config,\n\t    int level, const char *fmt, ...)\n{\n    va_list ap;\n    char *s;\n    va_start(ap, fmt);\n    s = kdc_log_msg_va(context, config, level, fmt, ap);\n    va_end(ap);\n    return s;\n}",
    "includes": [
      "include \"kdc_locl.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a_end(",
          "args": [
            "p)"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dc_log_msg_va(",
          "args": [
            "ontext,",
            "onfig,",
            "evel,",
            "mt,",
            "p)"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "dc_log_msg_va(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/log.c",
          "lines": "63-71",
          "snippet": "har*\nkdc_log_msg_va(krb5_context context,\n\t       krb5_kdc_configuration *config,\n\t       int level, const char *fmt, va_list ap)\n{\n    char *msg;\n    krb5_vlog_msg(context, config->logf, &msg, level, fmt, ap);\n    return msg;\n}",
          "includes": [
            "include \"kdc_locl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"kdc_locl.h\"\n\nhar*\nkdc_log_msg_va(krb5_context context,\n\t       krb5_kdc_configuration *config,\n\t       int level, const char *fmt, va_list ap)\n{\n    char *msg;\n    krb5_vlog_msg(context, config->logf, &msg, level, fmt, ap);\n    return msg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "a_start(",
          "args": [
            "p,",
            "mt)"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"kdc_locl.h\"\n\nhar*\nkdc_log_msg(krb5_context context,\n\t    krb5_kdc_configuration *config,\n\t    int level, const char *fmt, ...)\n{\n    va_list ap;\n    char *s;\n    va_start(ap, fmt);\n    s = kdc_log_msg_va(context, config, level, fmt, ap);\n    va_end(ap);\n    return s;\n}"
  },
  {
    "function_name": "dc_log_msg_va(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/log.c",
    "lines": "63-71",
    "snippet": "har*\nkdc_log_msg_va(krb5_context context,\n\t       krb5_kdc_configuration *config,\n\t       int level, const char *fmt, va_list ap)\n{\n    char *msg;\n    krb5_vlog_msg(context, config->logf, &msg, level, fmt, ap);\n    return msg;\n}",
    "includes": [
      "include \"kdc_locl.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb5_vlog_msg(",
          "args": [
            "ontext,",
            "onfig->logf,",
            "msg,",
            "evel,",
            "mt,",
            "p)"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"kdc_locl.h\"\n\nhar*\nkdc_log_msg_va(krb5_context context,\n\t       krb5_kdc_configuration *config,\n\t       int level, const char *fmt, va_list ap)\n{\n    char *msg;\n    krb5_vlog_msg(context, config->logf, &msg, level, fmt, ap);\n    return msg;\n}"
  },
  {
    "function_name": "dc_openlog(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/log.c",
    "lines": "38-61",
    "snippet": "oid\nkdc_openlog(krb5_context context,\n\t    const char *service,\n\t    krb5_kdc_configuration *config)\n{\n    char **s = NULL, **p;\n    krb5_initlog(context, \"kdc\", &config->logf);\n    s = krb5_config_get_strings(context, NULL, service, \"logging\", NULL);\n    if(s == NULL)\n\ts = krb5_config_get_strings(context, NULL, \"logging\", service, NULL);\n    if(s){\n\tfor(p = s; *p; p++)\n\t    krb5_addlog_dest(context, config->logf, *p);\n\tkrb5_config_free_strings(s);\n    }else {\n\tchar *ss;\n\tif (asprintf(&ss, \"0-1/FILE:%s/%s\", hdb_db_dir(context),\n\t    KDC_LOG_FILE) < 0)\n\t    err(1, \"out of memory\");\n\tkrb5_addlog_dest(context, config->logf, ss);\n\tfree(ss);\n    }\n    krb5_set_warn_dest(context, config->logf);\n}",
    "includes": [
      "include \"kdc_locl.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb5_set_warn_dest(",
          "args": [
            "ontext,",
            "onfig->logf)"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ree(",
          "args": [
            "s)"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_addlog_dest(",
          "args": [
            "ontext,",
            "onfig->logf,",
            "s)"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rr(",
          "args": [
            ",",
            "out of memory\")"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf(",
          "args": [
            "ss,",
            "0-1/FILE:%s/%s\",",
            "db_db_dir(context),",
            "DC_LOG_FILE)"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_db_dir(",
          "args": [
            "ontext)"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_config_free_strings(",
          "args": [
            ")"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_addlog_dest(",
          "args": [
            "ontext,",
            "onfig->logf,",
            "p)"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_config_get_strings(",
          "args": [
            "ontext,",
            "ULL,",
            "logging\",",
            "ervice,",
            "ULL)"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_config_get_strings(",
          "args": [
            "ontext,",
            "ULL,",
            "ervice,",
            "logging\",",
            "ULL)"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_initlog(",
          "args": [
            "ontext,",
            "kdc\",",
            "config->logf)"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"kdc_locl.h\"\n\noid\nkdc_openlog(krb5_context context,\n\t    const char *service,\n\t    krb5_kdc_configuration *config)\n{\n    char **s = NULL, **p;\n    krb5_initlog(context, \"kdc\", &config->logf);\n    s = krb5_config_get_strings(context, NULL, service, \"logging\", NULL);\n    if(s == NULL)\n\ts = krb5_config_get_strings(context, NULL, \"logging\", service, NULL);\n    if(s){\n\tfor(p = s; *p; p++)\n\t    krb5_addlog_dest(context, config->logf, *p);\n\tkrb5_config_free_strings(s);\n    }else {\n\tchar *ss;\n\tif (asprintf(&ss, \"0-1/FILE:%s/%s\", hdb_db_dir(context),\n\t    KDC_LOG_FILE) < 0)\n\t    err(1, \"out of memory\");\n\tkrb5_addlog_dest(context, config->logf, ss);\n\tfree(ss);\n    }\n    krb5_set_warn_dest(context, config->logf);\n}"
  }
]