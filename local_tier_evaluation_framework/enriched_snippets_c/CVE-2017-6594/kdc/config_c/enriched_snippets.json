[
  {
    "function_name": "onfigure(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/config.c",
    "lines": "154-307",
    "snippet": "rb5_kdc_configuration *\nconfigure(krb5_context context, int argc, char **argv, int *optidx)\n{\n    krb5_kdc_configuration *config;\n    krb5_error_code ret;\n    \n    const char *p;\n\n    *optidx = 0;\n\n    while (getarg(args, num_args, argc, argv, optidx))\n\twarnx(\"error at argument `%s'\", argv[*optidx]);\n\n    if (help_flag)\n\tusage (0);\n\n    if (version_flag) {\n\tprint_version(NULL);\n\texit(0);\n    }\n\n    if (builtin_hdb_flag) {\n\tchar *list;\n\tret = hdb_list_builtin(context, &list);\n\tif (ret)\n\t    krb5_err(context, 1, ret, \"listing builtin hdb backends\");\n\tprintf(\"builtin hdb backends: %s\\n\", list);\n\tfree(list);\n\texit(0);\n    }\n\n    if(detach_from_console == -1)\n\tdetach_from_console = krb5_config_get_bool_default(context, NULL,\n\t\t\t\t\t\t\t   FALSE,\n\t\t\t\t\t\t\t   \"kdc\",\n\t\t\t\t\t\t\t   \"detach\", NULL);\n\n    if (detach_from_console && daemon_child == -1)\n        roken_detach_prep(argc, argv, \"--daemon-child\");\n\n    {\n\tchar **files;\n\tint aret;\n\n\tif (config_file == NULL) {\n\t    aret = asprintf(&config_file, \"%s/kdc.conf\", hdb_db_dir(context));\n\t    if (aret == -1 || config_file == NULL)\n\t\terrx(1, \"out of memory\");\n\t}\n\n\tret = krb5_prepend_config_files_default(config_file, &files);\n\tif (ret)\n\t    krb5_err(context, 1, ret, \"getting configuration files\");\n\n\tret = krb5_set_config_files(context, files);\n\tkrb5_free_config_files(files);\n\tif(ret)\n\t    krb5_err(context, 1, ret, \"reading configuration files\");\n    }\n\n    ret = krb5_kdc_get_config(context, &config);\n    if (ret)\n\tkrb5_err(context, 1, ret, \"krb5_kdc_default_config\");\n\n    kdc_openlog(context, \"kdc\", config);\n\n    ret = krb5_kdc_set_dbinfo(context, config);\n    if (ret)\n\tkrb5_err(context, 1, ret, \"krb5_kdc_set_dbinfo\");\n\n    if(max_request_str)\n\tmax_request_tcp = max_request_udp = parse_bytes(max_request_str, NULL);\n\n    if(max_request_tcp == 0){\n\tp = krb5_config_get_string (context,\n\t\t\t\t    NULL,\n\t\t\t\t    \"kdc\",\n\t\t\t\t    \"max-request\",\n\t\t\t\t    NULL);\n\tif(p)\n\t    max_request_tcp = max_request_udp = parse_bytes(p, NULL);\n    }\n\n    if(require_preauth != -1)\n\tconfig->require_preauth = require_preauth;\n\n    if(port_str == NULL){\n\tp = krb5_config_get_string(context, NULL, \"kdc\", \"ports\", NULL);\n\tif (p != NULL)\n\t    port_str = strdup(p);\n    }\n\n    explicit_addresses.len = 0;\n\n    if (addresses_str.num_strings) {\n\tint i;\n\n\tfor (i = 0; i < addresses_str.num_strings; ++i)\n\t    add_one_address (context, addresses_str.strings[i], i == 0);\n\tfree_getarg_strings (&addresses_str);\n    } else {\n\tchar **foo = krb5_config_get_strings (context, NULL,\n\t\t\t\t\t      \"kdc\", \"addresses\", NULL);\n\n\tif (foo != NULL) {\n\t    add_one_address (context, *foo++, TRUE);\n\t    while (*foo)\n\t\tadd_one_address (context, *foo++, FALSE);\n\t}\n    }\n\n    if(enable_http == -1)\n\tenable_http = krb5_config_get_bool(context, NULL, \"kdc\",\n\t\t\t\t\t   \"enable-http\", NULL);\n\n    if(request_log == NULL)\n\trequest_log = krb5_config_get_string(context, NULL,\n\t\t\t\t\t     \"kdc\",\n\t\t\t\t\t     \"kdc-request-log\",\n\t\t\t\t\t     NULL);\n\n    if (krb5_config_get_string(context, NULL, \"kdc\",\n\t\t\t       \"enforce-transited-policy\", NULL))\n\tkrb5_errx(context, 1, \"enforce-transited-policy deprecated, \"\n\t\t  \"use [kdc]transited-policy instead\");\n\n    if(max_request_tcp == 0)\n\tmax_request_tcp = 64 * 1024;\n    if(max_request_udp == 0)\n\tmax_request_udp = 64 * 1024;\n\n    if (port_str == NULL)\n\tport_str = \"+\";\n\n    if(disable_des == -1)\n\tdisable_des = krb5_config_get_bool_default(context, NULL,\n\t\t\t\t\t\t   FALSE,\n\t\t\t\t\t\t   \"kdc\",\n\t\t\t\t\t\t   \"disable-des\", NULL);\n    if(disable_des) {\n\tkrb5_enctype_disable(context, ETYPE_DES_CBC_CRC);\n\tkrb5_enctype_disable(context, ETYPE_DES_CBC_MD4);\n\tkrb5_enctype_disable(context, ETYPE_DES_CBC_MD5);\n\tkrb5_enctype_disable(context, ETYPE_DES_CBC_NONE);\n\tkrb5_enctype_disable(context, ETYPE_DES_CFB64_NONE);\n\tkrb5_enctype_disable(context, ETYPE_DES_PCBC_NONE);\n    }\n\n    krb5_kdc_windc_init(context);\n\n    krb5_kdc_pkinit_config(context, config);\n\n    return config;\n}",
    "includes": [
      "include <parse_bytes.h>",
      "include <getarg.h>\n#",
      "include \"kdc_locl.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic char *config_file;",
      "tatic int require_preauth = -1;",
      "tatic char *max_request_str;",
      "tatic int disable_des = -1;",
      "tatic int builtin_hdb_flag;",
      "tatic int help_flag;",
      "tatic int version_flag;",
      "nt enable_http = -1;",
      "onst char *request_log;",
      "onst char *port_str;",
      "rb5_addresses explicit_addresses;",
      "ize_t max_request_udp;",
      "ize_t max_request_tcp;",
      "tatic struct getarg_strings addresses_str;",
      "tatic struct getargs args[] = {\n    {\n\t\"config-file\",\t'c',\targ_string,\t&config_file,\n\t\"location of config file\",\t\"file\"\n    },\n    {\n\t\"require-preauth\",\t'p',\targ_negative_flag, &require_preauth,\n\t\"don't require pa-data in as-reqs\", NULL\n    },\n    {\n\t\"max-request\",\t0,\targ_string, &max_request_str,\n\t\"max size for a kdc-request\", \"size\"\n    },\n    { \"enable-http\", 'H', arg_flag, &enable_http, \"turn on HTTP support\",\n   \t NULL },\n    {\t\"ports\",\t'P', \targ_string, rk_UNCONST(&port_str),\n\t\"ports to listen to\", \"portspec\"\n    },\n    {\n\t\"detach\",       0 ,      arg_flag, &detach_from_console,\n\t\"detach from console\", NULL\n    },\n    {\n        \"daemon-child\",       0 ,      arg_flag, &daemon_child,\n        \"private argument, do not use\", NULL\n    },\n#ifdef __APPLE__\n    {\n        \"bonjour\",       0 ,      arg_flag, &do_bonjour,\n        \"private argument, do not use\", NULL\n    },\n#endif\n    {\t\"addresses\",\t0,\targ_strings, &addresses_str,\n\t\"addresses to listen on\", \"list of addresses\" },\n    {\t\"disable-des\",\t0,\targ_flag, &disable_des,\n\t\"disable DES\", NULL },\n    {\t\"builtin-hdb\",\t0,\targ_flag,   &builtin_hdb_flag,\n\t\"list builtin hdb backends\", NULL},\n    {   \"runas-user\",\t0,\targ_string, &runas_string,\n\t\"run as this user when connected to network\", NULL\n    },\n    {   \"chroot\",\t0,\targ_string, &chroot_string,\n\t\"chroot directory to run in\", NULL\n    },\n    {\t\"testing\",\t0,\targ_flag,   &testing_flag, NULL, NULL },\n    {\t\"help\",\t\t'h',\targ_flag,   &help_flag, NULL, NULL },\n    {\t\"version\",\t'v',\targ_flag,   &version_flag, NULL, NULL }\n};",
      "tatic int num_args = sizeof(args) / sizeof(args[0]);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb5_kdc_pkinit_config(",
          "args": [
            "ontext,",
            "onfig)"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "rb5_kdc_pkinit_config(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/default_config.c",
          "lines": "264-299",
          "snippet": "rb5_error_code\nkrb5_kdc_pkinit_config(krb5_context context, krb5_kdc_configuration *config)\n{\n#ifdef PKINIT\n#ifdef __APPLE__\n    config->enable_pkinit = 1;\n\n    if (config->pkinit_kdc_identity == NULL) {\n\tif (config->pkinit_kdc_friendly_name == NULL)\n\t    config->pkinit_kdc_friendly_name =\n\t\tstrdup(\"O=System Identity,CN=com.apple.kerberos.kdc\");\n\tconfig->pkinit_kdc_identity = strdup(\"KEYCHAIN:\");\n    }\n    if (config->pkinit_kdc_anchors == NULL)\n\tconfig->pkinit_kdc_anchors = strdup(\"KEYCHAIN:\");\n\n#endif /* __APPLE__ */\n\n    if (config->enable_pkinit) {\n\tif (config->pkinit_kdc_identity == NULL)\n\t    krb5_errx(context, 1, \"pkinit enabled but no identity\");\n\n\tif (config->pkinit_kdc_anchors == NULL)\n\t    krb5_errx(context, 1, \"pkinit enabled but no X509 anchors\");\n\n\tkrb5_kdc_pk_initialize(context, config,\n\t\t\t       config->pkinit_kdc_identity,\n\t\t\t       config->pkinit_kdc_anchors,\n\t\t\t       config->pkinit_kdc_cert_pool,\n\t\t\t       config->pkinit_kdc_revoke);\n\n    }\n\n    return 0;\n#endif /* PKINIT */\n}",
          "includes": [
            "include <parse_bytes.h>",
            "include <getarg.h>\n#",
            "include \"kdc_locl.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <parse_bytes.h>\ninclude <getarg.h>\n#\ninclude \"kdc_locl.h\"\n#\n\nrb5_error_code\nkrb5_kdc_pkinit_config(krb5_context context, krb5_kdc_configuration *config)\n{\n#ifdef PKINIT\n#ifdef __APPLE__\n    config->enable_pkinit = 1;\n\n    if (config->pkinit_kdc_identity == NULL) {\n\tif (config->pkinit_kdc_friendly_name == NULL)\n\t    config->pkinit_kdc_friendly_name =\n\t\tstrdup(\"O=System Identity,CN=com.apple.kerberos.kdc\");\n\tconfig->pkinit_kdc_identity = strdup(\"KEYCHAIN:\");\n    }\n    if (config->pkinit_kdc_anchors == NULL)\n\tconfig->pkinit_kdc_anchors = strdup(\"KEYCHAIN:\");\n\n#endif /* __APPLE__ */\n\n    if (config->enable_pkinit) {\n\tif (config->pkinit_kdc_identity == NULL)\n\t    krb5_errx(context, 1, \"pkinit enabled but no identity\");\n\n\tif (config->pkinit_kdc_anchors == NULL)\n\t    krb5_errx(context, 1, \"pkinit enabled but no X509 anchors\");\n\n\tkrb5_kdc_pk_initialize(context, config,\n\t\t\t       config->pkinit_kdc_identity,\n\t\t\t       config->pkinit_kdc_anchors,\n\t\t\t       config->pkinit_kdc_cert_pool,\n\t\t\t       config->pkinit_kdc_revoke);\n\n    }\n\n    return 0;\n#endif /* PKINIT */\n}"
        }
      },
      {
        "call_info": {
          "callee": "rb5_kdc_windc_init(",
          "args": [
            "ontext)"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "rb5_kdc_windc_init(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/windc.c",
          "lines": "49-55",
          "snippet": "rb5_error_code\nkrb5_kdc_windc_init(krb5_context context)\n{\n    (void)_krb5_plugin_run_f(context, \"krb5\", \"windc\",\n\t\t\t     KRB5_WINDC_PLUGIN_MINOR, 0, NULL, load);\n    return 0;\n}",
          "includes": [
            "include \"kdc_locl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"kdc_locl.h\"\n\nrb5_error_code\nkrb5_kdc_windc_init(krb5_context context)\n{\n    (void)_krb5_plugin_run_f(context, \"krb5\", \"windc\",\n\t\t\t     KRB5_WINDC_PLUGIN_MINOR, 0, NULL, load);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rb5_enctype_disable(",
          "args": [
            "ontext,",
            "TYPE_DES_PCBC_NONE)"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_enctype_disable(",
          "args": [
            "ontext,",
            "TYPE_DES_CFB64_NONE)"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_enctype_disable(",
          "args": [
            "ontext,",
            "TYPE_DES_CBC_NONE)"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_enctype_disable(",
          "args": [
            "ontext,",
            "TYPE_DES_CBC_MD5)"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_enctype_disable(",
          "args": [
            "ontext,",
            "TYPE_DES_CBC_MD4)"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_enctype_disable(",
          "args": [
            "ontext,",
            "TYPE_DES_CBC_CRC)"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_config_get_bool_default(",
          "args": [
            "ontext,",
            "ULL,",
            "ALSE,",
            "kdc\",",
            "disable-des\",",
            "ULL)"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_errx(",
          "args": [
            "ontext,",
            ",",
            "enforce-transited-policy deprecated, \"\n\t\t  \"use [kdc]transited-policy instead\")"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_config_get_string(",
          "args": [
            "ontext,",
            "ULL,",
            "kdc\",",
            "enforce-transited-policy\",",
            "ULL)"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_config_get_string(",
          "args": [
            "ontext,",
            "ULL,",
            "kdc\",",
            "kdc-request-log\",",
            "ULL)"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_config_get_bool(",
          "args": [
            "ontext,",
            "ULL,",
            "kdc\",",
            "enable-http\",",
            "ULL)"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dd_one_address",
          "args": [
            "ontext,",
            "foo++,",
            "ALSE)"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "dd_one_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/config.c",
          "lines": "138-152",
          "snippet": "tatic void\nadd_one_address (krb5_context context, const char *str, int first)\n{\n    krb5_error_code ret;\n    krb5_addresses tmp;\n\n    ret = krb5_parse_address (context, str, &tmp);\n    if (ret)\n\tkrb5_err (context, 1, ret, \"parse_address `%s'\", str);\n    if (first)\n\tkrb5_copy_addresses(context, &tmp, &explicit_addresses);\n    else\n\tkrb5_append_addresses(context, &explicit_addresses, &tmp);\n    krb5_free_addresses (context, &tmp);\n}",
          "includes": [
            "include <parse_bytes.h>",
            "include <getarg.h>\n#",
            "include \"kdc_locl.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [
            "rb5_addresses explicit_addresses;"
          ],
          "called_functions": [],
          "contextual_snippet": "include <parse_bytes.h>\ninclude <getarg.h>\n#\ninclude \"kdc_locl.h\"\n#\n\nrb5_addresses explicit_addresses;\n\ntatic void\nadd_one_address (krb5_context context, const char *str, int first)\n{\n    krb5_error_code ret;\n    krb5_addresses tmp;\n\n    ret = krb5_parse_address (context, str, &tmp);\n    if (ret)\n\tkrb5_err (context, 1, ret, \"parse_address `%s'\", str);\n    if (first)\n\tkrb5_copy_addresses(context, &tmp, &explicit_addresses);\n    else\n\tkrb5_append_addresses(context, &explicit_addresses, &tmp);\n    krb5_free_addresses (context, &tmp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rb5_config_get_strings",
          "args": [
            "ontext,",
            "ULL,",
            "kdc\",",
            "addresses\",",
            "ULL)"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ree_getarg_strings",
          "args": [
            "addresses_str)"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trdup(",
          "args": [
            ")"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_config_get_string(",
          "args": [
            "ontext,",
            "ULL,",
            "kdc\",",
            "ports\",",
            "ULL)"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arse_bytes(",
          "args": [
            ",",
            "ULL)"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_config_get_string",
          "args": [
            "ontext,",
            "ULL,",
            "kdc\",",
            "max-request\",",
            "ULL)"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arse_bytes(",
          "args": [
            "ax_request_str,",
            "ULL)"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_err(",
          "args": [
            "ontext,",
            ",",
            "et,",
            "krb5_kdc_set_dbinfo\")"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_kdc_set_dbinfo(",
          "args": [
            "ontext,",
            "onfig)"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "rb5_kdc_set_dbinfo(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/set_dbinfo.c",
          "lines": "67-111",
          "snippet": "rb5_error_code\nkrb5_kdc_set_dbinfo(krb5_context context, struct krb5_kdc_configuration *c)\n{\n    struct hdb_dbinfo *info, *d;\n    krb5_error_code ret;\n    int i;\n\n    /* fetch the databases */\n    ret = hdb_get_dbinfo(context, &info);\n    if (ret)\n\treturn ret;\n\n    d = NULL;\n    while ((d = hdb_dbinfo_get_next(info, d)) != NULL) {\n\n\tret = add_db(context, c,\n\t\t     hdb_dbinfo_get_dbname(context, d),\n\t\t     hdb_dbinfo_get_mkey_file(context, d));\n\tif (ret)\n\t    goto out;\n\n\tkdc_log(context, c, 0, \"label: %s\",\n\t\thdb_dbinfo_get_label(context, d));\n\tkdc_log(context, c, 0, \"\\tdbname: %s\",\n\t\thdb_dbinfo_get_dbname(context, d));\n\tkdc_log(context, c, 0, \"\\tmkey_file: %s\",\n\t\thdb_dbinfo_get_mkey_file(context, d));\n\tkdc_log(context, c, 0, \"\\tacl_file: %s\",\n\t\thdb_dbinfo_get_acl_file(context, d));\n    }\n    hdb_free_dbinfo(context, &info);\n\n    return 0;\nout:\n    for (i = 0; i < c->num_db; i++)\n\tif (c->db[i] && c->db[i]->hdb_destroy)\n\t    (*c->db[i]->hdb_destroy)(context, c->db[i]);\n    c->num_db = 0;\n    free(c->db);\n    c->db = NULL;\n\n    hdb_free_dbinfo(context, &info);\n\n    return ret;\n}",
          "includes": [
            "include \"kdc_locl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"kdc_locl.h\"\n\nrb5_error_code\nkrb5_kdc_set_dbinfo(krb5_context context, struct krb5_kdc_configuration *c)\n{\n    struct hdb_dbinfo *info, *d;\n    krb5_error_code ret;\n    int i;\n\n    /* fetch the databases */\n    ret = hdb_get_dbinfo(context, &info);\n    if (ret)\n\treturn ret;\n\n    d = NULL;\n    while ((d = hdb_dbinfo_get_next(info, d)) != NULL) {\n\n\tret = add_db(context, c,\n\t\t     hdb_dbinfo_get_dbname(context, d),\n\t\t     hdb_dbinfo_get_mkey_file(context, d));\n\tif (ret)\n\t    goto out;\n\n\tkdc_log(context, c, 0, \"label: %s\",\n\t\thdb_dbinfo_get_label(context, d));\n\tkdc_log(context, c, 0, \"\\tdbname: %s\",\n\t\thdb_dbinfo_get_dbname(context, d));\n\tkdc_log(context, c, 0, \"\\tmkey_file: %s\",\n\t\thdb_dbinfo_get_mkey_file(context, d));\n\tkdc_log(context, c, 0, \"\\tacl_file: %s\",\n\t\thdb_dbinfo_get_acl_file(context, d));\n    }\n    hdb_free_dbinfo(context, &info);\n\n    return 0;\nout:\n    for (i = 0; i < c->num_db; i++)\n\tif (c->db[i] && c->db[i]->hdb_destroy)\n\t    (*c->db[i]->hdb_destroy)(context, c->db[i]);\n    c->num_db = 0;\n    free(c->db);\n    c->db = NULL;\n\n    hdb_free_dbinfo(context, &info);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dc_openlog(",
          "args": [
            "ontext,",
            "kdc\",",
            "onfig)"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "dc_openlog(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/log.c",
          "lines": "38-61",
          "snippet": "oid\nkdc_openlog(krb5_context context,\n\t    const char *service,\n\t    krb5_kdc_configuration *config)\n{\n    char **s = NULL, **p;\n    krb5_initlog(context, \"kdc\", &config->logf);\n    s = krb5_config_get_strings(context, NULL, service, \"logging\", NULL);\n    if(s == NULL)\n\ts = krb5_config_get_strings(context, NULL, \"logging\", service, NULL);\n    if(s){\n\tfor(p = s; *p; p++)\n\t    krb5_addlog_dest(context, config->logf, *p);\n\tkrb5_config_free_strings(s);\n    }else {\n\tchar *ss;\n\tif (asprintf(&ss, \"0-1/FILE:%s/%s\", hdb_db_dir(context),\n\t    KDC_LOG_FILE) < 0)\n\t    err(1, \"out of memory\");\n\tkrb5_addlog_dest(context, config->logf, ss);\n\tfree(ss);\n    }\n    krb5_set_warn_dest(context, config->logf);\n}",
          "includes": [
            "include \"kdc_locl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"kdc_locl.h\"\n\noid\nkdc_openlog(krb5_context context,\n\t    const char *service,\n\t    krb5_kdc_configuration *config)\n{\n    char **s = NULL, **p;\n    krb5_initlog(context, \"kdc\", &config->logf);\n    s = krb5_config_get_strings(context, NULL, service, \"logging\", NULL);\n    if(s == NULL)\n\ts = krb5_config_get_strings(context, NULL, \"logging\", service, NULL);\n    if(s){\n\tfor(p = s; *p; p++)\n\t    krb5_addlog_dest(context, config->logf, *p);\n\tkrb5_config_free_strings(s);\n    }else {\n\tchar *ss;\n\tif (asprintf(&ss, \"0-1/FILE:%s/%s\", hdb_db_dir(context),\n\t    KDC_LOG_FILE) < 0)\n\t    err(1, \"out of memory\");\n\tkrb5_addlog_dest(context, config->logf, ss);\n\tfree(ss);\n    }\n    krb5_set_warn_dest(context, config->logf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rb5_err(",
          "args": [
            "ontext,",
            ",",
            "et,",
            "krb5_kdc_default_config\")"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_kdc_get_config(",
          "args": [
            "ontext,",
            "config)"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "rb5_kdc_get_config(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/default_config.c",
          "lines": "40-262",
          "snippet": "rb5_error_code\nkrb5_kdc_get_config(krb5_context context, krb5_kdc_configuration **config)\n{\n    krb5_kdc_configuration *c;\n\n    c = calloc(1, sizeof(*c));\n    if (c == NULL) {\n\tkrb5_set_error_message(context, ENOMEM, \"malloc: out of memory\");\n\treturn ENOMEM;\n    }\n\n    c->num_kdc_processes = -1;\n    c->require_preauth = TRUE;\n    c->kdc_warn_pwexpire = 0;\n    c->encode_as_rep_as_tgs_rep = FALSE;\n    c->tgt_use_strongest_session_key = FALSE;\n    c->preauth_use_strongest_session_key = FALSE;\n    c->svc_use_strongest_session_key = FALSE;\n    c->use_strongest_server_key = TRUE;\n    c->check_ticket_addresses = TRUE;\n    c->allow_null_ticket_addresses = TRUE;\n    c->allow_anonymous = FALSE;\n    c->strict_nametypes = FALSE;\n    c->trpolicy = TRPOLICY_ALWAYS_CHECK;\n    c->enable_pkinit = FALSE;\n    c->pkinit_princ_in_cert = TRUE;\n    c->pkinit_require_binding = TRUE;\n    c->db = NULL;\n    c->num_db = 0;\n    c->logf = NULL;\n\n    c->num_kdc_processes =\n        krb5_config_get_int_default(context, NULL, c->num_kdc_processes,\n\t\t\t\t    \"kdc\", \"num-kdc-processes\", NULL);\n\n    c->require_preauth =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->require_preauth,\n\t\t\t\t     \"kdc\", \"require-preauth\", NULL);\n#ifdef DIGEST\n    c->enable_digest =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     FALSE,\n\t\t\t\t     \"kdc\", \"enable-digest\", NULL);\n\n    {\n\tconst char *digests;\n\n\tdigests = krb5_config_get_string(context, NULL,\n\t\t\t\t\t \"kdc\",\n\t\t\t\t\t \"digests_allowed\", NULL);\n\tif (digests == NULL)\n\t    digests = \"ntlm-v2\";\n\tc->digests_allowed = parse_flags(digests,_kdc_digestunits, 0);\n\tif (c->digests_allowed == -1) {\n\t    kdc_log(context, c, 0,\n\t\t    \"unparsable digest units (%s), turning off digest\",\n\t\t    digests);\n\t    c->enable_digest = 0;\n\t} else if (c->digests_allowed == 0) {\n\t    kdc_log(context, c, 0,\n\t\t    \"no digest enable, turning digest off\",\n\t\t    digests);\n\t    c->enable_digest = 0;\n\t}\n    }\n#endif\n\n#ifdef KX509\n    c->enable_kx509 =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     FALSE,\n\t\t\t\t     \"kdc\", \"enable-kx509\", NULL);\n\n    if (c->enable_kx509) {\n\tc->kx509_template =\n\t    krb5_config_get_string(context, NULL,\n\t\t\t\t   \"kdc\", \"kx509_template\", NULL);\n\tc->kx509_ca =\n\t    krb5_config_get_string(context, NULL,\n\t\t\t\t   \"kdc\", \"kx509_ca\", NULL);\n\tif (c->kx509_ca == NULL || c->kx509_template == NULL) {\n\t    kdc_log(context, c, 0,\n\t\t    \"missing kx509 configuration, turning off\");\n\t    c->enable_kx509 = FALSE;\n\t}\n    }\n#endif\n\n    c->tgt_use_strongest_session_key =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->tgt_use_strongest_session_key,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"tgt-use-strongest-session-key\", NULL);\n    c->preauth_use_strongest_session_key =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->preauth_use_strongest_session_key,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"preauth-use-strongest-session-key\", NULL);\n    c->svc_use_strongest_session_key =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->svc_use_strongest_session_key,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"svc-use-strongest-session-key\", NULL);\n    c->use_strongest_server_key =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->use_strongest_server_key,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"use-strongest-server-key\", NULL);\n\n    c->check_ticket_addresses =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->check_ticket_addresses,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"check-ticket-addresses\", NULL);\n    c->allow_null_ticket_addresses =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->allow_null_ticket_addresses,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"allow-null-ticket-addresses\", NULL);\n\n    c->allow_anonymous =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->allow_anonymous,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"allow-anonymous\", NULL);\n\n    c->strict_nametypes =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->strict_nametypes,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"strict-nametypes\", NULL);\n\n    c->max_datagram_reply_length =\n\tkrb5_config_get_int_default(context,\n\t\t\t\t    NULL,\n\t\t\t\t    1400,\n\t\t\t\t    \"kdc\",\n\t\t\t\t    \"max-kdc-datagram-reply-length\",\n\t\t\t\t    NULL);\n\n    {\n\tconst char *trpolicy_str;\n\n\ttrpolicy_str =\n\t    krb5_config_get_string_default(context, NULL, \"DEFAULT\", \"kdc\",\n\t\t\t\t\t   \"transited-policy\", NULL);\n\tif(strcasecmp(trpolicy_str, \"always-check\") == 0) {\n\t    c->trpolicy = TRPOLICY_ALWAYS_CHECK;\n\t} else if(strcasecmp(trpolicy_str, \"allow-per-principal\") == 0) {\n\t    c->trpolicy = TRPOLICY_ALLOW_PER_PRINCIPAL;\n\t} else if(strcasecmp(trpolicy_str, \"always-honour-request\") == 0) {\n\t    c->trpolicy = TRPOLICY_ALWAYS_HONOUR_REQUEST;\n\t} else if(strcasecmp(trpolicy_str, \"DEFAULT\") == 0) {\n\t    /* default */\n\t} else {\n\t    kdc_log(context, c, 0,\n\t\t    \"unknown transited-policy: %s, \"\n\t\t    \"reverting to default (always-check)\",\n\t\t    trpolicy_str);\n\t}\n    }\n\n    c->encode_as_rep_as_tgs_rep =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->encode_as_rep_as_tgs_rep,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"encode_as_rep_as_tgs_rep\", NULL);\n\n    c->kdc_warn_pwexpire =\n\tkrb5_config_get_time_default (context, NULL,\n\t\t\t\t      c->kdc_warn_pwexpire,\n\t\t\t\t      \"kdc\", \"kdc_warn_pwexpire\", NULL);\n\n\n    c->enable_pkinit =\n\tkrb5_config_get_bool_default(context,\n\t\t\t\t     NULL,\n\t\t\t\t     c->enable_pkinit,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"enable-pkinit\",\n\t\t\t\t     NULL);\n\n\n    c->pkinit_kdc_identity =\n\tkrb5_config_get_string(context, NULL,\n\t\t\t       \"kdc\", \"pkinit_identity\", NULL);\n    c->pkinit_kdc_anchors =\n\tkrb5_config_get_string(context, NULL,\n\t\t\t       \"kdc\", \"pkinit_anchors\", NULL);\n    c->pkinit_kdc_cert_pool =\n\tkrb5_config_get_strings(context, NULL,\n\t\t\t\t\"kdc\", \"pkinit_pool\", NULL);\n    c->pkinit_kdc_revoke =\n\tkrb5_config_get_strings(context, NULL,\n\t\t\t\t\"kdc\", \"pkinit_revoke\", NULL);\n    c->pkinit_kdc_ocsp_file =\n\tkrb5_config_get_string(context, NULL,\n\t\t\t       \"kdc\", \"pkinit_kdc_ocsp\", NULL);\n    c->pkinit_kdc_friendly_name =\n\tkrb5_config_get_string(context, NULL,\n\t\t\t       \"kdc\", \"pkinit_kdc_friendly_name\", NULL);\n    c->pkinit_princ_in_cert =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->pkinit_princ_in_cert,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"pkinit_principal_in_certificate\",\n\t\t\t\t     NULL);\n    c->pkinit_require_binding =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->pkinit_require_binding,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"pkinit_win2k_require_binding\",\n\t\t\t\t     NULL);\n    c->pkinit_dh_min_bits =\n\tkrb5_config_get_int_default(context, NULL,\n\t\t\t\t    0,\n\t\t\t\t    \"kdc\", \"pkinit_dh_min_bits\", NULL);\n\n    *config = c;\n\n    return 0;\n}",
          "includes": [
            "include <parse_bytes.h>",
            "include <getarg.h>\n#",
            "include \"kdc_locl.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <parse_bytes.h>\ninclude <getarg.h>\n#\ninclude \"kdc_locl.h\"\n#\n\nrb5_error_code\nkrb5_kdc_get_config(krb5_context context, krb5_kdc_configuration **config)\n{\n    krb5_kdc_configuration *c;\n\n    c = calloc(1, sizeof(*c));\n    if (c == NULL) {\n\tkrb5_set_error_message(context, ENOMEM, \"malloc: out of memory\");\n\treturn ENOMEM;\n    }\n\n    c->num_kdc_processes = -1;\n    c->require_preauth = TRUE;\n    c->kdc_warn_pwexpire = 0;\n    c->encode_as_rep_as_tgs_rep = FALSE;\n    c->tgt_use_strongest_session_key = FALSE;\n    c->preauth_use_strongest_session_key = FALSE;\n    c->svc_use_strongest_session_key = FALSE;\n    c->use_strongest_server_key = TRUE;\n    c->check_ticket_addresses = TRUE;\n    c->allow_null_ticket_addresses = TRUE;\n    c->allow_anonymous = FALSE;\n    c->strict_nametypes = FALSE;\n    c->trpolicy = TRPOLICY_ALWAYS_CHECK;\n    c->enable_pkinit = FALSE;\n    c->pkinit_princ_in_cert = TRUE;\n    c->pkinit_require_binding = TRUE;\n    c->db = NULL;\n    c->num_db = 0;\n    c->logf = NULL;\n\n    c->num_kdc_processes =\n        krb5_config_get_int_default(context, NULL, c->num_kdc_processes,\n\t\t\t\t    \"kdc\", \"num-kdc-processes\", NULL);\n\n    c->require_preauth =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->require_preauth,\n\t\t\t\t     \"kdc\", \"require-preauth\", NULL);\n#ifdef DIGEST\n    c->enable_digest =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     FALSE,\n\t\t\t\t     \"kdc\", \"enable-digest\", NULL);\n\n    {\n\tconst char *digests;\n\n\tdigests = krb5_config_get_string(context, NULL,\n\t\t\t\t\t \"kdc\",\n\t\t\t\t\t \"digests_allowed\", NULL);\n\tif (digests == NULL)\n\t    digests = \"ntlm-v2\";\n\tc->digests_allowed = parse_flags(digests,_kdc_digestunits, 0);\n\tif (c->digests_allowed == -1) {\n\t    kdc_log(context, c, 0,\n\t\t    \"unparsable digest units (%s), turning off digest\",\n\t\t    digests);\n\t    c->enable_digest = 0;\n\t} else if (c->digests_allowed == 0) {\n\t    kdc_log(context, c, 0,\n\t\t    \"no digest enable, turning digest off\",\n\t\t    digests);\n\t    c->enable_digest = 0;\n\t}\n    }\n#endif\n\n#ifdef KX509\n    c->enable_kx509 =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     FALSE,\n\t\t\t\t     \"kdc\", \"enable-kx509\", NULL);\n\n    if (c->enable_kx509) {\n\tc->kx509_template =\n\t    krb5_config_get_string(context, NULL,\n\t\t\t\t   \"kdc\", \"kx509_template\", NULL);\n\tc->kx509_ca =\n\t    krb5_config_get_string(context, NULL,\n\t\t\t\t   \"kdc\", \"kx509_ca\", NULL);\n\tif (c->kx509_ca == NULL || c->kx509_template == NULL) {\n\t    kdc_log(context, c, 0,\n\t\t    \"missing kx509 configuration, turning off\");\n\t    c->enable_kx509 = FALSE;\n\t}\n    }\n#endif\n\n    c->tgt_use_strongest_session_key =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->tgt_use_strongest_session_key,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"tgt-use-strongest-session-key\", NULL);\n    c->preauth_use_strongest_session_key =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->preauth_use_strongest_session_key,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"preauth-use-strongest-session-key\", NULL);\n    c->svc_use_strongest_session_key =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->svc_use_strongest_session_key,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"svc-use-strongest-session-key\", NULL);\n    c->use_strongest_server_key =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->use_strongest_server_key,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"use-strongest-server-key\", NULL);\n\n    c->check_ticket_addresses =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->check_ticket_addresses,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"check-ticket-addresses\", NULL);\n    c->allow_null_ticket_addresses =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->allow_null_ticket_addresses,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"allow-null-ticket-addresses\", NULL);\n\n    c->allow_anonymous =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->allow_anonymous,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"allow-anonymous\", NULL);\n\n    c->strict_nametypes =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->strict_nametypes,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"strict-nametypes\", NULL);\n\n    c->max_datagram_reply_length =\n\tkrb5_config_get_int_default(context,\n\t\t\t\t    NULL,\n\t\t\t\t    1400,\n\t\t\t\t    \"kdc\",\n\t\t\t\t    \"max-kdc-datagram-reply-length\",\n\t\t\t\t    NULL);\n\n    {\n\tconst char *trpolicy_str;\n\n\ttrpolicy_str =\n\t    krb5_config_get_string_default(context, NULL, \"DEFAULT\", \"kdc\",\n\t\t\t\t\t   \"transited-policy\", NULL);\n\tif(strcasecmp(trpolicy_str, \"always-check\") == 0) {\n\t    c->trpolicy = TRPOLICY_ALWAYS_CHECK;\n\t} else if(strcasecmp(trpolicy_str, \"allow-per-principal\") == 0) {\n\t    c->trpolicy = TRPOLICY_ALLOW_PER_PRINCIPAL;\n\t} else if(strcasecmp(trpolicy_str, \"always-honour-request\") == 0) {\n\t    c->trpolicy = TRPOLICY_ALWAYS_HONOUR_REQUEST;\n\t} else if(strcasecmp(trpolicy_str, \"DEFAULT\") == 0) {\n\t    /* default */\n\t} else {\n\t    kdc_log(context, c, 0,\n\t\t    \"unknown transited-policy: %s, \"\n\t\t    \"reverting to default (always-check)\",\n\t\t    trpolicy_str);\n\t}\n    }\n\n    c->encode_as_rep_as_tgs_rep =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->encode_as_rep_as_tgs_rep,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"encode_as_rep_as_tgs_rep\", NULL);\n\n    c->kdc_warn_pwexpire =\n\tkrb5_config_get_time_default (context, NULL,\n\t\t\t\t      c->kdc_warn_pwexpire,\n\t\t\t\t      \"kdc\", \"kdc_warn_pwexpire\", NULL);\n\n\n    c->enable_pkinit =\n\tkrb5_config_get_bool_default(context,\n\t\t\t\t     NULL,\n\t\t\t\t     c->enable_pkinit,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"enable-pkinit\",\n\t\t\t\t     NULL);\n\n\n    c->pkinit_kdc_identity =\n\tkrb5_config_get_string(context, NULL,\n\t\t\t       \"kdc\", \"pkinit_identity\", NULL);\n    c->pkinit_kdc_anchors =\n\tkrb5_config_get_string(context, NULL,\n\t\t\t       \"kdc\", \"pkinit_anchors\", NULL);\n    c->pkinit_kdc_cert_pool =\n\tkrb5_config_get_strings(context, NULL,\n\t\t\t\t\"kdc\", \"pkinit_pool\", NULL);\n    c->pkinit_kdc_revoke =\n\tkrb5_config_get_strings(context, NULL,\n\t\t\t\t\"kdc\", \"pkinit_revoke\", NULL);\n    c->pkinit_kdc_ocsp_file =\n\tkrb5_config_get_string(context, NULL,\n\t\t\t       \"kdc\", \"pkinit_kdc_ocsp\", NULL);\n    c->pkinit_kdc_friendly_name =\n\tkrb5_config_get_string(context, NULL,\n\t\t\t       \"kdc\", \"pkinit_kdc_friendly_name\", NULL);\n    c->pkinit_princ_in_cert =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->pkinit_princ_in_cert,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"pkinit_principal_in_certificate\",\n\t\t\t\t     NULL);\n    c->pkinit_require_binding =\n\tkrb5_config_get_bool_default(context, NULL,\n\t\t\t\t     c->pkinit_require_binding,\n\t\t\t\t     \"kdc\",\n\t\t\t\t     \"pkinit_win2k_require_binding\",\n\t\t\t\t     NULL);\n    c->pkinit_dh_min_bits =\n\tkrb5_config_get_int_default(context, NULL,\n\t\t\t\t    0,\n\t\t\t\t    \"kdc\", \"pkinit_dh_min_bits\", NULL);\n\n    *config = c;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rb5_err(",
          "args": [
            "ontext,",
            ",",
            "et,",
            "reading configuration files\")"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_free_config_files(",
          "args": [
            "iles)"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_set_config_files(",
          "args": [
            "ontext,",
            "iles)"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_err(",
          "args": [
            "ontext,",
            ",",
            "et,",
            "getting configuration files\")"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_prepend_config_files_default(",
          "args": [
            "onfig_file,",
            "files)"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rrx(",
          "args": [
            ",",
            "out of memory\")"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf(",
          "args": [
            "config_file,",
            "%s/kdc.conf\",",
            "db_db_dir(context))"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_db_dir(",
          "args": [
            "ontext)"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oken_detach_prep(",
          "args": [
            "rgc,",
            "rgv,",
            "--daemon-child\")"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_config_get_bool_default(",
          "args": [
            "ontext,",
            "ULL,",
            "ALSE,",
            "kdc\",",
            "detach\",",
            "ULL)"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xit(",
          "args": [
            ")"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ree(",
          "args": [
            "ist)"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rintf(",
          "args": [
            "builtin hdb backends: %s\\n\",",
            "ist)"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_err(",
          "args": [
            "ontext,",
            ",",
            "et,",
            "listing builtin hdb backends\")"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_list_builtin(",
          "args": [
            "ontext,",
            "list)"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xit(",
          "args": [
            ")"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rint_version(",
          "args": [
            "ULL)"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sage",
          "args": [
            ")"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "sage(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/config.c",
          "lines": "131-136",
          "snippet": "tatic void\nusage(int ret)\n{\n    arg_printusage (args, num_args, NULL, \"\");\n    exit (ret);\n}",
          "includes": [
            "include <parse_bytes.h>",
            "include <getarg.h>\n#",
            "include \"kdc_locl.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [
            "tatic struct getargs args[] = {\n    {\n\t\"config-file\",\t'c',\targ_string,\t&config_file,\n\t\"location of config file\",\t\"file\"\n    },\n    {\n\t\"require-preauth\",\t'p',\targ_negative_flag, &require_preauth,\n\t\"don't require pa-data in as-reqs\", NULL\n    },\n    {\n\t\"max-request\",\t0,\targ_string, &max_request_str,\n\t\"max size for a kdc-request\", \"size\"\n    },\n    { \"enable-http\", 'H', arg_flag, &enable_http, \"turn on HTTP support\",\n   \t NULL },\n    {\t\"ports\",\t'P', \targ_string, rk_UNCONST(&port_str),\n\t\"ports to listen to\", \"portspec\"\n    },\n    {\n\t\"detach\",       0 ,      arg_flag, &detach_from_console,\n\t\"detach from console\", NULL\n    },\n    {\n        \"daemon-child\",       0 ,      arg_flag, &daemon_child,\n        \"private argument, do not use\", NULL\n    },\n#ifdef __APPLE__\n    {\n        \"bonjour\",       0 ,      arg_flag, &do_bonjour,\n        \"private argument, do not use\", NULL\n    },\n#endif\n    {\t\"addresses\",\t0,\targ_strings, &addresses_str,\n\t\"addresses to listen on\", \"list of addresses\" },\n    {\t\"disable-des\",\t0,\targ_flag, &disable_des,\n\t\"disable DES\", NULL },\n    {\t\"builtin-hdb\",\t0,\targ_flag,   &builtin_hdb_flag,\n\t\"list builtin hdb backends\", NULL},\n    {   \"runas-user\",\t0,\targ_string, &runas_string,\n\t\"run as this user when connected to network\", NULL\n    },\n    {   \"chroot\",\t0,\targ_string, &chroot_string,\n\t\"chroot directory to run in\", NULL\n    },\n    {\t\"testing\",\t0,\targ_flag,   &testing_flag, NULL, NULL },\n    {\t\"help\",\t\t'h',\targ_flag,   &help_flag, NULL, NULL },\n    {\t\"version\",\t'v',\targ_flag,   &version_flag, NULL, NULL }\n};",
            "tatic int num_args = sizeof(args) / sizeof(args[0]);"
          ],
          "called_functions": [],
          "contextual_snippet": "include <parse_bytes.h>\ninclude <getarg.h>\n#\ninclude \"kdc_locl.h\"\n#\n\ntatic struct getargs args[] = {\n    {\n\t\"config-file\",\t'c',\targ_string,\t&config_file,\n\t\"location of config file\",\t\"file\"\n    },\n    {\n\t\"require-preauth\",\t'p',\targ_negative_flag, &require_preauth,\n\t\"don't require pa-data in as-reqs\", NULL\n    },\n    {\n\t\"max-request\",\t0,\targ_string, &max_request_str,\n\t\"max size for a kdc-request\", \"size\"\n    },\n    { \"enable-http\", 'H', arg_flag, &enable_http, \"turn on HTTP support\",\n   \t NULL },\n    {\t\"ports\",\t'P', \targ_string, rk_UNCONST(&port_str),\n\t\"ports to listen to\", \"portspec\"\n    },\n    {\n\t\"detach\",       0 ,      arg_flag, &detach_from_console,\n\t\"detach from console\", NULL\n    },\n    {\n        \"daemon-child\",       0 ,      arg_flag, &daemon_child,\n        \"private argument, do not use\", NULL\n    },\n#ifdef __APPLE__\n    {\n        \"bonjour\",       0 ,      arg_flag, &do_bonjour,\n        \"private argument, do not use\", NULL\n    },\n#endif\n    {\t\"addresses\",\t0,\targ_strings, &addresses_str,\n\t\"addresses to listen on\", \"list of addresses\" },\n    {\t\"disable-des\",\t0,\targ_flag, &disable_des,\n\t\"disable DES\", NULL },\n    {\t\"builtin-hdb\",\t0,\targ_flag,   &builtin_hdb_flag,\n\t\"list builtin hdb backends\", NULL},\n    {   \"runas-user\",\t0,\targ_string, &runas_string,\n\t\"run as this user when connected to network\", NULL\n    },\n    {   \"chroot\",\t0,\targ_string, &chroot_string,\n\t\"chroot directory to run in\", NULL\n    },\n    {\t\"testing\",\t0,\targ_flag,   &testing_flag, NULL, NULL },\n    {\t\"help\",\t\t'h',\targ_flag,   &help_flag, NULL, NULL },\n    {\t\"version\",\t'v',\targ_flag,   &version_flag, NULL, NULL }\n};\ntatic int num_args = sizeof(args) / sizeof(args[0]);\n\ntatic void\nusage(int ret)\n{\n    arg_printusage (args, num_args, NULL, \"\");\n    exit (ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "arnx(",
          "args": [
            "error at argument `%s'\",",
            "rgv[*optidx])"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etarg(",
          "args": [
            "rgs,",
            "um_args,",
            "rgc,",
            "rgv,",
            "ptidx)"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <parse_bytes.h>\ninclude <getarg.h>\n#\ninclude \"kdc_locl.h\"\n#\n\ntatic char *config_file;\ntatic int require_preauth = -1;\ntatic char *max_request_str;\ntatic int disable_des = -1;\ntatic int builtin_hdb_flag;\ntatic int help_flag;\ntatic int version_flag;\nnt enable_http = -1;\nonst char *request_log;\nonst char *port_str;\nrb5_addresses explicit_addresses;\nize_t max_request_udp;\nize_t max_request_tcp;\ntatic struct getarg_strings addresses_str;\ntatic struct getargs args[] = {\n    {\n\t\"config-file\",\t'c',\targ_string,\t&config_file,\n\t\"location of config file\",\t\"file\"\n    },\n    {\n\t\"require-preauth\",\t'p',\targ_negative_flag, &require_preauth,\n\t\"don't require pa-data in as-reqs\", NULL\n    },\n    {\n\t\"max-request\",\t0,\targ_string, &max_request_str,\n\t\"max size for a kdc-request\", \"size\"\n    },\n    { \"enable-http\", 'H', arg_flag, &enable_http, \"turn on HTTP support\",\n   \t NULL },\n    {\t\"ports\",\t'P', \targ_string, rk_UNCONST(&port_str),\n\t\"ports to listen to\", \"portspec\"\n    },\n    {\n\t\"detach\",       0 ,      arg_flag, &detach_from_console,\n\t\"detach from console\", NULL\n    },\n    {\n        \"daemon-child\",       0 ,      arg_flag, &daemon_child,\n        \"private argument, do not use\", NULL\n    },\n#ifdef __APPLE__\n    {\n        \"bonjour\",       0 ,      arg_flag, &do_bonjour,\n        \"private argument, do not use\", NULL\n    },\n#endif\n    {\t\"addresses\",\t0,\targ_strings, &addresses_str,\n\t\"addresses to listen on\", \"list of addresses\" },\n    {\t\"disable-des\",\t0,\targ_flag, &disable_des,\n\t\"disable DES\", NULL },\n    {\t\"builtin-hdb\",\t0,\targ_flag,   &builtin_hdb_flag,\n\t\"list builtin hdb backends\", NULL},\n    {   \"runas-user\",\t0,\targ_string, &runas_string,\n\t\"run as this user when connected to network\", NULL\n    },\n    {   \"chroot\",\t0,\targ_string, &chroot_string,\n\t\"chroot directory to run in\", NULL\n    },\n    {\t\"testing\",\t0,\targ_flag,   &testing_flag, NULL, NULL },\n    {\t\"help\",\t\t'h',\targ_flag,   &help_flag, NULL, NULL },\n    {\t\"version\",\t'v',\targ_flag,   &version_flag, NULL, NULL }\n};\ntatic int num_args = sizeof(args) / sizeof(args[0]);\n\nrb5_kdc_configuration *\nconfigure(krb5_context context, int argc, char **argv, int *optidx)\n{\n    krb5_kdc_configuration *config;\n    krb5_error_code ret;\n    \n    const char *p;\n\n    *optidx = 0;\n\n    while (getarg(args, num_args, argc, argv, optidx))\n\twarnx(\"error at argument `%s'\", argv[*optidx]);\n\n    if (help_flag)\n\tusage (0);\n\n    if (version_flag) {\n\tprint_version(NULL);\n\texit(0);\n    }\n\n    if (builtin_hdb_flag) {\n\tchar *list;\n\tret = hdb_list_builtin(context, &list);\n\tif (ret)\n\t    krb5_err(context, 1, ret, \"listing builtin hdb backends\");\n\tprintf(\"builtin hdb backends: %s\\n\", list);\n\tfree(list);\n\texit(0);\n    }\n\n    if(detach_from_console == -1)\n\tdetach_from_console = krb5_config_get_bool_default(context, NULL,\n\t\t\t\t\t\t\t   FALSE,\n\t\t\t\t\t\t\t   \"kdc\",\n\t\t\t\t\t\t\t   \"detach\", NULL);\n\n    if (detach_from_console && daemon_child == -1)\n        roken_detach_prep(argc, argv, \"--daemon-child\");\n\n    {\n\tchar **files;\n\tint aret;\n\n\tif (config_file == NULL) {\n\t    aret = asprintf(&config_file, \"%s/kdc.conf\", hdb_db_dir(context));\n\t    if (aret == -1 || config_file == NULL)\n\t\terrx(1, \"out of memory\");\n\t}\n\n\tret = krb5_prepend_config_files_default(config_file, &files);\n\tif (ret)\n\t    krb5_err(context, 1, ret, \"getting configuration files\");\n\n\tret = krb5_set_config_files(context, files);\n\tkrb5_free_config_files(files);\n\tif(ret)\n\t    krb5_err(context, 1, ret, \"reading configuration files\");\n    }\n\n    ret = krb5_kdc_get_config(context, &config);\n    if (ret)\n\tkrb5_err(context, 1, ret, \"krb5_kdc_default_config\");\n\n    kdc_openlog(context, \"kdc\", config);\n\n    ret = krb5_kdc_set_dbinfo(context, config);\n    if (ret)\n\tkrb5_err(context, 1, ret, \"krb5_kdc_set_dbinfo\");\n\n    if(max_request_str)\n\tmax_request_tcp = max_request_udp = parse_bytes(max_request_str, NULL);\n\n    if(max_request_tcp == 0){\n\tp = krb5_config_get_string (context,\n\t\t\t\t    NULL,\n\t\t\t\t    \"kdc\",\n\t\t\t\t    \"max-request\",\n\t\t\t\t    NULL);\n\tif(p)\n\t    max_request_tcp = max_request_udp = parse_bytes(p, NULL);\n    }\n\n    if(require_preauth != -1)\n\tconfig->require_preauth = require_preauth;\n\n    if(port_str == NULL){\n\tp = krb5_config_get_string(context, NULL, \"kdc\", \"ports\", NULL);\n\tif (p != NULL)\n\t    port_str = strdup(p);\n    }\n\n    explicit_addresses.len = 0;\n\n    if (addresses_str.num_strings) {\n\tint i;\n\n\tfor (i = 0; i < addresses_str.num_strings; ++i)\n\t    add_one_address (context, addresses_str.strings[i], i == 0);\n\tfree_getarg_strings (&addresses_str);\n    } else {\n\tchar **foo = krb5_config_get_strings (context, NULL,\n\t\t\t\t\t      \"kdc\", \"addresses\", NULL);\n\n\tif (foo != NULL) {\n\t    add_one_address (context, *foo++, TRUE);\n\t    while (*foo)\n\t\tadd_one_address (context, *foo++, FALSE);\n\t}\n    }\n\n    if(enable_http == -1)\n\tenable_http = krb5_config_get_bool(context, NULL, \"kdc\",\n\t\t\t\t\t   \"enable-http\", NULL);\n\n    if(request_log == NULL)\n\trequest_log = krb5_config_get_string(context, NULL,\n\t\t\t\t\t     \"kdc\",\n\t\t\t\t\t     \"kdc-request-log\",\n\t\t\t\t\t     NULL);\n\n    if (krb5_config_get_string(context, NULL, \"kdc\",\n\t\t\t       \"enforce-transited-policy\", NULL))\n\tkrb5_errx(context, 1, \"enforce-transited-policy deprecated, \"\n\t\t  \"use [kdc]transited-policy instead\");\n\n    if(max_request_tcp == 0)\n\tmax_request_tcp = 64 * 1024;\n    if(max_request_udp == 0)\n\tmax_request_udp = 64 * 1024;\n\n    if (port_str == NULL)\n\tport_str = \"+\";\n\n    if(disable_des == -1)\n\tdisable_des = krb5_config_get_bool_default(context, NULL,\n\t\t\t\t\t\t   FALSE,\n\t\t\t\t\t\t   \"kdc\",\n\t\t\t\t\t\t   \"disable-des\", NULL);\n    if(disable_des) {\n\tkrb5_enctype_disable(context, ETYPE_DES_CBC_CRC);\n\tkrb5_enctype_disable(context, ETYPE_DES_CBC_MD4);\n\tkrb5_enctype_disable(context, ETYPE_DES_CBC_MD5);\n\tkrb5_enctype_disable(context, ETYPE_DES_CBC_NONE);\n\tkrb5_enctype_disable(context, ETYPE_DES_CFB64_NONE);\n\tkrb5_enctype_disable(context, ETYPE_DES_PCBC_NONE);\n    }\n\n    krb5_kdc_windc_init(context);\n\n    krb5_kdc_pkinit_config(context, config);\n\n    return config;\n}"
  },
  {
    "function_name": "dd_one_address",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/config.c",
    "lines": "138-152",
    "snippet": "tatic void\nadd_one_address (krb5_context context, const char *str, int first)\n{\n    krb5_error_code ret;\n    krb5_addresses tmp;\n\n    ret = krb5_parse_address (context, str, &tmp);\n    if (ret)\n\tkrb5_err (context, 1, ret, \"parse_address `%s'\", str);\n    if (first)\n\tkrb5_copy_addresses(context, &tmp, &explicit_addresses);\n    else\n\tkrb5_append_addresses(context, &explicit_addresses, &tmp);\n    krb5_free_addresses (context, &tmp);\n}",
    "includes": [
      "include <parse_bytes.h>",
      "include <getarg.h>\n#",
      "include \"kdc_locl.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "rb5_addresses explicit_addresses;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb5_free_addresses",
          "args": [
            "ontext,",
            "tmp)"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_append_addresses(",
          "args": [
            "ontext,",
            "explicit_addresses,",
            "tmp)"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_copy_addresses(",
          "args": [
            "ontext,",
            "tmp,",
            "explicit_addresses)"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_err",
          "args": [
            "ontext,",
            ",",
            "et,",
            "parse_address `%s'\",",
            "tr)"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb5_parse_address",
          "args": [
            "ontext,",
            "tr,",
            "tmp)"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <parse_bytes.h>\ninclude <getarg.h>\n#\ninclude \"kdc_locl.h\"\n#\n\nrb5_addresses explicit_addresses;\n\ntatic void\nadd_one_address (krb5_context context, const char *str, int first)\n{\n    krb5_error_code ret;\n    krb5_addresses tmp;\n\n    ret = krb5_parse_address (context, str, &tmp);\n    if (ret)\n\tkrb5_err (context, 1, ret, \"parse_address `%s'\", str);\n    if (first)\n\tkrb5_copy_addresses(context, &tmp, &explicit_addresses);\n    else\n\tkrb5_append_addresses(context, &explicit_addresses, &tmp);\n    krb5_free_addresses (context, &tmp);\n}"
  },
  {
    "function_name": "sage(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-6594/repo/kdc/config.c",
    "lines": "131-136",
    "snippet": "tatic void\nusage(int ret)\n{\n    arg_printusage (args, num_args, NULL, \"\");\n    exit (ret);\n}",
    "includes": [
      "include <parse_bytes.h>",
      "include <getarg.h>\n#",
      "include \"kdc_locl.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [
      "tatic struct getargs args[] = {\n    {\n\t\"config-file\",\t'c',\targ_string,\t&config_file,\n\t\"location of config file\",\t\"file\"\n    },\n    {\n\t\"require-preauth\",\t'p',\targ_negative_flag, &require_preauth,\n\t\"don't require pa-data in as-reqs\", NULL\n    },\n    {\n\t\"max-request\",\t0,\targ_string, &max_request_str,\n\t\"max size for a kdc-request\", \"size\"\n    },\n    { \"enable-http\", 'H', arg_flag, &enable_http, \"turn on HTTP support\",\n   \t NULL },\n    {\t\"ports\",\t'P', \targ_string, rk_UNCONST(&port_str),\n\t\"ports to listen to\", \"portspec\"\n    },\n    {\n\t\"detach\",       0 ,      arg_flag, &detach_from_console,\n\t\"detach from console\", NULL\n    },\n    {\n        \"daemon-child\",       0 ,      arg_flag, &daemon_child,\n        \"private argument, do not use\", NULL\n    },\n#ifdef __APPLE__\n    {\n        \"bonjour\",       0 ,      arg_flag, &do_bonjour,\n        \"private argument, do not use\", NULL\n    },\n#endif\n    {\t\"addresses\",\t0,\targ_strings, &addresses_str,\n\t\"addresses to listen on\", \"list of addresses\" },\n    {\t\"disable-des\",\t0,\targ_flag, &disable_des,\n\t\"disable DES\", NULL },\n    {\t\"builtin-hdb\",\t0,\targ_flag,   &builtin_hdb_flag,\n\t\"list builtin hdb backends\", NULL},\n    {   \"runas-user\",\t0,\targ_string, &runas_string,\n\t\"run as this user when connected to network\", NULL\n    },\n    {   \"chroot\",\t0,\targ_string, &chroot_string,\n\t\"chroot directory to run in\", NULL\n    },\n    {\t\"testing\",\t0,\targ_flag,   &testing_flag, NULL, NULL },\n    {\t\"help\",\t\t'h',\targ_flag,   &help_flag, NULL, NULL },\n    {\t\"version\",\t'v',\targ_flag,   &version_flag, NULL, NULL }\n};",
      "tatic int num_args = sizeof(args) / sizeof(args[0]);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xit",
          "args": [
            "et)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rg_printusage",
          "args": [
            "rgs,",
            "um_args,",
            "ULL,",
            "\")"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <parse_bytes.h>\ninclude <getarg.h>\n#\ninclude \"kdc_locl.h\"\n#\n\ntatic struct getargs args[] = {\n    {\n\t\"config-file\",\t'c',\targ_string,\t&config_file,\n\t\"location of config file\",\t\"file\"\n    },\n    {\n\t\"require-preauth\",\t'p',\targ_negative_flag, &require_preauth,\n\t\"don't require pa-data in as-reqs\", NULL\n    },\n    {\n\t\"max-request\",\t0,\targ_string, &max_request_str,\n\t\"max size for a kdc-request\", \"size\"\n    },\n    { \"enable-http\", 'H', arg_flag, &enable_http, \"turn on HTTP support\",\n   \t NULL },\n    {\t\"ports\",\t'P', \targ_string, rk_UNCONST(&port_str),\n\t\"ports to listen to\", \"portspec\"\n    },\n    {\n\t\"detach\",       0 ,      arg_flag, &detach_from_console,\n\t\"detach from console\", NULL\n    },\n    {\n        \"daemon-child\",       0 ,      arg_flag, &daemon_child,\n        \"private argument, do not use\", NULL\n    },\n#ifdef __APPLE__\n    {\n        \"bonjour\",       0 ,      arg_flag, &do_bonjour,\n        \"private argument, do not use\", NULL\n    },\n#endif\n    {\t\"addresses\",\t0,\targ_strings, &addresses_str,\n\t\"addresses to listen on\", \"list of addresses\" },\n    {\t\"disable-des\",\t0,\targ_flag, &disable_des,\n\t\"disable DES\", NULL },\n    {\t\"builtin-hdb\",\t0,\targ_flag,   &builtin_hdb_flag,\n\t\"list builtin hdb backends\", NULL},\n    {   \"runas-user\",\t0,\targ_string, &runas_string,\n\t\"run as this user when connected to network\", NULL\n    },\n    {   \"chroot\",\t0,\targ_string, &chroot_string,\n\t\"chroot directory to run in\", NULL\n    },\n    {\t\"testing\",\t0,\targ_flag,   &testing_flag, NULL, NULL },\n    {\t\"help\",\t\t'h',\targ_flag,   &help_flag, NULL, NULL },\n    {\t\"version\",\t'v',\targ_flag,   &version_flag, NULL, NULL }\n};\ntatic int num_args = sizeof(args) / sizeof(args[0]);\n\ntatic void\nusage(int ret)\n{\n    arg_printusage (args, num_args, NULL, \"\");\n    exit (ret);\n}"
  }
]