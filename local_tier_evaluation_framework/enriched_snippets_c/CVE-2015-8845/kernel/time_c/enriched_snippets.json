[
  {
    "function_name": "rtc_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "1115-1125",
    "snippet": "static int __init rtc_init(void)\n{\n\tstruct platform_device *pdev;\n\n\tif (!ppc_md.get_rtc_time)\n\t\treturn -ENODEV;\n\n\tpdev = platform_device_register_simple(\"rtc-generic\", -1, NULL, 0);\n\n\treturn PTR_ERR_OR_ZERO(pdev);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PTR_ERR_OR_ZERO",
          "args": [
            "pdev"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "platform_device_register_simple",
          "args": [
            "\"rtc-generic\"",
            "-1",
            "NULL",
            "0"
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic int __init rtc_init(void)\n{\n\tstruct platform_device *pdev;\n\n\tif (!ppc_md.get_rtc_time)\n\t\treturn -ENODEV;\n\n\tpdev = platform_device_register_simple(\"rtc-generic\", -1, NULL, 0);\n\n\treturn PTR_ERR_OR_ZERO(pdev);\n}"
  },
  {
    "function_name": "calibrate_delay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "1107-1113",
    "snippet": "void calibrate_delay(void)\n{\n\t/* Some generic code (such as spinlock debug) use loops_per_jiffy\n\t * as the number of __delay(1) in a jiffy, so make it so\n\t */\n\tloops_per_jiffy = tb_ticks_per_jiffy;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long tb_ticks_per_jiffy;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long tb_ticks_per_jiffy;\n\nvoid calibrate_delay(void)\n{\n\t/* Some generic code (such as spinlock debug) use loops_per_jiffy\n\t * as the number of __delay(1) in a jiffy, so make it so\n\t */\n\tloops_per_jiffy = tb_ticks_per_jiffy;\n}"
  },
  {
    "function_name": "div128_by_32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "1077-1104",
    "snippet": "void div128_by_32(u64 dividend_high, u64 dividend_low,\n\t\t  unsigned divisor, struct div_result *dr)\n{\n\tunsigned long a, b, c, d;\n\tunsigned long w, x, y, z;\n\tu64 ra, rb, rc;\n\n\ta = dividend_high >> 32;\n\tb = dividend_high & 0xffffffff;\n\tc = dividend_low >> 32;\n\td = dividend_low & 0xffffffff;\n\n\tw = a / divisor;\n\tra = ((u64)(a - (w * divisor)) << 32) + b;\n\n\trb = ((u64) do_div(ra, divisor) << 32) + c;\n\tx = ra;\n\n\trc = ((u64) do_div(rb, divisor) << 32) + d;\n\ty = rb;\n\n\tdo_div(rc, divisor);\n\tz = rc;\n\n\tdr->result_high = ((u64)w << 32) + x;\n\tdr->result_low  = ((u64)y << 32) + z;\n\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "rc",
            "divisor"
          ],
          "line": 1098
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "rb",
            "divisor"
          ],
          "line": 1095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "ra",
            "divisor"
          ],
          "line": 1092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "a - (w * divisor)"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid div128_by_32(u64 dividend_high, u64 dividend_low,\n\t\t  unsigned divisor, struct div_result *dr)\n{\n\tunsigned long a, b, c, d;\n\tunsigned long w, x, y, z;\n\tu64 ra, rb, rc;\n\n\ta = dividend_high >> 32;\n\tb = dividend_high & 0xffffffff;\n\tc = dividend_low >> 32;\n\td = dividend_low & 0xffffffff;\n\n\tw = a / divisor;\n\tra = ((u64)(a - (w * divisor)) << 32) + b;\n\n\trb = ((u64) do_div(ra, divisor) << 32) + c;\n\tx = ra;\n\n\trc = ((u64) do_div(rb, divisor) << 32) + d;\n\ty = rb;\n\n\tdo_div(rc, divisor);\n\tz = rc;\n\n\tdr->result_high = ((u64)w << 32) + x;\n\tdr->result_low  = ((u64)y << 32) + z;\n\n}"
  },
  {
    "function_name": "to_tm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "1037-1070",
    "snippet": "void to_tm(int tim, struct rtc_time * tm)\n{\n\tregister int    i;\n\tregister long   hms, day;\n\n\tday = tim / SECDAY;\n\thms = tim % SECDAY;\n\n\t/* Hours, minutes, seconds are easy */\n\ttm->tm_hour = hms / 3600;\n\ttm->tm_min = (hms % 3600) / 60;\n\ttm->tm_sec = (hms % 3600) % 60;\n\n\t/* Number of years in days */\n\tfor (i = STARTOFTIME; day >= days_in_year(i); i++)\n\t\tday -= days_in_year(i);\n\ttm->tm_year = i;\n\n\t/* Number of months in days left */\n\tif (leapyear(tm->tm_year))\n\t\tdays_in_month(FEBRUARY) = 29;\n\tfor (i = 1; day >= days_in_month(i); i++)\n\t\tday -= days_in_month(i);\n\tdays_in_month(FEBRUARY) = 28;\n\ttm->tm_mon = i;\n\n\t/* Days are what is left over (+1) from all that. */\n\ttm->tm_mday = day + 1;\n\n\t/*\n\t * Determine the day of week\n\t */\n\tGregorianDay(tm);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define SECDAY\t\t86400L",
      "#define\tSTARTOFTIME\t1970",
      "#define FEBRUARY\t2"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GregorianDay",
          "args": [
            "tm"
          ],
          "line": 1069
        },
        "resolved": true,
        "details": {
          "function_name": "GregorianDay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "1008-1034",
          "snippet": "void GregorianDay(struct rtc_time * tm)\n{\n\tint leapsToDate;\n\tint lastYear;\n\tint day;\n\tint MonthOffset[] = { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334 };\n\n\tlastYear = tm->tm_year - 1;\n\n\t/*\n\t * Number of leap corrections to apply up to end of last year\n\t */\n\tleapsToDate = lastYear / 4 - lastYear / 100 + lastYear / 400;\n\n\t/*\n\t * This year is a leap year if it is divisible by 4 except when it is\n\t * divisible by 100 unless it is divisible by 400\n\t *\n\t * e.g. 1904 was a leap year, 1900 was not, 1996 is, and 2000 was\n\t */\n\tday = tm->tm_mon > 2 && leapyear(tm->tm_year);\n\n\tday += lastYear*365 + leapsToDate + MonthOffset[tm->tm_mon-1] +\n\t\t   tm->tm_mday;\n\n\ttm->tm_wday = day % 7;\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid GregorianDay(struct rtc_time * tm)\n{\n\tint leapsToDate;\n\tint lastYear;\n\tint day;\n\tint MonthOffset[] = { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334 };\n\n\tlastYear = tm->tm_year - 1;\n\n\t/*\n\t * Number of leap corrections to apply up to end of last year\n\t */\n\tleapsToDate = lastYear / 4 - lastYear / 100 + lastYear / 400;\n\n\t/*\n\t * This year is a leap year if it is divisible by 4 except when it is\n\t * divisible by 100 unless it is divisible by 400\n\t *\n\t * e.g. 1904 was a leap year, 1900 was not, 1996 is, and 2000 was\n\t */\n\tday = tm->tm_mon > 2 && leapyear(tm->tm_year);\n\n\tday += lastYear*365 + leapsToDate + MonthOffset[tm->tm_mon-1] +\n\t\t   tm->tm_mday;\n\n\ttm->tm_wday = day % 7;\n}"
        }
      },
      {
        "call_info": {
          "callee": "days_in_month",
          "args": [
            "FEBRUARY"
          ],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "days_in_month",
          "args": [
            "i"
          ],
          "line": 1059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "days_in_month",
          "args": [
            "i"
          ],
          "line": 1058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "days_in_month",
          "args": [
            "FEBRUARY"
          ],
          "line": 1057
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "leapyear",
          "args": [
            "tm->tm_year"
          ],
          "line": 1056
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "days_in_year",
          "args": [
            "i"
          ],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "days_in_year",
          "args": [
            "i"
          ],
          "line": 1051
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define SECDAY\t\t86400L\n#define\tSTARTOFTIME\t1970\n#define FEBRUARY\t2\n\nvoid to_tm(int tim, struct rtc_time * tm)\n{\n\tregister int    i;\n\tregister long   hms, day;\n\n\tday = tim / SECDAY;\n\thms = tim % SECDAY;\n\n\t/* Hours, minutes, seconds are easy */\n\ttm->tm_hour = hms / 3600;\n\ttm->tm_min = (hms % 3600) / 60;\n\ttm->tm_sec = (hms % 3600) % 60;\n\n\t/* Number of years in days */\n\tfor (i = STARTOFTIME; day >= days_in_year(i); i++)\n\t\tday -= days_in_year(i);\n\ttm->tm_year = i;\n\n\t/* Number of months in days left */\n\tif (leapyear(tm->tm_year))\n\t\tdays_in_month(FEBRUARY) = 29;\n\tfor (i = 1; day >= days_in_month(i); i++)\n\t\tday -= days_in_month(i);\n\tdays_in_month(FEBRUARY) = 28;\n\ttm->tm_mon = i;\n\n\t/* Days are what is left over (+1) from all that. */\n\ttm->tm_mday = day + 1;\n\n\t/*\n\t * Determine the day of week\n\t */\n\tGregorianDay(tm);\n}"
  },
  {
    "function_name": "GregorianDay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "1008-1034",
    "snippet": "void GregorianDay(struct rtc_time * tm)\n{\n\tint leapsToDate;\n\tint lastYear;\n\tint day;\n\tint MonthOffset[] = { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334 };\n\n\tlastYear = tm->tm_year - 1;\n\n\t/*\n\t * Number of leap corrections to apply up to end of last year\n\t */\n\tleapsToDate = lastYear / 4 - lastYear / 100 + lastYear / 400;\n\n\t/*\n\t * This year is a leap year if it is divisible by 4 except when it is\n\t * divisible by 100 unless it is divisible by 400\n\t *\n\t * e.g. 1904 was a leap year, 1900 was not, 1996 is, and 2000 was\n\t */\n\tday = tm->tm_mon > 2 && leapyear(tm->tm_year);\n\n\tday += lastYear*365 + leapsToDate + MonthOffset[tm->tm_mon-1] +\n\t\t   tm->tm_mday;\n\n\ttm->tm_wday = day % 7;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "leapyear",
          "args": [
            "tm->tm_year"
          ],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid GregorianDay(struct rtc_time * tm)\n{\n\tint leapsToDate;\n\tint lastYear;\n\tint day;\n\tint MonthOffset[] = { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334 };\n\n\tlastYear = tm->tm_year - 1;\n\n\t/*\n\t * Number of leap corrections to apply up to end of last year\n\t */\n\tleapsToDate = lastYear / 4 - lastYear / 100 + lastYear / 400;\n\n\t/*\n\t * This year is a leap year if it is divisible by 4 except when it is\n\t * divisible by 100 unless it is divisible by 400\n\t *\n\t * e.g. 1904 was a leap year, 1900 was not, 1996 is, and 2000 was\n\t */\n\tday = tm->tm_mon > 2 && leapyear(tm->tm_year);\n\n\tday += lastYear*365 + leapsToDate + MonthOffset[tm->tm_mon-1] +\n\t\t   tm->tm_mday;\n\n\ttm->tm_wday = day % 7;\n}"
  },
  {
    "function_name": "time_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "921-989",
    "snippet": "void __init time_init(void)\n{\n\tstruct div_result res;\n\tu64 scale;\n\tunsigned shift;\n\n\tif (__USE_RTC()) {\n\t\t/* 601 processor: dec counts down by 128 every 128ns */\n\t\tppc_tb_freq = 1000000000;\n\t} else {\n\t\t/* Normal PowerPC with timebase register */\n\t\tppc_md.calibrate_decr();\n\t\tprintk(KERN_DEBUG \"time_init: decrementer frequency = %lu.%.6lu MHz\\n\",\n\t\t       ppc_tb_freq / 1000000, ppc_tb_freq % 1000000);\n\t\tprintk(KERN_DEBUG \"time_init: processor frequency   = %lu.%.6lu MHz\\n\",\n\t\t       ppc_proc_freq / 1000000, ppc_proc_freq % 1000000);\n\t}\n\n\ttb_ticks_per_jiffy = ppc_tb_freq / HZ;\n\ttb_ticks_per_sec = ppc_tb_freq;\n\ttb_ticks_per_usec = ppc_tb_freq / 1000000;\n\tcalc_cputime_factors();\n\tsetup_cputime_one_jiffy();\n\n\t/*\n\t * Compute scale factor for sched_clock.\n\t * The calibrate_decr() function has set tb_ticks_per_sec,\n\t * which is the timebase frequency.\n\t * We compute 1e9 * 2^64 / tb_ticks_per_sec and interpret\n\t * the 128-bit result as a 64.64 fixed-point number.\n\t * We then shift that number right until it is less than 1.0,\n\t * giving us the scale factor and shift count to use in\n\t * sched_clock().\n\t */\n\tdiv128_by_32(1000000000, 0, tb_ticks_per_sec, &res);\n\tscale = res.result_low;\n\tfor (shift = 0; res.result_high != 0; ++shift) {\n\t\tscale = (scale >> 1) | (res.result_high << 63);\n\t\tres.result_high >>= 1;\n\t}\n\ttb_to_ns_scale = scale;\n\ttb_to_ns_shift = shift;\n\t/* Save the current timebase to pretty up CONFIG_PRINTK_TIME */\n\tboot_tb = get_tb_or_rtc();\n\n\t/* If platform provided a timezone (pmac), we correct the time */\n\tif (timezone_offset) {\n\t\tsys_tz.tz_minuteswest = -timezone_offset / 60;\n\t\tsys_tz.tz_dsttime = 0;\n\t}\n\n\tvdso_data->tb_update_count = 0;\n\tvdso_data->tb_ticks_per_sec = tb_ticks_per_sec;\n\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* Register the clocksource */\n\tclocksource_init();\n\n\tinit_decrementer_clockevent();\n\ttick_setup_hrtimer_broadcast();\n\n#ifdef CONFIG_COMMON_CLK\n\tof_clk_init(NULL);\n#endif\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static cycle_t rtc_read(struct clocksource *);",
      "static cycle_t timebase_read(struct clocksource *);",
      "unsigned long tb_ticks_per_jiffy;",
      "unsigned long tb_ticks_per_usec = 100;",
      "unsigned long tb_ticks_per_sec;",
      "static u64 tb_to_ns_scale",
      "extern struct timezone sys_tz;",
      "static long timezone_offset;",
      "unsigned long ppc_proc_freq;",
      "unsigned long ppc_tb_freq;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_clk_init",
          "args": [
            "NULL"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tick_setup_hrtimer_broadcast",
          "args": [],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_decrementer_clockevent",
          "args": [],
          "line": 983
        },
        "resolved": true,
        "details": {
          "function_name": "init_decrementer_clockevent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "894-906",
          "snippet": "static void __init init_decrementer_clockevent(void)\n{\n\tint cpu = smp_processor_id();\n\n\tclockevents_calc_mult_shift(&decrementer_clockevent, ppc_tb_freq, 4);\n\n\tdecrementer_clockevent.max_delta_ns =\n\t\tclockevent_delta2ns(DECREMENTER_MAX, &decrementer_clockevent);\n\tdecrementer_clockevent.min_delta_ns =\n\t\tclockevent_delta2ns(2, &decrementer_clockevent);\n\n\tregister_decrementer_clockevent(cpu);\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define DECREMENTER_MAX\t0x7fffffff"
          ],
          "globals_used": [
            "struct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};",
            "unsigned long ppc_tb_freq;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define DECREMENTER_MAX\t0x7fffffff\n\nstruct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};\nunsigned long ppc_tb_freq;\n\nstatic void __init init_decrementer_clockevent(void)\n{\n\tint cpu = smp_processor_id();\n\n\tclockevents_calc_mult_shift(&decrementer_clockevent, ppc_tb_freq, 4);\n\n\tdecrementer_clockevent.max_delta_ns =\n\t\tclockevent_delta2ns(DECREMENTER_MAX, &decrementer_clockevent);\n\tdecrementer_clockevent.min_delta_ns =\n\t\tclockevent_delta2ns(2, &decrementer_clockevent);\n\n\tregister_decrementer_clockevent(cpu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clocksource_init",
          "args": [],
          "line": 981
        },
        "resolved": true,
        "details": {
          "function_name": "clocksource_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "834-851",
          "snippet": "static void __init clocksource_init(void)\n{\n\tstruct clocksource *clock;\n\n\tif (__USE_RTC())\n\t\tclock = &clocksource_rtc;\n\telse\n\t\tclock = &clocksource_timebase;\n\n\tif (clocksource_register_hz(clock, tb_ticks_per_sec)) {\n\t\tprintk(KERN_ERR \"clocksource: %s is already registered\\n\",\n\t\t       clock->name);\n\t\treturn;\n\t}\n\n\tprintk(KERN_INFO \"clocksource: %s mult[%x] shift[%d] registered\\n\",\n\t       clock->name, clock->mult, clock->shift);\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static cycle_t rtc_read(struct clocksource *);",
            "static struct clocksource clocksource_rtc = {\n\t.name         = \"rtc\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = rtc_read,\n};",
            "static cycle_t timebase_read(struct clocksource *);",
            "static struct clocksource clocksource_timebase = {\n\t.name         = \"timebase\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = timebase_read,\n};",
            "unsigned long tb_ticks_per_sec;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic cycle_t rtc_read(struct clocksource *);\nstatic struct clocksource clocksource_rtc = {\n\t.name         = \"rtc\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = rtc_read,\n};\nstatic cycle_t timebase_read(struct clocksource *);\nstatic struct clocksource clocksource_timebase = {\n\t.name         = \"timebase\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = timebase_read,\n};\nunsigned long tb_ticks_per_sec;\n\nstatic void __init clocksource_init(void)\n{\n\tstruct clocksource *clock;\n\n\tif (__USE_RTC())\n\t\tclock = &clocksource_rtc;\n\telse\n\t\tclock = &clocksource_timebase;\n\n\tif (clocksource_register_hz(clock, tb_ticks_per_sec)) {\n\t\tprintk(KERN_ERR \"clocksource: %s is already registered\\n\",\n\t\t       clock->name);\n\t\treturn;\n\t}\n\n\tprintk(KERN_INFO \"clocksource: %s mult[%x] shift[%d] registered\\n\",\n\t       clock->name, clock->mult, clock->shift);\n}"
        }
      },
      {
        "call_info": {
          "callee": "start_cpu_decrementer",
          "args": [],
          "line": 978
        },
        "resolved": true,
        "details": {
          "function_name": "start_cpu_decrementer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "686-695",
          "snippet": "static void start_cpu_decrementer(void)\n{\n#if defined(CONFIG_BOOKE) || defined(CONFIG_40x)\n\t/* Clear any pending timer interrupts */\n\tmtspr(SPRN_TSR, TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS);\n\n\t/* Enable decrementer interrupt */\n\tmtspr(SPRN_TCR, TCR_DIE);\n#endif /* defined(CONFIG_BOOKE) || defined(CONFIG_40x) */\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void start_cpu_decrementer(void)\n{\n#if defined(CONFIG_BOOKE) || defined(CONFIG_40x)\n\t/* Clear any pending timer interrupts */\n\tmtspr(SPRN_TSR, TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS);\n\n\t/* Enable decrementer interrupt */\n\tmtspr(SPRN_TCR, TCR_DIE);\n#endif /* defined(CONFIG_BOOKE) || defined(CONFIG_40x) */\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_tb_or_rtc",
          "args": [],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div128_by_32",
          "args": [
            "1000000000",
            "0",
            "tb_ticks_per_sec",
            "&res"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "div128_by_32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "1077-1104",
          "snippet": "void div128_by_32(u64 dividend_high, u64 dividend_low,\n\t\t  unsigned divisor, struct div_result *dr)\n{\n\tunsigned long a, b, c, d;\n\tunsigned long w, x, y, z;\n\tu64 ra, rb, rc;\n\n\ta = dividend_high >> 32;\n\tb = dividend_high & 0xffffffff;\n\tc = dividend_low >> 32;\n\td = dividend_low & 0xffffffff;\n\n\tw = a / divisor;\n\tra = ((u64)(a - (w * divisor)) << 32) + b;\n\n\trb = ((u64) do_div(ra, divisor) << 32) + c;\n\tx = ra;\n\n\trc = ((u64) do_div(rb, divisor) << 32) + d;\n\ty = rb;\n\n\tdo_div(rc, divisor);\n\tz = rc;\n\n\tdr->result_high = ((u64)w << 32) + x;\n\tdr->result_low  = ((u64)y << 32) + z;\n\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid div128_by_32(u64 dividend_high, u64 dividend_low,\n\t\t  unsigned divisor, struct div_result *dr)\n{\n\tunsigned long a, b, c, d;\n\tunsigned long w, x, y, z;\n\tu64 ra, rb, rc;\n\n\ta = dividend_high >> 32;\n\tb = dividend_high & 0xffffffff;\n\tc = dividend_low >> 32;\n\td = dividend_low & 0xffffffff;\n\n\tw = a / divisor;\n\tra = ((u64)(a - (w * divisor)) << 32) + b;\n\n\trb = ((u64) do_div(ra, divisor) << 32) + c;\n\tx = ra;\n\n\trc = ((u64) do_div(rb, divisor) << 32) + d;\n\ty = rb;\n\n\tdo_div(rc, divisor);\n\tz = rc;\n\n\tdr->result_high = ((u64)w << 32) + x;\n\tdr->result_low  = ((u64)y << 32) + z;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup_cputime_one_jiffy",
          "args": [],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "calc_cputime_factors",
          "args": [],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "calc_cputime_factors",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "170-182",
          "snippet": "static void calc_cputime_factors(void)\n{\n\tstruct div_result res;\n\n\tdiv128_by_32(HZ, 0, tb_ticks_per_sec, &res);\n\t__cputime_jiffies_factor = res.result_low;\n\tdiv128_by_32(1000000, 0, tb_ticks_per_sec, &res);\n\t__cputime_usec_factor = res.result_low;\n\tdiv128_by_32(1, 0, tb_ticks_per_sec, &res);\n\t__cputime_sec_factor = res.result_low;\n\tdiv128_by_32(USER_HZ, 0, tb_ticks_per_sec, &res);\n\t__cputime_clockt_factor = res.result_low;\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned long tb_ticks_per_sec;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long tb_ticks_per_sec;\n\nstatic void calc_cputime_factors(void)\n{\n\tstruct div_result res;\n\n\tdiv128_by_32(HZ, 0, tb_ticks_per_sec, &res);\n\t__cputime_jiffies_factor = res.result_low;\n\tdiv128_by_32(1000000, 0, tb_ticks_per_sec, &res);\n\t__cputime_usec_factor = res.result_low;\n\tdiv128_by_32(1, 0, tb_ticks_per_sec, &res);\n\t__cputime_sec_factor = res.result_low;\n\tdiv128_by_32(USER_HZ, 0, tb_ticks_per_sec, &res);\n\t__cputime_clockt_factor = res.result_low;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_DEBUG \"time_init: processor frequency   = %lu.%.6lu MHz\\n\"",
            "ppc_proc_freq / 1000000",
            "ppc_proc_freq % 1000000"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_DEBUG \"time_init: decrementer frequency = %lu.%.6lu MHz\\n\"",
            "ppc_tb_freq / 1000000",
            "ppc_tb_freq % 1000000"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.calibrate_decr",
          "args": [],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__USE_RTC",
          "args": [],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic cycle_t rtc_read(struct clocksource *);\nstatic cycle_t timebase_read(struct clocksource *);\nunsigned long tb_ticks_per_jiffy;\nunsigned long tb_ticks_per_usec = 100;\nunsigned long tb_ticks_per_sec;\nstatic u64 tb_to_ns_scale;\nextern struct timezone sys_tz;\nstatic long timezone_offset;\nunsigned long ppc_proc_freq;\nunsigned long ppc_tb_freq;\n\nvoid __init time_init(void)\n{\n\tstruct div_result res;\n\tu64 scale;\n\tunsigned shift;\n\n\tif (__USE_RTC()) {\n\t\t/* 601 processor: dec counts down by 128 every 128ns */\n\t\tppc_tb_freq = 1000000000;\n\t} else {\n\t\t/* Normal PowerPC with timebase register */\n\t\tppc_md.calibrate_decr();\n\t\tprintk(KERN_DEBUG \"time_init: decrementer frequency = %lu.%.6lu MHz\\n\",\n\t\t       ppc_tb_freq / 1000000, ppc_tb_freq % 1000000);\n\t\tprintk(KERN_DEBUG \"time_init: processor frequency   = %lu.%.6lu MHz\\n\",\n\t\t       ppc_proc_freq / 1000000, ppc_proc_freq % 1000000);\n\t}\n\n\ttb_ticks_per_jiffy = ppc_tb_freq / HZ;\n\ttb_ticks_per_sec = ppc_tb_freq;\n\ttb_ticks_per_usec = ppc_tb_freq / 1000000;\n\tcalc_cputime_factors();\n\tsetup_cputime_one_jiffy();\n\n\t/*\n\t * Compute scale factor for sched_clock.\n\t * The calibrate_decr() function has set tb_ticks_per_sec,\n\t * which is the timebase frequency.\n\t * We compute 1e9 * 2^64 / tb_ticks_per_sec and interpret\n\t * the 128-bit result as a 64.64 fixed-point number.\n\t * We then shift that number right until it is less than 1.0,\n\t * giving us the scale factor and shift count to use in\n\t * sched_clock().\n\t */\n\tdiv128_by_32(1000000000, 0, tb_ticks_per_sec, &res);\n\tscale = res.result_low;\n\tfor (shift = 0; res.result_high != 0; ++shift) {\n\t\tscale = (scale >> 1) | (res.result_high << 63);\n\t\tres.result_high >>= 1;\n\t}\n\ttb_to_ns_scale = scale;\n\ttb_to_ns_shift = shift;\n\t/* Save the current timebase to pretty up CONFIG_PRINTK_TIME */\n\tboot_tb = get_tb_or_rtc();\n\n\t/* If platform provided a timezone (pmac), we correct the time */\n\tif (timezone_offset) {\n\t\tsys_tz.tz_minuteswest = -timezone_offset / 60;\n\t\tsys_tz.tz_dsttime = 0;\n\t}\n\n\tvdso_data->tb_update_count = 0;\n\tvdso_data->tb_ticks_per_sec = tb_ticks_per_sec;\n\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* Register the clocksource */\n\tclocksource_init();\n\n\tinit_decrementer_clockevent();\n\ttick_setup_hrtimer_broadcast();\n\n#ifdef CONFIG_COMMON_CLK\n\tof_clk_init(NULL);\n#endif\n}"
  },
  {
    "function_name": "secondary_cpu_time_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "908-918",
    "snippet": "void secondary_cpu_time_init(void)\n{\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* FIME: Should make unrelatred change to move snapshot_timebase\n\t * call here ! */\n\tregister_decrementer_clockevent(smp_processor_id());\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_decrementer_clockevent",
          "args": [
            "smp_processor_id()"
          ],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "register_decrementer_clockevent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "881-892",
          "snippet": "static void register_decrementer_clockevent(int cpu)\n{\n\tstruct clock_event_device *dec = &per_cpu(decrementers, cpu);\n\n\t*dec = decrementer_clockevent;\n\tdec->cpumask = cpumask_of(cpu);\n\n\tprintk_once(KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\",\n\t\t    dec->name, dec->mult, dec->shift, cpu);\n\n\tclockevents_register_device(dec);\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};",
            "static DEFINE_PER_CPU(struct clock_event_device, decrementers);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstruct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};\nstatic DEFINE_PER_CPU(struct clock_event_device, decrementers);\n\nstatic void register_decrementer_clockevent(int cpu)\n{\n\tstruct clock_event_device *dec = &per_cpu(decrementers, cpu);\n\n\t*dec = decrementer_clockevent;\n\tdec->cpumask = cpumask_of(cpu);\n\n\tprintk_once(KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\",\n\t\t    dec->name, dec->mult, dec->shift, cpu);\n\n\tclockevents_register_device(dec);\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "start_cpu_decrementer",
          "args": [],
          "line": 913
        },
        "resolved": true,
        "details": {
          "function_name": "start_cpu_decrementer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "686-695",
          "snippet": "static void start_cpu_decrementer(void)\n{\n#if defined(CONFIG_BOOKE) || defined(CONFIG_40x)\n\t/* Clear any pending timer interrupts */\n\tmtspr(SPRN_TSR, TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS);\n\n\t/* Enable decrementer interrupt */\n\tmtspr(SPRN_TCR, TCR_DIE);\n#endif /* defined(CONFIG_BOOKE) || defined(CONFIG_40x) */\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void start_cpu_decrementer(void)\n{\n#if defined(CONFIG_BOOKE) || defined(CONFIG_40x)\n\t/* Clear any pending timer interrupts */\n\tmtspr(SPRN_TSR, TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS);\n\n\t/* Enable decrementer interrupt */\n\tmtspr(SPRN_TCR, TCR_DIE);\n#endif /* defined(CONFIG_BOOKE) || defined(CONFIG_40x) */\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid secondary_cpu_time_init(void)\n{\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* FIME: Should make unrelatred change to move snapshot_timebase\n\t * call here ! */\n\tregister_decrementer_clockevent(smp_processor_id());\n}"
  },
  {
    "function_name": "init_decrementer_clockevent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "894-906",
    "snippet": "static void __init init_decrementer_clockevent(void)\n{\n\tint cpu = smp_processor_id();\n\n\tclockevents_calc_mult_shift(&decrementer_clockevent, ppc_tb_freq, 4);\n\n\tdecrementer_clockevent.max_delta_ns =\n\t\tclockevent_delta2ns(DECREMENTER_MAX, &decrementer_clockevent);\n\tdecrementer_clockevent.min_delta_ns =\n\t\tclockevent_delta2ns(2, &decrementer_clockevent);\n\n\tregister_decrementer_clockevent(cpu);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define DECREMENTER_MAX\t0x7fffffff"
    ],
    "globals_used": [
      "struct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};",
      "unsigned long ppc_tb_freq;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_decrementer_clockevent",
          "args": [
            "cpu"
          ],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "register_decrementer_clockevent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "881-892",
          "snippet": "static void register_decrementer_clockevent(int cpu)\n{\n\tstruct clock_event_device *dec = &per_cpu(decrementers, cpu);\n\n\t*dec = decrementer_clockevent;\n\tdec->cpumask = cpumask_of(cpu);\n\n\tprintk_once(KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\",\n\t\t    dec->name, dec->mult, dec->shift, cpu);\n\n\tclockevents_register_device(dec);\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};",
            "static DEFINE_PER_CPU(struct clock_event_device, decrementers);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstruct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};\nstatic DEFINE_PER_CPU(struct clock_event_device, decrementers);\n\nstatic void register_decrementer_clockevent(int cpu)\n{\n\tstruct clock_event_device *dec = &per_cpu(decrementers, cpu);\n\n\t*dec = decrementer_clockevent;\n\tdec->cpumask = cpumask_of(cpu);\n\n\tprintk_once(KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\",\n\t\t    dec->name, dec->mult, dec->shift, cpu);\n\n\tclockevents_register_device(dec);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clockevent_delta2ns",
          "args": [
            "2",
            "&decrementer_clockevent"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clockevent_delta2ns",
          "args": [
            "DECREMENTER_MAX",
            "&decrementer_clockevent"
          ],
          "line": 901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clockevents_calc_mult_shift",
          "args": [
            "&decrementer_clockevent",
            "ppc_tb_freq",
            "4"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define DECREMENTER_MAX\t0x7fffffff\n\nstruct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};\nunsigned long ppc_tb_freq;\n\nstatic void __init init_decrementer_clockevent(void)\n{\n\tint cpu = smp_processor_id();\n\n\tclockevents_calc_mult_shift(&decrementer_clockevent, ppc_tb_freq, 4);\n\n\tdecrementer_clockevent.max_delta_ns =\n\t\tclockevent_delta2ns(DECREMENTER_MAX, &decrementer_clockevent);\n\tdecrementer_clockevent.min_delta_ns =\n\t\tclockevent_delta2ns(2, &decrementer_clockevent);\n\n\tregister_decrementer_clockevent(cpu);\n}"
  },
  {
    "function_name": "register_decrementer_clockevent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "881-892",
    "snippet": "static void register_decrementer_clockevent(int cpu)\n{\n\tstruct clock_event_device *dec = &per_cpu(decrementers, cpu);\n\n\t*dec = decrementer_clockevent;\n\tdec->cpumask = cpumask_of(cpu);\n\n\tprintk_once(KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\",\n\t\t    dec->name, dec->mult, dec->shift, cpu);\n\n\tclockevents_register_device(dec);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};",
      "static DEFINE_PER_CPU(struct clock_event_device, decrementers);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "clockevents_register_device",
          "args": [
            "dec"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk_once",
          "args": [
            "KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\"",
            "dec->name",
            "dec->mult",
            "dec->shift",
            "cpu"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_of",
          "args": [
            "cpu"
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "decrementers",
            "cpu"
          ],
          "line": 883
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstruct clock_event_device decrementer_clockevent = {\n\t.name\t\t\t= \"decrementer\",\n\t.rating\t\t\t= 200,\n\t.irq\t\t\t= 0,\n\t.set_next_event\t\t= decrementer_set_next_event,\n\t.set_state_shutdown\t= decrementer_shutdown,\n\t.tick_resume\t\t= decrementer_shutdown,\n\t.features\t\t= CLOCK_EVT_FEAT_ONESHOT |\n\t\t\t\t  CLOCK_EVT_FEAT_C3STOP,\n};\nstatic DEFINE_PER_CPU(struct clock_event_device, decrementers);\n\nstatic void register_decrementer_clockevent(int cpu)\n{\n\tstruct clock_event_device *dec = &per_cpu(decrementers, cpu);\n\n\t*dec = decrementer_clockevent;\n\tdec->cpumask = cpumask_of(cpu);\n\n\tprintk_once(KERN_DEBUG \"clockevent: %s mult[%x] shift[%d] cpu[%d]\\n\",\n\t\t    dec->name, dec->mult, dec->shift, cpu);\n\n\tclockevents_register_device(dec);\n}"
  },
  {
    "function_name": "tick_broadcast_ipi_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "873-879",
    "snippet": "void tick_broadcast_ipi_handler(void)\n{\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t*next_tb = get_tb_or_rtc();\n\t__timer_interrupt();\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__timer_interrupt",
          "args": [],
          "line": 878
        },
        "resolved": true,
        "details": {
          "function_name": "__timer_interrupt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "484-523",
          "snippet": "static void __timer_interrupt(void)\n{\n\tstruct pt_regs *regs = get_irq_regs();\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\tstruct clock_event_device *evt = this_cpu_ptr(&decrementers);\n\tu64 now;\n\n\ttrace_timer_interrupt_entry(regs);\n\n\tif (test_irq_work_pending()) {\n\t\tclear_irq_work_pending();\n\t\tirq_work_run();\n\t}\n\n\tnow = get_tb_or_rtc();\n\tif (now >= *next_tb) {\n\t\t*next_tb = ~(u64)0;\n\t\tif (evt->event_handler)\n\t\t\tevt->event_handler(evt);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_event);\n\t} else {\n\t\tnow = *next_tb - now;\n\t\tif (now <= DECREMENTER_MAX)\n\t\t\tset_dec((int)now);\n\t\t/* We may have raced with new irq work */\n\t\tif (test_irq_work_pending())\n\t\t\tset_dec(1);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_others);\n\t}\n\n#ifdef CONFIG_PPC64\n\t/* collect purr register values often, for accurate calculations */\n\tif (firmware_has_feature(FW_FEATURE_SPLPAR)) {\n\t\tstruct cpu_usage *cu = this_cpu_ptr(&cpu_usage_array);\n\t\tcu->current_tb = mfspr(SPRN_PURR);\n\t}\n#endif\n\n\ttrace_timer_interrupt_exit(regs);\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define DECREMENTER_MAX\t0x7fffffff"
          ],
          "globals_used": [
            "static int decrementer_shutdown(struct clock_event_device *evt);",
            "static DEFINE_PER_CPU(struct clock_event_device, decrementers);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define DECREMENTER_MAX\t0x7fffffff\n\nstatic int decrementer_shutdown(struct clock_event_device *evt);\nstatic DEFINE_PER_CPU(struct clock_event_device, decrementers);\n\nstatic void __timer_interrupt(void)\n{\n\tstruct pt_regs *regs = get_irq_regs();\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\tstruct clock_event_device *evt = this_cpu_ptr(&decrementers);\n\tu64 now;\n\n\ttrace_timer_interrupt_entry(regs);\n\n\tif (test_irq_work_pending()) {\n\t\tclear_irq_work_pending();\n\t\tirq_work_run();\n\t}\n\n\tnow = get_tb_or_rtc();\n\tif (now >= *next_tb) {\n\t\t*next_tb = ~(u64)0;\n\t\tif (evt->event_handler)\n\t\t\tevt->event_handler(evt);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_event);\n\t} else {\n\t\tnow = *next_tb - now;\n\t\tif (now <= DECREMENTER_MAX)\n\t\t\tset_dec((int)now);\n\t\t/* We may have raced with new irq work */\n\t\tif (test_irq_work_pending())\n\t\t\tset_dec(1);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_others);\n\t}\n\n#ifdef CONFIG_PPC64\n\t/* collect purr register values often, for accurate calculations */\n\tif (firmware_has_feature(FW_FEATURE_SPLPAR)) {\n\t\tstruct cpu_usage *cu = this_cpu_ptr(&cpu_usage_array);\n\t\tcu->current_tb = mfspr(SPRN_PURR);\n\t}\n#endif\n\n\ttrace_timer_interrupt_exit(regs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_tb_or_rtc",
          "args": [],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&decrementers_next_tb"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid tick_broadcast_ipi_handler(void)\n{\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t*next_tb = get_tb_or_rtc();\n\t__timer_interrupt();\n}"
  },
  {
    "function_name": "decrementer_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "866-870",
    "snippet": "static int decrementer_shutdown(struct clock_event_device *dev)\n{\n\tdecrementer_set_next_event(DECREMENTER_MAX, dev);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define DECREMENTER_MAX\t0x7fffffff"
    ],
    "globals_used": [
      "static int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "decrementer_set_next_event",
          "args": [
            "DECREMENTER_MAX",
            "dev"
          ],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "decrementer_set_next_event",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "853-864",
          "snippet": "static int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev)\n{\n\t__this_cpu_write(decrementers_next_tb, get_tb_or_rtc() + evt);\n\tset_dec(evt);\n\n\t/* We may have raced with new irq work */\n\tif (test_irq_work_pending())\n\t\tset_dec(1);\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);",
            "static int decrementer_shutdown(struct clock_event_device *evt);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);\nstatic int decrementer_shutdown(struct clock_event_device *evt);\n\nstatic int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev)\n{\n\t__this_cpu_write(decrementers_next_tb, get_tb_or_rtc() + evt);\n\tset_dec(evt);\n\n\t/* We may have raced with new irq work */\n\tif (test_irq_work_pending())\n\t\tset_dec(1);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define DECREMENTER_MAX\t0x7fffffff\n\nstatic int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);\n\nstatic int decrementer_shutdown(struct clock_event_device *dev)\n{\n\tdecrementer_set_next_event(DECREMENTER_MAX, dev);\n\treturn 0;\n}"
  },
  {
    "function_name": "decrementer_set_next_event",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "853-864",
    "snippet": "static int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev)\n{\n\t__this_cpu_write(decrementers_next_tb, get_tb_or_rtc() + evt);\n\tset_dec(evt);\n\n\t/* We may have raced with new irq work */\n\tif (test_irq_work_pending())\n\t\tset_dec(1);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);",
      "static int decrementer_shutdown(struct clock_event_device *evt);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "1"
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_irq_work_pending",
          "args": [],
          "line": 860
        },
        "resolved": true,
        "details": {
          "function_name": "test_irq_work_pending",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "435-443",
          "snippet": "static inline unsigned long test_irq_work_pending(void)\n{\n\tunsigned long x;\n\n\tasm volatile(\"lbz %0,%1(13)\"\n\t\t: \"=r\" (x)\n\t\t: \"i\" (offsetof(struct paca_struct, irq_work_pending)));\n\treturn x;\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline unsigned long test_irq_work_pending(void)\n{\n\tunsigned long x;\n\n\tasm volatile(\"lbz %0,%1(13)\"\n\t\t: \"=r\" (x)\n\t\t: \"i\" (offsetof(struct paca_struct, irq_work_pending)));\n\treturn x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "evt"
          ],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__this_cpu_write",
          "args": [
            "decrementers_next_tb",
            "get_tb_or_rtc() + evt"
          ],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_tb_or_rtc",
          "args": [],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev);\nstatic int decrementer_shutdown(struct clock_event_device *evt);\n\nstatic int decrementer_set_next_event(unsigned long evt,\n\t\t\t\t      struct clock_event_device *dev)\n{\n\t__this_cpu_write(decrementers_next_tb, get_tb_or_rtc() + evt);\n\tset_dec(evt);\n\n\t/* We may have raced with new irq work */\n\tif (test_irq_work_pending())\n\t\tset_dec(1);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "clocksource_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "834-851",
    "snippet": "static void __init clocksource_init(void)\n{\n\tstruct clocksource *clock;\n\n\tif (__USE_RTC())\n\t\tclock = &clocksource_rtc;\n\telse\n\t\tclock = &clocksource_timebase;\n\n\tif (clocksource_register_hz(clock, tb_ticks_per_sec)) {\n\t\tprintk(KERN_ERR \"clocksource: %s is already registered\\n\",\n\t\t       clock->name);\n\t\treturn;\n\t}\n\n\tprintk(KERN_INFO \"clocksource: %s mult[%x] shift[%d] registered\\n\",\n\t       clock->name, clock->mult, clock->shift);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static cycle_t rtc_read(struct clocksource *);",
      "static struct clocksource clocksource_rtc = {\n\t.name         = \"rtc\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = rtc_read,\n};",
      "static cycle_t timebase_read(struct clocksource *);",
      "static struct clocksource clocksource_timebase = {\n\t.name         = \"timebase\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = timebase_read,\n};",
      "unsigned long tb_ticks_per_sec;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"clocksource: %s mult[%x] shift[%d] registered\\n\"",
            "clock->name",
            "clock->mult",
            "clock->shift"
          ],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"clocksource: %s is already registered\\n\"",
            "clock->name"
          ],
          "line": 844
        },
        "resolved": true,
        "details": {
          "function_name": "printk_log_rtas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/rtasd.c",
          "lines": "111-156",
          "snippet": "static void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s, Severity: %d\\n\",\n\t\t       error_log_cnt, rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_severity(errlog));\n\t}\n}",
          "includes": [
            "#include <asm/topology.h>",
            "#include <asm/machdep.h>",
            "#include <linux/atomic.h>",
            "#include <asm/nvram.h>",
            "#include <asm/prom.h>",
            "#include <asm/rtas.h>",
            "#include <asm/io.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/cpu.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int full_rtas_msgs = 0;",
            "static int error_log_cnt;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/topology.h>\n#include <asm/machdep.h>\n#include <linux/atomic.h>\n#include <asm/nvram.h>\n#include <asm/prom.h>\n#include <asm/rtas.h>\n#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/cpu.h>\n#include <linux/spinlock.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic int full_rtas_msgs = 0;\nstatic int error_log_cnt;\n\nstatic void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s, Severity: %d\\n\",\n\t\t       error_log_cnt, rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_severity(errlog));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "clocksource_register_hz",
          "args": [
            "clock",
            "tb_ticks_per_sec"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__USE_RTC",
          "args": [],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic cycle_t rtc_read(struct clocksource *);\nstatic struct clocksource clocksource_rtc = {\n\t.name         = \"rtc\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = rtc_read,\n};\nstatic cycle_t timebase_read(struct clocksource *);\nstatic struct clocksource clocksource_timebase = {\n\t.name         = \"timebase\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = timebase_read,\n};\nunsigned long tb_ticks_per_sec;\n\nstatic void __init clocksource_init(void)\n{\n\tstruct clocksource *clock;\n\n\tif (__USE_RTC())\n\t\tclock = &clocksource_rtc;\n\telse\n\t\tclock = &clocksource_timebase;\n\n\tif (clocksource_register_hz(clock, tb_ticks_per_sec)) {\n\t\tprintk(KERN_ERR \"clocksource: %s is already registered\\n\",\n\t\t       clock->name);\n\t\treturn;\n\t}\n\n\tprintk(KERN_INFO \"clocksource: %s mult[%x] shift[%d] registered\\n\",\n\t       clock->name, clock->mult, clock->shift);\n}"
  },
  {
    "function_name": "update_vsyscall_tz",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "828-832",
    "snippet": "void update_vsyscall_tz(void)\n{\n\tvdso_data->tz_minuteswest = sys_tz.tz_minuteswest;\n\tvdso_data->tz_dsttime = sys_tz.tz_dsttime;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct timezone sys_tz;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nextern struct timezone sys_tz;\n\nvoid update_vsyscall_tz(void)\n{\n\tvdso_data->tz_minuteswest = sys_tz.tz_minuteswest;\n\tvdso_data->tz_dsttime = sys_tz.tz_dsttime;\n}"
  },
  {
    "function_name": "update_vsyscall_old",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "783-826",
    "snippet": "void update_vsyscall_old(struct timespec *wall_time, struct timespec *wtm,\n\t\t\t struct clocksource *clock, u32 mult, cycle_t cycle_last)\n{\n\tu64 new_tb_to_xs, new_stamp_xsec;\n\tu32 frac_sec;\n\n\tif (clock != &clocksource_timebase)\n\t\treturn;\n\n\t/* Make userspace gettimeofday spin until we're done. */\n\t++vdso_data->tb_update_count;\n\tsmp_mb();\n\n\t/* 19342813113834067 ~= 2^(20+64) / 1e9 */\n\tnew_tb_to_xs = (u64) mult * (19342813113834067ULL >> clock->shift);\n\tnew_stamp_xsec = (u64) wall_time->tv_nsec * XSEC_PER_SEC;\n\tdo_div(new_stamp_xsec, 1000000000);\n\tnew_stamp_xsec += (u64) wall_time->tv_sec * XSEC_PER_SEC;\n\n\tBUG_ON(wall_time->tv_nsec >= NSEC_PER_SEC);\n\t/* this is tv_nsec / 1e9 as a 0.32 fraction */\n\tfrac_sec = ((u64) wall_time->tv_nsec * 18446744073ULL) >> 32;\n\n\t/*\n\t * tb_update_count is used to allow the userspace gettimeofday code\n\t * to assure itself that it sees a consistent view of the tb_to_xs and\n\t * stamp_xsec variables.  It reads the tb_update_count, then reads\n\t * tb_to_xs and stamp_xsec and then reads tb_update_count again.  If\n\t * the two values of tb_update_count match and are even then the\n\t * tb_to_xs and stamp_xsec values are consistent.  If not, then it\n\t * loops back and reads them again until this criteria is met.\n\t * We expect the caller to have done the first increment of\n\t * vdso_data->tb_update_count already.\n\t */\n\tvdso_data->tb_orig_stamp = cycle_last;\n\tvdso_data->stamp_xsec = new_stamp_xsec;\n\tvdso_data->tb_to_xs = new_tb_to_xs;\n\tvdso_data->wtom_clock_sec = wtm->tv_sec;\n\tvdso_data->wtom_clock_nsec = wtm->tv_nsec;\n\tvdso_data->stamp_xtime = *wall_time;\n\tvdso_data->stamp_sec_fraction = frac_sec;\n\tsmp_wmb();\n\t++(vdso_data->tb_update_count);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define XSEC_PER_SEC (1024*1024)"
    ],
    "globals_used": [
      "static cycle_t rtc_read(struct clocksource *);",
      "static cycle_t timebase_read(struct clocksource *);",
      "static struct clocksource clocksource_timebase = {\n\t.name         = \"timebase\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = timebase_read,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_wmb",
          "args": [],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "wall_time->tv_nsec >= NSEC_PER_SEC"
          ],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "new_stamp_xsec",
            "1000000000"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define XSEC_PER_SEC (1024*1024)\n\nstatic cycle_t rtc_read(struct clocksource *);\nstatic cycle_t timebase_read(struct clocksource *);\nstatic struct clocksource clocksource_timebase = {\n\t.name         = \"timebase\",\n\t.rating       = 400,\n\t.flags        = CLOCK_SOURCE_IS_CONTINUOUS,\n\t.mask         = CLOCKSOURCE_MASK(64),\n\t.read         = timebase_read,\n};\n\nvoid update_vsyscall_old(struct timespec *wall_time, struct timespec *wtm,\n\t\t\t struct clocksource *clock, u32 mult, cycle_t cycle_last)\n{\n\tu64 new_tb_to_xs, new_stamp_xsec;\n\tu32 frac_sec;\n\n\tif (clock != &clocksource_timebase)\n\t\treturn;\n\n\t/* Make userspace gettimeofday spin until we're done. */\n\t++vdso_data->tb_update_count;\n\tsmp_mb();\n\n\t/* 19342813113834067 ~= 2^(20+64) / 1e9 */\n\tnew_tb_to_xs = (u64) mult * (19342813113834067ULL >> clock->shift);\n\tnew_stamp_xsec = (u64) wall_time->tv_nsec * XSEC_PER_SEC;\n\tdo_div(new_stamp_xsec, 1000000000);\n\tnew_stamp_xsec += (u64) wall_time->tv_sec * XSEC_PER_SEC;\n\n\tBUG_ON(wall_time->tv_nsec >= NSEC_PER_SEC);\n\t/* this is tv_nsec / 1e9 as a 0.32 fraction */\n\tfrac_sec = ((u64) wall_time->tv_nsec * 18446744073ULL) >> 32;\n\n\t/*\n\t * tb_update_count is used to allow the userspace gettimeofday code\n\t * to assure itself that it sees a consistent view of the tb_to_xs and\n\t * stamp_xsec variables.  It reads the tb_update_count, then reads\n\t * tb_to_xs and stamp_xsec and then reads tb_update_count again.  If\n\t * the two values of tb_update_count match and are even then the\n\t * tb_to_xs and stamp_xsec values are consistent.  If not, then it\n\t * loops back and reads them again until this criteria is met.\n\t * We expect the caller to have done the first increment of\n\t * vdso_data->tb_update_count already.\n\t */\n\tvdso_data->tb_orig_stamp = cycle_last;\n\tvdso_data->stamp_xsec = new_stamp_xsec;\n\tvdso_data->tb_to_xs = new_tb_to_xs;\n\tvdso_data->wtom_clock_sec = wtm->tv_sec;\n\tvdso_data->wtom_clock_nsec = wtm->tv_nsec;\n\tvdso_data->stamp_xtime = *wall_time;\n\tvdso_data->stamp_sec_fraction = frac_sec;\n\tsmp_wmb();\n\t++(vdso_data->tb_update_count);\n}"
  },
  {
    "function_name": "timebase_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "778-781",
    "snippet": "static cycle_t timebase_read(struct clocksource *cs)\n{\n\treturn (cycle_t)get_tb();\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static cycle_t rtc_read(struct clocksource *);",
      "static cycle_t timebase_read(struct clocksource *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_tb",
          "args": [],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic cycle_t rtc_read(struct clocksource *);\nstatic cycle_t timebase_read(struct clocksource *);\n\nstatic cycle_t timebase_read(struct clocksource *cs)\n{\n\treturn (cycle_t)get_tb();\n}"
  },
  {
    "function_name": "rtc_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "773-776",
    "snippet": "static cycle_t rtc_read(struct clocksource *cs)\n{\n\treturn (cycle_t)get_rtc();\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static cycle_t rtc_read(struct clocksource *);",
      "static cycle_t timebase_read(struct clocksource *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_rtc",
          "args": [],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic cycle_t rtc_read(struct clocksource *);\nstatic cycle_t timebase_read(struct clocksource *);\n\nstatic cycle_t rtc_read(struct clocksource *cs)\n{\n\treturn (cycle_t)get_rtc();\n}"
  },
  {
    "function_name": "read_persistent_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "760-770",
    "snippet": "void read_persistent_clock(struct timespec *ts)\n{\n\t__read_persistent_clock(ts);\n\n\t/* Sanitize it in case real time clock is set below EPOCH */\n\tif (ts->tv_sec < 0) {\n\t\tts->tv_sec = 0;\n\t\tts->tv_nsec = 0;\n\t}\n\t\t\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__read_persistent_clock",
          "args": [
            "ts"
          ],
          "line": 762
        },
        "resolved": true,
        "details": {
          "function_name": "__read_persistent_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "732-758",
          "snippet": "static void __read_persistent_clock(struct timespec *ts)\n{\n\tstruct rtc_time tm;\n\tstatic int first = 1;\n\n\tts->tv_nsec = 0;\n\t/* XXX this is a litle fragile but will work okay in the short term */\n\tif (first) {\n\t\tfirst = 0;\n\t\tif (ppc_md.time_init)\n\t\t\ttimezone_offset = ppc_md.time_init();\n\n\t\t/* get_boot_time() isn't guaranteed to be safe to call late */\n\t\tif (ppc_md.get_boot_time) {\n\t\t\tts->tv_sec = ppc_md.get_boot_time() - timezone_offset;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!ppc_md.get_rtc_time) {\n\t\tts->tv_sec = 0;\n\t\treturn;\n\t}\n\tppc_md.get_rtc_time(&tm);\n\n\tts->tv_sec = mktime(tm.tm_year+1900, tm.tm_mon+1, tm.tm_mday,\n\t\t\t    tm.tm_hour, tm.tm_min, tm.tm_sec);\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static long timezone_offset;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic long timezone_offset;\n\nstatic void __read_persistent_clock(struct timespec *ts)\n{\n\tstruct rtc_time tm;\n\tstatic int first = 1;\n\n\tts->tv_nsec = 0;\n\t/* XXX this is a litle fragile but will work okay in the short term */\n\tif (first) {\n\t\tfirst = 0;\n\t\tif (ppc_md.time_init)\n\t\t\ttimezone_offset = ppc_md.time_init();\n\n\t\t/* get_boot_time() isn't guaranteed to be safe to call late */\n\t\tif (ppc_md.get_boot_time) {\n\t\t\tts->tv_sec = ppc_md.get_boot_time() - timezone_offset;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!ppc_md.get_rtc_time) {\n\t\tts->tv_sec = 0;\n\t\treturn;\n\t}\n\tppc_md.get_rtc_time(&tm);\n\n\tts->tv_sec = mktime(tm.tm_year+1900, tm.tm_mon+1, tm.tm_mday,\n\t\t\t    tm.tm_hour, tm.tm_min, tm.tm_sec);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid read_persistent_clock(struct timespec *ts)\n{\n\t__read_persistent_clock(ts);\n\n\t/* Sanitize it in case real time clock is set below EPOCH */\n\tif (ts->tv_sec < 0) {\n\t\tts->tv_sec = 0;\n\t\tts->tv_nsec = 0;\n\t}\n\t\t\n}"
  },
  {
    "function_name": "__read_persistent_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "732-758",
    "snippet": "static void __read_persistent_clock(struct timespec *ts)\n{\n\tstruct rtc_time tm;\n\tstatic int first = 1;\n\n\tts->tv_nsec = 0;\n\t/* XXX this is a litle fragile but will work okay in the short term */\n\tif (first) {\n\t\tfirst = 0;\n\t\tif (ppc_md.time_init)\n\t\t\ttimezone_offset = ppc_md.time_init();\n\n\t\t/* get_boot_time() isn't guaranteed to be safe to call late */\n\t\tif (ppc_md.get_boot_time) {\n\t\t\tts->tv_sec = ppc_md.get_boot_time() - timezone_offset;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!ppc_md.get_rtc_time) {\n\t\tts->tv_sec = 0;\n\t\treturn;\n\t}\n\tppc_md.get_rtc_time(&tm);\n\n\tts->tv_sec = mktime(tm.tm_year+1900, tm.tm_mon+1, tm.tm_mday,\n\t\t\t    tm.tm_hour, tm.tm_min, tm.tm_sec);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static long timezone_offset;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mktime",
          "args": [
            "tm.tm_year+1900",
            "tm.tm_mon+1",
            "tm.tm_mday",
            "tm.tm_hour",
            "tm.tm_min",
            "tm.tm_sec"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.get_rtc_time",
          "args": [
            "&tm"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.get_boot_time",
          "args": [],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.time_init",
          "args": [],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "time_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "921-989",
          "snippet": "void __init time_init(void)\n{\n\tstruct div_result res;\n\tu64 scale;\n\tunsigned shift;\n\n\tif (__USE_RTC()) {\n\t\t/* 601 processor: dec counts down by 128 every 128ns */\n\t\tppc_tb_freq = 1000000000;\n\t} else {\n\t\t/* Normal PowerPC with timebase register */\n\t\tppc_md.calibrate_decr();\n\t\tprintk(KERN_DEBUG \"time_init: decrementer frequency = %lu.%.6lu MHz\\n\",\n\t\t       ppc_tb_freq / 1000000, ppc_tb_freq % 1000000);\n\t\tprintk(KERN_DEBUG \"time_init: processor frequency   = %lu.%.6lu MHz\\n\",\n\t\t       ppc_proc_freq / 1000000, ppc_proc_freq % 1000000);\n\t}\n\n\ttb_ticks_per_jiffy = ppc_tb_freq / HZ;\n\ttb_ticks_per_sec = ppc_tb_freq;\n\ttb_ticks_per_usec = ppc_tb_freq / 1000000;\n\tcalc_cputime_factors();\n\tsetup_cputime_one_jiffy();\n\n\t/*\n\t * Compute scale factor for sched_clock.\n\t * The calibrate_decr() function has set tb_ticks_per_sec,\n\t * which is the timebase frequency.\n\t * We compute 1e9 * 2^64 / tb_ticks_per_sec and interpret\n\t * the 128-bit result as a 64.64 fixed-point number.\n\t * We then shift that number right until it is less than 1.0,\n\t * giving us the scale factor and shift count to use in\n\t * sched_clock().\n\t */\n\tdiv128_by_32(1000000000, 0, tb_ticks_per_sec, &res);\n\tscale = res.result_low;\n\tfor (shift = 0; res.result_high != 0; ++shift) {\n\t\tscale = (scale >> 1) | (res.result_high << 63);\n\t\tres.result_high >>= 1;\n\t}\n\ttb_to_ns_scale = scale;\n\ttb_to_ns_shift = shift;\n\t/* Save the current timebase to pretty up CONFIG_PRINTK_TIME */\n\tboot_tb = get_tb_or_rtc();\n\n\t/* If platform provided a timezone (pmac), we correct the time */\n\tif (timezone_offset) {\n\t\tsys_tz.tz_minuteswest = -timezone_offset / 60;\n\t\tsys_tz.tz_dsttime = 0;\n\t}\n\n\tvdso_data->tb_update_count = 0;\n\tvdso_data->tb_ticks_per_sec = tb_ticks_per_sec;\n\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* Register the clocksource */\n\tclocksource_init();\n\n\tinit_decrementer_clockevent();\n\ttick_setup_hrtimer_broadcast();\n\n#ifdef CONFIG_COMMON_CLK\n\tof_clk_init(NULL);\n#endif\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static cycle_t rtc_read(struct clocksource *);",
            "static cycle_t timebase_read(struct clocksource *);",
            "unsigned long tb_ticks_per_jiffy;",
            "unsigned long tb_ticks_per_usec = 100;",
            "unsigned long tb_ticks_per_sec;",
            "static u64 tb_to_ns_scale",
            "extern struct timezone sys_tz;",
            "static long timezone_offset;",
            "unsigned long ppc_proc_freq;",
            "unsigned long ppc_tb_freq;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic cycle_t rtc_read(struct clocksource *);\nstatic cycle_t timebase_read(struct clocksource *);\nunsigned long tb_ticks_per_jiffy;\nunsigned long tb_ticks_per_usec = 100;\nunsigned long tb_ticks_per_sec;\nstatic u64 tb_to_ns_scale;\nextern struct timezone sys_tz;\nstatic long timezone_offset;\nunsigned long ppc_proc_freq;\nunsigned long ppc_tb_freq;\n\nvoid __init time_init(void)\n{\n\tstruct div_result res;\n\tu64 scale;\n\tunsigned shift;\n\n\tif (__USE_RTC()) {\n\t\t/* 601 processor: dec counts down by 128 every 128ns */\n\t\tppc_tb_freq = 1000000000;\n\t} else {\n\t\t/* Normal PowerPC with timebase register */\n\t\tppc_md.calibrate_decr();\n\t\tprintk(KERN_DEBUG \"time_init: decrementer frequency = %lu.%.6lu MHz\\n\",\n\t\t       ppc_tb_freq / 1000000, ppc_tb_freq % 1000000);\n\t\tprintk(KERN_DEBUG \"time_init: processor frequency   = %lu.%.6lu MHz\\n\",\n\t\t       ppc_proc_freq / 1000000, ppc_proc_freq % 1000000);\n\t}\n\n\ttb_ticks_per_jiffy = ppc_tb_freq / HZ;\n\ttb_ticks_per_sec = ppc_tb_freq;\n\ttb_ticks_per_usec = ppc_tb_freq / 1000000;\n\tcalc_cputime_factors();\n\tsetup_cputime_one_jiffy();\n\n\t/*\n\t * Compute scale factor for sched_clock.\n\t * The calibrate_decr() function has set tb_ticks_per_sec,\n\t * which is the timebase frequency.\n\t * We compute 1e9 * 2^64 / tb_ticks_per_sec and interpret\n\t * the 128-bit result as a 64.64 fixed-point number.\n\t * We then shift that number right until it is less than 1.0,\n\t * giving us the scale factor and shift count to use in\n\t * sched_clock().\n\t */\n\tdiv128_by_32(1000000000, 0, tb_ticks_per_sec, &res);\n\tscale = res.result_low;\n\tfor (shift = 0; res.result_high != 0; ++shift) {\n\t\tscale = (scale >> 1) | (res.result_high << 63);\n\t\tres.result_high >>= 1;\n\t}\n\ttb_to_ns_scale = scale;\n\ttb_to_ns_shift = shift;\n\t/* Save the current timebase to pretty up CONFIG_PRINTK_TIME */\n\tboot_tb = get_tb_or_rtc();\n\n\t/* If platform provided a timezone (pmac), we correct the time */\n\tif (timezone_offset) {\n\t\tsys_tz.tz_minuteswest = -timezone_offset / 60;\n\t\tsys_tz.tz_dsttime = 0;\n\t}\n\n\tvdso_data->tb_update_count = 0;\n\tvdso_data->tb_ticks_per_sec = tb_ticks_per_sec;\n\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* Register the clocksource */\n\tclocksource_init();\n\n\tinit_decrementer_clockevent();\n\ttick_setup_hrtimer_broadcast();\n\n#ifdef CONFIG_COMMON_CLK\n\tof_clk_init(NULL);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic long timezone_offset;\n\nstatic void __read_persistent_clock(struct timespec *ts)\n{\n\tstruct rtc_time tm;\n\tstatic int first = 1;\n\n\tts->tv_nsec = 0;\n\t/* XXX this is a litle fragile but will work okay in the short term */\n\tif (first) {\n\t\tfirst = 0;\n\t\tif (ppc_md.time_init)\n\t\t\ttimezone_offset = ppc_md.time_init();\n\n\t\t/* get_boot_time() isn't guaranteed to be safe to call late */\n\t\tif (ppc_md.get_boot_time) {\n\t\t\tts->tv_sec = ppc_md.get_boot_time() - timezone_offset;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!ppc_md.get_rtc_time) {\n\t\tts->tv_sec = 0;\n\t\treturn;\n\t}\n\tppc_md.get_rtc_time(&tm);\n\n\tts->tv_sec = mktime(tm.tm_year+1900, tm.tm_mon+1, tm.tm_mday,\n\t\t\t    tm.tm_hour, tm.tm_min, tm.tm_sec);\n}"
  },
  {
    "function_name": "update_persistent_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "718-730",
    "snippet": "int update_persistent_clock(struct timespec now)\n{\n\tstruct rtc_time tm;\n\n\tif (!ppc_md.set_rtc_time)\n\t\treturn -ENODEV;\n\n\tto_tm(now.tv_sec + 1 + timezone_offset, &tm);\n\ttm.tm_year -= 1900;\n\ttm.tm_mon -= 1;\n\n\treturn ppc_md.set_rtc_time(&tm);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static long timezone_offset;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.set_rtc_time",
          "args": [
            "&tm"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_tm",
          "args": [
            "now.tv_sec + 1 + timezone_offset",
            "&tm"
          ],
          "line": 725
        },
        "resolved": true,
        "details": {
          "function_name": "to_tm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "1037-1070",
          "snippet": "void to_tm(int tim, struct rtc_time * tm)\n{\n\tregister int    i;\n\tregister long   hms, day;\n\n\tday = tim / SECDAY;\n\thms = tim % SECDAY;\n\n\t/* Hours, minutes, seconds are easy */\n\ttm->tm_hour = hms / 3600;\n\ttm->tm_min = (hms % 3600) / 60;\n\ttm->tm_sec = (hms % 3600) % 60;\n\n\t/* Number of years in days */\n\tfor (i = STARTOFTIME; day >= days_in_year(i); i++)\n\t\tday -= days_in_year(i);\n\ttm->tm_year = i;\n\n\t/* Number of months in days left */\n\tif (leapyear(tm->tm_year))\n\t\tdays_in_month(FEBRUARY) = 29;\n\tfor (i = 1; day >= days_in_month(i); i++)\n\t\tday -= days_in_month(i);\n\tdays_in_month(FEBRUARY) = 28;\n\ttm->tm_mon = i;\n\n\t/* Days are what is left over (+1) from all that. */\n\ttm->tm_mday = day + 1;\n\n\t/*\n\t * Determine the day of week\n\t */\n\tGregorianDay(tm);\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define SECDAY\t\t86400L",
            "#define\tSTARTOFTIME\t1970",
            "#define FEBRUARY\t2"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define SECDAY\t\t86400L\n#define\tSTARTOFTIME\t1970\n#define FEBRUARY\t2\n\nvoid to_tm(int tim, struct rtc_time * tm)\n{\n\tregister int    i;\n\tregister long   hms, day;\n\n\tday = tim / SECDAY;\n\thms = tim % SECDAY;\n\n\t/* Hours, minutes, seconds are easy */\n\ttm->tm_hour = hms / 3600;\n\ttm->tm_min = (hms % 3600) / 60;\n\ttm->tm_sec = (hms % 3600) % 60;\n\n\t/* Number of years in days */\n\tfor (i = STARTOFTIME; day >= days_in_year(i); i++)\n\t\tday -= days_in_year(i);\n\ttm->tm_year = i;\n\n\t/* Number of months in days left */\n\tif (leapyear(tm->tm_year))\n\t\tdays_in_month(FEBRUARY) = 29;\n\tfor (i = 1; day >= days_in_month(i); i++)\n\t\tday -= days_in_month(i);\n\tdays_in_month(FEBRUARY) = 28;\n\ttm->tm_mon = i;\n\n\t/* Days are what is left over (+1) from all that. */\n\ttm->tm_mday = day + 1;\n\n\t/*\n\t * Determine the day of week\n\t */\n\tGregorianDay(tm);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic long timezone_offset;\n\nint update_persistent_clock(struct timespec now)\n{\n\tstruct rtc_time tm;\n\n\tif (!ppc_md.set_rtc_time)\n\t\treturn -ENODEV;\n\n\tto_tm(now.tv_sec + 1 + timezone_offset, &tm);\n\ttm.tm_year -= 1900;\n\ttm.tm_mon -= 1;\n\n\treturn ppc_md.set_rtc_time(&tm);\n}"
  },
  {
    "function_name": "generic_calibrate_decr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "697-716",
    "snippet": "void __init generic_calibrate_decr(void)\n{\n\tppc_tb_freq = DEFAULT_TB_FREQ;\t\t/* hardcoded default */\n\n\tif (!get_freq(\"ibm,extended-timebase-frequency\", 2, &ppc_tb_freq) &&\n\t    !get_freq(\"timebase-frequency\", 1, &ppc_tb_freq)) {\n\n\t\tprintk(KERN_ERR \"WARNING: Estimating decrementer frequency \"\n\t\t\t\t\"(not found)\\n\");\n\t}\n\n\tppc_proc_freq = DEFAULT_PROC_FREQ;\t/* hardcoded default */\n\n\tif (!get_freq(\"ibm,extended-clock-frequency\", 2, &ppc_proc_freq) &&\n\t    !get_freq(\"clock-frequency\", 1, &ppc_proc_freq)) {\n\n\t\tprintk(KERN_ERR \"WARNING: Estimating processor frequency \"\n\t\t\t\t\"(not found)\\n\");\n\t}\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long ppc_proc_freq;",
      "unsigned long ppc_tb_freq;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"WARNING: Estimating processor frequency \"\n\t\t\t\t\"(not found)\\n\""
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_freq",
          "args": [
            "\"clock-frequency\"",
            "1",
            "&ppc_proc_freq"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "get_freq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "664-684",
          "snippet": "static int __init get_freq(char *name, int cells, unsigned long *val)\n{\n\tstruct device_node *cpu;\n\tconst __be32 *fp;\n\tint found = 0;\n\n\t/* The cpu node should have timebase and clock frequency properties */\n\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\tif (cpu) {\n\t\tfp = of_get_property(cpu, name, NULL);\n\t\tif (fp) {\n\t\t\tfound = 1;\n\t\t\t*val = of_read_ulong(fp, cells);\n\t\t}\n\n\t\tof_node_put(cpu);\n\t}\n\n\treturn found;\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic int __init get_freq(char *name, int cells, unsigned long *val)\n{\n\tstruct device_node *cpu;\n\tconst __be32 *fp;\n\tint found = 0;\n\n\t/* The cpu node should have timebase and clock frequency properties */\n\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\tif (cpu) {\n\t\tfp = of_get_property(cpu, name, NULL);\n\t\tif (fp) {\n\t\t\tfound = 1;\n\t\t\t*val = of_read_ulong(fp, cells);\n\t\t}\n\n\t\tof_node_put(cpu);\n\t}\n\n\treturn found;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"WARNING: Estimating decrementer frequency \"\n\t\t\t\t\"(not found)\\n\""
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long ppc_proc_freq;\nunsigned long ppc_tb_freq;\n\nvoid __init generic_calibrate_decr(void)\n{\n\tppc_tb_freq = DEFAULT_TB_FREQ;\t\t/* hardcoded default */\n\n\tif (!get_freq(\"ibm,extended-timebase-frequency\", 2, &ppc_tb_freq) &&\n\t    !get_freq(\"timebase-frequency\", 1, &ppc_tb_freq)) {\n\n\t\tprintk(KERN_ERR \"WARNING: Estimating decrementer frequency \"\n\t\t\t\t\"(not found)\\n\");\n\t}\n\n\tppc_proc_freq = DEFAULT_PROC_FREQ;\t/* hardcoded default */\n\n\tif (!get_freq(\"ibm,extended-clock-frequency\", 2, &ppc_proc_freq) &&\n\t    !get_freq(\"clock-frequency\", 1, &ppc_proc_freq)) {\n\n\t\tprintk(KERN_ERR \"WARNING: Estimating processor frequency \"\n\t\t\t\t\"(not found)\\n\");\n\t}\n}"
  },
  {
    "function_name": "start_cpu_decrementer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "686-695",
    "snippet": "static void start_cpu_decrementer(void)\n{\n#if defined(CONFIG_BOOKE) || defined(CONFIG_40x)\n\t/* Clear any pending timer interrupts */\n\tmtspr(SPRN_TSR, TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS);\n\n\t/* Enable decrementer interrupt */\n\tmtspr(SPRN_TCR, TCR_DIE);\n#endif /* defined(CONFIG_BOOKE) || defined(CONFIG_40x) */\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_TCR",
            "TCR_DIE"
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_TSR",
            "TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void start_cpu_decrementer(void)\n{\n#if defined(CONFIG_BOOKE) || defined(CONFIG_40x)\n\t/* Clear any pending timer interrupts */\n\tmtspr(SPRN_TSR, TSR_ENW | TSR_WIS | TSR_DIS | TSR_FIS);\n\n\t/* Enable decrementer interrupt */\n\tmtspr(SPRN_TCR, TCR_DIE);\n#endif /* defined(CONFIG_BOOKE) || defined(CONFIG_40x) */\n}"
  },
  {
    "function_name": "get_freq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "664-684",
    "snippet": "static int __init get_freq(char *name, int cells, unsigned long *val)\n{\n\tstruct device_node *cpu;\n\tconst __be32 *fp;\n\tint found = 0;\n\n\t/* The cpu node should have timebase and clock frequency properties */\n\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\tif (cpu) {\n\t\tfp = of_get_property(cpu, name, NULL);\n\t\tif (fp) {\n\t\t\tfound = 1;\n\t\t\t*val = of_read_ulong(fp, cells);\n\t\t}\n\n\t\tof_node_put(cpu);\n\t}\n\n\treturn found;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "cpu"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_read_ulong",
          "args": [
            "fp",
            "cells"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "cpu",
            "name",
            "NULL"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_type",
          "args": [
            "NULL",
            "\"cpu\""
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic int __init get_freq(char *name, int cells, unsigned long *val)\n{\n\tstruct device_node *cpu;\n\tconst __be32 *fp;\n\tint found = 0;\n\n\t/* The cpu node should have timebase and clock frequency properties */\n\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\tif (cpu) {\n\t\tfp = of_get_property(cpu, name, NULL);\n\t\tif (fp) {\n\t\t\tfound = 1;\n\t\t\t*val = of_read_ulong(fp, cells);\n\t\t}\n\n\t\tof_node_put(cpu);\n\t}\n\n\treturn found;\n}"
  },
  {
    "function_name": "running_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "640-661",
    "snippet": "unsigned long long running_clock(void)\n{\n\t/*\n\t * Don't read the VTB as a host since KVM does not switch in host\n\t * timebase into the VTB when it takes a guest off the CPU, reading the\n\t * VTB would result in reading 'last switched out' guest VTB.\n\t *\n\t * Host kernels are often compiled with CONFIG_PPC_PSERIES checked, it\n\t * would be unsafe to rely only on the #ifdef above.\n\t */\n\tif (firmware_has_feature(FW_FEATURE_LPAR) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\treturn mulhdu(get_vtb() - boot_tb, tb_to_ns_scale) << tb_to_ns_shift;\n\n\t/*\n\t * This is a next best approximation without a VTB.\n\t * On a host which is running bare metal there should never be any stolen\n\t * time and on a host which doesn't do any virtualisation TB *should* equal\n\t * VTB so it makes no difference anyway.\n\t */\n\treturn local_clock() - cputime_to_nsecs(kcpustat_this_cpu->cpustat[CPUTIME_STEAL]);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 tb_to_ns_scale"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cputime_to_nsecs",
          "args": [
            "kcpustat_this_cpu->cpustat[CPUTIME_STEAL]"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_clock",
          "args": [],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mulhdu",
          "args": [
            "get_vtb() - boot_tb",
            "tb_to_ns_scale"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_vtb",
          "args": [],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_207S"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 tb_to_ns_scale;\n\nunsigned long long running_clock(void)\n{\n\t/*\n\t * Don't read the VTB as a host since KVM does not switch in host\n\t * timebase into the VTB when it takes a guest off the CPU, reading the\n\t * VTB would result in reading 'last switched out' guest VTB.\n\t *\n\t * Host kernels are often compiled with CONFIG_PPC_PSERIES checked, it\n\t * would be unsafe to rely only on the #ifdef above.\n\t */\n\tif (firmware_has_feature(FW_FEATURE_LPAR) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S))\n\t\treturn mulhdu(get_vtb() - boot_tb, tb_to_ns_scale) << tb_to_ns_shift;\n\n\t/*\n\t * This is a next best approximation without a VTB.\n\t * On a host which is running bare metal there should never be any stolen\n\t * time and on a host which doesn't do any virtualisation TB *should* equal\n\t * VTB so it makes no difference anyway.\n\t */\n\treturn local_clock() - cputime_to_nsecs(kcpustat_this_cpu->cpustat[CPUTIME_STEAL]);\n}"
  },
  {
    "function_name": "sched_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "625-630",
    "snippet": "unsigned long long sched_clock(void)\n{\n\tif (__USE_RTC())\n\t\treturn get_rtc();\n\treturn mulhdu(get_tb() - boot_tb, tb_to_ns_scale) << tb_to_ns_shift;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 tb_to_ns_scale"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mulhdu",
          "args": [
            "get_tb() - boot_tb",
            "tb_to_ns_scale"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_tb",
          "args": [],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_rtc",
          "args": [],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__USE_RTC",
          "args": [],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 tb_to_ns_scale;\n\nunsigned long long sched_clock(void)\n{\n\tif (__USE_RTC())\n\t\treturn get_rtc();\n\treturn mulhdu(get_tb() - boot_tb, tb_to_ns_scale) << tb_to_ns_shift;\n}"
  },
  {
    "function_name": "tb_to_ns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "612-615",
    "snippet": "unsigned long long tb_to_ns(unsigned long long ticks)\n{\n\treturn mulhdu(ticks, tb_to_ns_scale) << tb_to_ns_shift;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 tb_to_ns_scale"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mulhdu",
          "args": [
            "ticks",
            "tb_to_ns_scale"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 tb_to_ns_scale;\n\nunsigned long long tb_to_ns(unsigned long long ticks)\n{\n\treturn mulhdu(ticks, tb_to_ns_scale) << tb_to_ns_shift;\n}"
  },
  {
    "function_name": "arch_suspend_enable_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "604-609",
    "snippet": "void arch_suspend_enable_irqs(void)\n{\n\tgeneric_suspend_enable_irqs();\n\tif (ppc_md.suspend_enable_irqs)\n\t\tppc_md.suspend_enable_irqs();\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.suspend_enable_irqs",
          "args": [],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "generic_suspend_enable_irqs",
          "args": [],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "generic_suspend_enable_irqs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "590-593",
          "snippet": "static void generic_suspend_enable_irqs(void)\n{\n\tlocal_irq_enable();\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void generic_suspend_enable_irqs(void)\n{\n\tlocal_irq_enable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid arch_suspend_enable_irqs(void)\n{\n\tgeneric_suspend_enable_irqs();\n\tif (ppc_md.suspend_enable_irqs)\n\t\tppc_md.suspend_enable_irqs();\n}"
  },
  {
    "function_name": "arch_suspend_disable_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "596-601",
    "snippet": "void arch_suspend_disable_irqs(void)\n{\n\tif (ppc_md.suspend_disable_irqs)\n\t\tppc_md.suspend_disable_irqs();\n\tgeneric_suspend_disable_irqs();\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "generic_suspend_disable_irqs",
          "args": [],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "generic_suspend_disable_irqs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "579-588",
          "snippet": "static void generic_suspend_disable_irqs(void)\n{\n\t/* Disable the decrementer, so that it doesn't interfere\n\t * with suspending.\n\t */\n\n\tset_dec(DECREMENTER_MAX);\n\tlocal_irq_disable();\n\tset_dec(DECREMENTER_MAX);\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define DECREMENTER_MAX\t0x7fffffff"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define DECREMENTER_MAX\t0x7fffffff\n\nstatic void generic_suspend_disable_irqs(void)\n{\n\t/* Disable the decrementer, so that it doesn't interfere\n\t * with suspending.\n\t */\n\n\tset_dec(DECREMENTER_MAX);\n\tlocal_irq_disable();\n\tset_dec(DECREMENTER_MAX);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppc_md.suspend_disable_irqs",
          "args": [],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid arch_suspend_disable_irqs(void)\n{\n\tif (ppc_md.suspend_disable_irqs)\n\t\tppc_md.suspend_disable_irqs();\n\tgeneric_suspend_disable_irqs();\n}"
  },
  {
    "function_name": "generic_suspend_enable_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "590-593",
    "snippet": "static void generic_suspend_enable_irqs(void)\n{\n\tlocal_irq_enable();\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_enable",
          "args": [],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic void generic_suspend_enable_irqs(void)\n{\n\tlocal_irq_enable();\n}"
  },
  {
    "function_name": "generic_suspend_disable_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "579-588",
    "snippet": "static void generic_suspend_disable_irqs(void)\n{\n\t/* Disable the decrementer, so that it doesn't interfere\n\t * with suspending.\n\t */\n\n\tset_dec(DECREMENTER_MAX);\n\tlocal_irq_disable();\n\tset_dec(DECREMENTER_MAX);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define DECREMENTER_MAX\t0x7fffffff"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "DECREMENTER_MAX"
          ],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_disable",
          "args": [],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "DECREMENTER_MAX"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define DECREMENTER_MAX\t0x7fffffff\n\nstatic void generic_suspend_disable_irqs(void)\n{\n\t/* Disable the decrementer, so that it doesn't interfere\n\t * with suspending.\n\t */\n\n\tset_dec(DECREMENTER_MAX);\n\tlocal_irq_disable();\n\tset_dec(DECREMENTER_MAX);\n}"
  },
  {
    "function_name": "hdec_interrupt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "574-576",
    "snippet": "void hdec_interrupt(struct pt_regs *regs)\n{\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid hdec_interrupt(struct pt_regs *regs)\n{\n}"
  },
  {
    "function_name": "timer_interrupt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "529-567",
    "snippet": "void timer_interrupt(struct pt_regs * regs)\n{\n\tstruct pt_regs *old_regs;\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t/* Ensure a positive value is written to the decrementer, or else\n\t * some CPUs will continue to take decrementer exceptions.\n\t */\n\tset_dec(DECREMENTER_MAX);\n\n\t/* Some implementations of hotplug will get timer interrupts while\n\t * offline, just ignore these and we also need to set\n\t * decrementers_next_tb as MAX to make sure __check_irq_replay\n\t * don't replay timer interrupt when return, otherwise we'll trap\n\t * here infinitely :(\n\t */\n\tif (!cpu_online(smp_processor_id())) {\n\t\t*next_tb = ~(u64)0;\n\t\treturn;\n\t}\n\n\t/* Conditionally hard-enable interrupts now that the DEC has been\n\t * bumped to its maximum value\n\t */\n\tmay_hard_irq_enable();\n\n\n#if defined(CONFIG_PPC32) && defined(CONFIG_PPC_PMAC)\n\tif (atomic_read(&ppc_n_lost_interrupts) != 0)\n\t\tdo_IRQ(regs);\n#endif\n\n\told_regs = set_irq_regs(regs);\n\tirq_enter();\n\n\t__timer_interrupt();\n\tirq_exit();\n\tset_irq_regs(old_regs);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define DECREMENTER_MAX\t0x7fffffff"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_irq_regs",
          "args": [
            "old_regs"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_exit",
          "args": [],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__timer_interrupt",
          "args": [],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "__timer_interrupt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "484-523",
          "snippet": "static void __timer_interrupt(void)\n{\n\tstruct pt_regs *regs = get_irq_regs();\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\tstruct clock_event_device *evt = this_cpu_ptr(&decrementers);\n\tu64 now;\n\n\ttrace_timer_interrupt_entry(regs);\n\n\tif (test_irq_work_pending()) {\n\t\tclear_irq_work_pending();\n\t\tirq_work_run();\n\t}\n\n\tnow = get_tb_or_rtc();\n\tif (now >= *next_tb) {\n\t\t*next_tb = ~(u64)0;\n\t\tif (evt->event_handler)\n\t\t\tevt->event_handler(evt);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_event);\n\t} else {\n\t\tnow = *next_tb - now;\n\t\tif (now <= DECREMENTER_MAX)\n\t\t\tset_dec((int)now);\n\t\t/* We may have raced with new irq work */\n\t\tif (test_irq_work_pending())\n\t\t\tset_dec(1);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_others);\n\t}\n\n#ifdef CONFIG_PPC64\n\t/* collect purr register values often, for accurate calculations */\n\tif (firmware_has_feature(FW_FEATURE_SPLPAR)) {\n\t\tstruct cpu_usage *cu = this_cpu_ptr(&cpu_usage_array);\n\t\tcu->current_tb = mfspr(SPRN_PURR);\n\t}\n#endif\n\n\ttrace_timer_interrupt_exit(regs);\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define DECREMENTER_MAX\t0x7fffffff"
          ],
          "globals_used": [
            "static int decrementer_shutdown(struct clock_event_device *evt);",
            "static DEFINE_PER_CPU(struct clock_event_device, decrementers);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define DECREMENTER_MAX\t0x7fffffff\n\nstatic int decrementer_shutdown(struct clock_event_device *evt);\nstatic DEFINE_PER_CPU(struct clock_event_device, decrementers);\n\nstatic void __timer_interrupt(void)\n{\n\tstruct pt_regs *regs = get_irq_regs();\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\tstruct clock_event_device *evt = this_cpu_ptr(&decrementers);\n\tu64 now;\n\n\ttrace_timer_interrupt_entry(regs);\n\n\tif (test_irq_work_pending()) {\n\t\tclear_irq_work_pending();\n\t\tirq_work_run();\n\t}\n\n\tnow = get_tb_or_rtc();\n\tif (now >= *next_tb) {\n\t\t*next_tb = ~(u64)0;\n\t\tif (evt->event_handler)\n\t\t\tevt->event_handler(evt);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_event);\n\t} else {\n\t\tnow = *next_tb - now;\n\t\tif (now <= DECREMENTER_MAX)\n\t\t\tset_dec((int)now);\n\t\t/* We may have raced with new irq work */\n\t\tif (test_irq_work_pending())\n\t\t\tset_dec(1);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_others);\n\t}\n\n#ifdef CONFIG_PPC64\n\t/* collect purr register values often, for accurate calculations */\n\tif (firmware_has_feature(FW_FEATURE_SPLPAR)) {\n\t\tstruct cpu_usage *cu = this_cpu_ptr(&cpu_usage_array);\n\t\tcu->current_tb = mfspr(SPRN_PURR);\n\t}\n#endif\n\n\ttrace_timer_interrupt_exit(regs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_enter",
          "args": [],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_irq_regs",
          "args": [
            "regs"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_IRQ",
          "args": [
            "regs"
          ],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "do_IRQ",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/irq.c",
          "lines": "510-545",
          "snippet": "void do_IRQ(struct pt_regs *regs)\n{\n\tstruct pt_regs *old_regs = set_irq_regs(regs);\n\tstruct thread_info *curtp, *irqtp, *sirqtp;\n\n\t/* Switch to the irq stack to handle this */\n\tcurtp = current_thread_info();\n\tirqtp = hardirq_ctx[raw_smp_processor_id()];\n\tsirqtp = softirq_ctx[raw_smp_processor_id()];\n\n\t/* Already there ? */\n\tif (unlikely(curtp == irqtp || curtp == sirqtp)) {\n\t\t__do_irq(regs);\n\t\tset_irq_regs(old_regs);\n\t\treturn;\n\t}\n\n\t/* Prepare the thread_info in the irq stack */\n\tirqtp->task = curtp->task;\n\tirqtp->flags = 0;\n\n\t/* Copy the preempt_count so that the [soft]irq checks work. */\n\tirqtp->preempt_count = curtp->preempt_count;\n\n\t/* Switch stack and call */\n\tcall_do_irq(regs, irqtp);\n\n\t/* Restore stack limit */\n\tirqtp->task = NULL;\n\n\t/* Copy back updates to the thread_info */\n\tif (irqtp->flags)\n\t\tset_bits(irqtp->flags, &curtp->flags);\n\n\tset_irq_regs(old_regs);\n}",
          "includes": [
            "#include <asm/trace.h>",
            "#include <asm/lv1call.h>",
            "#include <asm/firmware.h>",
            "#include <asm/paca.h>",
            "#include <asm/debug.h>",
            "#include <asm/smp.h>",
            "#include <asm/udbg.h>",
            "#include <asm/machdep.h>",
            "#include <asm/ptrace.h>",
            "#include <asm/prom.h>",
            "#include <asm/cache.h>",
            "#include <asm/irq.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/io.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/pci.h>",
            "#include <linux/mutex.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/list.h>",
            "#include <linux/bitops.h>",
            "#include <linux/profile.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/irq.h>",
            "#include <linux/delay.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/ioport.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/sched.h>",
            "#include <linux/signal.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/threads.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct thread_info *softirq_ctx[NR_CPUS]",
            "struct thread_info *hardirq_ctx[NR_CPUS]"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/trace.h>\n#include <asm/lv1call.h>\n#include <asm/firmware.h>\n#include <asm/paca.h>\n#include <asm/debug.h>\n#include <asm/smp.h>\n#include <asm/udbg.h>\n#include <asm/machdep.h>\n#include <asm/ptrace.h>\n#include <asm/prom.h>\n#include <asm/cache.h>\n#include <asm/irq.h>\n#include <asm/pgtable.h>\n#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <linux/of_irq.h>\n#include <linux/of.h>\n#include <linux/debugfs.h>\n#include <linux/pci.h>\n#include <linux/mutex.h>\n#include <linux/radix-tree.h>\n#include <linux/list.h>\n#include <linux/bitops.h>\n#include <linux/profile.h>\n#include <linux/cpumask.h>\n#include <linux/seq_file.h>\n#include <linux/irq.h>\n#include <linux/delay.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/ioport.h>\n#include <linux/ptrace.h>\n#include <linux/sched.h>\n#include <linux/signal.h>\n#include <linux/kernel_stat.h>\n#include <linux/threads.h>\n#include <linux/export.h>\n\nstruct thread_info *softirq_ctx[NR_CPUS];\nstruct thread_info *hardirq_ctx[NR_CPUS];\n\nvoid do_IRQ(struct pt_regs *regs)\n{\n\tstruct pt_regs *old_regs = set_irq_regs(regs);\n\tstruct thread_info *curtp, *irqtp, *sirqtp;\n\n\t/* Switch to the irq stack to handle this */\n\tcurtp = current_thread_info();\n\tirqtp = hardirq_ctx[raw_smp_processor_id()];\n\tsirqtp = softirq_ctx[raw_smp_processor_id()];\n\n\t/* Already there ? */\n\tif (unlikely(curtp == irqtp || curtp == sirqtp)) {\n\t\t__do_irq(regs);\n\t\tset_irq_regs(old_regs);\n\t\treturn;\n\t}\n\n\t/* Prepare the thread_info in the irq stack */\n\tirqtp->task = curtp->task;\n\tirqtp->flags = 0;\n\n\t/* Copy the preempt_count so that the [soft]irq checks work. */\n\tirqtp->preempt_count = curtp->preempt_count;\n\n\t/* Switch stack and call */\n\tcall_do_irq(regs, irqtp);\n\n\t/* Restore stack limit */\n\tirqtp->task = NULL;\n\n\t/* Copy back updates to the thread_info */\n\tif (irqtp->flags)\n\t\tset_bits(irqtp->flags, &curtp->flags);\n\n\tset_irq_regs(old_regs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&ppc_n_lost_interrupts"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "may_hard_irq_enable",
          "args": [],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "smp_processor_id()"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_cpu_online",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "788-866",
          "snippet": "static void unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"cacheinfo.h\"",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [
            "#define HAS_PPC_PMC_G4\t\t1",
            "#define HAS_PPC_PMC_IBM\t\t1",
            "#define HAS_PPC_PMC_PA6T\t1",
            "#define HAS_PPC_PMC_IBM\t\t1"
          ],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cpu, cpu_devices);",
            "static DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_IBM\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\nstatic DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);\n\nstatic void unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "DECREMENTER_MAX"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&decrementers_next_tb"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define DECREMENTER_MAX\t0x7fffffff\n\nvoid timer_interrupt(struct pt_regs * regs)\n{\n\tstruct pt_regs *old_regs;\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t/* Ensure a positive value is written to the decrementer, or else\n\t * some CPUs will continue to take decrementer exceptions.\n\t */\n\tset_dec(DECREMENTER_MAX);\n\n\t/* Some implementations of hotplug will get timer interrupts while\n\t * offline, just ignore these and we also need to set\n\t * decrementers_next_tb as MAX to make sure __check_irq_replay\n\t * don't replay timer interrupt when return, otherwise we'll trap\n\t * here infinitely :(\n\t */\n\tif (!cpu_online(smp_processor_id())) {\n\t\t*next_tb = ~(u64)0;\n\t\treturn;\n\t}\n\n\t/* Conditionally hard-enable interrupts now that the DEC has been\n\t * bumped to its maximum value\n\t */\n\tmay_hard_irq_enable();\n\n\n#if defined(CONFIG_PPC32) && defined(CONFIG_PPC_PMAC)\n\tif (atomic_read(&ppc_n_lost_interrupts) != 0)\n\t\tdo_IRQ(regs);\n#endif\n\n\told_regs = set_irq_regs(regs);\n\tirq_enter();\n\n\t__timer_interrupt();\n\tirq_exit();\n\tset_irq_regs(old_regs);\n}"
  },
  {
    "function_name": "__timer_interrupt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "484-523",
    "snippet": "static void __timer_interrupt(void)\n{\n\tstruct pt_regs *regs = get_irq_regs();\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\tstruct clock_event_device *evt = this_cpu_ptr(&decrementers);\n\tu64 now;\n\n\ttrace_timer_interrupt_entry(regs);\n\n\tif (test_irq_work_pending()) {\n\t\tclear_irq_work_pending();\n\t\tirq_work_run();\n\t}\n\n\tnow = get_tb_or_rtc();\n\tif (now >= *next_tb) {\n\t\t*next_tb = ~(u64)0;\n\t\tif (evt->event_handler)\n\t\t\tevt->event_handler(evt);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_event);\n\t} else {\n\t\tnow = *next_tb - now;\n\t\tif (now <= DECREMENTER_MAX)\n\t\t\tset_dec((int)now);\n\t\t/* We may have raced with new irq work */\n\t\tif (test_irq_work_pending())\n\t\t\tset_dec(1);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_others);\n\t}\n\n#ifdef CONFIG_PPC64\n\t/* collect purr register values often, for accurate calculations */\n\tif (firmware_has_feature(FW_FEATURE_SPLPAR)) {\n\t\tstruct cpu_usage *cu = this_cpu_ptr(&cpu_usage_array);\n\t\tcu->current_tb = mfspr(SPRN_PURR);\n\t}\n#endif\n\n\ttrace_timer_interrupt_exit(regs);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define DECREMENTER_MAX\t0x7fffffff"
    ],
    "globals_used": [
      "static int decrementer_shutdown(struct clock_event_device *evt);",
      "static DEFINE_PER_CPU(struct clock_event_device, decrementers);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_timer_interrupt_exit",
          "args": [
            "regs"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PURR"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&cpu_usage_array"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_SPLPAR"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__this_cpu_inc",
          "args": [
            "irq_stat.timer_irqs_others"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "1"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_irq_work_pending",
          "args": [],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "test_irq_work_pending",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "435-443",
          "snippet": "static inline unsigned long test_irq_work_pending(void)\n{\n\tunsigned long x;\n\n\tasm volatile(\"lbz %0,%1(13)\"\n\t\t: \"=r\" (x)\n\t\t: \"i\" (offsetof(struct paca_struct, irq_work_pending)));\n\treturn x;\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline unsigned long test_irq_work_pending(void)\n{\n\tunsigned long x;\n\n\tasm volatile(\"lbz %0,%1(13)\"\n\t\t: \"=r\" (x)\n\t\t: \"i\" (offsetof(struct paca_struct, irq_work_pending)));\n\treturn x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "(int)now"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__this_cpu_inc",
          "args": [
            "irq_stat.timer_irqs_event"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evt->event_handler",
          "args": [
            "evt"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_tb_or_rtc",
          "args": [],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_work_run",
          "args": [],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_irq_work_pending",
          "args": [],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "clear_irq_work_pending",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "452-457",
          "snippet": "static inline void clear_irq_work_pending(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (0),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline void clear_irq_work_pending(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (0),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_timer_interrupt_entry",
          "args": [
            "regs"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&decrementers"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&decrementers_next_tb"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_irq_regs",
          "args": [],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\n#define DECREMENTER_MAX\t0x7fffffff\n\nstatic int decrementer_shutdown(struct clock_event_device *evt);\nstatic DEFINE_PER_CPU(struct clock_event_device, decrementers);\n\nstatic void __timer_interrupt(void)\n{\n\tstruct pt_regs *regs = get_irq_regs();\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\tstruct clock_event_device *evt = this_cpu_ptr(&decrementers);\n\tu64 now;\n\n\ttrace_timer_interrupt_entry(regs);\n\n\tif (test_irq_work_pending()) {\n\t\tclear_irq_work_pending();\n\t\tirq_work_run();\n\t}\n\n\tnow = get_tb_or_rtc();\n\tif (now >= *next_tb) {\n\t\t*next_tb = ~(u64)0;\n\t\tif (evt->event_handler)\n\t\t\tevt->event_handler(evt);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_event);\n\t} else {\n\t\tnow = *next_tb - now;\n\t\tif (now <= DECREMENTER_MAX)\n\t\t\tset_dec((int)now);\n\t\t/* We may have raced with new irq work */\n\t\tif (test_irq_work_pending())\n\t\t\tset_dec(1);\n\t\t__this_cpu_inc(irq_stat.timer_irqs_others);\n\t}\n\n#ifdef CONFIG_PPC64\n\t/* collect purr register values often, for accurate calculations */\n\tif (firmware_has_feature(FW_FEATURE_SPLPAR)) {\n\t\tstruct cpu_usage *cu = this_cpu_ptr(&cpu_usage_array);\n\t\tcu->current_tb = mfspr(SPRN_PURR);\n\t}\n#endif\n\n\ttrace_timer_interrupt_exit(regs);\n}"
  },
  {
    "function_name": "arch_irq_work_raise",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "469-475",
    "snippet": "void arch_irq_work_raise(void)\n{\n\tpreempt_disable();\n\tset_irq_work_pending_flag();\n\tset_dec(1);\n\tpreempt_enable();\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "1"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_irq_work_pending_flag",
          "args": [],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "set_irq_work_pending_flag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "445-450",
          "snippet": "static inline void set_irq_work_pending_flag(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (1),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline void set_irq_work_pending_flag(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (1),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid arch_irq_work_raise(void)\n{\n\tpreempt_disable();\n\tset_irq_work_pending_flag();\n\tset_dec(1);\n\tpreempt_enable();\n}"
  },
  {
    "function_name": "clear_irq_work_pending",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "452-457",
    "snippet": "static inline void clear_irq_work_pending(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (0),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline void clear_irq_work_pending(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (0),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}"
  },
  {
    "function_name": "set_irq_work_pending_flag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "445-450",
    "snippet": "static inline void set_irq_work_pending_flag(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (1),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline void set_irq_work_pending_flag(void)\n{\n\tasm volatile(\"stb %0,%1(13)\" : :\n\t\t\"r\" (1),\n\t\t\"i\" (offsetof(struct paca_struct, irq_work_pending)));\n}"
  },
  {
    "function_name": "test_irq_work_pending",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "435-443",
    "snippet": "static inline unsigned long test_irq_work_pending(void)\n{\n\tunsigned long x;\n\n\tasm volatile(\"lbz %0,%1(13)\"\n\t\t: \"=r\" (x)\n\t\t: \"i\" (offsetof(struct paca_struct, irq_work_pending)));\n\treturn x;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline unsigned long test_irq_work_pending(void)\n{\n\tunsigned long x;\n\n\tasm volatile(\"lbz %0,%1(13)\"\n\t\t: \"=r\" (x)\n\t\t: \"i\" (offsetof(struct paca_struct, irq_work_pending)));\n\treturn x;\n}"
  },
  {
    "function_name": "profile_pc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "417-425",
    "snippet": "unsigned long profile_pc(struct pt_regs *regs)\n{\n\tunsigned long pc = instruction_pointer(regs);\n\n\tif (in_lock_functions(pc))\n\t\treturn regs->link;\n\n\treturn pc;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_lock_functions",
          "args": [
            "pc"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "instruction_pointer",
          "args": [
            "regs"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long profile_pc(struct pt_regs *regs)\n{\n\tunsigned long pc = instruction_pointer(regs);\n\n\tif (in_lock_functions(pc))\n\t\treturn regs->link;\n\n\treturn pc;\n}"
  },
  {
    "function_name": "udelay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "410-413",
    "snippet": "void udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long tb_ticks_per_usec = 100;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__delay",
          "args": [
            "tb_ticks_per_usec * usecs"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "__delay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "388-407",
          "snippet": "void __delay(unsigned long loops)\n{\n\tunsigned long start;\n\tint diff;\n\n\tif (__USE_RTC()) {\n\t\tstart = get_rtcl();\n\t\tdo {\n\t\t\t/* the RTCL register wraps at 1000000000 */\n\t\t\tdiff = get_rtcl() - start;\n\t\t\tif (diff < 0)\n\t\t\t\tdiff += 1000000000;\n\t\t} while (diff < loops);\n\t} else {\n\t\tstart = get_tbl();\n\t\twhile (get_tbl() - start < loops)\n\t\t\tHMT_low();\n\t\tHMT_medium();\n\t}\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid __delay(unsigned long loops)\n{\n\tunsigned long start;\n\tint diff;\n\n\tif (__USE_RTC()) {\n\t\tstart = get_rtcl();\n\t\tdo {\n\t\t\t/* the RTCL register wraps at 1000000000 */\n\t\t\tdiff = get_rtcl() - start;\n\t\t\tif (diff < 0)\n\t\t\t\tdiff += 1000000000;\n\t\t} while (diff < loops);\n\t} else {\n\t\tstart = get_tbl();\n\t\twhile (get_tbl() - start < loops)\n\t\t\tHMT_low();\n\t\tHMT_medium();\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long tb_ticks_per_usec = 100;\n\nvoid udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}"
  },
  {
    "function_name": "__delay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "388-407",
    "snippet": "void __delay(unsigned long loops)\n{\n\tunsigned long start;\n\tint diff;\n\n\tif (__USE_RTC()) {\n\t\tstart = get_rtcl();\n\t\tdo {\n\t\t\t/* the RTCL register wraps at 1000000000 */\n\t\t\tdiff = get_rtcl() - start;\n\t\t\tif (diff < 0)\n\t\t\t\tdiff += 1000000000;\n\t\t} while (diff < loops);\n\t} else {\n\t\tstart = get_tbl();\n\t\twhile (get_tbl() - start < loops)\n\t\t\tHMT_low();\n\t\tHMT_medium();\n\t}\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HMT_medium",
          "args": [],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HMT_low",
          "args": [],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_tbl",
          "args": [],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_tbl",
          "args": [],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_rtcl",
          "args": [],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_rtcl",
          "args": [],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__USE_RTC",
          "args": [],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid __delay(unsigned long loops)\n{\n\tunsigned long start;\n\tint diff;\n\n\tif (__USE_RTC()) {\n\t\tstart = get_rtcl();\n\t\tdo {\n\t\t\t/* the RTCL register wraps at 1000000000 */\n\t\t\tdiff = get_rtcl() - start;\n\t\t\tif (diff < 0)\n\t\t\t\tdiff += 1000000000;\n\t\t} while (diff < loops);\n\t} else {\n\t\tstart = get_tbl();\n\t\twhile (get_tbl() - start < loops)\n\t\t\tHMT_low();\n\t\tHMT_medium();\n\t}\n}"
  },
  {
    "function_name": "vtime_account_user",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "372-382",
    "snippet": "void vtime_account_user(struct task_struct *tsk)\n{\n\tcputime_t utime, utimescaled;\n\n\tutime = get_paca()->user_time;\n\tutimescaled = get_paca()->user_time_scaled;\n\tget_paca()->user_time = 0;\n\tget_paca()->user_time_scaled = 0;\n\tget_paca()->utime_sspurr = 0;\n\taccount_user_time(tsk, utime, utimescaled);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "account_user_time",
          "args": [
            "tsk",
            "utime",
            "utimescaled"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid vtime_account_user(struct task_struct *tsk)\n{\n\tcputime_t utime, utimescaled;\n\n\tutime = get_paca()->user_time;\n\tutimescaled = get_paca()->user_time_scaled;\n\tget_paca()->user_time = 0;\n\tget_paca()->user_time_scaled = 0;\n\tget_paca()->utime_sspurr = 0;\n\taccount_user_time(tsk, utime, utimescaled);\n}"
  },
  {
    "function_name": "vtime_account_idle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "355-361",
    "snippet": "void vtime_account_idle(struct task_struct *tsk)\n{\n\tu64 delta, sys_scaled, stolen;\n\n\tdelta = vtime_delta(tsk, &sys_scaled, &stolen);\n\taccount_idle_time(delta + stolen);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "account_idle_time",
          "args": [
            "delta + stolen"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vtime_delta",
          "args": [
            "tsk",
            "&sys_scaled",
            "&stolen"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "vtime_delta",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "297-342",
          "snippet": "static u64 vtime_delta(struct task_struct *tsk,\n\t\t\tu64 *sys_scaled, u64 *stolen)\n{\n\tu64 now, nowscaled, deltascaled;\n\tu64 udelta, delta, user_scaled;\n\n\tWARN_ON_ONCE(!irqs_disabled());\n\n\tnow = mftb();\n\tnowscaled = read_spurr(now);\n\tget_paca()->system_time += now - get_paca()->starttime;\n\tget_paca()->starttime = now;\n\tdeltascaled = nowscaled - get_paca()->startspurr;\n\tget_paca()->startspurr = nowscaled;\n\n\t*stolen = calculate_stolen_time(now);\n\n\tdelta = get_paca()->system_time;\n\tget_paca()->system_time = 0;\n\tudelta = get_paca()->user_time - get_paca()->utime_sspurr;\n\tget_paca()->utime_sspurr = get_paca()->user_time;\n\n\t/*\n\t * Because we don't read the SPURR on every kernel entry/exit,\n\t * deltascaled includes both user and system SPURR ticks.\n\t * Apportion these ticks to system SPURR ticks and user\n\t * SPURR ticks in the same ratio as the system time (delta)\n\t * and user time (udelta) values obtained from the timebase\n\t * over the same interval.  The system ticks get accounted here;\n\t * the user ticks get saved up in paca->user_time_scaled to be\n\t * used by account_process_tick.\n\t */\n\t*sys_scaled = delta;\n\tuser_scaled = udelta;\n\tif (deltascaled != delta + udelta) {\n\t\tif (udelta) {\n\t\t\t*sys_scaled = deltascaled * delta / (delta + udelta);\n\t\t\tuser_scaled = deltascaled - *sys_scaled;\n\t\t} else {\n\t\t\t*sys_scaled = deltascaled;\n\t\t}\n\t}\n\tget_paca()->user_time_scaled += user_scaled;\n\n\treturn delta;\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 vtime_delta(struct task_struct *tsk,\n\t\t\tu64 *sys_scaled, u64 *stolen)\n{\n\tu64 now, nowscaled, deltascaled;\n\tu64 udelta, delta, user_scaled;\n\n\tWARN_ON_ONCE(!irqs_disabled());\n\n\tnow = mftb();\n\tnowscaled = read_spurr(now);\n\tget_paca()->system_time += now - get_paca()->starttime;\n\tget_paca()->starttime = now;\n\tdeltascaled = nowscaled - get_paca()->startspurr;\n\tget_paca()->startspurr = nowscaled;\n\n\t*stolen = calculate_stolen_time(now);\n\n\tdelta = get_paca()->system_time;\n\tget_paca()->system_time = 0;\n\tudelta = get_paca()->user_time - get_paca()->utime_sspurr;\n\tget_paca()->utime_sspurr = get_paca()->user_time;\n\n\t/*\n\t * Because we don't read the SPURR on every kernel entry/exit,\n\t * deltascaled includes both user and system SPURR ticks.\n\t * Apportion these ticks to system SPURR ticks and user\n\t * SPURR ticks in the same ratio as the system time (delta)\n\t * and user time (udelta) values obtained from the timebase\n\t * over the same interval.  The system ticks get accounted here;\n\t * the user ticks get saved up in paca->user_time_scaled to be\n\t * used by account_process_tick.\n\t */\n\t*sys_scaled = delta;\n\tuser_scaled = udelta;\n\tif (deltascaled != delta + udelta) {\n\t\tif (udelta) {\n\t\t\t*sys_scaled = deltascaled * delta / (delta + udelta);\n\t\t\tuser_scaled = deltascaled - *sys_scaled;\n\t\t} else {\n\t\t\t*sys_scaled = deltascaled;\n\t\t}\n\t}\n\tget_paca()->user_time_scaled += user_scaled;\n\n\treturn delta;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid vtime_account_idle(struct task_struct *tsk)\n{\n\tu64 delta, sys_scaled, stolen;\n\n\tdelta = vtime_delta(tsk, &sys_scaled, &stolen);\n\taccount_idle_time(delta + stolen);\n}"
  },
  {
    "function_name": "vtime_account_system",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "344-352",
    "snippet": "void vtime_account_system(struct task_struct *tsk)\n{\n\tu64 delta, sys_scaled, stolen;\n\n\tdelta = vtime_delta(tsk, &sys_scaled, &stolen);\n\taccount_system_time(tsk, 0, delta, sys_scaled);\n\tif (stolen)\n\t\taccount_steal_time(stolen);\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "account_steal_time",
          "args": [
            "stolen"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "account_system_time",
          "args": [
            "tsk",
            "0",
            "delta",
            "sys_scaled"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vtime_delta",
          "args": [
            "tsk",
            "&sys_scaled",
            "&stolen"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "vtime_delta",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "297-342",
          "snippet": "static u64 vtime_delta(struct task_struct *tsk,\n\t\t\tu64 *sys_scaled, u64 *stolen)\n{\n\tu64 now, nowscaled, deltascaled;\n\tu64 udelta, delta, user_scaled;\n\n\tWARN_ON_ONCE(!irqs_disabled());\n\n\tnow = mftb();\n\tnowscaled = read_spurr(now);\n\tget_paca()->system_time += now - get_paca()->starttime;\n\tget_paca()->starttime = now;\n\tdeltascaled = nowscaled - get_paca()->startspurr;\n\tget_paca()->startspurr = nowscaled;\n\n\t*stolen = calculate_stolen_time(now);\n\n\tdelta = get_paca()->system_time;\n\tget_paca()->system_time = 0;\n\tudelta = get_paca()->user_time - get_paca()->utime_sspurr;\n\tget_paca()->utime_sspurr = get_paca()->user_time;\n\n\t/*\n\t * Because we don't read the SPURR on every kernel entry/exit,\n\t * deltascaled includes both user and system SPURR ticks.\n\t * Apportion these ticks to system SPURR ticks and user\n\t * SPURR ticks in the same ratio as the system time (delta)\n\t * and user time (udelta) values obtained from the timebase\n\t * over the same interval.  The system ticks get accounted here;\n\t * the user ticks get saved up in paca->user_time_scaled to be\n\t * used by account_process_tick.\n\t */\n\t*sys_scaled = delta;\n\tuser_scaled = udelta;\n\tif (deltascaled != delta + udelta) {\n\t\tif (udelta) {\n\t\t\t*sys_scaled = deltascaled * delta / (delta + udelta);\n\t\t\tuser_scaled = deltascaled - *sys_scaled;\n\t\t} else {\n\t\t\t*sys_scaled = deltascaled;\n\t\t}\n\t}\n\tget_paca()->user_time_scaled += user_scaled;\n\n\treturn delta;\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 vtime_delta(struct task_struct *tsk,\n\t\t\tu64 *sys_scaled, u64 *stolen)\n{\n\tu64 now, nowscaled, deltascaled;\n\tu64 udelta, delta, user_scaled;\n\n\tWARN_ON_ONCE(!irqs_disabled());\n\n\tnow = mftb();\n\tnowscaled = read_spurr(now);\n\tget_paca()->system_time += now - get_paca()->starttime;\n\tget_paca()->starttime = now;\n\tdeltascaled = nowscaled - get_paca()->startspurr;\n\tget_paca()->startspurr = nowscaled;\n\n\t*stolen = calculate_stolen_time(now);\n\n\tdelta = get_paca()->system_time;\n\tget_paca()->system_time = 0;\n\tudelta = get_paca()->user_time - get_paca()->utime_sspurr;\n\tget_paca()->utime_sspurr = get_paca()->user_time;\n\n\t/*\n\t * Because we don't read the SPURR on every kernel entry/exit,\n\t * deltascaled includes both user and system SPURR ticks.\n\t * Apportion these ticks to system SPURR ticks and user\n\t * SPURR ticks in the same ratio as the system time (delta)\n\t * and user time (udelta) values obtained from the timebase\n\t * over the same interval.  The system ticks get accounted here;\n\t * the user ticks get saved up in paca->user_time_scaled to be\n\t * used by account_process_tick.\n\t */\n\t*sys_scaled = delta;\n\tuser_scaled = udelta;\n\tif (deltascaled != delta + udelta) {\n\t\tif (udelta) {\n\t\t\t*sys_scaled = deltascaled * delta / (delta + udelta);\n\t\t\tuser_scaled = deltascaled - *sys_scaled;\n\t\t} else {\n\t\t\t*sys_scaled = deltascaled;\n\t\t}\n\t}\n\tget_paca()->user_time_scaled += user_scaled;\n\n\treturn delta;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid vtime_account_system(struct task_struct *tsk)\n{\n\tu64 delta, sys_scaled, stolen;\n\n\tdelta = vtime_delta(tsk, &sys_scaled, &stolen);\n\taccount_system_time(tsk, 0, delta, sys_scaled);\n\tif (stolen)\n\t\taccount_steal_time(stolen);\n}"
  },
  {
    "function_name": "vtime_delta",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "297-342",
    "snippet": "static u64 vtime_delta(struct task_struct *tsk,\n\t\t\tu64 *sys_scaled, u64 *stolen)\n{\n\tu64 now, nowscaled, deltascaled;\n\tu64 udelta, delta, user_scaled;\n\n\tWARN_ON_ONCE(!irqs_disabled());\n\n\tnow = mftb();\n\tnowscaled = read_spurr(now);\n\tget_paca()->system_time += now - get_paca()->starttime;\n\tget_paca()->starttime = now;\n\tdeltascaled = nowscaled - get_paca()->startspurr;\n\tget_paca()->startspurr = nowscaled;\n\n\t*stolen = calculate_stolen_time(now);\n\n\tdelta = get_paca()->system_time;\n\tget_paca()->system_time = 0;\n\tudelta = get_paca()->user_time - get_paca()->utime_sspurr;\n\tget_paca()->utime_sspurr = get_paca()->user_time;\n\n\t/*\n\t * Because we don't read the SPURR on every kernel entry/exit,\n\t * deltascaled includes both user and system SPURR ticks.\n\t * Apportion these ticks to system SPURR ticks and user\n\t * SPURR ticks in the same ratio as the system time (delta)\n\t * and user time (udelta) values obtained from the timebase\n\t * over the same interval.  The system ticks get accounted here;\n\t * the user ticks get saved up in paca->user_time_scaled to be\n\t * used by account_process_tick.\n\t */\n\t*sys_scaled = delta;\n\tuser_scaled = udelta;\n\tif (deltascaled != delta + udelta) {\n\t\tif (udelta) {\n\t\t\t*sys_scaled = deltascaled * delta / (delta + udelta);\n\t\t\tuser_scaled = deltascaled - *sys_scaled;\n\t\t} else {\n\t\t\t*sys_scaled = deltascaled;\n\t\t}\n\t}\n\tget_paca()->user_time_scaled += user_scaled;\n\n\treturn delta;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "calculate_stolen_time",
          "args": [
            "now"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "calculate_stolen_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "286-289",
          "snippet": "static inline u64 calculate_stolen_time(u64 stop_tb)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline u64 calculate_stolen_time(u64 stop_tb)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read_spurr",
          "args": [
            "now"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "read_spurr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "188-195",
          "snippet": "static u64 read_spurr(u64 tb)\n{\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\treturn mfspr(SPRN_SPURR);\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\treturn mfspr(SPRN_PURR);\n\treturn tb;\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 read_spurr(u64 tb)\n{\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\treturn mfspr(SPRN_SPURR);\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\treturn mfspr(SPRN_PURR);\n\treturn tb;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mftb",
          "args": [],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!irqs_disabled()"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irqs_disabled",
          "args": [],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 vtime_delta(struct task_struct *tsk,\n\t\t\tu64 *sys_scaled, u64 *stolen)\n{\n\tu64 now, nowscaled, deltascaled;\n\tu64 udelta, delta, user_scaled;\n\n\tWARN_ON_ONCE(!irqs_disabled());\n\n\tnow = mftb();\n\tnowscaled = read_spurr(now);\n\tget_paca()->system_time += now - get_paca()->starttime;\n\tget_paca()->starttime = now;\n\tdeltascaled = nowscaled - get_paca()->startspurr;\n\tget_paca()->startspurr = nowscaled;\n\n\t*stolen = calculate_stolen_time(now);\n\n\tdelta = get_paca()->system_time;\n\tget_paca()->system_time = 0;\n\tudelta = get_paca()->user_time - get_paca()->utime_sspurr;\n\tget_paca()->utime_sspurr = get_paca()->user_time;\n\n\t/*\n\t * Because we don't read the SPURR on every kernel entry/exit,\n\t * deltascaled includes both user and system SPURR ticks.\n\t * Apportion these ticks to system SPURR ticks and user\n\t * SPURR ticks in the same ratio as the system time (delta)\n\t * and user time (udelta) values obtained from the timebase\n\t * over the same interval.  The system ticks get accounted here;\n\t * the user ticks get saved up in paca->user_time_scaled to be\n\t * used by account_process_tick.\n\t */\n\t*sys_scaled = delta;\n\tuser_scaled = udelta;\n\tif (deltascaled != delta + udelta) {\n\t\tif (udelta) {\n\t\t\t*sys_scaled = deltascaled * delta / (delta + udelta);\n\t\t\tuser_scaled = deltascaled - *sys_scaled;\n\t\t} else {\n\t\t\t*sys_scaled = deltascaled;\n\t\t}\n\t}\n\tget_paca()->user_time_scaled += user_scaled;\n\n\treturn delta;\n}"
  },
  {
    "function_name": "calculate_stolen_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "286-289",
    "snippet": "static inline u64 calculate_stolen_time(u64 stop_tb)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline u64 calculate_stolen_time(u64 stop_tb)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "calculate_stolen_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "271-283",
    "snippet": "static inline u64 calculate_stolen_time(u64 stop_tb)\n{\n\tu64 stolen = 0;\n\n\tif (get_paca()->dtl_ridx != be64_to_cpu(get_lppaca()->dtl_idx)) {\n\t\tstolen = scan_dispatch_log(stop_tb);\n\t\tget_paca()->system_time -= stolen;\n\t}\n\n\tstolen += get_paca()->stolen_time;\n\tget_paca()->stolen_time = 0;\n\treturn stolen;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scan_dispatch_log",
          "args": [
            "stop_tb"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "scan_dispatch_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "203-242",
          "snippet": "static u64 scan_dispatch_log(u64 stop_tb)\n{\n\tu64 i = local_paca->dtl_ridx;\n\tstruct dtl_entry *dtl = local_paca->dtl_curr;\n\tstruct dtl_entry *dtl_end = local_paca->dispatch_log_end;\n\tstruct lppaca *vpa = local_paca->lppaca_ptr;\n\tu64 tb_delta;\n\tu64 stolen = 0;\n\tu64 dtb;\n\n\tif (!dtl)\n\t\treturn 0;\n\n\tif (i == be64_to_cpu(vpa->dtl_idx))\n\t\treturn 0;\n\twhile (i < be64_to_cpu(vpa->dtl_idx)) {\n\t\tdtb = be64_to_cpu(dtl->timebase);\n\t\ttb_delta = be32_to_cpu(dtl->enqueue_to_dispatch_time) +\n\t\t\tbe32_to_cpu(dtl->ready_to_enqueue_time);\n\t\tbarrier();\n\t\tif (i + N_DISPATCH_LOG < be64_to_cpu(vpa->dtl_idx)) {\n\t\t\t/* buffer has overflowed */\n\t\t\ti = be64_to_cpu(vpa->dtl_idx) - N_DISPATCH_LOG;\n\t\t\tdtl = local_paca->dispatch_log + (i % N_DISPATCH_LOG);\n\t\t\tcontinue;\n\t\t}\n\t\tif (dtb > stop_tb)\n\t\t\tbreak;\n\t\tif (dtl_consumer)\n\t\t\tdtl_consumer(dtl, i);\n\t\tstolen += tb_delta;\n\t\t++i;\n\t\t++dtl;\n\t\tif (dtl == dtl_end)\n\t\t\tdtl = local_paca->dispatch_log;\n\t}\n\tlocal_paca->dtl_ridx = i;\n\tlocal_paca->dtl_curr = dtl;\n\treturn stolen;\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 scan_dispatch_log(u64 stop_tb)\n{\n\tu64 i = local_paca->dtl_ridx;\n\tstruct dtl_entry *dtl = local_paca->dtl_curr;\n\tstruct dtl_entry *dtl_end = local_paca->dispatch_log_end;\n\tstruct lppaca *vpa = local_paca->lppaca_ptr;\n\tu64 tb_delta;\n\tu64 stolen = 0;\n\tu64 dtb;\n\n\tif (!dtl)\n\t\treturn 0;\n\n\tif (i == be64_to_cpu(vpa->dtl_idx))\n\t\treturn 0;\n\twhile (i < be64_to_cpu(vpa->dtl_idx)) {\n\t\tdtb = be64_to_cpu(dtl->timebase);\n\t\ttb_delta = be32_to_cpu(dtl->enqueue_to_dispatch_time) +\n\t\t\tbe32_to_cpu(dtl->ready_to_enqueue_time);\n\t\tbarrier();\n\t\tif (i + N_DISPATCH_LOG < be64_to_cpu(vpa->dtl_idx)) {\n\t\t\t/* buffer has overflowed */\n\t\t\ti = be64_to_cpu(vpa->dtl_idx) - N_DISPATCH_LOG;\n\t\t\tdtl = local_paca->dispatch_log + (i % N_DISPATCH_LOG);\n\t\t\tcontinue;\n\t\t}\n\t\tif (dtb > stop_tb)\n\t\t\tbreak;\n\t\tif (dtl_consumer)\n\t\t\tdtl_consumer(dtl, i);\n\t\tstolen += tb_delta;\n\t\t++i;\n\t\t++dtl;\n\t\tif (dtl == dtl_end)\n\t\t\tdtl = local_paca->dispatch_log;\n\t}\n\tlocal_paca->dtl_ridx = i;\n\tlocal_paca->dtl_curr = dtl;\n\treturn stolen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "get_lppaca()->dtl_idx"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_lppaca",
          "args": [],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic inline u64 calculate_stolen_time(u64 stop_tb)\n{\n\tu64 stolen = 0;\n\n\tif (get_paca()->dtl_ridx != be64_to_cpu(get_lppaca()->dtl_idx)) {\n\t\tstolen = scan_dispatch_log(stop_tb);\n\t\tget_paca()->system_time -= stolen;\n\t}\n\n\tstolen += get_paca()->stolen_time;\n\tget_paca()->stolen_time = 0;\n\treturn stolen;\n}"
  },
  {
    "function_name": "accumulate_stolen_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "248-269",
    "snippet": "void accumulate_stolen_time(void)\n{\n\tu64 sst, ust;\n\n\tu8 save_soft_enabled = local_paca->soft_enabled;\n\n\t/* We are called early in the exception entry, before\n\t * soft/hard_enabled are sync'ed to the expected state\n\t * for the exception. We are hard disabled but the PACA\n\t * needs to reflect that so various debug stuff doesn't\n\t * complain\n\t */\n\tlocal_paca->soft_enabled = 0;\n\n\tsst = scan_dispatch_log(local_paca->starttime_user);\n\tust = scan_dispatch_log(local_paca->starttime);\n\tlocal_paca->system_time -= sst;\n\tlocal_paca->user_time -= ust;\n\tlocal_paca->stolen_time += ust + sst;\n\n\tlocal_paca->soft_enabled = save_soft_enabled;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scan_dispatch_log",
          "args": [
            "local_paca->starttime"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "scan_dispatch_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "203-242",
          "snippet": "static u64 scan_dispatch_log(u64 stop_tb)\n{\n\tu64 i = local_paca->dtl_ridx;\n\tstruct dtl_entry *dtl = local_paca->dtl_curr;\n\tstruct dtl_entry *dtl_end = local_paca->dispatch_log_end;\n\tstruct lppaca *vpa = local_paca->lppaca_ptr;\n\tu64 tb_delta;\n\tu64 stolen = 0;\n\tu64 dtb;\n\n\tif (!dtl)\n\t\treturn 0;\n\n\tif (i == be64_to_cpu(vpa->dtl_idx))\n\t\treturn 0;\n\twhile (i < be64_to_cpu(vpa->dtl_idx)) {\n\t\tdtb = be64_to_cpu(dtl->timebase);\n\t\ttb_delta = be32_to_cpu(dtl->enqueue_to_dispatch_time) +\n\t\t\tbe32_to_cpu(dtl->ready_to_enqueue_time);\n\t\tbarrier();\n\t\tif (i + N_DISPATCH_LOG < be64_to_cpu(vpa->dtl_idx)) {\n\t\t\t/* buffer has overflowed */\n\t\t\ti = be64_to_cpu(vpa->dtl_idx) - N_DISPATCH_LOG;\n\t\t\tdtl = local_paca->dispatch_log + (i % N_DISPATCH_LOG);\n\t\t\tcontinue;\n\t\t}\n\t\tif (dtb > stop_tb)\n\t\t\tbreak;\n\t\tif (dtl_consumer)\n\t\t\tdtl_consumer(dtl, i);\n\t\tstolen += tb_delta;\n\t\t++i;\n\t\t++dtl;\n\t\tif (dtl == dtl_end)\n\t\t\tdtl = local_paca->dispatch_log;\n\t}\n\tlocal_paca->dtl_ridx = i;\n\tlocal_paca->dtl_curr = dtl;\n\treturn stolen;\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 scan_dispatch_log(u64 stop_tb)\n{\n\tu64 i = local_paca->dtl_ridx;\n\tstruct dtl_entry *dtl = local_paca->dtl_curr;\n\tstruct dtl_entry *dtl_end = local_paca->dispatch_log_end;\n\tstruct lppaca *vpa = local_paca->lppaca_ptr;\n\tu64 tb_delta;\n\tu64 stolen = 0;\n\tu64 dtb;\n\n\tif (!dtl)\n\t\treturn 0;\n\n\tif (i == be64_to_cpu(vpa->dtl_idx))\n\t\treturn 0;\n\twhile (i < be64_to_cpu(vpa->dtl_idx)) {\n\t\tdtb = be64_to_cpu(dtl->timebase);\n\t\ttb_delta = be32_to_cpu(dtl->enqueue_to_dispatch_time) +\n\t\t\tbe32_to_cpu(dtl->ready_to_enqueue_time);\n\t\tbarrier();\n\t\tif (i + N_DISPATCH_LOG < be64_to_cpu(vpa->dtl_idx)) {\n\t\t\t/* buffer has overflowed */\n\t\t\ti = be64_to_cpu(vpa->dtl_idx) - N_DISPATCH_LOG;\n\t\t\tdtl = local_paca->dispatch_log + (i % N_DISPATCH_LOG);\n\t\t\tcontinue;\n\t\t}\n\t\tif (dtb > stop_tb)\n\t\t\tbreak;\n\t\tif (dtl_consumer)\n\t\t\tdtl_consumer(dtl, i);\n\t\tstolen += tb_delta;\n\t\t++i;\n\t\t++dtl;\n\t\tif (dtl == dtl_end)\n\t\t\tdtl = local_paca->dispatch_log;\n\t}\n\tlocal_paca->dtl_ridx = i;\n\tlocal_paca->dtl_curr = dtl;\n\treturn stolen;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid accumulate_stolen_time(void)\n{\n\tu64 sst, ust;\n\n\tu8 save_soft_enabled = local_paca->soft_enabled;\n\n\t/* We are called early in the exception entry, before\n\t * soft/hard_enabled are sync'ed to the expected state\n\t * for the exception. We are hard disabled but the PACA\n\t * needs to reflect that so various debug stuff doesn't\n\t * complain\n\t */\n\tlocal_paca->soft_enabled = 0;\n\n\tsst = scan_dispatch_log(local_paca->starttime_user);\n\tust = scan_dispatch_log(local_paca->starttime);\n\tlocal_paca->system_time -= sst;\n\tlocal_paca->user_time -= ust;\n\tlocal_paca->stolen_time += ust + sst;\n\n\tlocal_paca->soft_enabled = save_soft_enabled;\n}"
  },
  {
    "function_name": "scan_dispatch_log",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "203-242",
    "snippet": "static u64 scan_dispatch_log(u64 stop_tb)\n{\n\tu64 i = local_paca->dtl_ridx;\n\tstruct dtl_entry *dtl = local_paca->dtl_curr;\n\tstruct dtl_entry *dtl_end = local_paca->dispatch_log_end;\n\tstruct lppaca *vpa = local_paca->lppaca_ptr;\n\tu64 tb_delta;\n\tu64 stolen = 0;\n\tu64 dtb;\n\n\tif (!dtl)\n\t\treturn 0;\n\n\tif (i == be64_to_cpu(vpa->dtl_idx))\n\t\treturn 0;\n\twhile (i < be64_to_cpu(vpa->dtl_idx)) {\n\t\tdtb = be64_to_cpu(dtl->timebase);\n\t\ttb_delta = be32_to_cpu(dtl->enqueue_to_dispatch_time) +\n\t\t\tbe32_to_cpu(dtl->ready_to_enqueue_time);\n\t\tbarrier();\n\t\tif (i + N_DISPATCH_LOG < be64_to_cpu(vpa->dtl_idx)) {\n\t\t\t/* buffer has overflowed */\n\t\t\ti = be64_to_cpu(vpa->dtl_idx) - N_DISPATCH_LOG;\n\t\t\tdtl = local_paca->dispatch_log + (i % N_DISPATCH_LOG);\n\t\t\tcontinue;\n\t\t}\n\t\tif (dtb > stop_tb)\n\t\t\tbreak;\n\t\tif (dtl_consumer)\n\t\t\tdtl_consumer(dtl, i);\n\t\tstolen += tb_delta;\n\t\t++i;\n\t\t++dtl;\n\t\tif (dtl == dtl_end)\n\t\t\tdtl = local_paca->dispatch_log;\n\t}\n\tlocal_paca->dtl_ridx = i;\n\tlocal_paca->dtl_curr = dtl;\n\treturn stolen;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dtl_consumer",
          "args": [
            "dtl",
            "i"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "vpa->dtl_idx"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "vpa->dtl_idx"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "barrier",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "dtl->ready_to_enqueue_time"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "dtl->enqueue_to_dispatch_time"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "dtl->timebase"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "vpa->dtl_idx"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "vpa->dtl_idx"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 scan_dispatch_log(u64 stop_tb)\n{\n\tu64 i = local_paca->dtl_ridx;\n\tstruct dtl_entry *dtl = local_paca->dtl_curr;\n\tstruct dtl_entry *dtl_end = local_paca->dispatch_log_end;\n\tstruct lppaca *vpa = local_paca->lppaca_ptr;\n\tu64 tb_delta;\n\tu64 stolen = 0;\n\tu64 dtb;\n\n\tif (!dtl)\n\t\treturn 0;\n\n\tif (i == be64_to_cpu(vpa->dtl_idx))\n\t\treturn 0;\n\twhile (i < be64_to_cpu(vpa->dtl_idx)) {\n\t\tdtb = be64_to_cpu(dtl->timebase);\n\t\ttb_delta = be32_to_cpu(dtl->enqueue_to_dispatch_time) +\n\t\t\tbe32_to_cpu(dtl->ready_to_enqueue_time);\n\t\tbarrier();\n\t\tif (i + N_DISPATCH_LOG < be64_to_cpu(vpa->dtl_idx)) {\n\t\t\t/* buffer has overflowed */\n\t\t\ti = be64_to_cpu(vpa->dtl_idx) - N_DISPATCH_LOG;\n\t\t\tdtl = local_paca->dispatch_log + (i % N_DISPATCH_LOG);\n\t\t\tcontinue;\n\t\t}\n\t\tif (dtb > stop_tb)\n\t\t\tbreak;\n\t\tif (dtl_consumer)\n\t\t\tdtl_consumer(dtl, i);\n\t\tstolen += tb_delta;\n\t\t++i;\n\t\t++dtl;\n\t\tif (dtl == dtl_end)\n\t\t\tdtl = local_paca->dispatch_log;\n\t}\n\tlocal_paca->dtl_ridx = i;\n\tlocal_paca->dtl_curr = dtl;\n\treturn stolen;\n}"
  },
  {
    "function_name": "read_spurr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "188-195",
    "snippet": "static u64 read_spurr(u64 tb)\n{\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\treturn mfspr(SPRN_SPURR);\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\treturn mfspr(SPRN_PURR);\n\treturn tb;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PURR"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_PURR"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_SPURR"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SPURR"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nstatic u64 read_spurr(u64 tb)\n{\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\treturn mfspr(SPRN_SPURR);\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\treturn mfspr(SPRN_PURR);\n\treturn tb;\n}"
  },
  {
    "function_name": "calc_cputime_factors",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
    "lines": "170-182",
    "snippet": "static void calc_cputime_factors(void)\n{\n\tstruct div_result res;\n\n\tdiv128_by_32(HZ, 0, tb_ticks_per_sec, &res);\n\t__cputime_jiffies_factor = res.result_low;\n\tdiv128_by_32(1000000, 0, tb_ticks_per_sec, &res);\n\t__cputime_usec_factor = res.result_low;\n\tdiv128_by_32(1, 0, tb_ticks_per_sec, &res);\n\t__cputime_sec_factor = res.result_low;\n\tdiv128_by_32(USER_HZ, 0, tb_ticks_per_sec, &res);\n\t__cputime_clockt_factor = res.result_low;\n}",
    "includes": [
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/clockchips.h>",
      "#include <asm/cputime.h>",
      "#include <asm/firmware.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/smp.h>",
      "#include <asm/div64.h>",
      "#include <asm/irq.h>",
      "#include <asm/prom.h>",
      "#include <asm/time.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/cache.h>",
      "#include <asm/nvram.h>",
      "#include <asm/processor.h>",
      "#include <asm/io.h>",
      "#include <asm/trace.h>",
      "#include <linux/clk-provider.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/delay.h>",
      "#include <linux/irq.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/rtc.h>",
      "#include <linux/percpu.h>",
      "#include <linux/security.h>",
      "#include <linux/cpu.h>",
      "#include <linux/profile.h>",
      "#include <linux/init.h>",
      "#include <linux/clockchips.h>",
      "#include <linux/time.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/timex.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/mm.h>",
      "#include <linux/string.h>",
      "#include <linux/param.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long tb_ticks_per_sec;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "div128_by_32",
          "args": [
            "USER_HZ",
            "0",
            "tb_ticks_per_sec",
            "&res"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "div128_by_32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "1077-1104",
          "snippet": "void div128_by_32(u64 dividend_high, u64 dividend_low,\n\t\t  unsigned divisor, struct div_result *dr)\n{\n\tunsigned long a, b, c, d;\n\tunsigned long w, x, y, z;\n\tu64 ra, rb, rc;\n\n\ta = dividend_high >> 32;\n\tb = dividend_high & 0xffffffff;\n\tc = dividend_low >> 32;\n\td = dividend_low & 0xffffffff;\n\n\tw = a / divisor;\n\tra = ((u64)(a - (w * divisor)) << 32) + b;\n\n\trb = ((u64) do_div(ra, divisor) << 32) + c;\n\tx = ra;\n\n\trc = ((u64) do_div(rb, divisor) << 32) + d;\n\ty = rb;\n\n\tdo_div(rc, divisor);\n\tz = rc;\n\n\tdr->result_high = ((u64)w << 32) + x;\n\tdr->result_low  = ((u64)y << 32) + z;\n\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid div128_by_32(u64 dividend_high, u64 dividend_low,\n\t\t  unsigned divisor, struct div_result *dr)\n{\n\tunsigned long a, b, c, d;\n\tunsigned long w, x, y, z;\n\tu64 ra, rb, rc;\n\n\ta = dividend_high >> 32;\n\tb = dividend_high & 0xffffffff;\n\tc = dividend_low >> 32;\n\td = dividend_low & 0xffffffff;\n\n\tw = a / divisor;\n\tra = ((u64)(a - (w * divisor)) << 32) + b;\n\n\trb = ((u64) do_div(ra, divisor) << 32) + c;\n\tx = ra;\n\n\trc = ((u64) do_div(rb, divisor) << 32) + d;\n\ty = rb;\n\n\tdo_div(rc, divisor);\n\tz = rc;\n\n\tdr->result_high = ((u64)w << 32) + x;\n\tdr->result_low  = ((u64)y << 32) + z;\n\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long tb_ticks_per_sec;\n\nstatic void calc_cputime_factors(void)\n{\n\tstruct div_result res;\n\n\tdiv128_by_32(HZ, 0, tb_ticks_per_sec, &res);\n\t__cputime_jiffies_factor = res.result_low;\n\tdiv128_by_32(1000000, 0, tb_ticks_per_sec, &res);\n\t__cputime_usec_factor = res.result_low;\n\tdiv128_by_32(1, 0, tb_ticks_per_sec, &res);\n\t__cputime_sec_factor = res.result_low;\n\tdiv128_by_32(USER_HZ, 0, tb_ticks_per_sec, &res);\n\t__cputime_clockt_factor = res.result_low;\n}"
  }
]