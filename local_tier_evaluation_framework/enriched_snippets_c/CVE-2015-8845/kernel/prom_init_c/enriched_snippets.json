[
  {
    "function_name": "prom_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2747-2960",
    "snippet": "unsigned long __init prom_init(unsigned long r3, unsigned long r4,\n\t\t\t       unsigned long pp,\n\t\t\t       unsigned long r6, unsigned long r7,\n\t\t\t       unsigned long kbase)\n{\t\n\tunsigned long hdr;\n\n#ifdef CONFIG_PPC32\n\tunsigned long offset = reloc_offset();\n\treloc_got2(offset);\n#else\n\treloc_toc();\n#endif\n\n\t/*\n\t * First zero the BSS\n\t */\n\tmemset(&__bss_start, 0, __bss_stop - __bss_start);\n\n\t/*\n\t * Init interface to Open Firmware, get some node references,\n\t * like /chosen\n\t */\n\tprom_init_client_services(pp);\n\n\t/*\n\t * See if this OF is old enough that we need to do explicit maps\n\t * and other workarounds\n\t */\n\tprom_find_mmu();\n\n\t/*\n\t * Init prom stdout device\n\t */\n\tprom_init_stdout();\n\n\tprom_printf(\"Preparing to boot %s\", linux_banner);\n\n\t/*\n\t * Get default machine type. At this point, we do not differentiate\n\t * between pSeries SMP and pSeries LPAR\n\t */\n\tof_platform = prom_find_machine_type();\n\tprom_printf(\"Detected machine type: %x\\n\", of_platform);\n\n#ifndef CONFIG_NONSTATIC_KERNEL\n\t/* Bail if this is a kdump kernel. */\n\tif (PHYSICAL_START > 0)\n\t\tprom_panic(\"Error: You can't boot a kdump kernel from OF!\\n\");\n#endif\n\n\t/*\n\t * Check for an initrd\n\t */\n\tprom_check_initrd(r3, r4);\n\n#if defined(CONFIG_PPC_PSERIES) || defined(CONFIG_PPC_POWERNV)\n\t/*\n\t * On pSeries, inform the firmware about our capabilities\n\t */\n\tif (of_platform == PLATFORM_PSERIES ||\n\t    of_platform == PLATFORM_PSERIES_LPAR)\n\t\tprom_send_capabilities();\n#endif\n\n\t/*\n\t * Copy the CPU hold code\n\t */\n\tif (of_platform != PLATFORM_POWERMAC)\n\t\tcopy_and_flush(0, kbase, 0x100, 0);\n\n\t/*\n\t * Do early parsing of command line\n\t */\n\tearly_cmdline_parse();\n\n\t/*\n\t * Initialize memory management within prom_init\n\t */\n\tprom_init_mem();\n\n\t/*\n\t * Determine which cpu is actually running right _now_\n\t */\n\tprom_find_boot_cpu();\n\n\t/* \n\t * Initialize display devices\n\t */\n\tprom_check_displays();\n\n#if defined(CONFIG_PPC64) && defined(__BIG_ENDIAN__)\n\t/*\n\t * Initialize IOMMU (TCE tables) on pSeries. Do that before anything else\n\t * that uses the allocator, we need to make sure we get the top of memory\n\t * available for us here...\n\t */\n\tif (of_platform == PLATFORM_PSERIES)\n\t\tprom_initialize_tce_table();\n#endif\n\n\t/*\n\t * On non-powermacs, try to instantiate RTAS. PowerMacs don't\n\t * have a usable RTAS implementation.\n\t */\n\tif (of_platform != PLATFORM_POWERMAC &&\n\t    of_platform != PLATFORM_OPAL)\n\t\tprom_instantiate_rtas();\n\n#ifdef CONFIG_PPC_POWERNV\n\tif (of_platform == PLATFORM_OPAL)\n\t\tprom_instantiate_opal();\n#endif /* CONFIG_PPC_POWERNV */\n\n#ifdef CONFIG_PPC64\n\t/* instantiate sml */\n\tprom_instantiate_sml();\n#endif\n\n\t/*\n\t * On non-powermacs, put all CPUs in spin-loops.\n\t *\n\t * PowerMacs use a different mechanism to spin CPUs\n\t *\n\t * (This must be done after instanciating RTAS)\n\t */\n\tif (of_platform != PLATFORM_POWERMAC &&\n\t    of_platform != PLATFORM_OPAL)\n\t\tprom_hold_cpus();\n\n\t/*\n\t * Fill in some infos for use by the kernel later on\n\t */\n\tif (prom_memory_limit) {\n\t\t__be64 val = cpu_to_be64(prom_memory_limit);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,memory-limit\",\n\t\t\t     &val, sizeof(val));\n\t}\n#ifdef CONFIG_PPC64\n\tif (prom_iommu_off)\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,iommu-off\",\n\t\t\t     NULL, 0);\n\n\tif (prom_iommu_force_on)\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,iommu-force-on\",\n\t\t\t     NULL, 0);\n\n\tif (prom_tce_alloc_start) {\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,tce-alloc-start\",\n\t\t\t     &prom_tce_alloc_start,\n\t\t\t     sizeof(prom_tce_alloc_start));\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,tce-alloc-end\",\n\t\t\t     &prom_tce_alloc_end,\n\t\t\t     sizeof(prom_tce_alloc_end));\n\t}\n#endif\n\n\t/*\n\t * Fixup any known bugs in the device-tree\n\t */\n\tfixup_device_tree();\n\n\t/*\n\t * Now finally create the flattened device-tree\n\t */\n\tprom_printf(\"copying OF device tree...\\n\");\n\tflatten_device_tree();\n\n\t/*\n\t * in case stdin is USB and still active on IBM machines...\n\t * Unfortunately quiesce crashes on some powermacs if we have\n\t * closed stdin already (in particular the powerbook 101). It\n\t * appears that the OPAL version of OFW doesn't like it either.\n\t */\n\tif (of_platform != PLATFORM_POWERMAC &&\n\t    of_platform != PLATFORM_OPAL)\n\t\tprom_close_stdin();\n\n\t/*\n\t * Call OF \"quiesce\" method to shut down pending DMA's from\n\t * devices etc...\n\t */\n\tprom_printf(\"Quiescing Open Firmware ...\\n\");\n\tcall_prom(\"quiesce\", 0, 0);\n\n\t/*\n\t * And finally, call the kernel passing it the flattened device\n\t * tree and NULL as r5, thus triggering the new entry point which\n\t * is common to us and kexec\n\t */\n\thdr = dt_header_start;\n\n\t/* Don't print anything after quiesce under OPAL, it crashes OFW */\n\tif (of_platform != PLATFORM_OPAL) {\n\t\tprom_printf(\"Booting Linux via __start() ...\\n\");\n\t\tprom_debug(\"->dt_header_start=0x%x\\n\", hdr);\n\t}\n\n#ifdef CONFIG_PPC32\n\treloc_got2(-offset);\n#else\n\tunreloc_toc();\n#endif\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_OPAL\n\t/* OPAL early debug gets the OPAL base & entry in r8 and r9 */\n\t__start(hdr, kbase, 0, 0, 0,\n\t\tprom_opal_base, prom_opal_entry);\n#else\n\t__start(hdr, kbase, 0, 0, 0, 0, 0);\n#endif\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PLATFORM_OPAL\t\t0x0600",
      "#define PLATFORM_POWERMAC\t0x0400",
      "#define PLATFORM_PSERIES_LPAR\t0x0101",
      "#define PLATFORM_PSERIES\t0x0100"
    ],
    "globals_used": [
      "extern void __start(unsigned long r3, unsigned long r4, unsigned long r5,\n\t\t    unsigned long r6, unsigned long r7, unsigned long r8,\n\t\t    unsigned long r9);",
      "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);",
      "static struct prom_t __initdata prom;",
      "static unsigned long __initdata dt_header_start;",
      "static unsigned long __initdata prom_memory_limit;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__start",
          "args": [
            "hdr",
            "kbase",
            "0",
            "0",
            "0",
            "0",
            "0"
          ],
          "line": 2956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__start",
          "args": [
            "hdr",
            "kbase",
            "0",
            "0",
            "0",
            "prom_opal_base",
            "prom_opal_entry"
          ],
          "line": 2953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unreloc_toc",
          "args": [],
          "line": 2948
        },
        "resolved": true,
        "details": {
          "function_name": "unreloc_toc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2729-2738",
          "snippet": "static void unreloc_toc(void)\n{\n\tunsigned long offset = reloc_offset();\n\tunsigned long nr_entries =\n\t\t(__prom_init_toc_end - __prom_init_toc_start) / sizeof(long);\n\n\tmb();\n\n\t__reloc_toc(-offset, nr_entries);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\n\nstatic void unreloc_toc(void)\n{\n\tunsigned long offset = reloc_offset();\n\tunsigned long nr_entries =\n\t\t(__prom_init_toc_end - __prom_init_toc_start) / sizeof(long);\n\n\tmb();\n\n\t__reloc_toc(-offset, nr_entries);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reloc_got2",
          "args": [
            "-offset"
          ],
          "line": 2946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"->dt_header_start=0x%x\\n\"",
            "hdr"
          ],
          "line": 2942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Booting Linux via __start() ...\\n\""
          ],
          "line": 2941
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"quiesce\"",
            "0",
            "0"
          ],
          "line": 2930
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "217-239",
          "snippet": "static int __init call_prom(const char *service, int nargs, int nret, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, nret);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom(const char *service, int nargs, int nret, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, nret);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_close_stdin",
          "args": [],
          "line": 2923
        },
        "resolved": true,
        "details": {
          "function_name": "prom_close_stdin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1261-1270",
          "snippet": "static void __init prom_close_stdin(void)\n{\n\t__be32 val;\n\tihandle stdin;\n\n\tif (prom_getprop(prom.chosen, \"stdin\", &val, sizeof(val)) > 0) {\n\t\tstdin = be32_to_cpu(val);\n\t\tcall_prom(\"close\", 1, 0, stdin);\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_close_stdin(void)\n{\n\t__be32 val;\n\tihandle stdin;\n\n\tif (prom_getprop(prom.chosen, \"stdin\", &val, sizeof(val)) > 0) {\n\t\tstdin = be32_to_cpu(val);\n\t\tcall_prom(\"close\", 1, 0, stdin);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "flatten_device_tree",
          "args": [],
          "line": 2913
        },
        "resolved": true,
        "details": {
          "function_name": "flatten_device_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2228-2320",
          "snippet": "static void __init flatten_device_tree(void)\n{\n\tphandle root;\n\tunsigned long mem_start, mem_end, room;\n\tstruct boot_param_header *hdr;\n\tchar *namep;\n\tu64 *rsvmap;\n\n\t/*\n\t * Check how much room we have between alloc top & bottom (+/- a\n\t * few pages), crop to 1MB, as this is our \"chunk\" size\n\t */\n\troom = alloc_top - alloc_bottom - 0x4000;\n\tif (room > DEVTREE_CHUNK_SIZE)\n\t\troom = DEVTREE_CHUNK_SIZE;\n\tprom_debug(\"starting device tree allocs at %x\\n\", alloc_bottom);\n\n\t/* Now try to claim that */\n\tmem_start = (unsigned long)alloc_up(room, PAGE_SIZE);\n\tif (mem_start == 0)\n\t\tprom_panic(\"Can't allocate initial device-tree chunk\\n\");\n\tmem_end = mem_start + room;\n\n\t/* Get root of tree */\n\troot = call_prom(\"peer\", 1, 1, (phandle)0);\n\tif (root == (phandle)0)\n\t\tprom_panic (\"couldn't get device tree root\\n\");\n\n\t/* Build header and make room for mem rsv map */ \n\tmem_start = _ALIGN(mem_start, 4);\n\thdr = make_room(&mem_start, &mem_end,\n\t\t\tsizeof(struct boot_param_header), 4);\n\tdt_header_start = (unsigned long)hdr;\n\trsvmap = make_room(&mem_start, &mem_end, sizeof(mem_reserve_map), 8);\n\n\t/* Start of strings */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_string_start = mem_start;\n\tmem_start += 4; /* hole */\n\n\t/* Add \"linux,phandle\" in there, we'll need it */\n\tnamep = make_room(&mem_start, &mem_end, 16, 1);\n\tstrcpy(namep, \"linux,phandle\");\n\tmem_start = (unsigned long)namep + strlen(namep) + 1;\n\n\t/* Build string array */\n\tprom_printf(\"Building dt strings...\\n\"); \n\tscan_dt_build_strings(root, &mem_start, &mem_end);\n\tdt_string_end = mem_start;\n\n\t/* Build structure */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_struct_start = mem_start;\n\tprom_printf(\"Building dt structure...\\n\"); \n\tscan_dt_build_struct(root, &mem_start, &mem_end);\n\tdt_push_token(OF_DT_END, &mem_start, &mem_end);\n\tdt_struct_end = PAGE_ALIGN(mem_start);\n\n\t/* Finish header */\n\thdr->boot_cpuid_phys = cpu_to_be32(prom.cpu);\n\thdr->magic = cpu_to_be32(OF_DT_HEADER);\n\thdr->totalsize = cpu_to_be32(dt_struct_end - dt_header_start);\n\thdr->off_dt_struct = cpu_to_be32(dt_struct_start - dt_header_start);\n\thdr->off_dt_strings = cpu_to_be32(dt_string_start - dt_header_start);\n\thdr->dt_strings_size = cpu_to_be32(dt_string_end - dt_string_start);\n\thdr->off_mem_rsvmap = cpu_to_be32(((unsigned long)rsvmap) - dt_header_start);\n\thdr->version = cpu_to_be32(OF_DT_VERSION);\n\t/* Version 16 is not backward compatible */\n\thdr->last_comp_version = cpu_to_be32(0x10);\n\n\t/* Copy the reserve map in */\n\tmemcpy(rsvmap, mem_reserve_map, sizeof(mem_reserve_map));\n\n#ifdef DEBUG_PROM\n\t{\n\t\tint i;\n\t\tprom_printf(\"reserved memory map:\\n\");\n\t\tfor (i = 0; i < mem_reserve_cnt; i++)\n\t\t\tprom_printf(\"  %x - %x\\n\",\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].base),\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].size));\n\t}\n#endif\n\t/* Bump mem_reserve_cnt to cause further reservations to fail\n\t * since it's too late.\n\t */\n\tmem_reserve_cnt = MEM_RESERVE_MAP_SIZE;\n\n\tprom_printf(\"Device tree strings 0x%x -> 0x%x\\n\",\n\t\t    dt_string_start, dt_string_end);\n\tprom_printf(\"Device tree struct  0x%x -> 0x%x\\n\",\n\t\t    dt_struct_start, dt_struct_end);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MEM_RESERVE_MAP_SIZE\t8",
            "#define DEVTREE_CHUNK_SIZE\t0x100000"
          ],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static unsigned long __initdata dt_header_start;",
            "static unsigned long __initdata dt_struct_start, dt_struct_end;",
            "static unsigned long __initdata dt_string_start, dt_string_end;",
            "static unsigned long __initdata alloc_top;",
            "static unsigned long __initdata alloc_bottom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n#define DEVTREE_CHUNK_SIZE\t0x100000\n\nstatic struct prom_t __initdata prom;\nstatic unsigned long __initdata dt_header_start;\nstatic unsigned long __initdata dt_struct_start, dt_struct_end;\nstatic unsigned long __initdata dt_string_start, dt_string_end;\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_bottom;\nstatic void __init;\n\nstatic void __init flatten_device_tree(void)\n{\n\tphandle root;\n\tunsigned long mem_start, mem_end, room;\n\tstruct boot_param_header *hdr;\n\tchar *namep;\n\tu64 *rsvmap;\n\n\t/*\n\t * Check how much room we have between alloc top & bottom (+/- a\n\t * few pages), crop to 1MB, as this is our \"chunk\" size\n\t */\n\troom = alloc_top - alloc_bottom - 0x4000;\n\tif (room > DEVTREE_CHUNK_SIZE)\n\t\troom = DEVTREE_CHUNK_SIZE;\n\tprom_debug(\"starting device tree allocs at %x\\n\", alloc_bottom);\n\n\t/* Now try to claim that */\n\tmem_start = (unsigned long)alloc_up(room, PAGE_SIZE);\n\tif (mem_start == 0)\n\t\tprom_panic(\"Can't allocate initial device-tree chunk\\n\");\n\tmem_end = mem_start + room;\n\n\t/* Get root of tree */\n\troot = call_prom(\"peer\", 1, 1, (phandle)0);\n\tif (root == (phandle)0)\n\t\tprom_panic (\"couldn't get device tree root\\n\");\n\n\t/* Build header and make room for mem rsv map */ \n\tmem_start = _ALIGN(mem_start, 4);\n\thdr = make_room(&mem_start, &mem_end,\n\t\t\tsizeof(struct boot_param_header), 4);\n\tdt_header_start = (unsigned long)hdr;\n\trsvmap = make_room(&mem_start, &mem_end, sizeof(mem_reserve_map), 8);\n\n\t/* Start of strings */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_string_start = mem_start;\n\tmem_start += 4; /* hole */\n\n\t/* Add \"linux,phandle\" in there, we'll need it */\n\tnamep = make_room(&mem_start, &mem_end, 16, 1);\n\tstrcpy(namep, \"linux,phandle\");\n\tmem_start = (unsigned long)namep + strlen(namep) + 1;\n\n\t/* Build string array */\n\tprom_printf(\"Building dt strings...\\n\"); \n\tscan_dt_build_strings(root, &mem_start, &mem_end);\n\tdt_string_end = mem_start;\n\n\t/* Build structure */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_struct_start = mem_start;\n\tprom_printf(\"Building dt structure...\\n\"); \n\tscan_dt_build_struct(root, &mem_start, &mem_end);\n\tdt_push_token(OF_DT_END, &mem_start, &mem_end);\n\tdt_struct_end = PAGE_ALIGN(mem_start);\n\n\t/* Finish header */\n\thdr->boot_cpuid_phys = cpu_to_be32(prom.cpu);\n\thdr->magic = cpu_to_be32(OF_DT_HEADER);\n\thdr->totalsize = cpu_to_be32(dt_struct_end - dt_header_start);\n\thdr->off_dt_struct = cpu_to_be32(dt_struct_start - dt_header_start);\n\thdr->off_dt_strings = cpu_to_be32(dt_string_start - dt_header_start);\n\thdr->dt_strings_size = cpu_to_be32(dt_string_end - dt_string_start);\n\thdr->off_mem_rsvmap = cpu_to_be32(((unsigned long)rsvmap) - dt_header_start);\n\thdr->version = cpu_to_be32(OF_DT_VERSION);\n\t/* Version 16 is not backward compatible */\n\thdr->last_comp_version = cpu_to_be32(0x10);\n\n\t/* Copy the reserve map in */\n\tmemcpy(rsvmap, mem_reserve_map, sizeof(mem_reserve_map));\n\n#ifdef DEBUG_PROM\n\t{\n\t\tint i;\n\t\tprom_printf(\"reserved memory map:\\n\");\n\t\tfor (i = 0; i < mem_reserve_cnt; i++)\n\t\t\tprom_printf(\"  %x - %x\\n\",\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].base),\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].size));\n\t}\n#endif\n\t/* Bump mem_reserve_cnt to cause further reservations to fail\n\t * since it's too late.\n\t */\n\tmem_reserve_cnt = MEM_RESERVE_MAP_SIZE;\n\n\tprom_printf(\"Device tree strings 0x%x -> 0x%x\\n\",\n\t\t    dt_string_start, dt_string_end);\n\tprom_printf(\"Device tree struct  0x%x -> 0x%x\\n\",\n\t\t    dt_struct_start, dt_struct_end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fixup_device_tree",
          "args": [],
          "line": 2907
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_device_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2641-2648",
          "snippet": "static void __init fixup_device_tree(void)\n{\n\tfixup_device_tree_maple();\n\tfixup_device_tree_maple_memory_controller();\n\tfixup_device_tree_chrp();\n\tfixup_device_tree_pmac();\n\tfixup_device_tree_efika();\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init fixup_device_tree(void)\n{\n\tfixup_device_tree_maple();\n\tfixup_device_tree_maple_memory_controller();\n\tfixup_device_tree_chrp();\n\tfixup_device_tree_pmac();\n\tfixup_device_tree_efika();\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "prom.chosen",
            "\"/chosen\"",
            "\"linux,tce-alloc-end\"",
            "&prom_tce_alloc_end",
            "sizeof(prom_tce_alloc_end)"
          ],
          "line": 2898
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "500-520",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be64",
          "args": [
            "prom_memory_limit"
          ],
          "line": 2881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_hold_cpus",
          "args": [],
          "line": 2875
        },
        "resolved": true,
        "details": {
          "function_name": "prom_hold_cpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1657-1744",
          "snippet": "static void __init prom_hold_cpus(void)\n{\n\tunsigned long i;\n\tphandle node;\n\tchar type[64];\n\tunsigned long *spinloop\n\t\t= (void *) LOW_ADDR(__secondary_hold_spinloop);\n\tunsigned long *acknowledge\n\t\t= (void *) LOW_ADDR(__secondary_hold_acknowledge);\n\tunsigned long secondary_hold = LOW_ADDR(__secondary_hold);\n\n\t/*\n\t * On pseries, if RTAS supports \"query-cpu-stopped-state\",\n\t * we skip this stage, the CPUs will be started by the\n\t * kernel using RTAS.\n\t */\n\tif ((of_platform == PLATFORM_PSERIES ||\n\t     of_platform == PLATFORM_PSERIES_LPAR) &&\n\t    rtas_has_query_cpu_stopped) {\n\t\tprom_printf(\"prom_hold_cpus: skipped\\n\");\n\t\treturn;\n\t}\n\n\tprom_debug(\"prom_hold_cpus: start...\\n\");\n\tprom_debug(\"    1) spinloop       = 0x%x\\n\", (unsigned long)spinloop);\n\tprom_debug(\"    1) *spinloop      = 0x%x\\n\", *spinloop);\n\tprom_debug(\"    1) acknowledge    = 0x%x\\n\",\n\t\t   (unsigned long)acknowledge);\n\tprom_debug(\"    1) *acknowledge   = 0x%x\\n\", *acknowledge);\n\tprom_debug(\"    1) secondary_hold = 0x%x\\n\", secondary_hold);\n\n\t/* Set the common spinloop variable, so all of the secondary cpus\n\t * will block when they are awakened from their OF spinloop.\n\t * This must occur for both SMP and non SMP kernels, since OF will\n\t * be trashed when we move the kernel.\n\t */\n\t*spinloop = 0;\n\n\t/* look for cpus */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tunsigned int cpu_no;\n\t\t__be32 reg;\n\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (strcmp(type, \"cpu\") != 0)\n\t\t\tcontinue;\n\n\t\t/* Skip non-configured cpus. */\n\t\tif (prom_getprop(node, \"status\", type, sizeof(type)) > 0)\n\t\t\tif (strcmp(type, \"okay\") != 0)\n\t\t\t\tcontinue;\n\n\t\treg = cpu_to_be32(-1); /* make sparse happy */\n\t\tprom_getprop(node, \"reg\", &reg, sizeof(reg));\n\t\tcpu_no = be32_to_cpu(reg);\n\n\t\tprom_debug(\"cpu hw idx   = %lu\\n\", cpu_no);\n\n\t\t/* Init the acknowledge var which will be reset by\n\t\t * the secondary cpu when it awakens from its OF\n\t\t * spinloop.\n\t\t */\n\t\t*acknowledge = (unsigned long)-1;\n\n\t\tif (cpu_no != prom.cpu) {\n\t\t\t/* Primary Thread of non-boot cpu or any thread */\n\t\t\tprom_printf(\"starting cpu hw idx %lu... \", cpu_no);\n\t\t\tcall_prom(\"start-cpu\", 3, 0, node,\n\t\t\t\t  secondary_hold, cpu_no);\n\n\t\t\tfor (i = 0; (i < 100000000) && \n\t\t\t     (*acknowledge == ((unsigned long)-1)); i++ )\n\t\t\t\tmb();\n\n\t\t\tif (*acknowledge == cpu_no)\n\t\t\t\tprom_printf(\"done\\n\");\n\t\t\telse\n\t\t\t\tprom_printf(\"failed: %x\\n\", *acknowledge);\n\t\t}\n#ifdef CONFIG_SMP\n\t\telse\n\t\t\tprom_printf(\"boot cpu hw idx %lu\\n\", cpu_no);\n#endif /* CONFIG_SMP */\n\t}\n\n\tprom_debug(\"prom_hold_cpus: end...\\n\");\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PLATFORM_PSERIES_LPAR\t0x0101",
            "#define PLATFORM_PSERIES\t0x0100"
          ],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static bool rtas_has_query_cpu_stopped;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PLATFORM_PSERIES_LPAR\t0x0101\n#define PLATFORM_PSERIES\t0x0100\n\nstatic struct prom_t __initdata prom;\nstatic bool rtas_has_query_cpu_stopped;\nstatic void __init;\n\nstatic void __init prom_hold_cpus(void)\n{\n\tunsigned long i;\n\tphandle node;\n\tchar type[64];\n\tunsigned long *spinloop\n\t\t= (void *) LOW_ADDR(__secondary_hold_spinloop);\n\tunsigned long *acknowledge\n\t\t= (void *) LOW_ADDR(__secondary_hold_acknowledge);\n\tunsigned long secondary_hold = LOW_ADDR(__secondary_hold);\n\n\t/*\n\t * On pseries, if RTAS supports \"query-cpu-stopped-state\",\n\t * we skip this stage, the CPUs will be started by the\n\t * kernel using RTAS.\n\t */\n\tif ((of_platform == PLATFORM_PSERIES ||\n\t     of_platform == PLATFORM_PSERIES_LPAR) &&\n\t    rtas_has_query_cpu_stopped) {\n\t\tprom_printf(\"prom_hold_cpus: skipped\\n\");\n\t\treturn;\n\t}\n\n\tprom_debug(\"prom_hold_cpus: start...\\n\");\n\tprom_debug(\"    1) spinloop       = 0x%x\\n\", (unsigned long)spinloop);\n\tprom_debug(\"    1) *spinloop      = 0x%x\\n\", *spinloop);\n\tprom_debug(\"    1) acknowledge    = 0x%x\\n\",\n\t\t   (unsigned long)acknowledge);\n\tprom_debug(\"    1) *acknowledge   = 0x%x\\n\", *acknowledge);\n\tprom_debug(\"    1) secondary_hold = 0x%x\\n\", secondary_hold);\n\n\t/* Set the common spinloop variable, so all of the secondary cpus\n\t * will block when they are awakened from their OF spinloop.\n\t * This must occur for both SMP and non SMP kernels, since OF will\n\t * be trashed when we move the kernel.\n\t */\n\t*spinloop = 0;\n\n\t/* look for cpus */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tunsigned int cpu_no;\n\t\t__be32 reg;\n\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (strcmp(type, \"cpu\") != 0)\n\t\t\tcontinue;\n\n\t\t/* Skip non-configured cpus. */\n\t\tif (prom_getprop(node, \"status\", type, sizeof(type)) > 0)\n\t\t\tif (strcmp(type, \"okay\") != 0)\n\t\t\t\tcontinue;\n\n\t\treg = cpu_to_be32(-1); /* make sparse happy */\n\t\tprom_getprop(node, \"reg\", &reg, sizeof(reg));\n\t\tcpu_no = be32_to_cpu(reg);\n\n\t\tprom_debug(\"cpu hw idx   = %lu\\n\", cpu_no);\n\n\t\t/* Init the acknowledge var which will be reset by\n\t\t * the secondary cpu when it awakens from its OF\n\t\t * spinloop.\n\t\t */\n\t\t*acknowledge = (unsigned long)-1;\n\n\t\tif (cpu_no != prom.cpu) {\n\t\t\t/* Primary Thread of non-boot cpu or any thread */\n\t\t\tprom_printf(\"starting cpu hw idx %lu... \", cpu_no);\n\t\t\tcall_prom(\"start-cpu\", 3, 0, node,\n\t\t\t\t  secondary_hold, cpu_no);\n\n\t\t\tfor (i = 0; (i < 100000000) && \n\t\t\t     (*acknowledge == ((unsigned long)-1)); i++ )\n\t\t\t\tmb();\n\n\t\t\tif (*acknowledge == cpu_no)\n\t\t\t\tprom_printf(\"done\\n\");\n\t\t\telse\n\t\t\t\tprom_printf(\"failed: %x\\n\", *acknowledge);\n\t\t}\n#ifdef CONFIG_SMP\n\t\telse\n\t\t\tprom_printf(\"boot cpu hw idx %lu\\n\", cpu_no);\n#endif /* CONFIG_SMP */\n\t}\n\n\tprom_debug(\"prom_hold_cpus: end...\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_instantiate_sml",
          "args": [],
          "line": 2863
        },
        "resolved": true,
        "details": {
          "function_name": "prom_instantiate_sml",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1424-1496",
          "snippet": "static void __init prom_instantiate_sml(void)\n{\n\tphandle ibmvtpm_node;\n\tihandle ibmvtpm_inst;\n\tu32 entry = 0, size = 0, succ = 0;\n\tu64 base;\n\t__be32 val;\n\n\tprom_debug(\"prom_instantiate_sml: start...\\n\");\n\n\tibmvtpm_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tprom_debug(\"ibmvtpm_node: %x\\n\", ibmvtpm_node);\n\tif (!PHANDLE_VALID(ibmvtpm_node))\n\t\treturn;\n\n\tibmvtpm_inst = call_prom(\"open\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tif (!IHANDLE_VALID(ibmvtpm_inst)) {\n\t\tprom_printf(\"opening vtpm package failed (%x)\\n\", ibmvtpm_inst);\n\t\treturn;\n\t}\n\n\tif (prom_getprop(ibmvtpm_node, \"ibm,sml-efi-reformat-supported\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR) {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &succ,\n\t\t\t\t  ADDR(\"reformat-sml-to-efi-alignment\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || succ == 0) {\n\t\t\tprom_printf(\"Reformat SML to EFI alignment failed\\n\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-allocated-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get allocated size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t} else {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-handover-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get handover size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for sml\\n\");\n\n\tprom_printf(\"instantiating sml at 0x%x...\", base);\n\n\tmemset((void *)base, 0, size);\n\n\tif (call_prom_ret(\"call-method\", 4, 2, &entry,\n\t\t\t  ADDR(\"sml-handover\"),\n\t\t\t  ibmvtpm_inst, size, base) != 0 || entry == 0) {\n\t\tprom_printf(\"SML handover failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-base\",\n\t\t     &base, sizeof(base));\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-size\",\n\t\t     &size, sizeof(size));\n\n\tprom_debug(\"sml base     = 0x%x\\n\", base);\n\tprom_debug(\"sml size     = 0x%x\\n\", (long)size);\n\n\tprom_debug(\"prom_instantiate_sml: end...\\n\");\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init prom_instantiate_sml(void)\n{\n\tphandle ibmvtpm_node;\n\tihandle ibmvtpm_inst;\n\tu32 entry = 0, size = 0, succ = 0;\n\tu64 base;\n\t__be32 val;\n\n\tprom_debug(\"prom_instantiate_sml: start...\\n\");\n\n\tibmvtpm_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tprom_debug(\"ibmvtpm_node: %x\\n\", ibmvtpm_node);\n\tif (!PHANDLE_VALID(ibmvtpm_node))\n\t\treturn;\n\n\tibmvtpm_inst = call_prom(\"open\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tif (!IHANDLE_VALID(ibmvtpm_inst)) {\n\t\tprom_printf(\"opening vtpm package failed (%x)\\n\", ibmvtpm_inst);\n\t\treturn;\n\t}\n\n\tif (prom_getprop(ibmvtpm_node, \"ibm,sml-efi-reformat-supported\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR) {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &succ,\n\t\t\t\t  ADDR(\"reformat-sml-to-efi-alignment\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || succ == 0) {\n\t\t\tprom_printf(\"Reformat SML to EFI alignment failed\\n\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-allocated-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get allocated size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t} else {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-handover-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get handover size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for sml\\n\");\n\n\tprom_printf(\"instantiating sml at 0x%x...\", base);\n\n\tmemset((void *)base, 0, size);\n\n\tif (call_prom_ret(\"call-method\", 4, 2, &entry,\n\t\t\t  ADDR(\"sml-handover\"),\n\t\t\t  ibmvtpm_inst, size, base) != 0 || entry == 0) {\n\t\tprom_printf(\"SML handover failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-base\",\n\t\t     &base, sizeof(base));\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-size\",\n\t\t     &size, sizeof(size));\n\n\tprom_debug(\"sml base     = 0x%x\\n\", base);\n\tprom_debug(\"sml size     = 0x%x\\n\", (long)size);\n\n\tprom_debug(\"prom_instantiate_sml: end...\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_instantiate_opal",
          "args": [],
          "line": 2858
        },
        "resolved": true,
        "details": {
          "function_name": "prom_instantiate_opal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1282-1350",
          "snippet": "static void __init prom_instantiate_opal(void)\n{\n\tphandle opal_node;\n\tihandle opal_inst;\n\tu64 base, entry;\n\tu64 size = 0, align = 0x10000;\n\t__be64 val64;\n\tu32 rets[2];\n\n\tprom_debug(\"prom_instantiate_opal: start...\\n\");\n\n\topal_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/ibm,opal\"));\n\tprom_debug(\"opal_node: %x\\n\", opal_node);\n\tif (!PHANDLE_VALID(opal_node))\n\t\treturn;\n\n\tval64 = 0;\n\tprom_getprop(opal_node, \"opal-runtime-size\", &val64, sizeof(val64));\n\tsize = be64_to_cpu(val64);\n\tif (size == 0)\n\t\treturn;\n\tval64 = 0;\n\tprom_getprop(opal_node, \"opal-runtime-alignment\", &val64,sizeof(val64));\n\talign = be64_to_cpu(val64);\n\n\tbase = alloc_down(size, align, 0);\n\tif (base == 0) {\n\t\tprom_printf(\"OPAL allocation failed !\\n\");\n\t\treturn;\n\t}\n\n\topal_inst = call_prom(\"open\", 1, 1, ADDR(\"/ibm,opal\"));\n\tif (!IHANDLE_VALID(opal_inst)) {\n\t\tprom_printf(\"opening opal package failed (%x)\\n\", opal_inst);\n\t\treturn;\n\t}\n\n\tprom_printf(\"instantiating opal at 0x%x...\", base);\n\n\tif (call_prom_ret(\"call-method\", 4, 3, rets,\n\t\t\t  ADDR(\"load-opal-runtime\"),\n\t\t\t  opal_inst,\n\t\t\t  base >> 32, base & 0xffffffff) != 0\n\t    || (rets[0] == 0 && rets[1] == 0)) {\n\t\tprom_printf(\" failed\\n\");\n\t\treturn;\n\t}\n\tentry = (((u64)rets[0]) << 32) | rets[1];\n\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tprom_debug(\"opal base     = 0x%x\\n\", base);\n\tprom_debug(\"opal align    = 0x%x\\n\", align);\n\tprom_debug(\"opal entry    = 0x%x\\n\", entry);\n\tprom_debug(\"opal size     = 0x%x\\n\", (long)size);\n\n\tprom_setprop(opal_node, \"/ibm,opal\", \"opal-base-address\",\n\t\t     &base, sizeof(base));\n\tprom_setprop(opal_node, \"/ibm,opal\", \"opal-entry-address\",\n\t\t     &entry, sizeof(entry));\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_OPAL\n\tprom_opal_base = base;\n\tprom_opal_entry = entry;\n#endif\n\tprom_debug(\"prom_instantiate_opal: end...\\n\");\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_instantiate_opal(void)\n{\n\tphandle opal_node;\n\tihandle opal_inst;\n\tu64 base, entry;\n\tu64 size = 0, align = 0x10000;\n\t__be64 val64;\n\tu32 rets[2];\n\n\tprom_debug(\"prom_instantiate_opal: start...\\n\");\n\n\topal_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/ibm,opal\"));\n\tprom_debug(\"opal_node: %x\\n\", opal_node);\n\tif (!PHANDLE_VALID(opal_node))\n\t\treturn;\n\n\tval64 = 0;\n\tprom_getprop(opal_node, \"opal-runtime-size\", &val64, sizeof(val64));\n\tsize = be64_to_cpu(val64);\n\tif (size == 0)\n\t\treturn;\n\tval64 = 0;\n\tprom_getprop(opal_node, \"opal-runtime-alignment\", &val64,sizeof(val64));\n\talign = be64_to_cpu(val64);\n\n\tbase = alloc_down(size, align, 0);\n\tif (base == 0) {\n\t\tprom_printf(\"OPAL allocation failed !\\n\");\n\t\treturn;\n\t}\n\n\topal_inst = call_prom(\"open\", 1, 1, ADDR(\"/ibm,opal\"));\n\tif (!IHANDLE_VALID(opal_inst)) {\n\t\tprom_printf(\"opening opal package failed (%x)\\n\", opal_inst);\n\t\treturn;\n\t}\n\n\tprom_printf(\"instantiating opal at 0x%x...\", base);\n\n\tif (call_prom_ret(\"call-method\", 4, 3, rets,\n\t\t\t  ADDR(\"load-opal-runtime\"),\n\t\t\t  opal_inst,\n\t\t\t  base >> 32, base & 0xffffffff) != 0\n\t    || (rets[0] == 0 && rets[1] == 0)) {\n\t\tprom_printf(\" failed\\n\");\n\t\treturn;\n\t}\n\tentry = (((u64)rets[0]) << 32) | rets[1];\n\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tprom_debug(\"opal base     = 0x%x\\n\", base);\n\tprom_debug(\"opal align    = 0x%x\\n\", align);\n\tprom_debug(\"opal entry    = 0x%x\\n\", entry);\n\tprom_debug(\"opal size     = 0x%x\\n\", (long)size);\n\n\tprom_setprop(opal_node, \"/ibm,opal\", \"opal-base-address\",\n\t\t     &base, sizeof(base));\n\tprom_setprop(opal_node, \"/ibm,opal\", \"opal-entry-address\",\n\t\t     &entry, sizeof(entry));\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_OPAL\n\tprom_opal_base = base;\n\tprom_opal_entry = entry;\n#endif\n\tprom_debug(\"prom_instantiate_opal: end...\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_instantiate_rtas",
          "args": [],
          "line": 2854
        },
        "resolved": true,
        "details": {
          "function_name": "prom_instantiate_rtas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1357-1418",
          "snippet": "static void __init prom_instantiate_rtas(void)\n{\n\tphandle rtas_node;\n\tihandle rtas_inst;\n\tu32 base, entry = 0;\n\t__be32 val;\n\tu32 size = 0;\n\n\tprom_debug(\"prom_instantiate_rtas: start...\\n\");\n\n\trtas_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tprom_debug(\"rtas_node: %x\\n\", rtas_node);\n\tif (!PHANDLE_VALID(rtas_node))\n\t\treturn;\n\n\tval = 0;\n\tprom_getprop(rtas_node, \"rtas-size\", &val, sizeof(size));\n\tsize = be32_to_cpu(val);\n\tif (size == 0)\n\t\treturn;\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for RTAS\\n\");\n\n\trtas_inst = call_prom(\"open\", 1, 1, ADDR(\"/rtas\"));\n\tif (!IHANDLE_VALID(rtas_inst)) {\n\t\tprom_printf(\"opening rtas package failed (%x)\\n\", rtas_inst);\n\t\treturn;\n\t}\n\n\tprom_printf(\"instantiating rtas at 0x%x...\", base);\n\n\tif (call_prom_ret(\"call-method\", 3, 2, &entry,\n\t\t\t  ADDR(\"instantiate-rtas\"),\n\t\t\t  rtas_inst, base) != 0\n\t    || entry == 0) {\n\t\tprom_printf(\" failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tval = cpu_to_be32(base);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-base\",\n\t\t     &val, sizeof(val));\n\tval = cpu_to_be32(entry);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-entry\",\n\t\t     &val, sizeof(val));\n\n\t/* Check if it supports \"query-cpu-stopped-state\" */\n\tif (prom_getprop(rtas_node, \"query-cpu-stopped-state\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR)\n\t\trtas_has_query_cpu_stopped = true;\n\n\tprom_debug(\"rtas base     = 0x%x\\n\", base);\n\tprom_debug(\"rtas entry    = 0x%x\\n\", entry);\n\tprom_debug(\"rtas size     = 0x%x\\n\", (long)size);\n\n\tprom_debug(\"prom_instantiate_rtas: end...\\n\");\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static bool rtas_has_query_cpu_stopped;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic bool rtas_has_query_cpu_stopped;\nstatic void __init;\n\nstatic void __init prom_instantiate_rtas(void)\n{\n\tphandle rtas_node;\n\tihandle rtas_inst;\n\tu32 base, entry = 0;\n\t__be32 val;\n\tu32 size = 0;\n\n\tprom_debug(\"prom_instantiate_rtas: start...\\n\");\n\n\trtas_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tprom_debug(\"rtas_node: %x\\n\", rtas_node);\n\tif (!PHANDLE_VALID(rtas_node))\n\t\treturn;\n\n\tval = 0;\n\tprom_getprop(rtas_node, \"rtas-size\", &val, sizeof(size));\n\tsize = be32_to_cpu(val);\n\tif (size == 0)\n\t\treturn;\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for RTAS\\n\");\n\n\trtas_inst = call_prom(\"open\", 1, 1, ADDR(\"/rtas\"));\n\tif (!IHANDLE_VALID(rtas_inst)) {\n\t\tprom_printf(\"opening rtas package failed (%x)\\n\", rtas_inst);\n\t\treturn;\n\t}\n\n\tprom_printf(\"instantiating rtas at 0x%x...\", base);\n\n\tif (call_prom_ret(\"call-method\", 3, 2, &entry,\n\t\t\t  ADDR(\"instantiate-rtas\"),\n\t\t\t  rtas_inst, base) != 0\n\t    || entry == 0) {\n\t\tprom_printf(\" failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tval = cpu_to_be32(base);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-base\",\n\t\t     &val, sizeof(val));\n\tval = cpu_to_be32(entry);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-entry\",\n\t\t     &val, sizeof(val));\n\n\t/* Check if it supports \"query-cpu-stopped-state\" */\n\tif (prom_getprop(rtas_node, \"query-cpu-stopped-state\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR)\n\t\trtas_has_query_cpu_stopped = true;\n\n\tprom_debug(\"rtas base     = 0x%x\\n\", base);\n\tprom_debug(\"rtas entry    = 0x%x\\n\", entry);\n\tprom_debug(\"rtas size     = 0x%x\\n\", (long)size);\n\n\tprom_debug(\"prom_instantiate_rtas: end...\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_initialize_tce_table",
          "args": [],
          "line": 2845
        },
        "resolved": true,
        "details": {
          "function_name": "prom_initialize_tce_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1502-1629",
          "snippet": "static void __init prom_initialize_tce_table(void)\n{\n\tphandle node;\n\tihandle phb_node;\n\tchar compatible[64], type[64], model[64];\n\tchar *path = prom_scratch;\n\tu64 base, align;\n\tu32 minalign, minsize;\n\tu64 tce_entry, *tce_entryp;\n\tu64 local_alloc_top, local_alloc_bottom;\n\tu64 i;\n\n\tif (prom_iommu_off)\n\t\treturn;\n\n\tprom_debug(\"starting prom_initialize_tce_table\\n\");\n\n\t/* Cache current top of allocs so we reserve a single block */\n\tlocal_alloc_top = alloc_top_high;\n\tlocal_alloc_bottom = local_alloc_top;\n\n\t/* Search all nodes looking for PHBs. */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tcompatible[0] = 0;\n\t\ttype[0] = 0;\n\t\tmodel[0] = 0;\n\t\tprom_getprop(node, \"compatible\",\n\t\t\t     compatible, sizeof(compatible));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tprom_getprop(node, \"model\", model, sizeof(model));\n\n\t\tif ((type[0] == 0) || (strstr(type, \"pci\") == NULL))\n\t\t\tcontinue;\n\n\t\t/* Keep the old logic intact to avoid regression. */\n\t\tif (compatible[0] != 0) {\n\t\t\tif ((strstr(compatible, \"python\") == NULL) &&\n\t\t\t    (strstr(compatible, \"Speedwagon\") == NULL) &&\n\t\t\t    (strstr(compatible, \"Winnipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t} else if (model[0] != 0) {\n\t\t\tif ((strstr(model, \"ython\") == NULL) &&\n\t\t\t    (strstr(model, \"peedwagon\") == NULL) &&\n\t\t\t    (strstr(model, \"innipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tif (prom_getprop(node, \"tce-table-minalign\", &minalign,\n\t\t\t\t sizeof(minalign)) == PROM_ERROR)\n\t\t\tminalign = 0;\n\t\tif (prom_getprop(node, \"tce-table-minsize\", &minsize,\n\t\t\t\t sizeof(minsize)) == PROM_ERROR)\n\t\t\tminsize = 4UL << 20;\n\n\t\t/*\n\t\t * Even though we read what OF wants, we just set the table\n\t\t * size to 4 MB.  This is enough to map 2GB of PCI DMA space.\n\t\t * By doing this, we avoid the pitfalls of trying to DMA to\n\t\t * MMIO space and the DMA alias hole.\n\t\t *\n\t\t * On POWER4, firmware sets the TCE region by assuming\n\t\t * each TCE table is 8MB. Using this memory for anything\n\t\t * else will impact performance, so we always allocate 8MB.\n\t\t * Anton\n\t\t */\n\t\tif (pvr_version_is(PVR_POWER4) || pvr_version_is(PVR_POWER4p))\n\t\t\tminsize = 8UL << 20;\n\t\telse\n\t\t\tminsize = 4UL << 20;\n\n\t\t/* Align to the greater of the align or size */\n\t\talign = max(minalign, minsize);\n\t\tbase = alloc_down(minsize, align, 1);\n\t\tif (base == 0)\n\t\t\tprom_panic(\"ERROR, cannot find space for TCE table.\\n\");\n\t\tif (base < local_alloc_bottom)\n\t\t\tlocal_alloc_bottom = base;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\t\t/* Call OF to setup the TCE hardware */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node,\n\t\t\t      path, PROM_SCRATCH_SIZE-1) == PROM_ERROR) {\n\t\t\tprom_printf(\"package-to-path failed\\n\");\n\t\t}\n\n\t\t/* Save away the TCE table attributes for later use. */\n\t\tprom_setprop(node, path, \"linux,tce-base\", &base, sizeof(base));\n\t\tprom_setprop(node, path, \"linux,tce-size\", &minsize, sizeof(minsize));\n\n\t\tprom_debug(\"TCE table: %s\\n\", path);\n\t\tprom_debug(\"\\tnode = 0x%x\\n\", node);\n\t\tprom_debug(\"\\tbase = 0x%x\\n\", base);\n\t\tprom_debug(\"\\tsize = 0x%x\\n\", minsize);\n\n\t\t/* Initialize the table to have a one-to-one mapping\n\t\t * over the allocated size.\n\t\t */\n\t\ttce_entryp = (u64 *)base;\n\t\tfor (i = 0; i < (minsize >> 3) ;tce_entryp++, i++) {\n\t\t\ttce_entry = (i << PAGE_SHIFT);\n\t\t\ttce_entry |= 0x3;\n\t\t\t*tce_entryp = tce_entry;\n\t\t}\n\n\t\tprom_printf(\"opening PHB %s\", path);\n\t\tphb_node = call_prom(\"open\", 1, 1, path);\n\t\tif (phb_node == 0)\n\t\t\tprom_printf(\"... failed\\n\");\n\t\telse\n\t\t\tprom_printf(\"... done\\n\");\n\n\t\tcall_prom(\"call-method\", 6, 0, ADDR(\"set-64-bit-addressing\"),\n\t\t\t  phb_node, -1, minsize,\n\t\t\t  (u32) base, (u32) (base >> 32));\n\t\tcall_prom(\"close\", 1, 0, phb_node);\n\t}\n\n\treserve_mem(local_alloc_bottom, local_alloc_top - local_alloc_bottom);\n\n\t/* These are only really needed if there is a memory limit in\n\t * effect, but we don't know so export them always. */\n\tprom_tce_alloc_start = local_alloc_bottom;\n\tprom_tce_alloc_end = local_alloc_top;\n\n\t/* Flag the first invalid entry */\n\tprom_debug(\"ending prom_initialize_tce_table\\n\");\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)",
            "#define PROM_SCRATCH_SIZE 256"
          ],
          "globals_used": [
            "static unsigned long __initdata alloc_top_high;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n#define PROM_SCRATCH_SIZE 256\n\nstatic unsigned long __initdata alloc_top_high;\nstatic void __init;\n\nstatic void __init prom_initialize_tce_table(void)\n{\n\tphandle node;\n\tihandle phb_node;\n\tchar compatible[64], type[64], model[64];\n\tchar *path = prom_scratch;\n\tu64 base, align;\n\tu32 minalign, minsize;\n\tu64 tce_entry, *tce_entryp;\n\tu64 local_alloc_top, local_alloc_bottom;\n\tu64 i;\n\n\tif (prom_iommu_off)\n\t\treturn;\n\n\tprom_debug(\"starting prom_initialize_tce_table\\n\");\n\n\t/* Cache current top of allocs so we reserve a single block */\n\tlocal_alloc_top = alloc_top_high;\n\tlocal_alloc_bottom = local_alloc_top;\n\n\t/* Search all nodes looking for PHBs. */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tcompatible[0] = 0;\n\t\ttype[0] = 0;\n\t\tmodel[0] = 0;\n\t\tprom_getprop(node, \"compatible\",\n\t\t\t     compatible, sizeof(compatible));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tprom_getprop(node, \"model\", model, sizeof(model));\n\n\t\tif ((type[0] == 0) || (strstr(type, \"pci\") == NULL))\n\t\t\tcontinue;\n\n\t\t/* Keep the old logic intact to avoid regression. */\n\t\tif (compatible[0] != 0) {\n\t\t\tif ((strstr(compatible, \"python\") == NULL) &&\n\t\t\t    (strstr(compatible, \"Speedwagon\") == NULL) &&\n\t\t\t    (strstr(compatible, \"Winnipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t} else if (model[0] != 0) {\n\t\t\tif ((strstr(model, \"ython\") == NULL) &&\n\t\t\t    (strstr(model, \"peedwagon\") == NULL) &&\n\t\t\t    (strstr(model, \"innipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tif (prom_getprop(node, \"tce-table-minalign\", &minalign,\n\t\t\t\t sizeof(minalign)) == PROM_ERROR)\n\t\t\tminalign = 0;\n\t\tif (prom_getprop(node, \"tce-table-minsize\", &minsize,\n\t\t\t\t sizeof(minsize)) == PROM_ERROR)\n\t\t\tminsize = 4UL << 20;\n\n\t\t/*\n\t\t * Even though we read what OF wants, we just set the table\n\t\t * size to 4 MB.  This is enough to map 2GB of PCI DMA space.\n\t\t * By doing this, we avoid the pitfalls of trying to DMA to\n\t\t * MMIO space and the DMA alias hole.\n\t\t *\n\t\t * On POWER4, firmware sets the TCE region by assuming\n\t\t * each TCE table is 8MB. Using this memory for anything\n\t\t * else will impact performance, so we always allocate 8MB.\n\t\t * Anton\n\t\t */\n\t\tif (pvr_version_is(PVR_POWER4) || pvr_version_is(PVR_POWER4p))\n\t\t\tminsize = 8UL << 20;\n\t\telse\n\t\t\tminsize = 4UL << 20;\n\n\t\t/* Align to the greater of the align or size */\n\t\talign = max(minalign, minsize);\n\t\tbase = alloc_down(minsize, align, 1);\n\t\tif (base == 0)\n\t\t\tprom_panic(\"ERROR, cannot find space for TCE table.\\n\");\n\t\tif (base < local_alloc_bottom)\n\t\t\tlocal_alloc_bottom = base;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\t\t/* Call OF to setup the TCE hardware */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node,\n\t\t\t      path, PROM_SCRATCH_SIZE-1) == PROM_ERROR) {\n\t\t\tprom_printf(\"package-to-path failed\\n\");\n\t\t}\n\n\t\t/* Save away the TCE table attributes for later use. */\n\t\tprom_setprop(node, path, \"linux,tce-base\", &base, sizeof(base));\n\t\tprom_setprop(node, path, \"linux,tce-size\", &minsize, sizeof(minsize));\n\n\t\tprom_debug(\"TCE table: %s\\n\", path);\n\t\tprom_debug(\"\\tnode = 0x%x\\n\", node);\n\t\tprom_debug(\"\\tbase = 0x%x\\n\", base);\n\t\tprom_debug(\"\\tsize = 0x%x\\n\", minsize);\n\n\t\t/* Initialize the table to have a one-to-one mapping\n\t\t * over the allocated size.\n\t\t */\n\t\ttce_entryp = (u64 *)base;\n\t\tfor (i = 0; i < (minsize >> 3) ;tce_entryp++, i++) {\n\t\t\ttce_entry = (i << PAGE_SHIFT);\n\t\t\ttce_entry |= 0x3;\n\t\t\t*tce_entryp = tce_entry;\n\t\t}\n\n\t\tprom_printf(\"opening PHB %s\", path);\n\t\tphb_node = call_prom(\"open\", 1, 1, path);\n\t\tif (phb_node == 0)\n\t\t\tprom_printf(\"... failed\\n\");\n\t\telse\n\t\t\tprom_printf(\"... done\\n\");\n\n\t\tcall_prom(\"call-method\", 6, 0, ADDR(\"set-64-bit-addressing\"),\n\t\t\t  phb_node, -1, minsize,\n\t\t\t  (u32) base, (u32) (base >> 32));\n\t\tcall_prom(\"close\", 1, 0, phb_node);\n\t}\n\n\treserve_mem(local_alloc_bottom, local_alloc_top - local_alloc_bottom);\n\n\t/* These are only really needed if there is a memory limit in\n\t * effect, but we don't know so export them always. */\n\tprom_tce_alloc_start = local_alloc_bottom;\n\tprom_tce_alloc_end = local_alloc_top;\n\n\t/* Flag the first invalid entry */\n\tprom_debug(\"ending prom_initialize_tce_table\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_check_displays",
          "args": [],
          "line": 2836
        },
        "resolved": true,
        "details": {
          "function_name": "prom_check_displays",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1915-2004",
          "snippet": "static void __init prom_check_displays(void)\n{\n\tchar type[16], *path;\n\tphandle node;\n\tihandle ih;\n\tint i;\n\n\tstatic unsigned char default_colors[] = {\n\t\t0x00, 0x00, 0x00,\n\t\t0x00, 0x00, 0xaa,\n\t\t0x00, 0xaa, 0x00,\n\t\t0x00, 0xaa, 0xaa,\n\t\t0xaa, 0x00, 0x00,\n\t\t0xaa, 0x00, 0xaa,\n\t\t0xaa, 0xaa, 0x00,\n\t\t0xaa, 0xaa, 0xaa,\n\t\t0x55, 0x55, 0x55,\n\t\t0x55, 0x55, 0xff,\n\t\t0x55, 0xff, 0x55,\n\t\t0x55, 0xff, 0xff,\n\t\t0xff, 0x55, 0x55,\n\t\t0xff, 0x55, 0xff,\n\t\t0xff, 0xff, 0x55,\n\t\t0xff, 0xff, 0xff\n\t};\n\tconst unsigned char *clut;\n\n\tprom_debug(\"Looking for displays\\n\");\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (strcmp(type, \"display\") != 0)\n\t\t\tcontinue;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tpath = prom_scratch;\n\t\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\n\t\t/*\n\t\t * leave some room at the end of the path for appending extra\n\t\t * arguments\n\t\t */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node, path,\n\t\t\t      PROM_SCRATCH_SIZE-10) == PROM_ERROR)\n\t\t\tcontinue;\n\t\tprom_printf(\"found display   : %s, opening... \", path);\n\t\t\n\t\tih = call_prom(\"open\", 1, 1, path);\n\t\tif (ih == 0) {\n\t\t\tprom_printf(\"failed\\n\");\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Success */\n\t\tprom_printf(\"done\\n\");\n\t\tprom_setprop(node, path, \"linux,opened\", NULL, 0);\n\n\t\t/* Setup a usable color table when the appropriate\n\t\t * method is available. Should update this to set-colors */\n\t\tclut = default_colors;\n\t\tfor (i = 0; i < 16; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n\n#ifdef CONFIG_LOGO_LINUX_CLUT224\n\t\tclut = PTRRELOC(logo_linux_clut224.clut);\n\t\tfor (i = 0; i < logo_linux_clut224.clutsize; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i + 32, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n#endif /* CONFIG_LOGO_LINUX_CLUT224 */\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_BOOTX\n\t\tif (prom_getprop(node, \"linux,boot-display\", NULL, 0) !=\n\t\t    PROM_ERROR) {\n\t\t\tu32 width, height, pitch, addr;\n\n\t\t\tprom_printf(\"Setting btext !\\n\");\n\t\t\tprom_getprop(node, \"width\", &width, 4);\n\t\t\tprom_getprop(node, \"height\", &height, 4);\n\t\t\tprom_getprop(node, \"linebytes\", &pitch, 4);\n\t\t\tprom_getprop(node, \"address\", &addr, 4);\n\t\t\tprom_printf(\"W=%d H=%d LB=%d addr=0x%x\\n\",\n\t\t\t\t    width, height, pitch, addr);\n\t\t\tbtext_setup_display(width, height, 8, pitch, addr);\n\t\t}\n#endif /* CONFIG_PPC_EARLY_DEBUG_BOOTX */\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)",
            "#define PROM_SCRATCH_SIZE 256"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n#define PROM_SCRATCH_SIZE 256\n\nstatic void __init;\n\nstatic void __init prom_check_displays(void)\n{\n\tchar type[16], *path;\n\tphandle node;\n\tihandle ih;\n\tint i;\n\n\tstatic unsigned char default_colors[] = {\n\t\t0x00, 0x00, 0x00,\n\t\t0x00, 0x00, 0xaa,\n\t\t0x00, 0xaa, 0x00,\n\t\t0x00, 0xaa, 0xaa,\n\t\t0xaa, 0x00, 0x00,\n\t\t0xaa, 0x00, 0xaa,\n\t\t0xaa, 0xaa, 0x00,\n\t\t0xaa, 0xaa, 0xaa,\n\t\t0x55, 0x55, 0x55,\n\t\t0x55, 0x55, 0xff,\n\t\t0x55, 0xff, 0x55,\n\t\t0x55, 0xff, 0xff,\n\t\t0xff, 0x55, 0x55,\n\t\t0xff, 0x55, 0xff,\n\t\t0xff, 0xff, 0x55,\n\t\t0xff, 0xff, 0xff\n\t};\n\tconst unsigned char *clut;\n\n\tprom_debug(\"Looking for displays\\n\");\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (strcmp(type, \"display\") != 0)\n\t\t\tcontinue;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tpath = prom_scratch;\n\t\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\n\t\t/*\n\t\t * leave some room at the end of the path for appending extra\n\t\t * arguments\n\t\t */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node, path,\n\t\t\t      PROM_SCRATCH_SIZE-10) == PROM_ERROR)\n\t\t\tcontinue;\n\t\tprom_printf(\"found display   : %s, opening... \", path);\n\t\t\n\t\tih = call_prom(\"open\", 1, 1, path);\n\t\tif (ih == 0) {\n\t\t\tprom_printf(\"failed\\n\");\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Success */\n\t\tprom_printf(\"done\\n\");\n\t\tprom_setprop(node, path, \"linux,opened\", NULL, 0);\n\n\t\t/* Setup a usable color table when the appropriate\n\t\t * method is available. Should update this to set-colors */\n\t\tclut = default_colors;\n\t\tfor (i = 0; i < 16; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n\n#ifdef CONFIG_LOGO_LINUX_CLUT224\n\t\tclut = PTRRELOC(logo_linux_clut224.clut);\n\t\tfor (i = 0; i < logo_linux_clut224.clutsize; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i + 32, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n#endif /* CONFIG_LOGO_LINUX_CLUT224 */\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_BOOTX\n\t\tif (prom_getprop(node, \"linux,boot-display\", NULL, 0) !=\n\t\t    PROM_ERROR) {\n\t\t\tu32 width, height, pitch, addr;\n\n\t\t\tprom_printf(\"Setting btext !\\n\");\n\t\t\tprom_getprop(node, \"width\", &width, 4);\n\t\t\tprom_getprop(node, \"height\", &height, 4);\n\t\t\tprom_getprop(node, \"linebytes\", &pitch, 4);\n\t\t\tprom_getprop(node, \"address\", &addr, 4);\n\t\t\tprom_printf(\"W=%d H=%d LB=%d addr=0x%x\\n\",\n\t\t\t\t    width, height, pitch, addr);\n\t\t\tbtext_setup_display(width, height, 8, pitch, addr);\n\t\t}\n#endif /* CONFIG_PPC_EARLY_DEBUG_BOOTX */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_find_boot_cpu",
          "args": [],
          "line": 2831
        },
        "resolved": true,
        "details": {
          "function_name": "prom_find_boot_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2650-2667",
          "snippet": "static void __init prom_find_boot_cpu(void)\n{\n\t__be32 rval;\n\tihandle prom_cpu;\n\tphandle cpu_pkg;\n\n\trval = 0;\n\tif (prom_getprop(prom.chosen, \"cpu\", &rval, sizeof(rval)) <= 0)\n\t\treturn;\n\tprom_cpu = be32_to_cpu(rval);\n\n\tcpu_pkg = call_prom(\"instance-to-package\", 1, 1, prom_cpu);\n\n\tprom_getprop(cpu_pkg, \"reg\", &rval, sizeof(rval));\n\tprom.cpu = be32_to_cpu(rval);\n\n\tprom_debug(\"Booting CPU hw index = %lu\\n\", prom.cpu);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_find_boot_cpu(void)\n{\n\t__be32 rval;\n\tihandle prom_cpu;\n\tphandle cpu_pkg;\n\n\trval = 0;\n\tif (prom_getprop(prom.chosen, \"cpu\", &rval, sizeof(rval)) <= 0)\n\t\treturn;\n\tprom_cpu = be32_to_cpu(rval);\n\n\tcpu_pkg = call_prom(\"instance-to-package\", 1, 1, prom_cpu);\n\n\tprom_getprop(cpu_pkg, \"reg\", &rval, sizeof(rval));\n\tprom.cpu = be32_to_cpu(rval);\n\n\tprom_debug(\"Booting CPU hw index = %lu\\n\", prom.cpu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_init_mem",
          "args": [],
          "line": 2826
        },
        "resolved": true,
        "details": {
          "function_name": "prom_init_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1134-1259",
          "snippet": "static void __init prom_init_mem(void)\n{\n\tphandle node;\n\tchar *path, type[64];\n\tunsigned int plen;\n\tcell_t *p, *endp;\n\t__be32 val;\n\tu32 rac, rsc;\n\n\t/*\n\t * We iterate the memory nodes to find\n\t * 1) top of RMO (first node)\n\t * 2) top of memory\n\t */\n\tval = cpu_to_be32(2);\n\tprom_getprop(prom.root, \"#address-cells\", &val, sizeof(val));\n\trac = be32_to_cpu(val);\n\tval = cpu_to_be32(1);\n\tprom_getprop(prom.root, \"#size-cells\", &val, sizeof(rsc));\n\trsc = be32_to_cpu(val);\n\tprom_debug(\"root_addr_cells: %x\\n\", rac);\n\tprom_debug(\"root_size_cells: %x\\n\", rsc);\n\n\tprom_debug(\"scanning memory:\\n\");\n\tpath = prom_scratch;\n\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (type[0] == 0) {\n\t\t\t/*\n\t\t\t * CHRP Longtrail machines have no device_type\n\t\t\t * on the memory node, so check the name instead...\n\t\t\t */\n\t\t\tprom_getprop(node, \"name\", type, sizeof(type));\n\t\t}\n\t\tif (strcmp(type, \"memory\"))\n\t\t\tcontinue;\n\n\t\tplen = prom_getprop(node, \"reg\", regbuf, sizeof(regbuf));\n\t\tif (plen > sizeof(regbuf)) {\n\t\t\tprom_printf(\"memory node too large for buffer !\\n\");\n\t\t\tplen = sizeof(regbuf);\n\t\t}\n\t\tp = regbuf;\n\t\tendp = p + (plen / sizeof(cell_t));\n\n#ifdef DEBUG_PROM\n\t\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\t\tcall_prom(\"package-to-path\", 3, 1, node, path, PROM_SCRATCH_SIZE-1);\n\t\tprom_debug(\"  node %s :\\n\", path);\n#endif /* DEBUG_PROM */\n\n\t\twhile ((endp - p) >= (rac + rsc)) {\n\t\t\tunsigned long base, size;\n\n\t\t\tbase = prom_next_cell(rac, &p);\n\t\t\tsize = prom_next_cell(rsc, &p);\n\n\t\t\tif (size == 0)\n\t\t\t\tcontinue;\n\t\t\tprom_debug(\"    %x %x\\n\", base, size);\n\t\t\tif (base == 0 && (of_platform & PLATFORM_LPAR))\n\t\t\t\trmo_top = size;\n\t\t\tif ((base + size) > ram_top)\n\t\t\t\tram_top = base + size;\n\t\t}\n\t}\n\n\talloc_bottom = PAGE_ALIGN((unsigned long)&_end + 0x4000);\n\n\t/*\n\t * If prom_memory_limit is set we reduce the upper limits *except* for\n\t * alloc_top_high. This must be the real top of RAM so we can put\n\t * TCE's up there.\n\t */\n\n\talloc_top_high = ram_top;\n\n\tif (prom_memory_limit) {\n\t\tif (prom_memory_limit <= alloc_bottom) {\n\t\t\tprom_printf(\"Ignoring mem=%x <= alloc_bottom.\\n\",\n\t\t\t\tprom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else if (prom_memory_limit >= ram_top) {\n\t\t\tprom_printf(\"Ignoring mem=%x >= ram_top.\\n\",\n\t\t\t\tprom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else {\n\t\t\tram_top = prom_memory_limit;\n\t\t\trmo_top = min(rmo_top, prom_memory_limit);\n\t\t}\n\t}\n\n\t/*\n\t * Setup our top alloc point, that is top of RMO or top of\n\t * segment 0 when running non-LPAR.\n\t * Some RS64 machines have buggy firmware where claims up at\n\t * 1GB fail.  Cap at 768MB as a workaround.\n\t * Since 768MB is plenty of room, and we need to cap to something\n\t * reasonable on 32-bit, cap at 768MB on all machines.\n\t */\n\tif (!rmo_top)\n\t\trmo_top = ram_top;\n\trmo_top = min(0x30000000ul, rmo_top);\n\talloc_top = rmo_top;\n\talloc_top_high = ram_top;\n\n\t/*\n\t * Check if we have an initrd after the kernel but still inside\n\t * the RMO.  If we do move our bottom point to after it.\n\t */\n\tif (prom_initrd_start &&\n\t    prom_initrd_start < rmo_top &&\n\t    prom_initrd_end > alloc_bottom)\n\t\talloc_bottom = PAGE_ALIGN(prom_initrd_end);\n\n\tprom_printf(\"memory layout at init:\\n\");\n\tprom_printf(\"  memory_limit : %x (16 MB aligned)\\n\", prom_memory_limit);\n\tprom_printf(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_printf(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_printf(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_printf(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_printf(\"  ram_top      : %x\\n\", ram_top);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PLATFORM_LPAR\t\t0x0001",
            "#define PROM_SCRATCH_SIZE 256"
          ],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static unsigned long __initdata prom_initrd_start, prom_initrd_end;",
            "static unsigned long __initdata prom_memory_limit;",
            "static unsigned long __initdata alloc_top;",
            "static unsigned long __initdata alloc_top_high;",
            "static unsigned long __initdata alloc_bottom;",
            "static unsigned long __initdata rmo_top;",
            "static unsigned long __initdata ram_top;",
            "static cell_t __initdata regbuf[1024];",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PLATFORM_LPAR\t\t0x0001\n#define PROM_SCRATCH_SIZE 256\n\nstatic struct prom_t __initdata prom;\nstatic unsigned long __initdata prom_initrd_start, prom_initrd_end;\nstatic unsigned long __initdata prom_memory_limit;\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_top_high;\nstatic unsigned long __initdata alloc_bottom;\nstatic unsigned long __initdata rmo_top;\nstatic unsigned long __initdata ram_top;\nstatic cell_t __initdata regbuf[1024];\nstatic void __init;\n\nstatic void __init prom_init_mem(void)\n{\n\tphandle node;\n\tchar *path, type[64];\n\tunsigned int plen;\n\tcell_t *p, *endp;\n\t__be32 val;\n\tu32 rac, rsc;\n\n\t/*\n\t * We iterate the memory nodes to find\n\t * 1) top of RMO (first node)\n\t * 2) top of memory\n\t */\n\tval = cpu_to_be32(2);\n\tprom_getprop(prom.root, \"#address-cells\", &val, sizeof(val));\n\trac = be32_to_cpu(val);\n\tval = cpu_to_be32(1);\n\tprom_getprop(prom.root, \"#size-cells\", &val, sizeof(rsc));\n\trsc = be32_to_cpu(val);\n\tprom_debug(\"root_addr_cells: %x\\n\", rac);\n\tprom_debug(\"root_size_cells: %x\\n\", rsc);\n\n\tprom_debug(\"scanning memory:\\n\");\n\tpath = prom_scratch;\n\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (type[0] == 0) {\n\t\t\t/*\n\t\t\t * CHRP Longtrail machines have no device_type\n\t\t\t * on the memory node, so check the name instead...\n\t\t\t */\n\t\t\tprom_getprop(node, \"name\", type, sizeof(type));\n\t\t}\n\t\tif (strcmp(type, \"memory\"))\n\t\t\tcontinue;\n\n\t\tplen = prom_getprop(node, \"reg\", regbuf, sizeof(regbuf));\n\t\tif (plen > sizeof(regbuf)) {\n\t\t\tprom_printf(\"memory node too large for buffer !\\n\");\n\t\t\tplen = sizeof(regbuf);\n\t\t}\n\t\tp = regbuf;\n\t\tendp = p + (plen / sizeof(cell_t));\n\n#ifdef DEBUG_PROM\n\t\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\t\tcall_prom(\"package-to-path\", 3, 1, node, path, PROM_SCRATCH_SIZE-1);\n\t\tprom_debug(\"  node %s :\\n\", path);\n#endif /* DEBUG_PROM */\n\n\t\twhile ((endp - p) >= (rac + rsc)) {\n\t\t\tunsigned long base, size;\n\n\t\t\tbase = prom_next_cell(rac, &p);\n\t\t\tsize = prom_next_cell(rsc, &p);\n\n\t\t\tif (size == 0)\n\t\t\t\tcontinue;\n\t\t\tprom_debug(\"    %x %x\\n\", base, size);\n\t\t\tif (base == 0 && (of_platform & PLATFORM_LPAR))\n\t\t\t\trmo_top = size;\n\t\t\tif ((base + size) > ram_top)\n\t\t\t\tram_top = base + size;\n\t\t}\n\t}\n\n\talloc_bottom = PAGE_ALIGN((unsigned long)&_end + 0x4000);\n\n\t/*\n\t * If prom_memory_limit is set we reduce the upper limits *except* for\n\t * alloc_top_high. This must be the real top of RAM so we can put\n\t * TCE's up there.\n\t */\n\n\talloc_top_high = ram_top;\n\n\tif (prom_memory_limit) {\n\t\tif (prom_memory_limit <= alloc_bottom) {\n\t\t\tprom_printf(\"Ignoring mem=%x <= alloc_bottom.\\n\",\n\t\t\t\tprom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else if (prom_memory_limit >= ram_top) {\n\t\t\tprom_printf(\"Ignoring mem=%x >= ram_top.\\n\",\n\t\t\t\tprom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else {\n\t\t\tram_top = prom_memory_limit;\n\t\t\trmo_top = min(rmo_top, prom_memory_limit);\n\t\t}\n\t}\n\n\t/*\n\t * Setup our top alloc point, that is top of RMO or top of\n\t * segment 0 when running non-LPAR.\n\t * Some RS64 machines have buggy firmware where claims up at\n\t * 1GB fail.  Cap at 768MB as a workaround.\n\t * Since 768MB is plenty of room, and we need to cap to something\n\t * reasonable on 32-bit, cap at 768MB on all machines.\n\t */\n\tif (!rmo_top)\n\t\trmo_top = ram_top;\n\trmo_top = min(0x30000000ul, rmo_top);\n\talloc_top = rmo_top;\n\talloc_top_high = ram_top;\n\n\t/*\n\t * Check if we have an initrd after the kernel but still inside\n\t * the RMO.  If we do move our bottom point to after it.\n\t */\n\tif (prom_initrd_start &&\n\t    prom_initrd_start < rmo_top &&\n\t    prom_initrd_end > alloc_bottom)\n\t\talloc_bottom = PAGE_ALIGN(prom_initrd_end);\n\n\tprom_printf(\"memory layout at init:\\n\");\n\tprom_printf(\"  memory_limit : %x (16 MB aligned)\\n\", prom_memory_limit);\n\tprom_printf(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_printf(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_printf(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_printf(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_printf(\"  ram_top      : %x\\n\", ram_top);\n}"
        }
      },
      {
        "call_info": {
          "callee": "early_cmdline_parse",
          "args": [],
          "line": 2821
        },
        "resolved": true,
        "details": {
          "function_name": "early_cmdline_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "587-627",
          "snippet": "static void __init early_cmdline_parse(void)\n{\n\tconst char *opt;\n\n\tchar *p;\n\tint l = 0;\n\n\tprom_cmd_line[0] = 0;\n\tp = prom_cmd_line;\n\tif ((long)prom.chosen > 0)\n\t\tl = prom_getprop(prom.chosen, \"bootargs\", p, COMMAND_LINE_SIZE-1);\n#ifdef CONFIG_CMDLINE\n\tif (l <= 0 || p[0] == '\\0') /* dbl check */\n\t\tstrlcpy(prom_cmd_line,\n\t\t\tCONFIG_CMDLINE, sizeof(prom_cmd_line));\n#endif /* CONFIG_CMDLINE */\n\tprom_printf(\"command line: %s\\n\", prom_cmd_line);\n\n#ifdef CONFIG_PPC64\n\topt = strstr(prom_cmd_line, \"iommu=\");\n\tif (opt) {\n\t\tprom_printf(\"iommu opt is: %s\\n\", opt);\n\t\topt += 6;\n\t\twhile (*opt && *opt == ' ')\n\t\t\topt++;\n\t\tif (!strncmp(opt, \"off\", 3))\n\t\t\tprom_iommu_off = 1;\n\t\telse if (!strncmp(opt, \"force\", 5))\n\t\t\tprom_iommu_force_on = 1;\n\t}\n#endif\n\topt = strstr(prom_cmd_line, \"mem=\");\n\tif (opt) {\n\t\topt += 4;\n\t\tprom_memory_limit = prom_memparse(opt, (const char **)&opt);\n#ifdef CONFIG_PPC64\n\t\t/* Align to 16 MB == size of ppc64 large page */\n\t\tprom_memory_limit = ALIGN(prom_memory_limit, 0x1000000);\n#endif\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static unsigned long __initdata prom_memory_limit;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic unsigned long __initdata prom_memory_limit;\nstatic void __init;\n\nstatic void __init early_cmdline_parse(void)\n{\n\tconst char *opt;\n\n\tchar *p;\n\tint l = 0;\n\n\tprom_cmd_line[0] = 0;\n\tp = prom_cmd_line;\n\tif ((long)prom.chosen > 0)\n\t\tl = prom_getprop(prom.chosen, \"bootargs\", p, COMMAND_LINE_SIZE-1);\n#ifdef CONFIG_CMDLINE\n\tif (l <= 0 || p[0] == '\\0') /* dbl check */\n\t\tstrlcpy(prom_cmd_line,\n\t\t\tCONFIG_CMDLINE, sizeof(prom_cmd_line));\n#endif /* CONFIG_CMDLINE */\n\tprom_printf(\"command line: %s\\n\", prom_cmd_line);\n\n#ifdef CONFIG_PPC64\n\topt = strstr(prom_cmd_line, \"iommu=\");\n\tif (opt) {\n\t\tprom_printf(\"iommu opt is: %s\\n\", opt);\n\t\topt += 6;\n\t\twhile (*opt && *opt == ' ')\n\t\t\topt++;\n\t\tif (!strncmp(opt, \"off\", 3))\n\t\t\tprom_iommu_off = 1;\n\t\telse if (!strncmp(opt, \"force\", 5))\n\t\t\tprom_iommu_force_on = 1;\n\t}\n#endif\n\topt = strstr(prom_cmd_line, \"mem=\");\n\tif (opt) {\n\t\topt += 4;\n\t\tprom_memory_limit = prom_memparse(opt, (const char **)&opt);\n#ifdef CONFIG_PPC64\n\t\t/* Align to 16 MB == size of ppc64 large page */\n\t\tprom_memory_limit = ALIGN(prom_memory_limit, 0x1000000);\n#endif\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_and_flush",
          "args": [
            "0",
            "kbase",
            "0x100",
            "0"
          ],
          "line": 2816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_send_capabilities",
          "args": [],
          "line": 2809
        },
        "resolved": true,
        "details": {
          "function_name": "prom_send_capabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "865-940",
          "snippet": "static void __init prom_send_capabilities(void)\n{\n\tihandle root;\n\tprom_arg_t ret;\n\tu32 cores;\n\tunsigned char *ptcores;\n\n\troot = call_prom(\"open\", 1, 1, ADDR(\"/\"));\n\tif (root != 0) {\n\t\t/* We need to tell the FW about the number of cores we support.\n\t\t *\n\t\t * To do that, we count the number of threads on the first core\n\t\t * (we assume this is the same for all cores) and use it to\n\t\t * divide NR_CPUS.\n\t\t */\n\n\t\t/* The core value may start at an odd address. If such a word\n\t\t * access is made at a cache line boundary, this leads to an\n\t\t * exception which may not be handled at this time.\n\t\t * Forcing a per byte access to avoid exception.\n\t\t */\n\t\tptcores = &ibm_architecture_vec[IBM_ARCH_VEC_NRCORES_OFFSET];\n\t\tcores = 0;\n\t\tcores |= ptcores[0] << 24;\n\t\tcores |= ptcores[1] << 16;\n\t\tcores |= ptcores[2] << 8;\n\t\tcores |= ptcores[3];\n\t\tif (cores != NR_CPUS) {\n\t\t\tprom_printf(\"WARNING ! \"\n\t\t\t\t    \"ibm_architecture_vec structure inconsistent: %lu!\\n\",\n\t\t\t\t    cores);\n\t\t} else {\n\t\t\tcores = DIV_ROUND_UP(NR_CPUS, prom_count_smt_threads());\n\t\t\tprom_printf(\"Max number of cores passed to firmware: %lu (NR_CPUS = %lu)\\n\",\n\t\t\t\t    cores, NR_CPUS);\n\t\t\tptcores[0] = (cores >> 24) & 0xff;\n\t\t\tptcores[1] = (cores >> 16) & 0xff;\n\t\t\tptcores[2] = (cores >> 8) & 0xff;\n\t\t\tptcores[3] = cores & 0xff;\n\t\t}\n\n\t\t/* try calling the ibm,client-architecture-support method */\n\t\tprom_printf(\"Calling ibm,client-architecture-support...\");\n\t\tif (call_prom_ret(\"call-method\", 3, 2, &ret,\n\t\t\t\t  ADDR(\"ibm,client-architecture-support\"),\n\t\t\t\t  root,\n\t\t\t\t  ADDR(ibm_architecture_vec)) == 0) {\n\t\t\t/* the call exists... */\n\t\t\tif (ret)\n\t\t\t\tprom_printf(\"\\nWARNING: ibm,client-architecture\"\n\t\t\t\t\t    \"-support call FAILED!\\n\");\n\t\t\tcall_prom(\"close\", 1, 0, root);\n\t\t\tprom_printf(\" done\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"close\", 1, 0, root);\n\t\tprom_printf(\" not implemented\\n\");\n\t}\n\n#ifdef __BIG_ENDIAN__\n\t{\n\t\tihandle elfloader;\n\n\t\t/* no ibm,client-architecture-support call, try the old way */\n\t\telfloader = call_prom(\"open\", 1, 1,\n\t\t\t\t      ADDR(\"/packages/elf-loader\"));\n\t\tif (elfloader == 0) {\n\t\t\tprom_printf(\"couldn't open /packages/elf-loader\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"call-method\", 3, 1, ADDR(\"process-elf-header\"),\n\t\t\t  elfloader, ADDR(&fake_elf));\n\t\tcall_prom(\"close\", 1, 0, elfloader);\n\t}\n#endif /* __BIG_ENDIAN__ */\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_send_capabilities(void)\n{\n\tihandle root;\n\tprom_arg_t ret;\n\tu32 cores;\n\tunsigned char *ptcores;\n\n\troot = call_prom(\"open\", 1, 1, ADDR(\"/\"));\n\tif (root != 0) {\n\t\t/* We need to tell the FW about the number of cores we support.\n\t\t *\n\t\t * To do that, we count the number of threads on the first core\n\t\t * (we assume this is the same for all cores) and use it to\n\t\t * divide NR_CPUS.\n\t\t */\n\n\t\t/* The core value may start at an odd address. If such a word\n\t\t * access is made at a cache line boundary, this leads to an\n\t\t * exception which may not be handled at this time.\n\t\t * Forcing a per byte access to avoid exception.\n\t\t */\n\t\tptcores = &ibm_architecture_vec[IBM_ARCH_VEC_NRCORES_OFFSET];\n\t\tcores = 0;\n\t\tcores |= ptcores[0] << 24;\n\t\tcores |= ptcores[1] << 16;\n\t\tcores |= ptcores[2] << 8;\n\t\tcores |= ptcores[3];\n\t\tif (cores != NR_CPUS) {\n\t\t\tprom_printf(\"WARNING ! \"\n\t\t\t\t    \"ibm_architecture_vec structure inconsistent: %lu!\\n\",\n\t\t\t\t    cores);\n\t\t} else {\n\t\t\tcores = DIV_ROUND_UP(NR_CPUS, prom_count_smt_threads());\n\t\t\tprom_printf(\"Max number of cores passed to firmware: %lu (NR_CPUS = %lu)\\n\",\n\t\t\t\t    cores, NR_CPUS);\n\t\t\tptcores[0] = (cores >> 24) & 0xff;\n\t\t\tptcores[1] = (cores >> 16) & 0xff;\n\t\t\tptcores[2] = (cores >> 8) & 0xff;\n\t\t\tptcores[3] = cores & 0xff;\n\t\t}\n\n\t\t/* try calling the ibm,client-architecture-support method */\n\t\tprom_printf(\"Calling ibm,client-architecture-support...\");\n\t\tif (call_prom_ret(\"call-method\", 3, 2, &ret,\n\t\t\t\t  ADDR(\"ibm,client-architecture-support\"),\n\t\t\t\t  root,\n\t\t\t\t  ADDR(ibm_architecture_vec)) == 0) {\n\t\t\t/* the call exists... */\n\t\t\tif (ret)\n\t\t\t\tprom_printf(\"\\nWARNING: ibm,client-architecture\"\n\t\t\t\t\t    \"-support call FAILED!\\n\");\n\t\t\tcall_prom(\"close\", 1, 0, root);\n\t\t\tprom_printf(\" done\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"close\", 1, 0, root);\n\t\tprom_printf(\" not implemented\\n\");\n\t}\n\n#ifdef __BIG_ENDIAN__\n\t{\n\t\tihandle elfloader;\n\n\t\t/* no ibm,client-architecture-support call, try the old way */\n\t\telfloader = call_prom(\"open\", 1, 1,\n\t\t\t\t      ADDR(\"/packages/elf-loader\"));\n\t\tif (elfloader == 0) {\n\t\t\tprom_printf(\"couldn't open /packages/elf-loader\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"call-method\", 3, 1, ADDR(\"process-elf-header\"),\n\t\t\t  elfloader, ADDR(&fake_elf));\n\t\tcall_prom(\"close\", 1, 0, elfloader);\n\t}\n#endif /* __BIG_ENDIAN__ */\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_check_initrd",
          "args": [
            "r3",
            "r4"
          ],
          "line": 2801
        },
        "resolved": true,
        "details": {
          "function_name": "prom_check_initrd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2669-2692",
          "snippet": "static void __init prom_check_initrd(unsigned long r3, unsigned long r4)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tif (r3 && r4 && r4 != 0xdeadbeef) {\n\t\t__be64 val;\n\n\t\tprom_initrd_start = is_kernel_addr(r3) ? __pa(r3) : r3;\n\t\tprom_initrd_end = prom_initrd_start + r4;\n\n\t\tval = cpu_to_be64(prom_initrd_start);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-start\",\n\t\t\t     &val, sizeof(val));\n\t\tval = cpu_to_be64(prom_initrd_end);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-end\",\n\t\t\t     &val, sizeof(val));\n\n\t\treserve_mem(prom_initrd_start,\n\t\t\t    prom_initrd_end - prom_initrd_start);\n\n\t\tprom_debug(\"initrd_start=0x%x\\n\", prom_initrd_start);\n\t\tprom_debug(\"initrd_end=0x%x\\n\", prom_initrd_end);\n\t}\n#endif /* CONFIG_BLK_DEV_INITRD */\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static unsigned long __initdata prom_initrd_start, prom_initrd_end;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic unsigned long __initdata prom_initrd_start, prom_initrd_end;\nstatic void __init;\n\nstatic void __init prom_check_initrd(unsigned long r3, unsigned long r4)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tif (r3 && r4 && r4 != 0xdeadbeef) {\n\t\t__be64 val;\n\n\t\tprom_initrd_start = is_kernel_addr(r3) ? __pa(r3) : r3;\n\t\tprom_initrd_end = prom_initrd_start + r4;\n\n\t\tval = cpu_to_be64(prom_initrd_start);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-start\",\n\t\t\t     &val, sizeof(val));\n\t\tval = cpu_to_be64(prom_initrd_end);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-end\",\n\t\t\t     &val, sizeof(val));\n\n\t\treserve_mem(prom_initrd_start,\n\t\t\t    prom_initrd_end - prom_initrd_start);\n\n\t\tprom_debug(\"initrd_start=0x%x\\n\", prom_initrd_start);\n\t\tprom_debug(\"initrd_end=0x%x\\n\", prom_initrd_end);\n\t}\n#endif /* CONFIG_BLK_DEV_INITRD */\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"Error: You can't boot a kdump kernel from OF!\\n\""
          ],
          "line": 2795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_find_machine_type",
          "args": [],
          "line": 2789
        },
        "resolved": true,
        "details": {
          "function_name": "prom_find_machine_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1835-1900",
          "snippet": "static int __init prom_find_machine_type(void)\n{\n\tchar compat[256];\n\tint len, i = 0;\n#ifdef CONFIG_PPC64\n\tphandle rtas;\n\tint x;\n#endif\n\n\t/* Look for a PowerMac or a Cell */\n\tlen = prom_getprop(prom.root, \"compatible\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len > 0) {\n\t\tcompat[len] = 0;\n\t\twhile (i < len) {\n\t\t\tchar *p = &compat[i];\n\t\t\tint sl = strlen(p);\n\t\t\tif (sl == 0)\n\t\t\t\tbreak;\n\t\t\tif (strstr(p, \"Power Macintosh\") ||\n\t\t\t    strstr(p, \"MacRISC\"))\n\t\t\t\treturn PLATFORM_POWERMAC;\n#ifdef CONFIG_PPC64\n\t\t\t/* We must make sure we don't detect the IBM Cell\n\t\t\t * blades as pSeries due to some firmware issues,\n\t\t\t * so we do it here.\n\t\t\t */\n\t\t\tif (strstr(p, \"IBM,CBEA\") ||\n\t\t\t    strstr(p, \"IBM,CPBW-1.0\"))\n\t\t\t\treturn PLATFORM_GENERIC;\n#endif /* CONFIG_PPC64 */\n\t\t\ti += sl + 1;\n\t\t}\n\t}\n#ifdef CONFIG_PPC64\n\t/* Try to detect OPAL */\n\tif (PHANDLE_VALID(call_prom(\"finddevice\", 1, 1, ADDR(\"/ibm,opal\"))))\n\t\treturn PLATFORM_OPAL;\n\n\t/* Try to figure out if it's an IBM pSeries or any other\n\t * PAPR compliant platform. We assume it is if :\n\t *  - /device_type is \"chrp\" (please, do NOT use that for future\n\t *    non-IBM designs !\n\t *  - it has /rtas\n\t */\n\tlen = prom_getprop(prom.root, \"device_type\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len <= 0)\n\t\treturn PLATFORM_GENERIC;\n\tif (strcmp(compat, \"chrp\"))\n\t\treturn PLATFORM_GENERIC;\n\n\t/* Default to pSeries. We need to know if we are running LPAR */\n\trtas = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tif (!PHANDLE_VALID(rtas))\n\t\treturn PLATFORM_GENERIC;\n\tx = prom_getproplen(rtas, \"ibm,hypertas-functions\");\n\tif (x != PROM_ERROR) {\n\t\tprom_debug(\"Hypertas detected, assuming LPAR !\\n\");\n\t\treturn PLATFORM_PSERIES_LPAR;\n\t}\n\treturn PLATFORM_PSERIES;\n#else\n\treturn PLATFORM_GENERIC;\n#endif\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)",
            "#define PLATFORM_OPAL\t\t0x0600",
            "#define PLATFORM_GENERIC\t0x0500",
            "#define PLATFORM_POWERMAC\t0x0400",
            "#define PLATFORM_PSERIES_LPAR\t0x0101",
            "#define PLATFORM_PSERIES\t0x0100"
          ],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n#define PLATFORM_OPAL\t\t0x0600\n#define PLATFORM_GENERIC\t0x0500\n#define PLATFORM_POWERMAC\t0x0400\n#define PLATFORM_PSERIES_LPAR\t0x0101\n#define PLATFORM_PSERIES\t0x0100\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic int __init prom_find_machine_type(void)\n{\n\tchar compat[256];\n\tint len, i = 0;\n#ifdef CONFIG_PPC64\n\tphandle rtas;\n\tint x;\n#endif\n\n\t/* Look for a PowerMac or a Cell */\n\tlen = prom_getprop(prom.root, \"compatible\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len > 0) {\n\t\tcompat[len] = 0;\n\t\twhile (i < len) {\n\t\t\tchar *p = &compat[i];\n\t\t\tint sl = strlen(p);\n\t\t\tif (sl == 0)\n\t\t\t\tbreak;\n\t\t\tif (strstr(p, \"Power Macintosh\") ||\n\t\t\t    strstr(p, \"MacRISC\"))\n\t\t\t\treturn PLATFORM_POWERMAC;\n#ifdef CONFIG_PPC64\n\t\t\t/* We must make sure we don't detect the IBM Cell\n\t\t\t * blades as pSeries due to some firmware issues,\n\t\t\t * so we do it here.\n\t\t\t */\n\t\t\tif (strstr(p, \"IBM,CBEA\") ||\n\t\t\t    strstr(p, \"IBM,CPBW-1.0\"))\n\t\t\t\treturn PLATFORM_GENERIC;\n#endif /* CONFIG_PPC64 */\n\t\t\ti += sl + 1;\n\t\t}\n\t}\n#ifdef CONFIG_PPC64\n\t/* Try to detect OPAL */\n\tif (PHANDLE_VALID(call_prom(\"finddevice\", 1, 1, ADDR(\"/ibm,opal\"))))\n\t\treturn PLATFORM_OPAL;\n\n\t/* Try to figure out if it's an IBM pSeries or any other\n\t * PAPR compliant platform. We assume it is if :\n\t *  - /device_type is \"chrp\" (please, do NOT use that for future\n\t *    non-IBM designs !\n\t *  - it has /rtas\n\t */\n\tlen = prom_getprop(prom.root, \"device_type\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len <= 0)\n\t\treturn PLATFORM_GENERIC;\n\tif (strcmp(compat, \"chrp\"))\n\t\treturn PLATFORM_GENERIC;\n\n\t/* Default to pSeries. We need to know if we are running LPAR */\n\trtas = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tif (!PHANDLE_VALID(rtas))\n\t\treturn PLATFORM_GENERIC;\n\tx = prom_getproplen(rtas, \"ibm,hypertas-functions\");\n\tif (x != PROM_ERROR) {\n\t\tprom_debug(\"Hypertas detected, assuming LPAR !\\n\");\n\t\treturn PLATFORM_PSERIES_LPAR;\n\t}\n\treturn PLATFORM_PSERIES;\n#else\n\treturn PLATFORM_GENERIC;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_init_stdout",
          "args": [],
          "line": 2781
        },
        "resolved": true,
        "details": {
          "function_name": "prom_init_stdout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1801-1833",
          "snippet": "static void __init prom_init_stdout(void)\n{\n\tchar *path = of_stdout_device;\n\tchar type[16];\n\tphandle stdout_node;\n\t__be32 val;\n\n\tif (prom_getprop(prom.chosen, \"stdout\", &val, sizeof(val)) <= 0)\n\t\tprom_panic(\"cannot find stdout\");\n\n\tprom.stdout = be32_to_cpu(val);\n\n\t/* Get the full OF pathname of the stdout device */\n\tmemset(path, 0, 256);\n\tcall_prom(\"instance-to-path\", 3, 1, prom.stdout, path, 255);\n\tprom_printf(\"OF stdout device is: %s\\n\", of_stdout_device);\n\tprom_setprop(prom.chosen, \"/chosen\", \"linux,stdout-path\",\n\t\t     path, strlen(path) + 1);\n\n\t/* instance-to-package fails on PA-Semi */\n\tstdout_node = call_prom(\"instance-to-package\", 1, 1, prom.stdout);\n\tif (stdout_node != PROM_ERROR) {\n\t\tval = cpu_to_be32(stdout_node);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,stdout-package\",\n\t\t\t     &val, sizeof(val));\n\n\t\t/* If it's a display, note it */\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(stdout_node, \"device_type\", type, sizeof(type));\n\t\tif (strcmp(type, \"display\") == 0)\n\t\t\tprom_setprop(stdout_node, path, \"linux,boot-display\", NULL, 0);\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_init_stdout(void)\n{\n\tchar *path = of_stdout_device;\n\tchar type[16];\n\tphandle stdout_node;\n\t__be32 val;\n\n\tif (prom_getprop(prom.chosen, \"stdout\", &val, sizeof(val)) <= 0)\n\t\tprom_panic(\"cannot find stdout\");\n\n\tprom.stdout = be32_to_cpu(val);\n\n\t/* Get the full OF pathname of the stdout device */\n\tmemset(path, 0, 256);\n\tcall_prom(\"instance-to-path\", 3, 1, prom.stdout, path, 255);\n\tprom_printf(\"OF stdout device is: %s\\n\", of_stdout_device);\n\tprom_setprop(prom.chosen, \"/chosen\", \"linux,stdout-path\",\n\t\t     path, strlen(path) + 1);\n\n\t/* instance-to-package fails on PA-Semi */\n\tstdout_node = call_prom(\"instance-to-package\", 1, 1, prom.stdout);\n\tif (stdout_node != PROM_ERROR) {\n\t\tval = cpu_to_be32(stdout_node);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,stdout-package\",\n\t\t\t     &val, sizeof(val));\n\n\t\t/* If it's a display, note it */\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(stdout_node, \"device_type\", type, sizeof(type));\n\t\tif (strcmp(type, \"display\") == 0)\n\t\t\tprom_setprop(stdout_node, path, \"linux,boot-display\", NULL, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_find_mmu",
          "args": [],
          "line": 2776
        },
        "resolved": true,
        "details": {
          "function_name": "prom_find_mmu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1771-1796",
          "snippet": "static void __init prom_find_mmu(void)\n{\n\tphandle oprom;\n\tchar version[64];\n\n\toprom = call_prom(\"finddevice\", 1, 1, ADDR(\"/openprom\"));\n\tif (!PHANDLE_VALID(oprom))\n\t\treturn;\n\tif (prom_getprop(oprom, \"model\", version, sizeof(version)) <= 0)\n\t\treturn;\n\tversion[sizeof(version) - 1] = 0;\n\t/* XXX might need to add other versions here */\n\tif (strcmp(version, \"Open Firmware, 1.0.5\") == 0)\n\t\tof_workarounds = OF_WA_CLAIM;\n\telse if (strncmp(version, \"FirmWorks,3.\", 12) == 0) {\n\t\tof_workarounds = OF_WA_CLAIM | OF_WA_LONGTRAIL;\n\t\tcall_prom(\"interpret\", 1, 1, \"dev /memory 0 to allow-reclaim\");\n\t} else\n\t\treturn;\n\tprom.memory = call_prom(\"open\", 1, 1, ADDR(\"/memory\"));\n\tprom_getprop(prom.chosen, \"mmu\", &prom.mmumap,\n\t\t     sizeof(prom.mmumap));\n\tprom.mmumap = be32_to_cpu(prom.mmumap);\n\tif (!IHANDLE_VALID(prom.memory) || !IHANDLE_VALID(prom.mmumap))\n\t\tof_workarounds &= ~OF_WA_CLAIM;\t\t/* hmmm */\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */"
          ],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_find_mmu(void)\n{\n\tphandle oprom;\n\tchar version[64];\n\n\toprom = call_prom(\"finddevice\", 1, 1, ADDR(\"/openprom\"));\n\tif (!PHANDLE_VALID(oprom))\n\t\treturn;\n\tif (prom_getprop(oprom, \"model\", version, sizeof(version)) <= 0)\n\t\treturn;\n\tversion[sizeof(version) - 1] = 0;\n\t/* XXX might need to add other versions here */\n\tif (strcmp(version, \"Open Firmware, 1.0.5\") == 0)\n\t\tof_workarounds = OF_WA_CLAIM;\n\telse if (strncmp(version, \"FirmWorks,3.\", 12) == 0) {\n\t\tof_workarounds = OF_WA_CLAIM | OF_WA_LONGTRAIL;\n\t\tcall_prom(\"interpret\", 1, 1, \"dev /memory 0 to allow-reclaim\");\n\t} else\n\t\treturn;\n\tprom.memory = call_prom(\"open\", 1, 1, ADDR(\"/memory\"));\n\tprom_getprop(prom.chosen, \"mmu\", &prom.mmumap,\n\t\t     sizeof(prom.mmumap));\n\tprom.mmumap = be32_to_cpu(prom.mmumap);\n\tif (!IHANDLE_VALID(prom.memory) || !IHANDLE_VALID(prom.mmumap))\n\t\tof_workarounds &= ~OF_WA_CLAIM;\t\t/* hmmm */\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_init_client_services",
          "args": [
            "pp"
          ],
          "line": 2770
        },
        "resolved": true,
        "details": {
          "function_name": "prom_init_client_services",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1747-1763",
          "snippet": "static void __init prom_init_client_services(unsigned long pp)\n{\n\t/* Get a handle to the prom entry point before anything else */\n\tprom_entry = pp;\n\n\t/* get a handle for the stdout device */\n\tprom.chosen = call_prom(\"finddevice\", 1, 1, ADDR(\"/chosen\"));\n\tif (!PHANDLE_VALID(prom.chosen))\n\t\tprom_panic(\"cannot find chosen\"); /* msg won't be printed :( */\n\n\t/* get device tree root */\n\tprom.root = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(prom.root))\n\t\tprom_panic(\"cannot find device tree root\"); /* msg won't be printed :( */\n\n\tprom.mmumap = 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_init_client_services(unsigned long pp)\n{\n\t/* Get a handle to the prom entry point before anything else */\n\tprom_entry = pp;\n\n\t/* get a handle for the stdout device */\n\tprom.chosen = call_prom(\"finddevice\", 1, 1, ADDR(\"/chosen\"));\n\tif (!PHANDLE_VALID(prom.chosen))\n\t\tprom_panic(\"cannot find chosen\"); /* msg won't be printed :( */\n\n\t/* get device tree root */\n\tprom.root = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(prom.root))\n\t\tprom_panic(\"cannot find device tree root\"); /* msg won't be printed :( */\n\n\tprom.mmumap = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&__bss_start",
            "0",
            "__bss_stop - __bss_start"
          ],
          "line": 2764
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/io.c",
          "lines": "126-151",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "reloc_got2",
          "args": [
            "offset"
          ],
          "line": 2756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reloc_offset",
          "args": [],
          "line": 2755
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PLATFORM_OPAL\t\t0x0600\n#define PLATFORM_POWERMAC\t0x0400\n#define PLATFORM_PSERIES_LPAR\t0x0101\n#define PLATFORM_PSERIES\t0x0100\n\nextern void __start(unsigned long r3, unsigned long r4, unsigned long r5,\n\t\t    unsigned long r6, unsigned long r7, unsigned long r8,\n\t\t    unsigned long r9);\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\nstatic struct prom_t __initdata prom;\nstatic unsigned long __initdata dt_header_start;\nstatic unsigned long __initdata prom_memory_limit;\nstatic void __init;\n\nunsigned long __init prom_init(unsigned long r3, unsigned long r4,\n\t\t\t       unsigned long pp,\n\t\t\t       unsigned long r6, unsigned long r7,\n\t\t\t       unsigned long kbase)\n{\t\n\tunsigned long hdr;\n\n#ifdef CONFIG_PPC32\n\tunsigned long offset = reloc_offset();\n\treloc_got2(offset);\n#else\n\treloc_toc();\n#endif\n\n\t/*\n\t * First zero the BSS\n\t */\n\tmemset(&__bss_start, 0, __bss_stop - __bss_start);\n\n\t/*\n\t * Init interface to Open Firmware, get some node references,\n\t * like /chosen\n\t */\n\tprom_init_client_services(pp);\n\n\t/*\n\t * See if this OF is old enough that we need to do explicit maps\n\t * and other workarounds\n\t */\n\tprom_find_mmu();\n\n\t/*\n\t * Init prom stdout device\n\t */\n\tprom_init_stdout();\n\n\tprom_printf(\"Preparing to boot %s\", linux_banner);\n\n\t/*\n\t * Get default machine type. At this point, we do not differentiate\n\t * between pSeries SMP and pSeries LPAR\n\t */\n\tof_platform = prom_find_machine_type();\n\tprom_printf(\"Detected machine type: %x\\n\", of_platform);\n\n#ifndef CONFIG_NONSTATIC_KERNEL\n\t/* Bail if this is a kdump kernel. */\n\tif (PHYSICAL_START > 0)\n\t\tprom_panic(\"Error: You can't boot a kdump kernel from OF!\\n\");\n#endif\n\n\t/*\n\t * Check for an initrd\n\t */\n\tprom_check_initrd(r3, r4);\n\n#if defined(CONFIG_PPC_PSERIES) || defined(CONFIG_PPC_POWERNV)\n\t/*\n\t * On pSeries, inform the firmware about our capabilities\n\t */\n\tif (of_platform == PLATFORM_PSERIES ||\n\t    of_platform == PLATFORM_PSERIES_LPAR)\n\t\tprom_send_capabilities();\n#endif\n\n\t/*\n\t * Copy the CPU hold code\n\t */\n\tif (of_platform != PLATFORM_POWERMAC)\n\t\tcopy_and_flush(0, kbase, 0x100, 0);\n\n\t/*\n\t * Do early parsing of command line\n\t */\n\tearly_cmdline_parse();\n\n\t/*\n\t * Initialize memory management within prom_init\n\t */\n\tprom_init_mem();\n\n\t/*\n\t * Determine which cpu is actually running right _now_\n\t */\n\tprom_find_boot_cpu();\n\n\t/* \n\t * Initialize display devices\n\t */\n\tprom_check_displays();\n\n#if defined(CONFIG_PPC64) && defined(__BIG_ENDIAN__)\n\t/*\n\t * Initialize IOMMU (TCE tables) on pSeries. Do that before anything else\n\t * that uses the allocator, we need to make sure we get the top of memory\n\t * available for us here...\n\t */\n\tif (of_platform == PLATFORM_PSERIES)\n\t\tprom_initialize_tce_table();\n#endif\n\n\t/*\n\t * On non-powermacs, try to instantiate RTAS. PowerMacs don't\n\t * have a usable RTAS implementation.\n\t */\n\tif (of_platform != PLATFORM_POWERMAC &&\n\t    of_platform != PLATFORM_OPAL)\n\t\tprom_instantiate_rtas();\n\n#ifdef CONFIG_PPC_POWERNV\n\tif (of_platform == PLATFORM_OPAL)\n\t\tprom_instantiate_opal();\n#endif /* CONFIG_PPC_POWERNV */\n\n#ifdef CONFIG_PPC64\n\t/* instantiate sml */\n\tprom_instantiate_sml();\n#endif\n\n\t/*\n\t * On non-powermacs, put all CPUs in spin-loops.\n\t *\n\t * PowerMacs use a different mechanism to spin CPUs\n\t *\n\t * (This must be done after instanciating RTAS)\n\t */\n\tif (of_platform != PLATFORM_POWERMAC &&\n\t    of_platform != PLATFORM_OPAL)\n\t\tprom_hold_cpus();\n\n\t/*\n\t * Fill in some infos for use by the kernel later on\n\t */\n\tif (prom_memory_limit) {\n\t\t__be64 val = cpu_to_be64(prom_memory_limit);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,memory-limit\",\n\t\t\t     &val, sizeof(val));\n\t}\n#ifdef CONFIG_PPC64\n\tif (prom_iommu_off)\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,iommu-off\",\n\t\t\t     NULL, 0);\n\n\tif (prom_iommu_force_on)\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,iommu-force-on\",\n\t\t\t     NULL, 0);\n\n\tif (prom_tce_alloc_start) {\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,tce-alloc-start\",\n\t\t\t     &prom_tce_alloc_start,\n\t\t\t     sizeof(prom_tce_alloc_start));\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,tce-alloc-end\",\n\t\t\t     &prom_tce_alloc_end,\n\t\t\t     sizeof(prom_tce_alloc_end));\n\t}\n#endif\n\n\t/*\n\t * Fixup any known bugs in the device-tree\n\t */\n\tfixup_device_tree();\n\n\t/*\n\t * Now finally create the flattened device-tree\n\t */\n\tprom_printf(\"copying OF device tree...\\n\");\n\tflatten_device_tree();\n\n\t/*\n\t * in case stdin is USB and still active on IBM machines...\n\t * Unfortunately quiesce crashes on some powermacs if we have\n\t * closed stdin already (in particular the powerbook 101). It\n\t * appears that the OPAL version of OFW doesn't like it either.\n\t */\n\tif (of_platform != PLATFORM_POWERMAC &&\n\t    of_platform != PLATFORM_OPAL)\n\t\tprom_close_stdin();\n\n\t/*\n\t * Call OF \"quiesce\" method to shut down pending DMA's from\n\t * devices etc...\n\t */\n\tprom_printf(\"Quiescing Open Firmware ...\\n\");\n\tcall_prom(\"quiesce\", 0, 0);\n\n\t/*\n\t * And finally, call the kernel passing it the flattened device\n\t * tree and NULL as r5, thus triggering the new entry point which\n\t * is common to us and kexec\n\t */\n\thdr = dt_header_start;\n\n\t/* Don't print anything after quiesce under OPAL, it crashes OFW */\n\tif (of_platform != PLATFORM_OPAL) {\n\t\tprom_printf(\"Booting Linux via __start() ...\\n\");\n\t\tprom_debug(\"->dt_header_start=0x%x\\n\", hdr);\n\t}\n\n#ifdef CONFIG_PPC32\n\treloc_got2(-offset);\n#else\n\tunreloc_toc();\n#endif\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_OPAL\n\t/* OPAL early debug gets the OPAL base & entry in r8 and r9 */\n\t__start(hdr, kbase, 0, 0, 0,\n\t\tprom_opal_base, prom_opal_entry);\n#else\n\t__start(hdr, kbase, 0, 0, 0, 0, 0);\n#endif\n\n\treturn 0;\n}"
  },
  {
    "function_name": "unreloc_toc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2729-2738",
    "snippet": "static void unreloc_toc(void)\n{\n\tunsigned long offset = reloc_offset();\n\tunsigned long nr_entries =\n\t\t(__prom_init_toc_end - __prom_init_toc_start) / sizeof(long);\n\n\tmb();\n\n\t__reloc_toc(-offset, nr_entries);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__reloc_toc",
          "args": [
            "-offset",
            "nr_entries"
          ],
          "line": 2737
        },
        "resolved": true,
        "details": {
          "function_name": "__reloc_toc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2704-2716",
          "snippet": "static void __reloc_toc(unsigned long offset, unsigned long nr_entries)\n{\n\tunsigned long i;\n\tunsigned long *toc_entry;\n\n\t/* Get the start of the TOC by using r2 directly. */\n\tasm volatile(\"addi %0,2,-0x8000\" : \"=b\" (toc_entry));\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\t*toc_entry = *toc_entry + offset;\n\t\ttoc_entry++;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\n\nstatic void __reloc_toc(unsigned long offset, unsigned long nr_entries)\n{\n\tunsigned long i;\n\tunsigned long *toc_entry;\n\n\t/* Get the start of the TOC by using r2 directly. */\n\tasm volatile(\"addi %0,2,-0x8000\" : \"=b\" (toc_entry));\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\t*toc_entry = *toc_entry + offset;\n\t\ttoc_entry++;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb",
          "args": [],
          "line": 2735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reloc_offset",
          "args": [],
          "line": 2731
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\n\nstatic void unreloc_toc(void)\n{\n\tunsigned long offset = reloc_offset();\n\tunsigned long nr_entries =\n\t\t(__prom_init_toc_end - __prom_init_toc_start) / sizeof(long);\n\n\tmb();\n\n\t__reloc_toc(-offset, nr_entries);\n}"
  },
  {
    "function_name": "reloc_toc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2718-2727",
    "snippet": "static void reloc_toc(void)\n{\n\tunsigned long offset = reloc_offset();\n\tunsigned long nr_entries =\n\t\t(__prom_init_toc_end - __prom_init_toc_start) / sizeof(long);\n\n\t__reloc_toc(offset, nr_entries);\n\n\tmb();\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mb",
          "args": [],
          "line": 2726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__reloc_toc",
          "args": [
            "offset",
            "nr_entries"
          ],
          "line": 2724
        },
        "resolved": true,
        "details": {
          "function_name": "__reloc_toc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2704-2716",
          "snippet": "static void __reloc_toc(unsigned long offset, unsigned long nr_entries)\n{\n\tunsigned long i;\n\tunsigned long *toc_entry;\n\n\t/* Get the start of the TOC by using r2 directly. */\n\tasm volatile(\"addi %0,2,-0x8000\" : \"=b\" (toc_entry));\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\t*toc_entry = *toc_entry + offset;\n\t\ttoc_entry++;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\n\nstatic void __reloc_toc(unsigned long offset, unsigned long nr_entries)\n{\n\tunsigned long i;\n\tunsigned long *toc_entry;\n\n\t/* Get the start of the TOC by using r2 directly. */\n\tasm volatile(\"addi %0,2,-0x8000\" : \"=b\" (toc_entry));\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\t*toc_entry = *toc_entry + offset;\n\t\ttoc_entry++;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "reloc_offset",
          "args": [],
          "line": 2720
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\n\nstatic void reloc_toc(void)\n{\n\tunsigned long offset = reloc_offset();\n\tunsigned long nr_entries =\n\t\t(__prom_init_toc_end - __prom_init_toc_start) / sizeof(long);\n\n\t__reloc_toc(offset, nr_entries);\n\n\tmb();\n}"
  },
  {
    "function_name": "__reloc_toc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2704-2716",
    "snippet": "static void __reloc_toc(unsigned long offset, unsigned long nr_entries)\n{\n\tunsigned long i;\n\tunsigned long *toc_entry;\n\n\t/* Get the start of the TOC by using r2 directly. */\n\tasm volatile(\"addi %0,2,-0x8000\" : \"=b\" (toc_entry));\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\t*toc_entry = *toc_entry + offset;\n\t\ttoc_entry++;\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\n\nstatic void __reloc_toc(unsigned long offset, unsigned long nr_entries)\n{\n\tunsigned long i;\n\tunsigned long *toc_entry;\n\n\t/* Get the start of the TOC by using r2 directly. */\n\tasm volatile(\"addi %0,2,-0x8000\" : \"=b\" (toc_entry));\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\t*toc_entry = *toc_entry + offset;\n\t\ttoc_entry++;\n\t}\n}"
  },
  {
    "function_name": "unreloc_toc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2700-2702",
    "snippet": "static void unreloc_toc(void)\n{\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void unreloc_toc(void)\n{\n}"
  },
  {
    "function_name": "reloc_toc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2696-2698",
    "snippet": "static void reloc_toc(void)\n{\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void reloc_toc(void)\n{\n}"
  },
  {
    "function_name": "prom_check_initrd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2669-2692",
    "snippet": "static void __init prom_check_initrd(unsigned long r3, unsigned long r4)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tif (r3 && r4 && r4 != 0xdeadbeef) {\n\t\t__be64 val;\n\n\t\tprom_initrd_start = is_kernel_addr(r3) ? __pa(r3) : r3;\n\t\tprom_initrd_end = prom_initrd_start + r4;\n\n\t\tval = cpu_to_be64(prom_initrd_start);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-start\",\n\t\t\t     &val, sizeof(val));\n\t\tval = cpu_to_be64(prom_initrd_end);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-end\",\n\t\t\t     &val, sizeof(val));\n\n\t\treserve_mem(prom_initrd_start,\n\t\t\t    prom_initrd_end - prom_initrd_start);\n\n\t\tprom_debug(\"initrd_start=0x%x\\n\", prom_initrd_start);\n\t\tprom_debug(\"initrd_end=0x%x\\n\", prom_initrd_end);\n\t}\n#endif /* CONFIG_BLK_DEV_INITRD */\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static unsigned long __initdata prom_initrd_start, prom_initrd_end;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"initrd_end=0x%x\\n\"",
            "prom_initrd_end"
          ],
          "line": 2689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"initrd_start=0x%x\\n\"",
            "prom_initrd_start"
          ],
          "line": 2688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_mem",
          "args": [
            "prom_initrd_start",
            "prom_initrd_end - prom_initrd_start"
          ],
          "line": 2685
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1107-1128",
          "snippet": "static void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = _ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = _ALIGN_UP(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MEM_RESERVE_MAP_SIZE\t8"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n\nstatic void __init;\n\nstatic void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = _ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = _ALIGN_UP(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "prom.chosen",
            "\"/chosen\"",
            "\"linux,initrd-end\"",
            "&val",
            "sizeof(val)"
          ],
          "line": 2682
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "500-520",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be64",
          "args": [
            "prom_initrd_end"
          ],
          "line": 2681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be64",
          "args": [
            "prom_initrd_start"
          ],
          "line": 2678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__pa",
          "args": [
            "r3"
          ],
          "line": 2675
        },
        "resolved": true,
        "details": {
          "function_name": "__parse_fpscr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/traps.c",
          "lines": "829-854",
          "snippet": "static inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = 0;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}",
          "includes": [
            "#include <sysdev/fsl_pci.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/fadump.h>",
            "#include <asm/rio.h>",
            "#include <asm/ppc-opcode.h>",
            "#include <asm/kexec.h>",
            "#include <asm/tm.h>",
            "#include <asm/processor.h>",
            "#include <asm/firmware.h>",
            "#include <asm/backlight.h>",
            "#include <asm/reg.h>",
            "#include <asm/pmc.h>",
            "#include <asm/rtas.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/emulated_ops.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/bug.h>",
            "#include <linux/backlight.h>",
            "#include <linux/kexec.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/delay.h>",
            "#include <linux/prctl.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/user.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sysdev/fsl_pci.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/fadump.h>\n#include <asm/rio.h>\n#include <asm/ppc-opcode.h>\n#include <asm/kexec.h>\n#include <asm/tm.h>\n#include <asm/processor.h>\n#include <asm/firmware.h>\n#include <asm/backlight.h>\n#include <asm/reg.h>\n#include <asm/pmc.h>\n#include <asm/rtas.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <asm/pgtable.h>\n#include <asm/emulated_ops.h>\n#include <linux/context_tracking.h>\n#include <linux/ratelimit.h>\n#include <linux/debugfs.h>\n#include <linux/kdebug.h>\n#include <linux/bug.h>\n#include <linux/backlight.h>\n#include <linux/kexec.h>\n#include <linux/kprobes.h>\n#include <linux/delay.h>\n#include <linux/prctl.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/user.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = 0;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_kernel_addr",
          "args": [
            "r3"
          ],
          "line": 2675
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic unsigned long __initdata prom_initrd_start, prom_initrd_end;\nstatic void __init;\n\nstatic void __init prom_check_initrd(unsigned long r3, unsigned long r4)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tif (r3 && r4 && r4 != 0xdeadbeef) {\n\t\t__be64 val;\n\n\t\tprom_initrd_start = is_kernel_addr(r3) ? __pa(r3) : r3;\n\t\tprom_initrd_end = prom_initrd_start + r4;\n\n\t\tval = cpu_to_be64(prom_initrd_start);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-start\",\n\t\t\t     &val, sizeof(val));\n\t\tval = cpu_to_be64(prom_initrd_end);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-end\",\n\t\t\t     &val, sizeof(val));\n\n\t\treserve_mem(prom_initrd_start,\n\t\t\t    prom_initrd_end - prom_initrd_start);\n\n\t\tprom_debug(\"initrd_start=0x%x\\n\", prom_initrd_start);\n\t\tprom_debug(\"initrd_end=0x%x\\n\", prom_initrd_end);\n\t}\n#endif /* CONFIG_BLK_DEV_INITRD */\n}"
  },
  {
    "function_name": "prom_find_boot_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2650-2667",
    "snippet": "static void __init prom_find_boot_cpu(void)\n{\n\t__be32 rval;\n\tihandle prom_cpu;\n\tphandle cpu_pkg;\n\n\trval = 0;\n\tif (prom_getprop(prom.chosen, \"cpu\", &rval, sizeof(rval)) <= 0)\n\t\treturn;\n\tprom_cpu = be32_to_cpu(rval);\n\n\tcpu_pkg = call_prom(\"instance-to-package\", 1, 1, prom_cpu);\n\n\tprom_getprop(cpu_pkg, \"reg\", &rval, sizeof(rval));\n\tprom.cpu = be32_to_cpu(rval);\n\n\tprom_debug(\"Booting CPU hw index = %lu\\n\", prom.cpu);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Booting CPU hw index = %lu\\n\"",
            "prom.cpu"
          ],
          "line": 2666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "rval"
          ],
          "line": 2664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "cpu_pkg",
            "\"reg\"",
            "&rval",
            "sizeof(rval)"
          ],
          "line": 2663
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"instance-to-package\"",
            "1",
            "1",
            "prom_cpu"
          ],
          "line": 2661
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "rval"
          ],
          "line": 2659
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_find_boot_cpu(void)\n{\n\t__be32 rval;\n\tihandle prom_cpu;\n\tphandle cpu_pkg;\n\n\trval = 0;\n\tif (prom_getprop(prom.chosen, \"cpu\", &rval, sizeof(rval)) <= 0)\n\t\treturn;\n\tprom_cpu = be32_to_cpu(rval);\n\n\tcpu_pkg = call_prom(\"instance-to-package\", 1, 1, prom_cpu);\n\n\tprom_getprop(cpu_pkg, \"reg\", &rval, sizeof(rval));\n\tprom.cpu = be32_to_cpu(rval);\n\n\tprom_debug(\"Booting CPU hw index = %lu\\n\", prom.cpu);\n}"
  },
  {
    "function_name": "fixup_device_tree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2641-2648",
    "snippet": "static void __init fixup_device_tree(void)\n{\n\tfixup_device_tree_maple();\n\tfixup_device_tree_maple_memory_controller();\n\tfixup_device_tree_chrp();\n\tfixup_device_tree_pmac();\n\tfixup_device_tree_efika();\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fixup_device_tree_efika",
          "args": [],
          "line": 2647
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_device_tree_efika",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2574-2636",
          "snippet": "static void __init fixup_device_tree_efika(void)\n{\n\tint sound_irq[3] = { 2, 2, 0 };\n\tint bcomm_irq[3*16] = { 3,0,0, 3,1,0, 3,2,0, 3,3,0,\n\t\t\t\t3,4,0, 3,5,0, 3,6,0, 3,7,0,\n\t\t\t\t3,8,0, 3,9,0, 3,10,0, 3,11,0,\n\t\t\t\t3,12,0, 3,13,0, 3,14,0, 3,15,0 };\n\tu32 node;\n\tchar prop[64];\n\tint rv, len;\n\n\t/* Check if we're really running on a EFIKA */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\trv = prom_getprop(node, \"model\", prop, sizeof(prop));\n\tif (rv == PROM_ERROR)\n\t\treturn;\n\tif (strcmp(prop, \"EFIKA5K2\"))\n\t\treturn;\n\n\tprom_printf(\"Applying EFIKA device tree fixups\\n\");\n\n\t/* Claiming to be 'chrp' is death */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\trv = prom_getprop(node, \"device_type\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (strcmp(prop, \"chrp\") == 0))\n\t\tprom_setprop(node, \"/\", \"device_type\", \"efika\", sizeof(\"efika\"));\n\n\t/* CODEGEN,description is exposed in /proc/cpuinfo so\n\t   fix that too */\n\trv = prom_getprop(node, \"CODEGEN,description\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (strstr(prop, \"CHRP\")))\n\t\tprom_setprop(node, \"/\", \"CODEGEN,description\",\n\t\t\t     \"Efika 5200B PowerPC System\",\n\t\t\t     sizeof(\"Efika 5200B PowerPC System\"));\n\n\t/* Fixup bestcomm interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/bestcomm\"));\n\tif (PHANDLE_VALID(node)) {\n\t\tlen = prom_getproplen(node, \"interrupts\");\n\t\tif (len == 12) {\n\t\t\tprom_printf(\"Fixing bestcomm interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/bestcom\", \"interrupts\",\n\t\t\t\t     bcomm_irq, sizeof(bcomm_irq));\n\t\t}\n\t}\n\n\t/* Fixup sound interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/sound\"));\n\tif (PHANDLE_VALID(node)) {\n\t\trv = prom_getprop(node, \"interrupts\", prop, sizeof(prop));\n\t\tif (rv == PROM_ERROR) {\n\t\t\tprom_printf(\"Adding sound interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/sound\", \"interrupts\",\n\t\t\t\t     sound_irq, sizeof(sound_irq));\n\t\t}\n\t}\n\n\t/* Make sure ethernet phy-handle property exists */\n\tfixup_device_tree_efika_add_phy();\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_efika(void)\n{\n\tint sound_irq[3] = { 2, 2, 0 };\n\tint bcomm_irq[3*16] = { 3,0,0, 3,1,0, 3,2,0, 3,3,0,\n\t\t\t\t3,4,0, 3,5,0, 3,6,0, 3,7,0,\n\t\t\t\t3,8,0, 3,9,0, 3,10,0, 3,11,0,\n\t\t\t\t3,12,0, 3,13,0, 3,14,0, 3,15,0 };\n\tu32 node;\n\tchar prop[64];\n\tint rv, len;\n\n\t/* Check if we're really running on a EFIKA */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\trv = prom_getprop(node, \"model\", prop, sizeof(prop));\n\tif (rv == PROM_ERROR)\n\t\treturn;\n\tif (strcmp(prop, \"EFIKA5K2\"))\n\t\treturn;\n\n\tprom_printf(\"Applying EFIKA device tree fixups\\n\");\n\n\t/* Claiming to be 'chrp' is death */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\trv = prom_getprop(node, \"device_type\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (strcmp(prop, \"chrp\") == 0))\n\t\tprom_setprop(node, \"/\", \"device_type\", \"efika\", sizeof(\"efika\"));\n\n\t/* CODEGEN,description is exposed in /proc/cpuinfo so\n\t   fix that too */\n\trv = prom_getprop(node, \"CODEGEN,description\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (strstr(prop, \"CHRP\")))\n\t\tprom_setprop(node, \"/\", \"CODEGEN,description\",\n\t\t\t     \"Efika 5200B PowerPC System\",\n\t\t\t     sizeof(\"Efika 5200B PowerPC System\"));\n\n\t/* Fixup bestcomm interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/bestcomm\"));\n\tif (PHANDLE_VALID(node)) {\n\t\tlen = prom_getproplen(node, \"interrupts\");\n\t\tif (len == 12) {\n\t\t\tprom_printf(\"Fixing bestcomm interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/bestcom\", \"interrupts\",\n\t\t\t\t     bcomm_irq, sizeof(bcomm_irq));\n\t\t}\n\t}\n\n\t/* Fixup sound interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/sound\"));\n\tif (PHANDLE_VALID(node)) {\n\t\trv = prom_getprop(node, \"interrupts\", prop, sizeof(prop));\n\t\tif (rv == PROM_ERROR) {\n\t\t\tprom_printf(\"Adding sound interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/sound\", \"interrupts\",\n\t\t\t\t     sound_irq, sizeof(sound_irq));\n\t\t}\n\t}\n\n\t/* Make sure ethernet phy-handle property exists */\n\tfixup_device_tree_efika_add_phy();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fixup_device_tree_pmac",
          "args": [],
          "line": 2646
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_device_tree_pmac",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2462-2500",
          "snippet": "static void __init fixup_device_tree_pmac(void)\n{\n\tphandle u3, i2c, mpic;\n\tu32 u3_rev;\n\tu32 interrupts[2];\n\tu32 parent;\n\n\t/* Some G5s have a missing interrupt definition, fix it up here */\n\tu3 = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000\"));\n\tif (!PHANDLE_VALID(u3))\n\t\treturn;\n\ti2c = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/i2c@f8001000\"));\n\tif (!PHANDLE_VALID(i2c))\n\t\treturn;\n\tmpic = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/mpic@f8040000\"));\n\tif (!PHANDLE_VALID(mpic))\n\t\treturn;\n\n\t/* check if proper rev of u3 */\n\tif (prom_getprop(u3, \"device-rev\", &u3_rev, sizeof(u3_rev))\n\t    == PROM_ERROR)\n\t\treturn;\n\tif (u3_rev < 0x35 || u3_rev > 0x39)\n\t\treturn;\n\t/* does it need fixup ? */\n\tif (prom_getproplen(i2c, \"interrupts\") > 0)\n\t\treturn;\n\n\tprom_printf(\"fixing up bogus interrupts for u3 i2c...\\n\");\n\n\t/* interrupt on this revision of u3 is number 0 and level */\n\tinterrupts[0] = 0;\n\tinterrupts[1] = 1;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupts\",\n\t\t     &interrupts, sizeof(interrupts));\n\tparent = (u32)mpic;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupt-parent\",\n\t\t     &parent, sizeof(parent));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_pmac(void)\n{\n\tphandle u3, i2c, mpic;\n\tu32 u3_rev;\n\tu32 interrupts[2];\n\tu32 parent;\n\n\t/* Some G5s have a missing interrupt definition, fix it up here */\n\tu3 = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000\"));\n\tif (!PHANDLE_VALID(u3))\n\t\treturn;\n\ti2c = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/i2c@f8001000\"));\n\tif (!PHANDLE_VALID(i2c))\n\t\treturn;\n\tmpic = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/mpic@f8040000\"));\n\tif (!PHANDLE_VALID(mpic))\n\t\treturn;\n\n\t/* check if proper rev of u3 */\n\tif (prom_getprop(u3, \"device-rev\", &u3_rev, sizeof(u3_rev))\n\t    == PROM_ERROR)\n\t\treturn;\n\tif (u3_rev < 0x35 || u3_rev > 0x39)\n\t\treturn;\n\t/* does it need fixup ? */\n\tif (prom_getproplen(i2c, \"interrupts\") > 0)\n\t\treturn;\n\n\tprom_printf(\"fixing up bogus interrupts for u3 i2c...\\n\");\n\n\t/* interrupt on this revision of u3 is number 0 and level */\n\tinterrupts[0] = 0;\n\tinterrupts[1] = 1;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupts\",\n\t\t     &interrupts, sizeof(interrupts));\n\tparent = (u32)mpic;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupt-parent\",\n\t\t     &parent, sizeof(parent));\n}"
        }
      },
      {
        "call_info": {
          "callee": "fixup_device_tree_chrp",
          "args": [],
          "line": 2645
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_device_tree_chrp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2412-2456",
          "snippet": "static void __init fixup_device_tree_chrp(void)\n{\n\tphandle ph;\n\tu32 prop[6];\n\tu32 rloc = 0x01006000; /* IO space; PCI device = 12 */\n\tchar *name;\n\tint rc;\n\n\tname = \"/pci@80000000/isa@c\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(ph)) {\n\t\tname = \"/pci@ff500000/isa@6\";\n\t\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\t\trloc = 0x01003000; /* IO space; PCI device = 6 */\n\t}\n\tif (PHANDLE_VALID(ph)) {\n\t\trc = prom_getproplen(ph, \"ranges\");\n\t\tif (rc == 0 || rc == PROM_ERROR) {\n\t\t\tprom_printf(\"Fixing up missing ISA range on Pegasos...\\n\");\n\n\t\t\tprop[0] = 0x1;\n\t\t\tprop[1] = 0x0;\n\t\t\tprop[2] = rloc;\n\t\t\tprop[3] = 0x0;\n\t\t\tprop[4] = 0x0;\n\t\t\tprop[5] = 0x00010000;\n\t\t\tprom_setprop(ph, name, \"ranges\", prop, sizeof(prop));\n\t\t}\n\t}\n\n\tname = \"/pci@80000000/ide@C,1\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (PHANDLE_VALID(ph)) {\n\t\tprom_printf(\"Fixing up IDE interrupt on Pegasos...\\n\");\n\t\tprop[0] = 14;\n\t\tprop[1] = 0x0;\n\t\tprom_setprop(ph, name, \"interrupts\", prop, 2*sizeof(u32));\n\t\tprom_printf(\"Fixing up IDE class-code on Pegasos...\\n\");\n\t\trc = prom_getprop(ph, \"class-code\", prop, sizeof(u32));\n\t\tif (rc == sizeof(u32)) {\n\t\t\tprop[0] &= ~0x5;\n\t\t\tprom_setprop(ph, name, \"class-code\", prop, sizeof(u32));\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_chrp(void)\n{\n\tphandle ph;\n\tu32 prop[6];\n\tu32 rloc = 0x01006000; /* IO space; PCI device = 12 */\n\tchar *name;\n\tint rc;\n\n\tname = \"/pci@80000000/isa@c\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(ph)) {\n\t\tname = \"/pci@ff500000/isa@6\";\n\t\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\t\trloc = 0x01003000; /* IO space; PCI device = 6 */\n\t}\n\tif (PHANDLE_VALID(ph)) {\n\t\trc = prom_getproplen(ph, \"ranges\");\n\t\tif (rc == 0 || rc == PROM_ERROR) {\n\t\t\tprom_printf(\"Fixing up missing ISA range on Pegasos...\\n\");\n\n\t\t\tprop[0] = 0x1;\n\t\t\tprop[1] = 0x0;\n\t\t\tprop[2] = rloc;\n\t\t\tprop[3] = 0x0;\n\t\t\tprop[4] = 0x0;\n\t\t\tprop[5] = 0x00010000;\n\t\t\tprom_setprop(ph, name, \"ranges\", prop, sizeof(prop));\n\t\t}\n\t}\n\n\tname = \"/pci@80000000/ide@C,1\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (PHANDLE_VALID(ph)) {\n\t\tprom_printf(\"Fixing up IDE interrupt on Pegasos...\\n\");\n\t\tprop[0] = 14;\n\t\tprop[1] = 0x0;\n\t\tprom_setprop(ph, name, \"interrupts\", prop, 2*sizeof(u32));\n\t\tprom_printf(\"Fixing up IDE class-code on Pegasos...\\n\");\n\t\trc = prom_getprop(ph, \"class-code\", prop, sizeof(u32));\n\t\tif (rc == sizeof(u32)) {\n\t\t\tprop[0] &= ~0x5;\n\t\t\tprom_setprop(ph, name, \"class-code\", prop, sizeof(u32));\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fixup_device_tree_maple_memory_controller",
          "args": [],
          "line": 2644
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_device_tree_maple_memory_controller",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2368-2400",
          "snippet": "static void __init fixup_device_tree_maple_memory_controller(void)\n{\n\tphandle mc;\n\tu32 mc_reg[4];\n\tchar *name = \"/hostbridge@f8000000\";\n\tu32 ac, sc;\n\n\tmc = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(mc))\n\t\treturn;\n\n\tif (prom_getproplen(mc, \"reg\") != 8)\n\t\treturn;\n\n\tprom_getprop(prom.root, \"#address-cells\", &ac, sizeof(ac));\n\tprom_getprop(prom.root, \"#size-cells\", &sc, sizeof(sc));\n\tif ((ac != 2) || (sc != 2))\n\t\treturn;\n\n\tif (prom_getprop(mc, \"reg\", mc_reg, sizeof(mc_reg)) == PROM_ERROR)\n\t\treturn;\n\n\tif (mc_reg[0] != CPC925_MC_START || mc_reg[1] != CPC925_MC_LENGTH)\n\t\treturn;\n\n\tprom_printf(\"Fixing up bogus hostbridge on Maple...\\n\");\n\n\tmc_reg[0] = 0x0;\n\tmc_reg[1] = CPC925_MC_START;\n\tmc_reg[2] = 0x0;\n\tmc_reg[3] = CPC925_MC_LENGTH;\n\tprom_setprop(mc, name, \"reg\", mc_reg, sizeof(mc_reg));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define CPC925_MC_LENGTH\t0x1000000",
            "#define CPC925_MC_START\t\t0xf8000000",
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define CPC925_MC_LENGTH\t0x1000000\n#define CPC925_MC_START\t\t0xf8000000\n#define PROM_ERROR\t\t(-1u)\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init fixup_device_tree_maple_memory_controller(void)\n{\n\tphandle mc;\n\tu32 mc_reg[4];\n\tchar *name = \"/hostbridge@f8000000\";\n\tu32 ac, sc;\n\n\tmc = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(mc))\n\t\treturn;\n\n\tif (prom_getproplen(mc, \"reg\") != 8)\n\t\treturn;\n\n\tprom_getprop(prom.root, \"#address-cells\", &ac, sizeof(ac));\n\tprom_getprop(prom.root, \"#size-cells\", &sc, sizeof(sc));\n\tif ((ac != 2) || (sc != 2))\n\t\treturn;\n\n\tif (prom_getprop(mc, \"reg\", mc_reg, sizeof(mc_reg)) == PROM_ERROR)\n\t\treturn;\n\n\tif (mc_reg[0] != CPC925_MC_START || mc_reg[1] != CPC925_MC_LENGTH)\n\t\treturn;\n\n\tprom_printf(\"Fixing up bogus hostbridge on Maple...\\n\");\n\n\tmc_reg[0] = 0x0;\n\tmc_reg[1] = CPC925_MC_START;\n\tmc_reg[2] = 0x0;\n\tmc_reg[3] = CPC925_MC_LENGTH;\n\tprom_setprop(mc, name, \"reg\", mc_reg, sizeof(mc_reg));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init fixup_device_tree(void)\n{\n\tfixup_device_tree_maple();\n\tfixup_device_tree_maple_memory_controller();\n\tfixup_device_tree_chrp();\n\tfixup_device_tree_pmac();\n\tfixup_device_tree_efika();\n}"
  },
  {
    "function_name": "fixup_device_tree_efika",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2574-2636",
    "snippet": "static void __init fixup_device_tree_efika(void)\n{\n\tint sound_irq[3] = { 2, 2, 0 };\n\tint bcomm_irq[3*16] = { 3,0,0, 3,1,0, 3,2,0, 3,3,0,\n\t\t\t\t3,4,0, 3,5,0, 3,6,0, 3,7,0,\n\t\t\t\t3,8,0, 3,9,0, 3,10,0, 3,11,0,\n\t\t\t\t3,12,0, 3,13,0, 3,14,0, 3,15,0 };\n\tu32 node;\n\tchar prop[64];\n\tint rv, len;\n\n\t/* Check if we're really running on a EFIKA */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\trv = prom_getprop(node, \"model\", prop, sizeof(prop));\n\tif (rv == PROM_ERROR)\n\t\treturn;\n\tif (strcmp(prop, \"EFIKA5K2\"))\n\t\treturn;\n\n\tprom_printf(\"Applying EFIKA device tree fixups\\n\");\n\n\t/* Claiming to be 'chrp' is death */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\trv = prom_getprop(node, \"device_type\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (strcmp(prop, \"chrp\") == 0))\n\t\tprom_setprop(node, \"/\", \"device_type\", \"efika\", sizeof(\"efika\"));\n\n\t/* CODEGEN,description is exposed in /proc/cpuinfo so\n\t   fix that too */\n\trv = prom_getprop(node, \"CODEGEN,description\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (strstr(prop, \"CHRP\")))\n\t\tprom_setprop(node, \"/\", \"CODEGEN,description\",\n\t\t\t     \"Efika 5200B PowerPC System\",\n\t\t\t     sizeof(\"Efika 5200B PowerPC System\"));\n\n\t/* Fixup bestcomm interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/bestcomm\"));\n\tif (PHANDLE_VALID(node)) {\n\t\tlen = prom_getproplen(node, \"interrupts\");\n\t\tif (len == 12) {\n\t\t\tprom_printf(\"Fixing bestcomm interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/bestcom\", \"interrupts\",\n\t\t\t\t     bcomm_irq, sizeof(bcomm_irq));\n\t\t}\n\t}\n\n\t/* Fixup sound interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/sound\"));\n\tif (PHANDLE_VALID(node)) {\n\t\trv = prom_getprop(node, \"interrupts\", prop, sizeof(prop));\n\t\tif (rv == PROM_ERROR) {\n\t\t\tprom_printf(\"Adding sound interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/sound\", \"interrupts\",\n\t\t\t\t     sound_irq, sizeof(sound_irq));\n\t\t}\n\t}\n\n\t/* Make sure ethernet phy-handle property exists */\n\tfixup_device_tree_efika_add_phy();\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fixup_device_tree_efika_add_phy",
          "args": [],
          "line": 2635
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_device_tree_efika_add_phy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2512-2572",
          "snippet": "static void __init fixup_device_tree_efika_add_phy(void)\n{\n\tu32 node;\n\tchar prop[64];\n\tint rv;\n\n\t/* Check if /builtin/ethernet exists - bail if it doesn't */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/ethernet\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\t/* Check if the phy-handle property exists - bail if it does */\n\trv = prom_getprop(node, \"phy-handle\", prop, sizeof(prop));\n\tif (!rv)\n\t\treturn;\n\n\t/*\n\t * At this point the ethernet device doesn't have a phy described.\n\t * Now we need to add the missing phy node and linkage\n\t */\n\n\t/* Check for an MDIO bus node - if missing then create one */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/mdio\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet MDIO node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" 1 encode-int s\\\" #address-cells\\\" property\"\n\t\t\t\t\" 0 encode-int s\\\" #size-cells\\\" property\"\n\t\t\t\t\" s\\\" mdio\\\" device-name\"\n\t\t\t\t\" s\\\" fsl,mpc5200b-mdio\\\" encode-string\"\n\t\t\t\t\" s\\\" compatible\\\" property\"\n\t\t\t\t\" 0xf0003000 0x400 reg\"\n\t\t\t\t\" 0x2 encode-int\"\n\t\t\t\t\" 0x5 encode-int encode+\"\n\t\t\t\t\" 0x3 encode-int encode+\"\n\t\t\t\t\" s\\\" interrupts\\\" property\"\n\t\t\t\" finish-device\");\n\t};\n\n\t/* Check for a PHY device node - if missing then create one and\n\t * give it's phandle to the ethernet node */\n\tnode = call_prom(\"finddevice\", 1, 1,\n\t\t\t ADDR(\"/builtin/mdio/ethernet-phy\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet PHY node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin/mdio\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" s\\\" ethernet-phy\\\" device-name\"\n\t\t\t\t\" 0x10 encode-int s\\\" reg\\\" property\"\n\t\t\t\t\" my-self\"\n\t\t\t\t\" ihandle>phandle\"\n\t\t\t\" finish-device\"\n\t\t\t\" s\\\" /builtin/ethernet\\\" find-device\"\n\t\t\t\t\" encode-int\"\n\t\t\t\t\" s\\\" phy-handle\\\" property\"\n\t\t\t\" device-end\");\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_efika_add_phy(void)\n{\n\tu32 node;\n\tchar prop[64];\n\tint rv;\n\n\t/* Check if /builtin/ethernet exists - bail if it doesn't */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/ethernet\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\t/* Check if the phy-handle property exists - bail if it does */\n\trv = prom_getprop(node, \"phy-handle\", prop, sizeof(prop));\n\tif (!rv)\n\t\treturn;\n\n\t/*\n\t * At this point the ethernet device doesn't have a phy described.\n\t * Now we need to add the missing phy node and linkage\n\t */\n\n\t/* Check for an MDIO bus node - if missing then create one */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/mdio\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet MDIO node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" 1 encode-int s\\\" #address-cells\\\" property\"\n\t\t\t\t\" 0 encode-int s\\\" #size-cells\\\" property\"\n\t\t\t\t\" s\\\" mdio\\\" device-name\"\n\t\t\t\t\" s\\\" fsl,mpc5200b-mdio\\\" encode-string\"\n\t\t\t\t\" s\\\" compatible\\\" property\"\n\t\t\t\t\" 0xf0003000 0x400 reg\"\n\t\t\t\t\" 0x2 encode-int\"\n\t\t\t\t\" 0x5 encode-int encode+\"\n\t\t\t\t\" 0x3 encode-int encode+\"\n\t\t\t\t\" s\\\" interrupts\\\" property\"\n\t\t\t\" finish-device\");\n\t};\n\n\t/* Check for a PHY device node - if missing then create one and\n\t * give it's phandle to the ethernet node */\n\tnode = call_prom(\"finddevice\", 1, 1,\n\t\t\t ADDR(\"/builtin/mdio/ethernet-phy\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet PHY node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin/mdio\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" s\\\" ethernet-phy\\\" device-name\"\n\t\t\t\t\" 0x10 encode-int s\\\" reg\\\" property\"\n\t\t\t\t\" my-self\"\n\t\t\t\t\" ihandle>phandle\"\n\t\t\t\" finish-device\"\n\t\t\t\" s\\\" /builtin/ethernet\\\" find-device\"\n\t\t\t\t\" encode-int\"\n\t\t\t\t\" s\\\" phy-handle\\\" property\"\n\t\t\t\" device-end\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "node",
            "\"/builtin/sound\"",
            "\"interrupts\"",
            "sound_irq",
            "sizeof(sound_irq)"
          ],
          "line": 2629
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "500-520",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Adding sound interrupts property\\n\""
          ],
          "line": 2628
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"interrupts\"",
            "prop",
            "sizeof(prop)"
          ],
          "line": 2626
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "node"
          ],
          "line": 2625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(\"/builtin/sound\")"
          ],
          "line": 2624
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/builtin/sound\""
          ],
          "line": 2624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "node",
            "\"interrupts\""
          ],
          "line": 2615
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "469-472",
          "snippet": "static int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "node"
          ],
          "line": 2614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/builtin/bestcomm\""
          ],
          "line": 2613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "prop",
            "\"CHRP\""
          ],
          "line": 2607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "prop",
            "\"chrp\""
          ],
          "line": 2601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/\""
          ],
          "line": 2599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "prop",
            "\"EFIKA5K2\""
          ],
          "line": 2593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "node"
          ],
          "line": 2587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/\""
          ],
          "line": 2586
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_efika(void)\n{\n\tint sound_irq[3] = { 2, 2, 0 };\n\tint bcomm_irq[3*16] = { 3,0,0, 3,1,0, 3,2,0, 3,3,0,\n\t\t\t\t3,4,0, 3,5,0, 3,6,0, 3,7,0,\n\t\t\t\t3,8,0, 3,9,0, 3,10,0, 3,11,0,\n\t\t\t\t3,12,0, 3,13,0, 3,14,0, 3,15,0 };\n\tu32 node;\n\tchar prop[64];\n\tint rv, len;\n\n\t/* Check if we're really running on a EFIKA */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\trv = prom_getprop(node, \"model\", prop, sizeof(prop));\n\tif (rv == PROM_ERROR)\n\t\treturn;\n\tif (strcmp(prop, \"EFIKA5K2\"))\n\t\treturn;\n\n\tprom_printf(\"Applying EFIKA device tree fixups\\n\");\n\n\t/* Claiming to be 'chrp' is death */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\trv = prom_getprop(node, \"device_type\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (strcmp(prop, \"chrp\") == 0))\n\t\tprom_setprop(node, \"/\", \"device_type\", \"efika\", sizeof(\"efika\"));\n\n\t/* CODEGEN,description is exposed in /proc/cpuinfo so\n\t   fix that too */\n\trv = prom_getprop(node, \"CODEGEN,description\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (strstr(prop, \"CHRP\")))\n\t\tprom_setprop(node, \"/\", \"CODEGEN,description\",\n\t\t\t     \"Efika 5200B PowerPC System\",\n\t\t\t     sizeof(\"Efika 5200B PowerPC System\"));\n\n\t/* Fixup bestcomm interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/bestcomm\"));\n\tif (PHANDLE_VALID(node)) {\n\t\tlen = prom_getproplen(node, \"interrupts\");\n\t\tif (len == 12) {\n\t\t\tprom_printf(\"Fixing bestcomm interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/bestcom\", \"interrupts\",\n\t\t\t\t     bcomm_irq, sizeof(bcomm_irq));\n\t\t}\n\t}\n\n\t/* Fixup sound interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/sound\"));\n\tif (PHANDLE_VALID(node)) {\n\t\trv = prom_getprop(node, \"interrupts\", prop, sizeof(prop));\n\t\tif (rv == PROM_ERROR) {\n\t\t\tprom_printf(\"Adding sound interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/sound\", \"interrupts\",\n\t\t\t\t     sound_irq, sizeof(sound_irq));\n\t\t}\n\t}\n\n\t/* Make sure ethernet phy-handle property exists */\n\tfixup_device_tree_efika_add_phy();\n}"
  },
  {
    "function_name": "fixup_device_tree_efika_add_phy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2512-2572",
    "snippet": "static void __init fixup_device_tree_efika_add_phy(void)\n{\n\tu32 node;\n\tchar prop[64];\n\tint rv;\n\n\t/* Check if /builtin/ethernet exists - bail if it doesn't */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/ethernet\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\t/* Check if the phy-handle property exists - bail if it does */\n\trv = prom_getprop(node, \"phy-handle\", prop, sizeof(prop));\n\tif (!rv)\n\t\treturn;\n\n\t/*\n\t * At this point the ethernet device doesn't have a phy described.\n\t * Now we need to add the missing phy node and linkage\n\t */\n\n\t/* Check for an MDIO bus node - if missing then create one */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/mdio\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet MDIO node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" 1 encode-int s\\\" #address-cells\\\" property\"\n\t\t\t\t\" 0 encode-int s\\\" #size-cells\\\" property\"\n\t\t\t\t\" s\\\" mdio\\\" device-name\"\n\t\t\t\t\" s\\\" fsl,mpc5200b-mdio\\\" encode-string\"\n\t\t\t\t\" s\\\" compatible\\\" property\"\n\t\t\t\t\" 0xf0003000 0x400 reg\"\n\t\t\t\t\" 0x2 encode-int\"\n\t\t\t\t\" 0x5 encode-int encode+\"\n\t\t\t\t\" 0x3 encode-int encode+\"\n\t\t\t\t\" s\\\" interrupts\\\" property\"\n\t\t\t\" finish-device\");\n\t};\n\n\t/* Check for a PHY device node - if missing then create one and\n\t * give it's phandle to the ethernet node */\n\tnode = call_prom(\"finddevice\", 1, 1,\n\t\t\t ADDR(\"/builtin/mdio/ethernet-phy\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet PHY node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin/mdio\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" s\\\" ethernet-phy\\\" device-name\"\n\t\t\t\t\" 0x10 encode-int s\\\" reg\\\" property\"\n\t\t\t\t\" my-self\"\n\t\t\t\t\" ihandle>phandle\"\n\t\t\t\" finish-device\"\n\t\t\t\" s\\\" /builtin/ethernet\\\" find-device\"\n\t\t\t\t\" encode-int\"\n\t\t\t\t\" s\\\" phy-handle\\\" property\"\n\t\t\t\" device-end\");\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"interpret\"",
            "1",
            "1",
            "\" s\\\" /builtin/mdio\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" s\\\" ethernet-phy\\\" device-name\"\n\t\t\t\t\" 0x10 encode-int s\\\" reg\\\" property\"\n\t\t\t\t\" my-self\"\n\t\t\t\t\" ihandle>phandle\"\n\t\t\t\" finish-device\"\n\t\t\t\" s\\\" /builtin/ethernet\\\" find-device\"\n\t\t\t\t\" encode-int\"\n\t\t\t\t\" s\\\" phy-handle\\\" property\"\n\t\t\t\" device-end\""
          ],
          "line": 2559
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Adding Ethernet PHY node\\n\""
          ],
          "line": 2558
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "node"
          ],
          "line": 2557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/builtin/mdio/ethernet-phy\""
          ],
          "line": 2556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "node"
          ],
          "line": 2535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/builtin/mdio\""
          ],
          "line": 2534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"phy-handle\"",
            "prop",
            "sizeof(prop)"
          ],
          "line": 2524
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "node"
          ],
          "line": 2520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/builtin/ethernet\""
          ],
          "line": 2519
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_efika_add_phy(void)\n{\n\tu32 node;\n\tchar prop[64];\n\tint rv;\n\n\t/* Check if /builtin/ethernet exists - bail if it doesn't */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/ethernet\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\t/* Check if the phy-handle property exists - bail if it does */\n\trv = prom_getprop(node, \"phy-handle\", prop, sizeof(prop));\n\tif (!rv)\n\t\treturn;\n\n\t/*\n\t * At this point the ethernet device doesn't have a phy described.\n\t * Now we need to add the missing phy node and linkage\n\t */\n\n\t/* Check for an MDIO bus node - if missing then create one */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/mdio\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet MDIO node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" 1 encode-int s\\\" #address-cells\\\" property\"\n\t\t\t\t\" 0 encode-int s\\\" #size-cells\\\" property\"\n\t\t\t\t\" s\\\" mdio\\\" device-name\"\n\t\t\t\t\" s\\\" fsl,mpc5200b-mdio\\\" encode-string\"\n\t\t\t\t\" s\\\" compatible\\\" property\"\n\t\t\t\t\" 0xf0003000 0x400 reg\"\n\t\t\t\t\" 0x2 encode-int\"\n\t\t\t\t\" 0x5 encode-int encode+\"\n\t\t\t\t\" 0x3 encode-int encode+\"\n\t\t\t\t\" s\\\" interrupts\\\" property\"\n\t\t\t\" finish-device\");\n\t};\n\n\t/* Check for a PHY device node - if missing then create one and\n\t * give it's phandle to the ethernet node */\n\tnode = call_prom(\"finddevice\", 1, 1,\n\t\t\t ADDR(\"/builtin/mdio/ethernet-phy\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet PHY node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin/mdio\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" s\\\" ethernet-phy\\\" device-name\"\n\t\t\t\t\" 0x10 encode-int s\\\" reg\\\" property\"\n\t\t\t\t\" my-self\"\n\t\t\t\t\" ihandle>phandle\"\n\t\t\t\" finish-device\"\n\t\t\t\" s\\\" /builtin/ethernet\\\" find-device\"\n\t\t\t\t\" encode-int\"\n\t\t\t\t\" s\\\" phy-handle\\\" property\"\n\t\t\t\" device-end\");\n\t}\n}"
  },
  {
    "function_name": "fixup_device_tree_pmac",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2462-2500",
    "snippet": "static void __init fixup_device_tree_pmac(void)\n{\n\tphandle u3, i2c, mpic;\n\tu32 u3_rev;\n\tu32 interrupts[2];\n\tu32 parent;\n\n\t/* Some G5s have a missing interrupt definition, fix it up here */\n\tu3 = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000\"));\n\tif (!PHANDLE_VALID(u3))\n\t\treturn;\n\ti2c = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/i2c@f8001000\"));\n\tif (!PHANDLE_VALID(i2c))\n\t\treturn;\n\tmpic = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/mpic@f8040000\"));\n\tif (!PHANDLE_VALID(mpic))\n\t\treturn;\n\n\t/* check if proper rev of u3 */\n\tif (prom_getprop(u3, \"device-rev\", &u3_rev, sizeof(u3_rev))\n\t    == PROM_ERROR)\n\t\treturn;\n\tif (u3_rev < 0x35 || u3_rev > 0x39)\n\t\treturn;\n\t/* does it need fixup ? */\n\tif (prom_getproplen(i2c, \"interrupts\") > 0)\n\t\treturn;\n\n\tprom_printf(\"fixing up bogus interrupts for u3 i2c...\\n\");\n\n\t/* interrupt on this revision of u3 is number 0 and level */\n\tinterrupts[0] = 0;\n\tinterrupts[1] = 1;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupts\",\n\t\t     &interrupts, sizeof(interrupts));\n\tparent = (u32)mpic;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupt-parent\",\n\t\t     &parent, sizeof(parent));\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "i2c",
            "\"/u3@0,f8000000/i2c@f8001000\"",
            "\"interrupt-parent\"",
            "&parent",
            "sizeof(parent)"
          ],
          "line": 2498
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "500-520",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"fixing up bogus interrupts for u3 i2c...\\n\""
          ],
          "line": 2490
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "i2c",
            "\"interrupts\""
          ],
          "line": 2487
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "469-472",
          "snippet": "static int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "u3",
            "\"device-rev\"",
            "&u3_rev",
            "sizeof(u3_rev)"
          ],
          "line": 2481
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "mpic"
          ],
          "line": 2477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(\"/u3@0,f8000000/mpic@f8040000\")"
          ],
          "line": 2476
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/u3@0,f8000000/mpic@f8040000\""
          ],
          "line": 2476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "i2c"
          ],
          "line": 2474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/u3@0,f8000000/i2c@f8001000\""
          ],
          "line": 2473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "u3"
          ],
          "line": 2471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/u3@0,f8000000\""
          ],
          "line": 2470
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_pmac(void)\n{\n\tphandle u3, i2c, mpic;\n\tu32 u3_rev;\n\tu32 interrupts[2];\n\tu32 parent;\n\n\t/* Some G5s have a missing interrupt definition, fix it up here */\n\tu3 = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000\"));\n\tif (!PHANDLE_VALID(u3))\n\t\treturn;\n\ti2c = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/i2c@f8001000\"));\n\tif (!PHANDLE_VALID(i2c))\n\t\treturn;\n\tmpic = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/mpic@f8040000\"));\n\tif (!PHANDLE_VALID(mpic))\n\t\treturn;\n\n\t/* check if proper rev of u3 */\n\tif (prom_getprop(u3, \"device-rev\", &u3_rev, sizeof(u3_rev))\n\t    == PROM_ERROR)\n\t\treturn;\n\tif (u3_rev < 0x35 || u3_rev > 0x39)\n\t\treturn;\n\t/* does it need fixup ? */\n\tif (prom_getproplen(i2c, \"interrupts\") > 0)\n\t\treturn;\n\n\tprom_printf(\"fixing up bogus interrupts for u3 i2c...\\n\");\n\n\t/* interrupt on this revision of u3 is number 0 and level */\n\tinterrupts[0] = 0;\n\tinterrupts[1] = 1;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupts\",\n\t\t     &interrupts, sizeof(interrupts));\n\tparent = (u32)mpic;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupt-parent\",\n\t\t     &parent, sizeof(parent));\n}"
  },
  {
    "function_name": "fixup_device_tree_chrp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2412-2456",
    "snippet": "static void __init fixup_device_tree_chrp(void)\n{\n\tphandle ph;\n\tu32 prop[6];\n\tu32 rloc = 0x01006000; /* IO space; PCI device = 12 */\n\tchar *name;\n\tint rc;\n\n\tname = \"/pci@80000000/isa@c\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(ph)) {\n\t\tname = \"/pci@ff500000/isa@6\";\n\t\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\t\trloc = 0x01003000; /* IO space; PCI device = 6 */\n\t}\n\tif (PHANDLE_VALID(ph)) {\n\t\trc = prom_getproplen(ph, \"ranges\");\n\t\tif (rc == 0 || rc == PROM_ERROR) {\n\t\t\tprom_printf(\"Fixing up missing ISA range on Pegasos...\\n\");\n\n\t\t\tprop[0] = 0x1;\n\t\t\tprop[1] = 0x0;\n\t\t\tprop[2] = rloc;\n\t\t\tprop[3] = 0x0;\n\t\t\tprop[4] = 0x0;\n\t\t\tprop[5] = 0x00010000;\n\t\t\tprom_setprop(ph, name, \"ranges\", prop, sizeof(prop));\n\t\t}\n\t}\n\n\tname = \"/pci@80000000/ide@C,1\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (PHANDLE_VALID(ph)) {\n\t\tprom_printf(\"Fixing up IDE interrupt on Pegasos...\\n\");\n\t\tprop[0] = 14;\n\t\tprop[1] = 0x0;\n\t\tprom_setprop(ph, name, \"interrupts\", prop, 2*sizeof(u32));\n\t\tprom_printf(\"Fixing up IDE class-code on Pegasos...\\n\");\n\t\trc = prom_getprop(ph, \"class-code\", prop, sizeof(u32));\n\t\tif (rc == sizeof(u32)) {\n\t\t\tprop[0] &= ~0x5;\n\t\t\tprom_setprop(ph, name, \"class-code\", prop, sizeof(u32));\n\t\t}\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "ph",
            "name",
            "\"class-code\"",
            "prop",
            "sizeof(u32)"
          ],
          "line": 2453
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "500-520",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "ph",
            "\"class-code\"",
            "prop",
            "sizeof(u32)"
          ],
          "line": 2450
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Fixing up IDE class-code on Pegasos...\\n\""
          ],
          "line": 2449
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "ph"
          ],
          "line": 2444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(name)"
          ],
          "line": 2443
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 2443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "ph",
            "\"ranges\""
          ],
          "line": 2428
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "469-472",
          "snippet": "static int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "ph"
          ],
          "line": 2427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 2424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "ph"
          ],
          "line": 2422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 2421
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_chrp(void)\n{\n\tphandle ph;\n\tu32 prop[6];\n\tu32 rloc = 0x01006000; /* IO space; PCI device = 12 */\n\tchar *name;\n\tint rc;\n\n\tname = \"/pci@80000000/isa@c\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(ph)) {\n\t\tname = \"/pci@ff500000/isa@6\";\n\t\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\t\trloc = 0x01003000; /* IO space; PCI device = 6 */\n\t}\n\tif (PHANDLE_VALID(ph)) {\n\t\trc = prom_getproplen(ph, \"ranges\");\n\t\tif (rc == 0 || rc == PROM_ERROR) {\n\t\t\tprom_printf(\"Fixing up missing ISA range on Pegasos...\\n\");\n\n\t\t\tprop[0] = 0x1;\n\t\t\tprop[1] = 0x0;\n\t\t\tprop[2] = rloc;\n\t\t\tprop[3] = 0x0;\n\t\t\tprop[4] = 0x0;\n\t\t\tprop[5] = 0x00010000;\n\t\t\tprom_setprop(ph, name, \"ranges\", prop, sizeof(prop));\n\t\t}\n\t}\n\n\tname = \"/pci@80000000/ide@C,1\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (PHANDLE_VALID(ph)) {\n\t\tprom_printf(\"Fixing up IDE interrupt on Pegasos...\\n\");\n\t\tprop[0] = 14;\n\t\tprop[1] = 0x0;\n\t\tprom_setprop(ph, name, \"interrupts\", prop, 2*sizeof(u32));\n\t\tprom_printf(\"Fixing up IDE class-code on Pegasos...\\n\");\n\t\trc = prom_getprop(ph, \"class-code\", prop, sizeof(u32));\n\t\tif (rc == sizeof(u32)) {\n\t\t\tprop[0] &= ~0x5;\n\t\t\tprom_setprop(ph, name, \"class-code\", prop, sizeof(u32));\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "fixup_device_tree_maple_memory_controller",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2368-2400",
    "snippet": "static void __init fixup_device_tree_maple_memory_controller(void)\n{\n\tphandle mc;\n\tu32 mc_reg[4];\n\tchar *name = \"/hostbridge@f8000000\";\n\tu32 ac, sc;\n\n\tmc = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(mc))\n\t\treturn;\n\n\tif (prom_getproplen(mc, \"reg\") != 8)\n\t\treturn;\n\n\tprom_getprop(prom.root, \"#address-cells\", &ac, sizeof(ac));\n\tprom_getprop(prom.root, \"#size-cells\", &sc, sizeof(sc));\n\tif ((ac != 2) || (sc != 2))\n\t\treturn;\n\n\tif (prom_getprop(mc, \"reg\", mc_reg, sizeof(mc_reg)) == PROM_ERROR)\n\t\treturn;\n\n\tif (mc_reg[0] != CPC925_MC_START || mc_reg[1] != CPC925_MC_LENGTH)\n\t\treturn;\n\n\tprom_printf(\"Fixing up bogus hostbridge on Maple...\\n\");\n\n\tmc_reg[0] = 0x0;\n\tmc_reg[1] = CPC925_MC_START;\n\tmc_reg[2] = 0x0;\n\tmc_reg[3] = CPC925_MC_LENGTH;\n\tprom_setprop(mc, name, \"reg\", mc_reg, sizeof(mc_reg));\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define CPC925_MC_LENGTH\t0x1000000",
      "#define CPC925_MC_START\t\t0xf8000000",
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "mc",
            "name",
            "\"reg\"",
            "mc_reg",
            "sizeof(mc_reg)"
          ],
          "line": 2399
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "500-520",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Fixing up bogus hostbridge on Maple...\\n\""
          ],
          "line": 2393
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "mc",
            "\"reg\"",
            "mc_reg",
            "sizeof(mc_reg)"
          ],
          "line": 2387
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "mc",
            "\"reg\""
          ],
          "line": 2379
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "469-472",
          "snippet": "static int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "mc"
          ],
          "line": 2376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(name)"
          ],
          "line": 2375
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 2375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define CPC925_MC_LENGTH\t0x1000000\n#define CPC925_MC_START\t\t0xf8000000\n#define PROM_ERROR\t\t(-1u)\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init fixup_device_tree_maple_memory_controller(void)\n{\n\tphandle mc;\n\tu32 mc_reg[4];\n\tchar *name = \"/hostbridge@f8000000\";\n\tu32 ac, sc;\n\n\tmc = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(mc))\n\t\treturn;\n\n\tif (prom_getproplen(mc, \"reg\") != 8)\n\t\treturn;\n\n\tprom_getprop(prom.root, \"#address-cells\", &ac, sizeof(ac));\n\tprom_getprop(prom.root, \"#size-cells\", &sc, sizeof(sc));\n\tif ((ac != 2) || (sc != 2))\n\t\treturn;\n\n\tif (prom_getprop(mc, \"reg\", mc_reg, sizeof(mc_reg)) == PROM_ERROR)\n\t\treturn;\n\n\tif (mc_reg[0] != CPC925_MC_START || mc_reg[1] != CPC925_MC_LENGTH)\n\t\treturn;\n\n\tprom_printf(\"Fixing up bogus hostbridge on Maple...\\n\");\n\n\tmc_reg[0] = 0x0;\n\tmc_reg[1] = CPC925_MC_START;\n\tmc_reg[2] = 0x0;\n\tmc_reg[3] = CPC925_MC_LENGTH;\n\tprom_setprop(mc, name, \"reg\", mc_reg, sizeof(mc_reg));\n}"
  },
  {
    "function_name": "fixup_device_tree_maple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2325-2363",
    "snippet": "static void __init fixup_device_tree_maple(void)\n{\n\tphandle isa;\n\tu32 rloc = 0x01002000; /* IO space; PCI device = 4 */\n\tu32 isa_ranges[6];\n\tchar *name;\n\n\tname = \"/ht@0/isa@4\";\n\tisa = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(isa)) {\n\t\tname = \"/ht@0/isa@6\";\n\t\tisa = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\t\trloc = 0x01003000; /* IO space; PCI device = 6 */\n\t}\n\tif (!PHANDLE_VALID(isa))\n\t\treturn;\n\n\tif (prom_getproplen(isa, \"ranges\") != 12)\n\t\treturn;\n\tif (prom_getprop(isa, \"ranges\", isa_ranges, sizeof(isa_ranges))\n\t\t== PROM_ERROR)\n\t\treturn;\n\n\tif (isa_ranges[0] != 0x1 ||\n\t\tisa_ranges[1] != 0xf4000000 ||\n\t\tisa_ranges[2] != 0x00010000)\n\t\treturn;\n\n\tprom_printf(\"Fixing up bogus ISA range on Maple/Apache...\\n\");\n\n\tisa_ranges[0] = 0x1;\n\tisa_ranges[1] = 0x0;\n\tisa_ranges[2] = rloc;\n\tisa_ranges[3] = 0x0;\n\tisa_ranges[4] = 0x0;\n\tisa_ranges[5] = 0x00010000;\n\tprom_setprop(isa, name, \"ranges\",\n\t\t\tisa_ranges, sizeof(isa_ranges));\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "isa",
            "name",
            "\"ranges\"",
            "isa_ranges",
            "sizeof(isa_ranges)"
          ],
          "line": 2361
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "500-520",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Fixing up bogus ISA range on Maple/Apache...\\n\""
          ],
          "line": 2353
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "isa",
            "\"ranges\"",
            "isa_ranges",
            "sizeof(isa_ranges)"
          ],
          "line": 2344
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "isa",
            "\"ranges\""
          ],
          "line": 2342
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "469-472",
          "snippet": "static int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "isa"
          ],
          "line": 2339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(name)"
          ],
          "line": 2336
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 2336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "isa"
          ],
          "line": 2334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 2333
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_maple(void)\n{\n\tphandle isa;\n\tu32 rloc = 0x01002000; /* IO space; PCI device = 4 */\n\tu32 isa_ranges[6];\n\tchar *name;\n\n\tname = \"/ht@0/isa@4\";\n\tisa = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(isa)) {\n\t\tname = \"/ht@0/isa@6\";\n\t\tisa = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\t\trloc = 0x01003000; /* IO space; PCI device = 6 */\n\t}\n\tif (!PHANDLE_VALID(isa))\n\t\treturn;\n\n\tif (prom_getproplen(isa, \"ranges\") != 12)\n\t\treturn;\n\tif (prom_getprop(isa, \"ranges\", isa_ranges, sizeof(isa_ranges))\n\t\t== PROM_ERROR)\n\t\treturn;\n\n\tif (isa_ranges[0] != 0x1 ||\n\t\tisa_ranges[1] != 0xf4000000 ||\n\t\tisa_ranges[2] != 0x00010000)\n\t\treturn;\n\n\tprom_printf(\"Fixing up bogus ISA range on Maple/Apache...\\n\");\n\n\tisa_ranges[0] = 0x1;\n\tisa_ranges[1] = 0x0;\n\tisa_ranges[2] = rloc;\n\tisa_ranges[3] = 0x0;\n\tisa_ranges[4] = 0x0;\n\tisa_ranges[5] = 0x00010000;\n\tprom_setprop(isa, name, \"ranges\",\n\t\t\tisa_ranges, sizeof(isa_ranges));\n}"
  },
  {
    "function_name": "flatten_device_tree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2228-2320",
    "snippet": "static void __init flatten_device_tree(void)\n{\n\tphandle root;\n\tunsigned long mem_start, mem_end, room;\n\tstruct boot_param_header *hdr;\n\tchar *namep;\n\tu64 *rsvmap;\n\n\t/*\n\t * Check how much room we have between alloc top & bottom (+/- a\n\t * few pages), crop to 1MB, as this is our \"chunk\" size\n\t */\n\troom = alloc_top - alloc_bottom - 0x4000;\n\tif (room > DEVTREE_CHUNK_SIZE)\n\t\troom = DEVTREE_CHUNK_SIZE;\n\tprom_debug(\"starting device tree allocs at %x\\n\", alloc_bottom);\n\n\t/* Now try to claim that */\n\tmem_start = (unsigned long)alloc_up(room, PAGE_SIZE);\n\tif (mem_start == 0)\n\t\tprom_panic(\"Can't allocate initial device-tree chunk\\n\");\n\tmem_end = mem_start + room;\n\n\t/* Get root of tree */\n\troot = call_prom(\"peer\", 1, 1, (phandle)0);\n\tif (root == (phandle)0)\n\t\tprom_panic (\"couldn't get device tree root\\n\");\n\n\t/* Build header and make room for mem rsv map */ \n\tmem_start = _ALIGN(mem_start, 4);\n\thdr = make_room(&mem_start, &mem_end,\n\t\t\tsizeof(struct boot_param_header), 4);\n\tdt_header_start = (unsigned long)hdr;\n\trsvmap = make_room(&mem_start, &mem_end, sizeof(mem_reserve_map), 8);\n\n\t/* Start of strings */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_string_start = mem_start;\n\tmem_start += 4; /* hole */\n\n\t/* Add \"linux,phandle\" in there, we'll need it */\n\tnamep = make_room(&mem_start, &mem_end, 16, 1);\n\tstrcpy(namep, \"linux,phandle\");\n\tmem_start = (unsigned long)namep + strlen(namep) + 1;\n\n\t/* Build string array */\n\tprom_printf(\"Building dt strings...\\n\"); \n\tscan_dt_build_strings(root, &mem_start, &mem_end);\n\tdt_string_end = mem_start;\n\n\t/* Build structure */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_struct_start = mem_start;\n\tprom_printf(\"Building dt structure...\\n\"); \n\tscan_dt_build_struct(root, &mem_start, &mem_end);\n\tdt_push_token(OF_DT_END, &mem_start, &mem_end);\n\tdt_struct_end = PAGE_ALIGN(mem_start);\n\n\t/* Finish header */\n\thdr->boot_cpuid_phys = cpu_to_be32(prom.cpu);\n\thdr->magic = cpu_to_be32(OF_DT_HEADER);\n\thdr->totalsize = cpu_to_be32(dt_struct_end - dt_header_start);\n\thdr->off_dt_struct = cpu_to_be32(dt_struct_start - dt_header_start);\n\thdr->off_dt_strings = cpu_to_be32(dt_string_start - dt_header_start);\n\thdr->dt_strings_size = cpu_to_be32(dt_string_end - dt_string_start);\n\thdr->off_mem_rsvmap = cpu_to_be32(((unsigned long)rsvmap) - dt_header_start);\n\thdr->version = cpu_to_be32(OF_DT_VERSION);\n\t/* Version 16 is not backward compatible */\n\thdr->last_comp_version = cpu_to_be32(0x10);\n\n\t/* Copy the reserve map in */\n\tmemcpy(rsvmap, mem_reserve_map, sizeof(mem_reserve_map));\n\n#ifdef DEBUG_PROM\n\t{\n\t\tint i;\n\t\tprom_printf(\"reserved memory map:\\n\");\n\t\tfor (i = 0; i < mem_reserve_cnt; i++)\n\t\t\tprom_printf(\"  %x - %x\\n\",\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].base),\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].size));\n\t}\n#endif\n\t/* Bump mem_reserve_cnt to cause further reservations to fail\n\t * since it's too late.\n\t */\n\tmem_reserve_cnt = MEM_RESERVE_MAP_SIZE;\n\n\tprom_printf(\"Device tree strings 0x%x -> 0x%x\\n\",\n\t\t    dt_string_start, dt_string_end);\n\tprom_printf(\"Device tree struct  0x%x -> 0x%x\\n\",\n\t\t    dt_struct_start, dt_struct_end);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define MEM_RESERVE_MAP_SIZE\t8",
      "#define DEVTREE_CHUNK_SIZE\t0x100000"
    ],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static unsigned long __initdata dt_header_start;",
      "static unsigned long __initdata dt_struct_start, dt_struct_end;",
      "static unsigned long __initdata dt_string_start, dt_string_end;",
      "static unsigned long __initdata alloc_top;",
      "static unsigned long __initdata alloc_bottom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Device tree struct  0x%x -> 0x%x\\n\"",
            "dt_struct_start",
            "dt_struct_end"
          ],
          "line": 2318
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "mem_reserve_map[i].size"
          ],
          "line": 2308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "mem_reserve_map[i].base"
          ],
          "line": 2307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "rsvmap",
            "mem_reserve_map",
            "sizeof(mem_reserve_map)"
          ],
          "line": 2299
        },
        "resolved": true,
        "details": {
          "function_name": "_memcpy_toio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/io.c",
          "lines": "185-209",
          "snippet": "void _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0x10"
          ],
          "line": 2296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "OF_DT_VERSION"
          ],
          "line": 2294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "((unsigned long)rsvmap) - dt_header_start"
          ],
          "line": 2293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "dt_string_end - dt_string_start"
          ],
          "line": 2292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "dt_string_start - dt_header_start"
          ],
          "line": 2291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "dt_struct_start - dt_header_start"
          ],
          "line": 2290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "dt_struct_end - dt_header_start"
          ],
          "line": 2289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "OF_DT_HEADER"
          ],
          "line": 2288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "prom.cpu"
          ],
          "line": 2287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PAGE_ALIGN",
          "args": [
            "mem_start"
          ],
          "line": 2284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "OF_DT_END",
            "&mem_start",
            "&mem_end"
          ],
          "line": 2283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scan_dt_build_struct",
          "args": [
            "root",
            "&mem_start",
            "&mem_end"
          ],
          "line": 2282
        },
        "resolved": true,
        "details": {
          "function_name": "scan_dt_build_struct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2111-2226",
          "snippet": "static void __init scan_dt_build_struct(phandle node, unsigned long *mem_start,\n\t\t\t\t\tunsigned long *mem_end)\n{\n\tphandle child;\n\tchar *namep, *prev_name, *sstart, *p, *ep, *lp, *path;\n\tunsigned long soff;\n\tunsigned char *valp;\n\tstatic char pname[MAX_PROPERTY_NAME];\n\tint l, room, has_phandle = 0;\n\n\tdt_push_token(OF_DT_BEGIN_NODE, mem_start, mem_end);\n\n\t/* get the node's full name */\n\tnamep = (char *)*mem_start;\n\troom = *mem_end - *mem_start;\n\tif (room > 255)\n\t\troom = 255;\n\tl = call_prom(\"package-to-path\", 3, 1, node, namep, room);\n\tif (l >= 0) {\n\t\t/* Didn't fit?  Get more room. */\n\t\tif (l >= room) {\n\t\t\tif (l >= *mem_end - *mem_start)\n\t\t\t\tnamep = make_room(mem_start, mem_end, l+1, 1);\n\t\t\tcall_prom(\"package-to-path\", 3, 1, node, namep, l);\n\t\t}\n\t\tnamep[l] = '\\0';\n\n\t\t/* Fixup an Apple bug where they have bogus \\0 chars in the\n\t\t * middle of the path in some properties, and extract\n\t\t * the unit name (everything after the last '/').\n\t\t */\n\t\tfor (lp = p = namep, ep = namep + l; p < ep; p++) {\n\t\t\tif (*p == '/')\n\t\t\t\tlp = namep;\n\t\t\telse if (*p != 0)\n\t\t\t\t*lp++ = *p;\n\t\t}\n\t\t*lp = 0;\n\t\t*mem_start = _ALIGN((unsigned long)lp + 1, 4);\n\t}\n\n\t/* get it again for debugging */\n\tpath = prom_scratch;\n\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\tcall_prom(\"package-to-path\", 3, 1, node, path, PROM_SCRATCH_SIZE-1);\n\n\t/* get and store all properties */\n\tprev_name = \"\";\n\tsstart = (char *)dt_string_start;\n\tfor (;;) {\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name,\n\t\t\t      pname) != 1)\n\t\t\tbreak;\n\n \t\t/* skip \"name\" */\n \t\tif (strcmp(pname, \"name\") == 0) {\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\n\t\t/* find string offset */\n\t\tsoff = dt_find_string(pname);\n\t\tif (soff == 0) {\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <%s>, node %s\\n\", pname, path);\n\t\t\tbreak;\n\t\t}\n\t\tprev_name = sstart + soff;\n\n\t\t/* get length */\n\t\tl = call_prom(\"getproplen\", 2, 1, node, pname);\n\n\t\t/* sanity checks */\n\t\tif (l == PROM_ERROR)\n\t\t\tcontinue;\n\n\t\t/* push property head */\n\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\tdt_push_token(l, mem_start, mem_end);\n\t\tdt_push_token(soff, mem_start, mem_end);\n\n\t\t/* push property content */\n\t\tvalp = make_room(mem_start, mem_end, l, 4);\n\t\tcall_prom(\"getprop\", 4, 1, node, pname, valp, l);\n\t\t*mem_start = _ALIGN(*mem_start, 4);\n\n\t\tif (!strcmp(pname, \"phandle\"))\n\t\t\thas_phandle = 1;\n\t}\n\n\t/* Add a \"linux,phandle\" property if no \"phandle\" property already\n\t * existed (can happen with OPAL)\n\t */\n\tif (!has_phandle) {\n\t\tsoff = dt_find_string(\"linux,phandle\");\n\t\tif (soff == 0)\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <linux-phandle> node %s\\n\", path);\n\t\telse {\n\t\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\t\tdt_push_token(4, mem_start, mem_end);\n\t\t\tdt_push_token(soff, mem_start, mem_end);\n\t\t\tvalp = make_room(mem_start, mem_end, 4, 4);\n\t\t\t*(__be32 *)valp = cpu_to_be32(node);\n\t\t}\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_struct(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n\n\tdt_push_token(OF_DT_END_NODE, mem_start, mem_end);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MAX_PROPERTY_NAME 64",
            "#define PROM_ERROR\t\t(-1u)",
            "#define PROM_SCRATCH_SIZE 256"
          ],
          "globals_used": [
            "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MAX_PROPERTY_NAME 64\n#define PROM_ERROR\t\t(-1u)\n#define PROM_SCRATCH_SIZE 256\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\nstatic void __init;\n\nstatic void __init scan_dt_build_struct(phandle node, unsigned long *mem_start,\n\t\t\t\t\tunsigned long *mem_end)\n{\n\tphandle child;\n\tchar *namep, *prev_name, *sstart, *p, *ep, *lp, *path;\n\tunsigned long soff;\n\tunsigned char *valp;\n\tstatic char pname[MAX_PROPERTY_NAME];\n\tint l, room, has_phandle = 0;\n\n\tdt_push_token(OF_DT_BEGIN_NODE, mem_start, mem_end);\n\n\t/* get the node's full name */\n\tnamep = (char *)*mem_start;\n\troom = *mem_end - *mem_start;\n\tif (room > 255)\n\t\troom = 255;\n\tl = call_prom(\"package-to-path\", 3, 1, node, namep, room);\n\tif (l >= 0) {\n\t\t/* Didn't fit?  Get more room. */\n\t\tif (l >= room) {\n\t\t\tif (l >= *mem_end - *mem_start)\n\t\t\t\tnamep = make_room(mem_start, mem_end, l+1, 1);\n\t\t\tcall_prom(\"package-to-path\", 3, 1, node, namep, l);\n\t\t}\n\t\tnamep[l] = '\\0';\n\n\t\t/* Fixup an Apple bug where they have bogus \\0 chars in the\n\t\t * middle of the path in some properties, and extract\n\t\t * the unit name (everything after the last '/').\n\t\t */\n\t\tfor (lp = p = namep, ep = namep + l; p < ep; p++) {\n\t\t\tif (*p == '/')\n\t\t\t\tlp = namep;\n\t\t\telse if (*p != 0)\n\t\t\t\t*lp++ = *p;\n\t\t}\n\t\t*lp = 0;\n\t\t*mem_start = _ALIGN((unsigned long)lp + 1, 4);\n\t}\n\n\t/* get it again for debugging */\n\tpath = prom_scratch;\n\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\tcall_prom(\"package-to-path\", 3, 1, node, path, PROM_SCRATCH_SIZE-1);\n\n\t/* get and store all properties */\n\tprev_name = \"\";\n\tsstart = (char *)dt_string_start;\n\tfor (;;) {\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name,\n\t\t\t      pname) != 1)\n\t\t\tbreak;\n\n \t\t/* skip \"name\" */\n \t\tif (strcmp(pname, \"name\") == 0) {\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\n\t\t/* find string offset */\n\t\tsoff = dt_find_string(pname);\n\t\tif (soff == 0) {\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <%s>, node %s\\n\", pname, path);\n\t\t\tbreak;\n\t\t}\n\t\tprev_name = sstart + soff;\n\n\t\t/* get length */\n\t\tl = call_prom(\"getproplen\", 2, 1, node, pname);\n\n\t\t/* sanity checks */\n\t\tif (l == PROM_ERROR)\n\t\t\tcontinue;\n\n\t\t/* push property head */\n\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\tdt_push_token(l, mem_start, mem_end);\n\t\tdt_push_token(soff, mem_start, mem_end);\n\n\t\t/* push property content */\n\t\tvalp = make_room(mem_start, mem_end, l, 4);\n\t\tcall_prom(\"getprop\", 4, 1, node, pname, valp, l);\n\t\t*mem_start = _ALIGN(*mem_start, 4);\n\n\t\tif (!strcmp(pname, \"phandle\"))\n\t\t\thas_phandle = 1;\n\t}\n\n\t/* Add a \"linux,phandle\" property if no \"phandle\" property already\n\t * existed (can happen with OPAL)\n\t */\n\tif (!has_phandle) {\n\t\tsoff = dt_find_string(\"linux,phandle\");\n\t\tif (soff == 0)\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <linux-phandle> node %s\\n\", path);\n\t\telse {\n\t\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\t\tdt_push_token(4, mem_start, mem_end);\n\t\t\tdt_push_token(soff, mem_start, mem_end);\n\t\t\tvalp = make_room(mem_start, mem_end, 4, 4);\n\t\t\t*(__be32 *)valp = cpu_to_be32(node);\n\t\t}\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_struct(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n\n\tdt_push_token(OF_DT_END_NODE, mem_start, mem_end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PAGE_ALIGN",
          "args": [
            "mem_start"
          ],
          "line": 2279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scan_dt_build_strings",
          "args": [
            "root",
            "&mem_start",
            "&mem_end"
          ],
          "line": 2275
        },
        "resolved": true,
        "details": {
          "function_name": "scan_dt_build_strings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2063-2109",
          "snippet": "static void __init scan_dt_build_strings(phandle node,\n\t\t\t\t\t unsigned long *mem_start,\n\t\t\t\t\t unsigned long *mem_end)\n{\n\tchar *prev_name, *namep, *sstart;\n\tunsigned long soff;\n\tphandle child;\n\n\tsstart =  (char *)dt_string_start;\n\n\t/* get and store all property names */\n\tprev_name = \"\";\n\tfor (;;) {\n\t\t/* 64 is max len of name including nul. */\n\t\tnamep = make_room(mem_start, mem_end, MAX_PROPERTY_NAME, 1);\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name, namep) != 1) {\n\t\t\t/* No more nodes: unwind alloc */\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tbreak;\n\t\t}\n\n \t\t/* skip \"name\" */\n \t\tif (strcmp(namep, \"name\") == 0) {\n \t\t\t*mem_start = (unsigned long)namep;\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\t\t/* get/create string entry */\n\t\tsoff = dt_find_string(namep);\n\t\tif (soff != 0) {\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tnamep = sstart + soff;\n\t\t} else {\n\t\t\t/* Trim off some if we can */\n\t\t\t*mem_start = (unsigned long)namep + strlen(namep) + 1;\n\t\t\tdt_string_end = *mem_start;\n\t\t}\n\t\tprev_name = namep;\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_strings(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MAX_PROPERTY_NAME 64"
          ],
          "globals_used": [
            "static unsigned long __initdata dt_string_start, dt_string_end;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MAX_PROPERTY_NAME 64\n\nstatic unsigned long __initdata dt_string_start, dt_string_end;\nstatic void __init;\n\nstatic void __init scan_dt_build_strings(phandle node,\n\t\t\t\t\t unsigned long *mem_start,\n\t\t\t\t\t unsigned long *mem_end)\n{\n\tchar *prev_name, *namep, *sstart;\n\tunsigned long soff;\n\tphandle child;\n\n\tsstart =  (char *)dt_string_start;\n\n\t/* get and store all property names */\n\tprev_name = \"\";\n\tfor (;;) {\n\t\t/* 64 is max len of name including nul. */\n\t\tnamep = make_room(mem_start, mem_end, MAX_PROPERTY_NAME, 1);\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name, namep) != 1) {\n\t\t\t/* No more nodes: unwind alloc */\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tbreak;\n\t\t}\n\n \t\t/* skip \"name\" */\n \t\tif (strcmp(namep, \"name\") == 0) {\n \t\t\t*mem_start = (unsigned long)namep;\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\t\t/* get/create string entry */\n\t\tsoff = dt_find_string(namep);\n\t\tif (soff != 0) {\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tnamep = sstart + soff;\n\t\t} else {\n\t\t\t/* Trim off some if we can */\n\t\t\t*mem_start = (unsigned long)namep + strlen(namep) + 1;\n\t\t\tdt_string_end = *mem_start;\n\t\t}\n\t\tprev_name = namep;\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_strings(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "namep"
          ],
          "line": 2271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "namep",
            "\"linux,phandle\""
          ],
          "line": 2270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_room",
          "args": [
            "&mem_start",
            "&mem_end",
            "16",
            "1"
          ],
          "line": 2269
        },
        "resolved": true,
        "details": {
          "function_name": "make_room",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2008-2036",
          "snippet": "static void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = _ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %x...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define DEVTREE_CHUNK_SIZE\t0x100000"
          ],
          "globals_used": [
            "static unsigned long __initdata alloc_top;",
            "static unsigned long __initdata alloc_bottom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define DEVTREE_CHUNK_SIZE\t0x100000\n\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_bottom;\nstatic void __init;\n\nstatic void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = _ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %x...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PAGE_ALIGN",
          "args": [
            "mem_start"
          ],
          "line": 2264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ALIGN",
          "args": [
            "mem_start",
            "4"
          ],
          "line": 2257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"couldn't get device tree root\\n\""
          ],
          "line": 2254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"peer\"",
            "1",
            "1",
            "(phandle)0"
          ],
          "line": 2252
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"Can't allocate initial device-tree chunk\\n\""
          ],
          "line": 2248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_up",
          "args": [
            "room",
            "PAGE_SIZE"
          ],
          "line": 2246
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_up",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "976-1014",
          "snippet": "static unsigned long __init alloc_up(unsigned long size, unsigned long align)\n{\n\tunsigned long base = alloc_bottom;\n\tunsigned long addr = 0;\n\n\tif (align)\n\t\tbase = _ALIGN_UP(base, align);\n\tprom_debug(\"alloc_up(%x, %x)\\n\", size, align);\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_up() called with mem not initialized\\n\");\n\n\tif (align)\n\t\tbase = _ALIGN_UP(alloc_bottom, align);\n\telse\n\t\tbase = alloc_bottom;\n\n\tfor(; (base + size) <= alloc_top; \n\t    base = _ALIGN_UP(base + 0x100000, align)) {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t\tif (align == 0)\n\t\t\tbreak;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_bottom = addr + size;\n\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __initdata alloc_top;",
            "static unsigned long __initdata alloc_top_high;",
            "static unsigned long __initdata alloc_bottom;",
            "static unsigned long __initdata rmo_top;",
            "static unsigned long __initdata ram_top;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_top_high;\nstatic unsigned long __initdata alloc_bottom;\nstatic unsigned long __initdata rmo_top;\nstatic unsigned long __initdata ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_up(unsigned long size, unsigned long align)\n{\n\tunsigned long base = alloc_bottom;\n\tunsigned long addr = 0;\n\n\tif (align)\n\t\tbase = _ALIGN_UP(base, align);\n\tprom_debug(\"alloc_up(%x, %x)\\n\", size, align);\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_up() called with mem not initialized\\n\");\n\n\tif (align)\n\t\tbase = _ALIGN_UP(alloc_bottom, align);\n\telse\n\t\tbase = alloc_bottom;\n\n\tfor(; (base + size) <= alloc_top; \n\t    base = _ALIGN_UP(base + 0x100000, align)) {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t\tif (align == 0)\n\t\t\tbreak;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_bottom = addr + size;\n\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"starting device tree allocs at %x\\n\"",
            "alloc_bottom"
          ],
          "line": 2243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n#define DEVTREE_CHUNK_SIZE\t0x100000\n\nstatic struct prom_t __initdata prom;\nstatic unsigned long __initdata dt_header_start;\nstatic unsigned long __initdata dt_struct_start, dt_struct_end;\nstatic unsigned long __initdata dt_string_start, dt_string_end;\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_bottom;\nstatic void __init;\n\nstatic void __init flatten_device_tree(void)\n{\n\tphandle root;\n\tunsigned long mem_start, mem_end, room;\n\tstruct boot_param_header *hdr;\n\tchar *namep;\n\tu64 *rsvmap;\n\n\t/*\n\t * Check how much room we have between alloc top & bottom (+/- a\n\t * few pages), crop to 1MB, as this is our \"chunk\" size\n\t */\n\troom = alloc_top - alloc_bottom - 0x4000;\n\tif (room > DEVTREE_CHUNK_SIZE)\n\t\troom = DEVTREE_CHUNK_SIZE;\n\tprom_debug(\"starting device tree allocs at %x\\n\", alloc_bottom);\n\n\t/* Now try to claim that */\n\tmem_start = (unsigned long)alloc_up(room, PAGE_SIZE);\n\tif (mem_start == 0)\n\t\tprom_panic(\"Can't allocate initial device-tree chunk\\n\");\n\tmem_end = mem_start + room;\n\n\t/* Get root of tree */\n\troot = call_prom(\"peer\", 1, 1, (phandle)0);\n\tif (root == (phandle)0)\n\t\tprom_panic (\"couldn't get device tree root\\n\");\n\n\t/* Build header and make room for mem rsv map */ \n\tmem_start = _ALIGN(mem_start, 4);\n\thdr = make_room(&mem_start, &mem_end,\n\t\t\tsizeof(struct boot_param_header), 4);\n\tdt_header_start = (unsigned long)hdr;\n\trsvmap = make_room(&mem_start, &mem_end, sizeof(mem_reserve_map), 8);\n\n\t/* Start of strings */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_string_start = mem_start;\n\tmem_start += 4; /* hole */\n\n\t/* Add \"linux,phandle\" in there, we'll need it */\n\tnamep = make_room(&mem_start, &mem_end, 16, 1);\n\tstrcpy(namep, \"linux,phandle\");\n\tmem_start = (unsigned long)namep + strlen(namep) + 1;\n\n\t/* Build string array */\n\tprom_printf(\"Building dt strings...\\n\"); \n\tscan_dt_build_strings(root, &mem_start, &mem_end);\n\tdt_string_end = mem_start;\n\n\t/* Build structure */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_struct_start = mem_start;\n\tprom_printf(\"Building dt structure...\\n\"); \n\tscan_dt_build_struct(root, &mem_start, &mem_end);\n\tdt_push_token(OF_DT_END, &mem_start, &mem_end);\n\tdt_struct_end = PAGE_ALIGN(mem_start);\n\n\t/* Finish header */\n\thdr->boot_cpuid_phys = cpu_to_be32(prom.cpu);\n\thdr->magic = cpu_to_be32(OF_DT_HEADER);\n\thdr->totalsize = cpu_to_be32(dt_struct_end - dt_header_start);\n\thdr->off_dt_struct = cpu_to_be32(dt_struct_start - dt_header_start);\n\thdr->off_dt_strings = cpu_to_be32(dt_string_start - dt_header_start);\n\thdr->dt_strings_size = cpu_to_be32(dt_string_end - dt_string_start);\n\thdr->off_mem_rsvmap = cpu_to_be32(((unsigned long)rsvmap) - dt_header_start);\n\thdr->version = cpu_to_be32(OF_DT_VERSION);\n\t/* Version 16 is not backward compatible */\n\thdr->last_comp_version = cpu_to_be32(0x10);\n\n\t/* Copy the reserve map in */\n\tmemcpy(rsvmap, mem_reserve_map, sizeof(mem_reserve_map));\n\n#ifdef DEBUG_PROM\n\t{\n\t\tint i;\n\t\tprom_printf(\"reserved memory map:\\n\");\n\t\tfor (i = 0; i < mem_reserve_cnt; i++)\n\t\t\tprom_printf(\"  %x - %x\\n\",\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].base),\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].size));\n\t}\n#endif\n\t/* Bump mem_reserve_cnt to cause further reservations to fail\n\t * since it's too late.\n\t */\n\tmem_reserve_cnt = MEM_RESERVE_MAP_SIZE;\n\n\tprom_printf(\"Device tree strings 0x%x -> 0x%x\\n\",\n\t\t    dt_string_start, dt_string_end);\n\tprom_printf(\"Device tree struct  0x%x -> 0x%x\\n\",\n\t\t    dt_struct_start, dt_struct_end);\n}"
  },
  {
    "function_name": "scan_dt_build_struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2111-2226",
    "snippet": "static void __init scan_dt_build_struct(phandle node, unsigned long *mem_start,\n\t\t\t\t\tunsigned long *mem_end)\n{\n\tphandle child;\n\tchar *namep, *prev_name, *sstart, *p, *ep, *lp, *path;\n\tunsigned long soff;\n\tunsigned char *valp;\n\tstatic char pname[MAX_PROPERTY_NAME];\n\tint l, room, has_phandle = 0;\n\n\tdt_push_token(OF_DT_BEGIN_NODE, mem_start, mem_end);\n\n\t/* get the node's full name */\n\tnamep = (char *)*mem_start;\n\troom = *mem_end - *mem_start;\n\tif (room > 255)\n\t\troom = 255;\n\tl = call_prom(\"package-to-path\", 3, 1, node, namep, room);\n\tif (l >= 0) {\n\t\t/* Didn't fit?  Get more room. */\n\t\tif (l >= room) {\n\t\t\tif (l >= *mem_end - *mem_start)\n\t\t\t\tnamep = make_room(mem_start, mem_end, l+1, 1);\n\t\t\tcall_prom(\"package-to-path\", 3, 1, node, namep, l);\n\t\t}\n\t\tnamep[l] = '\\0';\n\n\t\t/* Fixup an Apple bug where they have bogus \\0 chars in the\n\t\t * middle of the path in some properties, and extract\n\t\t * the unit name (everything after the last '/').\n\t\t */\n\t\tfor (lp = p = namep, ep = namep + l; p < ep; p++) {\n\t\t\tif (*p == '/')\n\t\t\t\tlp = namep;\n\t\t\telse if (*p != 0)\n\t\t\t\t*lp++ = *p;\n\t\t}\n\t\t*lp = 0;\n\t\t*mem_start = _ALIGN((unsigned long)lp + 1, 4);\n\t}\n\n\t/* get it again for debugging */\n\tpath = prom_scratch;\n\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\tcall_prom(\"package-to-path\", 3, 1, node, path, PROM_SCRATCH_SIZE-1);\n\n\t/* get and store all properties */\n\tprev_name = \"\";\n\tsstart = (char *)dt_string_start;\n\tfor (;;) {\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name,\n\t\t\t      pname) != 1)\n\t\t\tbreak;\n\n \t\t/* skip \"name\" */\n \t\tif (strcmp(pname, \"name\") == 0) {\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\n\t\t/* find string offset */\n\t\tsoff = dt_find_string(pname);\n\t\tif (soff == 0) {\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <%s>, node %s\\n\", pname, path);\n\t\t\tbreak;\n\t\t}\n\t\tprev_name = sstart + soff;\n\n\t\t/* get length */\n\t\tl = call_prom(\"getproplen\", 2, 1, node, pname);\n\n\t\t/* sanity checks */\n\t\tif (l == PROM_ERROR)\n\t\t\tcontinue;\n\n\t\t/* push property head */\n\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\tdt_push_token(l, mem_start, mem_end);\n\t\tdt_push_token(soff, mem_start, mem_end);\n\n\t\t/* push property content */\n\t\tvalp = make_room(mem_start, mem_end, l, 4);\n\t\tcall_prom(\"getprop\", 4, 1, node, pname, valp, l);\n\t\t*mem_start = _ALIGN(*mem_start, 4);\n\n\t\tif (!strcmp(pname, \"phandle\"))\n\t\t\thas_phandle = 1;\n\t}\n\n\t/* Add a \"linux,phandle\" property if no \"phandle\" property already\n\t * existed (can happen with OPAL)\n\t */\n\tif (!has_phandle) {\n\t\tsoff = dt_find_string(\"linux,phandle\");\n\t\tif (soff == 0)\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <linux-phandle> node %s\\n\", path);\n\t\telse {\n\t\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\t\tdt_push_token(4, mem_start, mem_end);\n\t\t\tdt_push_token(soff, mem_start, mem_end);\n\t\t\tvalp = make_room(mem_start, mem_end, 4, 4);\n\t\t\t*(__be32 *)valp = cpu_to_be32(node);\n\t\t}\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_struct(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n\n\tdt_push_token(OF_DT_END_NODE, mem_start, mem_end);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define MAX_PROPERTY_NAME 64",
      "#define PROM_ERROR\t\t(-1u)",
      "#define PROM_SCRATCH_SIZE 256"
    ],
    "globals_used": [
      "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "OF_DT_END_NODE",
            "mem_start",
            "mem_end"
          ],
          "line": 2225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"peer\"",
            "1",
            "1",
            "child"
          ],
          "line": 2222
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "scan_dt_build_struct",
          "args": [
            "child",
            "mem_start",
            "mem_end"
          ],
          "line": 2221
        },
        "resolved": true,
        "details": {
          "function_name": "scan_dt_build_struct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2111-2226",
          "snippet": "static void __init scan_dt_build_struct(phandle node, unsigned long *mem_start,\n\t\t\t\t\tunsigned long *mem_end)\n{\n\tphandle child;\n\tchar *namep, *prev_name, *sstart, *p, *ep, *lp, *path;\n\tunsigned long soff;\n\tunsigned char *valp;\n\tstatic char pname[MAX_PROPERTY_NAME];\n\tint l, room, has_phandle = 0;\n\n\tdt_push_token(OF_DT_BEGIN_NODE, mem_start, mem_end);\n\n\t/* get the node's full name */\n\tnamep = (char *)*mem_start;\n\troom = *mem_end - *mem_start;\n\tif (room > 255)\n\t\troom = 255;\n\tl = call_prom(\"package-to-path\", 3, 1, node, namep, room);\n\tif (l >= 0) {\n\t\t/* Didn't fit?  Get more room. */\n\t\tif (l >= room) {\n\t\t\tif (l >= *mem_end - *mem_start)\n\t\t\t\tnamep = make_room(mem_start, mem_end, l+1, 1);\n\t\t\tcall_prom(\"package-to-path\", 3, 1, node, namep, l);\n\t\t}\n\t\tnamep[l] = '\\0';\n\n\t\t/* Fixup an Apple bug where they have bogus \\0 chars in the\n\t\t * middle of the path in some properties, and extract\n\t\t * the unit name (everything after the last '/').\n\t\t */\n\t\tfor (lp = p = namep, ep = namep + l; p < ep; p++) {\n\t\t\tif (*p == '/')\n\t\t\t\tlp = namep;\n\t\t\telse if (*p != 0)\n\t\t\t\t*lp++ = *p;\n\t\t}\n\t\t*lp = 0;\n\t\t*mem_start = _ALIGN((unsigned long)lp + 1, 4);\n\t}\n\n\t/* get it again for debugging */\n\tpath = prom_scratch;\n\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\tcall_prom(\"package-to-path\", 3, 1, node, path, PROM_SCRATCH_SIZE-1);\n\n\t/* get and store all properties */\n\tprev_name = \"\";\n\tsstart = (char *)dt_string_start;\n\tfor (;;) {\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name,\n\t\t\t      pname) != 1)\n\t\t\tbreak;\n\n \t\t/* skip \"name\" */\n \t\tif (strcmp(pname, \"name\") == 0) {\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\n\t\t/* find string offset */\n\t\tsoff = dt_find_string(pname);\n\t\tif (soff == 0) {\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <%s>, node %s\\n\", pname, path);\n\t\t\tbreak;\n\t\t}\n\t\tprev_name = sstart + soff;\n\n\t\t/* get length */\n\t\tl = call_prom(\"getproplen\", 2, 1, node, pname);\n\n\t\t/* sanity checks */\n\t\tif (l == PROM_ERROR)\n\t\t\tcontinue;\n\n\t\t/* push property head */\n\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\tdt_push_token(l, mem_start, mem_end);\n\t\tdt_push_token(soff, mem_start, mem_end);\n\n\t\t/* push property content */\n\t\tvalp = make_room(mem_start, mem_end, l, 4);\n\t\tcall_prom(\"getprop\", 4, 1, node, pname, valp, l);\n\t\t*mem_start = _ALIGN(*mem_start, 4);\n\n\t\tif (!strcmp(pname, \"phandle\"))\n\t\t\thas_phandle = 1;\n\t}\n\n\t/* Add a \"linux,phandle\" property if no \"phandle\" property already\n\t * existed (can happen with OPAL)\n\t */\n\tif (!has_phandle) {\n\t\tsoff = dt_find_string(\"linux,phandle\");\n\t\tif (soff == 0)\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <linux-phandle> node %s\\n\", path);\n\t\telse {\n\t\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\t\tdt_push_token(4, mem_start, mem_end);\n\t\t\tdt_push_token(soff, mem_start, mem_end);\n\t\t\tvalp = make_room(mem_start, mem_end, 4, 4);\n\t\t\t*(__be32 *)valp = cpu_to_be32(node);\n\t\t}\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_struct(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n\n\tdt_push_token(OF_DT_END_NODE, mem_start, mem_end);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "node"
          ],
          "line": 2214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_room",
          "args": [
            "mem_start",
            "mem_end",
            "4",
            "4"
          ],
          "line": 2213
        },
        "resolved": true,
        "details": {
          "function_name": "make_room",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2008-2036",
          "snippet": "static void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = _ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %x...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define DEVTREE_CHUNK_SIZE\t0x100000"
          ],
          "globals_used": [
            "static unsigned long __initdata alloc_top;",
            "static unsigned long __initdata alloc_bottom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define DEVTREE_CHUNK_SIZE\t0x100000\n\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_bottom;\nstatic void __init;\n\nstatic void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = _ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %x...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "soff",
            "mem_start",
            "mem_end"
          ],
          "line": 2212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "4",
            "mem_start",
            "mem_end"
          ],
          "line": 2211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "OF_DT_PROP",
            "mem_start",
            "mem_end"
          ],
          "line": 2210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <linux-phandle> node %s\\n\"",
            "path"
          ],
          "line": 2207
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dt_find_string",
          "args": [
            "\"linux,phandle\""
          ],
          "line": 2205
        },
        "resolved": true,
        "details": {
          "function_name": "dt_find_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2043-2055",
          "snippet": "static unsigned long __init dt_find_string(char *str)\n{\n\tchar *s, *os;\n\n\ts = os = (char *)dt_string_start;\n\ts += 4;\n\twhile (s <  (char *)dt_string_end) {\n\t\tif (strcmp(s, str) == 0)\n\t\t\treturn s - os;\n\t\ts += strlen(s) + 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long __initdata dt_string_start, dt_string_end;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long __initdata dt_string_start, dt_string_end;\nstatic void __init;\n\nstatic unsigned long __init dt_find_string(char *str)\n{\n\tchar *s, *os;\n\n\ts = os = (char *)dt_string_start;\n\ts += 4;\n\twhile (s <  (char *)dt_string_end) {\n\t\tif (strcmp(s, str) == 0)\n\t\t\treturn s - os;\n\t\ts += strlen(s) + 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "pname",
            "\"phandle\""
          ],
          "line": 2197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ALIGN",
          "args": [
            "*mem_start",
            "4"
          ],
          "line": 2195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "soff",
            "mem_start",
            "mem_end"
          ],
          "line": 2190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "l",
            "mem_start",
            "mem_end"
          ],
          "line": 2189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "OF_DT_PROP",
            "mem_start",
            "mem_end"
          ],
          "line": 2188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "pname",
            "\"name\""
          ],
          "line": 2166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "path",
            "0",
            "PROM_SCRATCH_SIZE"
          ],
          "line": 2154
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/io.c",
          "lines": "126-151",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "_ALIGN",
          "args": [
            "(unsigned long)lp + 1",
            "4"
          ],
          "line": 2149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "OF_DT_BEGIN_NODE",
            "mem_start",
            "mem_end"
          ],
          "line": 2121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MAX_PROPERTY_NAME 64\n#define PROM_ERROR\t\t(-1u)\n#define PROM_SCRATCH_SIZE 256\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\nstatic void __init;\n\nstatic void __init scan_dt_build_struct(phandle node, unsigned long *mem_start,\n\t\t\t\t\tunsigned long *mem_end)\n{\n\tphandle child;\n\tchar *namep, *prev_name, *sstart, *p, *ep, *lp, *path;\n\tunsigned long soff;\n\tunsigned char *valp;\n\tstatic char pname[MAX_PROPERTY_NAME];\n\tint l, room, has_phandle = 0;\n\n\tdt_push_token(OF_DT_BEGIN_NODE, mem_start, mem_end);\n\n\t/* get the node's full name */\n\tnamep = (char *)*mem_start;\n\troom = *mem_end - *mem_start;\n\tif (room > 255)\n\t\troom = 255;\n\tl = call_prom(\"package-to-path\", 3, 1, node, namep, room);\n\tif (l >= 0) {\n\t\t/* Didn't fit?  Get more room. */\n\t\tif (l >= room) {\n\t\t\tif (l >= *mem_end - *mem_start)\n\t\t\t\tnamep = make_room(mem_start, mem_end, l+1, 1);\n\t\t\tcall_prom(\"package-to-path\", 3, 1, node, namep, l);\n\t\t}\n\t\tnamep[l] = '\\0';\n\n\t\t/* Fixup an Apple bug where they have bogus \\0 chars in the\n\t\t * middle of the path in some properties, and extract\n\t\t * the unit name (everything after the last '/').\n\t\t */\n\t\tfor (lp = p = namep, ep = namep + l; p < ep; p++) {\n\t\t\tif (*p == '/')\n\t\t\t\tlp = namep;\n\t\t\telse if (*p != 0)\n\t\t\t\t*lp++ = *p;\n\t\t}\n\t\t*lp = 0;\n\t\t*mem_start = _ALIGN((unsigned long)lp + 1, 4);\n\t}\n\n\t/* get it again for debugging */\n\tpath = prom_scratch;\n\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\tcall_prom(\"package-to-path\", 3, 1, node, path, PROM_SCRATCH_SIZE-1);\n\n\t/* get and store all properties */\n\tprev_name = \"\";\n\tsstart = (char *)dt_string_start;\n\tfor (;;) {\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name,\n\t\t\t      pname) != 1)\n\t\t\tbreak;\n\n \t\t/* skip \"name\" */\n \t\tif (strcmp(pname, \"name\") == 0) {\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\n\t\t/* find string offset */\n\t\tsoff = dt_find_string(pname);\n\t\tif (soff == 0) {\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <%s>, node %s\\n\", pname, path);\n\t\t\tbreak;\n\t\t}\n\t\tprev_name = sstart + soff;\n\n\t\t/* get length */\n\t\tl = call_prom(\"getproplen\", 2, 1, node, pname);\n\n\t\t/* sanity checks */\n\t\tif (l == PROM_ERROR)\n\t\t\tcontinue;\n\n\t\t/* push property head */\n\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\tdt_push_token(l, mem_start, mem_end);\n\t\tdt_push_token(soff, mem_start, mem_end);\n\n\t\t/* push property content */\n\t\tvalp = make_room(mem_start, mem_end, l, 4);\n\t\tcall_prom(\"getprop\", 4, 1, node, pname, valp, l);\n\t\t*mem_start = _ALIGN(*mem_start, 4);\n\n\t\tif (!strcmp(pname, \"phandle\"))\n\t\t\thas_phandle = 1;\n\t}\n\n\t/* Add a \"linux,phandle\" property if no \"phandle\" property already\n\t * existed (can happen with OPAL)\n\t */\n\tif (!has_phandle) {\n\t\tsoff = dt_find_string(\"linux,phandle\");\n\t\tif (soff == 0)\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <linux-phandle> node %s\\n\", path);\n\t\telse {\n\t\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\t\tdt_push_token(4, mem_start, mem_end);\n\t\t\tdt_push_token(soff, mem_start, mem_end);\n\t\t\tvalp = make_room(mem_start, mem_end, 4, 4);\n\t\t\t*(__be32 *)valp = cpu_to_be32(node);\n\t\t}\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_struct(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n\n\tdt_push_token(OF_DT_END_NODE, mem_start, mem_end);\n}"
  },
  {
    "function_name": "scan_dt_build_strings",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2063-2109",
    "snippet": "static void __init scan_dt_build_strings(phandle node,\n\t\t\t\t\t unsigned long *mem_start,\n\t\t\t\t\t unsigned long *mem_end)\n{\n\tchar *prev_name, *namep, *sstart;\n\tunsigned long soff;\n\tphandle child;\n\n\tsstart =  (char *)dt_string_start;\n\n\t/* get and store all property names */\n\tprev_name = \"\";\n\tfor (;;) {\n\t\t/* 64 is max len of name including nul. */\n\t\tnamep = make_room(mem_start, mem_end, MAX_PROPERTY_NAME, 1);\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name, namep) != 1) {\n\t\t\t/* No more nodes: unwind alloc */\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tbreak;\n\t\t}\n\n \t\t/* skip \"name\" */\n \t\tif (strcmp(namep, \"name\") == 0) {\n \t\t\t*mem_start = (unsigned long)namep;\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\t\t/* get/create string entry */\n\t\tsoff = dt_find_string(namep);\n\t\tif (soff != 0) {\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tnamep = sstart + soff;\n\t\t} else {\n\t\t\t/* Trim off some if we can */\n\t\t\t*mem_start = (unsigned long)namep + strlen(namep) + 1;\n\t\t\tdt_string_end = *mem_start;\n\t\t}\n\t\tprev_name = namep;\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_strings(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define MAX_PROPERTY_NAME 64"
    ],
    "globals_used": [
      "static unsigned long __initdata dt_string_start, dt_string_end;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"peer\"",
            "1",
            "1",
            "child"
          ],
          "line": 2107
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "scan_dt_build_strings",
          "args": [
            "child",
            "mem_start",
            "mem_end"
          ],
          "line": 2106
        },
        "resolved": true,
        "details": {
          "function_name": "scan_dt_build_strings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2063-2109",
          "snippet": "static void __init scan_dt_build_strings(phandle node,\n\t\t\t\t\t unsigned long *mem_start,\n\t\t\t\t\t unsigned long *mem_end)\n{\n\tchar *prev_name, *namep, *sstart;\n\tunsigned long soff;\n\tphandle child;\n\n\tsstart =  (char *)dt_string_start;\n\n\t/* get and store all property names */\n\tprev_name = \"\";\n\tfor (;;) {\n\t\t/* 64 is max len of name including nul. */\n\t\tnamep = make_room(mem_start, mem_end, MAX_PROPERTY_NAME, 1);\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name, namep) != 1) {\n\t\t\t/* No more nodes: unwind alloc */\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tbreak;\n\t\t}\n\n \t\t/* skip \"name\" */\n \t\tif (strcmp(namep, \"name\") == 0) {\n \t\t\t*mem_start = (unsigned long)namep;\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\t\t/* get/create string entry */\n\t\tsoff = dt_find_string(namep);\n\t\tif (soff != 0) {\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tnamep = sstart + soff;\n\t\t} else {\n\t\t\t/* Trim off some if we can */\n\t\t\t*mem_start = (unsigned long)namep + strlen(namep) + 1;\n\t\t\tdt_string_end = *mem_start;\n\t\t}\n\t\tprev_name = namep;\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_strings(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "namep"
          ],
          "line": 2097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_find_string",
          "args": [
            "namep"
          ],
          "line": 2091
        },
        "resolved": true,
        "details": {
          "function_name": "dt_find_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2043-2055",
          "snippet": "static unsigned long __init dt_find_string(char *str)\n{\n\tchar *s, *os;\n\n\ts = os = (char *)dt_string_start;\n\ts += 4;\n\twhile (s <  (char *)dt_string_end) {\n\t\tif (strcmp(s, str) == 0)\n\t\t\treturn s - os;\n\t\ts += strlen(s) + 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long __initdata dt_string_start, dt_string_end;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long __initdata dt_string_start, dt_string_end;\nstatic void __init;\n\nstatic unsigned long __init dt_find_string(char *str)\n{\n\tchar *s, *os;\n\n\ts = os = (char *)dt_string_start;\n\ts += 4;\n\twhile (s <  (char *)dt_string_end) {\n\t\tif (strcmp(s, str) == 0)\n\t\t\treturn s - os;\n\t\ts += strlen(s) + 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "namep",
            "\"name\""
          ],
          "line": 2085
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_room",
          "args": [
            "mem_start",
            "mem_end",
            "MAX_PROPERTY_NAME",
            "1"
          ],
          "line": 2077
        },
        "resolved": true,
        "details": {
          "function_name": "make_room",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2008-2036",
          "snippet": "static void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = _ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %x...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define DEVTREE_CHUNK_SIZE\t0x100000"
          ],
          "globals_used": [
            "static unsigned long __initdata alloc_top;",
            "static unsigned long __initdata alloc_bottom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define DEVTREE_CHUNK_SIZE\t0x100000\n\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_bottom;\nstatic void __init;\n\nstatic void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = _ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %x...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MAX_PROPERTY_NAME 64\n\nstatic unsigned long __initdata dt_string_start, dt_string_end;\nstatic void __init;\n\nstatic void __init scan_dt_build_strings(phandle node,\n\t\t\t\t\t unsigned long *mem_start,\n\t\t\t\t\t unsigned long *mem_end)\n{\n\tchar *prev_name, *namep, *sstart;\n\tunsigned long soff;\n\tphandle child;\n\n\tsstart =  (char *)dt_string_start;\n\n\t/* get and store all property names */\n\tprev_name = \"\";\n\tfor (;;) {\n\t\t/* 64 is max len of name including nul. */\n\t\tnamep = make_room(mem_start, mem_end, MAX_PROPERTY_NAME, 1);\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name, namep) != 1) {\n\t\t\t/* No more nodes: unwind alloc */\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tbreak;\n\t\t}\n\n \t\t/* skip \"name\" */\n \t\tif (strcmp(namep, \"name\") == 0) {\n \t\t\t*mem_start = (unsigned long)namep;\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\t\t/* get/create string entry */\n\t\tsoff = dt_find_string(namep);\n\t\tif (soff != 0) {\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tnamep = sstart + soff;\n\t\t} else {\n\t\t\t/* Trim off some if we can */\n\t\t\t*mem_start = (unsigned long)namep + strlen(namep) + 1;\n\t\t\tdt_string_end = *mem_start;\n\t\t}\n\t\tprev_name = namep;\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_strings(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n}"
  },
  {
    "function_name": "dt_find_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2043-2055",
    "snippet": "static unsigned long __init dt_find_string(char *str)\n{\n\tchar *s, *os;\n\n\ts = os = (char *)dt_string_start;\n\ts += 4;\n\twhile (s <  (char *)dt_string_end) {\n\t\tif (strcmp(s, str) == 0)\n\t\t\treturn s - os;\n\t\ts += strlen(s) + 1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned long __initdata dt_string_start, dt_string_end;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "s"
          ],
          "line": 2052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "s",
            "str"
          ],
          "line": 2050
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long __initdata dt_string_start, dt_string_end;\nstatic void __init;\n\nstatic unsigned long __init dt_find_string(char *str)\n{\n\tchar *s, *os;\n\n\ts = os = (char *)dt_string_start;\n\ts += 4;\n\twhile (s <  (char *)dt_string_end) {\n\t\tif (strcmp(s, str) == 0)\n\t\t\treturn s - os;\n\t\ts += strlen(s) + 1;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "make_room",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2008-2036",
    "snippet": "static void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = _ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %x...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define DEVTREE_CHUNK_SIZE\t0x100000"
    ],
    "globals_used": [
      "static unsigned long __initdata alloc_top;",
      "static unsigned long __initdata alloc_bottom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\""
          ],
          "line": 2027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_up",
          "args": [
            "room",
            "0"
          ],
          "line": 2025
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_up",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "976-1014",
          "snippet": "static unsigned long __init alloc_up(unsigned long size, unsigned long align)\n{\n\tunsigned long base = alloc_bottom;\n\tunsigned long addr = 0;\n\n\tif (align)\n\t\tbase = _ALIGN_UP(base, align);\n\tprom_debug(\"alloc_up(%x, %x)\\n\", size, align);\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_up() called with mem not initialized\\n\");\n\n\tif (align)\n\t\tbase = _ALIGN_UP(alloc_bottom, align);\n\telse\n\t\tbase = alloc_bottom;\n\n\tfor(; (base + size) <= alloc_top; \n\t    base = _ALIGN_UP(base + 0x100000, align)) {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t\tif (align == 0)\n\t\t\tbreak;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_bottom = addr + size;\n\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __initdata alloc_top;",
            "static unsigned long __initdata alloc_top_high;",
            "static unsigned long __initdata alloc_bottom;",
            "static unsigned long __initdata rmo_top;",
            "static unsigned long __initdata ram_top;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_top_high;\nstatic unsigned long __initdata alloc_bottom;\nstatic unsigned long __initdata rmo_top;\nstatic unsigned long __initdata ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_up(unsigned long size, unsigned long align)\n{\n\tunsigned long base = alloc_bottom;\n\tunsigned long addr = 0;\n\n\tif (align)\n\t\tbase = _ALIGN_UP(base, align);\n\tprom_debug(\"alloc_up(%x, %x)\\n\", size, align);\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_up() called with mem not initialized\\n\");\n\n\tif (align)\n\t\tbase = _ALIGN_UP(alloc_bottom, align);\n\telse\n\t\tbase = alloc_bottom;\n\n\tfor(; (base + size) <= alloc_top; \n\t    base = _ALIGN_UP(base + 0x100000, align)) {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t\tif (align == 0)\n\t\t\tbreak;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_bottom = addr + size;\n\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\""
          ],
          "line": 2023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Chunk exhausted, claiming more at %x...\\n\"",
            "alloc_bottom"
          ],
          "line": 2017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ALIGN",
          "args": [
            "*mem_start",
            "align"
          ],
          "line": 2013
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define DEVTREE_CHUNK_SIZE\t0x100000\n\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_bottom;\nstatic void __init;\n\nstatic void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = _ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %x...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "prom_check_displays",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1915-2004",
    "snippet": "static void __init prom_check_displays(void)\n{\n\tchar type[16], *path;\n\tphandle node;\n\tihandle ih;\n\tint i;\n\n\tstatic unsigned char default_colors[] = {\n\t\t0x00, 0x00, 0x00,\n\t\t0x00, 0x00, 0xaa,\n\t\t0x00, 0xaa, 0x00,\n\t\t0x00, 0xaa, 0xaa,\n\t\t0xaa, 0x00, 0x00,\n\t\t0xaa, 0x00, 0xaa,\n\t\t0xaa, 0xaa, 0x00,\n\t\t0xaa, 0xaa, 0xaa,\n\t\t0x55, 0x55, 0x55,\n\t\t0x55, 0x55, 0xff,\n\t\t0x55, 0xff, 0x55,\n\t\t0x55, 0xff, 0xff,\n\t\t0xff, 0x55, 0x55,\n\t\t0xff, 0x55, 0xff,\n\t\t0xff, 0xff, 0x55,\n\t\t0xff, 0xff, 0xff\n\t};\n\tconst unsigned char *clut;\n\n\tprom_debug(\"Looking for displays\\n\");\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (strcmp(type, \"display\") != 0)\n\t\t\tcontinue;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tpath = prom_scratch;\n\t\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\n\t\t/*\n\t\t * leave some room at the end of the path for appending extra\n\t\t * arguments\n\t\t */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node, path,\n\t\t\t      PROM_SCRATCH_SIZE-10) == PROM_ERROR)\n\t\t\tcontinue;\n\t\tprom_printf(\"found display   : %s, opening... \", path);\n\t\t\n\t\tih = call_prom(\"open\", 1, 1, path);\n\t\tif (ih == 0) {\n\t\t\tprom_printf(\"failed\\n\");\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Success */\n\t\tprom_printf(\"done\\n\");\n\t\tprom_setprop(node, path, \"linux,opened\", NULL, 0);\n\n\t\t/* Setup a usable color table when the appropriate\n\t\t * method is available. Should update this to set-colors */\n\t\tclut = default_colors;\n\t\tfor (i = 0; i < 16; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n\n#ifdef CONFIG_LOGO_LINUX_CLUT224\n\t\tclut = PTRRELOC(logo_linux_clut224.clut);\n\t\tfor (i = 0; i < logo_linux_clut224.clutsize; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i + 32, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n#endif /* CONFIG_LOGO_LINUX_CLUT224 */\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_BOOTX\n\t\tif (prom_getprop(node, \"linux,boot-display\", NULL, 0) !=\n\t\t    PROM_ERROR) {\n\t\t\tu32 width, height, pitch, addr;\n\n\t\t\tprom_printf(\"Setting btext !\\n\");\n\t\t\tprom_getprop(node, \"width\", &width, 4);\n\t\t\tprom_getprop(node, \"height\", &height, 4);\n\t\t\tprom_getprop(node, \"linebytes\", &pitch, 4);\n\t\t\tprom_getprop(node, \"address\", &addr, 4);\n\t\t\tprom_printf(\"W=%d H=%d LB=%d addr=0x%x\\n\",\n\t\t\t\t    width, height, pitch, addr);\n\t\t\tbtext_setup_display(width, height, 8, pitch, addr);\n\t\t}\n#endif /* CONFIG_PPC_EARLY_DEBUG_BOOTX */\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)",
      "#define PROM_SCRATCH_SIZE 256"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "btext_setup_display",
          "args": [
            "width",
            "height",
            "8",
            "pitch",
            "addr"
          ],
          "line": 2000
        },
        "resolved": true,
        "details": {
          "function_name": "btext_setup_display",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/btext.c",
          "lines": "119-134",
          "snippet": "void __init btext_setup_display(int width, int height, int depth, int pitch,\n\t\t\t\tunsigned long address)\n{\n\tg_loc_X = 0;\n\tg_loc_Y = 0;\n\tg_max_loc_X = width / 8;\n\tg_max_loc_Y = height / 16;\n\tlogicalDisplayBase = (unsigned char *)address;\n\tdispDeviceBase = (unsigned char *)address;\n\tdispDeviceRowBytes = pitch;\n\tdispDeviceDepth = depth == 15 ? 16 : depth;\n\tdispDeviceRect[0] = dispDeviceRect[1] = 0;\n\tdispDeviceRect[2] = width;\n\tdispDeviceRect[3] = height;\n\tboot_text_mapped = 1;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/btext.h>",
            "#include <asm/prom.h>",
            "#include <asm/sections.h>",
            "#include <linux/memblock.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int g_max_loc_X",
            "static int g_max_loc_Y",
            "static int dispDeviceRowBytes",
            "static int dispDeviceDepth",
            "static int dispDeviceRect[4]",
            "static unsigned char *dispDeviceBase",
            "static unsigned char *logicalDisplayBase",
            "int boot_text_mapped"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/btext.h>\n#include <asm/prom.h>\n#include <asm/sections.h>\n#include <linux/memblock.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int g_max_loc_X;\nstatic int g_max_loc_Y;\nstatic int dispDeviceRowBytes;\nstatic int dispDeviceDepth;\nstatic int dispDeviceRect[4];\nstatic unsigned char *dispDeviceBase;\nstatic unsigned char *logicalDisplayBase;\nint boot_text_mapped;\n\nvoid __init btext_setup_display(int width, int height, int depth, int pitch,\n\t\t\t\tunsigned long address)\n{\n\tg_loc_X = 0;\n\tg_loc_Y = 0;\n\tg_max_loc_X = width / 8;\n\tg_max_loc_Y = height / 16;\n\tlogicalDisplayBase = (unsigned char *)address;\n\tdispDeviceBase = (unsigned char *)address;\n\tdispDeviceRowBytes = pitch;\n\tdispDeviceDepth = depth == 15 ? 16 : depth;\n\tdispDeviceRect[0] = dispDeviceRect[1] = 0;\n\tdispDeviceRect[2] = width;\n\tdispDeviceRect[3] = height;\n\tboot_text_mapped = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"W=%d H=%d LB=%d addr=0x%x\\n\"",
            "width",
            "height",
            "pitch",
            "addr"
          ],
          "line": 1998
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"address\"",
            "&addr",
            "4"
          ],
          "line": 1997
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_set_color",
          "args": [
            "ih",
            "i + 32",
            "clut[0]",
            "clut[1]",
            "clut[2]"
          ],
          "line": 1983
        },
        "resolved": true,
        "details": {
          "function_name": "prom_set_color",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1902-1905",
          "snippet": "static int __init prom_set_color(ihandle ih, int i, int r, int g, int b)\n{\n\treturn call_prom(\"call-method\", 6, 1, ADDR(\"color!\"), ih, i, b, g, r);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_set_color(ihandle ih, int i, int r, int g, int b)\n{\n\treturn call_prom(\"call-method\", 6, 1, ADDR(\"color!\"), ih, i, b, g, r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTRRELOC",
          "args": [
            "logo_linux_clut224.clut"
          ],
          "line": 1981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "node",
            "path",
            "\"linux,opened\"",
            "NULL",
            "0"
          ],
          "line": 1970
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "500-520",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"open\"",
            "1",
            "1",
            "path"
          ],
          "line": 1962
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "path",
            "0",
            "PROM_SCRATCH_SIZE"
          ],
          "line": 1951
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/io.c",
          "lines": "126-151",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "type",
            "\"display\""
          ],
          "line": 1946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_next_node",
          "args": [
            "&node"
          ],
          "line": 1943
        },
        "resolved": true,
        "details": {
          "function_name": "prom_next_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "445-460",
          "snippet": "static int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Looking for displays\\n\""
          ],
          "line": 1942
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n#define PROM_SCRATCH_SIZE 256\n\nstatic void __init;\n\nstatic void __init prom_check_displays(void)\n{\n\tchar type[16], *path;\n\tphandle node;\n\tihandle ih;\n\tint i;\n\n\tstatic unsigned char default_colors[] = {\n\t\t0x00, 0x00, 0x00,\n\t\t0x00, 0x00, 0xaa,\n\t\t0x00, 0xaa, 0x00,\n\t\t0x00, 0xaa, 0xaa,\n\t\t0xaa, 0x00, 0x00,\n\t\t0xaa, 0x00, 0xaa,\n\t\t0xaa, 0xaa, 0x00,\n\t\t0xaa, 0xaa, 0xaa,\n\t\t0x55, 0x55, 0x55,\n\t\t0x55, 0x55, 0xff,\n\t\t0x55, 0xff, 0x55,\n\t\t0x55, 0xff, 0xff,\n\t\t0xff, 0x55, 0x55,\n\t\t0xff, 0x55, 0xff,\n\t\t0xff, 0xff, 0x55,\n\t\t0xff, 0xff, 0xff\n\t};\n\tconst unsigned char *clut;\n\n\tprom_debug(\"Looking for displays\\n\");\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (strcmp(type, \"display\") != 0)\n\t\t\tcontinue;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tpath = prom_scratch;\n\t\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\n\t\t/*\n\t\t * leave some room at the end of the path for appending extra\n\t\t * arguments\n\t\t */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node, path,\n\t\t\t      PROM_SCRATCH_SIZE-10) == PROM_ERROR)\n\t\t\tcontinue;\n\t\tprom_printf(\"found display   : %s, opening... \", path);\n\t\t\n\t\tih = call_prom(\"open\", 1, 1, path);\n\t\tif (ih == 0) {\n\t\t\tprom_printf(\"failed\\n\");\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Success */\n\t\tprom_printf(\"done\\n\");\n\t\tprom_setprop(node, path, \"linux,opened\", NULL, 0);\n\n\t\t/* Setup a usable color table when the appropriate\n\t\t * method is available. Should update this to set-colors */\n\t\tclut = default_colors;\n\t\tfor (i = 0; i < 16; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n\n#ifdef CONFIG_LOGO_LINUX_CLUT224\n\t\tclut = PTRRELOC(logo_linux_clut224.clut);\n\t\tfor (i = 0; i < logo_linux_clut224.clutsize; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i + 32, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n#endif /* CONFIG_LOGO_LINUX_CLUT224 */\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_BOOTX\n\t\tif (prom_getprop(node, \"linux,boot-display\", NULL, 0) !=\n\t\t    PROM_ERROR) {\n\t\t\tu32 width, height, pitch, addr;\n\n\t\t\tprom_printf(\"Setting btext !\\n\");\n\t\t\tprom_getprop(node, \"width\", &width, 4);\n\t\t\tprom_getprop(node, \"height\", &height, 4);\n\t\t\tprom_getprop(node, \"linebytes\", &pitch, 4);\n\t\t\tprom_getprop(node, \"address\", &addr, 4);\n\t\t\tprom_printf(\"W=%d H=%d LB=%d addr=0x%x\\n\",\n\t\t\t\t    width, height, pitch, addr);\n\t\t\tbtext_setup_display(width, height, 8, pitch, addr);\n\t\t}\n#endif /* CONFIG_PPC_EARLY_DEBUG_BOOTX */\n\t}\n}"
  },
  {
    "function_name": "prom_set_color",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1902-1905",
    "snippet": "static int __init prom_set_color(ihandle ih, int i, int r, int g, int b)\n{\n\treturn call_prom(\"call-method\", 6, 1, ADDR(\"color!\"), ih, i, b, g, r);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"call-method\"",
            "6",
            "1",
            "ADDR(\"color!\")",
            "ih",
            "i",
            "b",
            "g",
            "r"
          ],
          "line": 1904
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"color!\""
          ],
          "line": 1904
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_set_color(ihandle ih, int i, int r, int g, int b)\n{\n\treturn call_prom(\"call-method\", 6, 1, ADDR(\"color!\"), ih, i, b, g, r);\n}"
  },
  {
    "function_name": "prom_find_machine_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1835-1900",
    "snippet": "static int __init prom_find_machine_type(void)\n{\n\tchar compat[256];\n\tint len, i = 0;\n#ifdef CONFIG_PPC64\n\tphandle rtas;\n\tint x;\n#endif\n\n\t/* Look for a PowerMac or a Cell */\n\tlen = prom_getprop(prom.root, \"compatible\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len > 0) {\n\t\tcompat[len] = 0;\n\t\twhile (i < len) {\n\t\t\tchar *p = &compat[i];\n\t\t\tint sl = strlen(p);\n\t\t\tif (sl == 0)\n\t\t\t\tbreak;\n\t\t\tif (strstr(p, \"Power Macintosh\") ||\n\t\t\t    strstr(p, \"MacRISC\"))\n\t\t\t\treturn PLATFORM_POWERMAC;\n#ifdef CONFIG_PPC64\n\t\t\t/* We must make sure we don't detect the IBM Cell\n\t\t\t * blades as pSeries due to some firmware issues,\n\t\t\t * so we do it here.\n\t\t\t */\n\t\t\tif (strstr(p, \"IBM,CBEA\") ||\n\t\t\t    strstr(p, \"IBM,CPBW-1.0\"))\n\t\t\t\treturn PLATFORM_GENERIC;\n#endif /* CONFIG_PPC64 */\n\t\t\ti += sl + 1;\n\t\t}\n\t}\n#ifdef CONFIG_PPC64\n\t/* Try to detect OPAL */\n\tif (PHANDLE_VALID(call_prom(\"finddevice\", 1, 1, ADDR(\"/ibm,opal\"))))\n\t\treturn PLATFORM_OPAL;\n\n\t/* Try to figure out if it's an IBM pSeries or any other\n\t * PAPR compliant platform. We assume it is if :\n\t *  - /device_type is \"chrp\" (please, do NOT use that for future\n\t *    non-IBM designs !\n\t *  - it has /rtas\n\t */\n\tlen = prom_getprop(prom.root, \"device_type\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len <= 0)\n\t\treturn PLATFORM_GENERIC;\n\tif (strcmp(compat, \"chrp\"))\n\t\treturn PLATFORM_GENERIC;\n\n\t/* Default to pSeries. We need to know if we are running LPAR */\n\trtas = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tif (!PHANDLE_VALID(rtas))\n\t\treturn PLATFORM_GENERIC;\n\tx = prom_getproplen(rtas, \"ibm,hypertas-functions\");\n\tif (x != PROM_ERROR) {\n\t\tprom_debug(\"Hypertas detected, assuming LPAR !\\n\");\n\t\treturn PLATFORM_PSERIES_LPAR;\n\t}\n\treturn PLATFORM_PSERIES;\n#else\n\treturn PLATFORM_GENERIC;\n#endif\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)",
      "#define PLATFORM_OPAL\t\t0x0600",
      "#define PLATFORM_GENERIC\t0x0500",
      "#define PLATFORM_POWERMAC\t0x0400",
      "#define PLATFORM_PSERIES_LPAR\t0x0101",
      "#define PLATFORM_PSERIES\t0x0100"
    ],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Hypertas detected, assuming LPAR !\\n\""
          ],
          "line": 1893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "rtas",
            "\"ibm,hypertas-functions\""
          ],
          "line": 1891
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "469-472",
          "snippet": "static int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "rtas"
          ],
          "line": 1889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(\"/rtas\")"
          ],
          "line": 1888
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/rtas\""
          ],
          "line": 1888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "compat",
            "\"chrp\""
          ],
          "line": 1884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "prom.root",
            "\"device_type\"",
            "compat",
            "sizeof(compat)-1"
          ],
          "line": 1880
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "call_prom(\"finddevice\", 1, 1, ADDR(\"/ibm,opal\"))"
          ],
          "line": 1871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/ibm,opal\""
          ],
          "line": 1871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p",
            "\"IBM,CPBW-1.0\""
          ],
          "line": 1863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p",
            "\"IBM,CBEA\""
          ],
          "line": 1862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p",
            "\"MacRISC\""
          ],
          "line": 1855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p",
            "\"Power Macintosh\""
          ],
          "line": 1854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "p"
          ],
          "line": 1851
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n#define PLATFORM_OPAL\t\t0x0600\n#define PLATFORM_GENERIC\t0x0500\n#define PLATFORM_POWERMAC\t0x0400\n#define PLATFORM_PSERIES_LPAR\t0x0101\n#define PLATFORM_PSERIES\t0x0100\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic int __init prom_find_machine_type(void)\n{\n\tchar compat[256];\n\tint len, i = 0;\n#ifdef CONFIG_PPC64\n\tphandle rtas;\n\tint x;\n#endif\n\n\t/* Look for a PowerMac or a Cell */\n\tlen = prom_getprop(prom.root, \"compatible\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len > 0) {\n\t\tcompat[len] = 0;\n\t\twhile (i < len) {\n\t\t\tchar *p = &compat[i];\n\t\t\tint sl = strlen(p);\n\t\t\tif (sl == 0)\n\t\t\t\tbreak;\n\t\t\tif (strstr(p, \"Power Macintosh\") ||\n\t\t\t    strstr(p, \"MacRISC\"))\n\t\t\t\treturn PLATFORM_POWERMAC;\n#ifdef CONFIG_PPC64\n\t\t\t/* We must make sure we don't detect the IBM Cell\n\t\t\t * blades as pSeries due to some firmware issues,\n\t\t\t * so we do it here.\n\t\t\t */\n\t\t\tif (strstr(p, \"IBM,CBEA\") ||\n\t\t\t    strstr(p, \"IBM,CPBW-1.0\"))\n\t\t\t\treturn PLATFORM_GENERIC;\n#endif /* CONFIG_PPC64 */\n\t\t\ti += sl + 1;\n\t\t}\n\t}\n#ifdef CONFIG_PPC64\n\t/* Try to detect OPAL */\n\tif (PHANDLE_VALID(call_prom(\"finddevice\", 1, 1, ADDR(\"/ibm,opal\"))))\n\t\treturn PLATFORM_OPAL;\n\n\t/* Try to figure out if it's an IBM pSeries or any other\n\t * PAPR compliant platform. We assume it is if :\n\t *  - /device_type is \"chrp\" (please, do NOT use that for future\n\t *    non-IBM designs !\n\t *  - it has /rtas\n\t */\n\tlen = prom_getprop(prom.root, \"device_type\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len <= 0)\n\t\treturn PLATFORM_GENERIC;\n\tif (strcmp(compat, \"chrp\"))\n\t\treturn PLATFORM_GENERIC;\n\n\t/* Default to pSeries. We need to know if we are running LPAR */\n\trtas = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tif (!PHANDLE_VALID(rtas))\n\t\treturn PLATFORM_GENERIC;\n\tx = prom_getproplen(rtas, \"ibm,hypertas-functions\");\n\tif (x != PROM_ERROR) {\n\t\tprom_debug(\"Hypertas detected, assuming LPAR !\\n\");\n\t\treturn PLATFORM_PSERIES_LPAR;\n\t}\n\treturn PLATFORM_PSERIES;\n#else\n\treturn PLATFORM_GENERIC;\n#endif\n}"
  },
  {
    "function_name": "prom_init_stdout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1801-1833",
    "snippet": "static void __init prom_init_stdout(void)\n{\n\tchar *path = of_stdout_device;\n\tchar type[16];\n\tphandle stdout_node;\n\t__be32 val;\n\n\tif (prom_getprop(prom.chosen, \"stdout\", &val, sizeof(val)) <= 0)\n\t\tprom_panic(\"cannot find stdout\");\n\n\tprom.stdout = be32_to_cpu(val);\n\n\t/* Get the full OF pathname of the stdout device */\n\tmemset(path, 0, 256);\n\tcall_prom(\"instance-to-path\", 3, 1, prom.stdout, path, 255);\n\tprom_printf(\"OF stdout device is: %s\\n\", of_stdout_device);\n\tprom_setprop(prom.chosen, \"/chosen\", \"linux,stdout-path\",\n\t\t     path, strlen(path) + 1);\n\n\t/* instance-to-package fails on PA-Semi */\n\tstdout_node = call_prom(\"instance-to-package\", 1, 1, prom.stdout);\n\tif (stdout_node != PROM_ERROR) {\n\t\tval = cpu_to_be32(stdout_node);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,stdout-package\",\n\t\t\t     &val, sizeof(val));\n\n\t\t/* If it's a display, note it */\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(stdout_node, \"device_type\", type, sizeof(type));\n\t\tif (strcmp(type, \"display\") == 0)\n\t\t\tprom_setprop(stdout_node, path, \"linux,boot-display\", NULL, 0);\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "stdout_node",
            "path",
            "\"linux,boot-display\"",
            "NULL",
            "0"
          ],
          "line": 1831
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "500-520",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "type",
            "\"display\""
          ],
          "line": 1830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "stdout_node",
            "\"device_type\"",
            "type",
            "sizeof(type)"
          ],
          "line": 1829
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "type",
            "0",
            "sizeof(type)"
          ],
          "line": 1828
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/io.c",
          "lines": "126-151",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "stdout_node"
          ],
          "line": 1823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"instance-to-package\"",
            "1",
            "1",
            "prom.stdout"
          ],
          "line": 1821
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "path"
          ],
          "line": 1818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"OF stdout device is: %s\\n\"",
            "of_stdout_device"
          ],
          "line": 1816
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "val"
          ],
          "line": 1811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"cannot find stdout\""
          ],
          "line": 1809
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_init_stdout(void)\n{\n\tchar *path = of_stdout_device;\n\tchar type[16];\n\tphandle stdout_node;\n\t__be32 val;\n\n\tif (prom_getprop(prom.chosen, \"stdout\", &val, sizeof(val)) <= 0)\n\t\tprom_panic(\"cannot find stdout\");\n\n\tprom.stdout = be32_to_cpu(val);\n\n\t/* Get the full OF pathname of the stdout device */\n\tmemset(path, 0, 256);\n\tcall_prom(\"instance-to-path\", 3, 1, prom.stdout, path, 255);\n\tprom_printf(\"OF stdout device is: %s\\n\", of_stdout_device);\n\tprom_setprop(prom.chosen, \"/chosen\", \"linux,stdout-path\",\n\t\t     path, strlen(path) + 1);\n\n\t/* instance-to-package fails on PA-Semi */\n\tstdout_node = call_prom(\"instance-to-package\", 1, 1, prom.stdout);\n\tif (stdout_node != PROM_ERROR) {\n\t\tval = cpu_to_be32(stdout_node);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,stdout-package\",\n\t\t\t     &val, sizeof(val));\n\n\t\t/* If it's a display, note it */\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(stdout_node, \"device_type\", type, sizeof(type));\n\t\tif (strcmp(type, \"display\") == 0)\n\t\t\tprom_setprop(stdout_node, path, \"linux,boot-display\", NULL, 0);\n\t}\n}"
  },
  {
    "function_name": "prom_find_mmu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1771-1796",
    "snippet": "static void __init prom_find_mmu(void)\n{\n\tphandle oprom;\n\tchar version[64];\n\n\toprom = call_prom(\"finddevice\", 1, 1, ADDR(\"/openprom\"));\n\tif (!PHANDLE_VALID(oprom))\n\t\treturn;\n\tif (prom_getprop(oprom, \"model\", version, sizeof(version)) <= 0)\n\t\treturn;\n\tversion[sizeof(version) - 1] = 0;\n\t/* XXX might need to add other versions here */\n\tif (strcmp(version, \"Open Firmware, 1.0.5\") == 0)\n\t\tof_workarounds = OF_WA_CLAIM;\n\telse if (strncmp(version, \"FirmWorks,3.\", 12) == 0) {\n\t\tof_workarounds = OF_WA_CLAIM | OF_WA_LONGTRAIL;\n\t\tcall_prom(\"interpret\", 1, 1, \"dev /memory 0 to allow-reclaim\");\n\t} else\n\t\treturn;\n\tprom.memory = call_prom(\"open\", 1, 1, ADDR(\"/memory\"));\n\tprom_getprop(prom.chosen, \"mmu\", &prom.mmumap,\n\t\t     sizeof(prom.mmumap));\n\tprom.mmumap = be32_to_cpu(prom.mmumap);\n\tif (!IHANDLE_VALID(prom.memory) || !IHANDLE_VALID(prom.mmumap))\n\t\tof_workarounds &= ~OF_WA_CLAIM;\t\t/* hmmm */\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
      "#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */"
    ],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "IHANDLE_VALID",
          "args": [
            "prom.mmumap"
          ],
          "line": 1794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IHANDLE_VALID",
          "args": [
            "prom.memory"
          ],
          "line": 1794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "prom.mmumap"
          ],
          "line": 1793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "prom.chosen",
            "\"mmu\"",
            "&prom.mmumap",
            "sizeof(prom.mmumap)"
          ],
          "line": 1791
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"open\"",
            "1",
            "1",
            "ADDR(\"/memory\")"
          ],
          "line": 1790
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/memory\""
          ],
          "line": 1790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "version",
            "\"FirmWorks,3.\"",
            "12"
          ],
          "line": 1785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "version",
            "\"Open Firmware, 1.0.5\""
          ],
          "line": 1783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "oprom"
          ],
          "line": 1777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/openprom\""
          ],
          "line": 1776
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_find_mmu(void)\n{\n\tphandle oprom;\n\tchar version[64];\n\n\toprom = call_prom(\"finddevice\", 1, 1, ADDR(\"/openprom\"));\n\tif (!PHANDLE_VALID(oprom))\n\t\treturn;\n\tif (prom_getprop(oprom, \"model\", version, sizeof(version)) <= 0)\n\t\treturn;\n\tversion[sizeof(version) - 1] = 0;\n\t/* XXX might need to add other versions here */\n\tif (strcmp(version, \"Open Firmware, 1.0.5\") == 0)\n\t\tof_workarounds = OF_WA_CLAIM;\n\telse if (strncmp(version, \"FirmWorks,3.\", 12) == 0) {\n\t\tof_workarounds = OF_WA_CLAIM | OF_WA_LONGTRAIL;\n\t\tcall_prom(\"interpret\", 1, 1, \"dev /memory 0 to allow-reclaim\");\n\t} else\n\t\treturn;\n\tprom.memory = call_prom(\"open\", 1, 1, ADDR(\"/memory\"));\n\tprom_getprop(prom.chosen, \"mmu\", &prom.mmumap,\n\t\t     sizeof(prom.mmumap));\n\tprom.mmumap = be32_to_cpu(prom.mmumap);\n\tif (!IHANDLE_VALID(prom.memory) || !IHANDLE_VALID(prom.mmumap))\n\t\tof_workarounds &= ~OF_WA_CLAIM;\t\t/* hmmm */\n}"
  },
  {
    "function_name": "prom_init_client_services",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1747-1763",
    "snippet": "static void __init prom_init_client_services(unsigned long pp)\n{\n\t/* Get a handle to the prom entry point before anything else */\n\tprom_entry = pp;\n\n\t/* get a handle for the stdout device */\n\tprom.chosen = call_prom(\"finddevice\", 1, 1, ADDR(\"/chosen\"));\n\tif (!PHANDLE_VALID(prom.chosen))\n\t\tprom_panic(\"cannot find chosen\"); /* msg won't be printed :( */\n\n\t/* get device tree root */\n\tprom.root = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(prom.root))\n\t\tprom_panic(\"cannot find device tree root\"); /* msg won't be printed :( */\n\n\tprom.mmumap = 0;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"cannot find device tree root\""
          ],
          "line": 1760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "prom.root"
          ],
          "line": 1759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(\"/\")"
          ],
          "line": 1758
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/\""
          ],
          "line": 1758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"cannot find chosen\""
          ],
          "line": 1755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "prom.chosen"
          ],
          "line": 1754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/chosen\""
          ],
          "line": 1753
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_init_client_services(unsigned long pp)\n{\n\t/* Get a handle to the prom entry point before anything else */\n\tprom_entry = pp;\n\n\t/* get a handle for the stdout device */\n\tprom.chosen = call_prom(\"finddevice\", 1, 1, ADDR(\"/chosen\"));\n\tif (!PHANDLE_VALID(prom.chosen))\n\t\tprom_panic(\"cannot find chosen\"); /* msg won't be printed :( */\n\n\t/* get device tree root */\n\tprom.root = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(prom.root))\n\t\tprom_panic(\"cannot find device tree root\"); /* msg won't be printed :( */\n\n\tprom.mmumap = 0;\n}"
  },
  {
    "function_name": "prom_hold_cpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1657-1744",
    "snippet": "static void __init prom_hold_cpus(void)\n{\n\tunsigned long i;\n\tphandle node;\n\tchar type[64];\n\tunsigned long *spinloop\n\t\t= (void *) LOW_ADDR(__secondary_hold_spinloop);\n\tunsigned long *acknowledge\n\t\t= (void *) LOW_ADDR(__secondary_hold_acknowledge);\n\tunsigned long secondary_hold = LOW_ADDR(__secondary_hold);\n\n\t/*\n\t * On pseries, if RTAS supports \"query-cpu-stopped-state\",\n\t * we skip this stage, the CPUs will be started by the\n\t * kernel using RTAS.\n\t */\n\tif ((of_platform == PLATFORM_PSERIES ||\n\t     of_platform == PLATFORM_PSERIES_LPAR) &&\n\t    rtas_has_query_cpu_stopped) {\n\t\tprom_printf(\"prom_hold_cpus: skipped\\n\");\n\t\treturn;\n\t}\n\n\tprom_debug(\"prom_hold_cpus: start...\\n\");\n\tprom_debug(\"    1) spinloop       = 0x%x\\n\", (unsigned long)spinloop);\n\tprom_debug(\"    1) *spinloop      = 0x%x\\n\", *spinloop);\n\tprom_debug(\"    1) acknowledge    = 0x%x\\n\",\n\t\t   (unsigned long)acknowledge);\n\tprom_debug(\"    1) *acknowledge   = 0x%x\\n\", *acknowledge);\n\tprom_debug(\"    1) secondary_hold = 0x%x\\n\", secondary_hold);\n\n\t/* Set the common spinloop variable, so all of the secondary cpus\n\t * will block when they are awakened from their OF spinloop.\n\t * This must occur for both SMP and non SMP kernels, since OF will\n\t * be trashed when we move the kernel.\n\t */\n\t*spinloop = 0;\n\n\t/* look for cpus */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tunsigned int cpu_no;\n\t\t__be32 reg;\n\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (strcmp(type, \"cpu\") != 0)\n\t\t\tcontinue;\n\n\t\t/* Skip non-configured cpus. */\n\t\tif (prom_getprop(node, \"status\", type, sizeof(type)) > 0)\n\t\t\tif (strcmp(type, \"okay\") != 0)\n\t\t\t\tcontinue;\n\n\t\treg = cpu_to_be32(-1); /* make sparse happy */\n\t\tprom_getprop(node, \"reg\", &reg, sizeof(reg));\n\t\tcpu_no = be32_to_cpu(reg);\n\n\t\tprom_debug(\"cpu hw idx   = %lu\\n\", cpu_no);\n\n\t\t/* Init the acknowledge var which will be reset by\n\t\t * the secondary cpu when it awakens from its OF\n\t\t * spinloop.\n\t\t */\n\t\t*acknowledge = (unsigned long)-1;\n\n\t\tif (cpu_no != prom.cpu) {\n\t\t\t/* Primary Thread of non-boot cpu or any thread */\n\t\t\tprom_printf(\"starting cpu hw idx %lu... \", cpu_no);\n\t\t\tcall_prom(\"start-cpu\", 3, 0, node,\n\t\t\t\t  secondary_hold, cpu_no);\n\n\t\t\tfor (i = 0; (i < 100000000) && \n\t\t\t     (*acknowledge == ((unsigned long)-1)); i++ )\n\t\t\t\tmb();\n\n\t\t\tif (*acknowledge == cpu_no)\n\t\t\t\tprom_printf(\"done\\n\");\n\t\t\telse\n\t\t\t\tprom_printf(\"failed: %x\\n\", *acknowledge);\n\t\t}\n#ifdef CONFIG_SMP\n\t\telse\n\t\t\tprom_printf(\"boot cpu hw idx %lu\\n\", cpu_no);\n#endif /* CONFIG_SMP */\n\t}\n\n\tprom_debug(\"prom_hold_cpus: end...\\n\");\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PLATFORM_PSERIES_LPAR\t0x0101",
      "#define PLATFORM_PSERIES\t0x0100"
    ],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static bool rtas_has_query_cpu_stopped;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_hold_cpus: end...\\n\""
          ],
          "line": 1743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"failed: %x\\n\"",
            "*acknowledge"
          ],
          "line": 1735
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb",
          "args": [],
          "line": 1730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"start-cpu\"",
            "3",
            "0",
            "node",
            "secondary_hold",
            "cpu_no"
          ],
          "line": 1725
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"cpu hw idx   = %lu\\n\"",
            "cpu_no"
          ],
          "line": 1714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "reg"
          ],
          "line": 1712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"reg\"",
            "&reg",
            "sizeof(reg)"
          ],
          "line": 1711
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "-1"
          ],
          "line": 1710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "type",
            "\"okay\""
          ],
          "line": 1707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "type",
            "\"cpu\""
          ],
          "line": 1702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_next_node",
          "args": [
            "&node"
          ],
          "line": 1696
        },
        "resolved": true,
        "details": {
          "function_name": "prom_next_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "445-460",
          "snippet": "static int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    1) secondary_hold = 0x%x\\n\"",
            "secondary_hold"
          ],
          "line": 1686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    1) *acknowledge   = 0x%x\\n\"",
            "*acknowledge"
          ],
          "line": 1685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    1) acknowledge    = 0x%x\\n\"",
            "(unsigned long)acknowledge"
          ],
          "line": 1683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    1) *spinloop      = 0x%x\\n\"",
            "*spinloop"
          ],
          "line": 1682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    1) spinloop       = 0x%x\\n\"",
            "(unsigned long)spinloop"
          ],
          "line": 1681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_hold_cpus: start...\\n\""
          ],
          "line": 1680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOW_ADDR",
          "args": [
            "__secondary_hold"
          ],
          "line": 1666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOW_ADDR",
          "args": [
            "__secondary_hold_acknowledge"
          ],
          "line": 1665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOW_ADDR",
          "args": [
            "__secondary_hold_spinloop"
          ],
          "line": 1663
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PLATFORM_PSERIES_LPAR\t0x0101\n#define PLATFORM_PSERIES\t0x0100\n\nstatic struct prom_t __initdata prom;\nstatic bool rtas_has_query_cpu_stopped;\nstatic void __init;\n\nstatic void __init prom_hold_cpus(void)\n{\n\tunsigned long i;\n\tphandle node;\n\tchar type[64];\n\tunsigned long *spinloop\n\t\t= (void *) LOW_ADDR(__secondary_hold_spinloop);\n\tunsigned long *acknowledge\n\t\t= (void *) LOW_ADDR(__secondary_hold_acknowledge);\n\tunsigned long secondary_hold = LOW_ADDR(__secondary_hold);\n\n\t/*\n\t * On pseries, if RTAS supports \"query-cpu-stopped-state\",\n\t * we skip this stage, the CPUs will be started by the\n\t * kernel using RTAS.\n\t */\n\tif ((of_platform == PLATFORM_PSERIES ||\n\t     of_platform == PLATFORM_PSERIES_LPAR) &&\n\t    rtas_has_query_cpu_stopped) {\n\t\tprom_printf(\"prom_hold_cpus: skipped\\n\");\n\t\treturn;\n\t}\n\n\tprom_debug(\"prom_hold_cpus: start...\\n\");\n\tprom_debug(\"    1) spinloop       = 0x%x\\n\", (unsigned long)spinloop);\n\tprom_debug(\"    1) *spinloop      = 0x%x\\n\", *spinloop);\n\tprom_debug(\"    1) acknowledge    = 0x%x\\n\",\n\t\t   (unsigned long)acknowledge);\n\tprom_debug(\"    1) *acknowledge   = 0x%x\\n\", *acknowledge);\n\tprom_debug(\"    1) secondary_hold = 0x%x\\n\", secondary_hold);\n\n\t/* Set the common spinloop variable, so all of the secondary cpus\n\t * will block when they are awakened from their OF spinloop.\n\t * This must occur for both SMP and non SMP kernels, since OF will\n\t * be trashed when we move the kernel.\n\t */\n\t*spinloop = 0;\n\n\t/* look for cpus */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tunsigned int cpu_no;\n\t\t__be32 reg;\n\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (strcmp(type, \"cpu\") != 0)\n\t\t\tcontinue;\n\n\t\t/* Skip non-configured cpus. */\n\t\tif (prom_getprop(node, \"status\", type, sizeof(type)) > 0)\n\t\t\tif (strcmp(type, \"okay\") != 0)\n\t\t\t\tcontinue;\n\n\t\treg = cpu_to_be32(-1); /* make sparse happy */\n\t\tprom_getprop(node, \"reg\", &reg, sizeof(reg));\n\t\tcpu_no = be32_to_cpu(reg);\n\n\t\tprom_debug(\"cpu hw idx   = %lu\\n\", cpu_no);\n\n\t\t/* Init the acknowledge var which will be reset by\n\t\t * the secondary cpu when it awakens from its OF\n\t\t * spinloop.\n\t\t */\n\t\t*acknowledge = (unsigned long)-1;\n\n\t\tif (cpu_no != prom.cpu) {\n\t\t\t/* Primary Thread of non-boot cpu or any thread */\n\t\t\tprom_printf(\"starting cpu hw idx %lu... \", cpu_no);\n\t\t\tcall_prom(\"start-cpu\", 3, 0, node,\n\t\t\t\t  secondary_hold, cpu_no);\n\n\t\t\tfor (i = 0; (i < 100000000) && \n\t\t\t     (*acknowledge == ((unsigned long)-1)); i++ )\n\t\t\t\tmb();\n\n\t\t\tif (*acknowledge == cpu_no)\n\t\t\t\tprom_printf(\"done\\n\");\n\t\t\telse\n\t\t\t\tprom_printf(\"failed: %x\\n\", *acknowledge);\n\t\t}\n#ifdef CONFIG_SMP\n\t\telse\n\t\t\tprom_printf(\"boot cpu hw idx %lu\\n\", cpu_no);\n#endif /* CONFIG_SMP */\n\t}\n\n\tprom_debug(\"prom_hold_cpus: end...\\n\");\n}"
  },
  {
    "function_name": "prom_initialize_tce_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1502-1629",
    "snippet": "static void __init prom_initialize_tce_table(void)\n{\n\tphandle node;\n\tihandle phb_node;\n\tchar compatible[64], type[64], model[64];\n\tchar *path = prom_scratch;\n\tu64 base, align;\n\tu32 minalign, minsize;\n\tu64 tce_entry, *tce_entryp;\n\tu64 local_alloc_top, local_alloc_bottom;\n\tu64 i;\n\n\tif (prom_iommu_off)\n\t\treturn;\n\n\tprom_debug(\"starting prom_initialize_tce_table\\n\");\n\n\t/* Cache current top of allocs so we reserve a single block */\n\tlocal_alloc_top = alloc_top_high;\n\tlocal_alloc_bottom = local_alloc_top;\n\n\t/* Search all nodes looking for PHBs. */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tcompatible[0] = 0;\n\t\ttype[0] = 0;\n\t\tmodel[0] = 0;\n\t\tprom_getprop(node, \"compatible\",\n\t\t\t     compatible, sizeof(compatible));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tprom_getprop(node, \"model\", model, sizeof(model));\n\n\t\tif ((type[0] == 0) || (strstr(type, \"pci\") == NULL))\n\t\t\tcontinue;\n\n\t\t/* Keep the old logic intact to avoid regression. */\n\t\tif (compatible[0] != 0) {\n\t\t\tif ((strstr(compatible, \"python\") == NULL) &&\n\t\t\t    (strstr(compatible, \"Speedwagon\") == NULL) &&\n\t\t\t    (strstr(compatible, \"Winnipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t} else if (model[0] != 0) {\n\t\t\tif ((strstr(model, \"ython\") == NULL) &&\n\t\t\t    (strstr(model, \"peedwagon\") == NULL) &&\n\t\t\t    (strstr(model, \"innipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tif (prom_getprop(node, \"tce-table-minalign\", &minalign,\n\t\t\t\t sizeof(minalign)) == PROM_ERROR)\n\t\t\tminalign = 0;\n\t\tif (prom_getprop(node, \"tce-table-minsize\", &minsize,\n\t\t\t\t sizeof(minsize)) == PROM_ERROR)\n\t\t\tminsize = 4UL << 20;\n\n\t\t/*\n\t\t * Even though we read what OF wants, we just set the table\n\t\t * size to 4 MB.  This is enough to map 2GB of PCI DMA space.\n\t\t * By doing this, we avoid the pitfalls of trying to DMA to\n\t\t * MMIO space and the DMA alias hole.\n\t\t *\n\t\t * On POWER4, firmware sets the TCE region by assuming\n\t\t * each TCE table is 8MB. Using this memory for anything\n\t\t * else will impact performance, so we always allocate 8MB.\n\t\t * Anton\n\t\t */\n\t\tif (pvr_version_is(PVR_POWER4) || pvr_version_is(PVR_POWER4p))\n\t\t\tminsize = 8UL << 20;\n\t\telse\n\t\t\tminsize = 4UL << 20;\n\n\t\t/* Align to the greater of the align or size */\n\t\talign = max(minalign, minsize);\n\t\tbase = alloc_down(minsize, align, 1);\n\t\tif (base == 0)\n\t\t\tprom_panic(\"ERROR, cannot find space for TCE table.\\n\");\n\t\tif (base < local_alloc_bottom)\n\t\t\tlocal_alloc_bottom = base;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\t\t/* Call OF to setup the TCE hardware */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node,\n\t\t\t      path, PROM_SCRATCH_SIZE-1) == PROM_ERROR) {\n\t\t\tprom_printf(\"package-to-path failed\\n\");\n\t\t}\n\n\t\t/* Save away the TCE table attributes for later use. */\n\t\tprom_setprop(node, path, \"linux,tce-base\", &base, sizeof(base));\n\t\tprom_setprop(node, path, \"linux,tce-size\", &minsize, sizeof(minsize));\n\n\t\tprom_debug(\"TCE table: %s\\n\", path);\n\t\tprom_debug(\"\\tnode = 0x%x\\n\", node);\n\t\tprom_debug(\"\\tbase = 0x%x\\n\", base);\n\t\tprom_debug(\"\\tsize = 0x%x\\n\", minsize);\n\n\t\t/* Initialize the table to have a one-to-one mapping\n\t\t * over the allocated size.\n\t\t */\n\t\ttce_entryp = (u64 *)base;\n\t\tfor (i = 0; i < (minsize >> 3) ;tce_entryp++, i++) {\n\t\t\ttce_entry = (i << PAGE_SHIFT);\n\t\t\ttce_entry |= 0x3;\n\t\t\t*tce_entryp = tce_entry;\n\t\t}\n\n\t\tprom_printf(\"opening PHB %s\", path);\n\t\tphb_node = call_prom(\"open\", 1, 1, path);\n\t\tif (phb_node == 0)\n\t\t\tprom_printf(\"... failed\\n\");\n\t\telse\n\t\t\tprom_printf(\"... done\\n\");\n\n\t\tcall_prom(\"call-method\", 6, 0, ADDR(\"set-64-bit-addressing\"),\n\t\t\t  phb_node, -1, minsize,\n\t\t\t  (u32) base, (u32) (base >> 32));\n\t\tcall_prom(\"close\", 1, 0, phb_node);\n\t}\n\n\treserve_mem(local_alloc_bottom, local_alloc_top - local_alloc_bottom);\n\n\t/* These are only really needed if there is a memory limit in\n\t * effect, but we don't know so export them always. */\n\tprom_tce_alloc_start = local_alloc_bottom;\n\tprom_tce_alloc_end = local_alloc_top;\n\n\t/* Flag the first invalid entry */\n\tprom_debug(\"ending prom_initialize_tce_table\\n\");\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)",
      "#define PROM_SCRATCH_SIZE 256"
    ],
    "globals_used": [
      "static unsigned long __initdata alloc_top_high;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"ending prom_initialize_tce_table\\n\""
          ],
          "line": 1628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_mem",
          "args": [
            "local_alloc_bottom",
            "local_alloc_top - local_alloc_bottom"
          ],
          "line": 1620
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1107-1128",
          "snippet": "static void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = _ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = _ALIGN_UP(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MEM_RESERVE_MAP_SIZE\t8"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n\nstatic void __init;\n\nstatic void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = _ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = _ALIGN_UP(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"close\"",
            "1",
            "0",
            "phb_node"
          ],
          "line": 1617
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "base >> 32"
          ],
          "line": 1616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"set-64-bit-addressing\""
          ],
          "line": 1614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"... done\\n\""
          ],
          "line": 1612
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"\\tsize = 0x%x\\n\"",
            "minsize"
          ],
          "line": 1595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"\\tbase = 0x%x\\n\"",
            "base"
          ],
          "line": 1594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"\\tnode = 0x%x\\n\"",
            "node"
          ],
          "line": 1593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"TCE table: %s\\n\"",
            "path"
          ],
          "line": 1592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "node",
            "path",
            "\"linux,tce-size\"",
            "&minsize",
            "sizeof(minsize)"
          ],
          "line": 1590
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "500-520",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "path",
            "0",
            "PROM_SCRATCH_SIZE"
          ],
          "line": 1581
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/io.c",
          "lines": "126-151",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"ERROR, cannot find space for TCE table.\\n\""
          ],
          "line": 1576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_down",
          "args": [
            "minsize",
            "align",
            "1"
          ],
          "line": 1574
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_down",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1021-1073",
          "snippet": "static unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"alloc_down(%x, %x, %s)\\n\", size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = _ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = _ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = _ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __initdata alloc_top;",
            "static unsigned long __initdata alloc_top_high;",
            "static unsigned long __initdata alloc_bottom;",
            "static unsigned long __initdata rmo_top;",
            "static unsigned long __initdata ram_top;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_top_high;\nstatic unsigned long __initdata alloc_bottom;\nstatic unsigned long __initdata rmo_top;\nstatic unsigned long __initdata ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"alloc_down(%x, %x, %s)\\n\", size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = _ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = _ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = _ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "minalign",
            "minsize"
          ],
          "line": 1573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pvr_version_is",
          "args": [
            "PVR_POWER4p"
          ],
          "line": 1567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pvr_version_is",
          "args": [
            "PVR_POWER4"
          ],
          "line": 1567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"tce-table-minsize\"",
            "&minsize",
            "sizeof(minsize)"
          ],
          "line": 1552
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "model",
            "\"innipeg\""
          ],
          "line": 1545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "model",
            "\"peedwagon\""
          ],
          "line": 1544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "model",
            "\"ython\""
          ],
          "line": 1543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "compatible",
            "\"Winnipeg\""
          ],
          "line": 1540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "compatible",
            "\"Speedwagon\""
          ],
          "line": 1539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "compatible",
            "\"python\""
          ],
          "line": 1538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "type",
            "\"pci\""
          ],
          "line": 1533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_next_node",
          "args": [
            "&node"
          ],
          "line": 1524
        },
        "resolved": true,
        "details": {
          "function_name": "prom_next_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "445-460",
          "snippet": "static int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"starting prom_initialize_tce_table\\n\""
          ],
          "line": 1517
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n#define PROM_SCRATCH_SIZE 256\n\nstatic unsigned long __initdata alloc_top_high;\nstatic void __init;\n\nstatic void __init prom_initialize_tce_table(void)\n{\n\tphandle node;\n\tihandle phb_node;\n\tchar compatible[64], type[64], model[64];\n\tchar *path = prom_scratch;\n\tu64 base, align;\n\tu32 minalign, minsize;\n\tu64 tce_entry, *tce_entryp;\n\tu64 local_alloc_top, local_alloc_bottom;\n\tu64 i;\n\n\tif (prom_iommu_off)\n\t\treturn;\n\n\tprom_debug(\"starting prom_initialize_tce_table\\n\");\n\n\t/* Cache current top of allocs so we reserve a single block */\n\tlocal_alloc_top = alloc_top_high;\n\tlocal_alloc_bottom = local_alloc_top;\n\n\t/* Search all nodes looking for PHBs. */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tcompatible[0] = 0;\n\t\ttype[0] = 0;\n\t\tmodel[0] = 0;\n\t\tprom_getprop(node, \"compatible\",\n\t\t\t     compatible, sizeof(compatible));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tprom_getprop(node, \"model\", model, sizeof(model));\n\n\t\tif ((type[0] == 0) || (strstr(type, \"pci\") == NULL))\n\t\t\tcontinue;\n\n\t\t/* Keep the old logic intact to avoid regression. */\n\t\tif (compatible[0] != 0) {\n\t\t\tif ((strstr(compatible, \"python\") == NULL) &&\n\t\t\t    (strstr(compatible, \"Speedwagon\") == NULL) &&\n\t\t\t    (strstr(compatible, \"Winnipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t} else if (model[0] != 0) {\n\t\t\tif ((strstr(model, \"ython\") == NULL) &&\n\t\t\t    (strstr(model, \"peedwagon\") == NULL) &&\n\t\t\t    (strstr(model, \"innipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tif (prom_getprop(node, \"tce-table-minalign\", &minalign,\n\t\t\t\t sizeof(minalign)) == PROM_ERROR)\n\t\t\tminalign = 0;\n\t\tif (prom_getprop(node, \"tce-table-minsize\", &minsize,\n\t\t\t\t sizeof(minsize)) == PROM_ERROR)\n\t\t\tminsize = 4UL << 20;\n\n\t\t/*\n\t\t * Even though we read what OF wants, we just set the table\n\t\t * size to 4 MB.  This is enough to map 2GB of PCI DMA space.\n\t\t * By doing this, we avoid the pitfalls of trying to DMA to\n\t\t * MMIO space and the DMA alias hole.\n\t\t *\n\t\t * On POWER4, firmware sets the TCE region by assuming\n\t\t * each TCE table is 8MB. Using this memory for anything\n\t\t * else will impact performance, so we always allocate 8MB.\n\t\t * Anton\n\t\t */\n\t\tif (pvr_version_is(PVR_POWER4) || pvr_version_is(PVR_POWER4p))\n\t\t\tminsize = 8UL << 20;\n\t\telse\n\t\t\tminsize = 4UL << 20;\n\n\t\t/* Align to the greater of the align or size */\n\t\talign = max(minalign, minsize);\n\t\tbase = alloc_down(minsize, align, 1);\n\t\tif (base == 0)\n\t\t\tprom_panic(\"ERROR, cannot find space for TCE table.\\n\");\n\t\tif (base < local_alloc_bottom)\n\t\t\tlocal_alloc_bottom = base;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\t\t/* Call OF to setup the TCE hardware */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node,\n\t\t\t      path, PROM_SCRATCH_SIZE-1) == PROM_ERROR) {\n\t\t\tprom_printf(\"package-to-path failed\\n\");\n\t\t}\n\n\t\t/* Save away the TCE table attributes for later use. */\n\t\tprom_setprop(node, path, \"linux,tce-base\", &base, sizeof(base));\n\t\tprom_setprop(node, path, \"linux,tce-size\", &minsize, sizeof(minsize));\n\n\t\tprom_debug(\"TCE table: %s\\n\", path);\n\t\tprom_debug(\"\\tnode = 0x%x\\n\", node);\n\t\tprom_debug(\"\\tbase = 0x%x\\n\", base);\n\t\tprom_debug(\"\\tsize = 0x%x\\n\", minsize);\n\n\t\t/* Initialize the table to have a one-to-one mapping\n\t\t * over the allocated size.\n\t\t */\n\t\ttce_entryp = (u64 *)base;\n\t\tfor (i = 0; i < (minsize >> 3) ;tce_entryp++, i++) {\n\t\t\ttce_entry = (i << PAGE_SHIFT);\n\t\t\ttce_entry |= 0x3;\n\t\t\t*tce_entryp = tce_entry;\n\t\t}\n\n\t\tprom_printf(\"opening PHB %s\", path);\n\t\tphb_node = call_prom(\"open\", 1, 1, path);\n\t\tif (phb_node == 0)\n\t\t\tprom_printf(\"... failed\\n\");\n\t\telse\n\t\t\tprom_printf(\"... done\\n\");\n\n\t\tcall_prom(\"call-method\", 6, 0, ADDR(\"set-64-bit-addressing\"),\n\t\t\t  phb_node, -1, minsize,\n\t\t\t  (u32) base, (u32) (base >> 32));\n\t\tcall_prom(\"close\", 1, 0, phb_node);\n\t}\n\n\treserve_mem(local_alloc_bottom, local_alloc_top - local_alloc_bottom);\n\n\t/* These are only really needed if there is a memory limit in\n\t * effect, but we don't know so export them always. */\n\tprom_tce_alloc_start = local_alloc_bottom;\n\tprom_tce_alloc_end = local_alloc_top;\n\n\t/* Flag the first invalid entry */\n\tprom_debug(\"ending prom_initialize_tce_table\\n\");\n}"
  },
  {
    "function_name": "prom_instantiate_sml",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1424-1496",
    "snippet": "static void __init prom_instantiate_sml(void)\n{\n\tphandle ibmvtpm_node;\n\tihandle ibmvtpm_inst;\n\tu32 entry = 0, size = 0, succ = 0;\n\tu64 base;\n\t__be32 val;\n\n\tprom_debug(\"prom_instantiate_sml: start...\\n\");\n\n\tibmvtpm_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tprom_debug(\"ibmvtpm_node: %x\\n\", ibmvtpm_node);\n\tif (!PHANDLE_VALID(ibmvtpm_node))\n\t\treturn;\n\n\tibmvtpm_inst = call_prom(\"open\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tif (!IHANDLE_VALID(ibmvtpm_inst)) {\n\t\tprom_printf(\"opening vtpm package failed (%x)\\n\", ibmvtpm_inst);\n\t\treturn;\n\t}\n\n\tif (prom_getprop(ibmvtpm_node, \"ibm,sml-efi-reformat-supported\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR) {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &succ,\n\t\t\t\t  ADDR(\"reformat-sml-to-efi-alignment\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || succ == 0) {\n\t\t\tprom_printf(\"Reformat SML to EFI alignment failed\\n\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-allocated-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get allocated size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t} else {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-handover-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get handover size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for sml\\n\");\n\n\tprom_printf(\"instantiating sml at 0x%x...\", base);\n\n\tmemset((void *)base, 0, size);\n\n\tif (call_prom_ret(\"call-method\", 4, 2, &entry,\n\t\t\t  ADDR(\"sml-handover\"),\n\t\t\t  ibmvtpm_inst, size, base) != 0 || entry == 0) {\n\t\tprom_printf(\"SML handover failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-base\",\n\t\t     &base, sizeof(base));\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-size\",\n\t\t     &size, sizeof(size));\n\n\tprom_debug(\"sml base     = 0x%x\\n\", base);\n\tprom_debug(\"sml size     = 0x%x\\n\", (long)size);\n\n\tprom_debug(\"prom_instantiate_sml: end...\\n\");\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_instantiate_sml: end...\\n\""
          ],
          "line": 1495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"sml size     = 0x%x\\n\"",
            "(long)size"
          ],
          "line": 1493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"sml base     = 0x%x\\n\"",
            "base"
          ],
          "line": 1492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "ibmvtpm_node",
            "\"/vdevice/vtpm\"",
            "\"linux,sml-size\"",
            "&size",
            "sizeof(size)"
          ],
          "line": 1489
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "500-520",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reserve_mem",
          "args": [
            "base",
            "size"
          ],
          "line": 1485
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1107-1128",
          "snippet": "static void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = _ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = _ALIGN_UP(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MEM_RESERVE_MAP_SIZE\t8"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n\nstatic void __init;\n\nstatic void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = _ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = _ALIGN_UP(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\" done\\n\""
          ],
          "line": 1483
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom_ret",
          "args": [
            "\"call-method\"",
            "4",
            "2",
            "&entry",
            "ADDR(\"sml-handover\")",
            "ibmvtpm_inst",
            "size",
            "base"
          ],
          "line": 1477
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"sml-handover\""
          ],
          "line": 1478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "(void *)base",
            "0",
            "size"
          ],
          "line": 1475
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/io.c",
          "lines": "126-151",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"Could not allocate memory for sml\\n\""
          ],
          "line": 1471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_down",
          "args": [
            "size",
            "PAGE_SIZE",
            "0"
          ],
          "line": 1469
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_down",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1021-1073",
          "snippet": "static unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"alloc_down(%x, %x, %s)\\n\", size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = _ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = _ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = _ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __initdata alloc_top;",
            "static unsigned long __initdata alloc_top_high;",
            "static unsigned long __initdata alloc_bottom;",
            "static unsigned long __initdata rmo_top;",
            "static unsigned long __initdata ram_top;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_top_high;\nstatic unsigned long __initdata alloc_bottom;\nstatic unsigned long __initdata rmo_top;\nstatic unsigned long __initdata ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"alloc_down(%x, %x, %s)\\n\", size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = _ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = _ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = _ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"sml-get-handover-size\""
          ],
          "line": 1462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"sml-get-allocated-size\""
          ],
          "line": 1455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"reformat-sml-to-efi-alignment\""
          ],
          "line": 1448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "ibmvtpm_node",
            "\"ibm,sml-efi-reformat-supported\"",
            "&val",
            "sizeof(val)"
          ],
          "line": 1445
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IHANDLE_VALID",
          "args": [
            "ibmvtpm_inst"
          ],
          "line": 1440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/vdevice/vtpm\""
          ],
          "line": 1439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "ibmvtpm_node"
          ],
          "line": 1436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"ibmvtpm_node: %x\\n\"",
            "ibmvtpm_node"
          ],
          "line": 1435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/vdevice/vtpm\""
          ],
          "line": 1434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_instantiate_sml: start...\\n\""
          ],
          "line": 1432
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init prom_instantiate_sml(void)\n{\n\tphandle ibmvtpm_node;\n\tihandle ibmvtpm_inst;\n\tu32 entry = 0, size = 0, succ = 0;\n\tu64 base;\n\t__be32 val;\n\n\tprom_debug(\"prom_instantiate_sml: start...\\n\");\n\n\tibmvtpm_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tprom_debug(\"ibmvtpm_node: %x\\n\", ibmvtpm_node);\n\tif (!PHANDLE_VALID(ibmvtpm_node))\n\t\treturn;\n\n\tibmvtpm_inst = call_prom(\"open\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tif (!IHANDLE_VALID(ibmvtpm_inst)) {\n\t\tprom_printf(\"opening vtpm package failed (%x)\\n\", ibmvtpm_inst);\n\t\treturn;\n\t}\n\n\tif (prom_getprop(ibmvtpm_node, \"ibm,sml-efi-reformat-supported\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR) {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &succ,\n\t\t\t\t  ADDR(\"reformat-sml-to-efi-alignment\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || succ == 0) {\n\t\t\tprom_printf(\"Reformat SML to EFI alignment failed\\n\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-allocated-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get allocated size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t} else {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-handover-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get handover size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for sml\\n\");\n\n\tprom_printf(\"instantiating sml at 0x%x...\", base);\n\n\tmemset((void *)base, 0, size);\n\n\tif (call_prom_ret(\"call-method\", 4, 2, &entry,\n\t\t\t  ADDR(\"sml-handover\"),\n\t\t\t  ibmvtpm_inst, size, base) != 0 || entry == 0) {\n\t\tprom_printf(\"SML handover failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-base\",\n\t\t     &base, sizeof(base));\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-size\",\n\t\t     &size, sizeof(size));\n\n\tprom_debug(\"sml base     = 0x%x\\n\", base);\n\tprom_debug(\"sml size     = 0x%x\\n\", (long)size);\n\n\tprom_debug(\"prom_instantiate_sml: end...\\n\");\n}"
  },
  {
    "function_name": "prom_instantiate_rtas",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1357-1418",
    "snippet": "static void __init prom_instantiate_rtas(void)\n{\n\tphandle rtas_node;\n\tihandle rtas_inst;\n\tu32 base, entry = 0;\n\t__be32 val;\n\tu32 size = 0;\n\n\tprom_debug(\"prom_instantiate_rtas: start...\\n\");\n\n\trtas_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tprom_debug(\"rtas_node: %x\\n\", rtas_node);\n\tif (!PHANDLE_VALID(rtas_node))\n\t\treturn;\n\n\tval = 0;\n\tprom_getprop(rtas_node, \"rtas-size\", &val, sizeof(size));\n\tsize = be32_to_cpu(val);\n\tif (size == 0)\n\t\treturn;\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for RTAS\\n\");\n\n\trtas_inst = call_prom(\"open\", 1, 1, ADDR(\"/rtas\"));\n\tif (!IHANDLE_VALID(rtas_inst)) {\n\t\tprom_printf(\"opening rtas package failed (%x)\\n\", rtas_inst);\n\t\treturn;\n\t}\n\n\tprom_printf(\"instantiating rtas at 0x%x...\", base);\n\n\tif (call_prom_ret(\"call-method\", 3, 2, &entry,\n\t\t\t  ADDR(\"instantiate-rtas\"),\n\t\t\t  rtas_inst, base) != 0\n\t    || entry == 0) {\n\t\tprom_printf(\" failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tval = cpu_to_be32(base);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-base\",\n\t\t     &val, sizeof(val));\n\tval = cpu_to_be32(entry);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-entry\",\n\t\t     &val, sizeof(val));\n\n\t/* Check if it supports \"query-cpu-stopped-state\" */\n\tif (prom_getprop(rtas_node, \"query-cpu-stopped-state\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR)\n\t\trtas_has_query_cpu_stopped = true;\n\n\tprom_debug(\"rtas base     = 0x%x\\n\", base);\n\tprom_debug(\"rtas entry    = 0x%x\\n\", entry);\n\tprom_debug(\"rtas size     = 0x%x\\n\", (long)size);\n\n\tprom_debug(\"prom_instantiate_rtas: end...\\n\");\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static bool rtas_has_query_cpu_stopped;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_instantiate_rtas: end...\\n\""
          ],
          "line": 1417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"rtas size     = 0x%x\\n\"",
            "(long)size"
          ],
          "line": 1415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"rtas entry    = 0x%x\\n\"",
            "entry"
          ],
          "line": 1414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"rtas base     = 0x%x\\n\"",
            "base"
          ],
          "line": 1413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "rtas_node",
            "\"query-cpu-stopped-state\"",
            "&val",
            "sizeof(val)"
          ],
          "line": 1409
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "rtas_node",
            "\"/rtas\"",
            "\"linux,rtas-entry\"",
            "&val",
            "sizeof(val)"
          ],
          "line": 1405
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "500-520",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "entry"
          ],
          "line": 1404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "base"
          ],
          "line": 1401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_mem",
          "args": [
            "base",
            "size"
          ],
          "line": 1399
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1107-1128",
          "snippet": "static void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = _ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = _ALIGN_UP(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MEM_RESERVE_MAP_SIZE\t8"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n\nstatic void __init;\n\nstatic void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = _ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = _ALIGN_UP(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\" done\\n\""
          ],
          "line": 1397
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom_ret",
          "args": [
            "\"call-method\"",
            "3",
            "2",
            "&entry",
            "ADDR(\"instantiate-rtas\")",
            "rtas_inst",
            "base"
          ],
          "line": 1390
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"instantiate-rtas\""
          ],
          "line": 1391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IHANDLE_VALID",
          "args": [
            "rtas_inst"
          ],
          "line": 1383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/rtas\""
          ],
          "line": 1382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"Could not allocate memory for RTAS\\n\""
          ],
          "line": 1380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_down",
          "args": [
            "size",
            "PAGE_SIZE",
            "0"
          ],
          "line": 1378
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_down",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1021-1073",
          "snippet": "static unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"alloc_down(%x, %x, %s)\\n\", size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = _ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = _ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = _ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __initdata alloc_top;",
            "static unsigned long __initdata alloc_top_high;",
            "static unsigned long __initdata alloc_bottom;",
            "static unsigned long __initdata rmo_top;",
            "static unsigned long __initdata ram_top;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_top_high;\nstatic unsigned long __initdata alloc_bottom;\nstatic unsigned long __initdata rmo_top;\nstatic unsigned long __initdata ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"alloc_down(%x, %x, %s)\\n\", size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = _ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = _ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = _ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "val"
          ],
          "line": 1374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "rtas_node"
          ],
          "line": 1369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"rtas_node: %x\\n\"",
            "rtas_node"
          ],
          "line": 1368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/rtas\""
          ],
          "line": 1367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_instantiate_rtas: start...\\n\""
          ],
          "line": 1365
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic bool rtas_has_query_cpu_stopped;\nstatic void __init;\n\nstatic void __init prom_instantiate_rtas(void)\n{\n\tphandle rtas_node;\n\tihandle rtas_inst;\n\tu32 base, entry = 0;\n\t__be32 val;\n\tu32 size = 0;\n\n\tprom_debug(\"prom_instantiate_rtas: start...\\n\");\n\n\trtas_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tprom_debug(\"rtas_node: %x\\n\", rtas_node);\n\tif (!PHANDLE_VALID(rtas_node))\n\t\treturn;\n\n\tval = 0;\n\tprom_getprop(rtas_node, \"rtas-size\", &val, sizeof(size));\n\tsize = be32_to_cpu(val);\n\tif (size == 0)\n\t\treturn;\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for RTAS\\n\");\n\n\trtas_inst = call_prom(\"open\", 1, 1, ADDR(\"/rtas\"));\n\tif (!IHANDLE_VALID(rtas_inst)) {\n\t\tprom_printf(\"opening rtas package failed (%x)\\n\", rtas_inst);\n\t\treturn;\n\t}\n\n\tprom_printf(\"instantiating rtas at 0x%x...\", base);\n\n\tif (call_prom_ret(\"call-method\", 3, 2, &entry,\n\t\t\t  ADDR(\"instantiate-rtas\"),\n\t\t\t  rtas_inst, base) != 0\n\t    || entry == 0) {\n\t\tprom_printf(\" failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tval = cpu_to_be32(base);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-base\",\n\t\t     &val, sizeof(val));\n\tval = cpu_to_be32(entry);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-entry\",\n\t\t     &val, sizeof(val));\n\n\t/* Check if it supports \"query-cpu-stopped-state\" */\n\tif (prom_getprop(rtas_node, \"query-cpu-stopped-state\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR)\n\t\trtas_has_query_cpu_stopped = true;\n\n\tprom_debug(\"rtas base     = 0x%x\\n\", base);\n\tprom_debug(\"rtas entry    = 0x%x\\n\", entry);\n\tprom_debug(\"rtas size     = 0x%x\\n\", (long)size);\n\n\tprom_debug(\"prom_instantiate_rtas: end...\\n\");\n}"
  },
  {
    "function_name": "prom_instantiate_opal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1282-1350",
    "snippet": "static void __init prom_instantiate_opal(void)\n{\n\tphandle opal_node;\n\tihandle opal_inst;\n\tu64 base, entry;\n\tu64 size = 0, align = 0x10000;\n\t__be64 val64;\n\tu32 rets[2];\n\n\tprom_debug(\"prom_instantiate_opal: start...\\n\");\n\n\topal_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/ibm,opal\"));\n\tprom_debug(\"opal_node: %x\\n\", opal_node);\n\tif (!PHANDLE_VALID(opal_node))\n\t\treturn;\n\n\tval64 = 0;\n\tprom_getprop(opal_node, \"opal-runtime-size\", &val64, sizeof(val64));\n\tsize = be64_to_cpu(val64);\n\tif (size == 0)\n\t\treturn;\n\tval64 = 0;\n\tprom_getprop(opal_node, \"opal-runtime-alignment\", &val64,sizeof(val64));\n\talign = be64_to_cpu(val64);\n\n\tbase = alloc_down(size, align, 0);\n\tif (base == 0) {\n\t\tprom_printf(\"OPAL allocation failed !\\n\");\n\t\treturn;\n\t}\n\n\topal_inst = call_prom(\"open\", 1, 1, ADDR(\"/ibm,opal\"));\n\tif (!IHANDLE_VALID(opal_inst)) {\n\t\tprom_printf(\"opening opal package failed (%x)\\n\", opal_inst);\n\t\treturn;\n\t}\n\n\tprom_printf(\"instantiating opal at 0x%x...\", base);\n\n\tif (call_prom_ret(\"call-method\", 4, 3, rets,\n\t\t\t  ADDR(\"load-opal-runtime\"),\n\t\t\t  opal_inst,\n\t\t\t  base >> 32, base & 0xffffffff) != 0\n\t    || (rets[0] == 0 && rets[1] == 0)) {\n\t\tprom_printf(\" failed\\n\");\n\t\treturn;\n\t}\n\tentry = (((u64)rets[0]) << 32) | rets[1];\n\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tprom_debug(\"opal base     = 0x%x\\n\", base);\n\tprom_debug(\"opal align    = 0x%x\\n\", align);\n\tprom_debug(\"opal entry    = 0x%x\\n\", entry);\n\tprom_debug(\"opal size     = 0x%x\\n\", (long)size);\n\n\tprom_setprop(opal_node, \"/ibm,opal\", \"opal-base-address\",\n\t\t     &base, sizeof(base));\n\tprom_setprop(opal_node, \"/ibm,opal\", \"opal-entry-address\",\n\t\t     &entry, sizeof(entry));\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_OPAL\n\tprom_opal_base = base;\n\tprom_opal_entry = entry;\n#endif\n\tprom_debug(\"prom_instantiate_opal: end...\\n\");\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_instantiate_opal: end...\\n\""
          ],
          "line": 1349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "opal_node",
            "\"/ibm,opal\"",
            "\"opal-entry-address\"",
            "&entry",
            "sizeof(entry)"
          ],
          "line": 1342
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "500-520",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"opal size     = 0x%x\\n\"",
            "(long)size"
          ],
          "line": 1338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"opal entry    = 0x%x\\n\"",
            "entry"
          ],
          "line": 1337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"opal align    = 0x%x\\n\"",
            "align"
          ],
          "line": 1336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"opal base     = 0x%x\\n\"",
            "base"
          ],
          "line": 1335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_mem",
          "args": [
            "base",
            "size"
          ],
          "line": 1333
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1107-1128",
          "snippet": "static void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = _ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = _ALIGN_UP(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MEM_RESERVE_MAP_SIZE\t8"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n\nstatic void __init;\n\nstatic void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = _ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = _ALIGN_UP(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\" done\\n\""
          ],
          "line": 1331
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom_ret",
          "args": [
            "\"call-method\"",
            "4",
            "3",
            "rets",
            "ADDR(\"load-opal-runtime\")",
            "opal_inst",
            "base >> 32",
            "base & 0xffffffff"
          ],
          "line": 1321
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"load-opal-runtime\""
          ],
          "line": 1322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IHANDLE_VALID",
          "args": [
            "opal_inst"
          ],
          "line": 1314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/ibm,opal\""
          ],
          "line": 1313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_down",
          "args": [
            "size",
            "align",
            "0"
          ],
          "line": 1307
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_down",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1021-1073",
          "snippet": "static unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"alloc_down(%x, %x, %s)\\n\", size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = _ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = _ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = _ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __initdata alloc_top;",
            "static unsigned long __initdata alloc_top_high;",
            "static unsigned long __initdata alloc_bottom;",
            "static unsigned long __initdata rmo_top;",
            "static unsigned long __initdata ram_top;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_top_high;\nstatic unsigned long __initdata alloc_bottom;\nstatic unsigned long __initdata rmo_top;\nstatic unsigned long __initdata ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"alloc_down(%x, %x, %s)\\n\", size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = _ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = _ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = _ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "val64"
          ],
          "line": 1305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "opal_node",
            "\"opal-runtime-alignment\"",
            "&val64",
            "sizeof(val64)"
          ],
          "line": 1304
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "val64"
          ],
          "line": 1300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "opal_node"
          ],
          "line": 1295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"opal_node: %x\\n\"",
            "opal_node"
          ],
          "line": 1294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/ibm,opal\""
          ],
          "line": 1293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_instantiate_opal: start...\\n\""
          ],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_instantiate_opal(void)\n{\n\tphandle opal_node;\n\tihandle opal_inst;\n\tu64 base, entry;\n\tu64 size = 0, align = 0x10000;\n\t__be64 val64;\n\tu32 rets[2];\n\n\tprom_debug(\"prom_instantiate_opal: start...\\n\");\n\n\topal_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/ibm,opal\"));\n\tprom_debug(\"opal_node: %x\\n\", opal_node);\n\tif (!PHANDLE_VALID(opal_node))\n\t\treturn;\n\n\tval64 = 0;\n\tprom_getprop(opal_node, \"opal-runtime-size\", &val64, sizeof(val64));\n\tsize = be64_to_cpu(val64);\n\tif (size == 0)\n\t\treturn;\n\tval64 = 0;\n\tprom_getprop(opal_node, \"opal-runtime-alignment\", &val64,sizeof(val64));\n\talign = be64_to_cpu(val64);\n\n\tbase = alloc_down(size, align, 0);\n\tif (base == 0) {\n\t\tprom_printf(\"OPAL allocation failed !\\n\");\n\t\treturn;\n\t}\n\n\topal_inst = call_prom(\"open\", 1, 1, ADDR(\"/ibm,opal\"));\n\tif (!IHANDLE_VALID(opal_inst)) {\n\t\tprom_printf(\"opening opal package failed (%x)\\n\", opal_inst);\n\t\treturn;\n\t}\n\n\tprom_printf(\"instantiating opal at 0x%x...\", base);\n\n\tif (call_prom_ret(\"call-method\", 4, 3, rets,\n\t\t\t  ADDR(\"load-opal-runtime\"),\n\t\t\t  opal_inst,\n\t\t\t  base >> 32, base & 0xffffffff) != 0\n\t    || (rets[0] == 0 && rets[1] == 0)) {\n\t\tprom_printf(\" failed\\n\");\n\t\treturn;\n\t}\n\tentry = (((u64)rets[0]) << 32) | rets[1];\n\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tprom_debug(\"opal base     = 0x%x\\n\", base);\n\tprom_debug(\"opal align    = 0x%x\\n\", align);\n\tprom_debug(\"opal entry    = 0x%x\\n\", entry);\n\tprom_debug(\"opal size     = 0x%x\\n\", (long)size);\n\n\tprom_setprop(opal_node, \"/ibm,opal\", \"opal-base-address\",\n\t\t     &base, sizeof(base));\n\tprom_setprop(opal_node, \"/ibm,opal\", \"opal-entry-address\",\n\t\t     &entry, sizeof(entry));\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_OPAL\n\tprom_opal_base = base;\n\tprom_opal_entry = entry;\n#endif\n\tprom_debug(\"prom_instantiate_opal: end...\\n\");\n}"
  },
  {
    "function_name": "prom_close_stdin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1261-1270",
    "snippet": "static void __init prom_close_stdin(void)\n{\n\t__be32 val;\n\tihandle stdin;\n\n\tif (prom_getprop(prom.chosen, \"stdin\", &val, sizeof(val)) > 0) {\n\t\tstdin = be32_to_cpu(val);\n\t\tcall_prom(\"close\", 1, 0, stdin);\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"close\"",
            "1",
            "0",
            "stdin"
          ],
          "line": 1268
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "val"
          ],
          "line": 1267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "prom.chosen",
            "\"stdin\"",
            "&val",
            "sizeof(val)"
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_close_stdin(void)\n{\n\t__be32 val;\n\tihandle stdin;\n\n\tif (prom_getprop(prom.chosen, \"stdin\", &val, sizeof(val)) > 0) {\n\t\tstdin = be32_to_cpu(val);\n\t\tcall_prom(\"close\", 1, 0, stdin);\n\t}\n}"
  },
  {
    "function_name": "prom_init_mem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1134-1259",
    "snippet": "static void __init prom_init_mem(void)\n{\n\tphandle node;\n\tchar *path, type[64];\n\tunsigned int plen;\n\tcell_t *p, *endp;\n\t__be32 val;\n\tu32 rac, rsc;\n\n\t/*\n\t * We iterate the memory nodes to find\n\t * 1) top of RMO (first node)\n\t * 2) top of memory\n\t */\n\tval = cpu_to_be32(2);\n\tprom_getprop(prom.root, \"#address-cells\", &val, sizeof(val));\n\trac = be32_to_cpu(val);\n\tval = cpu_to_be32(1);\n\tprom_getprop(prom.root, \"#size-cells\", &val, sizeof(rsc));\n\trsc = be32_to_cpu(val);\n\tprom_debug(\"root_addr_cells: %x\\n\", rac);\n\tprom_debug(\"root_size_cells: %x\\n\", rsc);\n\n\tprom_debug(\"scanning memory:\\n\");\n\tpath = prom_scratch;\n\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (type[0] == 0) {\n\t\t\t/*\n\t\t\t * CHRP Longtrail machines have no device_type\n\t\t\t * on the memory node, so check the name instead...\n\t\t\t */\n\t\t\tprom_getprop(node, \"name\", type, sizeof(type));\n\t\t}\n\t\tif (strcmp(type, \"memory\"))\n\t\t\tcontinue;\n\n\t\tplen = prom_getprop(node, \"reg\", regbuf, sizeof(regbuf));\n\t\tif (plen > sizeof(regbuf)) {\n\t\t\tprom_printf(\"memory node too large for buffer !\\n\");\n\t\t\tplen = sizeof(regbuf);\n\t\t}\n\t\tp = regbuf;\n\t\tendp = p + (plen / sizeof(cell_t));\n\n#ifdef DEBUG_PROM\n\t\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\t\tcall_prom(\"package-to-path\", 3, 1, node, path, PROM_SCRATCH_SIZE-1);\n\t\tprom_debug(\"  node %s :\\n\", path);\n#endif /* DEBUG_PROM */\n\n\t\twhile ((endp - p) >= (rac + rsc)) {\n\t\t\tunsigned long base, size;\n\n\t\t\tbase = prom_next_cell(rac, &p);\n\t\t\tsize = prom_next_cell(rsc, &p);\n\n\t\t\tif (size == 0)\n\t\t\t\tcontinue;\n\t\t\tprom_debug(\"    %x %x\\n\", base, size);\n\t\t\tif (base == 0 && (of_platform & PLATFORM_LPAR))\n\t\t\t\trmo_top = size;\n\t\t\tif ((base + size) > ram_top)\n\t\t\t\tram_top = base + size;\n\t\t}\n\t}\n\n\talloc_bottom = PAGE_ALIGN((unsigned long)&_end + 0x4000);\n\n\t/*\n\t * If prom_memory_limit is set we reduce the upper limits *except* for\n\t * alloc_top_high. This must be the real top of RAM so we can put\n\t * TCE's up there.\n\t */\n\n\talloc_top_high = ram_top;\n\n\tif (prom_memory_limit) {\n\t\tif (prom_memory_limit <= alloc_bottom) {\n\t\t\tprom_printf(\"Ignoring mem=%x <= alloc_bottom.\\n\",\n\t\t\t\tprom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else if (prom_memory_limit >= ram_top) {\n\t\t\tprom_printf(\"Ignoring mem=%x >= ram_top.\\n\",\n\t\t\t\tprom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else {\n\t\t\tram_top = prom_memory_limit;\n\t\t\trmo_top = min(rmo_top, prom_memory_limit);\n\t\t}\n\t}\n\n\t/*\n\t * Setup our top alloc point, that is top of RMO or top of\n\t * segment 0 when running non-LPAR.\n\t * Some RS64 machines have buggy firmware where claims up at\n\t * 1GB fail.  Cap at 768MB as a workaround.\n\t * Since 768MB is plenty of room, and we need to cap to something\n\t * reasonable on 32-bit, cap at 768MB on all machines.\n\t */\n\tif (!rmo_top)\n\t\trmo_top = ram_top;\n\trmo_top = min(0x30000000ul, rmo_top);\n\talloc_top = rmo_top;\n\talloc_top_high = ram_top;\n\n\t/*\n\t * Check if we have an initrd after the kernel but still inside\n\t * the RMO.  If we do move our bottom point to after it.\n\t */\n\tif (prom_initrd_start &&\n\t    prom_initrd_start < rmo_top &&\n\t    prom_initrd_end > alloc_bottom)\n\t\talloc_bottom = PAGE_ALIGN(prom_initrd_end);\n\n\tprom_printf(\"memory layout at init:\\n\");\n\tprom_printf(\"  memory_limit : %x (16 MB aligned)\\n\", prom_memory_limit);\n\tprom_printf(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_printf(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_printf(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_printf(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_printf(\"  ram_top      : %x\\n\", ram_top);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PLATFORM_LPAR\t\t0x0001",
      "#define PROM_SCRATCH_SIZE 256"
    ],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static unsigned long __initdata prom_initrd_start, prom_initrd_end;",
      "static unsigned long __initdata prom_memory_limit;",
      "static unsigned long __initdata alloc_top;",
      "static unsigned long __initdata alloc_top_high;",
      "static unsigned long __initdata alloc_bottom;",
      "static unsigned long __initdata rmo_top;",
      "static unsigned long __initdata ram_top;",
      "static cell_t __initdata regbuf[1024];",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"  ram_top      : %x\\n\"",
            "ram_top"
          ],
          "line": 1258
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "PAGE_ALIGN",
          "args": [
            "prom_initrd_end"
          ],
          "line": 1250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "0x30000000ul",
            "rmo_top"
          ],
          "line": 1239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "rmo_top",
            "prom_memory_limit"
          ],
          "line": 1225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PAGE_ALIGN",
          "args": [
            "(unsigned long)&_end + 0x4000"
          ],
          "line": 1204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    %x %x\\n\"",
            "base",
            "size"
          ],
          "line": 1196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_next_cell",
          "args": [
            "rsc",
            "&p"
          ],
          "line": 1192
        },
        "resolved": true,
        "details": {
          "function_name": "prom_next_cell",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1078-1097",
          "snippet": "static unsigned long __init prom_next_cell(int s, cell_t **cellp)\n{\n\tcell_t *p = *cellp;\n\tunsigned long r = 0;\n\n\t/* Ignore more than 2 cells */\n\twhile (s > sizeof(unsigned long) / 4) {\n\t\tp++;\n\t\ts--;\n\t}\n\tr = be32_to_cpu(*p++);\n#ifdef CONFIG_PPC64\n\tif (s > 1) {\n\t\tr <<= 32;\n\t\tr |= be32_to_cpu(*(p++));\n\t}\n#endif\n\t*cellp = p;\n\treturn r;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic unsigned long __init prom_next_cell(int s, cell_t **cellp)\n{\n\tcell_t *p = *cellp;\n\tunsigned long r = 0;\n\n\t/* Ignore more than 2 cells */\n\twhile (s > sizeof(unsigned long) / 4) {\n\t\tp++;\n\t\ts--;\n\t}\n\tr = be32_to_cpu(*p++);\n#ifdef CONFIG_PPC64\n\tif (s > 1) {\n\t\tr <<= 32;\n\t\tr |= be32_to_cpu(*(p++));\n\t}\n#endif\n\t*cellp = p;\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  node %s :\\n\"",
            "path"
          ],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"package-to-path\"",
            "3",
            "1",
            "node",
            "path",
            "PROM_SCRATCH_SIZE-1"
          ],
          "line": 1184
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "path",
            "0",
            "PROM_SCRATCH_SIZE"
          ],
          "line": 1183
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/io.c",
          "lines": "126-151",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"reg\"",
            "regbuf",
            "sizeof(regbuf)"
          ],
          "line": 1174
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "type",
            "\"memory\""
          ],
          "line": 1171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_next_node",
          "args": [
            "&node"
          ],
          "line": 1160
        },
        "resolved": true,
        "details": {
          "function_name": "prom_next_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "445-460",
          "snippet": "static int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"scanning memory:\\n\""
          ],
          "line": 1157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"root_size_cells: %x\\n\"",
            "rsc"
          ],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"root_addr_cells: %x\\n\"",
            "rac"
          ],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "val"
          ],
          "line": 1153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "1"
          ],
          "line": 1151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "val"
          ],
          "line": 1150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "2"
          ],
          "line": 1148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PLATFORM_LPAR\t\t0x0001\n#define PROM_SCRATCH_SIZE 256\n\nstatic struct prom_t __initdata prom;\nstatic unsigned long __initdata prom_initrd_start, prom_initrd_end;\nstatic unsigned long __initdata prom_memory_limit;\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_top_high;\nstatic unsigned long __initdata alloc_bottom;\nstatic unsigned long __initdata rmo_top;\nstatic unsigned long __initdata ram_top;\nstatic cell_t __initdata regbuf[1024];\nstatic void __init;\n\nstatic void __init prom_init_mem(void)\n{\n\tphandle node;\n\tchar *path, type[64];\n\tunsigned int plen;\n\tcell_t *p, *endp;\n\t__be32 val;\n\tu32 rac, rsc;\n\n\t/*\n\t * We iterate the memory nodes to find\n\t * 1) top of RMO (first node)\n\t * 2) top of memory\n\t */\n\tval = cpu_to_be32(2);\n\tprom_getprop(prom.root, \"#address-cells\", &val, sizeof(val));\n\trac = be32_to_cpu(val);\n\tval = cpu_to_be32(1);\n\tprom_getprop(prom.root, \"#size-cells\", &val, sizeof(rsc));\n\trsc = be32_to_cpu(val);\n\tprom_debug(\"root_addr_cells: %x\\n\", rac);\n\tprom_debug(\"root_size_cells: %x\\n\", rsc);\n\n\tprom_debug(\"scanning memory:\\n\");\n\tpath = prom_scratch;\n\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (type[0] == 0) {\n\t\t\t/*\n\t\t\t * CHRP Longtrail machines have no device_type\n\t\t\t * on the memory node, so check the name instead...\n\t\t\t */\n\t\t\tprom_getprop(node, \"name\", type, sizeof(type));\n\t\t}\n\t\tif (strcmp(type, \"memory\"))\n\t\t\tcontinue;\n\n\t\tplen = prom_getprop(node, \"reg\", regbuf, sizeof(regbuf));\n\t\tif (plen > sizeof(regbuf)) {\n\t\t\tprom_printf(\"memory node too large for buffer !\\n\");\n\t\t\tplen = sizeof(regbuf);\n\t\t}\n\t\tp = regbuf;\n\t\tendp = p + (plen / sizeof(cell_t));\n\n#ifdef DEBUG_PROM\n\t\tmemset(path, 0, PROM_SCRATCH_SIZE);\n\t\tcall_prom(\"package-to-path\", 3, 1, node, path, PROM_SCRATCH_SIZE-1);\n\t\tprom_debug(\"  node %s :\\n\", path);\n#endif /* DEBUG_PROM */\n\n\t\twhile ((endp - p) >= (rac + rsc)) {\n\t\t\tunsigned long base, size;\n\n\t\t\tbase = prom_next_cell(rac, &p);\n\t\t\tsize = prom_next_cell(rsc, &p);\n\n\t\t\tif (size == 0)\n\t\t\t\tcontinue;\n\t\t\tprom_debug(\"    %x %x\\n\", base, size);\n\t\t\tif (base == 0 && (of_platform & PLATFORM_LPAR))\n\t\t\t\trmo_top = size;\n\t\t\tif ((base + size) > ram_top)\n\t\t\t\tram_top = base + size;\n\t\t}\n\t}\n\n\talloc_bottom = PAGE_ALIGN((unsigned long)&_end + 0x4000);\n\n\t/*\n\t * If prom_memory_limit is set we reduce the upper limits *except* for\n\t * alloc_top_high. This must be the real top of RAM so we can put\n\t * TCE's up there.\n\t */\n\n\talloc_top_high = ram_top;\n\n\tif (prom_memory_limit) {\n\t\tif (prom_memory_limit <= alloc_bottom) {\n\t\t\tprom_printf(\"Ignoring mem=%x <= alloc_bottom.\\n\",\n\t\t\t\tprom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else if (prom_memory_limit >= ram_top) {\n\t\t\tprom_printf(\"Ignoring mem=%x >= ram_top.\\n\",\n\t\t\t\tprom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else {\n\t\t\tram_top = prom_memory_limit;\n\t\t\trmo_top = min(rmo_top, prom_memory_limit);\n\t\t}\n\t}\n\n\t/*\n\t * Setup our top alloc point, that is top of RMO or top of\n\t * segment 0 when running non-LPAR.\n\t * Some RS64 machines have buggy firmware where claims up at\n\t * 1GB fail.  Cap at 768MB as a workaround.\n\t * Since 768MB is plenty of room, and we need to cap to something\n\t * reasonable on 32-bit, cap at 768MB on all machines.\n\t */\n\tif (!rmo_top)\n\t\trmo_top = ram_top;\n\trmo_top = min(0x30000000ul, rmo_top);\n\talloc_top = rmo_top;\n\talloc_top_high = ram_top;\n\n\t/*\n\t * Check if we have an initrd after the kernel but still inside\n\t * the RMO.  If we do move our bottom point to after it.\n\t */\n\tif (prom_initrd_start &&\n\t    prom_initrd_start < rmo_top &&\n\t    prom_initrd_end > alloc_bottom)\n\t\talloc_bottom = PAGE_ALIGN(prom_initrd_end);\n\n\tprom_printf(\"memory layout at init:\\n\");\n\tprom_printf(\"  memory_limit : %x (16 MB aligned)\\n\", prom_memory_limit);\n\tprom_printf(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_printf(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_printf(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_printf(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_printf(\"  ram_top      : %x\\n\", ram_top);\n}"
  },
  {
    "function_name": "reserve_mem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1107-1128",
    "snippet": "static void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = _ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = _ALIGN_UP(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define MEM_RESERVE_MAP_SIZE\t8"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be64",
          "args": [
            "size"
          ],
          "line": 1126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be64",
          "args": [
            "base"
          ],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"Memory reserve map exhausted !\\n\""
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ALIGN_UP",
          "args": [
            "top",
            "PAGE_SIZE"
          ],
          "line": 1120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ALIGN_DOWN",
          "args": [
            "base",
            "PAGE_SIZE"
          ],
          "line": 1119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n\nstatic void __init;\n\nstatic void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = _ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = _ALIGN_UP(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}"
  },
  {
    "function_name": "prom_next_cell",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1078-1097",
    "snippet": "static unsigned long __init prom_next_cell(int s, cell_t **cellp)\n{\n\tcell_t *p = *cellp;\n\tunsigned long r = 0;\n\n\t/* Ignore more than 2 cells */\n\twhile (s > sizeof(unsigned long) / 4) {\n\t\tp++;\n\t\ts--;\n\t}\n\tr = be32_to_cpu(*p++);\n#ifdef CONFIG_PPC64\n\tif (s > 1) {\n\t\tr <<= 32;\n\t\tr |= be32_to_cpu(*(p++));\n\t}\n#endif\n\t*cellp = p;\n\treturn r;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*(p++)"
          ],
          "line": 1092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*p++"
          ],
          "line": 1088
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic unsigned long __init prom_next_cell(int s, cell_t **cellp)\n{\n\tcell_t *p = *cellp;\n\tunsigned long r = 0;\n\n\t/* Ignore more than 2 cells */\n\twhile (s > sizeof(unsigned long) / 4) {\n\t\tp++;\n\t\ts--;\n\t}\n\tr = be32_to_cpu(*p++);\n#ifdef CONFIG_PPC64\n\tif (s > 1) {\n\t\tr <<= 32;\n\t\tr |= be32_to_cpu(*(p++));\n\t}\n#endif\n\t*cellp = p;\n\treturn r;\n}"
  },
  {
    "function_name": "alloc_down",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1021-1073",
    "snippet": "static unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"alloc_down(%x, %x, %s)\\n\", size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = _ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = _ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = _ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static unsigned long __initdata alloc_top;",
      "static unsigned long __initdata alloc_top_high;",
      "static unsigned long __initdata alloc_bottom;",
      "static unsigned long __initdata rmo_top;",
      "static unsigned long __initdata ram_top;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  ram_top      : %x\\n\"",
            "ram_top"
          ],
          "line": 1070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  rmo_top      : %x\\n\"",
            "rmo_top"
          ],
          "line": 1069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  alloc_top_hi : %x\\n\"",
            "alloc_top_high"
          ],
          "line": 1068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  alloc_top    : %x\\n\"",
            "alloc_top"
          ],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  alloc_bottom : %x\\n\"",
            "alloc_bottom"
          ],
          "line": 1066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\" -> %x\\n\"",
            "addr"
          ],
          "line": 1065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_claim",
          "args": [
            "base",
            "size",
            "0"
          ],
          "line": 1055
        },
        "resolved": true,
        "details": {
          "function_name": "prom_claim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "395-427",
          "snippet": "static unsigned int __init prom_claim(unsigned long virt, unsigned long size,\n\t\t\t\tunsigned long align)\n{\n\n\tif (align == 0 && (OF_WORKAROUNDS & OF_WA_CLAIM)) {\n\t\t/*\n\t\t * Old OF requires we claim physical and virtual separately\n\t\t * and then map explicitly (assuming virtual mode)\n\t\t */\n\t\tint ret;\n\t\tprom_arg_t result;\n\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.memory,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0 || result == -1)\n\t\t\treturn -1;\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.mmumap,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0) {\n\t\t\tcall_prom(\"call-method\", 4, 1, ADDR(\"release\"),\n\t\t\t\t  prom.memory, size, virt);\n\t\t\treturn -1;\n\t\t}\n\t\t/* the 0x12 is M (coherence) + PP == read/write */\n\t\tcall_prom(\"call-method\", 6, 1,\n\t\t\t  ADDR(\"map\"), prom.mmumap, 0x12, size, virt, virt);\n\t\treturn virt;\n\t}\n\treturn call_prom(\"claim\", 3, 1, (prom_arg_t)virt, (prom_arg_t)size,\n\t\t\t (prom_arg_t)align);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic unsigned int __init prom_claim(unsigned long virt, unsigned long size,\n\t\t\t\tunsigned long align)\n{\n\n\tif (align == 0 && (OF_WORKAROUNDS & OF_WA_CLAIM)) {\n\t\t/*\n\t\t * Old OF requires we claim physical and virtual separately\n\t\t * and then map explicitly (assuming virtual mode)\n\t\t */\n\t\tint ret;\n\t\tprom_arg_t result;\n\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.memory,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0 || result == -1)\n\t\t\treturn -1;\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.mmumap,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0) {\n\t\t\tcall_prom(\"call-method\", 4, 1, ADDR(\"release\"),\n\t\t\t\t  prom.memory, size, virt);\n\t\t\treturn -1;\n\t\t}\n\t\t/* the 0x12 is M (coherence) + PP == read/write */\n\t\tcall_prom(\"call-method\", 6, 1,\n\t\t\t  ADDR(\"map\"), prom.mmumap, 0x12, size, virt, virt);\n\t\treturn virt;\n\t}\n\treturn call_prom(\"claim\", 3, 1, (prom_arg_t)virt, (prom_arg_t)size,\n\t\t\t (prom_arg_t)align);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    trying: 0x%x\\n\\r\"",
            "base"
          ],
          "line": 1054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ALIGN_DOWN",
          "args": [
            "base - 0x100000",
            "align"
          ],
          "line": 1053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ALIGN_DOWN",
          "args": [
            "alloc_top - size",
            "align"
          ],
          "line": 1051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ALIGN_DOWN",
          "args": [
            "alloc_top_high - size",
            "align"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"alloc_down() called with mem not initialized\\n\""
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"alloc_down(%x, %x, %s)\\n\"",
            "size",
            "align",
            "highmem ? \"(high)\" : \"(low)\""
          ],
          "line": 1026
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_top_high;\nstatic unsigned long __initdata alloc_bottom;\nstatic unsigned long __initdata rmo_top;\nstatic unsigned long __initdata ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"alloc_down(%x, %x, %s)\\n\", size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = _ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = _ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = _ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}"
  },
  {
    "function_name": "alloc_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "976-1014",
    "snippet": "static unsigned long __init alloc_up(unsigned long size, unsigned long align)\n{\n\tunsigned long base = alloc_bottom;\n\tunsigned long addr = 0;\n\n\tif (align)\n\t\tbase = _ALIGN_UP(base, align);\n\tprom_debug(\"alloc_up(%x, %x)\\n\", size, align);\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_up() called with mem not initialized\\n\");\n\n\tif (align)\n\t\tbase = _ALIGN_UP(alloc_bottom, align);\n\telse\n\t\tbase = alloc_bottom;\n\n\tfor(; (base + size) <= alloc_top; \n\t    base = _ALIGN_UP(base + 0x100000, align)) {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t\tif (align == 0)\n\t\t\tbreak;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_bottom = addr + size;\n\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static unsigned long __initdata alloc_top;",
      "static unsigned long __initdata alloc_top_high;",
      "static unsigned long __initdata alloc_bottom;",
      "static unsigned long __initdata rmo_top;",
      "static unsigned long __initdata ram_top;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  ram_top      : %x\\n\"",
            "ram_top"
          ],
          "line": 1011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  rmo_top      : %x\\n\"",
            "rmo_top"
          ],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  alloc_top_hi : %x\\n\"",
            "alloc_top_high"
          ],
          "line": 1009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  alloc_top    : %x\\n\"",
            "alloc_top"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  alloc_bottom : %x\\n\"",
            "alloc_bottom"
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\" -> %x\\n\"",
            "addr"
          ],
          "line": 1006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_claim",
          "args": [
            "base",
            "size",
            "0"
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "prom_claim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "395-427",
          "snippet": "static unsigned int __init prom_claim(unsigned long virt, unsigned long size,\n\t\t\t\tunsigned long align)\n{\n\n\tif (align == 0 && (OF_WORKAROUNDS & OF_WA_CLAIM)) {\n\t\t/*\n\t\t * Old OF requires we claim physical and virtual separately\n\t\t * and then map explicitly (assuming virtual mode)\n\t\t */\n\t\tint ret;\n\t\tprom_arg_t result;\n\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.memory,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0 || result == -1)\n\t\t\treturn -1;\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.mmumap,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0) {\n\t\t\tcall_prom(\"call-method\", 4, 1, ADDR(\"release\"),\n\t\t\t\t  prom.memory, size, virt);\n\t\t\treturn -1;\n\t\t}\n\t\t/* the 0x12 is M (coherence) + PP == read/write */\n\t\tcall_prom(\"call-method\", 6, 1,\n\t\t\t  ADDR(\"map\"), prom.mmumap, 0x12, size, virt, virt);\n\t\treturn virt;\n\t}\n\treturn call_prom(\"claim\", 3, 1, (prom_arg_t)virt, (prom_arg_t)size,\n\t\t\t (prom_arg_t)align);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic unsigned int __init prom_claim(unsigned long virt, unsigned long size,\n\t\t\t\tunsigned long align)\n{\n\n\tif (align == 0 && (OF_WORKAROUNDS & OF_WA_CLAIM)) {\n\t\t/*\n\t\t * Old OF requires we claim physical and virtual separately\n\t\t * and then map explicitly (assuming virtual mode)\n\t\t */\n\t\tint ret;\n\t\tprom_arg_t result;\n\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.memory,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0 || result == -1)\n\t\t\treturn -1;\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.mmumap,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0) {\n\t\t\tcall_prom(\"call-method\", 4, 1, ADDR(\"release\"),\n\t\t\t\t  prom.memory, size, virt);\n\t\t\treturn -1;\n\t\t}\n\t\t/* the 0x12 is M (coherence) + PP == read/write */\n\t\tcall_prom(\"call-method\", 6, 1,\n\t\t\t  ADDR(\"map\"), prom.mmumap, 0x12, size, virt, virt);\n\t\treturn virt;\n\t}\n\treturn call_prom(\"claim\", 3, 1, (prom_arg_t)virt, (prom_arg_t)size,\n\t\t\t (prom_arg_t)align);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    trying: 0x%x\\n\\r\"",
            "base"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ALIGN_UP",
          "args": [
            "base + 0x100000",
            "align"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ALIGN_UP",
          "args": [
            "alloc_bottom",
            "align"
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"alloc_up() called with mem not initialized\\n\""
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"alloc_up(%x, %x)\\n\"",
            "size",
            "align"
          ],
          "line": 983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ALIGN_UP",
          "args": [
            "base",
            "align"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __initdata alloc_top;\nstatic unsigned long __initdata alloc_top_high;\nstatic unsigned long __initdata alloc_bottom;\nstatic unsigned long __initdata rmo_top;\nstatic unsigned long __initdata ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_up(unsigned long size, unsigned long align)\n{\n\tunsigned long base = alloc_bottom;\n\tunsigned long addr = 0;\n\n\tif (align)\n\t\tbase = _ALIGN_UP(base, align);\n\tprom_debug(\"alloc_up(%x, %x)\\n\", size, align);\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_up() called with mem not initialized\\n\");\n\n\tif (align)\n\t\tbase = _ALIGN_UP(alloc_bottom, align);\n\telse\n\t\tbase = alloc_bottom;\n\n\tfor(; (base + size) <= alloc_top; \n\t    base = _ALIGN_UP(base + 0x100000, align)) {\n\t\tprom_debug(\"    trying: 0x%x\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t\tif (align == 0)\n\t\t\tbreak;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_bottom = addr + size;\n\n\tprom_debug(\" -> %x\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %x\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %x\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %x\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %x\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %x\\n\", ram_top);\n\n\treturn addr;\n}"
  },
  {
    "function_name": "prom_send_capabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "865-940",
    "snippet": "static void __init prom_send_capabilities(void)\n{\n\tihandle root;\n\tprom_arg_t ret;\n\tu32 cores;\n\tunsigned char *ptcores;\n\n\troot = call_prom(\"open\", 1, 1, ADDR(\"/\"));\n\tif (root != 0) {\n\t\t/* We need to tell the FW about the number of cores we support.\n\t\t *\n\t\t * To do that, we count the number of threads on the first core\n\t\t * (we assume this is the same for all cores) and use it to\n\t\t * divide NR_CPUS.\n\t\t */\n\n\t\t/* The core value may start at an odd address. If such a word\n\t\t * access is made at a cache line boundary, this leads to an\n\t\t * exception which may not be handled at this time.\n\t\t * Forcing a per byte access to avoid exception.\n\t\t */\n\t\tptcores = &ibm_architecture_vec[IBM_ARCH_VEC_NRCORES_OFFSET];\n\t\tcores = 0;\n\t\tcores |= ptcores[0] << 24;\n\t\tcores |= ptcores[1] << 16;\n\t\tcores |= ptcores[2] << 8;\n\t\tcores |= ptcores[3];\n\t\tif (cores != NR_CPUS) {\n\t\t\tprom_printf(\"WARNING ! \"\n\t\t\t\t    \"ibm_architecture_vec structure inconsistent: %lu!\\n\",\n\t\t\t\t    cores);\n\t\t} else {\n\t\t\tcores = DIV_ROUND_UP(NR_CPUS, prom_count_smt_threads());\n\t\t\tprom_printf(\"Max number of cores passed to firmware: %lu (NR_CPUS = %lu)\\n\",\n\t\t\t\t    cores, NR_CPUS);\n\t\t\tptcores[0] = (cores >> 24) & 0xff;\n\t\t\tptcores[1] = (cores >> 16) & 0xff;\n\t\t\tptcores[2] = (cores >> 8) & 0xff;\n\t\t\tptcores[3] = cores & 0xff;\n\t\t}\n\n\t\t/* try calling the ibm,client-architecture-support method */\n\t\tprom_printf(\"Calling ibm,client-architecture-support...\");\n\t\tif (call_prom_ret(\"call-method\", 3, 2, &ret,\n\t\t\t\t  ADDR(\"ibm,client-architecture-support\"),\n\t\t\t\t  root,\n\t\t\t\t  ADDR(ibm_architecture_vec)) == 0) {\n\t\t\t/* the call exists... */\n\t\t\tif (ret)\n\t\t\t\tprom_printf(\"\\nWARNING: ibm,client-architecture\"\n\t\t\t\t\t    \"-support call FAILED!\\n\");\n\t\t\tcall_prom(\"close\", 1, 0, root);\n\t\t\tprom_printf(\" done\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"close\", 1, 0, root);\n\t\tprom_printf(\" not implemented\\n\");\n\t}\n\n#ifdef __BIG_ENDIAN__\n\t{\n\t\tihandle elfloader;\n\n\t\t/* no ibm,client-architecture-support call, try the old way */\n\t\telfloader = call_prom(\"open\", 1, 1,\n\t\t\t\t      ADDR(\"/packages/elf-loader\"));\n\t\tif (elfloader == 0) {\n\t\t\tprom_printf(\"couldn't open /packages/elf-loader\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"call-method\", 3, 1, ADDR(\"process-elf-header\"),\n\t\t\t  elfloader, ADDR(&fake_elf));\n\t\tcall_prom(\"close\", 1, 0, elfloader);\n\t}\n#endif /* __BIG_ENDIAN__ */\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"close\"",
            "1",
            "0",
            "elfloader"
          ],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "&fake_elf"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"process-elf-header\""
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"couldn't open /packages/elf-loader\\n\""
          ],
          "line": 932
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/packages/elf-loader\""
          ],
          "line": 930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "ibm_architecture_vec"
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"ibm,client-architecture-support\""
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "NR_CPUS",
            "prom_count_smt_threads()"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_count_smt_threads",
          "args": [],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "prom_count_smt_threads",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "826-862",
          "snippet": "static int __init prom_count_smt_threads(void)\n{\n\tphandle node;\n\tchar type[64];\n\tunsigned int plen;\n\n\t/* Pick up th first CPU node we can find */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (strcmp(type, \"cpu\"))\n\t\t\tcontinue;\n\t\t/*\n\t\t * There is an entry for each smt thread, each entry being\n\t\t * 4 bytes long.  All cpus should have the same number of\n\t\t * smt threads, so return after finding the first.\n\t\t */\n\t\tplen = prom_getproplen(node, \"ibm,ppc-interrupt-server#s\");\n\t\tif (plen == PROM_ERROR)\n\t\t\tbreak;\n\t\tplen >>= 2;\n\t\tprom_debug(\"Found %lu smt threads per core\\n\", (unsigned long)plen);\n\n\t\t/* Sanity check */\n\t\tif (plen < 1 || plen > 64) {\n\t\t\tprom_printf(\"Threads per core %lu out of bounds, assuming 1\\n\",\n\t\t\t\t    (unsigned long)plen);\n\t\t\treturn 1;\n\t\t}\n\t\treturn plen;\n\t}\n\tprom_debug(\"No threads found, assuming 1 per core\\n\");\n\n\treturn 1;\n\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init prom_count_smt_threads(void)\n{\n\tphandle node;\n\tchar type[64];\n\tunsigned int plen;\n\n\t/* Pick up th first CPU node we can find */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (strcmp(type, \"cpu\"))\n\t\t\tcontinue;\n\t\t/*\n\t\t * There is an entry for each smt thread, each entry being\n\t\t * 4 bytes long.  All cpus should have the same number of\n\t\t * smt threads, so return after finding the first.\n\t\t */\n\t\tplen = prom_getproplen(node, \"ibm,ppc-interrupt-server#s\");\n\t\tif (plen == PROM_ERROR)\n\t\t\tbreak;\n\t\tplen >>= 2;\n\t\tprom_debug(\"Found %lu smt threads per core\\n\", (unsigned long)plen);\n\n\t\t/* Sanity check */\n\t\tif (plen < 1 || plen > 64) {\n\t\t\tprom_printf(\"Threads per core %lu out of bounds, assuming 1\\n\",\n\t\t\t\t    (unsigned long)plen);\n\t\t\treturn 1;\n\t\t}\n\t\treturn plen;\n\t}\n\tprom_debug(\"No threads found, assuming 1 per core\\n\");\n\n\treturn 1;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/\""
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_send_capabilities(void)\n{\n\tihandle root;\n\tprom_arg_t ret;\n\tu32 cores;\n\tunsigned char *ptcores;\n\n\troot = call_prom(\"open\", 1, 1, ADDR(\"/\"));\n\tif (root != 0) {\n\t\t/* We need to tell the FW about the number of cores we support.\n\t\t *\n\t\t * To do that, we count the number of threads on the first core\n\t\t * (we assume this is the same for all cores) and use it to\n\t\t * divide NR_CPUS.\n\t\t */\n\n\t\t/* The core value may start at an odd address. If such a word\n\t\t * access is made at a cache line boundary, this leads to an\n\t\t * exception which may not be handled at this time.\n\t\t * Forcing a per byte access to avoid exception.\n\t\t */\n\t\tptcores = &ibm_architecture_vec[IBM_ARCH_VEC_NRCORES_OFFSET];\n\t\tcores = 0;\n\t\tcores |= ptcores[0] << 24;\n\t\tcores |= ptcores[1] << 16;\n\t\tcores |= ptcores[2] << 8;\n\t\tcores |= ptcores[3];\n\t\tif (cores != NR_CPUS) {\n\t\t\tprom_printf(\"WARNING ! \"\n\t\t\t\t    \"ibm_architecture_vec structure inconsistent: %lu!\\n\",\n\t\t\t\t    cores);\n\t\t} else {\n\t\t\tcores = DIV_ROUND_UP(NR_CPUS, prom_count_smt_threads());\n\t\t\tprom_printf(\"Max number of cores passed to firmware: %lu (NR_CPUS = %lu)\\n\",\n\t\t\t\t    cores, NR_CPUS);\n\t\t\tptcores[0] = (cores >> 24) & 0xff;\n\t\t\tptcores[1] = (cores >> 16) & 0xff;\n\t\t\tptcores[2] = (cores >> 8) & 0xff;\n\t\t\tptcores[3] = cores & 0xff;\n\t\t}\n\n\t\t/* try calling the ibm,client-architecture-support method */\n\t\tprom_printf(\"Calling ibm,client-architecture-support...\");\n\t\tif (call_prom_ret(\"call-method\", 3, 2, &ret,\n\t\t\t\t  ADDR(\"ibm,client-architecture-support\"),\n\t\t\t\t  root,\n\t\t\t\t  ADDR(ibm_architecture_vec)) == 0) {\n\t\t\t/* the call exists... */\n\t\t\tif (ret)\n\t\t\t\tprom_printf(\"\\nWARNING: ibm,client-architecture\"\n\t\t\t\t\t    \"-support call FAILED!\\n\");\n\t\t\tcall_prom(\"close\", 1, 0, root);\n\t\t\tprom_printf(\" done\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"close\", 1, 0, root);\n\t\tprom_printf(\" not implemented\\n\");\n\t}\n\n#ifdef __BIG_ENDIAN__\n\t{\n\t\tihandle elfloader;\n\n\t\t/* no ibm,client-architecture-support call, try the old way */\n\t\telfloader = call_prom(\"open\", 1, 1,\n\t\t\t\t      ADDR(\"/packages/elf-loader\"));\n\t\tif (elfloader == 0) {\n\t\t\tprom_printf(\"couldn't open /packages/elf-loader\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"call-method\", 3, 1, ADDR(\"process-elf-header\"),\n\t\t\t  elfloader, ADDR(&fake_elf));\n\t\tcall_prom(\"close\", 1, 0, elfloader);\n\t}\n#endif /* __BIG_ENDIAN__ */\n}"
  },
  {
    "function_name": "prom_count_smt_threads",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "826-862",
    "snippet": "static int __init prom_count_smt_threads(void)\n{\n\tphandle node;\n\tchar type[64];\n\tunsigned int plen;\n\n\t/* Pick up th first CPU node we can find */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (strcmp(type, \"cpu\"))\n\t\t\tcontinue;\n\t\t/*\n\t\t * There is an entry for each smt thread, each entry being\n\t\t * 4 bytes long.  All cpus should have the same number of\n\t\t * smt threads, so return after finding the first.\n\t\t */\n\t\tplen = prom_getproplen(node, \"ibm,ppc-interrupt-server#s\");\n\t\tif (plen == PROM_ERROR)\n\t\t\tbreak;\n\t\tplen >>= 2;\n\t\tprom_debug(\"Found %lu smt threads per core\\n\", (unsigned long)plen);\n\n\t\t/* Sanity check */\n\t\tif (plen < 1 || plen > 64) {\n\t\t\tprom_printf(\"Threads per core %lu out of bounds, assuming 1\\n\",\n\t\t\t\t    (unsigned long)plen);\n\t\t\treturn 1;\n\t\t}\n\t\treturn plen;\n\t}\n\tprom_debug(\"No threads found, assuming 1 per core\\n\");\n\n\treturn 1;\n\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"No threads found, assuming 1 per core\\n\""
          ],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Threads per core %lu out of bounds, assuming 1\\n\"",
            "(unsigned long)plen"
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Found %lu smt threads per core\\n\"",
            "(unsigned long)plen"
          ],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "node",
            "\"ibm,ppc-interrupt-server#s\""
          ],
          "line": 844
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "469-472",
          "snippet": "static int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "type",
            "\"cpu\""
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"device_type\"",
            "type",
            "sizeof(type)"
          ],
          "line": 835
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_next_node",
          "args": [
            "&node"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "prom_next_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "445-460",
          "snippet": "static int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init prom_count_smt_threads(void)\n{\n\tphandle node;\n\tchar type[64];\n\tunsigned int plen;\n\n\t/* Pick up th first CPU node we can find */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (strcmp(type, \"cpu\"))\n\t\t\tcontinue;\n\t\t/*\n\t\t * There is an entry for each smt thread, each entry being\n\t\t * 4 bytes long.  All cpus should have the same number of\n\t\t * smt threads, so return after finding the first.\n\t\t */\n\t\tplen = prom_getproplen(node, \"ibm,ppc-interrupt-server#s\");\n\t\tif (plen == PROM_ERROR)\n\t\t\tbreak;\n\t\tplen >>= 2;\n\t\tprom_debug(\"Found %lu smt threads per core\\n\", (unsigned long)plen);\n\n\t\t/* Sanity check */\n\t\tif (plen < 1 || plen > 64) {\n\t\t\tprom_printf(\"Threads per core %lu out of bounds, assuming 1\\n\",\n\t\t\t\t    (unsigned long)plen);\n\t\t\treturn 1;\n\t\t}\n\t\treturn plen;\n\t}\n\tprom_debug(\"No threads found, assuming 1 per core\\n\");\n\n\treturn 1;\n\n}"
  },
  {
    "function_name": "early_cmdline_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "587-627",
    "snippet": "static void __init early_cmdline_parse(void)\n{\n\tconst char *opt;\n\n\tchar *p;\n\tint l = 0;\n\n\tprom_cmd_line[0] = 0;\n\tp = prom_cmd_line;\n\tif ((long)prom.chosen > 0)\n\t\tl = prom_getprop(prom.chosen, \"bootargs\", p, COMMAND_LINE_SIZE-1);\n#ifdef CONFIG_CMDLINE\n\tif (l <= 0 || p[0] == '\\0') /* dbl check */\n\t\tstrlcpy(prom_cmd_line,\n\t\t\tCONFIG_CMDLINE, sizeof(prom_cmd_line));\n#endif /* CONFIG_CMDLINE */\n\tprom_printf(\"command line: %s\\n\", prom_cmd_line);\n\n#ifdef CONFIG_PPC64\n\topt = strstr(prom_cmd_line, \"iommu=\");\n\tif (opt) {\n\t\tprom_printf(\"iommu opt is: %s\\n\", opt);\n\t\topt += 6;\n\t\twhile (*opt && *opt == ' ')\n\t\t\topt++;\n\t\tif (!strncmp(opt, \"off\", 3))\n\t\t\tprom_iommu_off = 1;\n\t\telse if (!strncmp(opt, \"force\", 5))\n\t\t\tprom_iommu_force_on = 1;\n\t}\n#endif\n\topt = strstr(prom_cmd_line, \"mem=\");\n\tif (opt) {\n\t\topt += 4;\n\t\tprom_memory_limit = prom_memparse(opt, (const char **)&opt);\n#ifdef CONFIG_PPC64\n\t\t/* Align to 16 MB == size of ppc64 large page */\n\t\tprom_memory_limit = ALIGN(prom_memory_limit, 0x1000000);\n#endif\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static unsigned long __initdata prom_memory_limit;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "prom_memory_limit",
            "0x1000000"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_memparse",
          "args": [
            "opt",
            "(const char **)&opt"
          ],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "prom_memparse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "556-581",
          "snippet": "static unsigned long prom_memparse(const char *ptr, const char **retptr)\n{\n\tunsigned long ret = prom_strtoul(ptr, retptr);\n\tint shift = 0;\n\n\t/*\n\t * We can't use a switch here because GCC *may* generate a\n\t * jump table which won't work, because we're not running at\n\t * the address we're linked at.\n\t */\n\tif ('G' == **retptr || 'g' == **retptr)\n\t\tshift = 30;\n\n\tif ('M' == **retptr || 'm' == **retptr)\n\t\tshift = 20;\n\n\tif ('K' == **retptr || 'k' == **retptr)\n\t\tshift = 10;\n\n\tif (shift) {\n\t\tret <<= shift;\n\t\t(*retptr)++;\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long prom_memparse(const char *ptr, const char **retptr)\n{\n\tunsigned long ret = prom_strtoul(ptr, retptr);\n\tint shift = 0;\n\n\t/*\n\t * We can't use a switch here because GCC *may* generate a\n\t * jump table which won't work, because we're not running at\n\t * the address we're linked at.\n\t */\n\tif ('G' == **retptr || 'g' == **retptr)\n\t\tshift = 30;\n\n\tif ('M' == **retptr || 'm' == **retptr)\n\t\tshift = 20;\n\n\tif ('K' == **retptr || 'k' == **retptr)\n\t\tshift = 10;\n\n\tif (shift) {\n\t\tret <<= shift;\n\t\t(*retptr)++;\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "prom_cmd_line",
            "\"mem=\""
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "opt",
            "\"force\"",
            "5"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "opt",
            "\"off\"",
            "3"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"iommu opt is: %s\\n\"",
            "opt"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "prom_cmd_line",
            "\"iommu=\""
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "prom_cmd_line",
            "CONFIG_CMDLINE",
            "sizeof(prom_cmd_line)"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "prom.chosen",
            "\"bootargs\"",
            "p",
            "COMMAND_LINE_SIZE-1"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "462-467",
          "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic unsigned long __initdata prom_memory_limit;\nstatic void __init;\n\nstatic void __init early_cmdline_parse(void)\n{\n\tconst char *opt;\n\n\tchar *p;\n\tint l = 0;\n\n\tprom_cmd_line[0] = 0;\n\tp = prom_cmd_line;\n\tif ((long)prom.chosen > 0)\n\t\tl = prom_getprop(prom.chosen, \"bootargs\", p, COMMAND_LINE_SIZE-1);\n#ifdef CONFIG_CMDLINE\n\tif (l <= 0 || p[0] == '\\0') /* dbl check */\n\t\tstrlcpy(prom_cmd_line,\n\t\t\tCONFIG_CMDLINE, sizeof(prom_cmd_line));\n#endif /* CONFIG_CMDLINE */\n\tprom_printf(\"command line: %s\\n\", prom_cmd_line);\n\n#ifdef CONFIG_PPC64\n\topt = strstr(prom_cmd_line, \"iommu=\");\n\tif (opt) {\n\t\tprom_printf(\"iommu opt is: %s\\n\", opt);\n\t\topt += 6;\n\t\twhile (*opt && *opt == ' ')\n\t\t\topt++;\n\t\tif (!strncmp(opt, \"off\", 3))\n\t\t\tprom_iommu_off = 1;\n\t\telse if (!strncmp(opt, \"force\", 5))\n\t\t\tprom_iommu_force_on = 1;\n\t}\n#endif\n\topt = strstr(prom_cmd_line, \"mem=\");\n\tif (opt) {\n\t\topt += 4;\n\t\tprom_memory_limit = prom_memparse(opt, (const char **)&opt);\n#ifdef CONFIG_PPC64\n\t\t/* Align to 16 MB == size of ppc64 large page */\n\t\tprom_memory_limit = ALIGN(prom_memory_limit, 0x1000000);\n#endif\n\t}\n}"
  },
  {
    "function_name": "prom_memparse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "556-581",
    "snippet": "static unsigned long prom_memparse(const char *ptr, const char **retptr)\n{\n\tunsigned long ret = prom_strtoul(ptr, retptr);\n\tint shift = 0;\n\n\t/*\n\t * We can't use a switch here because GCC *may* generate a\n\t * jump table which won't work, because we're not running at\n\t * the address we're linked at.\n\t */\n\tif ('G' == **retptr || 'g' == **retptr)\n\t\tshift = 30;\n\n\tif ('M' == **retptr || 'm' == **retptr)\n\t\tshift = 20;\n\n\tif ('K' == **retptr || 'k' == **retptr)\n\t\tshift = 10;\n\n\tif (shift) {\n\t\tret <<= shift;\n\t\t(*retptr)++;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_strtoul",
          "args": [
            "ptr",
            "retptr"
          ],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strtoul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "531-554",
          "snippet": "static unsigned long prom_strtoul(const char *cp, const char **endp)\n{\n\tunsigned long result = 0, base = 10, value;\n\n\tif (*cp == '0') {\n\t\tbase = 8;\n\t\tcp++;\n\t\tif (toupper(*cp) == 'X') {\n\t\t\tcp++;\n\t\t\tbase = 16;\n\t\t}\n\t}\n\n\twhile (isxdigit(*cp) &&\n\t       (value = isdigit(*cp) ? *cp - '0' : toupper(*cp) - 'A' + 10) < base) {\n\t\tresult = result * base + value;\n\t\tcp++;\n\t}\n\n\tif (endp)\n\t\t*endp = cp;\n\n\treturn result;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long prom_strtoul(const char *cp, const char **endp)\n{\n\tunsigned long result = 0, base = 10, value;\n\n\tif (*cp == '0') {\n\t\tbase = 8;\n\t\tcp++;\n\t\tif (toupper(*cp) == 'X') {\n\t\t\tcp++;\n\t\t\tbase = 16;\n\t\t}\n\t}\n\n\twhile (isxdigit(*cp) &&\n\t       (value = isdigit(*cp) ? *cp - '0' : toupper(*cp) - 'A' + 10) < base) {\n\t\tresult = result * base + value;\n\t\tcp++;\n\t}\n\n\tif (endp)\n\t\t*endp = cp;\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long prom_memparse(const char *ptr, const char **retptr)\n{\n\tunsigned long ret = prom_strtoul(ptr, retptr);\n\tint shift = 0;\n\n\t/*\n\t * We can't use a switch here because GCC *may* generate a\n\t * jump table which won't work, because we're not running at\n\t * the address we're linked at.\n\t */\n\tif ('G' == **retptr || 'g' == **retptr)\n\t\tshift = 30;\n\n\tif ('M' == **retptr || 'm' == **retptr)\n\t\tshift = 20;\n\n\tif ('K' == **retptr || 'k' == **retptr)\n\t\tshift = 10;\n\n\tif (shift) {\n\t\tret <<= shift;\n\t\t(*retptr)++;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "prom_strtoul",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "531-554",
    "snippet": "static unsigned long prom_strtoul(const char *cp, const char **endp)\n{\n\tunsigned long result = 0, base = 10, value;\n\n\tif (*cp == '0') {\n\t\tbase = 8;\n\t\tcp++;\n\t\tif (toupper(*cp) == 'X') {\n\t\t\tcp++;\n\t\t\tbase = 16;\n\t\t}\n\t}\n\n\twhile (isxdigit(*cp) &&\n\t       (value = isdigit(*cp) ? *cp - '0' : toupper(*cp) - 'A' + 10) < base) {\n\t\tresult = result * base + value;\n\t\tcp++;\n\t}\n\n\tif (endp)\n\t\t*endp = cp;\n\n\treturn result;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "toupper",
          "args": [
            "*cp"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*cp"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isxdigit",
          "args": [
            "*cp"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toupper",
          "args": [
            "*cp"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long prom_strtoul(const char *cp, const char **endp)\n{\n\tunsigned long result = 0, base = 10, value;\n\n\tif (*cp == '0') {\n\t\tbase = 8;\n\t\tcp++;\n\t\tif (toupper(*cp) == 'X') {\n\t\t\tcp++;\n\t\t\tbase = 16;\n\t\t}\n\t}\n\n\twhile (isxdigit(*cp) &&\n\t       (value = isdigit(*cp) ? *cp - '0' : toupper(*cp) - 'A' + 10) < base) {\n\t\tresult = result * base + value;\n\t\tcp++;\n\t}\n\n\tif (endp)\n\t\t*endp = cp;\n\n\treturn result;\n}"
  },
  {
    "function_name": "prom_setprop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "500-520",
    "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
      "#define OF_WORKAROUNDS\tof_workarounds",
      "#define OF_WORKAROUNDS\t0"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"interpret\"",
            "1",
            "1",
            "(u32)(unsigned long) cmd"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_string",
          "args": [
            "&p",
            "\"property\""
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "add_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "474-482",
          "snippet": "static void add_string(char **str, const char *q)\n{\n\tchar *p = *str;\n\n\twhile (*q)\n\t\t*p++ = *q++;\n\t*p++ = ' ';\n\t*str = p;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void add_string(char **str, const char *q)\n{\n\tchar *p = *str;\n\n\twhile (*q)\n\t\t*p++ = *q++;\n\t*p++ = ' ';\n\t*str = p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "tohex",
          "args": [
            "strlen(pname)"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "tohex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "484-498",
          "snippet": "static char *tohex(unsigned int x)\n{\n\tstatic char digits[] = \"0123456789abcdef\";\n\tstatic char result[9];\n\tint i;\n\n\tresult[8] = 0;\n\ti = 8;\n\tdo {\n\t\t--i;\n\t\tresult[i] = digits[x & 0xf];\n\t\tx >>= 4;\n\t} while (x != 0 && i > 0);\n\treturn &result[i];\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic char *tohex(unsigned int x)\n{\n\tstatic char digits[] = \"0123456789abcdef\";\n\tstatic char result[9];\n\tint i;\n\n\tresult[8] = 0;\n\ti = 8;\n\tdo {\n\t\t--i;\n\t\tresult[i] = digits[x & 0xf];\n\t\tx >>= 4;\n\t} while (x != 0 && i > 0);\n\treturn &result[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pname"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "pname"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "pname"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
  },
  {
    "function_name": "tohex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "484-498",
    "snippet": "static char *tohex(unsigned int x)\n{\n\tstatic char digits[] = \"0123456789abcdef\";\n\tstatic char result[9];\n\tint i;\n\n\tresult[8] = 0;\n\ti = 8;\n\tdo {\n\t\t--i;\n\t\tresult[i] = digits[x & 0xf];\n\t\tx >>= 4;\n\t} while (x != 0 && i > 0);\n\treturn &result[i];\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic char *tohex(unsigned int x)\n{\n\tstatic char digits[] = \"0123456789abcdef\";\n\tstatic char result[9];\n\tint i;\n\n\tresult[8] = 0;\n\ti = 8;\n\tdo {\n\t\t--i;\n\t\tresult[i] = digits[x & 0xf];\n\t\tx >>= 4;\n\t} while (x != 0 && i > 0);\n\treturn &result[i];\n}"
  },
  {
    "function_name": "add_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "474-482",
    "snippet": "static void add_string(char **str, const char *q)\n{\n\tchar *p = *str;\n\n\twhile (*q)\n\t\t*p++ = *q++;\n\t*p++ = ' ';\n\t*str = p;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void add_string(char **str, const char *q)\n{\n\tchar *p = *str;\n\n\twhile (*q)\n\t\t*p++ = *q++;\n\t*p++ = ' ';\n\t*str = p;\n}"
  },
  {
    "function_name": "prom_getproplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "469-472",
    "snippet": "static int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"getproplen\"",
            "2",
            "1",
            "node",
            "ADDR(pname)"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "pname"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
  },
  {
    "function_name": "prom_getprop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "462-467",
    "snippet": "static int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"getprop\"",
            "4",
            "1",
            "node",
            "ADDR(pname)",
            "(u32)(unsigned long) value",
            "(u32) valuelen"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "pname"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int inline prom_getprop(phandle node, const char *pname,\n\t\t\t       void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
  },
  {
    "function_name": "prom_next_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "445-460",
    "snippet": "static int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"peer\"",
            "1",
            "1",
            "node"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}"
  },
  {
    "function_name": "prom_claim",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "395-427",
    "snippet": "static unsigned int __init prom_claim(unsigned long virt, unsigned long size,\n\t\t\t\tunsigned long align)\n{\n\n\tif (align == 0 && (OF_WORKAROUNDS & OF_WA_CLAIM)) {\n\t\t/*\n\t\t * Old OF requires we claim physical and virtual separately\n\t\t * and then map explicitly (assuming virtual mode)\n\t\t */\n\t\tint ret;\n\t\tprom_arg_t result;\n\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.memory,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0 || result == -1)\n\t\t\treturn -1;\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.mmumap,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0) {\n\t\t\tcall_prom(\"call-method\", 4, 1, ADDR(\"release\"),\n\t\t\t\t  prom.memory, size, virt);\n\t\t\treturn -1;\n\t\t}\n\t\t/* the 0x12 is M (coherence) + PP == read/write */\n\t\tcall_prom(\"call-method\", 6, 1,\n\t\t\t  ADDR(\"map\"), prom.mmumap, 0x12, size, virt, virt);\n\t\treturn virt;\n\t}\n\treturn call_prom(\"claim\", 3, 1, (prom_arg_t)virt, (prom_arg_t)size,\n\t\t\t (prom_arg_t)align);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */",
      "#define OF_WORKAROUNDS\tof_workarounds",
      "#define OF_WORKAROUNDS\t0"
    ],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"claim\"",
            "3",
            "1",
            "(prom_arg_t)virt",
            "(prom_arg_t)size",
            "(prom_arg_t)align"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"map\""
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"release\""
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"claim\""
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"claim\""
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic unsigned int __init prom_claim(unsigned long virt, unsigned long size,\n\t\t\t\tunsigned long align)\n{\n\n\tif (align == 0 && (OF_WORKAROUNDS & OF_WA_CLAIM)) {\n\t\t/*\n\t\t * Old OF requires we claim physical and virtual separately\n\t\t * and then map explicitly (assuming virtual mode)\n\t\t */\n\t\tint ret;\n\t\tprom_arg_t result;\n\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.memory,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0 || result == -1)\n\t\t\treturn -1;\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.mmumap,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0) {\n\t\t\tcall_prom(\"call-method\", 4, 1, ADDR(\"release\"),\n\t\t\t\t  prom.memory, size, virt);\n\t\t\treturn -1;\n\t\t}\n\t\t/* the 0x12 is M (coherence) + PP == read/write */\n\t\tcall_prom(\"call-method\", 6, 1,\n\t\t\t  ADDR(\"map\"), prom.mmumap, 0x12, size, virt, virt);\n\t\treturn virt;\n\t}\n\treturn call_prom(\"claim\", 3, 1, (prom_arg_t)virt, (prom_arg_t)size,\n\t\t\t (prom_arg_t)align);\n}"
  },
  {
    "function_name": "prom_printf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "324-392",
    "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_print_dec",
          "args": [
            "vs"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "prom_print_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "308-322",
          "snippet": "static void __init prom_print_dec(unsigned long val)\n{\n\tint i, size;\n\tchar buf[UL_DIGITS+1];\n\n\tfor (i = UL_DIGITS-1; i >= 0;  i--) {\n\t\tbuf[i] = (val % 10) + '0';\n\t\tval = val/10;\n\t\tif (val == 0)\n\t\t\tbreak;\n\t}\n\t/* shift stuff down */\n\tsize = UL_DIGITS - i;\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf+i, size);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define UL_DIGITS 21"
          ],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define UL_DIGITS 21\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_print_dec(unsigned long val)\n{\n\tint i, size;\n\tchar buf[UL_DIGITS+1];\n\n\tfor (i = UL_DIGITS-1; i >= 0;  i--) {\n\t\tbuf[i] = (val % 10) + '0';\n\t\tval = val/10;\n\t\tif (val == 0)\n\t\t\tbreak;\n\t}\n\t/* shift stuff down */\n\tsize = UL_DIGITS - i;\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf+i, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_print",
          "args": [
            "\"-\""
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "324-392",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "long"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "unsignedlong"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_print_hex",
          "args": [
            "v"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "prom_print_hex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "291-304",
          "snippet": "static void __init prom_print_hex(unsigned long val)\n{\n\tint i, nibbles = sizeof(val)*2;\n\tchar buf[sizeof(val)*2+1];\n\n\tfor (i = nibbles-1;  i >= 0;  i--) {\n\t\tbuf[i] = (val & 0xf) + '0';\n\t\tif (buf[i] > '9')\n\t\t\tbuf[i] += ('a'-'0'-10);\n\t\tval >>= 4;\n\t}\n\tbuf[nibbles] = '\\0';\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf, nibbles);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __initdata prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_print_hex(unsigned long val)\n{\n\tint i, nibbles = sizeof(val)*2;\n\tchar buf[sizeof(val)*2+1];\n\n\tfor (i = nibbles-1;  i >= 0;  i--) {\n\t\tbuf[i] = (val & 0xf) + '0';\n\t\tif (buf[i] > '9')\n\t\t\tbuf[i] += ('a'-'0'-10);\n\t\tval >>= 4;\n\t}\n\tbuf[nibbles] = '\\0';\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf, nibbles);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "unsignedlong"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "int"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "unsignedlong"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "constchar *"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"write\"",
            "3",
            "1",
            "prom.stdout",
            "ADDR(\"\\r\\n\")",
            "2"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"\\r\\n\""
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "format"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tv = va_arg(args, unsigned long);\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tvs = va_arg(args, int);\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\t++q;\n\t\t\tif (*q == 0)\n\t\t\t\tbreak;\n\t\t\telse if (*q == 'x') {\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_hex(v);\n\t\t\t} else if (*q == 'u') { /* '%lu' */\n\t\t\t\t++q;\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tprom_print_dec(v);\n\t\t\t} else if (*q == 'd') { /* %ld */\n\t\t\t\t++q;\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tif (vs < 0) {\n\t\t\t\t\tprom_print(\"-\");\n\t\t\t\t\tvs = -vs;\n\t\t\t\t}\n\t\t\t\tprom_print_dec(vs);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "prom_print_dec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "308-322",
    "snippet": "static void __init prom_print_dec(unsigned long val)\n{\n\tint i, size;\n\tchar buf[UL_DIGITS+1];\n\n\tfor (i = UL_DIGITS-1; i >= 0;  i--) {\n\t\tbuf[i] = (val % 10) + '0';\n\t\tval = val/10;\n\t\tif (val == 0)\n\t\t\tbreak;\n\t}\n\t/* shift stuff down */\n\tsize = UL_DIGITS - i;\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf+i, size);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define UL_DIGITS 21"
    ],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"write\"",
            "3",
            "1",
            "prom.stdout",
            "buf+i",
            "size"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define UL_DIGITS 21\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_print_dec(unsigned long val)\n{\n\tint i, size;\n\tchar buf[UL_DIGITS+1];\n\n\tfor (i = UL_DIGITS-1; i >= 0;  i--) {\n\t\tbuf[i] = (val % 10) + '0';\n\t\tval = val/10;\n\t\tif (val == 0)\n\t\t\tbreak;\n\t}\n\t/* shift stuff down */\n\tsize = UL_DIGITS - i;\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf+i, size);\n}"
  },
  {
    "function_name": "prom_print_hex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "291-304",
    "snippet": "static void __init prom_print_hex(unsigned long val)\n{\n\tint i, nibbles = sizeof(val)*2;\n\tchar buf[sizeof(val)*2+1];\n\n\tfor (i = nibbles-1;  i >= 0;  i--) {\n\t\tbuf[i] = (val & 0xf) + '0';\n\t\tif (buf[i] > '9')\n\t\t\tbuf[i] += ('a'-'0'-10);\n\t\tval >>= 4;\n\t}\n\tbuf[nibbles] = '\\0';\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf, nibbles);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"write\"",
            "3",
            "1",
            "prom.stdout",
            "buf",
            "nibbles"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_print_hex(unsigned long val)\n{\n\tint i, nibbles = sizeof(val)*2;\n\tchar buf[sizeof(val)*2+1];\n\n\tfor (i = nibbles-1;  i >= 0;  i--) {\n\t\tbuf[i] = (val & 0xf) + '0';\n\t\tif (buf[i] > '9')\n\t\t\tbuf[i] += ('a'-'0'-10);\n\t\tval >>= 4;\n\t}\n\tbuf[nibbles] = '\\0';\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf, nibbles);\n}"
  },
  {
    "function_name": "prom_print",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "271-288",
    "snippet": "static void __init prom_print(const char *msg)\n{\n\tconst char *p, *q;\n\n\tif (prom.stdout == 0)\n\t\treturn;\n\n\tfor (p = msg; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\t++q;\n\t\tcall_prom(\"write\", 3, 1, prom.stdout, ADDR(\"\\r\\n\"), 2);\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __initdata prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"write\"",
            "3",
            "1",
            "prom.stdout",
            "ADDR(\"\\r\\n\")",
            "2"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "241-268",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"\\r\\n\""
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __initdata prom;\nstatic void __init;\n\nstatic void __init prom_print(const char *msg)\n{\n\tconst char *p, *q;\n\n\tif (prom.stdout == 0)\n\t\treturn;\n\n\tfor (p = msg; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\t++q;\n\t\tcall_prom(\"write\", 3, 1, prom.stdout, ADDR(\"\\r\\n\"), 2);\n\t}\n}"
  },
  {
    "function_name": "call_prom_ret",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "241-268",
    "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "args.args[nargs]"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "args.args[nargs+i]"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enter_prom",
          "args": [
            "&args",
            "prom_entry"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "enter_prom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "138-141",
          "snippet": "static inline int enter_prom(struct prom_args *args, unsigned long entry)\n{\n\treturn ((int (*)(struct prom_args *))entry)(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic inline int enter_prom(struct prom_args *args, unsigned long entry)\n{\n\treturn ((int (*)(struct prom_args *))entry)(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "list"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "va_arg(list, prom_arg_t)"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "list",
            "prom_arg_t"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "list",
            "rets"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "nret"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "nargs"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ADDR(service)"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "service"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
  },
  {
    "function_name": "call_prom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "217-239",
    "snippet": "static int __init call_prom(const char *service, int nargs, int nret, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, nret);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "args.args[nargs]"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enter_prom",
          "args": [
            "&args",
            "prom_entry"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "enter_prom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "138-141",
          "snippet": "static inline int enter_prom(struct prom_args *args, unsigned long entry)\n{\n\treturn ((int (*)(struct prom_args *))entry)(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/opal.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic inline int enter_prom(struct prom_args *args, unsigned long entry)\n{\n\treturn ((int (*)(struct prom_args *))entry)(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "list"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "va_arg(list, prom_arg_t)"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "list",
            "prom_arg_t"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "list",
            "nret"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "nret"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "nargs"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ADDR(service)"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "service"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init call_prom(const char *service, int nargs, int nret, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, nret);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
  },
  {
    "function_name": "enter_prom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "138-141",
    "snippet": "static inline int enter_prom(struct prom_args *args, unsigned long entry)\n{\n\treturn ((int (*)(struct prom_args *))entry)(args);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/opal.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/stringify.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "args"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/opal.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic inline int enter_prom(struct prom_args *args, unsigned long entry)\n{\n\treturn ((int (*)(struct prom_args *))entry)(args);\n}"
  }
]