[
  {
    "function_name": "cpu_die",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "823-830",
    "snippet": "void cpu_die(void)\n{\n\tif (ppc_md.cpu_die)\n\t\tppc_md.cpu_die();\n\n\t/* If we return, we re-enter start_secondary */\n\tstart_secondary_resume();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "start_secondary_resume",
          "args": [],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.cpu_die",
          "args": [],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "823-830",
          "snippet": "void cpu_die(void)\n{\n\tif (ppc_md.cpu_die)\n\t\tppc_md.cpu_die();\n\n\t/* If we return, we re-enter start_secondary */\n\tstart_secondary_resume();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid cpu_die(void)\n{\n\tif (ppc_md.cpu_die)\n\t\tppc_md.cpu_die();\n\n\t/* If we return, we re-enter start_secondary */\n\tstart_secondary_resume();\n}"
  },
  {
    "function_name": "__cpu_die",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "817-821",
    "snippet": "void __cpu_die(unsigned int cpu)\n{\n\tif (smp_ops->cpu_die)\n\t\tsmp_ops->cpu_die(cpu);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_ops->cpu_die",
          "args": [
            "cpu"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nvoid __cpu_die(unsigned int cpu)\n{\n\tif (smp_ops->cpu_die)\n\t\tsmp_ops->cpu_die(cpu);\n}"
  },
  {
    "function_name": "__cpu_disable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "791-815",
    "snippet": "int __cpu_disable(void)\n{\n\tint cpu = smp_processor_id();\n\tint base, i;\n\tint err;\n\n\tif (!smp_ops->cpu_disable)\n\t\treturn -ENOSYS;\n\n\terr = smp_ops->cpu_disable();\n\tif (err)\n\t\treturn err;\n\n\t/* Update sibling maps */\n\tbase = cpu_first_thread_sibling(cpu);\n\tfor (i = 0; i < threads_per_core; i++) {\n\t\tcpumask_clear_cpu(cpu, cpu_sibling_mask(base + i));\n\t\tcpumask_clear_cpu(base + i, cpu_sibling_mask(cpu));\n\t\tcpumask_clear_cpu(cpu, cpu_core_mask(base + i));\n\t\tcpumask_clear_cpu(base + i, cpu_core_mask(cpu));\n\t}\n\ttraverse_core_siblings(cpu, false);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "traverse_core_siblings",
          "args": [
            "cpu",
            "false"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "traverse_core_siblings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "636-675",
          "snippet": "static void traverse_core_siblings(int cpu, bool add)\n{\n\tstruct device_node *l2_cache, *np;\n\tconst struct cpumask *mask;\n\tint i, chip, plen;\n\tconst __be32 *prop;\n\n\t/* First see if we have ibm,chip-id properties in cpu nodes */\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np) {\n\t\tchip = -1;\n\t\tprop = of_get_property(np, \"ibm,chip-id\", &plen);\n\t\tif (prop && plen == sizeof(int))\n\t\t\tchip = of_read_number(prop, 1);\n\t\tof_node_put(np);\n\t\tif (chip >= 0) {\n\t\t\ttraverse_siblings_chip_id(cpu, add, chip);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tl2_cache = cpu_to_l2cache(cpu);\n\tmask = add ? cpu_online_mask : cpu_present_mask;\n\tfor_each_cpu(i, mask) {\n\t\tnp = cpu_to_l2cache(i);\n\t\tif (!np)\n\t\t\tcontinue;\n\t\tif (np == l2_cache) {\n\t\t\tif (add) {\n\t\t\t\tcpumask_set_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_set_cpu(i, cpu_core_mask(cpu));\n\t\t\t} else {\n\t\t\t\tcpumask_clear_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_clear_cpu(i, cpu_core_mask(cpu));\n\t\t\t}\n\t\t}\n\t\tof_node_put(np);\n\t}\n\tof_node_put(l2_cache);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void traverse_core_siblings(int cpu, bool add)\n{\n\tstruct device_node *l2_cache, *np;\n\tconst struct cpumask *mask;\n\tint i, chip, plen;\n\tconst __be32 *prop;\n\n\t/* First see if we have ibm,chip-id properties in cpu nodes */\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np) {\n\t\tchip = -1;\n\t\tprop = of_get_property(np, \"ibm,chip-id\", &plen);\n\t\tif (prop && plen == sizeof(int))\n\t\t\tchip = of_read_number(prop, 1);\n\t\tof_node_put(np);\n\t\tif (chip >= 0) {\n\t\t\ttraverse_siblings_chip_id(cpu, add, chip);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tl2_cache = cpu_to_l2cache(cpu);\n\tmask = add ? cpu_online_mask : cpu_present_mask;\n\tfor_each_cpu(i, mask) {\n\t\tnp = cpu_to_l2cache(i);\n\t\tif (!np)\n\t\t\tcontinue;\n\t\tif (np == l2_cache) {\n\t\t\tif (add) {\n\t\t\t\tcpumask_set_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_set_cpu(i, cpu_core_mask(cpu));\n\t\t\t} else {\n\t\t\t\tcpumask_clear_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_clear_cpu(i, cpu_core_mask(cpu));\n\t\t\t}\n\t\t}\n\t\tof_node_put(np);\n\t}\n\tof_node_put(l2_cache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "base + i",
            "cpu_core_mask(cpu)"
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_core_mask",
          "args": [
            "cpu"
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "cpu",
            "cpu_core_mask(base + i)"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_core_mask",
          "args": [
            "base + i"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "base + i",
            "cpu_sibling_mask(cpu)"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_sibling_mask",
          "args": [
            "cpu"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "cpu",
            "cpu_sibling_mask(base + i)"
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_sibling_mask",
          "args": [
            "base + i"
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_first_thread_sibling",
          "args": [
            "cpu"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_ops->cpu_disable",
          "args": [],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 793
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nint __cpu_disable(void)\n{\n\tint cpu = smp_processor_id();\n\tint base, i;\n\tint err;\n\n\tif (!smp_ops->cpu_disable)\n\t\treturn -ENOSYS;\n\n\terr = smp_ops->cpu_disable();\n\tif (err)\n\t\treturn err;\n\n\t/* Update sibling maps */\n\tbase = cpu_first_thread_sibling(cpu);\n\tfor (i = 0; i < threads_per_core; i++) {\n\t\tcpumask_clear_cpu(cpu, cpu_sibling_mask(base + i));\n\t\tcpumask_clear_cpu(base + i, cpu_sibling_mask(cpu));\n\t\tcpumask_clear_cpu(cpu, cpu_core_mask(base + i));\n\t\tcpumask_clear_cpu(base + i, cpu_core_mask(cpu));\n\t}\n\ttraverse_core_siblings(cpu, false);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "smp_cpus_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "762-788",
    "snippet": "void __init smp_cpus_done(unsigned int max_cpus)\n{\n\tcpumask_var_t old_mask;\n\n\t/* We want the setup_cpu() here to be called from CPU 0, but our\n\t * init thread may have been \"borrowed\" by another CPU in the meantime\n\t * se we pin us down to CPU 0 for a short while\n\t */\n\talloc_cpumask_var(&old_mask, GFP_NOWAIT);\n\tcpumask_copy(old_mask, tsk_cpus_allowed(current));\n\tset_cpus_allowed_ptr(current, cpumask_of(boot_cpuid));\n\t\n\tif (smp_ops && smp_ops->setup_cpu)\n\t\tsmp_ops->setup_cpu(boot_cpuid);\n\n\tset_cpus_allowed_ptr(current, old_mask);\n\n\tfree_cpumask_var(old_mask);\n\n\tif (smp_ops && smp_ops->bringup_done)\n\t\tsmp_ops->bringup_done();\n\n\tdump_numa_cpu_topology();\n\n\tset_sched_topology(powerpc_topology);\n\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;",
      "static struct sched_domain_topology_level powerpc_topology[] = {\n#ifdef CONFIG_SCHED_SMT\n\t{ cpu_smt_mask, powerpc_smt_flags, SD_INIT_NAME(SMT) },\n#endif\n\t{ cpu_cpu_mask, SD_INIT_NAME(DIE) },\n\t{ NULL, },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_sched_topology",
          "args": [
            "powerpc_topology"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dump_numa_cpu_topology",
          "args": [],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_ops->bringup_done",
          "args": [],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_cpumask_var",
          "args": [
            "old_mask"
          ],
          "line": 779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpus_allowed_ptr",
          "args": [
            "current",
            "old_mask"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_ops->setup_cpu",
          "args": [
            "boot_cpuid"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpus_allowed_ptr",
          "args": [
            "current",
            "cpumask_of(boot_cpuid)"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_of",
          "args": [
            "boot_cpuid"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_copy",
          "args": [
            "old_mask",
            "tsk_cpus_allowed(current)"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tsk_cpus_allowed",
          "args": [
            "current"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_cpumask_var",
          "args": [
            "&old_mask",
            "GFP_NOWAIT"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\nstatic struct sched_domain_topology_level powerpc_topology[] = {\n#ifdef CONFIG_SCHED_SMT\n\t{ cpu_smt_mask, powerpc_smt_flags, SD_INIT_NAME(SMT) },\n#endif\n\t{ cpu_cpu_mask, SD_INIT_NAME(DIE) },\n\t{ NULL, },\n};\n\nvoid __init smp_cpus_done(unsigned int max_cpus)\n{\n\tcpumask_var_t old_mask;\n\n\t/* We want the setup_cpu() here to be called from CPU 0, but our\n\t * init thread may have been \"borrowed\" by another CPU in the meantime\n\t * se we pin us down to CPU 0 for a short while\n\t */\n\talloc_cpumask_var(&old_mask, GFP_NOWAIT);\n\tcpumask_copy(old_mask, tsk_cpus_allowed(current));\n\tset_cpus_allowed_ptr(current, cpumask_of(boot_cpuid));\n\t\n\tif (smp_ops && smp_ops->setup_cpu)\n\t\tsmp_ops->setup_cpu(boot_cpuid);\n\n\tset_cpus_allowed_ptr(current, old_mask);\n\n\tfree_cpumask_var(old_mask);\n\n\tif (smp_ops && smp_ops->bringup_done)\n\t\tsmp_ops->bringup_done();\n\n\tdump_numa_cpu_topology();\n\n\tset_sched_topology(powerpc_topology);\n\n}"
  },
  {
    "function_name": "powerpc_smt_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "742-751",
    "snippet": "static int powerpc_smt_flags(void)\n{\n\tint flags = SD_SHARE_CPUCAPACITY | SD_SHARE_PKG_RESOURCES;\n\n\tif (cpu_has_feature(CPU_FTR_ASYM_SMT)) {\n\t\tprintk_once(KERN_INFO \"Enabling Asymmetric SMT scheduling\\n\");\n\t\tflags |= SD_ASYM_PACKING;\n\t}\n\treturn flags;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk_once",
          "args": [
            "KERN_INFO \"Enabling Asymmetric SMT scheduling\\n\""
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ASYM_SMT"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic int powerpc_smt_flags(void)\n{\n\tint flags = SD_SHARE_CPUCAPACITY | SD_SHARE_PKG_RESOURCES;\n\n\tif (cpu_has_feature(CPU_FTR_ASYM_SMT)) {\n\t\tprintk_once(KERN_INFO \"Enabling Asymmetric SMT scheduling\\n\");\n\t\tflags |= SD_ASYM_PACKING;\n\t}\n\treturn flags;\n}"
  },
  {
    "function_name": "setup_profiling_timer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "735-738",
    "snippet": "int setup_profiling_timer(unsigned int multiplier)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint setup_profiling_timer(unsigned int multiplier)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "start_secondary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "678-733",
    "snippet": "void start_secondary(void *unused)\n{\n\tunsigned int cpu = smp_processor_id();\n\tint i, base;\n\n\tatomic_inc(&init_mm.mm_count);\n\tcurrent->active_mm = &init_mm;\n\n\tsmp_store_cpu_info(cpu);\n\tset_dec(tb_ticks_per_jiffy);\n\tpreempt_disable();\n\tcpu_callin_map[cpu] = 1;\n\n\tif (smp_ops->setup_cpu)\n\t\tsmp_ops->setup_cpu(cpu);\n\tif (smp_ops->take_timebase)\n\t\tsmp_ops->take_timebase();\n\n\tsecondary_cpu_time_init();\n\n#ifdef CONFIG_PPC64\n\tif (system_state == SYSTEM_RUNNING)\n\t\tvdso_data->processorCount++;\n\n\tvdso_getcpu_init();\n#endif\n\t/* Update sibling maps */\n\tbase = cpu_first_thread_sibling(cpu);\n\tfor (i = 0; i < threads_per_core; i++) {\n\t\tif (cpu_is_offline(base + i) && (cpu != base + i))\n\t\t\tcontinue;\n\t\tcpumask_set_cpu(cpu, cpu_sibling_mask(base + i));\n\t\tcpumask_set_cpu(base + i, cpu_sibling_mask(cpu));\n\n\t\t/* cpu_core_map should be a superset of\n\t\t * cpu_sibling_map even if we don't have cache\n\t\t * information, so update the former here, too.\n\t\t */\n\t\tcpumask_set_cpu(cpu, cpu_core_mask(base + i));\n\t\tcpumask_set_cpu(base + i, cpu_core_mask(cpu));\n\t}\n\ttraverse_core_siblings(cpu, true);\n\n\tset_numa_node(numa_cpu_lookup_table[cpu]);\n\tset_numa_mem(local_memory_node(numa_cpu_lookup_table[cpu]));\n\n\tsmp_wmb();\n\tnotify_cpu_starting(cpu);\n\tset_cpu_online(cpu, true);\n\n\tlocal_irq_enable();\n\n\tcpu_startup_entry(CPUHP_ONLINE);\n\n\tBUG();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;",
      "volatile unsigned int cpu_callin_map[NR_CPUS];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_startup_entry",
          "args": [
            "CPUHP_ONLINE"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_enable",
          "args": [],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_online",
          "args": [
            "cpu",
            "true"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notify_cpu_starting",
          "args": [
            "cpu"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_wmb",
          "args": [],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_numa_mem",
          "args": [
            "local_memory_node(numa_cpu_lookup_table[cpu])"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_memory_node",
          "args": [
            "numa_cpu_lookup_table[cpu]"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_numa_node",
          "args": [
            "numa_cpu_lookup_table[cpu]"
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traverse_core_siblings",
          "args": [
            "cpu",
            "true"
          ],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "traverse_core_siblings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "636-675",
          "snippet": "static void traverse_core_siblings(int cpu, bool add)\n{\n\tstruct device_node *l2_cache, *np;\n\tconst struct cpumask *mask;\n\tint i, chip, plen;\n\tconst __be32 *prop;\n\n\t/* First see if we have ibm,chip-id properties in cpu nodes */\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np) {\n\t\tchip = -1;\n\t\tprop = of_get_property(np, \"ibm,chip-id\", &plen);\n\t\tif (prop && plen == sizeof(int))\n\t\t\tchip = of_read_number(prop, 1);\n\t\tof_node_put(np);\n\t\tif (chip >= 0) {\n\t\t\ttraverse_siblings_chip_id(cpu, add, chip);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tl2_cache = cpu_to_l2cache(cpu);\n\tmask = add ? cpu_online_mask : cpu_present_mask;\n\tfor_each_cpu(i, mask) {\n\t\tnp = cpu_to_l2cache(i);\n\t\tif (!np)\n\t\t\tcontinue;\n\t\tif (np == l2_cache) {\n\t\t\tif (add) {\n\t\t\t\tcpumask_set_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_set_cpu(i, cpu_core_mask(cpu));\n\t\t\t} else {\n\t\t\t\tcpumask_clear_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_clear_cpu(i, cpu_core_mask(cpu));\n\t\t\t}\n\t\t}\n\t\tof_node_put(np);\n\t}\n\tof_node_put(l2_cache);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void traverse_core_siblings(int cpu, bool add)\n{\n\tstruct device_node *l2_cache, *np;\n\tconst struct cpumask *mask;\n\tint i, chip, plen;\n\tconst __be32 *prop;\n\n\t/* First see if we have ibm,chip-id properties in cpu nodes */\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np) {\n\t\tchip = -1;\n\t\tprop = of_get_property(np, \"ibm,chip-id\", &plen);\n\t\tif (prop && plen == sizeof(int))\n\t\t\tchip = of_read_number(prop, 1);\n\t\tof_node_put(np);\n\t\tif (chip >= 0) {\n\t\t\ttraverse_siblings_chip_id(cpu, add, chip);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tl2_cache = cpu_to_l2cache(cpu);\n\tmask = add ? cpu_online_mask : cpu_present_mask;\n\tfor_each_cpu(i, mask) {\n\t\tnp = cpu_to_l2cache(i);\n\t\tif (!np)\n\t\t\tcontinue;\n\t\tif (np == l2_cache) {\n\t\t\tif (add) {\n\t\t\t\tcpumask_set_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_set_cpu(i, cpu_core_mask(cpu));\n\t\t\t} else {\n\t\t\t\tcpumask_clear_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_clear_cpu(i, cpu_core_mask(cpu));\n\t\t\t}\n\t\t}\n\t\tof_node_put(np);\n\t}\n\tof_node_put(l2_cache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "base + i",
            "cpu_core_mask(cpu)"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_core_mask",
          "args": [
            "cpu"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "cpu",
            "cpu_core_mask(base + i)"
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_core_mask",
          "args": [
            "base + i"
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "base + i",
            "cpu_sibling_mask(cpu)"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_sibling_mask",
          "args": [
            "cpu"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "cpu",
            "cpu_sibling_mask(base + i)"
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_sibling_mask",
          "args": [
            "base + i"
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_is_offline",
          "args": [
            "base + i"
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_first_thread_sibling",
          "args": [
            "cpu"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vdso_getcpu_init",
          "args": [],
          "line": 702
        },
        "resolved": true,
        "details": {
          "function_name": "vdso_getcpu_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/vdso.c",
          "lines": "691-712",
          "snippet": "int vdso_getcpu_init(void)\n{\n\tunsigned long cpu, node, val;\n\n\t/*\n\t * SPRG_VDSO contains the CPU in the bottom 16 bits and the NUMA node\n\t * in the next 16 bits.  The VDSO uses this to implement getcpu().\n\t */\n\tcpu = get_cpu();\n\tWARN_ON_ONCE(cpu > 0xffff);\n\n\tnode = cpu_to_node(cpu);\n\tWARN_ON_ONCE(node > 0xffff);\n\n\tval = (cpu & 0xfff) | ((node & 0xffff) << 16);\n\tmtspr(SPRN_SPRG_VDSO_WRITE, val);\n\tget_paca()->sprg_vdso = val;\n\n\tput_cpu();\n\n\treturn 0;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/vdso.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/vdso_datapage.h>\n#include <asm/vdso.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu_context.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/pgtable.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint vdso_getcpu_init(void)\n{\n\tunsigned long cpu, node, val;\n\n\t/*\n\t * SPRG_VDSO contains the CPU in the bottom 16 bits and the NUMA node\n\t * in the next 16 bits.  The VDSO uses this to implement getcpu().\n\t */\n\tcpu = get_cpu();\n\tWARN_ON_ONCE(cpu > 0xffff);\n\n\tnode = cpu_to_node(cpu);\n\tWARN_ON_ONCE(node > 0xffff);\n\n\tval = (cpu & 0xfff) | ((node & 0xffff) << 16);\n\tmtspr(SPRN_SPRG_VDSO_WRITE, val);\n\tget_paca()->sprg_vdso = val;\n\n\tput_cpu();\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "secondary_cpu_time_init",
          "args": [],
          "line": 696
        },
        "resolved": true,
        "details": {
          "function_name": "secondary_cpu_time_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "908-918",
          "snippet": "void secondary_cpu_time_init(void)\n{\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* FIME: Should make unrelatred change to move snapshot_timebase\n\t * call here ! */\n\tregister_decrementer_clockevent(smp_processor_id());\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid secondary_cpu_time_init(void)\n{\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* FIME: Should make unrelatred change to move snapshot_timebase\n\t * call here ! */\n\tregister_decrementer_clockevent(smp_processor_id());\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_ops->take_timebase",
          "args": [],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_ops->setup_cpu",
          "args": [
            "cpu"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "tb_ticks_per_jiffy"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_store_cpu_info",
          "args": [
            "cpu"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "smp_store_cpu_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "350-357",
          "snippet": "static void smp_store_cpu_info(int id)\n{\n\tper_cpu(cpu_pvr, id) = mfspr(SPRN_PVR);\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tper_cpu(next_tlbcam_idx, id)\n\t\t= (mfspr(SPRN_TLB1CFG) & TLBnCFG_N_ENTRY) - 1;\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void smp_store_cpu_info(int id)\n{\n\tper_cpu(cpu_pvr, id) = mfspr(SPRN_PVR);\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tper_cpu(next_tlbcam_idx, id)\n\t\t= (mfspr(SPRN_TLB1CFG) & TLBnCFG_N_ENTRY) - 1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&init_mm.mm_count"
          ],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\nvolatile unsigned int cpu_callin_map[NR_CPUS];\n\nvoid start_secondary(void *unused)\n{\n\tunsigned int cpu = smp_processor_id();\n\tint i, base;\n\n\tatomic_inc(&init_mm.mm_count);\n\tcurrent->active_mm = &init_mm;\n\n\tsmp_store_cpu_info(cpu);\n\tset_dec(tb_ticks_per_jiffy);\n\tpreempt_disable();\n\tcpu_callin_map[cpu] = 1;\n\n\tif (smp_ops->setup_cpu)\n\t\tsmp_ops->setup_cpu(cpu);\n\tif (smp_ops->take_timebase)\n\t\tsmp_ops->take_timebase();\n\n\tsecondary_cpu_time_init();\n\n#ifdef CONFIG_PPC64\n\tif (system_state == SYSTEM_RUNNING)\n\t\tvdso_data->processorCount++;\n\n\tvdso_getcpu_init();\n#endif\n\t/* Update sibling maps */\n\tbase = cpu_first_thread_sibling(cpu);\n\tfor (i = 0; i < threads_per_core; i++) {\n\t\tif (cpu_is_offline(base + i) && (cpu != base + i))\n\t\t\tcontinue;\n\t\tcpumask_set_cpu(cpu, cpu_sibling_mask(base + i));\n\t\tcpumask_set_cpu(base + i, cpu_sibling_mask(cpu));\n\n\t\t/* cpu_core_map should be a superset of\n\t\t * cpu_sibling_map even if we don't have cache\n\t\t * information, so update the former here, too.\n\t\t */\n\t\tcpumask_set_cpu(cpu, cpu_core_mask(base + i));\n\t\tcpumask_set_cpu(base + i, cpu_core_mask(cpu));\n\t}\n\ttraverse_core_siblings(cpu, true);\n\n\tset_numa_node(numa_cpu_lookup_table[cpu]);\n\tset_numa_mem(local_memory_node(numa_cpu_lookup_table[cpu]));\n\n\tsmp_wmb();\n\tnotify_cpu_starting(cpu);\n\tset_cpu_online(cpu, true);\n\n\tlocal_irq_enable();\n\n\tcpu_startup_entry(CPUHP_ONLINE);\n\n\tBUG();\n}"
  },
  {
    "function_name": "traverse_core_siblings",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "636-675",
    "snippet": "static void traverse_core_siblings(int cpu, bool add)\n{\n\tstruct device_node *l2_cache, *np;\n\tconst struct cpumask *mask;\n\tint i, chip, plen;\n\tconst __be32 *prop;\n\n\t/* First see if we have ibm,chip-id properties in cpu nodes */\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np) {\n\t\tchip = -1;\n\t\tprop = of_get_property(np, \"ibm,chip-id\", &plen);\n\t\tif (prop && plen == sizeof(int))\n\t\t\tchip = of_read_number(prop, 1);\n\t\tof_node_put(np);\n\t\tif (chip >= 0) {\n\t\t\ttraverse_siblings_chip_id(cpu, add, chip);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tl2_cache = cpu_to_l2cache(cpu);\n\tmask = add ? cpu_online_mask : cpu_present_mask;\n\tfor_each_cpu(i, mask) {\n\t\tnp = cpu_to_l2cache(i);\n\t\tif (!np)\n\t\t\tcontinue;\n\t\tif (np == l2_cache) {\n\t\t\tif (add) {\n\t\t\t\tcpumask_set_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_set_cpu(i, cpu_core_mask(cpu));\n\t\t\t} else {\n\t\t\t\tcpumask_clear_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_clear_cpu(i, cpu_core_mask(cpu));\n\t\t\t}\n\t\t}\n\t\tof_node_put(np);\n\t}\n\tof_node_put(l2_cache);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "l2_cache"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "i",
            "cpu_core_mask(cpu)"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_core_mask",
          "args": [
            "cpu"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "cpu",
            "cpu_core_mask(i)"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_core_mask",
          "args": [
            "i"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "i",
            "cpu_core_mask(cpu)"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_core_mask",
          "args": [
            "cpu"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "cpu",
            "cpu_core_mask(i)"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_core_mask",
          "args": [
            "i"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_l2cache",
          "args": [
            "i"
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_to_l2cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "617-634",
          "snippet": "static struct device_node *cpu_to_l2cache(int cpu)\n{\n\tstruct device_node *np;\n\tstruct device_node *cache;\n\n\tif (!cpu_present(cpu))\n\t\treturn NULL;\n\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np == NULL)\n\t\treturn NULL;\n\n\tcache = of_find_next_cache_node(np);\n\n\tof_node_put(np);\n\n\treturn cache;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic struct device_node *cpu_to_l2cache(int cpu)\n{\n\tstruct device_node *np;\n\tstruct device_node *cache;\n\n\tif (!cpu_present(cpu))\n\t\treturn NULL;\n\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np == NULL)\n\t\treturn NULL;\n\n\tcache = of_find_next_cache_node(np);\n\n\tof_node_put(np);\n\n\treturn cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "i",
            "mask"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traverse_siblings_chip_id",
          "args": [
            "cpu",
            "add",
            "chip"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "traverse_siblings_chip_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "587-612",
          "snippet": "static void traverse_siblings_chip_id(int cpu, bool add, int chipid)\n{\n\tconst struct cpumask *mask;\n\tstruct device_node *np;\n\tint i, plen;\n\tconst __be32 *prop;\n\n\tmask = add ? cpu_online_mask : cpu_present_mask;\n\tfor_each_cpu(i, mask) {\n\t\tnp = of_get_cpu_node(i, NULL);\n\t\tif (!np)\n\t\t\tcontinue;\n\t\tprop = of_get_property(np, \"ibm,chip-id\", &plen);\n\t\tif (prop && plen == sizeof(int) &&\n\t\t    of_read_number(prop, 1) == chipid) {\n\t\t\tif (add) {\n\t\t\t\tcpumask_set_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_set_cpu(i, cpu_core_mask(cpu));\n\t\t\t} else {\n\t\t\t\tcpumask_clear_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_clear_cpu(i, cpu_core_mask(cpu));\n\t\t\t}\n\t\t}\n\t\tof_node_put(np);\n\t}\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void traverse_siblings_chip_id(int cpu, bool add, int chipid)\n{\n\tconst struct cpumask *mask;\n\tstruct device_node *np;\n\tint i, plen;\n\tconst __be32 *prop;\n\n\tmask = add ? cpu_online_mask : cpu_present_mask;\n\tfor_each_cpu(i, mask) {\n\t\tnp = of_get_cpu_node(i, NULL);\n\t\tif (!np)\n\t\t\tcontinue;\n\t\tprop = of_get_property(np, \"ibm,chip-id\", &plen);\n\t\tif (prop && plen == sizeof(int) &&\n\t\t    of_read_number(prop, 1) == chipid) {\n\t\t\tif (add) {\n\t\t\t\tcpumask_set_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_set_cpu(i, cpu_core_mask(cpu));\n\t\t\t} else {\n\t\t\t\tcpumask_clear_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_clear_cpu(i, cpu_core_mask(cpu));\n\t\t\t}\n\t\t}\n\t\tof_node_put(np);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_read_number",
          "args": [
            "prop",
            "1"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "\"ibm,chip-id\"",
            "&plen"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_cpu_node",
          "args": [
            "cpu",
            "NULL"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void traverse_core_siblings(int cpu, bool add)\n{\n\tstruct device_node *l2_cache, *np;\n\tconst struct cpumask *mask;\n\tint i, chip, plen;\n\tconst __be32 *prop;\n\n\t/* First see if we have ibm,chip-id properties in cpu nodes */\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np) {\n\t\tchip = -1;\n\t\tprop = of_get_property(np, \"ibm,chip-id\", &plen);\n\t\tif (prop && plen == sizeof(int))\n\t\t\tchip = of_read_number(prop, 1);\n\t\tof_node_put(np);\n\t\tif (chip >= 0) {\n\t\t\ttraverse_siblings_chip_id(cpu, add, chip);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tl2_cache = cpu_to_l2cache(cpu);\n\tmask = add ? cpu_online_mask : cpu_present_mask;\n\tfor_each_cpu(i, mask) {\n\t\tnp = cpu_to_l2cache(i);\n\t\tif (!np)\n\t\t\tcontinue;\n\t\tif (np == l2_cache) {\n\t\t\tif (add) {\n\t\t\t\tcpumask_set_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_set_cpu(i, cpu_core_mask(cpu));\n\t\t\t} else {\n\t\t\t\tcpumask_clear_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_clear_cpu(i, cpu_core_mask(cpu));\n\t\t\t}\n\t\t}\n\t\tof_node_put(np);\n\t}\n\tof_node_put(l2_cache);\n}"
  },
  {
    "function_name": "cpu_to_l2cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "617-634",
    "snippet": "static struct device_node *cpu_to_l2cache(int cpu)\n{\n\tstruct device_node *np;\n\tstruct device_node *cache;\n\n\tif (!cpu_present(cpu))\n\t\treturn NULL;\n\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np == NULL)\n\t\treturn NULL;\n\n\tcache = of_find_next_cache_node(np);\n\n\tof_node_put(np);\n\n\treturn cache;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_next_cache_node",
          "args": [
            "np"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_cpu_node",
          "args": [
            "cpu",
            "NULL"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_present",
          "args": [
            "cpu"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic struct device_node *cpu_to_l2cache(int cpu)\n{\n\tstruct device_node *np;\n\tstruct device_node *cache;\n\n\tif (!cpu_present(cpu))\n\t\treturn NULL;\n\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np == NULL)\n\t\treturn NULL;\n\n\tcache = of_find_next_cache_node(np);\n\n\tof_node_put(np);\n\n\treturn cache;\n}"
  },
  {
    "function_name": "traverse_siblings_chip_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "587-612",
    "snippet": "static void traverse_siblings_chip_id(int cpu, bool add, int chipid)\n{\n\tconst struct cpumask *mask;\n\tstruct device_node *np;\n\tint i, plen;\n\tconst __be32 *prop;\n\n\tmask = add ? cpu_online_mask : cpu_present_mask;\n\tfor_each_cpu(i, mask) {\n\t\tnp = of_get_cpu_node(i, NULL);\n\t\tif (!np)\n\t\t\tcontinue;\n\t\tprop = of_get_property(np, \"ibm,chip-id\", &plen);\n\t\tif (prop && plen == sizeof(int) &&\n\t\t    of_read_number(prop, 1) == chipid) {\n\t\t\tif (add) {\n\t\t\t\tcpumask_set_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_set_cpu(i, cpu_core_mask(cpu));\n\t\t\t} else {\n\t\t\t\tcpumask_clear_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_clear_cpu(i, cpu_core_mask(cpu));\n\t\t\t}\n\t\t}\n\t\tof_node_put(np);\n\t}\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "i",
            "cpu_core_mask(cpu)"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_core_mask",
          "args": [
            "cpu"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "cpu",
            "cpu_core_mask(i)"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_core_mask",
          "args": [
            "i"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "i",
            "cpu_core_mask(cpu)"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_core_mask",
          "args": [
            "cpu"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "cpu",
            "cpu_core_mask(i)"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_core_mask",
          "args": [
            "i"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_read_number",
          "args": [
            "prop",
            "1"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "\"ibm,chip-id\"",
            "&plen"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_cpu_node",
          "args": [
            "i",
            "NULL"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "i",
            "mask"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void traverse_siblings_chip_id(int cpu, bool add, int chipid)\n{\n\tconst struct cpumask *mask;\n\tstruct device_node *np;\n\tint i, plen;\n\tconst __be32 *prop;\n\n\tmask = add ? cpu_online_mask : cpu_present_mask;\n\tfor_each_cpu(i, mask) {\n\t\tnp = of_get_cpu_node(i, NULL);\n\t\tif (!np)\n\t\t\tcontinue;\n\t\tprop = of_get_property(np, \"ibm,chip-id\", &plen);\n\t\tif (prop && plen == sizeof(int) &&\n\t\t    of_read_number(prop, 1) == chipid) {\n\t\t\tif (add) {\n\t\t\t\tcpumask_set_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_set_cpu(i, cpu_core_mask(cpu));\n\t\t\t} else {\n\t\t\t\tcpumask_clear_cpu(cpu, cpu_core_mask(i));\n\t\t\t\tcpumask_clear_cpu(i, cpu_core_mask(cpu));\n\t\t\t}\n\t\t}\n\t\tof_node_put(np);\n\t}\n}"
  },
  {
    "function_name": "cpu_first_thread_of_core",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "581-584",
    "snippet": "int cpu_first_thread_of_core(int core)\n{\n\treturn core << threads_shift;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint cpu_first_thread_of_core(int core)\n{\n\treturn core << threads_shift;\n}"
  },
  {
    "function_name": "cpu_core_index_of_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "575-578",
    "snippet": "int cpu_core_index_of_thread(int cpu)\n{\n\treturn cpu >> threads_shift;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint cpu_core_index_of_thread(int cpu)\n{\n\treturn cpu >> threads_shift;\n}"
  },
  {
    "function_name": "cpu_to_core_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "554-572",
    "snippet": "int cpu_to_core_id(int cpu)\n{\n\tstruct device_node *np;\n\tconst __be32 *reg;\n\tint id = -1;\n\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (!np)\n\t\tgoto out;\n\n\treg = of_get_property(np, \"reg\", NULL);\n\tif (!reg)\n\t\tgoto out;\n\n\tid = be32_to_cpup(reg);\nout:\n\tof_node_put(np);\n\treturn id;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "reg"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "\"reg\"",
            "NULL"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_cpu_node",
          "args": [
            "cpu",
            "NULL"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint cpu_to_core_id(int cpu)\n{\n\tstruct device_node *np;\n\tconst __be32 *reg;\n\tint id = -1;\n\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (!np)\n\t\tgoto out;\n\n\treg = of_get_property(np, \"reg\", NULL);\n\tif (!reg)\n\t\tgoto out;\n\n\tid = be32_to_cpup(reg);\nout:\n\tof_node_put(np);\n\treturn id;\n}"
  },
  {
    "function_name": "__cpu_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "480-549",
    "snippet": "int __cpu_up(unsigned int cpu, struct task_struct *tidle)\n{\n\tint rc, c;\n\n\t/*\n\t * Don't allow secondary threads to come online if inhibited\n\t */\n\tif (threads_per_core > 1 && secondaries_inhibited() &&\n\t    cpu_thread_in_subcore(cpu))\n\t\treturn -EBUSY;\n\n\tif (smp_ops == NULL ||\n\t    (smp_ops->cpu_bootable && !smp_ops->cpu_bootable(cpu)))\n\t\treturn -EINVAL;\n\n\tcpu_idle_thread_init(cpu, tidle);\n\n\t/* Make sure callin-map entry is 0 (can be leftover a CPU\n\t * hotplug\n\t */\n\tcpu_callin_map[cpu] = 0;\n\n\t/* The information for processor bringup must\n\t * be written out to main store before we release\n\t * the processor.\n\t */\n\tsmp_mb();\n\n\t/* wake up cpus */\n\tDBG(\"smp: kicking cpu %d\\n\", cpu);\n\trc = smp_ops->kick_cpu(cpu);\n\tif (rc) {\n\t\tpr_err(\"smp: failed starting cpu %d (rc %d)\\n\", cpu, rc);\n\t\treturn rc;\n\t}\n\n\t/*\n\t * wait to see if the cpu made a callin (is actually up).\n\t * use this value that I found through experimentation.\n\t * -- Cort\n\t */\n\tif (system_state < SYSTEM_RUNNING)\n\t\tfor (c = 50000; c && !cpu_callin_map[cpu]; c--)\n\t\t\tudelay(100);\n#ifdef CONFIG_HOTPLUG_CPU\n\telse\n\t\t/*\n\t\t * CPUs can take much longer to come up in the\n\t\t * hotplug case.  Wait five seconds.\n\t\t */\n\t\tfor (c = 5000; c && !cpu_callin_map[cpu]; c--)\n\t\t\tmsleep(1);\n#endif\n\n\tif (!cpu_callin_map[cpu]) {\n\t\tprintk(KERN_ERR \"Processor %u is stuck.\\n\", cpu);\n\t\treturn -ENOENT;\n\t}\n\n\tDBG(\"Processor %u found.\\n\", cpu);\n\n\tif (smp_ops->give_timebase)\n\t\tsmp_ops->give_timebase();\n\n\t/* Wait until cpu puts itself in the online & active maps */\n\twhile (!cpu_online(cpu) || !cpu_active(cpu))\n\t\tcpu_relax();\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;",
      "volatile unsigned int cpu_callin_map[NR_CPUS];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_relax",
          "args": [],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_active",
          "args": [
            "cpu"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "cpu"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_cpu_online",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "788-866",
          "snippet": "static void unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"cacheinfo.h\"",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [
            "#define HAS_PPC_PMC_G4\t\t1",
            "#define HAS_PPC_PMC_IBM\t\t1",
            "#define HAS_PPC_PMC_PA6T\t1",
            "#define HAS_PPC_PMC_IBM\t\t1"
          ],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cpu, cpu_devices);",
            "static DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_IBM\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\nstatic DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);\n\nstatic void unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_ops->give_timebase",
          "args": [],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"Processor %u found.\\n\"",
            "cpu"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"Processor %u is stuck.\\n\"",
            "cpu"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "printk_log_rtas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/rtasd.c",
          "lines": "111-156",
          "snippet": "static void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s, Severity: %d\\n\",\n\t\t       error_log_cnt, rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_severity(errlog));\n\t}\n}",
          "includes": [
            "#include <asm/topology.h>",
            "#include <asm/machdep.h>",
            "#include <linux/atomic.h>",
            "#include <asm/nvram.h>",
            "#include <asm/prom.h>",
            "#include <asm/rtas.h>",
            "#include <asm/io.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/cpu.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int full_rtas_msgs = 0;",
            "static int error_log_cnt;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/topology.h>\n#include <asm/machdep.h>\n#include <linux/atomic.h>\n#include <asm/nvram.h>\n#include <asm/prom.h>\n#include <asm/rtas.h>\n#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/cpu.h>\n#include <linux/spinlock.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic int full_rtas_msgs = 0;\nstatic int error_log_cnt;\n\nstatic void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s, Severity: %d\\n\",\n\t\t       error_log_cnt, rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_severity(errlog));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "msleep",
          "args": [
            "1"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udelay",
          "args": [
            "100"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "udelay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "410-413",
          "snippet": "void udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned long tb_ticks_per_usec = 100;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long tb_ticks_per_usec = 100;\n\nvoid udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"smp: failed starting cpu %d (rc %d)\\n\"",
            "cpu",
            "rc"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_ops->kick_cpu",
          "args": [
            "cpu"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"smp: kicking cpu %d\\n\"",
            "cpu"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_idle_thread_init",
          "args": [
            "cpu",
            "tidle"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_idle_thread_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "468-478",
          "snippet": "static void cpu_idle_thread_init(unsigned int cpu, struct task_struct *idle)\n{\n\tstruct thread_info *ti = task_thread_info(idle);\n\n#ifdef CONFIG_PPC64\n\tpaca[cpu].__current = idle;\n\tpaca[cpu].kstack = (unsigned long)ti + THREAD_SIZE - STACK_FRAME_OVERHEAD;\n#endif\n\tti->cpu = cpu;\n\tsecondary_ti = current_set[cpu] = ti;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct thread_info *secondary_ti;",
            "struct thread_info *current_set[NR_CPUS];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct thread_info *secondary_ti;\nstruct thread_info *current_set[NR_CPUS];\n\nstatic void cpu_idle_thread_init(unsigned int cpu, struct task_struct *idle)\n{\n\tstruct thread_info *ti = task_thread_info(idle);\n\n#ifdef CONFIG_PPC64\n\tpaca[cpu].__current = idle;\n\tpaca[cpu].kstack = (unsigned long)ti + THREAD_SIZE - STACK_FRAME_OVERHEAD;\n#endif\n\tti->cpu = cpu;\n\tsecondary_ti = current_set[cpu] = ti;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_ops->cpu_bootable",
          "args": [
            "cpu"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_thread_in_subcore",
          "args": [
            "cpu"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "secondaries_inhibited",
          "args": [],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "secondaries_inhibited",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "457-460",
          "snippet": "static bool secondaries_inhibited(void)\n{\n\treturn kvm_hv_mode_active();\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic bool secondaries_inhibited(void)\n{\n\treturn kvm_hv_mode_active();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\nvolatile unsigned int cpu_callin_map[NR_CPUS];\n\nint __cpu_up(unsigned int cpu, struct task_struct *tidle)\n{\n\tint rc, c;\n\n\t/*\n\t * Don't allow secondary threads to come online if inhibited\n\t */\n\tif (threads_per_core > 1 && secondaries_inhibited() &&\n\t    cpu_thread_in_subcore(cpu))\n\t\treturn -EBUSY;\n\n\tif (smp_ops == NULL ||\n\t    (smp_ops->cpu_bootable && !smp_ops->cpu_bootable(cpu)))\n\t\treturn -EINVAL;\n\n\tcpu_idle_thread_init(cpu, tidle);\n\n\t/* Make sure callin-map entry is 0 (can be leftover a CPU\n\t * hotplug\n\t */\n\tcpu_callin_map[cpu] = 0;\n\n\t/* The information for processor bringup must\n\t * be written out to main store before we release\n\t * the processor.\n\t */\n\tsmp_mb();\n\n\t/* wake up cpus */\n\tDBG(\"smp: kicking cpu %d\\n\", cpu);\n\trc = smp_ops->kick_cpu(cpu);\n\tif (rc) {\n\t\tpr_err(\"smp: failed starting cpu %d (rc %d)\\n\", cpu, rc);\n\t\treturn rc;\n\t}\n\n\t/*\n\t * wait to see if the cpu made a callin (is actually up).\n\t * use this value that I found through experimentation.\n\t * -- Cort\n\t */\n\tif (system_state < SYSTEM_RUNNING)\n\t\tfor (c = 50000; c && !cpu_callin_map[cpu]; c--)\n\t\t\tudelay(100);\n#ifdef CONFIG_HOTPLUG_CPU\n\telse\n\t\t/*\n\t\t * CPUs can take much longer to come up in the\n\t\t * hotplug case.  Wait five seconds.\n\t\t */\n\t\tfor (c = 5000; c && !cpu_callin_map[cpu]; c--)\n\t\t\tmsleep(1);\n#endif\n\n\tif (!cpu_callin_map[cpu]) {\n\t\tprintk(KERN_ERR \"Processor %u is stuck.\\n\", cpu);\n\t\treturn -ENOENT;\n\t}\n\n\tDBG(\"Processor %u found.\\n\", cpu);\n\n\tif (smp_ops->give_timebase)\n\t\tsmp_ops->give_timebase();\n\n\t/* Wait until cpu puts itself in the online & active maps */\n\twhile (!cpu_online(cpu) || !cpu_active(cpu))\n\t\tcpu_relax();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cpu_idle_thread_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "468-478",
    "snippet": "static void cpu_idle_thread_init(unsigned int cpu, struct task_struct *idle)\n{\n\tstruct thread_info *ti = task_thread_info(idle);\n\n#ifdef CONFIG_PPC64\n\tpaca[cpu].__current = idle;\n\tpaca[cpu].kstack = (unsigned long)ti + THREAD_SIZE - STACK_FRAME_OVERHEAD;\n#endif\n\tti->cpu = cpu;\n\tsecondary_ti = current_set[cpu] = ti;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct thread_info *secondary_ti;",
      "struct thread_info *current_set[NR_CPUS];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "task_thread_info",
          "args": [
            "idle"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct thread_info *secondary_ti;\nstruct thread_info *current_set[NR_CPUS];\n\nstatic void cpu_idle_thread_init(unsigned int cpu, struct task_struct *idle)\n{\n\tstruct thread_info *ti = task_thread_info(idle);\n\n#ifdef CONFIG_PPC64\n\tpaca[cpu].__current = idle;\n\tpaca[cpu].kstack = (unsigned long)ti + THREAD_SIZE - STACK_FRAME_OVERHEAD;\n#endif\n\tti->cpu = cpu;\n\tsecondary_ti = current_set[cpu] = ti;\n}"
  },
  {
    "function_name": "secondaries_inhibited",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "457-460",
    "snippet": "static bool secondaries_inhibited(void)\n{\n\treturn kvm_hv_mode_active();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_hv_mode_active",
          "args": [],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic bool secondaries_inhibited(void)\n{\n\treturn kvm_hv_mode_active();\n}"
  },
  {
    "function_name": "generic_check_cpu_restart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "452-455",
    "snippet": "int generic_check_cpu_restart(unsigned int cpu)\n{\n\treturn per_cpu(cpu_state, cpu) == CPU_UP_PREPARE;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_state",
            "cpu"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint generic_check_cpu_restart(unsigned int cpu)\n{\n\treturn per_cpu(cpu_state, cpu) == CPU_UP_PREPARE;\n}"
  },
  {
    "function_name": "generic_set_cpu_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "447-450",
    "snippet": "void generic_set_cpu_up(unsigned int cpu)\n{\n\tper_cpu(cpu_state, cpu) = CPU_UP_PREPARE;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_state",
            "cpu"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid generic_set_cpu_up(unsigned int cpu)\n{\n\tper_cpu(cpu_state, cpu) = CPU_UP_PREPARE;\n}"
  },
  {
    "function_name": "generic_set_cpu_dead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "437-440",
    "snippet": "void generic_set_cpu_dead(unsigned int cpu)\n{\n\tper_cpu(cpu_state, cpu) = CPU_DEAD;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_state",
            "cpu"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid generic_set_cpu_dead(unsigned int cpu)\n{\n\tper_cpu(cpu_state, cpu) = CPU_DEAD;\n}"
  },
  {
    "function_name": "generic_cpu_die",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "424-435",
    "snippet": "void generic_cpu_die(unsigned int cpu)\n{\n\tint i;\n\n\tfor (i = 0; i < 100; i++) {\n\t\tsmp_rmb();\n\t\tif (per_cpu(cpu_state, cpu) == CPU_DEAD)\n\t\t\treturn;\n\t\tmsleep(100);\n\t}\n\tprintk(KERN_ERR \"CPU%d didn't die...\\n\", cpu);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"CPU%d didn't die...\\n\"",
            "cpu"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "printk_log_rtas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/rtasd.c",
          "lines": "111-156",
          "snippet": "static void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s, Severity: %d\\n\",\n\t\t       error_log_cnt, rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_severity(errlog));\n\t}\n}",
          "includes": [
            "#include <asm/topology.h>",
            "#include <asm/machdep.h>",
            "#include <linux/atomic.h>",
            "#include <asm/nvram.h>",
            "#include <asm/prom.h>",
            "#include <asm/rtas.h>",
            "#include <asm/io.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/cpu.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int full_rtas_msgs = 0;",
            "static int error_log_cnt;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/topology.h>\n#include <asm/machdep.h>\n#include <linux/atomic.h>\n#include <asm/nvram.h>\n#include <asm/prom.h>\n#include <asm/rtas.h>\n#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/cpu.h>\n#include <linux/spinlock.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic int full_rtas_msgs = 0;\nstatic int error_log_cnt;\n\nstatic void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s, Severity: %d\\n\",\n\t\t       error_log_cnt, rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_severity(errlog));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "msleep",
          "args": [
            "100"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_state",
            "cpu"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_rmb",
          "args": [],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid generic_cpu_die(unsigned int cpu)\n{\n\tint i;\n\n\tfor (i = 0; i < 100; i++) {\n\t\tsmp_rmb();\n\t\tif (per_cpu(cpu_state, cpu) == CPU_DEAD)\n\t\t\treturn;\n\t\tmsleep(100);\n\t}\n\tprintk(KERN_ERR \"CPU%d didn't die...\\n\", cpu);\n}"
  },
  {
    "function_name": "generic_cpu_disable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "409-422",
    "snippet": "int generic_cpu_disable(void)\n{\n\tunsigned int cpu = smp_processor_id();\n\n\tif (cpu == boot_cpuid)\n\t\treturn -EBUSY;\n\n\tset_cpu_online(cpu, false);\n#ifdef CONFIG_PPC64\n\tvdso_data->processorCount--;\n#endif\n\tmigrate_irqs();\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "migrate_irqs",
          "args": [],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "migrate_irqs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/irq.c",
          "lines": "424-460",
          "snippet": "void migrate_irqs(void)\n{\n\tstruct irq_desc *desc;\n\tunsigned int irq;\n\tstatic int warned;\n\tcpumask_var_t mask;\n\tconst struct cpumask *map = cpu_online_mask;\n\n\talloc_cpumask_var(&mask, GFP_KERNEL);\n\n\tfor_each_irq_desc(irq, desc) {\n\t\tstruct irq_data *data;\n\t\tstruct irq_chip *chip;\n\n\t\tdata = irq_desc_get_irq_data(desc);\n\t\tif (irqd_is_per_cpu(data))\n\t\t\tcontinue;\n\n\t\tchip = irq_data_get_irq_chip(data);\n\n\t\tcpumask_and(mask, irq_data_get_affinity_mask(data), map);\n\t\tif (cpumask_any(mask) >= nr_cpu_ids) {\n\t\t\tpr_warn(\"Breaking affinity for irq %i\\n\", irq);\n\t\t\tcpumask_copy(mask, map);\n\t\t}\n\t\tif (chip->irq_set_affinity)\n\t\t\tchip->irq_set_affinity(data, mask, true);\n\t\telse if (desc->action && !(warned++))\n\t\t\tpr_err(\"Cannot set affinity for irq %i\\n\", irq);\n\t}\n\n\tfree_cpumask_var(mask);\n\n\tlocal_irq_enable();\n\tmdelay(1);\n\tlocal_irq_disable();\n}",
          "includes": [
            "#include <asm/trace.h>",
            "#include <asm/lv1call.h>",
            "#include <asm/firmware.h>",
            "#include <asm/paca.h>",
            "#include <asm/debug.h>",
            "#include <asm/smp.h>",
            "#include <asm/udbg.h>",
            "#include <asm/machdep.h>",
            "#include <asm/ptrace.h>",
            "#include <asm/prom.h>",
            "#include <asm/cache.h>",
            "#include <asm/irq.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/io.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/pci.h>",
            "#include <linux/mutex.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/list.h>",
            "#include <linux/bitops.h>",
            "#include <linux/profile.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/irq.h>",
            "#include <linux/delay.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/ioport.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/sched.h>",
            "#include <linux/signal.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/threads.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/trace.h>\n#include <asm/lv1call.h>\n#include <asm/firmware.h>\n#include <asm/paca.h>\n#include <asm/debug.h>\n#include <asm/smp.h>\n#include <asm/udbg.h>\n#include <asm/machdep.h>\n#include <asm/ptrace.h>\n#include <asm/prom.h>\n#include <asm/cache.h>\n#include <asm/irq.h>\n#include <asm/pgtable.h>\n#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <linux/of_irq.h>\n#include <linux/of.h>\n#include <linux/debugfs.h>\n#include <linux/pci.h>\n#include <linux/mutex.h>\n#include <linux/radix-tree.h>\n#include <linux/list.h>\n#include <linux/bitops.h>\n#include <linux/profile.h>\n#include <linux/cpumask.h>\n#include <linux/seq_file.h>\n#include <linux/irq.h>\n#include <linux/delay.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/ioport.h>\n#include <linux/ptrace.h>\n#include <linux/sched.h>\n#include <linux/signal.h>\n#include <linux/kernel_stat.h>\n#include <linux/threads.h>\n#include <linux/export.h>\n\nvoid migrate_irqs(void)\n{\n\tstruct irq_desc *desc;\n\tunsigned int irq;\n\tstatic int warned;\n\tcpumask_var_t mask;\n\tconst struct cpumask *map = cpu_online_mask;\n\n\talloc_cpumask_var(&mask, GFP_KERNEL);\n\n\tfor_each_irq_desc(irq, desc) {\n\t\tstruct irq_data *data;\n\t\tstruct irq_chip *chip;\n\n\t\tdata = irq_desc_get_irq_data(desc);\n\t\tif (irqd_is_per_cpu(data))\n\t\t\tcontinue;\n\n\t\tchip = irq_data_get_irq_chip(data);\n\n\t\tcpumask_and(mask, irq_data_get_affinity_mask(data), map);\n\t\tif (cpumask_any(mask) >= nr_cpu_ids) {\n\t\t\tpr_warn(\"Breaking affinity for irq %i\\n\", irq);\n\t\t\tcpumask_copy(mask, map);\n\t\t}\n\t\tif (chip->irq_set_affinity)\n\t\t\tchip->irq_set_affinity(data, mask, true);\n\t\telse if (desc->action && !(warned++))\n\t\t\tpr_err(\"Cannot set affinity for irq %i\\n\", irq);\n\t}\n\n\tfree_cpumask_var(mask);\n\n\tlocal_irq_enable();\n\tmdelay(1);\n\tlocal_irq_disable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_cpu_online",
          "args": [
            "cpu",
            "false"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint generic_cpu_disable(void)\n{\n\tunsigned int cpu = smp_processor_id();\n\n\tif (cpu == boot_cpuid)\n\t\treturn -EBUSY;\n\n\tset_cpu_online(cpu, false);\n#ifdef CONFIG_PPC64\n\tvdso_data->processorCount--;\n#endif\n\tmigrate_irqs();\n\treturn 0;\n}"
  },
  {
    "function_name": "smp_prepare_boot_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "397-405",
    "snippet": "void smp_prepare_boot_cpu(void)\n{\n\tBUG_ON(smp_processor_id() != boot_cpuid);\n#ifdef CONFIG_PPC64\n\tpaca[boot_cpuid].__current = current;\n#endif\n\tset_numa_node(numa_cpu_lookup_table[boot_cpuid]);\n\tcurrent_set[boot_cpuid] = task_thread_info(current);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct thread_info *current_set[NR_CPUS];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "task_thread_info",
          "args": [
            "current"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_numa_node",
          "args": [
            "numa_cpu_lookup_table[boot_cpuid]"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "smp_processor_id() != boot_cpuid"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct thread_info *current_set[NR_CPUS];\n\nvoid smp_prepare_boot_cpu(void)\n{\n\tBUG_ON(smp_processor_id() != boot_cpuid);\n#ifdef CONFIG_PPC64\n\tpaca[boot_cpuid].__current = current;\n#endif\n\tset_numa_node(numa_cpu_lookup_table[boot_cpuid]);\n\tcurrent_set[boot_cpuid] = task_thread_info(current);\n}"
  },
  {
    "function_name": "smp_prepare_cpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "359-395",
    "snippet": "void __init smp_prepare_cpus(unsigned int max_cpus)\n{\n\tunsigned int cpu;\n\n\tDBG(\"smp_prepare_cpus\\n\");\n\n\t/* \n\t * setup_cpu may need to be called on the boot cpu. We havent\n\t * spun any cpus up but lets be paranoid.\n\t */\n\tBUG_ON(boot_cpuid != smp_processor_id());\n\n\t/* Fixup boot cpu */\n\tsmp_store_cpu_info(boot_cpuid);\n\tcpu_callin_map[boot_cpuid] = 1;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_sibling_map, cpu),\n\t\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_core_map, cpu),\n\t\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\t\t/*\n\t\t * numa_node_id() works after this.\n\t\t */\n\t\tif (cpu_present(cpu)) {\n\t\t\tset_cpu_numa_node(cpu, numa_cpu_lookup_table[cpu]);\n\t\t\tset_cpu_numa_mem(cpu,\n\t\t\t\tlocal_memory_node(numa_cpu_lookup_table[cpu]));\n\t\t}\n\t}\n\n\tcpumask_set_cpu(boot_cpuid, cpu_sibling_mask(boot_cpuid));\n\tcpumask_set_cpu(boot_cpuid, cpu_core_mask(boot_cpuid));\n\n\tif (smp_ops && smp_ops->probe)\n\t\tsmp_ops->probe();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;",
      "volatile unsigned int cpu_callin_map[NR_CPUS];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_ops->probe",
          "args": [],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "boot_cpuid",
            "cpu_core_mask(boot_cpuid)"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_core_mask",
          "args": [
            "boot_cpuid"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "boot_cpuid",
            "cpu_sibling_mask(boot_cpuid)"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_sibling_mask",
          "args": [
            "boot_cpuid"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_numa_mem",
          "args": [
            "cpu",
            "local_memory_node(numa_cpu_lookup_table[cpu])"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_memory_node",
          "args": [
            "numa_cpu_lookup_table[cpu]"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_numa_node",
          "args": [
            "cpu",
            "numa_cpu_lookup_table[cpu]"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_present",
          "args": [
            "cpu"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zalloc_cpumask_var_node",
          "args": [
            "&per_cpu(cpu_core_map, cpu)",
            "GFP_KERNEL",
            "cpu_to_node(cpu)"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_core_map",
            "cpu"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zalloc_cpumask_var_node",
          "args": [
            "&per_cpu(cpu_sibling_map, cpu)",
            "GFP_KERNEL",
            "cpu_to_node(cpu)"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_sibling_map",
            "cpu"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_store_cpu_info",
          "args": [
            "boot_cpuid"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "smp_store_cpu_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "350-357",
          "snippet": "static void smp_store_cpu_info(int id)\n{\n\tper_cpu(cpu_pvr, id) = mfspr(SPRN_PVR);\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tper_cpu(next_tlbcam_idx, id)\n\t\t= (mfspr(SPRN_TLB1CFG) & TLBnCFG_N_ENTRY) - 1;\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void smp_store_cpu_info(int id)\n{\n\tper_cpu(cpu_pvr, id) = mfspr(SPRN_PVR);\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tper_cpu(next_tlbcam_idx, id)\n\t\t= (mfspr(SPRN_TLB1CFG) & TLBnCFG_N_ENTRY) - 1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "boot_cpuid != smp_processor_id()"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"smp_prepare_cpus\\n\""
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\nvolatile unsigned int cpu_callin_map[NR_CPUS];\n\nvoid __init smp_prepare_cpus(unsigned int max_cpus)\n{\n\tunsigned int cpu;\n\n\tDBG(\"smp_prepare_cpus\\n\");\n\n\t/* \n\t * setup_cpu may need to be called on the boot cpu. We havent\n\t * spun any cpus up but lets be paranoid.\n\t */\n\tBUG_ON(boot_cpuid != smp_processor_id());\n\n\t/* Fixup boot cpu */\n\tsmp_store_cpu_info(boot_cpuid);\n\tcpu_callin_map[boot_cpuid] = 1;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_sibling_map, cpu),\n\t\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_core_map, cpu),\n\t\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\t\t/*\n\t\t * numa_node_id() works after this.\n\t\t */\n\t\tif (cpu_present(cpu)) {\n\t\t\tset_cpu_numa_node(cpu, numa_cpu_lookup_table[cpu]);\n\t\t\tset_cpu_numa_mem(cpu,\n\t\t\t\tlocal_memory_node(numa_cpu_lookup_table[cpu]));\n\t\t}\n\t}\n\n\tcpumask_set_cpu(boot_cpuid, cpu_sibling_mask(boot_cpuid));\n\tcpumask_set_cpu(boot_cpuid, cpu_core_mask(boot_cpuid));\n\n\tif (smp_ops && smp_ops->probe)\n\t\tsmp_ops->probe();\n}"
  },
  {
    "function_name": "smp_store_cpu_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "350-357",
    "snippet": "static void smp_store_cpu_info(int id)\n{\n\tper_cpu(cpu_pvr, id) = mfspr(SPRN_PVR);\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tper_cpu(next_tlbcam_idx, id)\n\t\t= (mfspr(SPRN_TLB1CFG) & TLBnCFG_N_ENTRY) - 1;\n#endif\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_TLB1CFG"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "next_tlbcam_idx",
            "id"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PVR"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_pvr",
            "id"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void smp_store_cpu_info(int id)\n{\n\tper_cpu(cpu_pvr, id) = mfspr(SPRN_PVR);\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tper_cpu(next_tlbcam_idx, id)\n\t\t= (mfspr(SPRN_TLB1CFG) & TLBnCFG_N_ENTRY) - 1;\n#endif\n}"
  },
  {
    "function_name": "smp_send_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "343-346",
    "snippet": "void smp_send_stop(void)\n{\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_call_function",
          "args": [
            "stop_this_cpu",
            "NULL",
            "0"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_send_stop(void)\n{\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}"
  },
  {
    "function_name": "stop_this_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "333-341",
    "snippet": "static void stop_this_cpu(void *dummy)\n{\n\t/* Remove this CPU */\n\tset_cpu_online(smp_processor_id(), false);\n\n\tlocal_irq_disable();\n\twhile (1)\n\t\t;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_disable",
          "args": [],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_online",
          "args": [
            "smp_processor_id()",
            "false"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void stop_this_cpu(void *dummy)\n{\n\t/* Remove this CPU */\n\tset_cpu_online(smp_processor_id(), false);\n\n\tlocal_irq_disable();\n\twhile (1)\n\t\t;\n}"
  },
  {
    "function_name": "crash_send_ipi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "323-330",
    "snippet": "void crash_send_ipi(void (*crash_ipi_callback)(struct pt_regs *))\n{\n\tcrash_ipi_function_ptr = crash_ipi_callback;\n\tif (crash_ipi_callback) {\n\t\tmb();\n\t\tsmp_send_debugger_break();\n\t}\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void (*crash_ipi_function_ptr)(struct pt_regs *) = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_send_debugger_break",
          "args": [],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "smp_send_debugger_break",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "308-319",
          "snippet": "void smp_send_debugger_break(void)\n{\n\tint cpu;\n\tint me = raw_smp_processor_id();\n\n\tif (unlikely(!smp_ops))\n\t\treturn;\n\n\tfor_each_online_cpu(cpu)\n\t\tif (cpu != me)\n\t\t\tdo_message_pass(cpu, PPC_MSG_DEBUGGER_BREAK);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nvoid smp_send_debugger_break(void)\n{\n\tint cpu;\n\tint me = raw_smp_processor_id();\n\n\tif (unlikely(!smp_ops))\n\t\treturn;\n\n\tfor_each_online_cpu(cpu)\n\t\tif (cpu != me)\n\t\t\tdo_message_pass(cpu, PPC_MSG_DEBUGGER_BREAK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb",
          "args": [],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void (*crash_ipi_function_ptr)(struct pt_regs *) = NULL;\n\nvoid crash_send_ipi(void (*crash_ipi_callback)(struct pt_regs *))\n{\n\tcrash_ipi_function_ptr = crash_ipi_callback;\n\tif (crash_ipi_callback) {\n\t\tmb();\n\t\tsmp_send_debugger_break();\n\t}\n}"
  },
  {
    "function_name": "smp_send_debugger_break",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "308-319",
    "snippet": "void smp_send_debugger_break(void)\n{\n\tint cpu;\n\tint me = raw_smp_processor_id();\n\n\tif (unlikely(!smp_ops))\n\t\treturn;\n\n\tfor_each_online_cpu(cpu)\n\t\tif (cpu != me)\n\t\t\tdo_message_pass(cpu, PPC_MSG_DEBUGGER_BREAK);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_message_pass",
          "args": [
            "cpu",
            "PPC_MSG_DEBUGGER_BREAK"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "do_message_pass",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "267-275",
          "snippet": "static inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!smp_ops"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_smp_processor_id",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nvoid smp_send_debugger_break(void)\n{\n\tint cpu;\n\tint me = raw_smp_processor_id();\n\n\tif (unlikely(!smp_ops))\n\t\treturn;\n\n\tfor_each_online_cpu(cpu)\n\t\tif (cpu != me)\n\t\t\tdo_message_pass(cpu, PPC_MSG_DEBUGGER_BREAK);\n}"
  },
  {
    "function_name": "tick_broadcast",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "298-304",
    "snippet": "void tick_broadcast(const struct cpumask *mask)\n{\n\tunsigned int cpu;\n\n\tfor_each_cpu(cpu, mask)\n\t\tdo_message_pass(cpu, PPC_MSG_TICK_BROADCAST);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_message_pass",
          "args": [
            "cpu",
            "PPC_MSG_TICK_BROADCAST"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "do_message_pass",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "267-275",
          "snippet": "static inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "cpu",
            "mask"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid tick_broadcast(const struct cpumask *mask)\n{\n\tunsigned int cpu;\n\n\tfor_each_cpu(cpu, mask)\n\t\tdo_message_pass(cpu, PPC_MSG_TICK_BROADCAST);\n}"
  },
  {
    "function_name": "arch_send_call_function_ipi_mask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "289-295",
    "snippet": "void arch_send_call_function_ipi_mask(const struct cpumask *mask)\n{\n\tunsigned int cpu;\n\n\tfor_each_cpu(cpu, mask)\n\t\tdo_message_pass(cpu, PPC_MSG_CALL_FUNCTION);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_message_pass",
          "args": [
            "cpu",
            "PPC_MSG_CALL_FUNCTION"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "do_message_pass",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "267-275",
          "snippet": "static inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "cpu",
            "mask"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid arch_send_call_function_ipi_mask(const struct cpumask *mask)\n{\n\tunsigned int cpu;\n\n\tfor_each_cpu(cpu, mask)\n\t\tdo_message_pass(cpu, PPC_MSG_CALL_FUNCTION);\n}"
  },
  {
    "function_name": "arch_send_call_function_single_ipi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "284-287",
    "snippet": "void arch_send_call_function_single_ipi(int cpu)\n{\n\tdo_message_pass(cpu, PPC_MSG_CALL_FUNCTION);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_message_pass",
          "args": [
            "cpu",
            "PPC_MSG_CALL_FUNCTION"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "do_message_pass",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "267-275",
          "snippet": "static inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid arch_send_call_function_single_ipi(int cpu)\n{\n\tdo_message_pass(cpu, PPC_MSG_CALL_FUNCTION);\n}"
  },
  {
    "function_name": "smp_send_reschedule",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "277-281",
    "snippet": "void smp_send_reschedule(int cpu)\n{\n\tif (likely(smp_ops))\n\t\tdo_message_pass(cpu, PPC_MSG_RESCHEDULE);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_message_pass",
          "args": [
            "cpu",
            "PPC_MSG_RESCHEDULE"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "do_message_pass",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "267-275",
          "snippet": "static inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "smp_ops"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nvoid smp_send_reschedule(int cpu)\n{\n\tif (likely(smp_ops))\n\t\tdo_message_pass(cpu, PPC_MSG_RESCHEDULE);\n}"
  },
  {
    "function_name": "do_message_pass",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "267-275",
    "snippet": "static inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_ops->message_pass",
          "args": [
            "cpu",
            "msg"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}"
  },
  {
    "function_name": "smp_ipi_demux",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "244-264",
    "snippet": "irqreturn_t smp_ipi_demux(void)\n{\n\tstruct cpu_messages *info = this_cpu_ptr(&ipi_message);\n\tunsigned int all;\n\n\tmb();\t/* order any irq clear */\n\n\tdo {\n\t\tall = xchg(&info->messages, 0);\n\t\tif (all & IPI_MESSAGE(PPC_MSG_CALL_FUNCTION))\n\t\t\tgeneric_smp_call_function_interrupt();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_RESCHEDULE))\n\t\t\tscheduler_ipi();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_TICK_BROADCAST))\n\t\t\ttick_broadcast_ipi_handler();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_DEBUGGER_BREAK))\n\t\t\tdebug_ipi_action(0, NULL);\n\t} while (info->messages);\n\n\treturn IRQ_HANDLED;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug_ipi_action",
          "args": [
            "0",
            "NULL"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "debug_ipi_action",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "157-169",
          "snippet": "static irqreturn_t debug_ipi_action(int irq, void *data)\n{\n\tif (crash_ipi_function_ptr) {\n\t\tcrash_ipi_function_ptr(get_irq_regs());\n\t\treturn IRQ_HANDLED;\n\t}\n\n#ifdef CONFIG_DEBUGGER\n\tdebugger_ipi(get_irq_regs());\n#endif /* CONFIG_DEBUGGER */\n\n\treturn IRQ_HANDLED;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic irqreturn_t debug_ipi_action(int irq, void *data)\n{\n\tif (crash_ipi_function_ptr) {\n\t\tcrash_ipi_function_ptr(get_irq_regs());\n\t\treturn IRQ_HANDLED;\n\t}\n\n#ifdef CONFIG_DEBUGGER\n\tdebugger_ipi(get_irq_regs());\n#endif /* CONFIG_DEBUGGER */\n\n\treturn IRQ_HANDLED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IPI_MESSAGE",
          "args": [
            "PPC_MSG_DEBUGGER_BREAK"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tick_broadcast_ipi_handler",
          "args": [],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "tick_broadcast_ipi_handler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "873-879",
          "snippet": "void tick_broadcast_ipi_handler(void)\n{\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t*next_tb = get_tb_or_rtc();\n\t__timer_interrupt();\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid tick_broadcast_ipi_handler(void)\n{\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t*next_tb = get_tb_or_rtc();\n\t__timer_interrupt();\n}"
        }
      },
      {
        "call_info": {
          "callee": "IPI_MESSAGE",
          "args": [
            "PPC_MSG_TICK_BROADCAST"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scheduler_ipi",
          "args": [],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IPI_MESSAGE",
          "args": [
            "PPC_MSG_RESCHEDULE"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "generic_smp_call_function_interrupt",
          "args": [],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IPI_MESSAGE",
          "args": [
            "PPC_MSG_CALL_FUNCTION"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xchg",
          "args": [
            "&info->messages",
            "0"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb",
          "args": [],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&ipi_message"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nirqreturn_t smp_ipi_demux(void)\n{\n\tstruct cpu_messages *info = this_cpu_ptr(&ipi_message);\n\tunsigned int all;\n\n\tmb();\t/* order any irq clear */\n\n\tdo {\n\t\tall = xchg(&info->messages, 0);\n\t\tif (all & IPI_MESSAGE(PPC_MSG_CALL_FUNCTION))\n\t\t\tgeneric_smp_call_function_interrupt();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_RESCHEDULE))\n\t\t\tscheduler_ipi();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_TICK_BROADCAST))\n\t\t\ttick_broadcast_ipi_handler();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_DEBUGGER_BREAK))\n\t\t\tdebug_ipi_action(0, NULL);\n\t} while (info->messages);\n\n\treturn IRQ_HANDLED;\n}"
  },
  {
    "function_name": "smp_muxed_ipi_message_pass",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "221-236",
    "snippet": "void smp_muxed_ipi_message_pass(int cpu, int msg)\n{\n\tstruct cpu_messages *info = &per_cpu(ipi_message, cpu);\n\tchar *message = (char *)&info->messages;\n\n\t/*\n\t * Order previous accesses before accesses in the IPI handler.\n\t */\n\tsmp_mb();\n\tmessage[msg] = 1;\n\t/*\n\t * cause_ipi functions are required to include a full barrier\n\t * before doing whatever causes the IPI.\n\t */\n\tsmp_ops->cause_ipi(cpu, info->data);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_ops->cause_ipi",
          "args": [
            "cpu",
            "info->data"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "ipi_message",
            "cpu"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nvoid smp_muxed_ipi_message_pass(int cpu, int msg)\n{\n\tstruct cpu_messages *info = &per_cpu(ipi_message, cpu);\n\tchar *message = (char *)&info->messages;\n\n\t/*\n\t * Order previous accesses before accesses in the IPI handler.\n\t */\n\tsmp_mb();\n\tmessage[msg] = 1;\n\t/*\n\t * cause_ipi functions are required to include a full barrier\n\t * before doing whatever causes the IPI.\n\t */\n\tsmp_ops->cause_ipi(cpu, info->data);\n}"
  },
  {
    "function_name": "smp_muxed_ipi_set_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "214-219",
    "snippet": "void smp_muxed_ipi_set_data(int cpu, unsigned long data)\n{\n\tstruct cpu_messages *info = &per_cpu(ipi_message, cpu);\n\n\tinfo->data = data;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "ipi_message",
            "cpu"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_muxed_ipi_set_data(int cpu, unsigned long data)\n{\n\tstruct cpu_messages *info = &per_cpu(ipi_message, cpu);\n\n\tinfo->data = data;\n}"
  },
  {
    "function_name": "smp_request_message_ipi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "186-205",
    "snippet": "int smp_request_message_ipi(int virq, int msg)\n{\n\tint err;\n\n\tif (msg < 0 || msg > PPC_MSG_DEBUGGER_BREAK) {\n\t\treturn -EINVAL;\n\t}\n#if !defined(CONFIG_DEBUGGER) && !defined(CONFIG_KEXEC)\n\tif (msg == PPC_MSG_DEBUGGER_BREAK) {\n\t\treturn 1;\n\t}\n#endif\n\terr = request_irq(virq, smp_ipi_action[msg],\n\t\t\t  IRQF_PERCPU | IRQF_NO_THREAD | IRQF_NO_SUSPEND,\n\t\t\t  smp_ipi_name[msg], NULL);\n\tWARN(err < 0, \"unable to request_irq %d for %s (rc %d)\\n\",\n\t\tvirq, smp_ipi_name[msg], err);\n\n\treturn err;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static irq_handler_t smp_ipi_action[] = {\n\t[PPC_MSG_CALL_FUNCTION] =  call_function_action,\n\t[PPC_MSG_RESCHEDULE] = reschedule_action,\n\t[PPC_MSG_TICK_BROADCAST] = tick_broadcast_ipi_action,\n\t[PPC_MSG_DEBUGGER_BREAK] = debug_ipi_action,\n};",
      "const char *smp_ipi_name[] = {\n\t[PPC_MSG_CALL_FUNCTION] =  \"ipi call function\",\n\t[PPC_MSG_RESCHEDULE] = \"ipi reschedule\",\n\t[PPC_MSG_TICK_BROADCAST] = \"ipi tick-broadcast\",\n\t[PPC_MSG_DEBUGGER_BREAK] = \"ipi debugger\",\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "err < 0",
            "\"unable to request_irq %d for %s (rc %d)\\n\"",
            "virq",
            "smp_ipi_name[msg]",
            "err"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request_irq",
          "args": [
            "virq",
            "smp_ipi_action[msg]",
            "IRQF_PERCPU | IRQF_NO_THREAD | IRQF_NO_SUSPEND",
            "smp_ipi_name[msg]",
            "NULL"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_request_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "224-234",
          "snippet": "int ibmebus_request_irq(u32 ist, irq_handler_t handler,\n\t\t\tunsigned long irq_flags, const char *devname,\n\t\t\tvoid *dev_id)\n{\n\tunsigned int irq = irq_create_mapping(NULL, ist);\n\n\tif (irq == NO_IRQ)\n\t\treturn -EINVAL;\n\n\treturn request_irq(irq, handler, irq_flags, devname, dev_id);\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nint ibmebus_request_irq(u32 ist, irq_handler_t handler,\n\t\t\tunsigned long irq_flags, const char *devname,\n\t\t\tvoid *dev_id)\n{\n\tunsigned int irq = irq_create_mapping(NULL, ist);\n\n\tif (irq == NO_IRQ)\n\t\treturn -EINVAL;\n\n\treturn request_irq(irq, handler, irq_flags, devname, dev_id);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic irq_handler_t smp_ipi_action[] = {\n\t[PPC_MSG_CALL_FUNCTION] =  call_function_action,\n\t[PPC_MSG_RESCHEDULE] = reschedule_action,\n\t[PPC_MSG_TICK_BROADCAST] = tick_broadcast_ipi_action,\n\t[PPC_MSG_DEBUGGER_BREAK] = debug_ipi_action,\n};\nconst char *smp_ipi_name[] = {\n\t[PPC_MSG_CALL_FUNCTION] =  \"ipi call function\",\n\t[PPC_MSG_RESCHEDULE] = \"ipi reschedule\",\n\t[PPC_MSG_TICK_BROADCAST] = \"ipi tick-broadcast\",\n\t[PPC_MSG_DEBUGGER_BREAK] = \"ipi debugger\",\n};\n\nint smp_request_message_ipi(int virq, int msg)\n{\n\tint err;\n\n\tif (msg < 0 || msg > PPC_MSG_DEBUGGER_BREAK) {\n\t\treturn -EINVAL;\n\t}\n#if !defined(CONFIG_DEBUGGER) && !defined(CONFIG_KEXEC)\n\tif (msg == PPC_MSG_DEBUGGER_BREAK) {\n\t\treturn 1;\n\t}\n#endif\n\terr = request_irq(virq, smp_ipi_action[msg],\n\t\t\t  IRQF_PERCPU | IRQF_NO_THREAD | IRQF_NO_SUSPEND,\n\t\t\t  smp_ipi_name[msg], NULL);\n\tWARN(err < 0, \"unable to request_irq %d for %s (rc %d)\\n\",\n\t\tvirq, smp_ipi_name[msg], err);\n\n\treturn err;\n}"
  },
  {
    "function_name": "debug_ipi_action",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "157-169",
    "snippet": "static irqreturn_t debug_ipi_action(int irq, void *data)\n{\n\tif (crash_ipi_function_ptr) {\n\t\tcrash_ipi_function_ptr(get_irq_regs());\n\t\treturn IRQ_HANDLED;\n\t}\n\n#ifdef CONFIG_DEBUGGER\n\tdebugger_ipi(get_irq_regs());\n#endif /* CONFIG_DEBUGGER */\n\n\treturn IRQ_HANDLED;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugger_ipi",
          "args": [
            "get_irq_regs()"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_irq_regs",
          "args": [],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crash_ipi_function_ptr",
          "args": [
            "get_irq_regs()"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_irq_regs",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic irqreturn_t debug_ipi_action(int irq, void *data)\n{\n\tif (crash_ipi_function_ptr) {\n\t\tcrash_ipi_function_ptr(get_irq_regs());\n\t\treturn IRQ_HANDLED;\n\t}\n\n#ifdef CONFIG_DEBUGGER\n\tdebugger_ipi(get_irq_regs());\n#endif /* CONFIG_DEBUGGER */\n\n\treturn IRQ_HANDLED;\n}"
  },
  {
    "function_name": "tick_broadcast_ipi_action",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "151-155",
    "snippet": "static irqreturn_t tick_broadcast_ipi_action(int irq, void *data)\n{\n\ttick_broadcast_ipi_handler();\n\treturn IRQ_HANDLED;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tick_broadcast_ipi_handler",
          "args": [],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "tick_broadcast_ipi_handler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "873-879",
          "snippet": "void tick_broadcast_ipi_handler(void)\n{\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t*next_tb = get_tb_or_rtc();\n\t__timer_interrupt();\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid tick_broadcast_ipi_handler(void)\n{\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t*next_tb = get_tb_or_rtc();\n\t__timer_interrupt();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic irqreturn_t tick_broadcast_ipi_action(int irq, void *data)\n{\n\ttick_broadcast_ipi_handler();\n\treturn IRQ_HANDLED;\n}"
  },
  {
    "function_name": "reschedule_action",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "145-149",
    "snippet": "static irqreturn_t reschedule_action(int irq, void *data)\n{\n\tscheduler_ipi();\n\treturn IRQ_HANDLED;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scheduler_ipi",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic irqreturn_t reschedule_action(int irq, void *data)\n{\n\tscheduler_ipi();\n\treturn IRQ_HANDLED;\n}"
  },
  {
    "function_name": "call_function_action",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "139-143",
    "snippet": "static irqreturn_t call_function_action(int irq, void *data)\n{\n\tgeneric_smp_call_function_interrupt();\n\treturn IRQ_HANDLED;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "generic_smp_call_function_interrupt",
          "args": [],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic irqreturn_t call_function_action(int irq, void *data)\n{\n\tgeneric_smp_call_function_interrupt();\n\treturn IRQ_HANDLED;\n}"
  },
  {
    "function_name": "smp_generic_kick_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "110-136",
    "snippet": "int smp_generic_kick_cpu(int nr)\n{\n\tBUG_ON(nr < 0 || nr >= NR_CPUS);\n\n\t/*\n\t * The processor is currently spinning, waiting for the\n\t * cpu_start field to become non-zero After we set cpu_start,\n\t * the processor will continue on to secondary_start\n\t */\n\tif (!paca[nr].cpu_start) {\n\t\tpaca[nr].cpu_start = 1;\n\t\tsmp_mb();\n\t\treturn 0;\n\t}\n\n#ifdef CONFIG_HOTPLUG_CPU\n\t/*\n\t * Ok it's not there, so it might be soft-unplugged, let's\n\t * try to bring it back\n\t */\n\tgeneric_set_cpu_up(nr);\n\tsmp_wmb();\n\tsmp_send_reschedule(nr);\n#endif /* CONFIG_HOTPLUG_CPU */\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_send_reschedule",
          "args": [
            "nr"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "smp_send_reschedule",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "277-281",
          "snippet": "void smp_send_reschedule(int cpu)\n{\n\tif (likely(smp_ops))\n\t\tdo_message_pass(cpu, PPC_MSG_RESCHEDULE);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nvoid smp_send_reschedule(int cpu)\n{\n\tif (likely(smp_ops))\n\t\tdo_message_pass(cpu, PPC_MSG_RESCHEDULE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_wmb",
          "args": [],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "generic_set_cpu_up",
          "args": [
            "nr"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "generic_set_cpu_up",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "447-450",
          "snippet": "void generic_set_cpu_up(unsigned int cpu)\n{\n\tper_cpu(cpu_state, cpu) = CPU_UP_PREPARE;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid generic_set_cpu_up(unsigned int cpu)\n{\n\tper_cpu(cpu_state, cpu) = CPU_UP_PREPARE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "nr < 0 || nr >= NR_CPUS"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint smp_generic_kick_cpu(int nr)\n{\n\tBUG_ON(nr < 0 || nr >= NR_CPUS);\n\n\t/*\n\t * The processor is currently spinning, waiting for the\n\t * cpu_start field to become non-zero After we set cpu_start,\n\t * the processor will continue on to secondary_start\n\t */\n\tif (!paca[nr].cpu_start) {\n\t\tpaca[nr].cpu_start = 1;\n\t\tsmp_mb();\n\t\treturn 0;\n\t}\n\n#ifdef CONFIG_HOTPLUG_CPU\n\t/*\n\t * Ok it's not there, so it might be soft-unplugged, let's\n\t * try to bring it back\n\t */\n\tgeneric_set_cpu_up(nr);\n\tsmp_wmb();\n\tsmp_send_reschedule(nr);\n#endif /* CONFIG_HOTPLUG_CPU */\n\n\treturn 0;\n}"
  },
  {
    "function_name": "smp_generic_cpu_bootable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
    "lines": "92-106",
    "snippet": "int smp_generic_cpu_bootable(unsigned int nr)\n{\n\t/* Special case - we inhibit secondary thread startup\n\t * during boot if the user requests it.\n\t */\n\tif (system_state == SYSTEM_BOOTING && cpu_has_feature(CPU_FTR_SMT)) {\n\t\tif (!smt_enabled_at_boot && cpu_thread_in_core(nr) != 0)\n\t\t\treturn 0;\n\t\tif (smt_enabled_at_boot\n\t\t    && cpu_thread_in_core(nr) >= smt_enabled_at_boot)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/page.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int smt_enabled_at_boot = 1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_thread_in_core",
          "args": [
            "nr"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_thread_in_core",
          "args": [
            "nr"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SMT"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint smt_enabled_at_boot = 1;\n\nint smp_generic_cpu_bootable(unsigned int nr)\n{\n\t/* Special case - we inhibit secondary thread startup\n\t * during boot if the user requests it.\n\t */\n\tif (system_state == SYSTEM_BOOTING && cpu_has_feature(CPU_FTR_SMT)) {\n\t\tif (!smt_enabled_at_boot && cpu_thread_in_core(nr) != 0)\n\t\t\treturn 0;\n\t\tif (smt_enabled_at_boot\n\t\t    && cpu_thread_in_core(nr) >= smt_enabled_at_boot)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
  }
]