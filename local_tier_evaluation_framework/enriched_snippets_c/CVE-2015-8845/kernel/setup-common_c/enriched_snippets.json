[
  {
    "function_name": "arch_setup_pdev_archdata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "747-752",
    "snippet": "void arch_setup_pdev_archdata(struct platform_device *pdev)\n{\n\tpdev->archdata.dma_mask = DMA_BIT_MASK(32);\n\tpdev->dev.dma_mask = &pdev->archdata.dma_mask;\n \tset_dma_ops(&pdev->dev, &dma_direct_ops);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_dma_ops",
          "args": [
            "&pdev->dev",
            "&dma_direct_ops"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DMA_BIT_MASK",
          "args": [
            "32"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid arch_setup_pdev_archdata(struct platform_device *pdev)\n{\n\tpdev->archdata.dma_mask = DMA_BIT_MASK(32);\n\tpdev->dev.dma_mask = &pdev->archdata.dma_mask;\n \tset_dma_ops(&pdev->dev, &dma_direct_ops);\n}"
  },
  {
    "function_name": "ppc_printk_progress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "742-745",
    "snippet": "void ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"%s\\n\"",
            "s"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}"
  },
  {
    "function_name": "powerpc_debugfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "733-738",
    "snippet": "static int powerpc_debugfs_init(void)\n{\n\tpowerpc_debugfs_root = debugfs_create_dir(\"powerpc\", NULL);\n\n\treturn powerpc_debugfs_root == NULL;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "\"powerpc\"",
            "NULL"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic int powerpc_debugfs_init(void)\n{\n\tpowerpc_debugfs_root = debugfs_create_dir(\"powerpc\", NULL);\n\n\treturn powerpc_debugfs_root == NULL;\n}"
  },
  {
    "function_name": "check_cache_coherency",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "703-724",
    "snippet": "static int __init check_cache_coherency(void)\n{\n\tstruct device_node *np;\n\tconst void *prop;\n\tint devtree_coherency;\n\n\tnp = of_find_node_by_path(\"/\");\n\tprop = of_get_property(np, \"coherency-off\", NULL);\n\tof_node_put(np);\n\n\tdevtree_coherency = prop ? 0 : 1;\n\n\tif (devtree_coherency != KERNEL_COHERENCY) {\n\t\tprintk(KERN_ERR\n\t\t\t\"kernel coherency:%s != device tree_coherency:%s\\n\",\n\t\t\tKERNEL_COHERENCY ? \"on\" : \"off\",\n\t\t\tdevtree_coherency ? \"on\" : \"off\");\n\t\tBUG();\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define KERNEL_COHERENCY\t1",
      "#define KERNEL_COHERENCY\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR\n\t\t\t\"kernel coherency:%s != device tree_coherency:%s\\n\"",
            "KERNEL_COHERENCY ? \"on\" : \"off\"",
            "devtree_coherency ? \"on\" : \"off\""
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "\"coherency-off\"",
            "NULL"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_path",
          "args": [
            "\"/\""
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\n#define KERNEL_COHERENCY\t1\n#define KERNEL_COHERENCY\t0\n\nstatic int __init check_cache_coherency(void)\n{\n\tstruct device_node *np;\n\tconst void *prop;\n\tint devtree_coherency;\n\n\tnp = of_find_node_by_path(\"/\");\n\tprop = of_get_property(np, \"coherency-off\", NULL);\n\tof_node_put(np);\n\n\tdevtree_coherency = prop ? 0 : 1;\n\n\tif (devtree_coherency != KERNEL_COHERENCY) {\n\t\tprintk(KERN_ERR\n\t\t\t\"kernel coherency:%s != device tree_coherency:%s\\n\",\n\t\t\tKERNEL_COHERENCY ? \"on\" : \"off\",\n\t\t\tdevtree_coherency ? \"on\" : \"off\");\n\t\tBUG();\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "setup_panic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "683-686",
    "snippet": "void __init setup_panic(void)\n{\n\tatomic_notifier_chain_register(&panic_notifier_list, &ppc_panic_block);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct notifier_block ppc_panic_block = {\n\t.notifier_call = ppc_panic_event,\n\t.priority = INT_MIN /* may not return; must be done last */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_notifier_chain_register",
          "args": [
            "&panic_notifier_list",
            "&ppc_panic_block"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic struct notifier_block ppc_panic_block = {\n\t.notifier_call = ppc_panic_event,\n\t.priority = INT_MIN /* may not return; must be done last */\n};\n\nvoid __init setup_panic(void)\n{\n\tatomic_notifier_chain_register(&panic_notifier_list, &ppc_panic_block);\n}"
  },
  {
    "function_name": "ppc_panic_event",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "666-676",
    "snippet": "static int ppc_panic_event(struct notifier_block *this,\n                             unsigned long event, void *ptr)\n{\n\t/*\n\t * If firmware-assisted dump has been registered then trigger\n\t * firmware-assisted dump and let firmware handle everything else.\n\t */\n\tcrash_fadump(NULL, ptr);\n\tppc_md.panic(ptr);  /* May not return */\n\treturn NOTIFY_DONE;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.panic",
          "args": [
            "ptr"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crash_fadump",
          "args": [
            "NULL",
            "ptr"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "crash_fadump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/fadump.c",
          "lines": "401-422",
          "snippet": "void crash_fadump(struct pt_regs *regs, const char *str)\n{\n\tstruct fadump_crash_info_header *fdh = NULL;\n\n\tif (!fw_dump.dump_registered || !fw_dump.fadumphdr_addr)\n\t\treturn;\n\n\tfdh = __va(fw_dump.fadumphdr_addr);\n\tcrashing_cpu = smp_processor_id();\n\tfdh->crashing_cpu = crashing_cpu;\n\tcrash_save_vmcoreinfo();\n\n\tif (regs)\n\t\tfdh->regs = *regs;\n\telse\n\t\tppc_save_regs(&fdh->regs);\n\n\tfdh->cpu_online_mask = *cpu_online_mask;\n\n\t/* Call ibm,os-term rtas call to trigger firmware assisted dump */\n\trtas_os_term((char *)str);\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/debug.h>",
            "#include <asm/fadump.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/crash_dump.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/delay.h>",
            "#include <linux/memblock.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct fw_dump fw_dump;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/debug.h>\n#include <asm/fadump.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/crash_dump.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/delay.h>\n#include <linux/memblock.h>\n#include <linux/string.h>\n\nstatic struct fw_dump fw_dump;\n\nvoid crash_fadump(struct pt_regs *regs, const char *str)\n{\n\tstruct fadump_crash_info_header *fdh = NULL;\n\n\tif (!fw_dump.dump_registered || !fw_dump.fadumphdr_addr)\n\t\treturn;\n\n\tfdh = __va(fw_dump.fadumphdr_addr);\n\tcrashing_cpu = smp_processor_id();\n\tfdh->crashing_cpu = crashing_cpu;\n\tcrash_save_vmcoreinfo();\n\n\tif (regs)\n\t\tfdh->regs = *regs;\n\telse\n\t\tppc_save_regs(&fdh->regs);\n\n\tfdh->cpu_online_mask = *cpu_online_mask;\n\n\t/* Call ibm,os-term rtas call to trigger firmware assisted dump */\n\trtas_os_term((char *)str);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nstatic int ppc_panic_event(struct notifier_block *this,\n                             unsigned long event, void *ptr)\n{\n\t/*\n\t * If firmware-assisted dump has been registered then trigger\n\t * firmware-assisted dump and let firmware handle everything else.\n\t */\n\tcrash_fadump(NULL, ptr);\n\tppc_md.panic(ptr);  /* May not return */\n\treturn NOTIFY_DONE;\n}"
  },
  {
    "function_name": "check_legacy_ioport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "612-663",
    "snippet": "int check_legacy_ioport(unsigned long base_port)\n{\n\tstruct device_node *parent, *np = NULL;\n\tint ret = -ENODEV;\n\n\tswitch(base_port) {\n\tcase I8042_DATA_REG:\n\t\tif (!(np = of_find_compatible_node(NULL, NULL, \"pnpPNP,303\")))\n\t\t\tnp = of_find_compatible_node(NULL, NULL, \"pnpPNP,f03\");\n\t\tif (np) {\n\t\t\tparent = of_get_parent(np);\n\n\t\t\tof_i8042_kbd_irq = irq_of_parse_and_map(parent, 0);\n\t\t\tif (!of_i8042_kbd_irq)\n\t\t\t\tof_i8042_kbd_irq = 1;\n\n\t\t\tof_i8042_aux_irq = irq_of_parse_and_map(parent, 1);\n\t\t\tif (!of_i8042_aux_irq)\n\t\t\t\tof_i8042_aux_irq = 12;\n\n\t\t\tof_node_put(np);\n\t\t\tnp = parent;\n\t\t\tbreak;\n\t\t}\n\t\tnp = of_find_node_by_type(NULL, \"8042\");\n\t\t/* Pegasos has no device_type on its 8042 node, look for the\n\t\t * name instead */\n\t\tif (!np)\n\t\t\tnp = of_find_node_by_name(NULL, \"8042\");\n\t\tif (np) {\n\t\t\tof_i8042_kbd_irq = 1;\n\t\t\tof_i8042_aux_irq = 12;\n\t\t}\n\t\tbreak;\n\tcase FDC_BASE: /* FDC1 */\n\t\tnp = of_find_node_by_type(NULL, \"fdc\");\n\t\tbreak;\n\tdefault:\n\t\t/* ipmi is supposed to fail here */\n\t\tbreak;\n\t}\n\tif (!np)\n\t\treturn ret;\n\tparent = of_get_parent(np);\n\tif (parent) {\n\t\tif (strcmp(parent->type, \"isa\") == 0)\n\t\t\tret = 0;\n\t\tof_node_put(parent);\n\t}\n\tof_node_put(np);\n\treturn ret;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int of_i8042_kbd_irq;",
      "int of_i8042_aux_irq;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "parent"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "parent->type",
            "\"isa\""
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_parent",
          "args": [
            "np"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_type",
          "args": [
            "NULL",
            "\"fdc\""
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_name",
          "args": [
            "NULL",
            "\"8042\""
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_type",
          "args": [
            "NULL",
            "\"8042\""
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_of_parse_and_map",
          "args": [
            "parent",
            "1"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_of_parse_and_map",
          "args": [
            "parent",
            "0"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_parent",
          "args": [
            "np"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_compatible_node",
          "args": [
            "NULL",
            "NULL",
            "\"pnpPNP,f03\""
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_compatible_node",
          "args": [
            "NULL",
            "NULL",
            "\"pnpPNP,303\""
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nint of_i8042_kbd_irq;\nint of_i8042_aux_irq;\n\nint check_legacy_ioport(unsigned long base_port)\n{\n\tstruct device_node *parent, *np = NULL;\n\tint ret = -ENODEV;\n\n\tswitch(base_port) {\n\tcase I8042_DATA_REG:\n\t\tif (!(np = of_find_compatible_node(NULL, NULL, \"pnpPNP,303\")))\n\t\t\tnp = of_find_compatible_node(NULL, NULL, \"pnpPNP,f03\");\n\t\tif (np) {\n\t\t\tparent = of_get_parent(np);\n\n\t\t\tof_i8042_kbd_irq = irq_of_parse_and_map(parent, 0);\n\t\t\tif (!of_i8042_kbd_irq)\n\t\t\t\tof_i8042_kbd_irq = 1;\n\n\t\t\tof_i8042_aux_irq = irq_of_parse_and_map(parent, 1);\n\t\t\tif (!of_i8042_aux_irq)\n\t\t\t\tof_i8042_aux_irq = 12;\n\n\t\t\tof_node_put(np);\n\t\t\tnp = parent;\n\t\t\tbreak;\n\t\t}\n\t\tnp = of_find_node_by_type(NULL, \"8042\");\n\t\t/* Pegasos has no device_type on its 8042 node, look for the\n\t\t * name instead */\n\t\tif (!np)\n\t\t\tnp = of_find_node_by_name(NULL, \"8042\");\n\t\tif (np) {\n\t\t\tof_i8042_kbd_irq = 1;\n\t\t\tof_i8042_aux_irq = 12;\n\t\t}\n\t\tbreak;\n\tcase FDC_BASE: /* FDC1 */\n\t\tnp = of_find_node_by_type(NULL, \"fdc\");\n\t\tbreak;\n\tdefault:\n\t\t/* ipmi is supposed to fail here */\n\t\tbreak;\n\t}\n\tif (!np)\n\t\treturn ret;\n\tparent = of_get_parent(np);\n\tif (parent) {\n\t\tif (strcmp(parent->type, \"isa\") == 0)\n\t\t\tret = 0;\n\t\tof_node_put(parent);\n\t}\n\tof_node_put(np);\n\treturn ret;\n}"
  },
  {
    "function_name": "probe_machine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "580-609",
    "snippet": "void probe_machine(void)\n{\n\textern struct machdep_calls __machine_desc_start;\n\textern struct machdep_calls __machine_desc_end;\n\n\t/*\n\t * Iterate all ppc_md structures until we find the proper\n\t * one for the current machine type\n\t */\n\tDBG(\"Probing machine type ...\\n\");\n\n\tfor (machine_id = &__machine_desc_start;\n\t     machine_id < &__machine_desc_end;\n\t     machine_id++) {\n\t\tDBG(\"  %s ...\", machine_id->name);\n\t\tmemcpy(&ppc_md, machine_id, sizeof(struct machdep_calls));\n\t\tif (ppc_md.probe()) {\n\t\t\tDBG(\" match !\\n\");\n\t\t\tbreak;\n\t\t}\n\t\tDBG(\"\\n\");\n\t}\n\t/* What can we do if we didn't find ? */\n\tif (machine_id >= &__machine_desc_end) {\n\t\tDBG(\"No suitable machine found !\\n\");\n\t\tfor (;;);\n\t}\n\n\tprintk(KERN_INFO \"Using %s machine description\\n\", ppc_md.name);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;",
      "struct machdep_calls *machine_id;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"Using %s machine description\\n\"",
            "ppc_md.name"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "ppc_printk_progress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "742-745",
          "snippet": "void ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"No suitable machine found !\\n\""
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"\\n\""
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" match !\\n\""
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.probe",
          "args": [],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&ppc_md",
            "machine_id",
            "sizeof(struct machdep_calls)"
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "_memcpy_toio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/io.c",
          "lines": "185-209",
          "snippet": "void _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"  %s ...\"",
            "machine_id->name"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"Probing machine type ...\\n\""
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\nstruct machdep_calls *machine_id;\n\nvoid probe_machine(void)\n{\n\textern struct machdep_calls __machine_desc_start;\n\textern struct machdep_calls __machine_desc_end;\n\n\t/*\n\t * Iterate all ppc_md structures until we find the proper\n\t * one for the current machine type\n\t */\n\tDBG(\"Probing machine type ...\\n\");\n\n\tfor (machine_id = &__machine_desc_start;\n\t     machine_id < &__machine_desc_end;\n\t     machine_id++) {\n\t\tDBG(\"  %s ...\", machine_id->name);\n\t\tmemcpy(&ppc_md, machine_id, sizeof(struct machdep_calls));\n\t\tif (ppc_md.probe()) {\n\t\t\tDBG(\" match !\\n\");\n\t\t\tbreak;\n\t\t}\n\t\tDBG(\"\\n\");\n\t}\n\t/* What can we do if we didn't find ? */\n\tif (machine_id >= &__machine_desc_end) {\n\t\tDBG(\"No suitable machine found !\\n\");\n\t\tfor (;;);\n\t}\n\n\tprintk(KERN_INFO \"Using %s machine description\\n\", ppc_md.name);\n}"
  },
  {
    "function_name": "add_pcspkr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "556-576",
    "snippet": "static __init int add_pcspkr(void)\n{\n\tstruct device_node *np;\n\tstruct platform_device *pd;\n\tint ret;\n\n\tnp = of_find_compatible_node(NULL, NULL, \"pnpPNP,100\");\n\tof_node_put(np);\n\tif (!np)\n\t\treturn -ENODEV;\n\n\tpd = platform_device_alloc(\"pcspkr\", -1);\n\tif (!pd)\n\t\treturn -ENOMEM;\n\n\tret = platform_device_add(pd);\n\tif (ret)\n\t\tplatform_device_put(pd);\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "platform_device_put",
          "args": [
            "pd"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "platform_device_add",
          "args": [
            "pd"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "platform_device_alloc",
          "args": [
            "\"pcspkr\"",
            "-1"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_compatible_node",
          "args": [
            "NULL",
            "NULL",
            "\"pnpPNP,100\""
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic __init int add_pcspkr(void)\n{\n\tstruct device_node *np;\n\tstruct platform_device *pd;\n\tint ret;\n\n\tnp = of_find_compatible_node(NULL, NULL, \"pnpPNP,100\");\n\tof_node_put(np);\n\tif (!np)\n\t\treturn -ENODEV;\n\n\tpd = platform_device_alloc(\"pcspkr\", -1);\n\tif (!pd)\n\t\treturn -ENOMEM;\n\n\tret = platform_device_add(pd);\n\tif (ret)\n\t\tplatform_device_put(pd);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "smp_setup_cpu_maps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "442-552",
    "snippet": "void __init smp_setup_cpu_maps(void)\n{\n\tstruct device_node *dn = NULL;\n\tint cpu = 0;\n\tint nthreads = 1;\n\n\tDBG(\"smp_setup_cpu_maps()\\n\");\n\n\twhile ((dn = of_find_node_by_type(dn, \"cpu\")) && cpu < nr_cpu_ids) {\n\t\tconst __be32 *intserv;\n\t\t__be32 cpu_be;\n\t\tint j, len;\n\n\t\tDBG(\"  * %s...\\n\", dn->full_name);\n\n\t\tintserv = of_get_property(dn, \"ibm,ppc-interrupt-server#s\",\n\t\t\t\t&len);\n\t\tif (intserv) {\n\t\t\tDBG(\"    ibm,ppc-interrupt-server#s -> %d threads\\n\",\n\t\t\t    nthreads);\n\t\t} else {\n\t\t\tDBG(\"    no ibm,ppc-interrupt-server#s -> 1 thread\\n\");\n\t\t\tintserv = of_get_property(dn, \"reg\", &len);\n\t\t\tif (!intserv) {\n\t\t\t\tcpu_be = cpu_to_be32(cpu);\n\t\t\t\tintserv = &cpu_be;\t/* assume logical == phys */\n\t\t\t\tlen = 4;\n\t\t\t}\n\t\t}\n\n\t\tnthreads = len / sizeof(int);\n\n\t\tfor (j = 0; j < nthreads && cpu < nr_cpu_ids; j++) {\n\t\t\tbool avail;\n\n\t\t\tDBG(\"    thread %d -> cpu %d (hard id %d)\\n\",\n\t\t\t    j, cpu, be32_to_cpu(intserv[j]));\n\n\t\t\tavail = of_device_is_available(dn);\n\t\t\tif (!avail)\n\t\t\t\tavail = !of_property_match_string(dn,\n\t\t\t\t\t\t\"enable-method\", \"spin-table\");\n\n\t\t\tset_cpu_present(cpu, avail);\n\t\t\tset_hard_smp_processor_id(cpu, be32_to_cpu(intserv[j]));\n\t\t\tset_cpu_possible(cpu, true);\n\t\t\tcpu++;\n\t\t}\n\t}\n\n\t/* If no SMT supported, nthreads is forced to 1 */\n\tif (!cpu_has_feature(CPU_FTR_SMT)) {\n\t\tDBG(\"  SMT disabled ! nthreads forced to 1\\n\");\n\t\tnthreads = 1;\n\t}\n\n#ifdef CONFIG_PPC64\n\t/*\n\t * On pSeries LPAR, we need to know how many cpus\n\t * could possibly be added to this partition.\n\t */\n\tif (machine_is(pseries) && firmware_has_feature(FW_FEATURE_LPAR) &&\n\t    (dn = of_find_node_by_path(\"/rtas\"))) {\n\t\tint num_addr_cell, num_size_cell, maxcpus;\n\t\tconst __be32 *ireg;\n\n\t\tnum_addr_cell = of_n_addr_cells(dn);\n\t\tnum_size_cell = of_n_size_cells(dn);\n\n\t\tireg = of_get_property(dn, \"ibm,lrdr-capacity\", NULL);\n\n\t\tif (!ireg)\n\t\t\tgoto out;\n\n\t\tmaxcpus = be32_to_cpup(ireg + num_addr_cell + num_size_cell);\n\n\t\t/* Double maxcpus for processors which have SMT capability */\n\t\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\t\tmaxcpus *= nthreads;\n\n\t\tif (maxcpus > nr_cpu_ids) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"Partition configured for %d cpus, \"\n\t\t\t       \"operating system maximum is %d.\\n\",\n\t\t\t       maxcpus, nr_cpu_ids);\n\t\t\tmaxcpus = nr_cpu_ids;\n\t\t} else\n\t\t\tprintk(KERN_INFO \"Partition configured for %d cpus.\\n\",\n\t\t\t       maxcpus);\n\n\t\tfor (cpu = 0; cpu < maxcpus; cpu++)\n\t\t\tset_cpu_possible(cpu, true);\n\tout:\n\t\tof_node_put(dn);\n\t}\n\tvdso_data->processorCount = num_present_cpus();\n#endif /* CONFIG_PPC64 */\n\n        /* Initialize CPU <=> thread mapping/\n\t *\n\t * WARNING: We assume that the number of threads is the same for\n\t * every CPU in the system. If that is not the case, then some code\n\t * here will have to be reworked\n\t */\n\tcpu_init_thread_core_maps(nthreads);\n\n\t/* Now that possible cpus are set, set nr_cpu_ids for later use */\n\tsetup_nr_cpu_ids();\n\n\tfree_unused_pacas();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_unused_pacas",
          "args": [],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "free_unused_pacas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/paca.c",
          "lines": "238-255",
          "snippet": "void __init free_unused_pacas(void)\n{\n\tint new_size;\n\n\tnew_size = PAGE_ALIGN(sizeof(struct paca_struct) * nr_cpu_ids);\n\n\tif (new_size >= paca_size)\n\t\treturn;\n\n\tmemblock_free(__pa(paca) + new_size, paca_size - new_size);\n\n\tprintk(KERN_DEBUG \"Freed %u bytes for unused pacas\\n\",\n\t\tpaca_size - new_size);\n\n\tpaca_size = new_size;\n\n\tfree_lppacas();\n}",
          "includes": [
            "#include <asm/kexec.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/sections.h>",
            "#include <asm/paca.h>",
            "#include <asm/lppaca.h>",
            "#include <linux/memblock.h>",
            "#include <linux/export.h>",
            "#include <linux/smp.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct paca_struct *paca;",
            "static int __initdata paca_size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/kexec.h>\n#include <asm/pgtable.h>\n#include <asm/sections.h>\n#include <asm/paca.h>\n#include <asm/lppaca.h>\n#include <linux/memblock.h>\n#include <linux/export.h>\n#include <linux/smp.h>\n\nstruct paca_struct *paca;\nstatic int __initdata paca_size;\n\nvoid __init free_unused_pacas(void)\n{\n\tint new_size;\n\n\tnew_size = PAGE_ALIGN(sizeof(struct paca_struct) * nr_cpu_ids);\n\n\tif (new_size >= paca_size)\n\t\treturn;\n\n\tmemblock_free(__pa(paca) + new_size, paca_size - new_size);\n\n\tprintk(KERN_DEBUG \"Freed %u bytes for unused pacas\\n\",\n\t\tpaca_size - new_size);\n\n\tpaca_size = new_size;\n\n\tfree_lppacas();\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup_nr_cpu_ids",
          "args": [],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_init_thread_core_maps",
          "args": [
            "nthreads"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_init_thread_core_maps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "401-421",
          "snippet": "static void __init cpu_init_thread_core_maps(int tpc)\n{\n\tint i;\n\n\tthreads_per_core = tpc;\n\tthreads_per_subcore = tpc;\n\tcpumask_clear(&threads_core_mask);\n\n\t/* This implementation only supports power of 2 number of threads\n\t * for simplicity and performance\n\t */\n\tthreads_shift = ilog2(tpc);\n\tBUG_ON(tpc != (1 << threads_shift));\n\n\tfor (i = 0; i < tpc; i++)\n\t\tcpumask_set_cpu(i, &threads_core_mask);\n\n\tprintk(KERN_INFO \"CPU maps initialized for %d thread%s per core\\n\",\n\t       tpc, tpc > 1 ? \"s\" : \"\");\n\tprintk(KERN_DEBUG \" (thread shift is %d)\\n\", threads_shift);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void __init cpu_init_thread_core_maps(int tpc)\n{\n\tint i;\n\n\tthreads_per_core = tpc;\n\tthreads_per_subcore = tpc;\n\tcpumask_clear(&threads_core_mask);\n\n\t/* This implementation only supports power of 2 number of threads\n\t * for simplicity and performance\n\t */\n\tthreads_shift = ilog2(tpc);\n\tBUG_ON(tpc != (1 << threads_shift));\n\n\tfor (i = 0; i < tpc; i++)\n\t\tcpumask_set_cpu(i, &threads_core_mask);\n\n\tprintk(KERN_INFO \"CPU maps initialized for %d thread%s per core\\n\",\n\t       tpc, tpc > 1 ? \"s\" : \"\");\n\tprintk(KERN_DEBUG \" (thread shift is %d)\\n\", threads_shift);\n}"
        }
      },
      {
        "call_info": {
          "callee": "num_present_cpus",
          "args": [],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "dn"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_possible",
          "args": [
            "cpu",
            "true"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"Partition configured for %d cpus.\\n\"",
            "maxcpus"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "ppc_printk_progress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "742-745",
          "snippet": "void ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING\n\t\t\t       \"Partition configured for %d cpus, \"\n\t\t\t       \"operating system maximum is %d.\\n\"",
            "maxcpus",
            "nr_cpu_ids"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SMT"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "ireg + num_addr_cell + num_size_cell"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "dn",
            "\"ibm,lrdr-capacity\"",
            "NULL"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_n_size_cells",
          "args": [
            "dn"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_n_addr_cells",
          "args": [
            "dn"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_path",
          "args": [
            "\"/rtas\""
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "machine_is",
          "args": [
            "pseries"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"  SMT disabled ! nthreads forced to 1\\n\""
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SMT"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_possible",
          "args": [
            "cpu",
            "true"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_hard_smp_processor_id",
          "args": [
            "cpu",
            "be32_to_cpu(intserv[j])"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "intserv[j]"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_present",
          "args": [
            "cpu",
            "avail"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_property_match_string",
          "args": [
            "dn",
            "\"enable-method\"",
            "\"spin-table\""
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_device_is_available",
          "args": [
            "dn"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"    thread %d -> cpu %d (hard id %d)\\n\"",
            "j",
            "cpu",
            "be32_to_cpu(intserv[j])"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "intserv[j]"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "cpu"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "dn",
            "\"reg\"",
            "&len"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"    no ibm,ppc-interrupt-server#s -> 1 thread\\n\""
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"    ibm,ppc-interrupt-server#s -> %d threads\\n\"",
            "nthreads"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "dn",
            "\"ibm,ppc-interrupt-server#s\"",
            "&len"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"  * %s...\\n\"",
            "dn->full_name"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_type",
          "args": [
            "dn",
            "\"cpu\""
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"smp_setup_cpu_maps()\\n\""
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init smp_setup_cpu_maps(void)\n{\n\tstruct device_node *dn = NULL;\n\tint cpu = 0;\n\tint nthreads = 1;\n\n\tDBG(\"smp_setup_cpu_maps()\\n\");\n\n\twhile ((dn = of_find_node_by_type(dn, \"cpu\")) && cpu < nr_cpu_ids) {\n\t\tconst __be32 *intserv;\n\t\t__be32 cpu_be;\n\t\tint j, len;\n\n\t\tDBG(\"  * %s...\\n\", dn->full_name);\n\n\t\tintserv = of_get_property(dn, \"ibm,ppc-interrupt-server#s\",\n\t\t\t\t&len);\n\t\tif (intserv) {\n\t\t\tDBG(\"    ibm,ppc-interrupt-server#s -> %d threads\\n\",\n\t\t\t    nthreads);\n\t\t} else {\n\t\t\tDBG(\"    no ibm,ppc-interrupt-server#s -> 1 thread\\n\");\n\t\t\tintserv = of_get_property(dn, \"reg\", &len);\n\t\t\tif (!intserv) {\n\t\t\t\tcpu_be = cpu_to_be32(cpu);\n\t\t\t\tintserv = &cpu_be;\t/* assume logical == phys */\n\t\t\t\tlen = 4;\n\t\t\t}\n\t\t}\n\n\t\tnthreads = len / sizeof(int);\n\n\t\tfor (j = 0; j < nthreads && cpu < nr_cpu_ids; j++) {\n\t\t\tbool avail;\n\n\t\t\tDBG(\"    thread %d -> cpu %d (hard id %d)\\n\",\n\t\t\t    j, cpu, be32_to_cpu(intserv[j]));\n\n\t\t\tavail = of_device_is_available(dn);\n\t\t\tif (!avail)\n\t\t\t\tavail = !of_property_match_string(dn,\n\t\t\t\t\t\t\"enable-method\", \"spin-table\");\n\n\t\t\tset_cpu_present(cpu, avail);\n\t\t\tset_hard_smp_processor_id(cpu, be32_to_cpu(intserv[j]));\n\t\t\tset_cpu_possible(cpu, true);\n\t\t\tcpu++;\n\t\t}\n\t}\n\n\t/* If no SMT supported, nthreads is forced to 1 */\n\tif (!cpu_has_feature(CPU_FTR_SMT)) {\n\t\tDBG(\"  SMT disabled ! nthreads forced to 1\\n\");\n\t\tnthreads = 1;\n\t}\n\n#ifdef CONFIG_PPC64\n\t/*\n\t * On pSeries LPAR, we need to know how many cpus\n\t * could possibly be added to this partition.\n\t */\n\tif (machine_is(pseries) && firmware_has_feature(FW_FEATURE_LPAR) &&\n\t    (dn = of_find_node_by_path(\"/rtas\"))) {\n\t\tint num_addr_cell, num_size_cell, maxcpus;\n\t\tconst __be32 *ireg;\n\n\t\tnum_addr_cell = of_n_addr_cells(dn);\n\t\tnum_size_cell = of_n_size_cells(dn);\n\n\t\tireg = of_get_property(dn, \"ibm,lrdr-capacity\", NULL);\n\n\t\tif (!ireg)\n\t\t\tgoto out;\n\n\t\tmaxcpus = be32_to_cpup(ireg + num_addr_cell + num_size_cell);\n\n\t\t/* Double maxcpus for processors which have SMT capability */\n\t\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\t\tmaxcpus *= nthreads;\n\n\t\tif (maxcpus > nr_cpu_ids) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"Partition configured for %d cpus, \"\n\t\t\t       \"operating system maximum is %d.\\n\",\n\t\t\t       maxcpus, nr_cpu_ids);\n\t\t\tmaxcpus = nr_cpu_ids;\n\t\t} else\n\t\t\tprintk(KERN_INFO \"Partition configured for %d cpus.\\n\",\n\t\t\t       maxcpus);\n\n\t\tfor (cpu = 0; cpu < maxcpus; cpu++)\n\t\t\tset_cpu_possible(cpu, true);\n\tout:\n\t\tof_node_put(dn);\n\t}\n\tvdso_data->processorCount = num_present_cpus();\n#endif /* CONFIG_PPC64 */\n\n        /* Initialize CPU <=> thread mapping/\n\t *\n\t * WARNING: We assume that the number of threads is the same for\n\t * every CPU in the system. If that is not the case, then some code\n\t * here will have to be reworked\n\t */\n\tcpu_init_thread_core_maps(nthreads);\n\n\t/* Now that possible cpus are set, set nr_cpu_ids for later use */\n\tsetup_nr_cpu_ids();\n\n\tfree_unused_pacas();\n}"
  },
  {
    "function_name": "cpu_init_thread_core_maps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "401-421",
    "snippet": "static void __init cpu_init_thread_core_maps(int tpc)\n{\n\tint i;\n\n\tthreads_per_core = tpc;\n\tthreads_per_subcore = tpc;\n\tcpumask_clear(&threads_core_mask);\n\n\t/* This implementation only supports power of 2 number of threads\n\t * for simplicity and performance\n\t */\n\tthreads_shift = ilog2(tpc);\n\tBUG_ON(tpc != (1 << threads_shift));\n\n\tfor (i = 0; i < tpc; i++)\n\t\tcpumask_set_cpu(i, &threads_core_mask);\n\n\tprintk(KERN_INFO \"CPU maps initialized for %d thread%s per core\\n\",\n\t       tpc, tpc > 1 ? \"s\" : \"\");\n\tprintk(KERN_DEBUG \" (thread shift is %d)\\n\", threads_shift);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_DEBUG \" (thread shift is %d)\\n\"",
            "threads_shift"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "ppc_printk_progress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "742-745",
          "snippet": "void ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid ppc_printk_progress(char *s, unsigned short hex)\n{\n\tpr_info(\"%s\\n\", s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"CPU maps initialized for %d thread%s per core\\n\"",
            "tpc",
            "tpc > 1 ? \"s\" : \"\""
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "i",
            "&threads_core_mask"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "tpc != (1 << threads_shift)"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ilog2",
          "args": [
            "tpc"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear",
          "args": [
            "&threads_core_mask"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void __init cpu_init_thread_core_maps(int tpc)\n{\n\tint i;\n\n\tthreads_per_core = tpc;\n\tthreads_per_subcore = tpc;\n\tcpumask_clear(&threads_core_mask);\n\n\t/* This implementation only supports power of 2 number of threads\n\t * for simplicity and performance\n\t */\n\tthreads_shift = ilog2(tpc);\n\tBUG_ON(tpc != (1 << threads_shift));\n\n\tfor (i = 0; i < tpc; i++)\n\t\tcpumask_set_cpu(i, &threads_core_mask);\n\n\tprintk(KERN_INFO \"CPU maps initialized for %d thread%s per core\\n\",\n\t       tpc, tpc > 1 ? \"s\" : \"\");\n\tprintk(KERN_DEBUG \" (thread shift is %d)\\n\", threads_shift);\n}"
  },
  {
    "function_name": "check_for_initrd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "370-390",
    "snippet": "void __init check_for_initrd(void)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tDBG(\" -> check_for_initrd()  initrd_start=0x%lx  initrd_end=0x%lx\\n\",\n\t    initrd_start, initrd_end);\n\n\t/* If we were passed an initrd, set the ROOT_DEV properly if the values\n\t * look sensible. If not, clear initrd reference.\n\t */\n\tif (is_kernel_addr(initrd_start) && is_kernel_addr(initrd_end) &&\n\t    initrd_end > initrd_start)\n\t\tROOT_DEV = Root_RAM0;\n\telse\n\t\tinitrd_start = initrd_end = 0;\n\n\tif (initrd_start)\n\t\tpr_info(\"Found initrd at 0x%lx:0x%lx\\n\", initrd_start, initrd_end);\n\n\tDBG(\" <- check_for_initrd()\\n\");\n#endif /* CONFIG_BLK_DEV_INITRD */\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" <- check_for_initrd()\\n\""
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Found initrd at 0x%lx:0x%lx\\n\"",
            "initrd_start",
            "initrd_end"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_kernel_addr",
          "args": [
            "initrd_end"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_kernel_addr",
          "args": [
            "initrd_start"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" -> check_for_initrd()  initrd_start=0x%lx  initrd_end=0x%lx\\n\"",
            "initrd_start",
            "initrd_end"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init check_for_initrd(void)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tDBG(\" -> check_for_initrd()  initrd_start=0x%lx  initrd_end=0x%lx\\n\",\n\t    initrd_start, initrd_end);\n\n\t/* If we were passed an initrd, set the ROOT_DEV properly if the values\n\t * look sensible. If not, clear initrd reference.\n\t */\n\tif (is_kernel_addr(initrd_start) && is_kernel_addr(initrd_end) &&\n\t    initrd_end > initrd_start)\n\t\tROOT_DEV = Root_RAM0;\n\telse\n\t\tinitrd_start = initrd_end = 0;\n\n\tif (initrd_start)\n\t\tpr_info(\"Found initrd at 0x%lx:0x%lx\\n\", initrd_start, initrd_end);\n\n\tDBG(\" <- check_for_initrd()\\n\");\n#endif /* CONFIG_BLK_DEV_INITRD */\n}"
  },
  {
    "function_name": "c_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "359-361",
    "snippet": "static void c_stop(struct seq_file *m, void *v)\n{\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void c_stop(struct seq_file *m, void *v)\n{\n}"
  },
  {
    "function_name": "c_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "353-357",
    "snippet": "static void *c_next(struct seq_file *m, void *v, loff_t *pos)\n{\n\t(*pos)++;\n\treturn c_start(m, pos);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "c_start",
          "args": [
            "m",
            "pos"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "c_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "342-351",
          "snippet": "static void *c_start(struct seq_file *m, loff_t *pos)\n{\n\tif (*pos == 0)\t/* just in case, cpu 0 is not the first */\n\t\t*pos = cpumask_first(cpu_online_mask);\n\telse\n\t\t*pos = cpumask_next(*pos - 1, cpu_online_mask);\n\tif ((*pos) < nr_cpu_ids)\n\t\treturn (void *)(unsigned long)(*pos + 1);\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void *c_start(struct seq_file *m, loff_t *pos)\n{\n\tif (*pos == 0)\t/* just in case, cpu 0 is not the first */\n\t\t*pos = cpumask_first(cpu_online_mask);\n\telse\n\t\t*pos = cpumask_next(*pos - 1, cpu_online_mask);\n\tif ((*pos) < nr_cpu_ids)\n\t\treturn (void *)(unsigned long)(*pos + 1);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void *c_next(struct seq_file *m, void *v, loff_t *pos)\n{\n\t(*pos)++;\n\treturn c_start(m, pos);\n}"
  },
  {
    "function_name": "c_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "342-351",
    "snippet": "static void *c_start(struct seq_file *m, loff_t *pos)\n{\n\tif (*pos == 0)\t/* just in case, cpu 0 is not the first */\n\t\t*pos = cpumask_first(cpu_online_mask);\n\telse\n\t\t*pos = cpumask_next(*pos - 1, cpu_online_mask);\n\tif ((*pos) < nr_cpu_ids)\n\t\treturn (void *)(unsigned long)(*pos + 1);\n\treturn NULL;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_next",
          "args": [
            "*pos - 1",
            "cpu_online_mask"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_first",
          "args": [
            "cpu_online_mask"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void *c_start(struct seq_file *m, loff_t *pos)\n{\n\tif (*pos == 0)\t/* just in case, cpu 0 is not the first */\n\t\t*pos = cpumask_first(cpu_online_mask);\n\telse\n\t\t*pos = cpumask_next(*pos - 1, cpu_online_mask);\n\tif ((*pos) < nr_cpu_ids)\n\t\treturn (void *)(unsigned long)(*pos + 1);\n\treturn NULL;\n}"
  },
  {
    "function_name": "show_cpuinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "212-340",
    "snippet": "static int show_cpuinfo(struct seq_file *m, void *v)\n{\n\tunsigned long cpu_id = (unsigned long)v - 1;\n\tunsigned int pvr;\n\tunsigned long proc_freq;\n\tunsigned short maj;\n\tunsigned short min;\n\n\t/* We only show online cpus: disable preempt (overzealous, I\n\t * knew) to prevent cpu going down. */\n\tpreempt_disable();\n\tif (!cpu_online(cpu_id)) {\n\t\tpreempt_enable();\n\t\treturn 0;\n\t}\n\n#ifdef CONFIG_SMP\n\tpvr = per_cpu(cpu_pvr, cpu_id);\n#else\n\tpvr = mfspr(SPRN_PVR);\n#endif\n\tmaj = (pvr >> 8) & 0xFF;\n\tmin = pvr & 0xFF;\n\n\tseq_printf(m, \"processor\\t: %lu\\n\", cpu_id);\n\tseq_printf(m, \"cpu\\t\\t: \");\n\n\tif (cur_cpu_spec->pvr_mask)\n\t\tseq_printf(m, \"%s\", cur_cpu_spec->cpu_name);\n\telse\n\t\tseq_printf(m, \"unknown (%08x)\", pvr);\n\n#ifdef CONFIG_ALTIVEC\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC))\n\t\tseq_printf(m, \", altivec supported\");\n#endif /* CONFIG_ALTIVEC */\n\n\tseq_printf(m, \"\\n\");\n\n#ifdef CONFIG_TAU\n\tif (cur_cpu_spec->cpu_features & CPU_FTR_TAU) {\n#ifdef CONFIG_TAU_AVERAGE\n\t\t/* more straightforward, but potentially misleading */\n\t\tseq_printf(m,  \"temperature \\t: %u C (uncalibrated)\\n\",\n\t\t\t   cpu_temp(cpu_id));\n#else\n\t\t/* show the actual temp sensor range */\n\t\tu32 temp;\n\t\ttemp = cpu_temp_both(cpu_id);\n\t\tseq_printf(m, \"temperature \\t: %u-%u C (uncalibrated)\\n\",\n\t\t\t   temp & 0xff, temp >> 16);\n#endif\n\t}\n#endif /* CONFIG_TAU */\n\n\t/*\n\t * Platforms that have variable clock rates, should implement\n\t * the method ppc_md.get_proc_freq() that reports the clock\n\t * rate of a given cpu. The rest can use ppc_proc_freq to\n\t * report the clock rate that is same across all cpus.\n\t */\n\tif (ppc_md.get_proc_freq)\n\t\tproc_freq = ppc_md.get_proc_freq(cpu_id);\n\telse\n\t\tproc_freq = ppc_proc_freq;\n\n\tif (proc_freq)\n\t\tseq_printf(m, \"clock\\t\\t: %lu.%06luMHz\\n\",\n\t\t\t   proc_freq / 1000000, proc_freq % 1000000);\n\n\tif (ppc_md.show_percpuinfo != NULL)\n\t\tppc_md.show_percpuinfo(m, cpu_id);\n\n\t/* If we are a Freescale core do a simple check so\n\t * we dont have to keep adding cases in the future */\n\tif (PVR_VER(pvr) & 0x8000) {\n\t\tswitch (PVR_VER(pvr)) {\n\t\tcase 0x8000:\t/* 7441/7450/7451, Voyager */\n\t\tcase 0x8001:\t/* 7445/7455, Apollo 6 */\n\t\tcase 0x8002:\t/* 7447/7457, Apollo 7 */\n\t\tcase 0x8003:\t/* 7447A, Apollo 7 PM */\n\t\tcase 0x8004:\t/* 7448, Apollo 8 */\n\t\tcase 0x800c:\t/* 7410, Nitro */\n\t\t\tmaj = ((pvr >> 8) & 0xF);\n\t\t\tmin = PVR_MIN(pvr);\n\t\t\tbreak;\n\t\tdefault:\t/* e500/book-e */\n\t\t\tmaj = PVR_MAJ(pvr);\n\t\t\tmin = PVR_MIN(pvr);\n\t\t\tbreak;\n\t\t}\n\t} else {\n\t\tswitch (PVR_VER(pvr)) {\n\t\t\tcase 0x0020:\t/* 403 family */\n\t\t\t\tmaj = PVR_MAJ(pvr) + 1;\n\t\t\t\tmin = PVR_MIN(pvr);\n\t\t\t\tbreak;\n\t\t\tcase 0x1008:\t/* 740P/750P ?? */\n\t\t\t\tmaj = ((pvr >> 8) & 0xFF) - 1;\n\t\t\t\tmin = pvr & 0xFF;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tmaj = (pvr >> 8) & 0xFF;\n\t\t\t\tmin = pvr & 0xFF;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tseq_printf(m, \"revision\\t: %hd.%hd (pvr %04x %04x)\\n\",\n\t\t   maj, min, PVR_VER(pvr), PVR_REV(pvr));\n\n#ifdef CONFIG_PPC32\n\tseq_printf(m, \"bogomips\\t: %lu.%02lu\\n\",\n\t\t   loops_per_jiffy / (500000/HZ),\n\t\t   (loops_per_jiffy / (5000/HZ)) % 100);\n#endif\n\n#ifdef CONFIG_SMP\n\tseq_printf(m, \"\\n\");\n#endif\n\n\tpreempt_enable();\n\n\t/* If this is the last cpu, print the summary */\n\tif (cpumask_next(cpu_id, cpu_online_mask) >= nr_cpu_ids)\n\t\tshow_cpuinfo_summary(m);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "show_cpuinfo_summary",
          "args": [
            "m"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "show_cpuinfo_summary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "180-210",
          "snippet": "static void show_cpuinfo_summary(struct seq_file *m)\n{\n\tstruct device_node *root;\n\tconst char *model = NULL;\n#if defined(CONFIG_SMP) && defined(CONFIG_PPC32)\n\tunsigned long bogosum = 0;\n\tint i;\n\tfor_each_online_cpu(i)\n\t\tbogosum += loops_per_jiffy;\n\tseq_printf(m, \"total bogomips\\t: %lu.%02lu\\n\",\n\t\t   bogosum/(500000/HZ), bogosum/(5000/HZ) % 100);\n#endif /* CONFIG_SMP && CONFIG_PPC32 */\n\tseq_printf(m, \"timebase\\t: %lu\\n\", ppc_tb_freq);\n\tif (ppc_md.name)\n\t\tseq_printf(m, \"platform\\t: %s\\n\", ppc_md.name);\n\troot = of_find_node_by_path(\"/\");\n\tif (root)\n\t\tmodel = of_get_property(root, \"model\", NULL);\n\tif (model)\n\t\tseq_printf(m, \"model\\t\\t: %s\\n\", model);\n\tof_node_put(root);\n\n\tif (ppc_md.show_cpuinfo != NULL)\n\t\tppc_md.show_cpuinfo(m);\n\n#ifdef CONFIG_PPC32\n\t/* Display the amount of memory */\n\tseq_printf(m, \"Memory\\t\\t: %d MB\\n\",\n\t\t   (unsigned int)(total_memory / (1024 * 1024)));\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct machdep_calls ppc_md;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nstatic void show_cpuinfo_summary(struct seq_file *m)\n{\n\tstruct device_node *root;\n\tconst char *model = NULL;\n#if defined(CONFIG_SMP) && defined(CONFIG_PPC32)\n\tunsigned long bogosum = 0;\n\tint i;\n\tfor_each_online_cpu(i)\n\t\tbogosum += loops_per_jiffy;\n\tseq_printf(m, \"total bogomips\\t: %lu.%02lu\\n\",\n\t\t   bogosum/(500000/HZ), bogosum/(5000/HZ) % 100);\n#endif /* CONFIG_SMP && CONFIG_PPC32 */\n\tseq_printf(m, \"timebase\\t: %lu\\n\", ppc_tb_freq);\n\tif (ppc_md.name)\n\t\tseq_printf(m, \"platform\\t: %s\\n\", ppc_md.name);\n\troot = of_find_node_by_path(\"/\");\n\tif (root)\n\t\tmodel = of_get_property(root, \"model\", NULL);\n\tif (model)\n\t\tseq_printf(m, \"model\\t\\t: %s\\n\", model);\n\tof_node_put(root);\n\n\tif (ppc_md.show_cpuinfo != NULL)\n\t\tppc_md.show_cpuinfo(m);\n\n#ifdef CONFIG_PPC32\n\t/* Display the amount of memory */\n\tseq_printf(m, \"Memory\\t\\t: %d MB\\n\",\n\t\t   (unsigned int)(total_memory / (1024 * 1024)));\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_next",
          "args": [
            "cpu_id",
            "cpu_online_mask"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"\\n\""
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"bogomips\\t: %lu.%02lu\\n\"",
            "loops_per_jiffy / (500000/HZ)",
            "(loops_per_jiffy / (5000/HZ)) % 100"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"revision\\t: %hd.%hd (pvr %04x %04x)\\n\"",
            "maj",
            "min",
            "PVR_VER(pvr)",
            "PVR_REV(pvr)"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_REV",
          "args": [
            "pvr"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "pvr"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_MIN",
          "args": [
            "pvr"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_MAJ",
          "args": [
            "pvr"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "pvr"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_MIN",
          "args": [
            "pvr"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_MAJ",
          "args": [
            "pvr"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_MIN",
          "args": [
            "pvr"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "pvr"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "pvr"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.show_percpuinfo",
          "args": [
            "m",
            "cpu_id"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"clock\\t\\t: %lu.%06luMHz\\n\"",
            "proc_freq / 1000000",
            "proc_freq % 1000000"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.get_proc_freq",
          "args": [
            "cpu_id"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"temperature \\t: %u-%u C (uncalibrated)\\n\"",
            "temp & 0xff",
            "temp >> 16"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_temp_both",
          "args": [
            "cpu_id"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_temp_both",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/tau_6xx.c",
          "lines": "257-260",
          "snippet": "u32 cpu_temp_both(unsigned long cpu)\n{\n\treturn ((tau[cpu].high << 16) | tau[cpu].low);\n}",
          "includes": [
            "#include <asm/machdep.h>",
            "#include <asm/8xx_immap.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/reg.h>",
            "#include <asm/io.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct tau_temp\n{\n\tint interrupts;\n\tunsigned char low;\n\tunsigned char high;\n\tunsigned char grew;\n} tau[NR_CPUS];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/machdep.h>\n#include <asm/8xx_immap.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/reg.h>\n#include <asm/io.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/jiffies.h>\n#include <linux/errno.h>\n\nstatic struct tau_temp\n{\n\tint interrupts;\n\tunsigned char low;\n\tunsigned char high;\n\tunsigned char grew;\n} tau[NR_CPUS];\n\nu32 cpu_temp_both(unsigned long cpu)\n{\n\treturn ((tau[cpu].high << 16) | tau[cpu].low);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"temperature \\t: %u C (uncalibrated)\\n\"",
            "cpu_temp(cpu_id)"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_temp",
          "args": [
            "cpu_id"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_temp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/tau_6xx.c",
          "lines": "262-265",
          "snippet": "int cpu_temp(unsigned long cpu)\n{\n\treturn ((tau[cpu].high + tau[cpu].low) / 2);\n}",
          "includes": [
            "#include <asm/machdep.h>",
            "#include <asm/8xx_immap.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/reg.h>",
            "#include <asm/io.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct tau_temp\n{\n\tint interrupts;\n\tunsigned char low;\n\tunsigned char high;\n\tunsigned char grew;\n} tau[NR_CPUS];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/machdep.h>\n#include <asm/8xx_immap.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/reg.h>\n#include <asm/io.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/jiffies.h>\n#include <linux/errno.h>\n\nstatic struct tau_temp\n{\n\tint interrupts;\n\tunsigned char low;\n\tunsigned char high;\n\tunsigned char grew;\n} tau[NR_CPUS];\n\nint cpu_temp(unsigned long cpu)\n{\n\treturn ((tau[cpu].high + tau[cpu].low) / 2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"\\n\""
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\", altivec supported\""
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ALTIVEC"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"unknown (%08x)\"",
            "pvr"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"%s\"",
            "cur_cpu_spec->cpu_name"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"cpu\\t\\t: \""
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"processor\\t: %lu\\n\"",
            "cpu_id"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PVR"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_pvr",
            "cpu_id"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "cpu_id"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_cpu_online",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "788-866",
          "snippet": "static void unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"cacheinfo.h\"",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [
            "#define HAS_PPC_PMC_G4\t\t1",
            "#define HAS_PPC_PMC_IBM\t\t1",
            "#define HAS_PPC_PMC_PA6T\t1",
            "#define HAS_PPC_PMC_IBM\t\t1"
          ],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cpu, cpu_devices);",
            "static DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_IBM\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\nstatic DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);\n\nstatic void unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nstatic int show_cpuinfo(struct seq_file *m, void *v)\n{\n\tunsigned long cpu_id = (unsigned long)v - 1;\n\tunsigned int pvr;\n\tunsigned long proc_freq;\n\tunsigned short maj;\n\tunsigned short min;\n\n\t/* We only show online cpus: disable preempt (overzealous, I\n\t * knew) to prevent cpu going down. */\n\tpreempt_disable();\n\tif (!cpu_online(cpu_id)) {\n\t\tpreempt_enable();\n\t\treturn 0;\n\t}\n\n#ifdef CONFIG_SMP\n\tpvr = per_cpu(cpu_pvr, cpu_id);\n#else\n\tpvr = mfspr(SPRN_PVR);\n#endif\n\tmaj = (pvr >> 8) & 0xFF;\n\tmin = pvr & 0xFF;\n\n\tseq_printf(m, \"processor\\t: %lu\\n\", cpu_id);\n\tseq_printf(m, \"cpu\\t\\t: \");\n\n\tif (cur_cpu_spec->pvr_mask)\n\t\tseq_printf(m, \"%s\", cur_cpu_spec->cpu_name);\n\telse\n\t\tseq_printf(m, \"unknown (%08x)\", pvr);\n\n#ifdef CONFIG_ALTIVEC\n\tif (cpu_has_feature(CPU_FTR_ALTIVEC))\n\t\tseq_printf(m, \", altivec supported\");\n#endif /* CONFIG_ALTIVEC */\n\n\tseq_printf(m, \"\\n\");\n\n#ifdef CONFIG_TAU\n\tif (cur_cpu_spec->cpu_features & CPU_FTR_TAU) {\n#ifdef CONFIG_TAU_AVERAGE\n\t\t/* more straightforward, but potentially misleading */\n\t\tseq_printf(m,  \"temperature \\t: %u C (uncalibrated)\\n\",\n\t\t\t   cpu_temp(cpu_id));\n#else\n\t\t/* show the actual temp sensor range */\n\t\tu32 temp;\n\t\ttemp = cpu_temp_both(cpu_id);\n\t\tseq_printf(m, \"temperature \\t: %u-%u C (uncalibrated)\\n\",\n\t\t\t   temp & 0xff, temp >> 16);\n#endif\n\t}\n#endif /* CONFIG_TAU */\n\n\t/*\n\t * Platforms that have variable clock rates, should implement\n\t * the method ppc_md.get_proc_freq() that reports the clock\n\t * rate of a given cpu. The rest can use ppc_proc_freq to\n\t * report the clock rate that is same across all cpus.\n\t */\n\tif (ppc_md.get_proc_freq)\n\t\tproc_freq = ppc_md.get_proc_freq(cpu_id);\n\telse\n\t\tproc_freq = ppc_proc_freq;\n\n\tif (proc_freq)\n\t\tseq_printf(m, \"clock\\t\\t: %lu.%06luMHz\\n\",\n\t\t\t   proc_freq / 1000000, proc_freq % 1000000);\n\n\tif (ppc_md.show_percpuinfo != NULL)\n\t\tppc_md.show_percpuinfo(m, cpu_id);\n\n\t/* If we are a Freescale core do a simple check so\n\t * we dont have to keep adding cases in the future */\n\tif (PVR_VER(pvr) & 0x8000) {\n\t\tswitch (PVR_VER(pvr)) {\n\t\tcase 0x8000:\t/* 7441/7450/7451, Voyager */\n\t\tcase 0x8001:\t/* 7445/7455, Apollo 6 */\n\t\tcase 0x8002:\t/* 7447/7457, Apollo 7 */\n\t\tcase 0x8003:\t/* 7447A, Apollo 7 PM */\n\t\tcase 0x8004:\t/* 7448, Apollo 8 */\n\t\tcase 0x800c:\t/* 7410, Nitro */\n\t\t\tmaj = ((pvr >> 8) & 0xF);\n\t\t\tmin = PVR_MIN(pvr);\n\t\t\tbreak;\n\t\tdefault:\t/* e500/book-e */\n\t\t\tmaj = PVR_MAJ(pvr);\n\t\t\tmin = PVR_MIN(pvr);\n\t\t\tbreak;\n\t\t}\n\t} else {\n\t\tswitch (PVR_VER(pvr)) {\n\t\t\tcase 0x0020:\t/* 403 family */\n\t\t\t\tmaj = PVR_MAJ(pvr) + 1;\n\t\t\t\tmin = PVR_MIN(pvr);\n\t\t\t\tbreak;\n\t\t\tcase 0x1008:\t/* 740P/750P ?? */\n\t\t\t\tmaj = ((pvr >> 8) & 0xFF) - 1;\n\t\t\t\tmin = pvr & 0xFF;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tmaj = (pvr >> 8) & 0xFF;\n\t\t\t\tmin = pvr & 0xFF;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tseq_printf(m, \"revision\\t: %hd.%hd (pvr %04x %04x)\\n\",\n\t\t   maj, min, PVR_VER(pvr), PVR_REV(pvr));\n\n#ifdef CONFIG_PPC32\n\tseq_printf(m, \"bogomips\\t: %lu.%02lu\\n\",\n\t\t   loops_per_jiffy / (500000/HZ),\n\t\t   (loops_per_jiffy / (5000/HZ)) % 100);\n#endif\n\n#ifdef CONFIG_SMP\n\tseq_printf(m, \"\\n\");\n#endif\n\n\tpreempt_enable();\n\n\t/* If this is the last cpu, print the summary */\n\tif (cpumask_next(cpu_id, cpu_online_mask) >= nr_cpu_ids)\n\t\tshow_cpuinfo_summary(m);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "show_cpuinfo_summary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "180-210",
    "snippet": "static void show_cpuinfo_summary(struct seq_file *m)\n{\n\tstruct device_node *root;\n\tconst char *model = NULL;\n#if defined(CONFIG_SMP) && defined(CONFIG_PPC32)\n\tunsigned long bogosum = 0;\n\tint i;\n\tfor_each_online_cpu(i)\n\t\tbogosum += loops_per_jiffy;\n\tseq_printf(m, \"total bogomips\\t: %lu.%02lu\\n\",\n\t\t   bogosum/(500000/HZ), bogosum/(5000/HZ) % 100);\n#endif /* CONFIG_SMP && CONFIG_PPC32 */\n\tseq_printf(m, \"timebase\\t: %lu\\n\", ppc_tb_freq);\n\tif (ppc_md.name)\n\t\tseq_printf(m, \"platform\\t: %s\\n\", ppc_md.name);\n\troot = of_find_node_by_path(\"/\");\n\tif (root)\n\t\tmodel = of_get_property(root, \"model\", NULL);\n\tif (model)\n\t\tseq_printf(m, \"model\\t\\t: %s\\n\", model);\n\tof_node_put(root);\n\n\tif (ppc_md.show_cpuinfo != NULL)\n\t\tppc_md.show_cpuinfo(m);\n\n#ifdef CONFIG_PPC32\n\t/* Display the amount of memory */\n\tseq_printf(m, \"Memory\\t\\t: %d MB\\n\",\n\t\t   (unsigned int)(total_memory / (1024 * 1024)));\n#endif\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"Memory\\t\\t: %d MB\\n\"",
            "(unsigned int)(total_memory / (1024 * 1024))"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.show_cpuinfo",
          "args": [
            "m"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "root"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"model\\t\\t: %s\\n\"",
            "model"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "root",
            "\"model\"",
            "NULL"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_path",
          "args": [
            "\"/\""
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"platform\\t: %s\\n\"",
            "ppc_md.name"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"timebase\\t: %lu\\n\"",
            "ppc_tb_freq"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"total bogomips\\t: %lu.%02lu\\n\"",
            "bogosum/(500000/HZ)",
            "bogosum/(5000/HZ) % 100"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nstatic void show_cpuinfo_summary(struct seq_file *m)\n{\n\tstruct device_node *root;\n\tconst char *model = NULL;\n#if defined(CONFIG_SMP) && defined(CONFIG_PPC32)\n\tunsigned long bogosum = 0;\n\tint i;\n\tfor_each_online_cpu(i)\n\t\tbogosum += loops_per_jiffy;\n\tseq_printf(m, \"total bogomips\\t: %lu.%02lu\\n\",\n\t\t   bogosum/(500000/HZ), bogosum/(5000/HZ) % 100);\n#endif /* CONFIG_SMP && CONFIG_PPC32 */\n\tseq_printf(m, \"timebase\\t: %lu\\n\", ppc_tb_freq);\n\tif (ppc_md.name)\n\t\tseq_printf(m, \"platform\\t: %s\\n\", ppc_md.name);\n\troot = of_find_node_by_path(\"/\");\n\tif (root)\n\t\tmodel = of_get_property(root, \"model\", NULL);\n\tif (model)\n\t\tseq_printf(m, \"model\\t\\t: %s\\n\", model);\n\tof_node_put(root);\n\n\tif (ppc_md.show_cpuinfo != NULL)\n\t\tppc_md.show_cpuinfo(m);\n\n#ifdef CONFIG_PPC32\n\t/* Display the amount of memory */\n\tseq_printf(m, \"Memory\\t\\t: %d MB\\n\",\n\t\t   (unsigned int)(total_memory / (1024 * 1024)));\n#endif\n}"
  },
  {
    "function_name": "machine_halt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "157-168",
    "snippet": "void machine_halt(void)\n{\n\tmachine_shutdown();\n\tif (ppc_md.halt)\n\t\tppc_md.halt();\n#ifdef CONFIG_SMP\n\tsmp_send_stop();\n#endif\n\tprintk(KERN_EMERG \"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1) ;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_disable",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_EMERG \"System Halted, OK to turn off power\\n\""
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_send_stop",
          "args": [],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "smp_send_stop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "343-346",
          "snippet": "void smp_send_stop(void)\n{\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_send_stop(void)\n{\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppc_md.halt",
          "args": [],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "machine_shutdown",
          "args": [],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "machine_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "112-124",
          "snippet": "void machine_shutdown(void)\n{\n#ifdef CONFIG_FA_DUMP\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n#endif\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct machdep_calls ppc_md;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nvoid machine_shutdown(void)\n{\n#ifdef CONFIG_FA_DUMP\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n#endif\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nvoid machine_halt(void)\n{\n\tmachine_shutdown();\n\tif (ppc_md.halt)\n\t\tppc_md.halt();\n#ifdef CONFIG_SMP\n\tsmp_send_stop();\n#endif\n\tprintk(KERN_EMERG \"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1) ;\n}"
  },
  {
    "function_name": "machine_power_off",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "139-150",
    "snippet": "void machine_power_off(void)\n{\n\tmachine_shutdown();\n\tif (pm_power_off)\n\t\tpm_power_off();\n#ifdef CONFIG_SMP\n\tsmp_send_stop();\n#endif\n\tprintk(KERN_EMERG \"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1) ;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void (*pm_power_off)(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_disable",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_EMERG \"System Halted, OK to turn off power\\n\""
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_send_stop",
          "args": [],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "smp_send_stop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "343-346",
          "snippet": "void smp_send_stop(void)\n{\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_send_stop(void)\n{\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_power_off",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "machine_shutdown",
          "args": [],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "machine_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "112-124",
          "snippet": "void machine_shutdown(void)\n{\n#ifdef CONFIG_FA_DUMP\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n#endif\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct machdep_calls ppc_md;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nvoid machine_shutdown(void)\n{\n#ifdef CONFIG_FA_DUMP\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n#endif\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid (*pm_power_off)(void);\n\nvoid machine_power_off(void)\n{\n\tmachine_shutdown();\n\tif (pm_power_off)\n\t\tpm_power_off();\n#ifdef CONFIG_SMP\n\tsmp_send_stop();\n#endif\n\tprintk(KERN_EMERG \"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1) ;\n}"
  },
  {
    "function_name": "machine_restart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "126-137",
    "snippet": "void machine_restart(char *cmd)\n{\n\tmachine_shutdown();\n\tif (ppc_md.restart)\n\t\tppc_md.restart(cmd);\n#ifdef CONFIG_SMP\n\tsmp_send_stop();\n#endif\n\tprintk(KERN_EMERG \"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1) ;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_disable",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_EMERG \"System Halted, OK to turn off power\\n\""
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_send_stop",
          "args": [],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "smp_send_stop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "343-346",
          "snippet": "void smp_send_stop(void)\n{\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_send_stop(void)\n{\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppc_md.restart",
          "args": [
            "cmd"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "machine_shutdown",
          "args": [],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "machine_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "112-124",
          "snippet": "void machine_shutdown(void)\n{\n#ifdef CONFIG_FA_DUMP\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n#endif\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct machdep_calls ppc_md;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nvoid machine_shutdown(void)\n{\n#ifdef CONFIG_FA_DUMP\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n#endif\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nvoid machine_restart(char *cmd)\n{\n\tmachine_shutdown();\n\tif (ppc_md.restart)\n\t\tppc_md.restart(cmd);\n#ifdef CONFIG_SMP\n\tsmp_send_stop();\n#endif\n\tprintk(KERN_EMERG \"System Halted, OK to turn off power\\n\");\n\tlocal_irq_disable();\n\twhile (1) ;\n}"
  },
  {
    "function_name": "machine_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
    "lines": "112-124",
    "snippet": "void machine_shutdown(void)\n{\n#ifdef CONFIG_FA_DUMP\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n#endif\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/fadump.h>",
      "#include <mm/mmu_decl.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/xmon.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/firmware.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/paca.h>",
      "#include <asm/io.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/memblock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/screen_info.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct machdep_calls ppc_md;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.machine_shutdown",
          "args": [],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "machine_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "112-124",
          "snippet": "void machine_shutdown(void)\n{\n#ifdef CONFIG_FA_DUMP\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n#endif\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "fadump_cleanup",
          "args": [],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "fadump_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/fadump.c",
          "lines": "1021-1029",
          "snippet": "void fadump_cleanup(void)\n{\n\t/* Invalidate the registration only if dump is active. */\n\tif (fw_dump.dump_active) {\n\t\tinit_fadump_mem_struct(&fdm,\n\t\t\tbe64_to_cpu(fdm_active->cpu_state_data.destination_address));\n\t\tfadump_invalidate_dump(&fdm);\n\t}\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/debug.h>",
            "#include <asm/fadump.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/crash_dump.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/delay.h>",
            "#include <linux/memblock.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct fw_dump fw_dump;",
            "static struct fadump_mem_struct fdm;",
            "static const struct fadump_mem_struct *fdm_active;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/debug.h>\n#include <asm/fadump.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/crash_dump.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/delay.h>\n#include <linux/memblock.h>\n#include <linux/string.h>\n\nstatic struct fw_dump fw_dump;\nstatic struct fadump_mem_struct fdm;\nstatic const struct fadump_mem_struct *fdm_active;\n\nvoid fadump_cleanup(void)\n{\n\t/* Invalidate the registration only if dump is active. */\n\tif (fw_dump.dump_active) {\n\t\tinit_fadump_mem_struct(&fdm,\n\t\t\tbe64_to_cpu(fdm_active->cpu_state_data.destination_address));\n\t\tfadump_invalidate_dump(&fdm);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nvoid machine_shutdown(void)\n{\n#ifdef CONFIG_FA_DUMP\n\t/*\n\t * if fadump is active, cleanup the fadump registration before we\n\t * shutdown.\n\t */\n\tfadump_cleanup();\n#endif\n\n\tif (ppc_md.machine_shutdown)\n\t\tppc_md.machine_shutdown();\n}"
  }
]