[
  {
    "function_name": "module_finalize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/module.c",
    "lines": "46-79",
    "snippet": "int module_finalize(const Elf_Ehdr *hdr,\n\t\tconst Elf_Shdr *sechdrs, struct module *me)\n{\n\tconst Elf_Shdr *sect;\n\n\t/* Apply feature fixups */\n\tsect = find_section(hdr, sechdrs, \"__ftr_fixup\");\n\tif (sect != NULL)\n\t\tdo_feature_fixups(cur_cpu_spec->cpu_features,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n\n\tsect = find_section(hdr, sechdrs, \"__mmu_ftr_fixup\");\n\tif (sect != NULL)\n\t\tdo_feature_fixups(cur_cpu_spec->mmu_features,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n\n#ifdef CONFIG_PPC64\n\tsect = find_section(hdr, sechdrs, \"__fw_ftr_fixup\");\n\tif (sect != NULL)\n\t\tdo_feature_fixups(powerpc_firmware_features,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n#endif\n\n\tsect = find_section(hdr, sechdrs, \"__lwsync_fixup\");\n\tif (sect != NULL)\n\t\tdo_lwsync_fixups(cur_cpu_spec->cpu_features,\n\t\t\t\t (void *)sect->sh_addr,\n\t\t\t\t (void *)sect->sh_addr + sect->sh_size);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <linux/sort.h>",
      "#include <asm/firmware.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/module.h>",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/err.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/elf.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_lwsync_fixups",
          "args": [
            "cur_cpu_spec->cpu_features",
            "(void *)sect->sh_addr",
            "(void *)sect->sh_addr + sect->sh_size"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_section",
          "args": [
            "hdr",
            "sechdrs",
            "\"__lwsync_fixup\""
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "find_section",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/module.c",
          "lines": "32-44",
          "snippet": "static const Elf_Shdr *find_section(const Elf_Ehdr *hdr,\n\t\t\t\t    const Elf_Shdr *sechdrs,\n\t\t\t\t    const char *name)\n{\n\tchar *secstrings;\n\tunsigned int i;\n\n\tsecstrings = (char *)hdr + sechdrs[hdr->e_shstrndx].sh_offset;\n\tfor (i = 1; i < hdr->e_shnum; i++)\n\t\tif (strcmp(secstrings+sechdrs[i].sh_name, name) == 0)\n\t\t\treturn &sechdrs[i];\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <linux/sort.h>",
            "#include <asm/firmware.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/module.h>",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/err.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/elf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <linux/sort.h>\n#include <asm/firmware.h>\n#include <asm/uaccess.h>\n#include <asm/module.h>\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/err.h>\n#include <linux/moduleloader.h>\n#include <linux/elf.h>\n\nstatic const Elf_Shdr *find_section(const Elf_Ehdr *hdr,\n\t\t\t\t    const Elf_Shdr *sechdrs,\n\t\t\t\t    const char *name)\n{\n\tchar *secstrings;\n\tunsigned int i;\n\n\tsecstrings = (char *)hdr + sechdrs[hdr->e_shstrndx].sh_offset;\n\tfor (i = 1; i < hdr->e_shnum; i++)\n\t\tif (strcmp(secstrings+sechdrs[i].sh_name, name) == 0)\n\t\t\treturn &sechdrs[i];\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_feature_fixups",
          "args": [
            "powerpc_firmware_features",
            "(void *)sect->sh_addr",
            "(void *)sect->sh_addr + sect->sh_size"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_feature_fixups",
          "args": [
            "cur_cpu_spec->mmu_features",
            "(void *)sect->sh_addr",
            "(void *)sect->sh_addr + sect->sh_size"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_feature_fixups",
          "args": [
            "cur_cpu_spec->cpu_features",
            "(void *)sect->sh_addr",
            "(void *)sect->sh_addr + sect->sh_size"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <linux/sort.h>\n#include <asm/firmware.h>\n#include <asm/uaccess.h>\n#include <asm/module.h>\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/err.h>\n#include <linux/moduleloader.h>\n#include <linux/elf.h>\n\nint module_finalize(const Elf_Ehdr *hdr,\n\t\tconst Elf_Shdr *sechdrs, struct module *me)\n{\n\tconst Elf_Shdr *sect;\n\n\t/* Apply feature fixups */\n\tsect = find_section(hdr, sechdrs, \"__ftr_fixup\");\n\tif (sect != NULL)\n\t\tdo_feature_fixups(cur_cpu_spec->cpu_features,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n\n\tsect = find_section(hdr, sechdrs, \"__mmu_ftr_fixup\");\n\tif (sect != NULL)\n\t\tdo_feature_fixups(cur_cpu_spec->mmu_features,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n\n#ifdef CONFIG_PPC64\n\tsect = find_section(hdr, sechdrs, \"__fw_ftr_fixup\");\n\tif (sect != NULL)\n\t\tdo_feature_fixups(powerpc_firmware_features,\n\t\t\t\t  (void *)sect->sh_addr,\n\t\t\t\t  (void *)sect->sh_addr + sect->sh_size);\n#endif\n\n\tsect = find_section(hdr, sechdrs, \"__lwsync_fixup\");\n\tif (sect != NULL)\n\t\tdo_lwsync_fixups(cur_cpu_spec->cpu_features,\n\t\t\t\t (void *)sect->sh_addr,\n\t\t\t\t (void *)sect->sh_addr + sect->sh_size);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "find_section",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/module.c",
    "lines": "32-44",
    "snippet": "static const Elf_Shdr *find_section(const Elf_Ehdr *hdr,\n\t\t\t\t    const Elf_Shdr *sechdrs,\n\t\t\t\t    const char *name)\n{\n\tchar *secstrings;\n\tunsigned int i;\n\n\tsecstrings = (char *)hdr + sechdrs[hdr->e_shstrndx].sh_offset;\n\tfor (i = 1; i < hdr->e_shnum; i++)\n\t\tif (strcmp(secstrings+sechdrs[i].sh_name, name) == 0)\n\t\t\treturn &sechdrs[i];\n\treturn NULL;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <linux/sort.h>",
      "#include <asm/firmware.h>",
      "#include <asm/uaccess.h>",
      "#include <asm/module.h>",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/err.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/elf.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "secstrings+sechdrs[i].sh_name",
            "name"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <linux/sort.h>\n#include <asm/firmware.h>\n#include <asm/uaccess.h>\n#include <asm/module.h>\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/err.h>\n#include <linux/moduleloader.h>\n#include <linux/elf.h>\n\nstatic const Elf_Shdr *find_section(const Elf_Ehdr *hdr,\n\t\t\t\t    const Elf_Shdr *sechdrs,\n\t\t\t\t    const char *name)\n{\n\tchar *secstrings;\n\tunsigned int i;\n\n\tsecstrings = (char *)hdr + sechdrs[hdr->e_shstrndx].sh_offset;\n\tfor (i = 1; i < hdr->e_shnum; i++)\n\t\tif (strcmp(secstrings+sechdrs[i].sh_name, name) == 0)\n\t\t\treturn &sechdrs[i];\n\treturn NULL;\n}"
  }
]