[
  {
    "function_name": "audit_classes_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/audit.c",
    "lines": "61-81",
    "snippet": "static int __init audit_classes_init(void)\n{\n#ifdef CONFIG_PPC64\n\textern __u32 ppc32_dir_class[];\n\textern __u32 ppc32_write_class[];\n\textern __u32 ppc32_read_class[];\n\textern __u32 ppc32_chattr_class[];\n\textern __u32 ppc32_signal_class[];\n\taudit_register_class(AUDIT_CLASS_WRITE_32, ppc32_write_class);\n\taudit_register_class(AUDIT_CLASS_READ_32, ppc32_read_class);\n\taudit_register_class(AUDIT_CLASS_DIR_WRITE_32, ppc32_dir_class);\n\taudit_register_class(AUDIT_CLASS_CHATTR_32, ppc32_chattr_class);\n\taudit_register_class(AUDIT_CLASS_SIGNAL_32, ppc32_signal_class);\n#endif\n\taudit_register_class(AUDIT_CLASS_WRITE, write_class);\n\taudit_register_class(AUDIT_CLASS_READ, read_class);\n\taudit_register_class(AUDIT_CLASS_DIR_WRITE, dir_class);\n\taudit_register_class(AUDIT_CLASS_CHATTR, chattr_class);\n\taudit_register_class(AUDIT_CLASS_SIGNAL, signal_class);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/audit.h>",
      "#include <linux/types.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned dir_class[] = {\n#include <asm-generic/audit_dir_write.h>\n~0U\n};",
      "static unsigned read_class[] = {\n#include <asm-generic/audit_read.h>\n~0U\n};",
      "static unsigned write_class[] = {\n#include <asm-generic/audit_write.h>\n~0U\n};",
      "static unsigned chattr_class[] = {\n#include <asm-generic/audit_change_attr.h>\n~0U\n};",
      "static unsigned signal_class[] = {\n#include <asm-generic/audit_signal.h>\n~0U\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "audit_register_class",
          "args": [
            "AUDIT_CLASS_SIGNAL",
            "signal_class"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_register_class",
          "args": [
            "AUDIT_CLASS_CHATTR",
            "chattr_class"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_register_class",
          "args": [
            "AUDIT_CLASS_DIR_WRITE",
            "dir_class"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_register_class",
          "args": [
            "AUDIT_CLASS_READ",
            "read_class"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_register_class",
          "args": [
            "AUDIT_CLASS_WRITE",
            "write_class"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_register_class",
          "args": [
            "AUDIT_CLASS_SIGNAL_32",
            "ppc32_signal_class"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_register_class",
          "args": [
            "AUDIT_CLASS_CHATTR_32",
            "ppc32_chattr_class"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_register_class",
          "args": [
            "AUDIT_CLASS_DIR_WRITE_32",
            "ppc32_dir_class"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_register_class",
          "args": [
            "AUDIT_CLASS_READ_32",
            "ppc32_read_class"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_register_class",
          "args": [
            "AUDIT_CLASS_WRITE_32",
            "ppc32_write_class"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/audit.h>\n#include <linux/types.h>\n#include <linux/init.h>\n\nstatic unsigned dir_class[] = {\n#include <asm-generic/audit_dir_write.h>\n~0U\n};\nstatic unsigned read_class[] = {\n#include <asm-generic/audit_read.h>\n~0U\n};\nstatic unsigned write_class[] = {\n#include <asm-generic/audit_write.h>\n~0U\n};\nstatic unsigned chattr_class[] = {\n#include <asm-generic/audit_change_attr.h>\n~0U\n};\nstatic unsigned signal_class[] = {\n#include <asm-generic/audit_signal.h>\n~0U\n};\n\nstatic int __init audit_classes_init(void)\n{\n#ifdef CONFIG_PPC64\n\textern __u32 ppc32_dir_class[];\n\textern __u32 ppc32_write_class[];\n\textern __u32 ppc32_read_class[];\n\textern __u32 ppc32_chattr_class[];\n\textern __u32 ppc32_signal_class[];\n\taudit_register_class(AUDIT_CLASS_WRITE_32, ppc32_write_class);\n\taudit_register_class(AUDIT_CLASS_READ_32, ppc32_read_class);\n\taudit_register_class(AUDIT_CLASS_DIR_WRITE_32, ppc32_dir_class);\n\taudit_register_class(AUDIT_CLASS_CHATTR_32, ppc32_chattr_class);\n\taudit_register_class(AUDIT_CLASS_SIGNAL_32, ppc32_signal_class);\n#endif\n\taudit_register_class(AUDIT_CLASS_WRITE, write_class);\n\taudit_register_class(AUDIT_CLASS_READ, read_class);\n\taudit_register_class(AUDIT_CLASS_DIR_WRITE, dir_class);\n\taudit_register_class(AUDIT_CLASS_CHATTR, chattr_class);\n\taudit_register_class(AUDIT_CLASS_SIGNAL, signal_class);\n\treturn 0;\n}"
  },
  {
    "function_name": "audit_classify_syscall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/audit.c",
    "lines": "40-59",
    "snippet": "int audit_classify_syscall(int abi, unsigned syscall)\n{\n#ifdef CONFIG_PPC64\n\textern int ppc32_classify_syscall(unsigned);\n\tif (abi == AUDIT_ARCH_PPC)\n\t\treturn ppc32_classify_syscall(syscall);\n#endif\n\tswitch(syscall) {\n\tcase __NR_open:\n\t\treturn 2;\n\tcase __NR_openat:\n\t\treturn 3;\n\tcase __NR_socketcall:\n\t\treturn 4;\n\tcase __NR_execve:\n\t\treturn 5;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/audit.h>",
      "#include <linux/types.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc32_classify_syscall",
          "args": [
            "syscall"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "ppc32_classify_syscall",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/compat_audit.c",
          "lines": "29-43",
          "snippet": "int ppc32_classify_syscall(unsigned syscall)\n{\n\tswitch(syscall) {\n\tcase __NR_open:\n\t\treturn 2;\n\tcase __NR_openat:\n\t\treturn 3;\n\tcase __NR_socketcall:\n\t\treturn 4;\n\tcase __NR_execve:\n\t\treturn 5;\n\tdefault:\n\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <asm/unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n\nint ppc32_classify_syscall(unsigned syscall)\n{\n\tswitch(syscall) {\n\tcase __NR_open:\n\t\treturn 2;\n\tcase __NR_openat:\n\t\treturn 3;\n\tcase __NR_socketcall:\n\t\treturn 4;\n\tcase __NR_execve:\n\t\treturn 5;\n\tdefault:\n\t\treturn 1;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/audit.h>\n#include <linux/types.h>\n#include <linux/init.h>\n\nint audit_classify_syscall(int abi, unsigned syscall)\n{\n#ifdef CONFIG_PPC64\n\textern int ppc32_classify_syscall(unsigned);\n\tif (abi == AUDIT_ARCH_PPC)\n\t\treturn ppc32_classify_syscall(syscall);\n#endif\n\tswitch(syscall) {\n\tcase __NR_open:\n\t\treturn 2;\n\tcase __NR_openat:\n\t\treturn 3;\n\tcase __NR_socketcall:\n\t\treturn 4;\n\tcase __NR_execve:\n\t\treturn 5;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
  },
  {
    "function_name": "audit_classify_arch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/audit.c",
    "lines": "31-38",
    "snippet": "int audit_classify_arch(int arch)\n{\n#ifdef CONFIG_PPC64\n\tif (arch == AUDIT_ARCH_PPC)\n\t\treturn 1;\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/audit.h>",
      "#include <linux/types.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/audit.h>\n#include <linux/types.h>\n#include <linux/init.h>\n\nint audit_classify_arch(int arch)\n{\n#ifdef CONFIG_PPC64\n\tif (arch == AUDIT_ARCH_PPC)\n\t\treturn 1;\n#endif\n\treturn 0;\n}"
  }
]