[
  {
    "function_name": "doorbell_exception",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/dbell.c",
    "lines": "54-57",
    "snippet": "void doorbell_exception(struct pt_regs *regs)\n{\n\tprintk(KERN_WARNING \"Received doorbell on non-smp system\\n\");\n}",
    "includes": [
      "#include <asm/kvm_ppc.h>",
      "#include <asm/irq_regs.h>",
      "#include <asm/dbell.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/threads.h>",
      "#include <linux/smp.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"Received doorbell on non-smp system\\n\""
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/kvm_ppc.h>\n#include <asm/irq_regs.h>\n#include <asm/dbell.h>\n#include <linux/hardirq.h>\n#include <linux/threads.h>\n#include <linux/smp.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nvoid doorbell_exception(struct pt_regs *regs)\n{\n\tprintk(KERN_WARNING \"Received doorbell on non-smp system\\n\");\n}"
  },
  {
    "function_name": "doorbell_exception",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/dbell.c",
    "lines": "37-52",
    "snippet": "void doorbell_exception(struct pt_regs *regs)\n{\n\tstruct pt_regs *old_regs = set_irq_regs(regs);\n\n\tirq_enter();\n\n\tmay_hard_irq_enable();\n\n\tkvmppc_set_host_ipi(smp_processor_id(), 0);\n\t__this_cpu_inc(irq_stat.doorbell_irqs);\n\n\tsmp_ipi_demux();\n\n\tirq_exit();\n\tset_irq_regs(old_regs);\n}",
    "includes": [
      "#include <asm/kvm_ppc.h>",
      "#include <asm/irq_regs.h>",
      "#include <asm/dbell.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/threads.h>",
      "#include <linux/smp.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_irq_regs",
          "args": [
            "old_regs"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_exit",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_ipi_demux",
          "args": [],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "smp_ipi_demux",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "244-264",
          "snippet": "irqreturn_t smp_ipi_demux(void)\n{\n\tstruct cpu_messages *info = this_cpu_ptr(&ipi_message);\n\tunsigned int all;\n\n\tmb();\t/* order any irq clear */\n\n\tdo {\n\t\tall = xchg(&info->messages, 0);\n\t\tif (all & IPI_MESSAGE(PPC_MSG_CALL_FUNCTION))\n\t\t\tgeneric_smp_call_function_interrupt();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_RESCHEDULE))\n\t\t\tscheduler_ipi();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_TICK_BROADCAST))\n\t\t\ttick_broadcast_ipi_handler();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_DEBUGGER_BREAK))\n\t\t\tdebug_ipi_action(0, NULL);\n\t} while (info->messages);\n\n\treturn IRQ_HANDLED;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nirqreturn_t smp_ipi_demux(void)\n{\n\tstruct cpu_messages *info = this_cpu_ptr(&ipi_message);\n\tunsigned int all;\n\n\tmb();\t/* order any irq clear */\n\n\tdo {\n\t\tall = xchg(&info->messages, 0);\n\t\tif (all & IPI_MESSAGE(PPC_MSG_CALL_FUNCTION))\n\t\t\tgeneric_smp_call_function_interrupt();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_RESCHEDULE))\n\t\t\tscheduler_ipi();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_TICK_BROADCAST))\n\t\t\ttick_broadcast_ipi_handler();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_DEBUGGER_BREAK))\n\t\t\tdebug_ipi_action(0, NULL);\n\t} while (info->messages);\n\n\treturn IRQ_HANDLED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__this_cpu_inc",
          "args": [
            "irq_stat.doorbell_irqs"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvmppc_set_host_ipi",
          "args": [
            "smp_processor_id()",
            "0"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "may_hard_irq_enable",
          "args": [],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_enter",
          "args": [],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_irq_regs",
          "args": [
            "regs"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/kvm_ppc.h>\n#include <asm/irq_regs.h>\n#include <asm/dbell.h>\n#include <linux/hardirq.h>\n#include <linux/threads.h>\n#include <linux/smp.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nvoid doorbell_exception(struct pt_regs *regs)\n{\n\tstruct pt_regs *old_regs = set_irq_regs(regs);\n\n\tirq_enter();\n\n\tmay_hard_irq_enable();\n\n\tkvmppc_set_host_ipi(smp_processor_id(), 0);\n\t__this_cpu_inc(irq_stat.doorbell_irqs);\n\n\tsmp_ipi_demux();\n\n\tirq_exit();\n\tset_irq_regs(old_regs);\n}"
  },
  {
    "function_name": "doorbell_cause_ipi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/dbell.c",
    "lines": "30-35",
    "snippet": "void doorbell_cause_ipi(int cpu, unsigned long data)\n{\n\t/* Order previous accesses vs. msgsnd, which is treated as a store */\n\tmb();\n\tppc_msgsnd(PPC_DBELL_MSGTYPE, 0, data);\n}",
    "includes": [
      "#include <asm/kvm_ppc.h>",
      "#include <asm/irq_regs.h>",
      "#include <asm/dbell.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/threads.h>",
      "#include <linux/smp.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_msgsnd",
          "args": [
            "PPC_DBELL_MSGTYPE",
            "0",
            "data"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb",
          "args": [],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/kvm_ppc.h>\n#include <asm/irq_regs.h>\n#include <asm/dbell.h>\n#include <linux/hardirq.h>\n#include <linux/threads.h>\n#include <linux/smp.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nvoid doorbell_cause_ipi(int cpu, unsigned long data)\n{\n\t/* Order previous accesses vs. msgsnd, which is treated as a store */\n\tmb();\n\tppc_msgsnd(PPC_DBELL_MSGTYPE, 0, data);\n}"
  },
  {
    "function_name": "doorbell_setup_this_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/dbell.c",
    "lines": "23-28",
    "snippet": "void doorbell_setup_this_cpu(void)\n{\n\tunsigned long tag = mfspr(SPRN_DOORBELL_CPUTAG) & PPC_DBELL_TAG_MASK;\n\n\tsmp_muxed_ipi_set_data(smp_processor_id(), tag);\n}",
    "includes": [
      "#include <asm/kvm_ppc.h>",
      "#include <asm/irq_regs.h>",
      "#include <asm/dbell.h>",
      "#include <linux/hardirq.h>",
      "#include <linux/threads.h>",
      "#include <linux/smp.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_muxed_ipi_set_data",
          "args": [
            "smp_processor_id()",
            "tag"
          ],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "smp_muxed_ipi_set_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "214-219",
          "snippet": "void smp_muxed_ipi_set_data(int cpu, unsigned long data)\n{\n\tstruct cpu_messages *info = &per_cpu(ipi_message, cpu);\n\n\tinfo->data = data;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_muxed_ipi_set_data(int cpu, unsigned long data)\n{\n\tstruct cpu_messages *info = &per_cpu(ipi_message, cpu);\n\n\tinfo->data = data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_DOORBELL_CPUTAG"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/kvm_ppc.h>\n#include <asm/irq_regs.h>\n#include <asm/dbell.h>\n#include <linux/hardirq.h>\n#include <linux/threads.h>\n#include <linux/smp.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nvoid doorbell_setup_this_cpu(void)\n{\n\tunsigned long tag = mfspr(SPRN_DOORBELL_CPUTAG) & PPC_DBELL_TAG_MASK;\n\n\tsmp_muxed_ipi_set_data(smp_processor_id(), tag);\n}"
  }
]