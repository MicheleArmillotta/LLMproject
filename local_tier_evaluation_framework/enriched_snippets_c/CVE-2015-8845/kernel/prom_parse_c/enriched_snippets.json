[
  {
    "function_name": "of_parse_dma_window",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom_parse.c",
    "lines": "10-33",
    "snippet": "void of_parse_dma_window(struct device_node *dn, const __be32 *dma_window,\n\t\t\t unsigned long *busno, unsigned long *phys,\n\t\t\t unsigned long *size)\n{\n\tu32 cells;\n\tconst __be32 *prop;\n\n\t/* busno is always one cell */\n\t*busno = of_read_number(dma_window, 1);\n\tdma_window++;\n\n\tprop = of_get_property(dn, \"ibm,#dma-address-cells\", NULL);\n\tif (!prop)\n\t\tprop = of_get_property(dn, \"#address-cells\", NULL);\n\n\tcells = prop ? of_read_number(prop, 1) : of_n_addr_cells(dn);\n\t*phys = of_read_number(dma_window, cells);\n\n\tdma_window += cells;\n\n\tprop = of_get_property(dn, \"ibm,#dma-size-cells\", NULL);\n\tcells = prop ? of_read_number(prop, 1) : of_n_size_cells(dn);\n\t*size = of_read_number(dma_window, cells);\n}",
    "includes": [
      "#include <asm/prom.h>",
      "#include <linux/of_address.h>",
      "#include <linux/etherdevice.h>",
      "#include <linux/ioport.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_read_number",
          "args": [
            "dma_window",
            "cells"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_n_size_cells",
          "args": [
            "dn"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_read_number",
          "args": [
            "prop",
            "1"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "dn",
            "\"ibm,#dma-size-cells\"",
            "NULL"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_read_number",
          "args": [
            "dma_window",
            "cells"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_n_addr_cells",
          "args": [
            "dn"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_read_number",
          "args": [
            "prop",
            "1"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "dn",
            "\"#address-cells\"",
            "NULL"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "dn",
            "\"ibm,#dma-address-cells\"",
            "NULL"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_read_number",
          "args": [
            "dma_window",
            "1"
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/prom.h>\n#include <linux/of_address.h>\n#include <linux/etherdevice.h>\n#include <linux/ioport.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nvoid of_parse_dma_window(struct device_node *dn, const __be32 *dma_window,\n\t\t\t unsigned long *busno, unsigned long *phys,\n\t\t\t unsigned long *size)\n{\n\tu32 cells;\n\tconst __be32 *prop;\n\n\t/* busno is always one cell */\n\t*busno = of_read_number(dma_window, 1);\n\tdma_window++;\n\n\tprop = of_get_property(dn, \"ibm,#dma-address-cells\", NULL);\n\tif (!prop)\n\t\tprop = of_get_property(dn, \"#address-cells\", NULL);\n\n\tcells = prop ? of_read_number(prop, 1) : of_n_addr_cells(dn);\n\t*phys = of_read_number(dma_window, cells);\n\n\tdma_window += cells;\n\n\tprop = of_get_property(dn, \"ibm,#dma-size-cells\", NULL);\n\tcells = prop ? of_read_number(prop, 1) : of_n_size_cells(dn);\n\t*size = of_read_number(dma_window, cells);\n}"
  }
]