[
  {
    "function_name": "register_powersave_nap_sysctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/idle.c",
    "lines": "107-113",
    "snippet": "static int __init\nregister_powersave_nap_sysctl(void)\n{\n\tregister_sysctl_table(powersave_nap_sysctl_root);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/smp.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <linux/tick.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/cpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_sysctl_table",
          "args": [
            "powersave_nap_sysctl_root"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/smp.h>\n#include <asm/runlatch.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <linux/tick.h>\n#include <linux/sysctl.h>\n#include <linux/cpu.h>\n#include <linux/smp.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n\nstatic int __init\nregister_powersave_nap_sysctl(void)\n{\n\tregister_sysctl_table(powersave_nap_sysctl_root);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "arch_cpu_idle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/idle.c",
    "lines": "56-80",
    "snippet": "void arch_cpu_idle(void)\n{\n\tppc64_runlatch_off();\n\n\tif (ppc_md.power_save) {\n\t\tppc_md.power_save();\n\t\t/*\n\t\t * Some power_save functions return with\n\t\t * interrupts enabled, some don't.\n\t\t */\n\t\tif (irqs_disabled())\n\t\t\tlocal_irq_enable();\n\t} else {\n\t\tlocal_irq_enable();\n\t\t/*\n\t\t * Go into low thread priority and possibly\n\t\t * low power mode.\n\t\t */\n\t\tHMT_low();\n\t\tHMT_very_low();\n\t}\n\n\tHMT_medium();\n\tppc64_runlatch_on();\n}",
    "includes": [
      "#include <asm/smp.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <linux/tick.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/cpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc64_runlatch_on",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "__ppc64_runlatch_on",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/process.c",
          "lines": "1587-1597",
          "snippet": "void notrace __ppc64_runlatch_on(void)\n{\n\tstruct thread_info *ti = current_thread_info();\n\tunsigned long ctrl;\n\n\tctrl = mfspr(SPRN_CTRLF);\n\tctrl |= CTRL_RUNLATCH;\n\tmtspr(SPRN_CTRLT, ctrl);\n\n\tti->local_flags |= _TLF_RUNLATCH;\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/code-patching.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __ppc64_runlatch_on(void)\n{\n\tstruct thread_info *ti = current_thread_info();\n\tunsigned long ctrl;\n\n\tctrl = mfspr(SPRN_CTRLF);\n\tctrl |= CTRL_RUNLATCH;\n\tmtspr(SPRN_CTRLT, ctrl);\n\n\tti->local_flags |= _TLF_RUNLATCH;\n}"
        }
      },
      {
        "call_info": {
          "callee": "HMT_medium",
          "args": [],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HMT_very_low",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HMT_low",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_enable",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_enable",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irqs_disabled",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.power_save",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc64_runlatch_off",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "__ppc64_runlatch_off",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/process.c",
          "lines": "1600-1610",
          "snippet": "void notrace __ppc64_runlatch_off(void)\n{\n\tstruct thread_info *ti = current_thread_info();\n\tunsigned long ctrl;\n\n\tti->local_flags &= ~_TLF_RUNLATCH;\n\n\tctrl = mfspr(SPRN_CTRLF);\n\tctrl &= ~CTRL_RUNLATCH;\n\tmtspr(SPRN_CTRLT, ctrl);\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/code-patching.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid notrace __ppc64_runlatch_off(void)\n{\n\tstruct thread_info *ti = current_thread_info();\n\tunsigned long ctrl;\n\n\tti->local_flags &= ~_TLF_RUNLATCH;\n\n\tctrl = mfspr(SPRN_CTRLF);\n\tctrl &= ~CTRL_RUNLATCH;\n\tmtspr(SPRN_CTRLT, ctrl);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/smp.h>\n#include <asm/runlatch.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <linux/tick.h>\n#include <linux/sysctl.h>\n#include <linux/cpu.h>\n#include <linux/smp.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n\nvoid arch_cpu_idle(void)\n{\n\tppc64_runlatch_off();\n\n\tif (ppc_md.power_save) {\n\t\tppc_md.power_save();\n\t\t/*\n\t\t * Some power_save functions return with\n\t\t * interrupts enabled, some don't.\n\t\t */\n\t\tif (irqs_disabled())\n\t\t\tlocal_irq_enable();\n\t} else {\n\t\tlocal_irq_enable();\n\t\t/*\n\t\t * Go into low thread priority and possibly\n\t\t * low power mode.\n\t\t */\n\t\tHMT_low();\n\t\tHMT_very_low();\n\t}\n\n\tHMT_medium();\n\tppc64_runlatch_on();\n}"
  },
  {
    "function_name": "arch_cpu_idle_dead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/idle.c",
    "lines": "49-53",
    "snippet": "void arch_cpu_idle_dead(void)\n{\n\tsched_preempt_enable_no_resched();\n\tcpu_die();\n}",
    "includes": [
      "#include <asm/smp.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <linux/tick.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/cpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_die",
          "args": [],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/smp.c",
          "lines": "823-830",
          "snippet": "void cpu_die(void)\n{\n\tif (ppc_md.cpu_die)\n\t\tppc_md.cpu_die();\n\n\t/* If we return, we re-enter start_secondary */\n\tstart_secondary_resume();\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid cpu_die(void)\n{\n\tif (ppc_md.cpu_die)\n\t\tppc_md.cpu_die();\n\n\t/* If we return, we re-enter start_secondary */\n\tstart_secondary_resume();\n}"
        }
      },
      {
        "call_info": {
          "callee": "sched_preempt_enable_no_resched",
          "args": [],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/smp.h>\n#include <asm/runlatch.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <linux/tick.h>\n#include <linux/sysctl.h>\n#include <linux/cpu.h>\n#include <linux/smp.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n\nvoid arch_cpu_idle_dead(void)\n{\n\tsched_preempt_enable_no_resched();\n\tcpu_die();\n}"
  },
  {
    "function_name": "powersave_off",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/idle.c",
    "lines": "40-45",
    "snippet": "static int __init powersave_off(char *arg)\n{\n\tppc_md.power_save = NULL;\n\tcpuidle_disable = IDLE_POWERSAVE_OFF;\n\treturn 0;\n}",
    "includes": [
      "#include <asm/smp.h>",
      "#include <asm/runlatch.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <linux/tick.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/cpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long cpuidle_disable = IDLE_NO_OVERRIDE;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <asm/smp.h>\n#include <asm/runlatch.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <linux/tick.h>\n#include <linux/sysctl.h>\n#include <linux/cpu.h>\n#include <linux/smp.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n\nunsigned long cpuidle_disable = IDLE_NO_OVERRIDE;\n\nstatic int __init powersave_off(char *arg)\n{\n\tppc_md.power_save = NULL;\n\tcpuidle_disable = IDLE_POWERSAVE_OFF;\n\treturn 0;\n}"
  }
]