[
  {
    "function_name": "ibmebus_bus_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "728-758",
    "snippet": "static int __init ibmebus_bus_init(void)\n{\n\tint err;\n\n\tprintk(KERN_INFO \"IBM eBus Device Driver\\n\");\n\n\terr = bus_register(&ibmebus_bus_type);\n\tif (err) {\n\t\tprintk(KERN_ERR \"%s: failed to register IBM eBus.\\n\",\n\t\t       __func__);\n\t\treturn err;\n\t}\n\n\terr = device_register(&ibmebus_bus_device);\n\tif (err) {\n\t\tprintk(KERN_WARNING \"%s: device_register returned %i\\n\",\n\t\t       __func__, err);\n\t\tbus_unregister(&ibmebus_bus_type);\n\n\t\treturn err;\n\t}\n\n\terr = ibmebus_create_devices(ibmebus_matches);\n\tif (err) {\n\t\tdevice_unregister(&ibmebus_bus_device);\n\t\tbus_unregister(&ibmebus_bus_type);\n\t\treturn err;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct device ibmebus_bus_device = { /* fake \"parent\" device */\n\t.init_name = \"ibmebus\",\n};",
      "struct bus_type ibmebus_bus_type;",
      "static const struct of_device_id ibmebus_matches[] __initconst = {\n\t{ .compatible = \"IBM,lhca\" },\n\t{ .compatible = \"IBM,lhea\" },\n\t{},\n};",
      "struct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_unregister",
          "args": [
            "&ibmebus_bus_type"
          ],
          "line": 753
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_unregister_driver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "218-221",
          "snippet": "void ibmebus_unregister_driver(struct platform_driver *drv)\n{\n\tdriver_unregister(&drv->driver);\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nvoid ibmebus_unregister_driver(struct platform_driver *drv)\n{\n\tdriver_unregister(&drv->driver);\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_unregister",
          "args": [
            "&ibmebus_bus_device"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ibmebus_create_devices",
          "args": [
            "ibmebus_matches"
          ],
          "line": 750
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_create_devices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "180-206",
          "snippet": "static int ibmebus_create_devices(const struct of_device_id *matches)\n{\n\tstruct device_node *root, *child;\n\tint ret = 0;\n\n\troot = of_find_node_by_path(\"/\");\n\n\tfor_each_child_of_node(root, child) {\n\t\tif (!of_match_node(matches, child))\n\t\t\tcontinue;\n\n\t\tif (bus_find_device(&ibmebus_bus_type, NULL, child,\n\t\t\t\t    ibmebus_match_node))\n\t\t\tcontinue;\n\n\t\tret = ibmebus_create_device(child);\n\t\tif (ret) {\n\t\t\tprintk(KERN_ERR \"%s: failed to create device (%i)\",\n\t\t\t       __func__, ret);\n\t\t\tof_node_put(child);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tof_node_put(root);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct bus_type ibmebus_bus_type;",
            "struct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstruct bus_type ibmebus_bus_type;\nstruct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};\n\nstatic int ibmebus_create_devices(const struct of_device_id *matches)\n{\n\tstruct device_node *root, *child;\n\tint ret = 0;\n\n\troot = of_find_node_by_path(\"/\");\n\n\tfor_each_child_of_node(root, child) {\n\t\tif (!of_match_node(matches, child))\n\t\t\tcontinue;\n\n\t\tif (bus_find_device(&ibmebus_bus_type, NULL, child,\n\t\t\t\t    ibmebus_match_node))\n\t\t\tcontinue;\n\n\t\tret = ibmebus_create_device(child);\n\t\tif (ret) {\n\t\t\tprintk(KERN_ERR \"%s: failed to create device (%i)\",\n\t\t\t       __func__, ret);\n\t\t\tof_node_put(child);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tof_node_put(root);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"%s: device_register returned %i\\n\"",
            "__func__",
            "err"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_register",
          "args": [
            "&ibmebus_bus_device"
          ],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"%s: failed to register IBM eBus.\\n\"",
            "__func__"
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "printk_log_rtas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/rtasd.c",
          "lines": "111-156",
          "snippet": "static void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s, Severity: %d\\n\",\n\t\t       error_log_cnt, rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_severity(errlog));\n\t}\n}",
          "includes": [
            "#include <asm/topology.h>",
            "#include <asm/machdep.h>",
            "#include <linux/atomic.h>",
            "#include <asm/nvram.h>",
            "#include <asm/prom.h>",
            "#include <asm/rtas.h>",
            "#include <asm/io.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/cpu.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int full_rtas_msgs = 0;",
            "static int error_log_cnt;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/topology.h>\n#include <asm/machdep.h>\n#include <linux/atomic.h>\n#include <asm/nvram.h>\n#include <asm/prom.h>\n#include <asm/rtas.h>\n#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/cpu.h>\n#include <linux/spinlock.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic int full_rtas_msgs = 0;\nstatic int error_log_cnt;\n\nstatic void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s, Severity: %d\\n\",\n\t\t       error_log_cnt, rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_severity(errlog));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_register",
          "args": [
            "&ibmebus_bus_type"
          ],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_register_driver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "208-215",
          "snippet": "int ibmebus_register_driver(struct platform_driver *drv)\n{\n\t/* If the driver uses devices that ibmebus doesn't know, add them */\n\tibmebus_create_devices(drv->driver.of_match_table);\n\n\tdrv->driver.bus = &ibmebus_bus_type;\n\treturn driver_register(&drv->driver);\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct bus_type ibmebus_bus_type;",
            "struct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstruct bus_type ibmebus_bus_type;\nstruct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};\n\nint ibmebus_register_driver(struct platform_driver *drv)\n{\n\t/* If the driver uses devices that ibmebus doesn't know, add them */\n\tibmebus_create_devices(drv->driver.of_match_table);\n\n\tdrv->driver.bus = &ibmebus_bus_type;\n\treturn driver_register(&drv->driver);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"IBM eBus Device Driver\\n\""
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic struct device ibmebus_bus_device = { /* fake \"parent\" device */\n\t.init_name = \"ibmebus\",\n};\nstruct bus_type ibmebus_bus_type;\nstatic const struct of_device_id ibmebus_matches[] __initconst = {\n\t{ .compatible = \"IBM,lhca\" },\n\t{ .compatible = \"IBM,lhea\" },\n\t{},\n};\nstruct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};\n\nstatic int __init ibmebus_bus_init(void)\n{\n\tint err;\n\n\tprintk(KERN_INFO \"IBM eBus Device Driver\\n\");\n\n\terr = bus_register(&ibmebus_bus_type);\n\tif (err) {\n\t\tprintk(KERN_ERR \"%s: failed to register IBM eBus.\\n\",\n\t\t       __func__);\n\t\treturn err;\n\t}\n\n\terr = device_register(&ibmebus_bus_device);\n\tif (err) {\n\t\tprintk(KERN_WARNING \"%s: device_register returned %i\\n\",\n\t\t       __func__, err);\n\t\tbus_unregister(&ibmebus_bus_type);\n\n\t\treturn err;\n\t}\n\n\terr = ibmebus_create_devices(ibmebus_matches);\n\tif (err) {\n\t\tdevice_unregister(&ibmebus_bus_device);\n\t\tbus_unregister(&ibmebus_bus_type);\n\t\treturn err;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_restore_noirq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "661-675",
    "snippet": "static int ibmebus_bus_pm_restore_noirq(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->restore_noirq)\n\t\t\tret = drv->pm->restore_noirq(dev);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define ibmebus_bus_pm_restore_noirq\tNULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "drv->pm->restore_noirq",
          "args": [
            "dev"
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\n#define ibmebus_bus_pm_restore_noirq\tNULL\n\nstatic int ibmebus_bus_pm_restore_noirq(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->restore_noirq)\n\t\t\tret = drv->pm->restore_noirq(dev);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_restore",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "643-659",
    "snippet": "static int ibmebus_bus_pm_restore(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->restore)\n\t\t\tret = drv->pm->restore(dev);\n\t} else {\n\t\tret = ibmebus_bus_legacy_resume(dev);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define ibmebus_bus_pm_restore\t\tNULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ibmebus_bus_legacy_resume",
          "args": [
            "dev"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_bus_legacy_resume",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "430-439",
          "snippet": "static int ibmebus_bus_legacy_resume(struct device *dev)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->resume)\n\t\tret = drv->resume(of_dev);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_bus_legacy_resume(struct device *dev)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->resume)\n\t\tret = drv->resume(of_dev);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "drv->pm->restore",
          "args": [
            "dev"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\n#define ibmebus_bus_pm_restore\t\tNULL\n\nstatic int ibmebus_bus_pm_restore(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->restore)\n\t\t\tret = drv->pm->restore(dev);\n\t} else {\n\t\tret = ibmebus_bus_legacy_resume(dev);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_poweroff_noirq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "627-641",
    "snippet": "static int ibmebus_bus_pm_poweroff_noirq(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->poweroff_noirq)\n\t\t\tret = drv->pm->poweroff_noirq(dev);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define ibmebus_bus_pm_poweroff_noirq\tNULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "drv->pm->poweroff_noirq",
          "args": [
            "dev"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\n#define ibmebus_bus_pm_poweroff_noirq\tNULL\n\nstatic int ibmebus_bus_pm_poweroff_noirq(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->poweroff_noirq)\n\t\t\tret = drv->pm->poweroff_noirq(dev);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_poweroff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "609-625",
    "snippet": "static int ibmebus_bus_pm_poweroff(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->poweroff)\n\t\t\tret = drv->pm->poweroff(dev);\n\t} else {\n\t\tret = ibmebus_bus_legacy_suspend(dev, PMSG_HIBERNATE);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define ibmebus_bus_pm_poweroff\t\tNULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ibmebus_bus_legacy_suspend",
          "args": [
            "dev",
            "PMSG_HIBERNATE"
          ],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_bus_legacy_suspend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "419-428",
          "snippet": "static int ibmebus_bus_legacy_suspend(struct device *dev, pm_message_t mesg)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->suspend)\n\t\tret = drv->suspend(of_dev, mesg);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_bus_legacy_suspend(struct device *dev, pm_message_t mesg)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->suspend)\n\t\tret = drv->suspend(of_dev, mesg);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "drv->pm->poweroff",
          "args": [
            "dev"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\n#define ibmebus_bus_pm_poweroff\t\tNULL\n\nstatic int ibmebus_bus_pm_poweroff(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->poweroff)\n\t\t\tret = drv->pm->poweroff(dev);\n\t} else {\n\t\tret = ibmebus_bus_legacy_suspend(dev, PMSG_HIBERNATE);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_thaw_noirq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "593-607",
    "snippet": "static int ibmebus_bus_pm_thaw_noirq(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->thaw_noirq)\n\t\t\tret = drv->pm->thaw_noirq(dev);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define ibmebus_bus_pm_thaw_noirq\t\tNULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "drv->pm->thaw_noirq",
          "args": [
            "dev"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\n#define ibmebus_bus_pm_thaw_noirq\t\tNULL\n\nstatic int ibmebus_bus_pm_thaw_noirq(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->thaw_noirq)\n\t\t\tret = drv->pm->thaw_noirq(dev);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_thaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "575-591",
    "snippet": "static int ibmebus_bus_pm_thaw(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->thaw)\n\t\t\tret = drv->pm->thaw(dev);\n\t} else {\n\t\tret = ibmebus_bus_legacy_resume(dev);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define ibmebus_bus_pm_thaw\t\tNULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ibmebus_bus_legacy_resume",
          "args": [
            "dev"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_bus_legacy_resume",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "430-439",
          "snippet": "static int ibmebus_bus_legacy_resume(struct device *dev)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->resume)\n\t\tret = drv->resume(of_dev);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_bus_legacy_resume(struct device *dev)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->resume)\n\t\tret = drv->resume(of_dev);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "drv->pm->thaw",
          "args": [
            "dev"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\n#define ibmebus_bus_pm_thaw\t\tNULL\n\nstatic int ibmebus_bus_pm_thaw(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->thaw)\n\t\t\tret = drv->pm->thaw(dev);\n\t} else {\n\t\tret = ibmebus_bus_legacy_resume(dev);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_freeze_noirq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "559-573",
    "snippet": "static int ibmebus_bus_pm_freeze_noirq(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->freeze_noirq)\n\t\t\tret = drv->pm->freeze_noirq(dev);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define ibmebus_bus_pm_freeze_noirq\tNULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "drv->pm->freeze_noirq",
          "args": [
            "dev"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\n#define ibmebus_bus_pm_freeze_noirq\tNULL\n\nstatic int ibmebus_bus_pm_freeze_noirq(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->freeze_noirq)\n\t\t\tret = drv->pm->freeze_noirq(dev);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_freeze",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "541-557",
    "snippet": "static int ibmebus_bus_pm_freeze(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->freeze)\n\t\t\tret = drv->pm->freeze(dev);\n\t} else {\n\t\tret = ibmebus_bus_legacy_suspend(dev, PMSG_FREEZE);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define ibmebus_bus_pm_freeze\t\tNULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ibmebus_bus_legacy_suspend",
          "args": [
            "dev",
            "PMSG_FREEZE"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_bus_legacy_suspend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "419-428",
          "snippet": "static int ibmebus_bus_legacy_suspend(struct device *dev, pm_message_t mesg)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->suspend)\n\t\tret = drv->suspend(of_dev, mesg);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_bus_legacy_suspend(struct device *dev, pm_message_t mesg)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->suspend)\n\t\tret = drv->suspend(of_dev, mesg);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "drv->pm->freeze",
          "args": [
            "dev"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\n#define ibmebus_bus_pm_freeze\t\tNULL\n\nstatic int ibmebus_bus_pm_freeze(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->freeze)\n\t\t\tret = drv->pm->freeze(dev);\n\t} else {\n\t\tret = ibmebus_bus_legacy_suspend(dev, PMSG_FREEZE);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_resume_noirq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "514-528",
    "snippet": "static int ibmebus_bus_pm_resume_noirq(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->resume_noirq)\n\t\t\tret = drv->pm->resume_noirq(dev);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define ibmebus_bus_pm_resume_noirq\tNULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "drv->pm->resume_noirq",
          "args": [
            "dev"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\n#define ibmebus_bus_pm_resume_noirq\tNULL\n\nstatic int ibmebus_bus_pm_resume_noirq(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->resume_noirq)\n\t\t\tret = drv->pm->resume_noirq(dev);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_resume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "496-512",
    "snippet": "static int ibmebus_bus_pm_resume(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->resume)\n\t\t\tret = drv->pm->resume(dev);\n\t} else {\n\t\tret = ibmebus_bus_legacy_resume(dev);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define ibmebus_bus_pm_resume\t\tNULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ibmebus_bus_legacy_resume",
          "args": [
            "dev"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_bus_legacy_resume",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "430-439",
          "snippet": "static int ibmebus_bus_legacy_resume(struct device *dev)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->resume)\n\t\tret = drv->resume(of_dev);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_bus_legacy_resume(struct device *dev)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->resume)\n\t\tret = drv->resume(of_dev);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "drv->pm->resume",
          "args": [
            "dev"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\n#define ibmebus_bus_pm_resume\t\tNULL\n\nstatic int ibmebus_bus_pm_resume(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->resume)\n\t\t\tret = drv->pm->resume(dev);\n\t} else {\n\t\tret = ibmebus_bus_legacy_resume(dev);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_suspend_noirq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "480-494",
    "snippet": "static int ibmebus_bus_pm_suspend_noirq(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->suspend_noirq)\n\t\t\tret = drv->pm->suspend_noirq(dev);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define ibmebus_bus_pm_suspend_noirq\tNULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "drv->pm->suspend_noirq",
          "args": [
            "dev"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\n#define ibmebus_bus_pm_suspend_noirq\tNULL\n\nstatic int ibmebus_bus_pm_suspend_noirq(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->suspend_noirq)\n\t\t\tret = drv->pm->suspend_noirq(dev);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_suspend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "462-478",
    "snippet": "static int ibmebus_bus_pm_suspend(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->suspend)\n\t\t\tret = drv->pm->suspend(dev);\n\t} else {\n\t\tret = ibmebus_bus_legacy_suspend(dev, PMSG_SUSPEND);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define ibmebus_bus_pm_suspend\t\tNULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ibmebus_bus_legacy_suspend",
          "args": [
            "dev",
            "PMSG_SUSPEND"
          ],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_bus_legacy_suspend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "419-428",
          "snippet": "static int ibmebus_bus_legacy_suspend(struct device *dev, pm_message_t mesg)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->suspend)\n\t\tret = drv->suspend(of_dev, mesg);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_bus_legacy_suspend(struct device *dev, pm_message_t mesg)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->suspend)\n\t\tret = drv->suspend(of_dev, mesg);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "drv->pm->suspend",
          "args": [
            "dev"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\n#define ibmebus_bus_pm_suspend\t\tNULL\n\nstatic int ibmebus_bus_pm_suspend(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (!drv)\n\t\treturn 0;\n\n\tif (drv->pm) {\n\t\tif (drv->pm->suspend)\n\t\t\tret = drv->pm->suspend(dev);\n\t} else {\n\t\tret = ibmebus_bus_legacy_suspend(dev, PMSG_SUSPEND);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "452-458",
    "snippet": "static void ibmebus_bus_pm_complete(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\n\tif (drv && drv->pm && drv->pm->complete)\n\t\tdrv->pm->complete(dev);\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "drv->pm->complete",
          "args": [
            "dev"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic void ibmebus_bus_pm_complete(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\n\tif (drv && drv->pm && drv->pm->complete)\n\t\tdrv->pm->complete(dev);\n}"
  },
  {
    "function_name": "ibmebus_bus_pm_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "441-450",
    "snippet": "static int ibmebus_bus_pm_prepare(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (drv && drv->pm && drv->pm->prepare)\n\t\tret = drv->pm->prepare(dev);\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "drv->pm->prepare",
          "args": [
            "dev"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_bus_pm_prepare(struct device *dev)\n{\n\tstruct device_driver *drv = dev->driver;\n\tint ret = 0;\n\n\tif (drv && drv->pm && drv->pm->prepare)\n\t\tret = drv->pm->prepare(dev);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_legacy_resume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "430-439",
    "snippet": "static int ibmebus_bus_legacy_resume(struct device *dev)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->resume)\n\t\tret = drv->resume(of_dev);\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "drv->resume",
          "args": [
            "of_dev"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_driver",
          "args": [
            "dev->driver"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_device",
          "args": [
            "dev"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_bus_legacy_resume(struct device *dev)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->resume)\n\t\tret = drv->resume(of_dev);\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_bus_legacy_suspend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "419-428",
    "snippet": "static int ibmebus_bus_legacy_suspend(struct device *dev, pm_message_t mesg)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->suspend)\n\t\tret = drv->suspend(of_dev, mesg);\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "drv->suspend",
          "args": [
            "of_dev",
            "mesg"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_driver",
          "args": [
            "dev->driver"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_device",
          "args": [
            "dev"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_bus_legacy_suspend(struct device *dev, pm_message_t mesg)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\tint ret = 0;\n\n\tif (dev->driver && drv->suspend)\n\t\tret = drv->suspend(of_dev, mesg);\n\treturn ret;\n}"
  },
  {
    "function_name": "modalias_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "402-409",
    "snippet": "static ssize_t modalias_show(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tssize_t len = of_device_get_modalias(dev, buf, PAGE_SIZE - 2);\n\tbuf[len] = '\\n';\n\tbuf[len+1] = 0;\n\treturn len+1;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_device_get_modalias",
          "args": [
            "dev",
            "buf",
            "PAGE_SIZE - 2"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic ssize_t modalias_show(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tssize_t len = of_device_get_modalias(dev, buf, PAGE_SIZE - 2);\n\tbuf[len] = '\\n';\n\tbuf[len+1] = 0;\n\treturn len+1;\n}"
  },
  {
    "function_name": "name_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "393-400",
    "snippet": "static ssize_t name_show(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tstruct platform_device *ofdev;\n\n\tofdev = to_platform_device(dev);\n\treturn sprintf(buf, \"%s\\n\", ofdev->dev.of_node->name);\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%s\\n\"",
            "ofdev->dev.of_node->name"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_device",
          "args": [
            "dev"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic ssize_t name_show(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tstruct platform_device *ofdev;\n\n\tofdev = to_platform_device(dev);\n\treturn sprintf(buf, \"%s\\n\", ofdev->dev.of_node->name);\n}"
  },
  {
    "function_name": "devspec_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "384-391",
    "snippet": "static ssize_t devspec_show(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tstruct platform_device *ofdev;\n\n\tofdev = to_platform_device(dev);\n\treturn sprintf(buf, \"%s\\n\", ofdev->dev.of_node->full_name);\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%s\\n\"",
            "ofdev->dev.of_node->full_name"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_device",
          "args": [
            "dev"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic ssize_t devspec_show(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tstruct platform_device *ofdev;\n\n\tofdev = to_platform_device(dev);\n\treturn sprintf(buf, \"%s\\n\", ofdev->dev.of_node->full_name);\n}"
  },
  {
    "function_name": "ibmebus_bus_device_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "372-379",
    "snippet": "static void ibmebus_bus_device_shutdown(struct device *dev)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\n\tif (dev->driver && drv->shutdown)\n\t\tdrv->shutdown(of_dev);\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "drv->shutdown",
          "args": [
            "of_dev"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_driver",
          "args": [
            "dev->driver"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_device",
          "args": [
            "dev"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic void ibmebus_bus_device_shutdown(struct device *dev)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\n\tif (dev->driver && drv->shutdown)\n\t\tdrv->shutdown(of_dev);\n}"
  },
  {
    "function_name": "ibmebus_bus_device_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "362-370",
    "snippet": "static int ibmebus_bus_device_remove(struct device *dev)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\n\tif (dev->driver && drv->remove)\n\t\tdrv->remove(of_dev);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "drv->remove",
          "args": [
            "of_dev"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_driver",
          "args": [
            "dev->driver"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_device",
          "args": [
            "dev"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_bus_device_remove(struct device *dev)\n{\n\tstruct platform_device *of_dev = to_platform_device(dev);\n\tstruct platform_driver *drv = to_platform_driver(dev->driver);\n\n\tif (dev->driver && drv->remove)\n\t\tdrv->remove(of_dev);\n\treturn 0;\n}"
  },
  {
    "function_name": "ibmebus_bus_device_probe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "340-360",
    "snippet": "static int ibmebus_bus_device_probe(struct device *dev)\n{\n\tint error = -ENODEV;\n\tstruct platform_driver *drv;\n\tstruct platform_device *of_dev;\n\n\tdrv = to_platform_driver(dev->driver);\n\tof_dev = to_platform_device(dev);\n\n\tif (!drv->probe)\n\t\treturn error;\n\n\tof_dev_get(of_dev);\n\n\tif (of_driver_match_device(dev, dev->driver))\n\t\terror = drv->probe(of_dev);\n\tif (error)\n\t\tof_dev_put(of_dev);\n\n\treturn error;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_dev_put",
          "args": [
            "of_dev"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "drv->probe",
          "args": [
            "of_dev"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_driver_match_device",
          "args": [
            "dev",
            "dev->driver"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_dev_get",
          "args": [
            "of_dev"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_device",
          "args": [
            "dev"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_driver",
          "args": [
            "dev->driver"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_bus_device_probe(struct device *dev)\n{\n\tint error = -ENODEV;\n\tstruct platform_driver *drv;\n\tstruct platform_device *of_dev;\n\n\tdrv = to_platform_driver(dev->driver);\n\tof_dev = to_platform_device(dev);\n\n\tif (!drv->probe)\n\t\treturn error;\n\n\tof_dev_get(of_dev);\n\n\tif (of_driver_match_device(dev, dev->driver))\n\t\terror = drv->probe(of_dev);\n\tif (error)\n\t\tof_dev_put(of_dev);\n\n\treturn error;\n}"
  },
  {
    "function_name": "ibmebus_bus_bus_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "330-338",
    "snippet": "static int ibmebus_bus_bus_match(struct device *dev, struct device_driver *drv)\n{\n\tconst struct of_device_id *matches = drv->of_match_table;\n\n\tif (!matches)\n\t\treturn 0;\n\n\treturn of_match_device(matches, dev) != NULL;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_match_device",
          "args": [
            "matches",
            "dev"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_bus_bus_match(struct device *dev, struct device_driver *drv)\n{\n\tconst struct of_device_id *matches = drv->of_match_table;\n\n\tif (!matches)\n\t\treturn 0;\n\n\treturn of_match_device(matches, dev) != NULL;\n}"
  },
  {
    "function_name": "ibmebus_store_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "297-320",
    "snippet": "static ssize_t ibmebus_store_remove(struct bus_type *bus,\n\t\t\t\t    const char *buf, size_t count)\n{\n\tstruct device *dev;\n\tchar *path;\n\n\tpath = ibmebus_chomp(buf, count);\n\tif (!path)\n\t\treturn -ENOMEM;\n\n\tif ((dev = bus_find_device(&ibmebus_bus_type, NULL, path,\n\t\t\t\t   ibmebus_match_path))) {\n\t\tof_device_unregister(to_platform_device(dev));\n\n\t\tkfree(path);\n\t\treturn count;\n\t} else {\n\t\tprintk(KERN_WARNING \"%s: %s not on the bus\\n\",\n\t\t       __func__, path);\n\n\t\tkfree(path);\n\t\treturn -ENODEV;\n\t}\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct bus_type ibmebus_bus_type;",
      "static BUS_ATTR(remove, S_IWUSR, NULL, ibmebus_store_remove);",
      "struct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "path"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"%s: %s not on the bus\\n\"",
            "__func__",
            "path"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "path"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_device_unregister",
          "args": [
            "to_platform_device(dev)"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_device",
          "args": [
            "dev"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_find_device",
          "args": [
            "&ibmebus_bus_type",
            "NULL",
            "path",
            "ibmebus_match_path"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ibmebus_chomp",
          "args": [
            "buf",
            "count"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_chomp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "246-259",
          "snippet": "static char *ibmebus_chomp(const char *in, size_t count)\n{\n\tchar *out = kmalloc(count + 1, GFP_KERNEL);\n\n\tif (!out)\n\t\treturn NULL;\n\n\tmemcpy(out, in, count);\n\tout[count] = '\\0';\n\tif (out[count - 1] == '\\n')\n\t\tout[count - 1] = '\\0';\n\n\treturn out;\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic char *ibmebus_chomp(const char *in, size_t count)\n{\n\tchar *out = kmalloc(count + 1, GFP_KERNEL);\n\n\tif (!out)\n\t\treturn NULL;\n\n\tmemcpy(out, in, count);\n\tout[count] = '\\0';\n\tif (out[count - 1] == '\\n')\n\t\tout[count - 1] = '\\0';\n\n\treturn out;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstruct bus_type ibmebus_bus_type;\nstatic BUS_ATTR(remove, S_IWUSR, NULL, ibmebus_store_remove);\nstruct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};\n\nstatic ssize_t ibmebus_store_remove(struct bus_type *bus,\n\t\t\t\t    const char *buf, size_t count)\n{\n\tstruct device *dev;\n\tchar *path;\n\n\tpath = ibmebus_chomp(buf, count);\n\tif (!path)\n\t\treturn -ENOMEM;\n\n\tif ((dev = bus_find_device(&ibmebus_bus_type, NULL, path,\n\t\t\t\t   ibmebus_match_path))) {\n\t\tof_device_unregister(to_platform_device(dev));\n\n\t\tkfree(path);\n\t\treturn count;\n\t} else {\n\t\tprintk(KERN_WARNING \"%s: %s not on the bus\\n\",\n\t\t       __func__, path);\n\n\t\tkfree(path);\n\t\treturn -ENODEV;\n\t}\n}"
  },
  {
    "function_name": "ibmebus_store_probe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "261-294",
    "snippet": "static ssize_t ibmebus_store_probe(struct bus_type *bus,\n\t\t\t\t   const char *buf, size_t count)\n{\n\tstruct device_node *dn = NULL;\n\tchar *path;\n\tssize_t rc = 0;\n\n\tpath = ibmebus_chomp(buf, count);\n\tif (!path)\n\t\treturn -ENOMEM;\n\n\tif (bus_find_device(&ibmebus_bus_type, NULL, path,\n\t\t\t    ibmebus_match_path)) {\n\t\tprintk(KERN_WARNING \"%s: %s has already been probed\\n\",\n\t\t       __func__, path);\n\t\trc = -EEXIST;\n\t\tgoto out;\n\t}\n\n\tif ((dn = of_find_node_by_path(path))) {\n\t\trc = ibmebus_create_device(dn);\n\t\tof_node_put(dn);\n\t} else {\n\t\tprintk(KERN_WARNING \"%s: no such device node: %s\\n\",\n\t\t       __func__, path);\n\t\trc = -ENODEV;\n\t}\n\nout:\n\tkfree(path);\n\tif (rc)\n\t\treturn rc;\n\treturn count;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct bus_type ibmebus_bus_type;",
      "static BUS_ATTR(probe, S_IWUSR, NULL, ibmebus_store_probe);",
      "struct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "path"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"%s: no such device node: %s\\n\"",
            "__func__",
            "path"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "dn"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ibmebus_create_device",
          "args": [
            "dn"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_create_devices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "180-206",
          "snippet": "static int ibmebus_create_devices(const struct of_device_id *matches)\n{\n\tstruct device_node *root, *child;\n\tint ret = 0;\n\n\troot = of_find_node_by_path(\"/\");\n\n\tfor_each_child_of_node(root, child) {\n\t\tif (!of_match_node(matches, child))\n\t\t\tcontinue;\n\n\t\tif (bus_find_device(&ibmebus_bus_type, NULL, child,\n\t\t\t\t    ibmebus_match_node))\n\t\t\tcontinue;\n\n\t\tret = ibmebus_create_device(child);\n\t\tif (ret) {\n\t\t\tprintk(KERN_ERR \"%s: failed to create device (%i)\",\n\t\t\t       __func__, ret);\n\t\t\tof_node_put(child);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tof_node_put(root);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct bus_type ibmebus_bus_type;",
            "struct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstruct bus_type ibmebus_bus_type;\nstruct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};\n\nstatic int ibmebus_create_devices(const struct of_device_id *matches)\n{\n\tstruct device_node *root, *child;\n\tint ret = 0;\n\n\troot = of_find_node_by_path(\"/\");\n\n\tfor_each_child_of_node(root, child) {\n\t\tif (!of_match_node(matches, child))\n\t\t\tcontinue;\n\n\t\tif (bus_find_device(&ibmebus_bus_type, NULL, child,\n\t\t\t\t    ibmebus_match_node))\n\t\t\tcontinue;\n\n\t\tret = ibmebus_create_device(child);\n\t\tif (ret) {\n\t\t\tprintk(KERN_ERR \"%s: failed to create device (%i)\",\n\t\t\t       __func__, ret);\n\t\t\tof_node_put(child);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tof_node_put(root);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "of_find_node_by_path",
          "args": [
            "path"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"%s: %s has already been probed\\n\"",
            "__func__",
            "path"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_find_device",
          "args": [
            "&ibmebus_bus_type",
            "NULL",
            "path",
            "ibmebus_match_path"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ibmebus_chomp",
          "args": [
            "buf",
            "count"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_chomp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "246-259",
          "snippet": "static char *ibmebus_chomp(const char *in, size_t count)\n{\n\tchar *out = kmalloc(count + 1, GFP_KERNEL);\n\n\tif (!out)\n\t\treturn NULL;\n\n\tmemcpy(out, in, count);\n\tout[count] = '\\0';\n\tif (out[count - 1] == '\\n')\n\t\tout[count - 1] = '\\0';\n\n\treturn out;\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic char *ibmebus_chomp(const char *in, size_t count)\n{\n\tchar *out = kmalloc(count + 1, GFP_KERNEL);\n\n\tif (!out)\n\t\treturn NULL;\n\n\tmemcpy(out, in, count);\n\tout[count] = '\\0';\n\tif (out[count - 1] == '\\n')\n\t\tout[count - 1] = '\\0';\n\n\treturn out;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstruct bus_type ibmebus_bus_type;\nstatic BUS_ATTR(probe, S_IWUSR, NULL, ibmebus_store_probe);\nstruct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};\n\nstatic ssize_t ibmebus_store_probe(struct bus_type *bus,\n\t\t\t\t   const char *buf, size_t count)\n{\n\tstruct device_node *dn = NULL;\n\tchar *path;\n\tssize_t rc = 0;\n\n\tpath = ibmebus_chomp(buf, count);\n\tif (!path)\n\t\treturn -ENOMEM;\n\n\tif (bus_find_device(&ibmebus_bus_type, NULL, path,\n\t\t\t    ibmebus_match_path)) {\n\t\tprintk(KERN_WARNING \"%s: %s has already been probed\\n\",\n\t\t       __func__, path);\n\t\trc = -EEXIST;\n\t\tgoto out;\n\t}\n\n\tif ((dn = of_find_node_by_path(path))) {\n\t\trc = ibmebus_create_device(dn);\n\t\tof_node_put(dn);\n\t} else {\n\t\tprintk(KERN_WARNING \"%s: no such device node: %s\\n\",\n\t\t       __func__, path);\n\t\trc = -ENODEV;\n\t}\n\nout:\n\tkfree(path);\n\tif (rc)\n\t\treturn rc;\n\treturn count;\n}"
  },
  {
    "function_name": "ibmebus_chomp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "246-259",
    "snippet": "static char *ibmebus_chomp(const char *in, size_t count)\n{\n\tchar *out = kmalloc(count + 1, GFP_KERNEL);\n\n\tif (!out)\n\t\treturn NULL;\n\n\tmemcpy(out, in, count);\n\tout[count] = '\\0';\n\tif (out[count - 1] == '\\n')\n\t\tout[count - 1] = '\\0';\n\n\treturn out;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "out",
            "in",
            "count"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "_memcpy_toio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/io.c",
          "lines": "185-209",
          "snippet": "void _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "count + 1",
            "GFP_KERNEL"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic char *ibmebus_chomp(const char *in, size_t count)\n{\n\tchar *out = kmalloc(count + 1, GFP_KERNEL);\n\n\tif (!out)\n\t\treturn NULL;\n\n\tmemcpy(out, in, count);\n\tout[count] = '\\0';\n\tif (out[count - 1] == '\\n')\n\t\tout[count - 1] = '\\0';\n\n\treturn out;\n}"
  },
  {
    "function_name": "ibmebus_free_irq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "237-243",
    "snippet": "void ibmebus_free_irq(u32 ist, void *dev_id)\n{\n\tunsigned int irq = irq_find_mapping(NULL, ist);\n\n\tfree_irq(irq, dev_id);\n\tirq_dispose_mapping(irq);\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_dispose_mapping",
          "args": [
            "irq"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_irq",
          "args": [
            "irq",
            "dev_id"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_free_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "237-243",
          "snippet": "void ibmebus_free_irq(u32 ist, void *dev_id)\n{\n\tunsigned int irq = irq_find_mapping(NULL, ist);\n\n\tfree_irq(irq, dev_id);\n\tirq_dispose_mapping(irq);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "irq_find_mapping",
          "args": [
            "NULL",
            "ist"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nvoid ibmebus_free_irq(u32 ist, void *dev_id)\n{\n\tunsigned int irq = irq_find_mapping(NULL, ist);\n\n\tfree_irq(irq, dev_id);\n\tirq_dispose_mapping(irq);\n}"
  },
  {
    "function_name": "ibmebus_request_irq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "224-234",
    "snippet": "int ibmebus_request_irq(u32 ist, irq_handler_t handler,\n\t\t\tunsigned long irq_flags, const char *devname,\n\t\t\tvoid *dev_id)\n{\n\tunsigned int irq = irq_create_mapping(NULL, ist);\n\n\tif (irq == NO_IRQ)\n\t\treturn -EINVAL;\n\n\treturn request_irq(irq, handler, irq_flags, devname, dev_id);\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "request_irq",
          "args": [
            "irq",
            "handler",
            "irq_flags",
            "devname",
            "dev_id"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_request_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "224-234",
          "snippet": "int ibmebus_request_irq(u32 ist, irq_handler_t handler,\n\t\t\tunsigned long irq_flags, const char *devname,\n\t\t\tvoid *dev_id)\n{\n\tunsigned int irq = irq_create_mapping(NULL, ist);\n\n\tif (irq == NO_IRQ)\n\t\treturn -EINVAL;\n\n\treturn request_irq(irq, handler, irq_flags, devname, dev_id);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "irq_create_mapping",
          "args": [
            "NULL",
            "ist"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nint ibmebus_request_irq(u32 ist, irq_handler_t handler,\n\t\t\tunsigned long irq_flags, const char *devname,\n\t\t\tvoid *dev_id)\n{\n\tunsigned int irq = irq_create_mapping(NULL, ist);\n\n\tif (irq == NO_IRQ)\n\t\treturn -EINVAL;\n\n\treturn request_irq(irq, handler, irq_flags, devname, dev_id);\n}"
  },
  {
    "function_name": "ibmebus_unregister_driver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "218-221",
    "snippet": "void ibmebus_unregister_driver(struct platform_driver *drv)\n{\n\tdriver_unregister(&drv->driver);\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "driver_unregister",
          "args": [
            "&drv->driver"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nvoid ibmebus_unregister_driver(struct platform_driver *drv)\n{\n\tdriver_unregister(&drv->driver);\n}"
  },
  {
    "function_name": "ibmebus_register_driver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "208-215",
    "snippet": "int ibmebus_register_driver(struct platform_driver *drv)\n{\n\t/* If the driver uses devices that ibmebus doesn't know, add them */\n\tibmebus_create_devices(drv->driver.of_match_table);\n\n\tdrv->driver.bus = &ibmebus_bus_type;\n\treturn driver_register(&drv->driver);\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct bus_type ibmebus_bus_type;",
      "struct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "driver_register",
          "args": [
            "&drv->driver"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ibmebus_create_devices",
          "args": [
            "drv->driver.of_match_table"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_create_devices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "180-206",
          "snippet": "static int ibmebus_create_devices(const struct of_device_id *matches)\n{\n\tstruct device_node *root, *child;\n\tint ret = 0;\n\n\troot = of_find_node_by_path(\"/\");\n\n\tfor_each_child_of_node(root, child) {\n\t\tif (!of_match_node(matches, child))\n\t\t\tcontinue;\n\n\t\tif (bus_find_device(&ibmebus_bus_type, NULL, child,\n\t\t\t\t    ibmebus_match_node))\n\t\t\tcontinue;\n\n\t\tret = ibmebus_create_device(child);\n\t\tif (ret) {\n\t\t\tprintk(KERN_ERR \"%s: failed to create device (%i)\",\n\t\t\t       __func__, ret);\n\t\t\tof_node_put(child);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tof_node_put(root);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/ibmebus.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/of.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/dma-mapping.h>",
            "#include <linux/kobject.h>",
            "#include <linux/console.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct bus_type ibmebus_bus_type;",
            "struct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstruct bus_type ibmebus_bus_type;\nstruct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};\n\nstatic int ibmebus_create_devices(const struct of_device_id *matches)\n{\n\tstruct device_node *root, *child;\n\tint ret = 0;\n\n\troot = of_find_node_by_path(\"/\");\n\n\tfor_each_child_of_node(root, child) {\n\t\tif (!of_match_node(matches, child))\n\t\t\tcontinue;\n\n\t\tif (bus_find_device(&ibmebus_bus_type, NULL, child,\n\t\t\t\t    ibmebus_match_node))\n\t\t\tcontinue;\n\n\t\tret = ibmebus_create_device(child);\n\t\tif (ret) {\n\t\t\tprintk(KERN_ERR \"%s: failed to create device (%i)\",\n\t\t\t       __func__, ret);\n\t\t\tof_node_put(child);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tof_node_put(root);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstruct bus_type ibmebus_bus_type;\nstruct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};\n\nint ibmebus_register_driver(struct platform_driver *drv)\n{\n\t/* If the driver uses devices that ibmebus doesn't know, add them */\n\tibmebus_create_devices(drv->driver.of_match_table);\n\n\tdrv->driver.bus = &ibmebus_bus_type;\n\treturn driver_register(&drv->driver);\n}"
  },
  {
    "function_name": "ibmebus_create_devices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "180-206",
    "snippet": "static int ibmebus_create_devices(const struct of_device_id *matches)\n{\n\tstruct device_node *root, *child;\n\tint ret = 0;\n\n\troot = of_find_node_by_path(\"/\");\n\n\tfor_each_child_of_node(root, child) {\n\t\tif (!of_match_node(matches, child))\n\t\t\tcontinue;\n\n\t\tif (bus_find_device(&ibmebus_bus_type, NULL, child,\n\t\t\t\t    ibmebus_match_node))\n\t\t\tcontinue;\n\n\t\tret = ibmebus_create_device(child);\n\t\tif (ret) {\n\t\t\tprintk(KERN_ERR \"%s: failed to create device (%i)\",\n\t\t\t       __func__, ret);\n\t\t\tof_node_put(child);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tof_node_put(root);\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct bus_type ibmebus_bus_type;",
      "struct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "root"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "child"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"%s: failed to create device (%i)\"",
            "__func__",
            "ret"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ibmebus_create_device",
          "args": [
            "child"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "ibmebus_create_devices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
          "lines": "180-206",
          "snippet": "static int ibmebus_create_devices(const struct of_device_id *matches)\n{\n\tstruct device_node *root, *child;\n\tint ret = 0;\n\n\troot = of_find_node_by_path(\"/\");\n\n\tfor_each_child_of_node(root, child) {\n\t\tif (!of_match_node(matches, child))\n\t\t\tcontinue;\n\n\t\tif (bus_find_device(&ibmebus_bus_type, NULL, child,\n\t\t\t\t    ibmebus_match_node))\n\t\t\tcontinue;\n\n\t\tret = ibmebus_create_device(child);\n\t\tif (ret) {\n\t\t\tprintk(KERN_ERR \"%s: failed to create device (%i)\",\n\t\t\t       __func__, ret);\n\t\t\tof_node_put(child);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tof_node_put(root);\n\treturn ret;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "bus_find_device",
          "args": [
            "&ibmebus_bus_type",
            "NULL",
            "child",
            "ibmebus_match_node"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_match_node",
          "args": [
            "matches",
            "child"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "for_each_child_of_node",
          "args": [
            "root",
            "child"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_path",
          "args": [
            "\"/\""
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstruct bus_type ibmebus_bus_type;\nstruct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};\n\nstatic int ibmebus_create_devices(const struct of_device_id *matches)\n{\n\tstruct device_node *root, *child;\n\tint ret = 0;\n\n\troot = of_find_node_by_path(\"/\");\n\n\tfor_each_child_of_node(root, child) {\n\t\tif (!of_match_node(matches, child))\n\t\t\tcontinue;\n\n\t\tif (bus_find_device(&ibmebus_bus_type, NULL, child,\n\t\t\t\t    ibmebus_match_node))\n\t\t\tcontinue;\n\n\t\tret = ibmebus_create_device(child);\n\t\tif (ret) {\n\t\t\tprintk(KERN_ERR \"%s: failed to create device (%i)\",\n\t\t\t       __func__, ret);\n\t\t\tof_node_put(child);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tof_node_put(root);\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_create_device",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "162-178",
    "snippet": "static int ibmebus_create_device(struct device_node *dn)\n{\n\tstruct platform_device *dev;\n\tint ret;\n\n\tdev = of_device_alloc(dn, NULL, &ibmebus_bus_device);\n\tif (!dev)\n\t\treturn -ENOMEM;\n\n\tdev->dev.bus = &ibmebus_bus_type;\n\tdev->dev.archdata.dma_ops = &ibmebus_dma_ops;\n\n\tret = of_device_add(dev);\n\tif (ret)\n\t\tplatform_device_put(dev);\n\treturn ret;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct device ibmebus_bus_device = { /* fake \"parent\" device */\n\t.init_name = \"ibmebus\",\n};",
      "struct bus_type ibmebus_bus_type;",
      "static struct dma_map_ops ibmebus_dma_ops = {\n\t.alloc              = ibmebus_alloc_coherent,\n\t.free               = ibmebus_free_coherent,\n\t.map_sg             = ibmebus_map_sg,\n\t.unmap_sg           = ibmebus_unmap_sg,\n\t.dma_supported      = ibmebus_dma_supported,\n\t.get_required_mask  = ibmebus_dma_get_required_mask,\n\t.map_page           = ibmebus_map_page,\n\t.unmap_page         = ibmebus_unmap_page,\n};",
      "struct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "platform_device_put",
          "args": [
            "dev"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_device_add",
          "args": [
            "dev"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_device_alloc",
          "args": [
            "dn",
            "NULL",
            "&ibmebus_bus_device"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic struct device ibmebus_bus_device = { /* fake \"parent\" device */\n\t.init_name = \"ibmebus\",\n};\nstruct bus_type ibmebus_bus_type;\nstatic struct dma_map_ops ibmebus_dma_ops = {\n\t.alloc              = ibmebus_alloc_coherent,\n\t.free               = ibmebus_free_coherent,\n\t.map_sg             = ibmebus_map_sg,\n\t.unmap_sg           = ibmebus_unmap_sg,\n\t.dma_supported      = ibmebus_dma_supported,\n\t.get_required_mask  = ibmebus_dma_get_required_mask,\n\t.map_page           = ibmebus_map_page,\n\t.unmap_page         = ibmebus_unmap_page,\n};\nstruct bus_type ibmebus_bus_type = {\n\t.name      = \"ibmebus\",\n\t.uevent    = of_device_uevent_modalias,\n\t.bus_groups = ibmbus_bus_groups,\n\t.match     = ibmebus_bus_bus_match,\n\t.probe     = ibmebus_bus_device_probe,\n\t.remove    = ibmebus_bus_device_remove,\n\t.shutdown  = ibmebus_bus_device_shutdown,\n\t.dev_attrs = ibmebus_bus_device_attrs,\n\t.pm        = IBMEBUS_BUS_PM_OPS_PTR,\n};\n\nstatic int ibmebus_create_device(struct device_node *dn)\n{\n\tstruct platform_device *dev;\n\tint ret;\n\n\tdev = of_device_alloc(dn, NULL, &ibmebus_bus_device);\n\tif (!dev)\n\t\treturn -ENOMEM;\n\n\tdev->dev.bus = &ibmebus_bus_type;\n\tdev->dev.archdata.dma_ops = &ibmebus_dma_ops;\n\n\tret = of_device_add(dev);\n\tif (ret)\n\t\tplatform_device_put(dev);\n\treturn ret;\n}"
  },
  {
    "function_name": "ibmebus_match_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "157-160",
    "snippet": "static int ibmebus_match_node(struct device *dev, void *data)\n{\n\treturn to_platform_device(dev)->dev.of_node == data;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "to_platform_device",
          "args": [
            "dev"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_match_node(struct device *dev, void *data)\n{\n\treturn to_platform_device(dev)->dev.of_node == data;\n}"
  },
  {
    "function_name": "ibmebus_match_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "150-155",
    "snippet": "static int ibmebus_match_path(struct device *dev, void *data)\n{\n\tstruct device_node *dn = to_platform_device(dev)->dev.of_node;\n\treturn (dn->full_name &&\n\t\t(strcasecmp((char *)data, dn->full_name) == 0));\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "(char *)data",
            "dn->full_name"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_platform_device",
          "args": [
            "dev"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_match_path(struct device *dev, void *data)\n{\n\tstruct device_node *dn = to_platform_device(dev)->dev.of_node;\n\treturn (dn->full_name &&\n\t\t(strcasecmp((char *)data, dn->full_name) == 0));\n}"
  },
  {
    "function_name": "ibmebus_dma_get_required_mask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "134-137",
    "snippet": "static u64 ibmebus_dma_get_required_mask(struct device *dev)\n{\n\treturn DMA_BIT_MASK(64);\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DMA_BIT_MASK",
          "args": [
            "64"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic u64 ibmebus_dma_get_required_mask(struct device *dev)\n{\n\treturn DMA_BIT_MASK(64);\n}"
  },
  {
    "function_name": "ibmebus_dma_supported",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "129-132",
    "snippet": "static int ibmebus_dma_supported(struct device *dev, u64 mask)\n{\n\treturn mask == DMA_BIT_MASK(64);\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DMA_BIT_MASK",
          "args": [
            "64"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_dma_supported(struct device *dev, u64 mask)\n{\n\treturn mask == DMA_BIT_MASK(64);\n}"
  },
  {
    "function_name": "ibmebus_unmap_sg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "121-127",
    "snippet": "static void ibmebus_unmap_sg(struct device *dev,\n\t\t\t     struct scatterlist *sg,\n\t\t\t     int nents, enum dma_data_direction direction,\n\t\t\t     struct dma_attrs *attrs)\n{\n\treturn;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic void ibmebus_unmap_sg(struct device *dev,\n\t\t\t     struct scatterlist *sg,\n\t\t\t     int nents, enum dma_data_direction direction,\n\t\t\t     struct dma_attrs *attrs)\n{\n\treturn;\n}"
  },
  {
    "function_name": "ibmebus_map_sg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "105-119",
    "snippet": "static int ibmebus_map_sg(struct device *dev,\n\t\t\t  struct scatterlist *sgl,\n\t\t\t  int nents, enum dma_data_direction direction,\n\t\t\t  struct dma_attrs *attrs)\n{\n\tstruct scatterlist *sg;\n\tint i;\n\n\tfor_each_sg(sgl, sg, nents, i) {\n\t\tsg->dma_address = (dma_addr_t) sg_virt(sg);\n\t\tsg->dma_length = sg->length;\n\t}\n\n\treturn nents;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sg_virt",
          "args": [
            "sg"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "for_each_sg",
          "args": [
            "sgl",
            "sg",
            "nents",
            "i"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic int ibmebus_map_sg(struct device *dev,\n\t\t\t  struct scatterlist *sgl,\n\t\t\t  int nents, enum dma_data_direction direction,\n\t\t\t  struct dma_attrs *attrs)\n{\n\tstruct scatterlist *sg;\n\tint i;\n\n\tfor_each_sg(sgl, sg, nents, i) {\n\t\tsg->dma_address = (dma_addr_t) sg_virt(sg);\n\t\tsg->dma_length = sg->length;\n\t}\n\n\treturn nents;\n}"
  },
  {
    "function_name": "ibmebus_unmap_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "96-103",
    "snippet": "static void ibmebus_unmap_page(struct device *dev,\n\t\t\t       dma_addr_t dma_addr,\n\t\t\t       size_t size,\n\t\t\t       enum dma_data_direction direction,\n\t\t\t       struct dma_attrs *attrs)\n{\n\treturn;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic void ibmebus_unmap_page(struct device *dev,\n\t\t\t       dma_addr_t dma_addr,\n\t\t\t       size_t size,\n\t\t\t       enum dma_data_direction direction,\n\t\t\t       struct dma_attrs *attrs)\n{\n\treturn;\n}"
  },
  {
    "function_name": "ibmebus_map_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "86-94",
    "snippet": "static dma_addr_t ibmebus_map_page(struct device *dev,\n\t\t\t\t   struct page *page,\n\t\t\t\t   unsigned long offset,\n\t\t\t\t   size_t size,\n\t\t\t\t   enum dma_data_direction direction,\n\t\t\t\t   struct dma_attrs *attrs)\n{\n\treturn (dma_addr_t)(page_address(page) + offset);\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "page_address(page) + offset"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic dma_addr_t ibmebus_map_page(struct device *dev,\n\t\t\t\t   struct page *page,\n\t\t\t\t   unsigned long offset,\n\t\t\t\t   size_t size,\n\t\t\t\t   enum dma_data_direction direction,\n\t\t\t\t   struct dma_attrs *attrs)\n{\n\treturn (dma_addr_t)(page_address(page) + offset);\n}"
  },
  {
    "function_name": "ibmebus_free_coherent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "78-84",
    "snippet": "static void ibmebus_free_coherent(struct device *dev,\n\t\t\t\t  size_t size, void *vaddr,\n\t\t\t\t  dma_addr_t dma_handle,\n\t\t\t\t  struct dma_attrs *attrs)\n{\n\tkfree(vaddr);\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "vaddr"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic void ibmebus_free_coherent(struct device *dev,\n\t\t\t\t  size_t size, void *vaddr,\n\t\t\t\t  dma_addr_t dma_handle,\n\t\t\t\t  struct dma_attrs *attrs)\n{\n\tkfree(vaddr);\n}"
  },
  {
    "function_name": "ibmebus_alloc_coherent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/ibmebus.c",
    "lines": "64-76",
    "snippet": "static void *ibmebus_alloc_coherent(struct device *dev,\n\t\t\t\t    size_t size,\n\t\t\t\t    dma_addr_t *dma_handle,\n\t\t\t\t    gfp_t flag,\n\t\t\t\t    struct dma_attrs *attrs)\n{\n\tvoid *mem;\n\n\tmem = kmalloc(size, flag);\n\t*dma_handle = (dma_addr_t)mem;\n\n\treturn mem;\n}",
    "includes": [
      "#include <asm/ibmebus.h>",
      "#include <linux/of_platform.h>",
      "#include <linux/stat.h>",
      "#include <linux/slab.h>",
      "#include <linux/of.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/dma-mapping.h>",
      "#include <linux/kobject.h>",
      "#include <linux/console.h>",
      "#include <linux/export.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "size",
            "flag"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ibmebus.h>\n#include <linux/of_platform.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/dma-mapping.h>\n#include <linux/kobject.h>\n#include <linux/console.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstatic void *ibmebus_alloc_coherent(struct device *dev,\n\t\t\t\t    size_t size,\n\t\t\t\t    dma_addr_t *dma_handle,\n\t\t\t\t    gfp_t flag,\n\t\t\t\t    struct dma_attrs *attrs)\n{\n\tvoid *mem;\n\n\tmem = kmalloc(size, flag);\n\t*dma_handle = (dma_addr_t)mem;\n\n\treturn mem;\n}"
  }
]