[
  {
    "function_name": "disable_hardlockup_detector",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "821-826",
    "snippet": "static int __init disable_hardlockup_detector(void)\n{\n\thardlockup_detector_disable();\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hardlockup_detector_disable",
          "args": [],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic int __init disable_hardlockup_detector(void)\n{\n\thardlockup_detector_disable();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "hw_nmi_get_sample_period",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "812-815",
    "snippet": "u64 hw_nmi_get_sample_period(int watchdog_thresh)\n{\n\treturn ppc_proc_freq * watchdog_thresh;\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nu64 hw_nmi_get_sample_period(int watchdog_thresh)\n{\n\treturn ppc_proc_freq * watchdog_thresh;\n}"
  },
  {
    "function_name": "memory_block_size_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "797-803",
    "snippet": "unsigned long memory_block_size_bytes(void)\n{\n\tif (ppc_md.memory_block_size)\n\t\treturn ppc_md.memory_block_size();\n\n\treturn MIN_MEMORY_BLOCK_SIZE;\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.memory_block_size",
          "args": [],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nunsigned long memory_block_size_bytes(void)\n{\n\tif (ppc_md.memory_block_size)\n\t\treturn ppc_md.memory_block_size();\n\n\treturn MIN_MEMORY_BLOCK_SIZE;\n}"
  },
  {
    "function_name": "setup_per_cpu_areas",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "765-793",
    "snippet": "void __init setup_per_cpu_areas(void)\n{\n\tconst size_t dyn_size = PERCPU_MODULE_RESERVE + PERCPU_DYNAMIC_RESERVE;\n\tsize_t atom_size;\n\tunsigned long delta;\n\tunsigned int cpu;\n\tint rc;\n\n\t/*\n\t * Linear mapping is one of 4K, 1M and 16M.  For 4K, no need\n\t * to group units.  For larger mappings, use 1M atom which\n\t * should be large enough to contain a number of units.\n\t */\n\tif (mmu_linear_psize == MMU_PAGE_4K)\n\t\tatom_size = PAGE_SIZE;\n\telse\n\t\tatom_size = 1 << 20;\n\n\trc = pcpu_embed_first_chunk(0, dyn_size, atom_size, pcpu_cpu_distance,\n\t\t\t\t    pcpu_fc_alloc, pcpu_fc_free);\n\tif (rc < 0)\n\t\tpanic(\"cannot initialize percpu area (err=%d)\", rc);\n\n\tdelta = (unsigned long)pcpu_base_addr - (unsigned long)__per_cpu_start;\n\tfor_each_possible_cpu(cpu) {\n                __per_cpu_offset[cpu] = delta + pcpu_unit_offsets[cpu];\n\t\tpaca[cpu].data_offset = __per_cpu_offset[cpu];\n\t}\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"cannot initialize percpu area (err=%d)\"",
            "rc"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pcpu_embed_first_chunk",
          "args": [
            "0",
            "dyn_size",
            "atom_size",
            "pcpu_cpu_distance",
            "pcpu_fc_alloc",
            "pcpu_fc_free"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init setup_per_cpu_areas(void)\n{\n\tconst size_t dyn_size = PERCPU_MODULE_RESERVE + PERCPU_DYNAMIC_RESERVE;\n\tsize_t atom_size;\n\tunsigned long delta;\n\tunsigned int cpu;\n\tint rc;\n\n\t/*\n\t * Linear mapping is one of 4K, 1M and 16M.  For 4K, no need\n\t * to group units.  For larger mappings, use 1M atom which\n\t * should be large enough to contain a number of units.\n\t */\n\tif (mmu_linear_psize == MMU_PAGE_4K)\n\t\tatom_size = PAGE_SIZE;\n\telse\n\t\tatom_size = 1 << 20;\n\n\trc = pcpu_embed_first_chunk(0, dyn_size, atom_size, pcpu_cpu_distance,\n\t\t\t\t    pcpu_fc_alloc, pcpu_fc_free);\n\tif (rc < 0)\n\t\tpanic(\"cannot initialize percpu area (err=%d)\", rc);\n\n\tdelta = (unsigned long)pcpu_base_addr - (unsigned long)__per_cpu_start;\n\tfor_each_possible_cpu(cpu) {\n                __per_cpu_offset[cpu] = delta + pcpu_unit_offsets[cpu];\n\t\tpaca[cpu].data_offset = __per_cpu_offset[cpu];\n\t}\n}"
  },
  {
    "function_name": "pcpu_cpu_distance",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "754-760",
    "snippet": "static int pcpu_cpu_distance(unsigned int from, unsigned int to)\n{\n\tif (cpu_to_node(from) == cpu_to_node(to))\n\t\treturn LOCAL_DISTANCE;\n\telse\n\t\treturn REMOTE_DISTANCE;\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "to"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "from"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic int pcpu_cpu_distance(unsigned int from, unsigned int to)\n{\n\tif (cpu_to_node(from) == cpu_to_node(to))\n\t\treturn LOCAL_DISTANCE;\n\telse\n\t\treturn REMOTE_DISTANCE;\n}"
  },
  {
    "function_name": "pcpu_fc_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "749-752",
    "snippet": "static void __init pcpu_fc_free(void *ptr, size_t size)\n{\n\tfree_bootmem(__pa(ptr), size);\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_bootmem",
          "args": [
            "__pa(ptr)",
            "size"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__pa",
          "args": [
            "ptr"
          ],
          "line": 751
        },
        "resolved": true,
        "details": {
          "function_name": "__parse_fpscr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/traps.c",
          "lines": "829-854",
          "snippet": "static inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = 0;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}",
          "includes": [
            "#include <sysdev/fsl_pci.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/fadump.h>",
            "#include <asm/rio.h>",
            "#include <asm/ppc-opcode.h>",
            "#include <asm/kexec.h>",
            "#include <asm/tm.h>",
            "#include <asm/processor.h>",
            "#include <asm/firmware.h>",
            "#include <asm/backlight.h>",
            "#include <asm/reg.h>",
            "#include <asm/pmc.h>",
            "#include <asm/rtas.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/emulated_ops.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/bug.h>",
            "#include <linux/backlight.h>",
            "#include <linux/kexec.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/delay.h>",
            "#include <linux/prctl.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/user.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sysdev/fsl_pci.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/fadump.h>\n#include <asm/rio.h>\n#include <asm/ppc-opcode.h>\n#include <asm/kexec.h>\n#include <asm/tm.h>\n#include <asm/processor.h>\n#include <asm/firmware.h>\n#include <asm/backlight.h>\n#include <asm/reg.h>\n#include <asm/pmc.h>\n#include <asm/rtas.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <asm/pgtable.h>\n#include <asm/emulated_ops.h>\n#include <linux/context_tracking.h>\n#include <linux/ratelimit.h>\n#include <linux/debugfs.h>\n#include <linux/kdebug.h>\n#include <linux/bug.h>\n#include <linux/backlight.h>\n#include <linux/kexec.h>\n#include <linux/kprobes.h>\n#include <linux/delay.h>\n#include <linux/prctl.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/user.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = 0;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void __init pcpu_fc_free(void *ptr, size_t size)\n{\n\tfree_bootmem(__pa(ptr), size);\n}"
  },
  {
    "function_name": "pcpu_fc_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "743-747",
    "snippet": "static void * __init pcpu_fc_alloc(unsigned int cpu, size_t size, size_t align)\n{\n\treturn __alloc_bootmem_node(NODE_DATA(cpu_to_node(cpu)), size, align,\n\t\t\t\t    __pa(MAX_DMA_ADDRESS));\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__alloc_bootmem_node",
          "args": [
            "NODE_DATA(cpu_to_node(cpu))",
            "size",
            "align",
            "__pa(MAX_DMA_ADDRESS)"
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__pa",
          "args": [
            "MAX_DMA_ADDRESS"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "__parse_fpscr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/traps.c",
          "lines": "829-854",
          "snippet": "static inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = 0;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}",
          "includes": [
            "#include <sysdev/fsl_pci.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/fadump.h>",
            "#include <asm/rio.h>",
            "#include <asm/ppc-opcode.h>",
            "#include <asm/kexec.h>",
            "#include <asm/tm.h>",
            "#include <asm/processor.h>",
            "#include <asm/firmware.h>",
            "#include <asm/backlight.h>",
            "#include <asm/reg.h>",
            "#include <asm/pmc.h>",
            "#include <asm/rtas.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/emulated_ops.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/bug.h>",
            "#include <linux/backlight.h>",
            "#include <linux/kexec.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/delay.h>",
            "#include <linux/prctl.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/user.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sysdev/fsl_pci.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/fadump.h>\n#include <asm/rio.h>\n#include <asm/ppc-opcode.h>\n#include <asm/kexec.h>\n#include <asm/tm.h>\n#include <asm/processor.h>\n#include <asm/firmware.h>\n#include <asm/backlight.h>\n#include <asm/reg.h>\n#include <asm/pmc.h>\n#include <asm/rtas.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <asm/uaccess.h>\n#include <asm/pgtable.h>\n#include <asm/emulated_ops.h>\n#include <linux/context_tracking.h>\n#include <linux/ratelimit.h>\n#include <linux/debugfs.h>\n#include <linux/kdebug.h>\n#include <linux/bug.h>\n#include <linux/backlight.h>\n#include <linux/kexec.h>\n#include <linux/kprobes.h>\n#include <linux/delay.h>\n#include <linux/prctl.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/user.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = 0;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NODE_DATA",
          "args": [
            "cpu_to_node(cpu)"
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void * __init pcpu_fc_alloc(unsigned int cpu, size_t size, size_t align)\n{\n\treturn __alloc_bootmem_node(NODE_DATA(cpu_to_node(cpu)), size, align,\n\t\t\t\t    __pa(MAX_DMA_ADDRESS));\n}"
  },
  {
    "function_name": "setup_arch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "691-738",
    "snippet": "void __init setup_arch(char **cmdline_p)\n{\n\t*cmdline_p = boot_command_line;\n\n\t/*\n\t * Set cache line size based on type of cpu as a default.\n\t * Systems with OF can look in the properties on the cpu node(s)\n\t * for a possibly more accurate value.\n\t */\n\tdcache_bsize = ppc64_caches.dline_size;\n\ticache_bsize = ppc64_caches.iline_size;\n\n\tif (ppc_md.panic)\n\t\tsetup_panic();\n\n\tinit_mm.start_code = (unsigned long)_stext;\n\tinit_mm.end_code = (unsigned long) _etext;\n\tinit_mm.end_data = (unsigned long) _edata;\n\tinit_mm.brk = klimit;\n#ifdef CONFIG_PPC_64K_PAGES\n\tinit_mm.context.pte_frag = NULL;\n#endif\n#ifdef CONFIG_SPAPR_TCE_IOMMU\n\tmm_iommu_init(&init_mm.context);\n#endif\n\tirqstack_early_init();\n\texc_lvl_early_init();\n\temergency_stack_init();\n\n\tinitmem_init();\n\n#ifdef CONFIG_DUMMY_CONSOLE\n\tconswitchp = &dummy_con;\n#endif\n\n\tif (ppc_md.setup_arch)\n\t\tppc_md.setup_arch();\n\n\tpaging_init();\n\n\t/* Initialize the MMU context management stuff */\n\tmmu_context_init();\n\n\t/* Interrupt code needs to be 64K-aligned */\n\tif ((unsigned long)_stext & 0xffff)\n\t\tpanic(\"Kernelbase not 64K-aligned (0x%lx)!\\n\",\n\t\t      (unsigned long)_stext);\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct ppc64_caches ppc64_caches = {\n\t.dline_size = 0x40,\n\t.log_dline_size = 6,\n\t.iline_size = 0x40,\n\t.log_iline_size = 6\n};",
      "int dcache_bsize;",
      "int icache_bsize;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"Kernelbase not 64K-aligned (0x%lx)!\\n\"",
            "(unsigned long)_stext"
          ],
          "line": 736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mmu_context_init",
          "args": [],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "paging_init",
          "args": [],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.setup_arch",
          "args": [],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initmem_init",
          "args": [],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "emergency_stack_init",
          "args": [],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "emergency_stack_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "656-685",
          "snippet": "static void __init emergency_stack_init(void)\n{\n\tu64 limit;\n\tunsigned int i;\n\n\t/*\n\t * Emergency stacks must be under 256MB, we cannot afford to take\n\t * SLB misses on them. The ABI also requires them to be 128-byte\n\t * aligned.\n\t *\n\t * Since we use these as temporary stacks during secondary CPU\n\t * bringup, we need to get at them in real mode. This means they\n\t * must also be within the RMO region.\n\t */\n\tlimit = min(safe_stack_limit(), ppc64_rma_size);\n\n\tfor_each_possible_cpu(i) {\n\t\tunsigned long sp;\n\t\tsp  = memblock_alloc_base(THREAD_SIZE, THREAD_SIZE, limit);\n\t\tsp += THREAD_SIZE;\n\t\tpaca[i].emergency_sp = __va(sp);\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\t\t/* emergency stack for machine check exception handling. */\n\t\tsp  = memblock_alloc_base(THREAD_SIZE, THREAD_SIZE, limit);\n\t\tsp += THREAD_SIZE;\n\t\tpaca[i].mc_emergency_sp = __va(sp);\n#endif\n\t}\n}",
          "includes": [
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/memblock.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void __init emergency_stack_init(void)\n{\n\tu64 limit;\n\tunsigned int i;\n\n\t/*\n\t * Emergency stacks must be under 256MB, we cannot afford to take\n\t * SLB misses on them. The ABI also requires them to be 128-byte\n\t * aligned.\n\t *\n\t * Since we use these as temporary stacks during secondary CPU\n\t * bringup, we need to get at them in real mode. This means they\n\t * must also be within the RMO region.\n\t */\n\tlimit = min(safe_stack_limit(), ppc64_rma_size);\n\n\tfor_each_possible_cpu(i) {\n\t\tunsigned long sp;\n\t\tsp  = memblock_alloc_base(THREAD_SIZE, THREAD_SIZE, limit);\n\t\tsp += THREAD_SIZE;\n\t\tpaca[i].emergency_sp = __va(sp);\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\t\t/* emergency stack for machine check exception handling. */\n\t\tsp  = memblock_alloc_base(THREAD_SIZE, THREAD_SIZE, limit);\n\t\tsp += THREAD_SIZE;\n\t\tpaca[i].mc_emergency_sp = __va(sp);\n#endif\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "exc_lvl_early_init",
          "args": [],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "exc_lvl_early_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "625-646",
          "snippet": "static void __init exc_lvl_early_init(void)\n{\n\tunsigned int i;\n\tunsigned long sp;\n\n\tfor_each_possible_cpu(i) {\n\t\tsp = memblock_alloc(THREAD_SIZE, THREAD_SIZE);\n\t\tcritirq_ctx[i] = (struct thread_info *)__va(sp);\n\t\tpaca[i].crit_kstack = __va(sp + THREAD_SIZE);\n\n\t\tsp = memblock_alloc(THREAD_SIZE, THREAD_SIZE);\n\t\tdbgirq_ctx[i] = (struct thread_info *)__va(sp);\n\t\tpaca[i].dbg_kstack = __va(sp + THREAD_SIZE);\n\n\t\tsp = memblock_alloc(THREAD_SIZE, THREAD_SIZE);\n\t\tmcheckirq_ctx[i] = (struct thread_info *)__va(sp);\n\t\tpaca[i].mc_kstack = __va(sp + THREAD_SIZE);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DEBUG_LVL_EXC))\n\t\tpatch_exception(0x040, exc_debug_debug_book3e);\n}",
          "includes": [
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/memblock.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void __init exc_lvl_early_init(void)\n{\n\tunsigned int i;\n\tunsigned long sp;\n\n\tfor_each_possible_cpu(i) {\n\t\tsp = memblock_alloc(THREAD_SIZE, THREAD_SIZE);\n\t\tcritirq_ctx[i] = (struct thread_info *)__va(sp);\n\t\tpaca[i].crit_kstack = __va(sp + THREAD_SIZE);\n\n\t\tsp = memblock_alloc(THREAD_SIZE, THREAD_SIZE);\n\t\tdbgirq_ctx[i] = (struct thread_info *)__va(sp);\n\t\tpaca[i].dbg_kstack = __va(sp + THREAD_SIZE);\n\n\t\tsp = memblock_alloc(THREAD_SIZE, THREAD_SIZE);\n\t\tmcheckirq_ctx[i] = (struct thread_info *)__va(sp);\n\t\tpaca[i].mc_kstack = __va(sp + THREAD_SIZE);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DEBUG_LVL_EXC))\n\t\tpatch_exception(0x040, exc_debug_debug_book3e);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irqstack_early_init",
          "args": [],
          "line": 716
        },
        "resolved": true,
        "details": {
          "function_name": "irqstack_early_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "605-622",
          "snippet": "static void __init irqstack_early_init(void)\n{\n\tu64 limit = safe_stack_limit();\n\tunsigned int i;\n\n\t/*\n\t * Interrupt stacks must be in the first segment since we\n\t * cannot afford to take SLB misses on them.\n\t */\n\tfor_each_possible_cpu(i) {\n\t\tsoftirq_ctx[i] = (struct thread_info *)\n\t\t\t__va(memblock_alloc_base(THREAD_SIZE,\n\t\t\t\t\t    THREAD_SIZE, limit));\n\t\thardirq_ctx[i] = (struct thread_info *)\n\t\t\t__va(memblock_alloc_base(THREAD_SIZE,\n\t\t\t\t\t    THREAD_SIZE, limit));\n\t}\n}",
          "includes": [
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/memblock.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void __init irqstack_early_init(void)\n{\n\tu64 limit = safe_stack_limit();\n\tunsigned int i;\n\n\t/*\n\t * Interrupt stacks must be in the first segment since we\n\t * cannot afford to take SLB misses on them.\n\t */\n\tfor_each_possible_cpu(i) {\n\t\tsoftirq_ctx[i] = (struct thread_info *)\n\t\t\t__va(memblock_alloc_base(THREAD_SIZE,\n\t\t\t\t\t    THREAD_SIZE, limit));\n\t\thardirq_ctx[i] = (struct thread_info *)\n\t\t\t__va(memblock_alloc_base(THREAD_SIZE,\n\t\t\t\t\t    THREAD_SIZE, limit));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mm_iommu_init",
          "args": [
            "&init_mm.context"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup_panic",
          "args": [],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "setup_panic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "683-686",
          "snippet": "void __init setup_panic(void)\n{\n\tatomic_notifier_chain_register(&panic_notifier_list, &ppc_panic_block);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct notifier_block ppc_panic_block = {\n\t.notifier_call = ppc_panic_event,\n\t.priority = INT_MIN /* may not return; must be done last */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic struct notifier_block ppc_panic_block = {\n\t.notifier_call = ppc_panic_event,\n\t.priority = INT_MIN /* may not return; must be done last */\n};\n\nvoid __init setup_panic(void)\n{\n\tatomic_notifier_chain_register(&panic_notifier_list, &ppc_panic_block);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct ppc64_caches ppc64_caches = {\n\t.dline_size = 0x40,\n\t.log_dline_size = 6,\n\t.iline_size = 0x40,\n\t.log_iline_size = 6\n};\nint dcache_bsize;\nint icache_bsize;\n\nvoid __init setup_arch(char **cmdline_p)\n{\n\t*cmdline_p = boot_command_line;\n\n\t/*\n\t * Set cache line size based on type of cpu as a default.\n\t * Systems with OF can look in the properties on the cpu node(s)\n\t * for a possibly more accurate value.\n\t */\n\tdcache_bsize = ppc64_caches.dline_size;\n\ticache_bsize = ppc64_caches.iline_size;\n\n\tif (ppc_md.panic)\n\t\tsetup_panic();\n\n\tinit_mm.start_code = (unsigned long)_stext;\n\tinit_mm.end_code = (unsigned long) _etext;\n\tinit_mm.end_data = (unsigned long) _edata;\n\tinit_mm.brk = klimit;\n#ifdef CONFIG_PPC_64K_PAGES\n\tinit_mm.context.pte_frag = NULL;\n#endif\n#ifdef CONFIG_SPAPR_TCE_IOMMU\n\tmm_iommu_init(&init_mm.context);\n#endif\n\tirqstack_early_init();\n\texc_lvl_early_init();\n\temergency_stack_init();\n\n\tinitmem_init();\n\n#ifdef CONFIG_DUMMY_CONSOLE\n\tconswitchp = &dummy_con;\n#endif\n\n\tif (ppc_md.setup_arch)\n\t\tppc_md.setup_arch();\n\n\tpaging_init();\n\n\t/* Initialize the MMU context management stuff */\n\tmmu_context_init();\n\n\t/* Interrupt code needs to be 64K-aligned */\n\tif ((unsigned long)_stext & 0xffff)\n\t\tpanic(\"Kernelbase not 64K-aligned (0x%lx)!\\n\",\n\t\t      (unsigned long)_stext);\n}"
  },
  {
    "function_name": "emergency_stack_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "656-685",
    "snippet": "static void __init emergency_stack_init(void)\n{\n\tu64 limit;\n\tunsigned int i;\n\n\t/*\n\t * Emergency stacks must be under 256MB, we cannot afford to take\n\t * SLB misses on them. The ABI also requires them to be 128-byte\n\t * aligned.\n\t *\n\t * Since we use these as temporary stacks during secondary CPU\n\t * bringup, we need to get at them in real mode. This means they\n\t * must also be within the RMO region.\n\t */\n\tlimit = min(safe_stack_limit(), ppc64_rma_size);\n\n\tfor_each_possible_cpu(i) {\n\t\tunsigned long sp;\n\t\tsp  = memblock_alloc_base(THREAD_SIZE, THREAD_SIZE, limit);\n\t\tsp += THREAD_SIZE;\n\t\tpaca[i].emergency_sp = __va(sp);\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\t\t/* emergency stack for machine check exception handling. */\n\t\tsp  = memblock_alloc_base(THREAD_SIZE, THREAD_SIZE, limit);\n\t\tsp += THREAD_SIZE;\n\t\tpaca[i].mc_emergency_sp = __va(sp);\n#endif\n\t}\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "sp"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc_base",
          "args": [
            "THREAD_SIZE",
            "THREAD_SIZE",
            "limit"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "sp"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc_base",
          "args": [
            "THREAD_SIZE",
            "THREAD_SIZE",
            "limit"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "safe_stack_limit()",
            "ppc64_rma_size"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "safe_stack_limit",
          "args": [],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "safe_stack_limit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "589-603",
          "snippet": "static u64 safe_stack_limit(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\tif (mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS, the first segment is bolted */\n\tif (mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}",
          "includes": [
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/memblock.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic u64 safe_stack_limit(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\tif (mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS, the first segment is bolted */\n\tif (mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void __init emergency_stack_init(void)\n{\n\tu64 limit;\n\tunsigned int i;\n\n\t/*\n\t * Emergency stacks must be under 256MB, we cannot afford to take\n\t * SLB misses on them. The ABI also requires them to be 128-byte\n\t * aligned.\n\t *\n\t * Since we use these as temporary stacks during secondary CPU\n\t * bringup, we need to get at them in real mode. This means they\n\t * must also be within the RMO region.\n\t */\n\tlimit = min(safe_stack_limit(), ppc64_rma_size);\n\n\tfor_each_possible_cpu(i) {\n\t\tunsigned long sp;\n\t\tsp  = memblock_alloc_base(THREAD_SIZE, THREAD_SIZE, limit);\n\t\tsp += THREAD_SIZE;\n\t\tpaca[i].emergency_sp = __va(sp);\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\t\t/* emergency stack for machine check exception handling. */\n\t\tsp  = memblock_alloc_base(THREAD_SIZE, THREAD_SIZE, limit);\n\t\tsp += THREAD_SIZE;\n\t\tpaca[i].mc_emergency_sp = __va(sp);\n#endif\n\t}\n}"
  },
  {
    "function_name": "exc_lvl_early_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "625-646",
    "snippet": "static void __init exc_lvl_early_init(void)\n{\n\tunsigned int i;\n\tunsigned long sp;\n\n\tfor_each_possible_cpu(i) {\n\t\tsp = memblock_alloc(THREAD_SIZE, THREAD_SIZE);\n\t\tcritirq_ctx[i] = (struct thread_info *)__va(sp);\n\t\tpaca[i].crit_kstack = __va(sp + THREAD_SIZE);\n\n\t\tsp = memblock_alloc(THREAD_SIZE, THREAD_SIZE);\n\t\tdbgirq_ctx[i] = (struct thread_info *)__va(sp);\n\t\tpaca[i].dbg_kstack = __va(sp + THREAD_SIZE);\n\n\t\tsp = memblock_alloc(THREAD_SIZE, THREAD_SIZE);\n\t\tmcheckirq_ctx[i] = (struct thread_info *)__va(sp);\n\t\tpaca[i].mc_kstack = __va(sp + THREAD_SIZE);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DEBUG_LVL_EXC))\n\t\tpatch_exception(0x040, exc_debug_debug_book3e);\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "patch_exception",
          "args": [
            "0x040",
            "exc_debug_debug_book3e"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_DEBUG_LVL_EXC"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "sp + THREAD_SIZE"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "sp"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc",
          "args": [
            "THREAD_SIZE",
            "THREAD_SIZE"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "sp + THREAD_SIZE"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "sp"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc",
          "args": [
            "THREAD_SIZE",
            "THREAD_SIZE"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "sp + THREAD_SIZE"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "sp"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc",
          "args": [
            "THREAD_SIZE",
            "THREAD_SIZE"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void __init exc_lvl_early_init(void)\n{\n\tunsigned int i;\n\tunsigned long sp;\n\n\tfor_each_possible_cpu(i) {\n\t\tsp = memblock_alloc(THREAD_SIZE, THREAD_SIZE);\n\t\tcritirq_ctx[i] = (struct thread_info *)__va(sp);\n\t\tpaca[i].crit_kstack = __va(sp + THREAD_SIZE);\n\n\t\tsp = memblock_alloc(THREAD_SIZE, THREAD_SIZE);\n\t\tdbgirq_ctx[i] = (struct thread_info *)__va(sp);\n\t\tpaca[i].dbg_kstack = __va(sp + THREAD_SIZE);\n\n\t\tsp = memblock_alloc(THREAD_SIZE, THREAD_SIZE);\n\t\tmcheckirq_ctx[i] = (struct thread_info *)__va(sp);\n\t\tpaca[i].mc_kstack = __va(sp + THREAD_SIZE);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DEBUG_LVL_EXC))\n\t\tpatch_exception(0x040, exc_debug_debug_book3e);\n}"
  },
  {
    "function_name": "irqstack_early_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "605-622",
    "snippet": "static void __init irqstack_early_init(void)\n{\n\tu64 limit = safe_stack_limit();\n\tunsigned int i;\n\n\t/*\n\t * Interrupt stacks must be in the first segment since we\n\t * cannot afford to take SLB misses on them.\n\t */\n\tfor_each_possible_cpu(i) {\n\t\tsoftirq_ctx[i] = (struct thread_info *)\n\t\t\t__va(memblock_alloc_base(THREAD_SIZE,\n\t\t\t\t\t    THREAD_SIZE, limit));\n\t\thardirq_ctx[i] = (struct thread_info *)\n\t\t\t__va(memblock_alloc_base(THREAD_SIZE,\n\t\t\t\t\t    THREAD_SIZE, limit));\n\t}\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "memblock_alloc_base(THREAD_SIZE,\n\t\t\t\t\t    THREAD_SIZE, limit)"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc_base",
          "args": [
            "THREAD_SIZE",
            "THREAD_SIZE",
            "limit"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "memblock_alloc_base(THREAD_SIZE,\n\t\t\t\t\t    THREAD_SIZE, limit)"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc_base",
          "args": [
            "THREAD_SIZE",
            "THREAD_SIZE",
            "limit"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "safe_stack_limit",
          "args": [],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "safe_stack_limit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "589-603",
          "snippet": "static u64 safe_stack_limit(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\tif (mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS, the first segment is bolted */\n\tif (mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}",
          "includes": [
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/memblock.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic u64 safe_stack_limit(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\tif (mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS, the first segment is bolted */\n\tif (mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void __init irqstack_early_init(void)\n{\n\tu64 limit = safe_stack_limit();\n\tunsigned int i;\n\n\t/*\n\t * Interrupt stacks must be in the first segment since we\n\t * cannot afford to take SLB misses on them.\n\t */\n\tfor_each_possible_cpu(i) {\n\t\tsoftirq_ctx[i] = (struct thread_info *)\n\t\t\t__va(memblock_alloc_base(THREAD_SIZE,\n\t\t\t\t\t    THREAD_SIZE, limit));\n\t\thardirq_ctx[i] = (struct thread_info *)\n\t\t\t__va(memblock_alloc_base(THREAD_SIZE,\n\t\t\t\t\t    THREAD_SIZE, limit));\n\t}\n}"
  },
  {
    "function_name": "safe_stack_limit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "589-603",
    "snippet": "static u64 safe_stack_limit(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\tif (mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS, the first segment is bolted */\n\tif (mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mmu_has_feature",
          "args": [
            "MMU_FTR_1T_SEGMENT"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mmu_has_feature",
          "args": [
            "MMU_FTR_TYPE_FSL_E"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic u64 safe_stack_limit(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\tif (mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS, the first segment is bolted */\n\tif (mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}"
  },
  {
    "function_name": "setup_system",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "469-582",
    "snippet": "void __init setup_system(void)\n{\n\tDBG(\" -> setup_system()\\n\");\n\n\t/* Apply the CPUs-specific and firmware specific fixups to kernel\n\t * text (nop out sections not relevant to this CPU or this firmware)\n\t */\n\tdo_feature_fixups(cur_cpu_spec->cpu_features,\n\t\t\t  &__start___ftr_fixup, &__stop___ftr_fixup);\n\tdo_feature_fixups(cur_cpu_spec->mmu_features,\n\t\t\t  &__start___mmu_ftr_fixup, &__stop___mmu_ftr_fixup);\n\tdo_feature_fixups(powerpc_firmware_features,\n\t\t\t  &__start___fw_ftr_fixup, &__stop___fw_ftr_fixup);\n\tdo_lwsync_fixups(cur_cpu_spec->cpu_features,\n\t\t\t &__start___lwsync_fixup, &__stop___lwsync_fixup);\n\tdo_final_fixups();\n\n\t/*\n\t * Unflatten the device-tree passed by prom_init or kexec\n\t */\n\tunflatten_device_tree();\n\n\t/*\n\t * Fill the ppc64_caches & systemcfg structures with informations\n \t * retrieved from the device-tree.\n\t */\n\tinitialize_cache_info();\n\n#ifdef CONFIG_PPC_RTAS\n\t/*\n\t * Initialize RTAS if available\n\t */\n\trtas_initialize();\n#endif /* CONFIG_PPC_RTAS */\n\n\t/*\n\t * Check if we have an initrd provided via the device-tree\n\t */\n\tcheck_for_initrd();\n\n\t/*\n\t * Do some platform specific early initializations, that includes\n\t * setting up the hash table pointers. It also sets up some interrupt-mapping\n\t * related options that will be used by finish_device_tree()\n\t */\n\tif (ppc_md.init_early)\n\t\tppc_md.init_early();\n\n \t/*\n\t * We can discover serial ports now since the above did setup the\n\t * hash table management for us, thus ioremap works. We do that early\n\t * so that further code can be debugged\n\t */\n\tfind_legacy_serial_ports();\n\n\t/*\n\t * Register early console\n\t */\n\tregister_early_udbg_console();\n\n\t/*\n\t * Initialize xmon\n\t */\n\txmon_setup();\n\n\tsmp_setup_cpu_maps();\n\tcheck_smt_enabled();\n\tsetup_tlb_core_data();\n\n\t/*\n\t * Freescale Book3e parts spin in a loop provided by firmware,\n\t * so smp_release_cpus() does nothing for them\n\t */\n#if defined(CONFIG_SMP)\n\t/* Release secondary cpus out of their spinloops at 0x60 now that\n\t * we can map physical -> logical CPU ids\n\t */\n\tsmp_release_cpus();\n#endif\n\n\tpr_info(\"Starting Linux %s %s\\n\", init_utsname()->machine,\n\t\t init_utsname()->version);\n\n\tpr_info(\"-----------------------------------------------------\\n\");\n\tpr_info(\"ppc64_pft_size    = 0x%llx\\n\", ppc64_pft_size);\n\tpr_info(\"phys_mem_size     = 0x%llx\\n\", memblock_phys_mem_size());\n\n\tif (ppc64_caches.dline_size != 0x80)\n\t\tpr_info(\"dcache_line_size  = 0x%x\\n\", ppc64_caches.dline_size);\n\tif (ppc64_caches.iline_size != 0x80)\n\t\tpr_info(\"icache_line_size  = 0x%x\\n\", ppc64_caches.iline_size);\n\n\tpr_info(\"cpu_features      = 0x%016lx\\n\", cur_cpu_spec->cpu_features);\n\tpr_info(\"  possible        = 0x%016lx\\n\", CPU_FTRS_POSSIBLE);\n\tpr_info(\"  always          = 0x%016lx\\n\", CPU_FTRS_ALWAYS);\n\tpr_info(\"cpu_user_features = 0x%08x 0x%08x\\n\", cur_cpu_spec->cpu_user_features,\n\t\tcur_cpu_spec->cpu_user_features2);\n\tpr_info(\"mmu_features      = 0x%08x\\n\", cur_cpu_spec->mmu_features);\n\tpr_info(\"firmware_features = 0x%016lx\\n\", powerpc_firmware_features);\n\n#ifdef CONFIG_PPC_STD_MMU_64\n\tif (htab_address)\n\t\tpr_info(\"htab_address      = 0x%p\\n\", htab_address);\n\n\tpr_info(\"htab_hash_mask    = 0x%lx\\n\", htab_hash_mask);\n#endif\n\n\tif (PHYSICAL_START > 0)\n\t\tpr_info(\"physical_start    = 0x%llx\\n\",\n\t\t       (unsigned long long)PHYSICAL_START);\n\tpr_info(\"-----------------------------------------------------\\n\");\n\n\tDBG(\" <- setup_system()\\n\");\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "u64 ppc64_pft_size;",
      "struct ppc64_caches ppc64_caches = {\n\t.dline_size = 0x40,\n\t.log_dline_size = 6,\n\t.iline_size = 0x40,\n\t.log_iline_size = 6\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" <- setup_system()\\n\""
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"-----------------------------------------------------\\n\""
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"physical_start    = 0x%llx\\n\"",
            "(unsigned long long)PHYSICAL_START"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"htab_hash_mask    = 0x%lx\\n\"",
            "htab_hash_mask"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"htab_address      = 0x%p\\n\"",
            "htab_address"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"firmware_features = 0x%016lx\\n\"",
            "powerpc_firmware_features"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"mmu_features      = 0x%08x\\n\"",
            "cur_cpu_spec->mmu_features"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"cpu_user_features = 0x%08x 0x%08x\\n\"",
            "cur_cpu_spec->cpu_user_features",
            "cur_cpu_spec->cpu_user_features2"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"  always          = 0x%016lx\\n\"",
            "CPU_FTRS_ALWAYS"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"  possible        = 0x%016lx\\n\"",
            "CPU_FTRS_POSSIBLE"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"cpu_features      = 0x%016lx\\n\"",
            "cur_cpu_spec->cpu_features"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"icache_line_size  = 0x%x\\n\"",
            "ppc64_caches.iline_size"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"dcache_line_size  = 0x%x\\n\"",
            "ppc64_caches.dline_size"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"phys_mem_size     = 0x%llx\\n\"",
            "memblock_phys_mem_size()"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_phys_mem_size",
          "args": [],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"ppc64_pft_size    = 0x%llx\\n\"",
            "ppc64_pft_size"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"-----------------------------------------------------\\n\""
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Starting Linux %s %s\\n\"",
            "init_utsname()->machine",
            "init_utsname()->version"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_utsname",
          "args": [],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_utsname",
          "args": [],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_release_cpus",
          "args": [],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "smp_release_cpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "355-386",
          "snippet": "void smp_release_cpus(void)\n{\n\tunsigned long *ptr;\n\tint i;\n\n\tif (!use_spinloop())\n\t\treturn;\n\n\tDBG(\" -> smp_release_cpus()\\n\");\n\n\t/* All secondary cpus are spinning on a common spinloop, release them\n\t * all now so they can start to spin on their individual paca\n\t * spinloops. For non SMP kernels, the secondary cpus never get out\n\t * of the common spinloop.\n\t */\n\n\tptr  = (unsigned long *)((unsigned long)&__secondary_hold_spinloop\n\t\t\t- PHYSICAL_START);\n\t*ptr = ppc_function_entry(generic_secondary_smp_init);\n\n\t/* And wait a bit for them to catch up */\n\tfor (i = 0; i < 100000; i++) {\n\t\tmb();\n\t\tHMT_low();\n\t\tif (spinning_secondaries == 0)\n\t\t\tbreak;\n\t\tudelay(1);\n\t}\n\tDBG(\"spinning_secondaries = %d\\n\", spinning_secondaries);\n\n\tDBG(\" <- smp_release_cpus()\\n\");\n}",
          "includes": [
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/memblock.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int spinning_secondaries;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nint spinning_secondaries;\n\nvoid smp_release_cpus(void)\n{\n\tunsigned long *ptr;\n\tint i;\n\n\tif (!use_spinloop())\n\t\treturn;\n\n\tDBG(\" -> smp_release_cpus()\\n\");\n\n\t/* All secondary cpus are spinning on a common spinloop, release them\n\t * all now so they can start to spin on their individual paca\n\t * spinloops. For non SMP kernels, the secondary cpus never get out\n\t * of the common spinloop.\n\t */\n\n\tptr  = (unsigned long *)((unsigned long)&__secondary_hold_spinloop\n\t\t\t- PHYSICAL_START);\n\t*ptr = ppc_function_entry(generic_secondary_smp_init);\n\n\t/* And wait a bit for them to catch up */\n\tfor (i = 0; i < 100000; i++) {\n\t\tmb();\n\t\tHMT_low();\n\t\tif (spinning_secondaries == 0)\n\t\t\tbreak;\n\t\tudelay(1);\n\t}\n\tDBG(\"spinning_secondaries = %d\\n\", spinning_secondaries);\n\n\tDBG(\" <- smp_release_cpus()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup_tlb_core_data",
          "args": [],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "setup_tlb_core_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "136-138",
          "snippet": "static void setup_tlb_core_data(void)\n{\n}",
          "includes": [
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/memblock.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void setup_tlb_core_data(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_smt_enabled",
          "args": [],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "check_smt_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "146-185",
          "snippet": "static void check_smt_enabled(void)\n{\n\tstruct device_node *dn;\n\tconst char *smt_option;\n\n\t/* Default to enabling all threads */\n\tsmt_enabled_at_boot = threads_per_core;\n\n\t/* Allow the command line to overrule the OF option */\n\tif (smt_enabled_cmdline) {\n\t\tif (!strcmp(smt_enabled_cmdline, \"on\"))\n\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\telse if (!strcmp(smt_enabled_cmdline, \"off\"))\n\t\t\tsmt_enabled_at_boot = 0;\n\t\telse {\n\t\t\tint smt;\n\t\t\tint rc;\n\n\t\t\trc = kstrtoint(smt_enabled_cmdline, 10, &smt);\n\t\t\tif (!rc)\n\t\t\t\tsmt_enabled_at_boot =\n\t\t\t\t\tmin(threads_per_core, smt);\n\t\t}\n\t} else {\n\t\tdn = of_find_node_by_path(\"/options\");\n\t\tif (dn) {\n\t\t\tsmt_option = of_get_property(dn, \"ibm,smt-enabled\",\n\t\t\t\t\t\t     NULL);\n\n\t\t\tif (smt_option) {\n\t\t\t\tif (!strcmp(smt_option, \"on\"))\n\t\t\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\t\t\telse if (!strcmp(smt_option, \"off\"))\n\t\t\t\t\tsmt_enabled_at_boot = 0;\n\t\t\t}\n\n\t\t\tof_node_put(dn);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/memblock.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void check_smt_enabled(void)\n{\n\tstruct device_node *dn;\n\tconst char *smt_option;\n\n\t/* Default to enabling all threads */\n\tsmt_enabled_at_boot = threads_per_core;\n\n\t/* Allow the command line to overrule the OF option */\n\tif (smt_enabled_cmdline) {\n\t\tif (!strcmp(smt_enabled_cmdline, \"on\"))\n\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\telse if (!strcmp(smt_enabled_cmdline, \"off\"))\n\t\t\tsmt_enabled_at_boot = 0;\n\t\telse {\n\t\t\tint smt;\n\t\t\tint rc;\n\n\t\t\trc = kstrtoint(smt_enabled_cmdline, 10, &smt);\n\t\t\tif (!rc)\n\t\t\t\tsmt_enabled_at_boot =\n\t\t\t\t\tmin(threads_per_core, smt);\n\t\t}\n\t} else {\n\t\tdn = of_find_node_by_path(\"/options\");\n\t\tif (dn) {\n\t\t\tsmt_option = of_get_property(dn, \"ibm,smt-enabled\",\n\t\t\t\t\t\t     NULL);\n\n\t\t\tif (smt_option) {\n\t\t\t\tif (!strcmp(smt_option, \"on\"))\n\t\t\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\t\t\telse if (!strcmp(smt_option, \"off\"))\n\t\t\t\t\tsmt_enabled_at_boot = 0;\n\t\t\t}\n\n\t\t\tof_node_put(dn);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_setup_cpu_maps",
          "args": [],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "smp_setup_cpu_maps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "442-552",
          "snippet": "void __init smp_setup_cpu_maps(void)\n{\n\tstruct device_node *dn = NULL;\n\tint cpu = 0;\n\tint nthreads = 1;\n\n\tDBG(\"smp_setup_cpu_maps()\\n\");\n\n\twhile ((dn = of_find_node_by_type(dn, \"cpu\")) && cpu < nr_cpu_ids) {\n\t\tconst __be32 *intserv;\n\t\t__be32 cpu_be;\n\t\tint j, len;\n\n\t\tDBG(\"  * %s...\\n\", dn->full_name);\n\n\t\tintserv = of_get_property(dn, \"ibm,ppc-interrupt-server#s\",\n\t\t\t\t&len);\n\t\tif (intserv) {\n\t\t\tDBG(\"    ibm,ppc-interrupt-server#s -> %d threads\\n\",\n\t\t\t    nthreads);\n\t\t} else {\n\t\t\tDBG(\"    no ibm,ppc-interrupt-server#s -> 1 thread\\n\");\n\t\t\tintserv = of_get_property(dn, \"reg\", &len);\n\t\t\tif (!intserv) {\n\t\t\t\tcpu_be = cpu_to_be32(cpu);\n\t\t\t\tintserv = &cpu_be;\t/* assume logical == phys */\n\t\t\t\tlen = 4;\n\t\t\t}\n\t\t}\n\n\t\tnthreads = len / sizeof(int);\n\n\t\tfor (j = 0; j < nthreads && cpu < nr_cpu_ids; j++) {\n\t\t\tbool avail;\n\n\t\t\tDBG(\"    thread %d -> cpu %d (hard id %d)\\n\",\n\t\t\t    j, cpu, be32_to_cpu(intserv[j]));\n\n\t\t\tavail = of_device_is_available(dn);\n\t\t\tif (!avail)\n\t\t\t\tavail = !of_property_match_string(dn,\n\t\t\t\t\t\t\"enable-method\", \"spin-table\");\n\n\t\t\tset_cpu_present(cpu, avail);\n\t\t\tset_hard_smp_processor_id(cpu, be32_to_cpu(intserv[j]));\n\t\t\tset_cpu_possible(cpu, true);\n\t\t\tcpu++;\n\t\t}\n\t}\n\n\t/* If no SMT supported, nthreads is forced to 1 */\n\tif (!cpu_has_feature(CPU_FTR_SMT)) {\n\t\tDBG(\"  SMT disabled ! nthreads forced to 1\\n\");\n\t\tnthreads = 1;\n\t}\n\n#ifdef CONFIG_PPC64\n\t/*\n\t * On pSeries LPAR, we need to know how many cpus\n\t * could possibly be added to this partition.\n\t */\n\tif (machine_is(pseries) && firmware_has_feature(FW_FEATURE_LPAR) &&\n\t    (dn = of_find_node_by_path(\"/rtas\"))) {\n\t\tint num_addr_cell, num_size_cell, maxcpus;\n\t\tconst __be32 *ireg;\n\n\t\tnum_addr_cell = of_n_addr_cells(dn);\n\t\tnum_size_cell = of_n_size_cells(dn);\n\n\t\tireg = of_get_property(dn, \"ibm,lrdr-capacity\", NULL);\n\n\t\tif (!ireg)\n\t\t\tgoto out;\n\n\t\tmaxcpus = be32_to_cpup(ireg + num_addr_cell + num_size_cell);\n\n\t\t/* Double maxcpus for processors which have SMT capability */\n\t\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\t\tmaxcpus *= nthreads;\n\n\t\tif (maxcpus > nr_cpu_ids) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"Partition configured for %d cpus, \"\n\t\t\t       \"operating system maximum is %d.\\n\",\n\t\t\t       maxcpus, nr_cpu_ids);\n\t\t\tmaxcpus = nr_cpu_ids;\n\t\t} else\n\t\t\tprintk(KERN_INFO \"Partition configured for %d cpus.\\n\",\n\t\t\t       maxcpus);\n\n\t\tfor (cpu = 0; cpu < maxcpus; cpu++)\n\t\t\tset_cpu_possible(cpu, true);\n\tout:\n\t\tof_node_put(dn);\n\t}\n\tvdso_data->processorCount = num_present_cpus();\n#endif /* CONFIG_PPC64 */\n\n        /* Initialize CPU <=> thread mapping/\n\t *\n\t * WARNING: We assume that the number of threads is the same for\n\t * every CPU in the system. If that is not the case, then some code\n\t * here will have to be reworked\n\t */\n\tcpu_init_thread_core_maps(nthreads);\n\n\t/* Now that possible cpus are set, set nr_cpu_ids for later use */\n\tsetup_nr_cpu_ids();\n\n\tfree_unused_pacas();\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init smp_setup_cpu_maps(void)\n{\n\tstruct device_node *dn = NULL;\n\tint cpu = 0;\n\tint nthreads = 1;\n\n\tDBG(\"smp_setup_cpu_maps()\\n\");\n\n\twhile ((dn = of_find_node_by_type(dn, \"cpu\")) && cpu < nr_cpu_ids) {\n\t\tconst __be32 *intserv;\n\t\t__be32 cpu_be;\n\t\tint j, len;\n\n\t\tDBG(\"  * %s...\\n\", dn->full_name);\n\n\t\tintserv = of_get_property(dn, \"ibm,ppc-interrupt-server#s\",\n\t\t\t\t&len);\n\t\tif (intserv) {\n\t\t\tDBG(\"    ibm,ppc-interrupt-server#s -> %d threads\\n\",\n\t\t\t    nthreads);\n\t\t} else {\n\t\t\tDBG(\"    no ibm,ppc-interrupt-server#s -> 1 thread\\n\");\n\t\t\tintserv = of_get_property(dn, \"reg\", &len);\n\t\t\tif (!intserv) {\n\t\t\t\tcpu_be = cpu_to_be32(cpu);\n\t\t\t\tintserv = &cpu_be;\t/* assume logical == phys */\n\t\t\t\tlen = 4;\n\t\t\t}\n\t\t}\n\n\t\tnthreads = len / sizeof(int);\n\n\t\tfor (j = 0; j < nthreads && cpu < nr_cpu_ids; j++) {\n\t\t\tbool avail;\n\n\t\t\tDBG(\"    thread %d -> cpu %d (hard id %d)\\n\",\n\t\t\t    j, cpu, be32_to_cpu(intserv[j]));\n\n\t\t\tavail = of_device_is_available(dn);\n\t\t\tif (!avail)\n\t\t\t\tavail = !of_property_match_string(dn,\n\t\t\t\t\t\t\"enable-method\", \"spin-table\");\n\n\t\t\tset_cpu_present(cpu, avail);\n\t\t\tset_hard_smp_processor_id(cpu, be32_to_cpu(intserv[j]));\n\t\t\tset_cpu_possible(cpu, true);\n\t\t\tcpu++;\n\t\t}\n\t}\n\n\t/* If no SMT supported, nthreads is forced to 1 */\n\tif (!cpu_has_feature(CPU_FTR_SMT)) {\n\t\tDBG(\"  SMT disabled ! nthreads forced to 1\\n\");\n\t\tnthreads = 1;\n\t}\n\n#ifdef CONFIG_PPC64\n\t/*\n\t * On pSeries LPAR, we need to know how many cpus\n\t * could possibly be added to this partition.\n\t */\n\tif (machine_is(pseries) && firmware_has_feature(FW_FEATURE_LPAR) &&\n\t    (dn = of_find_node_by_path(\"/rtas\"))) {\n\t\tint num_addr_cell, num_size_cell, maxcpus;\n\t\tconst __be32 *ireg;\n\n\t\tnum_addr_cell = of_n_addr_cells(dn);\n\t\tnum_size_cell = of_n_size_cells(dn);\n\n\t\tireg = of_get_property(dn, \"ibm,lrdr-capacity\", NULL);\n\n\t\tif (!ireg)\n\t\t\tgoto out;\n\n\t\tmaxcpus = be32_to_cpup(ireg + num_addr_cell + num_size_cell);\n\n\t\t/* Double maxcpus for processors which have SMT capability */\n\t\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\t\tmaxcpus *= nthreads;\n\n\t\tif (maxcpus > nr_cpu_ids) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"Partition configured for %d cpus, \"\n\t\t\t       \"operating system maximum is %d.\\n\",\n\t\t\t       maxcpus, nr_cpu_ids);\n\t\t\tmaxcpus = nr_cpu_ids;\n\t\t} else\n\t\t\tprintk(KERN_INFO \"Partition configured for %d cpus.\\n\",\n\t\t\t       maxcpus);\n\n\t\tfor (cpu = 0; cpu < maxcpus; cpu++)\n\t\t\tset_cpu_possible(cpu, true);\n\tout:\n\t\tof_node_put(dn);\n\t}\n\tvdso_data->processorCount = num_present_cpus();\n#endif /* CONFIG_PPC64 */\n\n        /* Initialize CPU <=> thread mapping/\n\t *\n\t * WARNING: We assume that the number of threads is the same for\n\t * every CPU in the system. If that is not the case, then some code\n\t * here will have to be reworked\n\t */\n\tcpu_init_thread_core_maps(nthreads);\n\n\t/* Now that possible cpus are set, set nr_cpu_ids for later use */\n\tsetup_nr_cpu_ids();\n\n\tfree_unused_pacas();\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmon_setup",
          "args": [],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_early_udbg_console",
          "args": [],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "register_early_udbg_console",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/udbg.c",
          "lines": "162-176",
          "snippet": "void __init register_early_udbg_console(void)\n{\n\tif (early_console)\n\t\treturn;\n\n\tif (!udbg_putc)\n\t\treturn;\n\n\tif (strstr(boot_command_line, \"udbg-immortal\")) {\n\t\tprintk(KERN_INFO \"early console immortal !\\n\");\n\t\tudbg_console.flags &= ~CON_BOOT;\n\t}\n\tearly_console = &udbg_console;\n\tregister_console(&udbg_console);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/processor.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct console udbg_console = {\n\t.name\t= \"udbg\",\n\t.write\t= udbg_console_write,\n\t.flags\t= CON_PRINTBUFFER | CON_ENABLED | CON_BOOT | CON_ANYTIME,\n\t.index\t= 0,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/processor.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n#include <stdarg.h>\n\nstatic struct console udbg_console = {\n\t.name\t= \"udbg\",\n\t.write\t= udbg_console_write,\n\t.flags\t= CON_PRINTBUFFER | CON_ENABLED | CON_BOOT | CON_ANYTIME,\n\t.index\t= 0,\n};\n\nvoid __init register_early_udbg_console(void)\n{\n\tif (early_console)\n\t\treturn;\n\n\tif (!udbg_putc)\n\t\treturn;\n\n\tif (strstr(boot_command_line, \"udbg-immortal\")) {\n\t\tprintk(KERN_INFO \"early console immortal !\\n\");\n\t\tudbg_console.flags &= ~CON_BOOT;\n\t}\n\tearly_console = &udbg_console;\n\tregister_console(&udbg_console);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_legacy_serial_ports",
          "args": [],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "find_legacy_serial_ports",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/legacy_serial.c",
          "lines": "363-446",
          "snippet": "void __init find_legacy_serial_ports(void)\n{\n\tstruct device_node *np, *stdout = NULL;\n\tconst char *path;\n\tint index;\n\n\tDBG(\" -> find_legacy_serial_port()\\n\");\n\n\t/* Now find out if one of these is out firmware console */\n\tpath = of_get_property(of_chosen, \"linux,stdout-path\", NULL);\n\tif (path != NULL) {\n\t\tstdout = of_find_node_by_path(path);\n\t\tif (stdout)\n\t\t\tDBG(\"stdout is %s\\n\", stdout->full_name);\n\t} else {\n\t\tDBG(\" no linux,stdout-path !\\n\");\n\t}\n\n\t/* Iterate over all the 16550 ports, looking for known parents */\n\tfor_each_compatible_node(np, \"serial\", \"ns16550\") {\n\t\tstruct device_node *parent = of_get_parent(np);\n\t\tif (!parent)\n\t\t\tcontinue;\n\t\tif (of_match_node(legacy_serial_parents, parent) != NULL) {\n\t\t\tif (of_device_is_available(np)) {\n\t\t\t\tindex = add_legacy_soc_port(np, np);\n\t\t\t\tif (index >= 0 && np == stdout)\n\t\t\t\t\tlegacy_serial_console = index;\n\t\t\t}\n\t\t}\n\t\tof_node_put(parent);\n\t}\n\n\t/* Next, fill our array with ISA ports */\n\tfor_each_node_by_type(np, \"serial\") {\n\t\tstruct device_node *isa = of_get_parent(np);\n\t\tif (isa && (!strcmp(isa->name, \"isa\") ||\n\t\t\t    !strcmp(isa->name, \"lpc\"))) {\n\t\t\tif (of_device_is_available(np)) {\n\t\t\t\tindex = add_legacy_isa_port(np, isa);\n\t\t\t\tif (index >= 0 && np == stdout)\n\t\t\t\t\tlegacy_serial_console = index;\n\t\t\t}\n\t\t}\n\t\tof_node_put(isa);\n\t}\n\n#ifdef CONFIG_PCI\n\t/* Next, try to locate PCI ports */\n\tfor (np = NULL; (np = of_find_all_nodes(np));) {\n\t\tstruct device_node *pci, *parent = of_get_parent(np);\n\t\tif (parent && !strcmp(parent->name, \"isa\")) {\n\t\t\tof_node_put(parent);\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(np->name, \"serial\") && strcmp(np->type, \"serial\")) {\n\t\t\tof_node_put(parent);\n\t\t\tcontinue;\n\t\t}\n\t\t/* Check for known pciclass, and also check whether we have\n\t\t * a device with child nodes for ports or not\n\t\t */\n\t\tif (of_device_is_compatible(np, \"pciclass,0700\") ||\n\t\t    of_device_is_compatible(np, \"pciclass,070002\"))\n\t\t\tpci = np;\n\t\telse if (of_device_is_compatible(parent, \"pciclass,0700\") ||\n\t\t\t of_device_is_compatible(parent, \"pciclass,070002\"))\n\t\t\tpci = parent;\n\t\telse {\n\t\t\tof_node_put(parent);\n\t\t\tcontinue;\n\t\t}\n\t\tindex = add_legacy_pci_port(np, pci);\n\t\tif (index >= 0 && np == stdout)\n\t\t\tlegacy_serial_console = index;\n\t\tof_node_put(parent);\n\t}\n#endif\n\n\tDBG(\"legacy_serial_console = %d\\n\", legacy_serial_console);\n\tif (legacy_serial_console >= 0)\n\t\tsetup_legacy_serial_console(legacy_serial_console);\n\tDBG(\" <- find_legacy_serial_port()\\n\");\n}",
          "includes": [
            "#include <asm/ppc-pci.h>",
            "#include <asm/pci-bridge.h>",
            "#include <asm/udbg.h>",
            "#include <asm/serial.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/io.h>",
            "#include <linux/serial_reg.h>",
            "#include <linux/of_device.h>",
            "#include <linux/of_address.h>",
            "#include <linux/pci.h>",
            "#include <linux/console.h>",
            "#include <linux/serial_core.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct of_device_id legacy_serial_parents[] __initconst = {\n\t{.type = \"soc\",},\n\t{.type = \"tsi-bridge\",},\n\t{.type = \"opb\", },\n\t{.compatible = \"ibm,opb\",},\n\t{.compatible = \"simple-bus\",},\n\t{.compatible = \"wrs,epld-localbus\",},\n\t{},\n};",
            "static int legacy_serial_console = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ppc-pci.h>\n#include <asm/pci-bridge.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/io.h>\n#include <linux/serial_reg.h>\n#include <linux/of_device.h>\n#include <linux/of_address.h>\n#include <linux/pci.h>\n#include <linux/console.h>\n#include <linux/serial_core.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/kernel.h>\n\nstatic const struct of_device_id legacy_serial_parents[] __initconst = {\n\t{.type = \"soc\",},\n\t{.type = \"tsi-bridge\",},\n\t{.type = \"opb\", },\n\t{.compatible = \"ibm,opb\",},\n\t{.compatible = \"simple-bus\",},\n\t{.compatible = \"wrs,epld-localbus\",},\n\t{},\n};\nstatic int legacy_serial_console = -1;\n\nvoid __init find_legacy_serial_ports(void)\n{\n\tstruct device_node *np, *stdout = NULL;\n\tconst char *path;\n\tint index;\n\n\tDBG(\" -> find_legacy_serial_port()\\n\");\n\n\t/* Now find out if one of these is out firmware console */\n\tpath = of_get_property(of_chosen, \"linux,stdout-path\", NULL);\n\tif (path != NULL) {\n\t\tstdout = of_find_node_by_path(path);\n\t\tif (stdout)\n\t\t\tDBG(\"stdout is %s\\n\", stdout->full_name);\n\t} else {\n\t\tDBG(\" no linux,stdout-path !\\n\");\n\t}\n\n\t/* Iterate over all the 16550 ports, looking for known parents */\n\tfor_each_compatible_node(np, \"serial\", \"ns16550\") {\n\t\tstruct device_node *parent = of_get_parent(np);\n\t\tif (!parent)\n\t\t\tcontinue;\n\t\tif (of_match_node(legacy_serial_parents, parent) != NULL) {\n\t\t\tif (of_device_is_available(np)) {\n\t\t\t\tindex = add_legacy_soc_port(np, np);\n\t\t\t\tif (index >= 0 && np == stdout)\n\t\t\t\t\tlegacy_serial_console = index;\n\t\t\t}\n\t\t}\n\t\tof_node_put(parent);\n\t}\n\n\t/* Next, fill our array with ISA ports */\n\tfor_each_node_by_type(np, \"serial\") {\n\t\tstruct device_node *isa = of_get_parent(np);\n\t\tif (isa && (!strcmp(isa->name, \"isa\") ||\n\t\t\t    !strcmp(isa->name, \"lpc\"))) {\n\t\t\tif (of_device_is_available(np)) {\n\t\t\t\tindex = add_legacy_isa_port(np, isa);\n\t\t\t\tif (index >= 0 && np == stdout)\n\t\t\t\t\tlegacy_serial_console = index;\n\t\t\t}\n\t\t}\n\t\tof_node_put(isa);\n\t}\n\n#ifdef CONFIG_PCI\n\t/* Next, try to locate PCI ports */\n\tfor (np = NULL; (np = of_find_all_nodes(np));) {\n\t\tstruct device_node *pci, *parent = of_get_parent(np);\n\t\tif (parent && !strcmp(parent->name, \"isa\")) {\n\t\t\tof_node_put(parent);\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(np->name, \"serial\") && strcmp(np->type, \"serial\")) {\n\t\t\tof_node_put(parent);\n\t\t\tcontinue;\n\t\t}\n\t\t/* Check for known pciclass, and also check whether we have\n\t\t * a device with child nodes for ports or not\n\t\t */\n\t\tif (of_device_is_compatible(np, \"pciclass,0700\") ||\n\t\t    of_device_is_compatible(np, \"pciclass,070002\"))\n\t\t\tpci = np;\n\t\telse if (of_device_is_compatible(parent, \"pciclass,0700\") ||\n\t\t\t of_device_is_compatible(parent, \"pciclass,070002\"))\n\t\t\tpci = parent;\n\t\telse {\n\t\t\tof_node_put(parent);\n\t\t\tcontinue;\n\t\t}\n\t\tindex = add_legacy_pci_port(np, pci);\n\t\tif (index >= 0 && np == stdout)\n\t\t\tlegacy_serial_console = index;\n\t\tof_node_put(parent);\n\t}\n#endif\n\n\tDBG(\"legacy_serial_console = %d\\n\", legacy_serial_console);\n\tif (legacy_serial_console >= 0)\n\t\tsetup_legacy_serial_console(legacy_serial_console);\n\tDBG(\" <- find_legacy_serial_port()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppc_md.init_early",
          "args": [],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_for_initrd",
          "args": [],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "check_for_initrd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "370-390",
          "snippet": "void __init check_for_initrd(void)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tDBG(\" -> check_for_initrd()  initrd_start=0x%lx  initrd_end=0x%lx\\n\",\n\t    initrd_start, initrd_end);\n\n\t/* If we were passed an initrd, set the ROOT_DEV properly if the values\n\t * look sensible. If not, clear initrd reference.\n\t */\n\tif (is_kernel_addr(initrd_start) && is_kernel_addr(initrd_end) &&\n\t    initrd_end > initrd_start)\n\t\tROOT_DEV = Root_RAM0;\n\telse\n\t\tinitrd_start = initrd_end = 0;\n\n\tif (initrd_start)\n\t\tpr_info(\"Found initrd at 0x%lx:0x%lx\\n\", initrd_start, initrd_end);\n\n\tDBG(\" <- check_for_initrd()\\n\");\n#endif /* CONFIG_BLK_DEV_INITRD */\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init check_for_initrd(void)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tDBG(\" -> check_for_initrd()  initrd_start=0x%lx  initrd_end=0x%lx\\n\",\n\t    initrd_start, initrd_end);\n\n\t/* If we were passed an initrd, set the ROOT_DEV properly if the values\n\t * look sensible. If not, clear initrd reference.\n\t */\n\tif (is_kernel_addr(initrd_start) && is_kernel_addr(initrd_end) &&\n\t    initrd_end > initrd_start)\n\t\tROOT_DEV = Root_RAM0;\n\telse\n\t\tinitrd_start = initrd_end = 0;\n\n\tif (initrd_start)\n\t\tpr_info(\"Found initrd at 0x%lx:0x%lx\\n\", initrd_start, initrd_end);\n\n\tDBG(\" <- check_for_initrd()\\n\");\n#endif /* CONFIG_BLK_DEV_INITRD */\n}"
        }
      },
      {
        "call_info": {
          "callee": "rtas_initialize",
          "args": [],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "rtas_initialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/rtas.c",
          "lines": "1128-1170",
          "snippet": "void __init rtas_initialize(void)\n{\n\tunsigned long rtas_region = RTAS_INSTANTIATE_MAX;\n\n\t/* Get RTAS dev node and fill up our \"rtas\" structure with infos\n\t * about it.\n\t */\n\trtas.dev = of_find_node_by_name(NULL, \"rtas\");\n\tif (rtas.dev) {\n\t\tconst __be32 *basep, *entryp, *sizep;\n\n\t\tbasep = of_get_property(rtas.dev, \"linux,rtas-base\", NULL);\n\t\tsizep = of_get_property(rtas.dev, \"rtas-size\", NULL);\n\t\tif (basep != NULL && sizep != NULL) {\n\t\t\trtas.base = __be32_to_cpu(*basep);\n\t\t\trtas.size = __be32_to_cpu(*sizep);\n\t\t\tentryp = of_get_property(rtas.dev,\n\t\t\t\t\t\"linux,rtas-entry\", NULL);\n\t\t\tif (entryp == NULL) /* Ugh */\n\t\t\t\trtas.entry = rtas.base;\n\t\t\telse\n\t\t\t\trtas.entry = __be32_to_cpu(*entryp);\n\t\t} else\n\t\t\trtas.dev = NULL;\n\t}\n\tif (!rtas.dev)\n\t\treturn;\n\n\t/* If RTAS was found, allocate the RMO buffer for it and look for\n\t * the stop-self token if any\n\t */\n#ifdef CONFIG_PPC64\n\tif (machine_is(pseries) && firmware_has_feature(FW_FEATURE_LPAR)) {\n\t\trtas_region = min(ppc64_rma_size, RTAS_INSTANTIATE_MAX);\n\t\tibm_suspend_me_token = rtas_token(\"ibm,suspend-me\");\n\t}\n#endif\n\trtas_rmo_buf = memblock_alloc_base(RTAS_RMOBUF_MAX, PAGE_SIZE, rtas_region);\n\n#ifdef CONFIG_RTAS_ERROR_LOGGING\n\trtas_last_error_token = rtas_token(\"rtas-last-error\");\n#endif\n}",
          "includes": [
            "#include <asm/topology.h>",
            "#include <asm/mmu.h>",
            "#include <asm/time.h>",
            "#include <linux/atomic.h>",
            "#include <asm/smp.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/udbg.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/delay.h>",
            "#include <asm/param.h>",
            "#include <asm/page.h>",
            "#include <asm/firmware.h>",
            "#include <asm/machdep.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/reboot.h>",
            "#include <linux/slab.h>",
            "#include <linux/memblock.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/completion.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/delay.h>",
            "#include <linux/capability.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct rtas_t rtas = {\n\t.lock = __ARCH_SPIN_LOCK_UNLOCKED\n};",
            "unsigned long rtas_rmo_buf;",
            "static int ibm_suspend_me_token = RTAS_UNKNOWN_SERVICE;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/topology.h>\n#include <asm/mmu.h>\n#include <asm/time.h>\n#include <linux/atomic.h>\n#include <asm/smp.h>\n#include <asm/syscalls.h>\n#include <asm/udbg.h>\n#include <asm/uaccess.h>\n#include <asm/delay.h>\n#include <asm/param.h>\n#include <asm/page.h>\n#include <asm/firmware.h>\n#include <asm/machdep.h>\n#include <asm/hvcall.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/reboot.h>\n#include <linux/slab.h>\n#include <linux/memblock.h>\n#include <linux/cpumask.h>\n#include <linux/completion.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/delay.h>\n#include <linux/capability.h>\n#include <linux/init.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstruct rtas_t rtas = {\n\t.lock = __ARCH_SPIN_LOCK_UNLOCKED\n};\nunsigned long rtas_rmo_buf;\nstatic int ibm_suspend_me_token = RTAS_UNKNOWN_SERVICE;\n\nvoid __init rtas_initialize(void)\n{\n\tunsigned long rtas_region = RTAS_INSTANTIATE_MAX;\n\n\t/* Get RTAS dev node and fill up our \"rtas\" structure with infos\n\t * about it.\n\t */\n\trtas.dev = of_find_node_by_name(NULL, \"rtas\");\n\tif (rtas.dev) {\n\t\tconst __be32 *basep, *entryp, *sizep;\n\n\t\tbasep = of_get_property(rtas.dev, \"linux,rtas-base\", NULL);\n\t\tsizep = of_get_property(rtas.dev, \"rtas-size\", NULL);\n\t\tif (basep != NULL && sizep != NULL) {\n\t\t\trtas.base = __be32_to_cpu(*basep);\n\t\t\trtas.size = __be32_to_cpu(*sizep);\n\t\t\tentryp = of_get_property(rtas.dev,\n\t\t\t\t\t\"linux,rtas-entry\", NULL);\n\t\t\tif (entryp == NULL) /* Ugh */\n\t\t\t\trtas.entry = rtas.base;\n\t\t\telse\n\t\t\t\trtas.entry = __be32_to_cpu(*entryp);\n\t\t} else\n\t\t\trtas.dev = NULL;\n\t}\n\tif (!rtas.dev)\n\t\treturn;\n\n\t/* If RTAS was found, allocate the RMO buffer for it and look for\n\t * the stop-self token if any\n\t */\n#ifdef CONFIG_PPC64\n\tif (machine_is(pseries) && firmware_has_feature(FW_FEATURE_LPAR)) {\n\t\trtas_region = min(ppc64_rma_size, RTAS_INSTANTIATE_MAX);\n\t\tibm_suspend_me_token = rtas_token(\"ibm,suspend-me\");\n\t}\n#endif\n\trtas_rmo_buf = memblock_alloc_base(RTAS_RMOBUF_MAX, PAGE_SIZE, rtas_region);\n\n#ifdef CONFIG_RTAS_ERROR_LOGGING\n\trtas_last_error_token = rtas_token(\"rtas-last-error\");\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "initialize_cache_info",
          "args": [],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "initialize_cache_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "396-462",
          "snippet": "static void __init initialize_cache_info(void)\n{\n\tstruct device_node *np;\n\tunsigned long num_cpus = 0;\n\n\tDBG(\" -> initialize_cache_info()\\n\");\n\n\tfor_each_node_by_type(np, \"cpu\") {\n\t\tnum_cpus += 1;\n\n\t\t/*\n\t\t * We're assuming *all* of the CPUs have the same\n\t\t * d-cache and i-cache sizes... -Peter\n\t\t */\n\t\tif (num_cpus == 1) {\n\t\t\tconst __be32 *sizep, *lsizep;\n\t\t\tu32 size, lsize;\n\n\t\t\tsize = 0;\n\t\t\tlsize = cur_cpu_spec->dcache_bsize;\n\t\t\tsizep = of_get_property(np, \"d-cache-size\", NULL);\n\t\t\tif (sizep != NULL)\n\t\t\t\tsize = be32_to_cpu(*sizep);\n\t\t\tlsizep = of_get_property(np, \"d-cache-block-size\",\n\t\t\t\t\t\t NULL);\n\t\t\t/* fallback if block size missing */\n\t\t\tif (lsizep == NULL)\n\t\t\t\tlsizep = of_get_property(np,\n\t\t\t\t\t\t\t \"d-cache-line-size\",\n\t\t\t\t\t\t\t NULL);\n\t\t\tif (lsizep != NULL)\n\t\t\t\tlsize = be32_to_cpu(*lsizep);\n\t\t\tif (sizep == NULL || lsizep == NULL)\n\t\t\t\tDBG(\"Argh, can't find dcache properties ! \"\n\t\t\t\t    \"sizep: %p, lsizep: %p\\n\", sizep, lsizep);\n\n\t\t\tppc64_caches.dsize = size;\n\t\t\tppc64_caches.dline_size = lsize;\n\t\t\tppc64_caches.log_dline_size = __ilog2(lsize);\n\t\t\tppc64_caches.dlines_per_page = PAGE_SIZE / lsize;\n\n\t\t\tsize = 0;\n\t\t\tlsize = cur_cpu_spec->icache_bsize;\n\t\t\tsizep = of_get_property(np, \"i-cache-size\", NULL);\n\t\t\tif (sizep != NULL)\n\t\t\t\tsize = be32_to_cpu(*sizep);\n\t\t\tlsizep = of_get_property(np, \"i-cache-block-size\",\n\t\t\t\t\t\t NULL);\n\t\t\tif (lsizep == NULL)\n\t\t\t\tlsizep = of_get_property(np,\n\t\t\t\t\t\t\t \"i-cache-line-size\",\n\t\t\t\t\t\t\t NULL);\n\t\t\tif (lsizep != NULL)\n\t\t\t\tlsize = be32_to_cpu(*lsizep);\n\t\t\tif (sizep == NULL || lsizep == NULL)\n\t\t\t\tDBG(\"Argh, can't find icache properties ! \"\n\t\t\t\t    \"sizep: %p, lsizep: %p\\n\", sizep, lsizep);\n\n\t\t\tppc64_caches.isize = size;\n\t\t\tppc64_caches.iline_size = lsize;\n\t\t\tppc64_caches.log_iline_size = __ilog2(lsize);\n\t\t\tppc64_caches.ilines_per_page = PAGE_SIZE / lsize;\n\t\t}\n\t}\n\n\tDBG(\" <- initialize_cache_info()\\n\");\n}",
          "includes": [
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/memblock.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct ppc64_caches ppc64_caches = {\n\t.dline_size = 0x40,\n\t.log_dline_size = 6,\n\t.iline_size = 0x40,\n\t.log_iline_size = 6\n};",
            "int dcache_bsize;",
            "int icache_bsize;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct ppc64_caches ppc64_caches = {\n\t.dline_size = 0x40,\n\t.log_dline_size = 6,\n\t.iline_size = 0x40,\n\t.log_iline_size = 6\n};\nint dcache_bsize;\nint icache_bsize;\n\nstatic void __init initialize_cache_info(void)\n{\n\tstruct device_node *np;\n\tunsigned long num_cpus = 0;\n\n\tDBG(\" -> initialize_cache_info()\\n\");\n\n\tfor_each_node_by_type(np, \"cpu\") {\n\t\tnum_cpus += 1;\n\n\t\t/*\n\t\t * We're assuming *all* of the CPUs have the same\n\t\t * d-cache and i-cache sizes... -Peter\n\t\t */\n\t\tif (num_cpus == 1) {\n\t\t\tconst __be32 *sizep, *lsizep;\n\t\t\tu32 size, lsize;\n\n\t\t\tsize = 0;\n\t\t\tlsize = cur_cpu_spec->dcache_bsize;\n\t\t\tsizep = of_get_property(np, \"d-cache-size\", NULL);\n\t\t\tif (sizep != NULL)\n\t\t\t\tsize = be32_to_cpu(*sizep);\n\t\t\tlsizep = of_get_property(np, \"d-cache-block-size\",\n\t\t\t\t\t\t NULL);\n\t\t\t/* fallback if block size missing */\n\t\t\tif (lsizep == NULL)\n\t\t\t\tlsizep = of_get_property(np,\n\t\t\t\t\t\t\t \"d-cache-line-size\",\n\t\t\t\t\t\t\t NULL);\n\t\t\tif (lsizep != NULL)\n\t\t\t\tlsize = be32_to_cpu(*lsizep);\n\t\t\tif (sizep == NULL || lsizep == NULL)\n\t\t\t\tDBG(\"Argh, can't find dcache properties ! \"\n\t\t\t\t    \"sizep: %p, lsizep: %p\\n\", sizep, lsizep);\n\n\t\t\tppc64_caches.dsize = size;\n\t\t\tppc64_caches.dline_size = lsize;\n\t\t\tppc64_caches.log_dline_size = __ilog2(lsize);\n\t\t\tppc64_caches.dlines_per_page = PAGE_SIZE / lsize;\n\n\t\t\tsize = 0;\n\t\t\tlsize = cur_cpu_spec->icache_bsize;\n\t\t\tsizep = of_get_property(np, \"i-cache-size\", NULL);\n\t\t\tif (sizep != NULL)\n\t\t\t\tsize = be32_to_cpu(*sizep);\n\t\t\tlsizep = of_get_property(np, \"i-cache-block-size\",\n\t\t\t\t\t\t NULL);\n\t\t\tif (lsizep == NULL)\n\t\t\t\tlsizep = of_get_property(np,\n\t\t\t\t\t\t\t \"i-cache-line-size\",\n\t\t\t\t\t\t\t NULL);\n\t\t\tif (lsizep != NULL)\n\t\t\t\tlsize = be32_to_cpu(*lsizep);\n\t\t\tif (sizep == NULL || lsizep == NULL)\n\t\t\t\tDBG(\"Argh, can't find icache properties ! \"\n\t\t\t\t    \"sizep: %p, lsizep: %p\\n\", sizep, lsizep);\n\n\t\t\tppc64_caches.isize = size;\n\t\t\tppc64_caches.iline_size = lsize;\n\t\t\tppc64_caches.log_iline_size = __ilog2(lsize);\n\t\t\tppc64_caches.ilines_per_page = PAGE_SIZE / lsize;\n\t\t}\n\t}\n\n\tDBG(\" <- initialize_cache_info()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "unflatten_device_tree",
          "args": [],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_final_fixups",
          "args": [],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_lwsync_fixups",
          "args": [
            "cur_cpu_spec->cpu_features",
            "&__start___lwsync_fixup",
            "&__stop___lwsync_fixup"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_feature_fixups",
          "args": [
            "powerpc_firmware_features",
            "&__start___fw_ftr_fixup",
            "&__stop___fw_ftr_fixup"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_feature_fixups",
          "args": [
            "cur_cpu_spec->mmu_features",
            "&__start___mmu_ftr_fixup",
            "&__stop___mmu_ftr_fixup"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_feature_fixups",
          "args": [
            "cur_cpu_spec->cpu_features",
            "&__start___ftr_fixup",
            "&__stop___ftr_fixup"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" -> setup_system()\\n\""
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nu64 ppc64_pft_size;\nstruct ppc64_caches ppc64_caches = {\n\t.dline_size = 0x40,\n\t.log_dline_size = 6,\n\t.iline_size = 0x40,\n\t.log_iline_size = 6\n};\n\nvoid __init setup_system(void)\n{\n\tDBG(\" -> setup_system()\\n\");\n\n\t/* Apply the CPUs-specific and firmware specific fixups to kernel\n\t * text (nop out sections not relevant to this CPU or this firmware)\n\t */\n\tdo_feature_fixups(cur_cpu_spec->cpu_features,\n\t\t\t  &__start___ftr_fixup, &__stop___ftr_fixup);\n\tdo_feature_fixups(cur_cpu_spec->mmu_features,\n\t\t\t  &__start___mmu_ftr_fixup, &__stop___mmu_ftr_fixup);\n\tdo_feature_fixups(powerpc_firmware_features,\n\t\t\t  &__start___fw_ftr_fixup, &__stop___fw_ftr_fixup);\n\tdo_lwsync_fixups(cur_cpu_spec->cpu_features,\n\t\t\t &__start___lwsync_fixup, &__stop___lwsync_fixup);\n\tdo_final_fixups();\n\n\t/*\n\t * Unflatten the device-tree passed by prom_init or kexec\n\t */\n\tunflatten_device_tree();\n\n\t/*\n\t * Fill the ppc64_caches & systemcfg structures with informations\n \t * retrieved from the device-tree.\n\t */\n\tinitialize_cache_info();\n\n#ifdef CONFIG_PPC_RTAS\n\t/*\n\t * Initialize RTAS if available\n\t */\n\trtas_initialize();\n#endif /* CONFIG_PPC_RTAS */\n\n\t/*\n\t * Check if we have an initrd provided via the device-tree\n\t */\n\tcheck_for_initrd();\n\n\t/*\n\t * Do some platform specific early initializations, that includes\n\t * setting up the hash table pointers. It also sets up some interrupt-mapping\n\t * related options that will be used by finish_device_tree()\n\t */\n\tif (ppc_md.init_early)\n\t\tppc_md.init_early();\n\n \t/*\n\t * We can discover serial ports now since the above did setup the\n\t * hash table management for us, thus ioremap works. We do that early\n\t * so that further code can be debugged\n\t */\n\tfind_legacy_serial_ports();\n\n\t/*\n\t * Register early console\n\t */\n\tregister_early_udbg_console();\n\n\t/*\n\t * Initialize xmon\n\t */\n\txmon_setup();\n\n\tsmp_setup_cpu_maps();\n\tcheck_smt_enabled();\n\tsetup_tlb_core_data();\n\n\t/*\n\t * Freescale Book3e parts spin in a loop provided by firmware,\n\t * so smp_release_cpus() does nothing for them\n\t */\n#if defined(CONFIG_SMP)\n\t/* Release secondary cpus out of their spinloops at 0x60 now that\n\t * we can map physical -> logical CPU ids\n\t */\n\tsmp_release_cpus();\n#endif\n\n\tpr_info(\"Starting Linux %s %s\\n\", init_utsname()->machine,\n\t\t init_utsname()->version);\n\n\tpr_info(\"-----------------------------------------------------\\n\");\n\tpr_info(\"ppc64_pft_size    = 0x%llx\\n\", ppc64_pft_size);\n\tpr_info(\"phys_mem_size     = 0x%llx\\n\", memblock_phys_mem_size());\n\n\tif (ppc64_caches.dline_size != 0x80)\n\t\tpr_info(\"dcache_line_size  = 0x%x\\n\", ppc64_caches.dline_size);\n\tif (ppc64_caches.iline_size != 0x80)\n\t\tpr_info(\"icache_line_size  = 0x%x\\n\", ppc64_caches.iline_size);\n\n\tpr_info(\"cpu_features      = 0x%016lx\\n\", cur_cpu_spec->cpu_features);\n\tpr_info(\"  possible        = 0x%016lx\\n\", CPU_FTRS_POSSIBLE);\n\tpr_info(\"  always          = 0x%016lx\\n\", CPU_FTRS_ALWAYS);\n\tpr_info(\"cpu_user_features = 0x%08x 0x%08x\\n\", cur_cpu_spec->cpu_user_features,\n\t\tcur_cpu_spec->cpu_user_features2);\n\tpr_info(\"mmu_features      = 0x%08x\\n\", cur_cpu_spec->mmu_features);\n\tpr_info(\"firmware_features = 0x%016lx\\n\", powerpc_firmware_features);\n\n#ifdef CONFIG_PPC_STD_MMU_64\n\tif (htab_address)\n\t\tpr_info(\"htab_address      = 0x%p\\n\", htab_address);\n\n\tpr_info(\"htab_hash_mask    = 0x%lx\\n\", htab_hash_mask);\n#endif\n\n\tif (PHYSICAL_START > 0)\n\t\tpr_info(\"physical_start    = 0x%llx\\n\",\n\t\t       (unsigned long long)PHYSICAL_START);\n\tpr_info(\"-----------------------------------------------------\\n\");\n\n\tDBG(\" <- setup_system()\\n\");\n}"
  },
  {
    "function_name": "initialize_cache_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "396-462",
    "snippet": "static void __init initialize_cache_info(void)\n{\n\tstruct device_node *np;\n\tunsigned long num_cpus = 0;\n\n\tDBG(\" -> initialize_cache_info()\\n\");\n\n\tfor_each_node_by_type(np, \"cpu\") {\n\t\tnum_cpus += 1;\n\n\t\t/*\n\t\t * We're assuming *all* of the CPUs have the same\n\t\t * d-cache and i-cache sizes... -Peter\n\t\t */\n\t\tif (num_cpus == 1) {\n\t\t\tconst __be32 *sizep, *lsizep;\n\t\t\tu32 size, lsize;\n\n\t\t\tsize = 0;\n\t\t\tlsize = cur_cpu_spec->dcache_bsize;\n\t\t\tsizep = of_get_property(np, \"d-cache-size\", NULL);\n\t\t\tif (sizep != NULL)\n\t\t\t\tsize = be32_to_cpu(*sizep);\n\t\t\tlsizep = of_get_property(np, \"d-cache-block-size\",\n\t\t\t\t\t\t NULL);\n\t\t\t/* fallback if block size missing */\n\t\t\tif (lsizep == NULL)\n\t\t\t\tlsizep = of_get_property(np,\n\t\t\t\t\t\t\t \"d-cache-line-size\",\n\t\t\t\t\t\t\t NULL);\n\t\t\tif (lsizep != NULL)\n\t\t\t\tlsize = be32_to_cpu(*lsizep);\n\t\t\tif (sizep == NULL || lsizep == NULL)\n\t\t\t\tDBG(\"Argh, can't find dcache properties ! \"\n\t\t\t\t    \"sizep: %p, lsizep: %p\\n\", sizep, lsizep);\n\n\t\t\tppc64_caches.dsize = size;\n\t\t\tppc64_caches.dline_size = lsize;\n\t\t\tppc64_caches.log_dline_size = __ilog2(lsize);\n\t\t\tppc64_caches.dlines_per_page = PAGE_SIZE / lsize;\n\n\t\t\tsize = 0;\n\t\t\tlsize = cur_cpu_spec->icache_bsize;\n\t\t\tsizep = of_get_property(np, \"i-cache-size\", NULL);\n\t\t\tif (sizep != NULL)\n\t\t\t\tsize = be32_to_cpu(*sizep);\n\t\t\tlsizep = of_get_property(np, \"i-cache-block-size\",\n\t\t\t\t\t\t NULL);\n\t\t\tif (lsizep == NULL)\n\t\t\t\tlsizep = of_get_property(np,\n\t\t\t\t\t\t\t \"i-cache-line-size\",\n\t\t\t\t\t\t\t NULL);\n\t\t\tif (lsizep != NULL)\n\t\t\t\tlsize = be32_to_cpu(*lsizep);\n\t\t\tif (sizep == NULL || lsizep == NULL)\n\t\t\t\tDBG(\"Argh, can't find icache properties ! \"\n\t\t\t\t    \"sizep: %p, lsizep: %p\\n\", sizep, lsizep);\n\n\t\t\tppc64_caches.isize = size;\n\t\t\tppc64_caches.iline_size = lsize;\n\t\t\tppc64_caches.log_iline_size = __ilog2(lsize);\n\t\t\tppc64_caches.ilines_per_page = PAGE_SIZE / lsize;\n\t\t}\n\t}\n\n\tDBG(\" <- initialize_cache_info()\\n\");\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct ppc64_caches ppc64_caches = {\n\t.dline_size = 0x40,\n\t.log_dline_size = 6,\n\t.iline_size = 0x40,\n\t.log_iline_size = 6\n};",
      "int dcache_bsize;",
      "int icache_bsize;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" <- initialize_cache_info()\\n\""
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__ilog2",
          "args": [
            "lsize"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"Argh, can't find icache properties ! \"\n\t\t\t\t    \"sizep: %p, lsizep: %p\\n\"",
            "sizep",
            "lsizep"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*lsizep"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "\"i-cache-line-size\"",
            "NULL"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "\"i-cache-block-size\"",
            "NULL"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*sizep"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "\"i-cache-size\"",
            "NULL"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__ilog2",
          "args": [
            "lsize"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"Argh, can't find dcache properties ! \"\n\t\t\t\t    \"sizep: %p, lsizep: %p\\n\"",
            "sizep",
            "lsizep"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*lsizep"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "\"d-cache-line-size\"",
            "NULL"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "\"d-cache-block-size\"",
            "NULL"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*sizep"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "\"d-cache-size\"",
            "NULL"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "for_each_node_by_type",
          "args": [
            "np",
            "\"cpu\""
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" -> initialize_cache_info()\\n\""
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct ppc64_caches ppc64_caches = {\n\t.dline_size = 0x40,\n\t.log_dline_size = 6,\n\t.iline_size = 0x40,\n\t.log_iline_size = 6\n};\nint dcache_bsize;\nint icache_bsize;\n\nstatic void __init initialize_cache_info(void)\n{\n\tstruct device_node *np;\n\tunsigned long num_cpus = 0;\n\n\tDBG(\" -> initialize_cache_info()\\n\");\n\n\tfor_each_node_by_type(np, \"cpu\") {\n\t\tnum_cpus += 1;\n\n\t\t/*\n\t\t * We're assuming *all* of the CPUs have the same\n\t\t * d-cache and i-cache sizes... -Peter\n\t\t */\n\t\tif (num_cpus == 1) {\n\t\t\tconst __be32 *sizep, *lsizep;\n\t\t\tu32 size, lsize;\n\n\t\t\tsize = 0;\n\t\t\tlsize = cur_cpu_spec->dcache_bsize;\n\t\t\tsizep = of_get_property(np, \"d-cache-size\", NULL);\n\t\t\tif (sizep != NULL)\n\t\t\t\tsize = be32_to_cpu(*sizep);\n\t\t\tlsizep = of_get_property(np, \"d-cache-block-size\",\n\t\t\t\t\t\t NULL);\n\t\t\t/* fallback if block size missing */\n\t\t\tif (lsizep == NULL)\n\t\t\t\tlsizep = of_get_property(np,\n\t\t\t\t\t\t\t \"d-cache-line-size\",\n\t\t\t\t\t\t\t NULL);\n\t\t\tif (lsizep != NULL)\n\t\t\t\tlsize = be32_to_cpu(*lsizep);\n\t\t\tif (sizep == NULL || lsizep == NULL)\n\t\t\t\tDBG(\"Argh, can't find dcache properties ! \"\n\t\t\t\t    \"sizep: %p, lsizep: %p\\n\", sizep, lsizep);\n\n\t\t\tppc64_caches.dsize = size;\n\t\t\tppc64_caches.dline_size = lsize;\n\t\t\tppc64_caches.log_dline_size = __ilog2(lsize);\n\t\t\tppc64_caches.dlines_per_page = PAGE_SIZE / lsize;\n\n\t\t\tsize = 0;\n\t\t\tlsize = cur_cpu_spec->icache_bsize;\n\t\t\tsizep = of_get_property(np, \"i-cache-size\", NULL);\n\t\t\tif (sizep != NULL)\n\t\t\t\tsize = be32_to_cpu(*sizep);\n\t\t\tlsizep = of_get_property(np, \"i-cache-block-size\",\n\t\t\t\t\t\t NULL);\n\t\t\tif (lsizep == NULL)\n\t\t\t\tlsizep = of_get_property(np,\n\t\t\t\t\t\t\t \"i-cache-line-size\",\n\t\t\t\t\t\t\t NULL);\n\t\t\tif (lsizep != NULL)\n\t\t\t\tlsize = be32_to_cpu(*lsizep);\n\t\t\tif (sizep == NULL || lsizep == NULL)\n\t\t\t\tDBG(\"Argh, can't find icache properties ! \"\n\t\t\t\t    \"sizep: %p, lsizep: %p\\n\", sizep, lsizep);\n\n\t\t\tppc64_caches.isize = size;\n\t\t\tppc64_caches.iline_size = lsize;\n\t\t\tppc64_caches.log_iline_size = __ilog2(lsize);\n\t\t\tppc64_caches.ilines_per_page = PAGE_SIZE / lsize;\n\t\t}\n\t}\n\n\tDBG(\" <- initialize_cache_info()\\n\");\n}"
  },
  {
    "function_name": "smp_release_cpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "355-386",
    "snippet": "void smp_release_cpus(void)\n{\n\tunsigned long *ptr;\n\tint i;\n\n\tif (!use_spinloop())\n\t\treturn;\n\n\tDBG(\" -> smp_release_cpus()\\n\");\n\n\t/* All secondary cpus are spinning on a common spinloop, release them\n\t * all now so they can start to spin on their individual paca\n\t * spinloops. For non SMP kernels, the secondary cpus never get out\n\t * of the common spinloop.\n\t */\n\n\tptr  = (unsigned long *)((unsigned long)&__secondary_hold_spinloop\n\t\t\t- PHYSICAL_START);\n\t*ptr = ppc_function_entry(generic_secondary_smp_init);\n\n\t/* And wait a bit for them to catch up */\n\tfor (i = 0; i < 100000; i++) {\n\t\tmb();\n\t\tHMT_low();\n\t\tif (spinning_secondaries == 0)\n\t\t\tbreak;\n\t\tudelay(1);\n\t}\n\tDBG(\"spinning_secondaries = %d\\n\", spinning_secondaries);\n\n\tDBG(\" <- smp_release_cpus()\\n\");\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int spinning_secondaries;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" <- smp_release_cpus()\\n\""
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"spinning_secondaries = %d\\n\"",
            "spinning_secondaries"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udelay",
          "args": [
            "1"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "udelay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/time.c",
          "lines": "410-413",
          "snippet": "void udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}",
          "includes": [
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/cputime.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/clk-provider.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/clockchips.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned long tb_ticks_per_usec = 100;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/cputime.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <asm/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/clk-provider.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/clockchips.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long tb_ticks_per_usec = 100;\n\nvoid udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "HMT_low",
          "args": [],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb",
          "args": [],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_function_entry",
          "args": [
            "generic_secondary_smp_init"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" -> smp_release_cpus()\\n\""
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "use_spinloop",
          "args": [],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "use_spinloop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "343-353",
          "snippet": "static bool use_spinloop(void)\n{\n\tif (!IS_ENABLED(CONFIG_PPC_BOOK3E))\n\t\treturn true;\n\n\t/*\n\t * When book3e boots from kexec, the ePAPR spin table does\n\t * not get used.\n\t */\n\treturn of_property_read_bool(of_chosen, \"linux,booted-from-kexec\");\n}",
          "includes": [
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/memblock.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic bool use_spinloop(void)\n{\n\tif (!IS_ENABLED(CONFIG_PPC_BOOK3E))\n\t\treturn true;\n\n\t/*\n\t * When book3e boots from kexec, the ePAPR spin table does\n\t * not get used.\n\t */\n\treturn of_property_read_bool(of_chosen, \"linux,booted-from-kexec\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nint spinning_secondaries;\n\nvoid smp_release_cpus(void)\n{\n\tunsigned long *ptr;\n\tint i;\n\n\tif (!use_spinloop())\n\t\treturn;\n\n\tDBG(\" -> smp_release_cpus()\\n\");\n\n\t/* All secondary cpus are spinning on a common spinloop, release them\n\t * all now so they can start to spin on their individual paca\n\t * spinloops. For non SMP kernels, the secondary cpus never get out\n\t * of the common spinloop.\n\t */\n\n\tptr  = (unsigned long *)((unsigned long)&__secondary_hold_spinloop\n\t\t\t- PHYSICAL_START);\n\t*ptr = ppc_function_entry(generic_secondary_smp_init);\n\n\t/* And wait a bit for them to catch up */\n\tfor (i = 0; i < 100000; i++) {\n\t\tmb();\n\t\tHMT_low();\n\t\tif (spinning_secondaries == 0)\n\t\t\tbreak;\n\t\tudelay(1);\n\t}\n\tDBG(\"spinning_secondaries = %d\\n\", spinning_secondaries);\n\n\tDBG(\" <- smp_release_cpus()\\n\");\n}"
  },
  {
    "function_name": "use_spinloop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "343-353",
    "snippet": "static bool use_spinloop(void)\n{\n\tif (!IS_ENABLED(CONFIG_PPC_BOOK3E))\n\t\treturn true;\n\n\t/*\n\t * When book3e boots from kexec, the ePAPR spin table does\n\t * not get used.\n\t */\n\treturn of_property_read_bool(of_chosen, \"linux,booted-from-kexec\");\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_property_read_bool",
          "args": [
            "of_chosen",
            "\"linux,booted-from-kexec\""
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC_BOOK3E"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic bool use_spinloop(void)\n{\n\tif (!IS_ENABLED(CONFIG_PPC_BOOK3E))\n\t\treturn true;\n\n\t/*\n\t * When book3e boots from kexec, the ePAPR spin table does\n\t * not get used.\n\t */\n\treturn of_property_read_bool(of_chosen, \"linux,booted-from-kexec\");\n}"
  },
  {
    "function_name": "early_setup_secondary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "324-338",
    "snippet": "void early_setup_secondary(void)\n{\n\t/* Mark interrupts enabled in PACA */\n\tget_paca()->soft_enabled = 0;\n\n\t/* Initialize the hash table or TLB handling */\n\tearly_init_mmu_secondary();\n\n\t/*\n\t * At this point, we can let interrupts switch to virtual mode\n\t * (the MMU has been setup), so adjust the MSR in the PACA to\n\t * have IR and DR set.\n\t */\n\tcpu_ready_for_interrupts();\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_ready_for_interrupts",
          "args": [],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_ready_for_interrupts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "208-223",
          "snippet": "static void cpu_ready_for_interrupts(void)\n{\n\t/* Set IR and DR in PACA MSR */\n\tget_paca()->kernel_msr = MSR_KERNEL;\n\n\t/*\n\t * Enable AIL if supported, and we are in hypervisor mode. If we are\n\t * not in hypervisor mode, we enable relocation-on interrupts later\n\t * in pSeries_setup_arch() using the H_SET_MODE hcall.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tunsigned long lpcr = mfspr(SPRN_LPCR);\n\t\tmtspr(SPRN_LPCR, lpcr | LPCR_AIL_3);\n\t}\n}",
          "includes": [
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/memblock.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void cpu_ready_for_interrupts(void)\n{\n\t/* Set IR and DR in PACA MSR */\n\tget_paca()->kernel_msr = MSR_KERNEL;\n\n\t/*\n\t * Enable AIL if supported, and we are in hypervisor mode. If we are\n\t * not in hypervisor mode, we enable relocation-on interrupts later\n\t * in pSeries_setup_arch() using the H_SET_MODE hcall.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tunsigned long lpcr = mfspr(SPRN_LPCR);\n\t\tmtspr(SPRN_LPCR, lpcr | LPCR_AIL_3);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "early_init_mmu_secondary",
          "args": [],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid early_setup_secondary(void)\n{\n\t/* Mark interrupts enabled in PACA */\n\tget_paca()->soft_enabled = 0;\n\n\t/* Initialize the hash table or TLB handling */\n\tearly_init_mmu_secondary();\n\n\t/*\n\t * At this point, we can let interrupts switch to virtual mode\n\t * (the MMU has been setup), so adjust the MSR in the PACA to\n\t * have IR and DR set.\n\t */\n\tcpu_ready_for_interrupts();\n}"
  },
  {
    "function_name": "early_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "244-321",
    "snippet": "void __init early_setup(unsigned long dt_ptr)\n{\n\tstatic __initdata struct paca_struct boot_paca;\n\n\t/* -------- printk is _NOT_ safe to use here ! ------- */\n\n\t/* Identify CPU type */\n\tidentify_cpu(0, mfspr(SPRN_PVR));\n\n\t/* Assume we're on cpu 0 for now. Don't write to the paca yet! */\n\tinitialise_paca(&boot_paca, 0);\n\tsetup_paca(&boot_paca);\n\tfixup_boot_paca();\n\n\t/* Initialize lockdep early or else spinlocks will blow */\n\tlockdep_init();\n\n\t/* -------- printk is now safe to use ------- */\n\n\t/* Enable early debugging if any specified (see udbg.h) */\n\tudbg_early_init();\n\n \tDBG(\" -> early_setup(), dt_ptr: 0x%lx\\n\", dt_ptr);\n\n\t/*\n\t * Do early initialization using the flattened device\n\t * tree, such as retrieving the physical memory map or\n\t * calculating/retrieving the hash table size.\n\t */\n\tearly_init_devtree(__va(dt_ptr));\n\n\tepapr_paravirt_early_init();\n\n\t/* Now we know the logical id of our boot cpu, setup the paca. */\n\tsetup_paca(&paca[boot_cpuid]);\n\tfixup_boot_paca();\n\n\t/* Probe the machine type */\n\tprobe_machine();\n\n\tsetup_kdump_trampoline();\n\n\tDBG(\"Found, Initializing memory management...\\n\");\n\n\t/* Initialize the hash table or TLB handling */\n\tearly_init_mmu();\n\n\t/*\n\t * At this point, we can let interrupts switch to virtual mode\n\t * (the MMU has been setup), so adjust the MSR in the PACA to\n\t * have IR and DR set and enable AIL if it exists\n\t */\n\tcpu_ready_for_interrupts();\n\n\t/* Reserve large chunks of memory for use by CMA for KVM */\n\tkvm_cma_reserve();\n\n\t/*\n\t * Reserve any gigantic pages requested on the command line.\n\t * memblock needs to have been initialized by the time this is\n\t * called since this will reserve memory.\n\t */\n\treserve_hugetlb_gpages();\n\n\tDBG(\" <- early_setup()\\n\");\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_BOOTX\n\t/*\n\t * This needs to be done *last* (after the above DBG() even)\n\t *\n\t * Right after we return from this function, we turn on the MMU\n\t * which means the real-mode access trick that btext does will\n\t * no longer work, it needs to switch to using a real MMU\n\t * mapping. This call will ensure that it does\n\t */\n\tbtext_map();\n#endif /* CONFIG_PPC_EARLY_DEBUG_BOOTX */\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "btext_map",
          "args": [],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "btext_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/btext.c",
          "lines": "152-170",
          "snippet": "void btext_map(void)\n{\n\tunsigned long base, offset, size;\n\tunsigned char *vbase;\n\n\t/* By default, we are no longer mapped */\n\tboot_text_mapped = 0;\n\tif (dispDeviceBase == 0)\n\t\treturn;\n\tbase = ((unsigned long) dispDeviceBase) & 0xFFFFF000UL;\n\toffset = ((unsigned long) dispDeviceBase) - base;\n\tsize = dispDeviceRowBytes * dispDeviceRect[3] + offset\n\t\t+ dispDeviceRect[0];\n\tvbase = __ioremap(base, size, _PAGE_NO_CACHE);\n\tif (vbase == 0)\n\t\treturn;\n\tlogicalDisplayBase = vbase + offset;\n\tboot_text_mapped = 1;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/btext.h>",
            "#include <asm/prom.h>",
            "#include <asm/sections.h>",
            "#include <linux/memblock.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int dispDeviceRowBytes",
            "static int dispDeviceRect[4]",
            "static unsigned char *dispDeviceBase",
            "static unsigned char *logicalDisplayBase",
            "int boot_text_mapped"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/pgtable.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/btext.h>\n#include <asm/prom.h>\n#include <asm/sections.h>\n#include <linux/memblock.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int dispDeviceRowBytes;\nstatic int dispDeviceRect[4];\nstatic unsigned char *dispDeviceBase;\nstatic unsigned char *logicalDisplayBase;\nint boot_text_mapped;\n\nvoid btext_map(void)\n{\n\tunsigned long base, offset, size;\n\tunsigned char *vbase;\n\n\t/* By default, we are no longer mapped */\n\tboot_text_mapped = 0;\n\tif (dispDeviceBase == 0)\n\t\treturn;\n\tbase = ((unsigned long) dispDeviceBase) & 0xFFFFF000UL;\n\toffset = ((unsigned long) dispDeviceBase) - base;\n\tsize = dispDeviceRowBytes * dispDeviceRect[3] + offset\n\t\t+ dispDeviceRect[0];\n\tvbase = __ioremap(base, size, _PAGE_NO_CACHE);\n\tif (vbase == 0)\n\t\treturn;\n\tlogicalDisplayBase = vbase + offset;\n\tboot_text_mapped = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" <- early_setup()\\n\""
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_hugetlb_gpages",
          "args": [],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvm_cma_reserve",
          "args": [],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_ready_for_interrupts",
          "args": [],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_ready_for_interrupts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "208-223",
          "snippet": "static void cpu_ready_for_interrupts(void)\n{\n\t/* Set IR and DR in PACA MSR */\n\tget_paca()->kernel_msr = MSR_KERNEL;\n\n\t/*\n\t * Enable AIL if supported, and we are in hypervisor mode. If we are\n\t * not in hypervisor mode, we enable relocation-on interrupts later\n\t * in pSeries_setup_arch() using the H_SET_MODE hcall.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tunsigned long lpcr = mfspr(SPRN_LPCR);\n\t\tmtspr(SPRN_LPCR, lpcr | LPCR_AIL_3);\n\t}\n}",
          "includes": [
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/memblock.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void cpu_ready_for_interrupts(void)\n{\n\t/* Set IR and DR in PACA MSR */\n\tget_paca()->kernel_msr = MSR_KERNEL;\n\n\t/*\n\t * Enable AIL if supported, and we are in hypervisor mode. If we are\n\t * not in hypervisor mode, we enable relocation-on interrupts later\n\t * in pSeries_setup_arch() using the H_SET_MODE hcall.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tunsigned long lpcr = mfspr(SPRN_LPCR);\n\t\tmtspr(SPRN_LPCR, lpcr | LPCR_AIL_3);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "early_init_mmu",
          "args": [],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"Found, Initializing memory management...\\n\""
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup_kdump_trampoline",
          "args": [],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "setup_kdump_trampoline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/crash_dump.c",
          "lines": "53-69",
          "snippet": "void __init setup_kdump_trampoline(void)\n{\n\tunsigned long i;\n\n\tDBG(\" -> setup_kdump_trampoline()\\n\");\n\n\tfor (i = KDUMP_TRAMPOLINE_START; i < KDUMP_TRAMPOLINE_END; i += 8) {\n\t\tcreate_trampoline(i);\n\t}\n\n#ifdef CONFIG_PPC_PSERIES\n\tcreate_trampoline(__pa(system_reset_fwnmi) - PHYSICAL_START);\n\tcreate_trampoline(__pa(machine_check_fwnmi) - PHYSICAL_START);\n#endif /* CONFIG_PPC_PSERIES */\n\n\tDBG(\" <- setup_kdump_trampoline()\\n\");\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/rtas.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/firmware.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/code-patching.h>",
            "#include <linux/memblock.h>",
            "#include <linux/io.h>",
            "#include <linux/crash_dump.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/rtas.h>\n#include <asm/uaccess.h>\n#include <asm/firmware.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/code-patching.h>\n#include <linux/memblock.h>\n#include <linux/io.h>\n#include <linux/crash_dump.h>\n\nvoid __init setup_kdump_trampoline(void)\n{\n\tunsigned long i;\n\n\tDBG(\" -> setup_kdump_trampoline()\\n\");\n\n\tfor (i = KDUMP_TRAMPOLINE_START; i < KDUMP_TRAMPOLINE_END; i += 8) {\n\t\tcreate_trampoline(i);\n\t}\n\n#ifdef CONFIG_PPC_PSERIES\n\tcreate_trampoline(__pa(system_reset_fwnmi) - PHYSICAL_START);\n\tcreate_trampoline(__pa(machine_check_fwnmi) - PHYSICAL_START);\n#endif /* CONFIG_PPC_PSERIES */\n\n\tDBG(\" <- setup_kdump_trampoline()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "probe_machine",
          "args": [],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "probe_machine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "580-609",
          "snippet": "void probe_machine(void)\n{\n\textern struct machdep_calls __machine_desc_start;\n\textern struct machdep_calls __machine_desc_end;\n\n\t/*\n\t * Iterate all ppc_md structures until we find the proper\n\t * one for the current machine type\n\t */\n\tDBG(\"Probing machine type ...\\n\");\n\n\tfor (machine_id = &__machine_desc_start;\n\t     machine_id < &__machine_desc_end;\n\t     machine_id++) {\n\t\tDBG(\"  %s ...\", machine_id->name);\n\t\tmemcpy(&ppc_md, machine_id, sizeof(struct machdep_calls));\n\t\tif (ppc_md.probe()) {\n\t\t\tDBG(\" match !\\n\");\n\t\t\tbreak;\n\t\t}\n\t\tDBG(\"\\n\");\n\t}\n\t/* What can we do if we didn't find ? */\n\tif (machine_id >= &__machine_desc_end) {\n\t\tDBG(\"No suitable machine found !\\n\");\n\t\tfor (;;);\n\t}\n\n\tprintk(KERN_INFO \"Using %s machine description\\n\", ppc_md.name);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct machdep_calls ppc_md;",
            "struct machdep_calls *machine_id;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/debugfs.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\nstruct machdep_calls *machine_id;\n\nvoid probe_machine(void)\n{\n\textern struct machdep_calls __machine_desc_start;\n\textern struct machdep_calls __machine_desc_end;\n\n\t/*\n\t * Iterate all ppc_md structures until we find the proper\n\t * one for the current machine type\n\t */\n\tDBG(\"Probing machine type ...\\n\");\n\n\tfor (machine_id = &__machine_desc_start;\n\t     machine_id < &__machine_desc_end;\n\t     machine_id++) {\n\t\tDBG(\"  %s ...\", machine_id->name);\n\t\tmemcpy(&ppc_md, machine_id, sizeof(struct machdep_calls));\n\t\tif (ppc_md.probe()) {\n\t\t\tDBG(\" match !\\n\");\n\t\t\tbreak;\n\t\t}\n\t\tDBG(\"\\n\");\n\t}\n\t/* What can we do if we didn't find ? */\n\tif (machine_id >= &__machine_desc_end) {\n\t\tDBG(\"No suitable machine found !\\n\");\n\t\tfor (;;);\n\t}\n\n\tprintk(KERN_INFO \"Using %s machine description\\n\", ppc_md.name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fixup_boot_paca",
          "args": [],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_boot_paca",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "200-206",
          "snippet": "static void fixup_boot_paca(void)\n{\n\t/* The boot cpu is started */\n\tget_paca()->cpu_start = 1;\n\t/* Allow percpu accesses to work until we setup percpu data */\n\tget_paca()->data_offset = 0;\n}",
          "includes": [
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/memblock.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void fixup_boot_paca(void)\n{\n\t/* The boot cpu is started */\n\tget_paca()->cpu_start = 1;\n\t/* Allow percpu accesses to work until we setup percpu data */\n\tget_paca()->data_offset = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup_paca",
          "args": [
            "&paca[boot_cpuid]"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "setup_paca",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/paca.c",
          "lines": "183-201",
          "snippet": "void setup_paca(struct paca_struct *new_paca)\n{\n\t/* Setup r13 */\n\tlocal_paca = new_paca;\n\n#ifdef CONFIG_PPC_BOOK3E\n\t/* On Book3E, initialize the TLB miss exception frames */\n\tmtspr(SPRN_SPRG_TLB_EXFRAME, local_paca->extlb);\n#else\n\t/* In HV mode, we setup both HPACA and PACA to avoid problems\n\t * if we do a GET_PACA() before the feature fixups have been\n\t * applied\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE))\n\t\tmtspr(SPRN_SPRG_HPACA, local_paca);\n#endif\n\tmtspr(SPRN_SPRG_PACA, local_paca);\n\n}",
          "includes": [
            "#include <asm/kexec.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/sections.h>",
            "#include <asm/paca.h>",
            "#include <asm/lppaca.h>",
            "#include <linux/memblock.h>",
            "#include <linux/export.h>",
            "#include <linux/smp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/kexec.h>\n#include <asm/pgtable.h>\n#include <asm/sections.h>\n#include <asm/paca.h>\n#include <asm/lppaca.h>\n#include <linux/memblock.h>\n#include <linux/export.h>\n#include <linux/smp.h>\n\nvoid setup_paca(struct paca_struct *new_paca)\n{\n\t/* Setup r13 */\n\tlocal_paca = new_paca;\n\n#ifdef CONFIG_PPC_BOOK3E\n\t/* On Book3E, initialize the TLB miss exception frames */\n\tmtspr(SPRN_SPRG_TLB_EXFRAME, local_paca->extlb);\n#else\n\t/* In HV mode, we setup both HPACA and PACA to avoid problems\n\t * if we do a GET_PACA() before the feature fixups have been\n\t * applied\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE))\n\t\tmtspr(SPRN_SPRG_HPACA, local_paca);\n#endif\n\tmtspr(SPRN_SPRG_PACA, local_paca);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "epapr_paravirt_early_init",
          "args": [],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "epapr_paravirt_early_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/epapr_paravirt.c",
          "lines": "68-73",
          "snippet": "int __init epapr_paravirt_early_init(void)\n{\n\tof_scan_flat_dt(early_init_dt_scan_epapr, NULL);\n\n\treturn 0;\n}",
          "includes": [
            "#include <asm/machdep.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/cacheflush.h>",
            "#include <asm/epapr_hcalls.h>",
            "#include <linux/of_fdt.h>",
            "#include <linux/of.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/machdep.h>\n#include <asm/code-patching.h>\n#include <asm/cacheflush.h>\n#include <asm/epapr_hcalls.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n\nint __init epapr_paravirt_early_init(void)\n{\n\tof_scan_flat_dt(early_init_dt_scan_epapr, NULL);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "early_init_devtree",
          "args": [
            "__va(dt_ptr)"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "early_init_devtree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/prom.c",
          "lines": "642-738",
          "snippet": "void __init early_init_devtree(void *params)\n{\n\tphys_addr_t limit;\n\n\tDBG(\" -> early_init_devtree(%p)\\n\", params);\n\n\t/* Too early to BUG_ON(), do it by hand */\n\tif (!early_init_dt_verify(params))\n\t\tpanic(\"BUG: Failed verifying flat device tree, bad version?\");\n\n#ifdef CONFIG_PPC_RTAS\n\t/* Some machines might need RTAS info for debugging, grab it now. */\n\tof_scan_flat_dt(early_init_dt_scan_rtas, NULL);\n#endif\n\n#ifdef CONFIG_PPC_POWERNV\n\t/* Some machines might need OPAL info for debugging, grab it now. */\n\tof_scan_flat_dt(early_init_dt_scan_opal, NULL);\n#endif\n\n#ifdef CONFIG_FA_DUMP\n\t/* scan tree to see if dump is active during last boot */\n\tof_scan_flat_dt(early_init_dt_scan_fw_dump, NULL);\n#endif\n\n\t/* Retrieve various informations from the /chosen node of the\n\t * device-tree, including the platform type, initrd location and\n\t * size, TCE reserve, and more ...\n\t */\n\tof_scan_flat_dt(early_init_dt_scan_chosen_ppc, boot_command_line);\n\n\t/* Scan memory nodes and rebuild MEMBLOCKs */\n\tof_scan_flat_dt(early_init_dt_scan_root, NULL);\n\tof_scan_flat_dt(early_init_dt_scan_memory_ppc, NULL);\n\n\tparse_early_param();\n\n\t/* make sure we've parsed cmdline for mem= before this */\n\tif (memory_limit)\n\t\tfirst_memblock_size = min_t(u64, first_memblock_size, memory_limit);\n\tsetup_initial_memory_limit(memstart_addr, first_memblock_size);\n\t/* Reserve MEMBLOCK regions used by kernel, initrd, dt, etc... */\n\tmemblock_reserve(PHYSICAL_START, __pa(klimit) - PHYSICAL_START);\n\t/* If relocatable, reserve first 32k for interrupt vectors etc. */\n\tif (PHYSICAL_START > MEMORY_START)\n\t\tmemblock_reserve(MEMORY_START, 0x8000);\n\treserve_kdump_trampoline();\n#ifdef CONFIG_FA_DUMP\n\t/*\n\t * If we fail to reserve memory for firmware-assisted dump then\n\t * fallback to kexec based kdump.\n\t */\n\tif (fadump_reserve_mem() == 0)\n#endif\n\t\treserve_crashkernel();\n\tearly_reserve_mem();\n\n\t/* Ensure that total memory size is page-aligned. */\n\tlimit = ALIGN(memory_limit ?: memblock_phys_mem_size(), PAGE_SIZE);\n\tmemblock_enforce_memory_limit(limit);\n\n\tmemblock_allow_resize();\n\tmemblock_dump_all();\n\n\tDBG(\"Phys. mem: %llx\\n\", memblock_phys_mem_size());\n\n\t/* We may need to relocate the flat tree, do it now.\n\t * FIXME .. and the initrd too? */\n\tmove_device_tree();\n\n\tallocate_pacas();\n\n\tDBG(\"Scanning CPUs ...\\n\");\n\n\t/* Retrieve CPU related informations from the flat tree\n\t * (altivec support, boot CPU ID, ...)\n\t */\n\tof_scan_flat_dt(early_init_dt_scan_cpus, NULL);\n\tif (boot_cpuid < 0) {\n\t\tprintk(\"Failed to identify boot CPU !\\n\");\n\t\tBUG();\n\t}\n\n#if defined(CONFIG_SMP) && defined(CONFIG_PPC64)\n\t/* We'll later wait for secondaries to check in; there are\n\t * NCPUS-1 non-boot CPUs  :-)\n\t */\n\tspinning_secondaries = boot_cpu_count - 1;\n#endif\n\n#ifdef CONFIG_PPC_POWERNV\n\t/* Scan and build the list of machine check recoverable ranges */\n\tof_scan_flat_dt(early_init_dt_scan_recoverable_ranges, NULL);\n#endif\n\n\tDBG(\" <- early_init_devtree()\\n\");\n}",
          "includes": [
            "#include <mm/mmu_decl.h>",
            "#include <asm/debug.h>",
            "#include <asm/fadump.h>",
            "#include <asm/opal.h>",
            "#include <asm/kexec.h>",
            "#include <asm/pci-bridge.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/paca.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/of_fdt.h>",
            "#include <linux/of.h>",
            "#include <linux/memblock.h>",
            "#include <linux/irq.h>",
            "#include <linux/kexec.h>",
            "#include <linux/export.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/stringify.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static phys_addr_t first_memblock_size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <mm/mmu_decl.h>\n#include <asm/debug.h>\n#include <asm/fadump.h>\n#include <asm/opal.h>\n#include <asm/kexec.h>\n#include <asm/pci-bridge.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/pgtable.h>\n#include <asm/paca.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/libfdt.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/memblock.h>\n#include <linux/irq.h>\n#include <linux/kexec.h>\n#include <linux/export.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/stringify.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic phys_addr_t first_memblock_size;\n\nvoid __init early_init_devtree(void *params)\n{\n\tphys_addr_t limit;\n\n\tDBG(\" -> early_init_devtree(%p)\\n\", params);\n\n\t/* Too early to BUG_ON(), do it by hand */\n\tif (!early_init_dt_verify(params))\n\t\tpanic(\"BUG: Failed verifying flat device tree, bad version?\");\n\n#ifdef CONFIG_PPC_RTAS\n\t/* Some machines might need RTAS info for debugging, grab it now. */\n\tof_scan_flat_dt(early_init_dt_scan_rtas, NULL);\n#endif\n\n#ifdef CONFIG_PPC_POWERNV\n\t/* Some machines might need OPAL info for debugging, grab it now. */\n\tof_scan_flat_dt(early_init_dt_scan_opal, NULL);\n#endif\n\n#ifdef CONFIG_FA_DUMP\n\t/* scan tree to see if dump is active during last boot */\n\tof_scan_flat_dt(early_init_dt_scan_fw_dump, NULL);\n#endif\n\n\t/* Retrieve various informations from the /chosen node of the\n\t * device-tree, including the platform type, initrd location and\n\t * size, TCE reserve, and more ...\n\t */\n\tof_scan_flat_dt(early_init_dt_scan_chosen_ppc, boot_command_line);\n\n\t/* Scan memory nodes and rebuild MEMBLOCKs */\n\tof_scan_flat_dt(early_init_dt_scan_root, NULL);\n\tof_scan_flat_dt(early_init_dt_scan_memory_ppc, NULL);\n\n\tparse_early_param();\n\n\t/* make sure we've parsed cmdline for mem= before this */\n\tif (memory_limit)\n\t\tfirst_memblock_size = min_t(u64, first_memblock_size, memory_limit);\n\tsetup_initial_memory_limit(memstart_addr, first_memblock_size);\n\t/* Reserve MEMBLOCK regions used by kernel, initrd, dt, etc... */\n\tmemblock_reserve(PHYSICAL_START, __pa(klimit) - PHYSICAL_START);\n\t/* If relocatable, reserve first 32k for interrupt vectors etc. */\n\tif (PHYSICAL_START > MEMORY_START)\n\t\tmemblock_reserve(MEMORY_START, 0x8000);\n\treserve_kdump_trampoline();\n#ifdef CONFIG_FA_DUMP\n\t/*\n\t * If we fail to reserve memory for firmware-assisted dump then\n\t * fallback to kexec based kdump.\n\t */\n\tif (fadump_reserve_mem() == 0)\n#endif\n\t\treserve_crashkernel();\n\tearly_reserve_mem();\n\n\t/* Ensure that total memory size is page-aligned. */\n\tlimit = ALIGN(memory_limit ?: memblock_phys_mem_size(), PAGE_SIZE);\n\tmemblock_enforce_memory_limit(limit);\n\n\tmemblock_allow_resize();\n\tmemblock_dump_all();\n\n\tDBG(\"Phys. mem: %llx\\n\", memblock_phys_mem_size());\n\n\t/* We may need to relocate the flat tree, do it now.\n\t * FIXME .. and the initrd too? */\n\tmove_device_tree();\n\n\tallocate_pacas();\n\n\tDBG(\"Scanning CPUs ...\\n\");\n\n\t/* Retrieve CPU related informations from the flat tree\n\t * (altivec support, boot CPU ID, ...)\n\t */\n\tof_scan_flat_dt(early_init_dt_scan_cpus, NULL);\n\tif (boot_cpuid < 0) {\n\t\tprintk(\"Failed to identify boot CPU !\\n\");\n\t\tBUG();\n\t}\n\n#if defined(CONFIG_SMP) && defined(CONFIG_PPC64)\n\t/* We'll later wait for secondaries to check in; there are\n\t * NCPUS-1 non-boot CPUs  :-)\n\t */\n\tspinning_secondaries = boot_cpu_count - 1;\n#endif\n\n#ifdef CONFIG_PPC_POWERNV\n\t/* Scan and build the list of machine check recoverable ranges */\n\tof_scan_flat_dt(early_init_dt_scan_recoverable_ranges, NULL);\n#endif\n\n\tDBG(\" <- early_init_devtree()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "dt_ptr"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\" -> early_setup(), dt_ptr: 0x%lx\\n\"",
            "dt_ptr"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udbg_early_init",
          "args": [],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_early_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/udbg.c",
          "lines": "29-81",
          "snippet": "void __init udbg_early_init(void)\n{\n#if defined(CONFIG_PPC_EARLY_DEBUG_LPAR)\n\t/* For LPAR machines that have an HVC console on vterm 0 */\n\tudbg_init_debug_lpar();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_LPAR_HVSI)\n\t/* For LPAR machines that have an HVSI console on vterm 0 */\n\tudbg_init_debug_lpar_hvsi();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_G5)\n\t/* For use on Apple G5 machines */\n\tudbg_init_pmac_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_RTAS_PANEL)\n\t/* RTAS panel debug */\n\tudbg_init_rtas_panel();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_RTAS_CONSOLE)\n\t/* RTAS console debug */\n\tudbg_init_rtas_console();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_MAPLE)\n\t/* Maple real mode debug */\n\tudbg_init_maple_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_PAS_REALMODE)\n\tudbg_init_pas_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_BOOTX)\n\tudbg_init_btext();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_44x)\n\t/* PPC44x debug */\n\tudbg_init_44x_as1();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_40x)\n\t/* PPC40x debug */\n\tudbg_init_40x_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_CPM)\n\tudbg_init_cpm();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_USBGECKO)\n\tudbg_init_usbgecko();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_MEMCONS)\n\t/* In memory console */\n\tudbg_init_memcons();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_EHV_BC)\n\tudbg_init_ehv_bc();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_PS3GELIC)\n\tudbg_init_ps3gelic();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_OPAL_RAW)\n\tudbg_init_debug_opal_raw();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_OPAL_HVSI)\n\tudbg_init_debug_opal_hvsi();\n#endif\n\n#ifdef CONFIG_PPC_EARLY_DEBUG\n\tconsole_loglevel = 10;\n\n\tregister_early_udbg_console();\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/processor.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/processor.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n#include <stdarg.h>\n\nvoid __init udbg_early_init(void)\n{\n#if defined(CONFIG_PPC_EARLY_DEBUG_LPAR)\n\t/* For LPAR machines that have an HVC console on vterm 0 */\n\tudbg_init_debug_lpar();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_LPAR_HVSI)\n\t/* For LPAR machines that have an HVSI console on vterm 0 */\n\tudbg_init_debug_lpar_hvsi();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_G5)\n\t/* For use on Apple G5 machines */\n\tudbg_init_pmac_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_RTAS_PANEL)\n\t/* RTAS panel debug */\n\tudbg_init_rtas_panel();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_RTAS_CONSOLE)\n\t/* RTAS console debug */\n\tudbg_init_rtas_console();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_MAPLE)\n\t/* Maple real mode debug */\n\tudbg_init_maple_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_PAS_REALMODE)\n\tudbg_init_pas_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_BOOTX)\n\tudbg_init_btext();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_44x)\n\t/* PPC44x debug */\n\tudbg_init_44x_as1();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_40x)\n\t/* PPC40x debug */\n\tudbg_init_40x_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_CPM)\n\tudbg_init_cpm();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_USBGECKO)\n\tudbg_init_usbgecko();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_MEMCONS)\n\t/* In memory console */\n\tudbg_init_memcons();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_EHV_BC)\n\tudbg_init_ehv_bc();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_PS3GELIC)\n\tudbg_init_ps3gelic();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_OPAL_RAW)\n\tudbg_init_debug_opal_raw();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_OPAL_HVSI)\n\tudbg_init_debug_opal_hvsi();\n#endif\n\n#ifdef CONFIG_PPC_EARLY_DEBUG\n\tconsole_loglevel = 10;\n\n\tregister_early_udbg_console();\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_init",
          "args": [],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initialise_paca",
          "args": [
            "&boot_paca",
            "0"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "initialise_paca",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/paca.c",
          "lines": "150-180",
          "snippet": "void __init initialise_paca(struct paca_struct *new_paca, int cpu)\n{\n       /* The TOC register (GPR2) points 32kB into the TOC, so that 64kB\n\t* of the TOC can be addressed using a single machine instruction.\n\t*/\n\tunsigned long kernel_toc = (unsigned long)(&__toc_start) + 0x8000UL;\n\n#ifdef CONFIG_PPC_BOOK3S\n\tnew_paca->lppaca_ptr = new_lppaca(cpu);\n#else\n\tnew_paca->kernel_pgd = swapper_pg_dir;\n#endif\n\tnew_paca->lock_token = 0x8000;\n\tnew_paca->paca_index = cpu;\n\tnew_paca->kernel_toc = kernel_toc;\n\tnew_paca->kernelbase = (unsigned long) _stext;\n\t/* Only set MSR:IR/DR when MMU is initialized */\n\tnew_paca->kernel_msr = MSR_KERNEL & ~(MSR_IR | MSR_DR);\n\tnew_paca->hw_cpu_id = 0xffff;\n\tnew_paca->kexec_state = KEXEC_STATE_NONE;\n\tnew_paca->__current = &init_task;\n\tnew_paca->data_offset = 0xfeeeeeeeeeeeeeeeULL;\n#ifdef CONFIG_PPC_STD_MMU_64\n\tnew_paca->slb_shadow_ptr = init_slb_shadow(cpu);\n#endif /* CONFIG_PPC_STD_MMU_64 */\n\n#ifdef CONFIG_PPC_BOOK3E\n\t/* For now -- if we have threads this will be adjusted later */\n\tnew_paca->tcd_ptr = &new_paca->tcd;\n#endif\n}",
          "includes": [
            "#include <asm/kexec.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/sections.h>",
            "#include <asm/paca.h>",
            "#include <asm/lppaca.h>",
            "#include <linux/memblock.h>",
            "#include <linux/export.h>",
            "#include <linux/smp.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern unsigned long __toc_start;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/kexec.h>\n#include <asm/pgtable.h>\n#include <asm/sections.h>\n#include <asm/paca.h>\n#include <asm/lppaca.h>\n#include <linux/memblock.h>\n#include <linux/export.h>\n#include <linux/smp.h>\n\nextern unsigned long __toc_start;\n\nvoid __init initialise_paca(struct paca_struct *new_paca, int cpu)\n{\n       /* The TOC register (GPR2) points 32kB into the TOC, so that 64kB\n\t* of the TOC can be addressed using a single machine instruction.\n\t*/\n\tunsigned long kernel_toc = (unsigned long)(&__toc_start) + 0x8000UL;\n\n#ifdef CONFIG_PPC_BOOK3S\n\tnew_paca->lppaca_ptr = new_lppaca(cpu);\n#else\n\tnew_paca->kernel_pgd = swapper_pg_dir;\n#endif\n\tnew_paca->lock_token = 0x8000;\n\tnew_paca->paca_index = cpu;\n\tnew_paca->kernel_toc = kernel_toc;\n\tnew_paca->kernelbase = (unsigned long) _stext;\n\t/* Only set MSR:IR/DR when MMU is initialized */\n\tnew_paca->kernel_msr = MSR_KERNEL & ~(MSR_IR | MSR_DR);\n\tnew_paca->hw_cpu_id = 0xffff;\n\tnew_paca->kexec_state = KEXEC_STATE_NONE;\n\tnew_paca->__current = &init_task;\n\tnew_paca->data_offset = 0xfeeeeeeeeeeeeeeeULL;\n#ifdef CONFIG_PPC_STD_MMU_64\n\tnew_paca->slb_shadow_ptr = init_slb_shadow(cpu);\n#endif /* CONFIG_PPC_STD_MMU_64 */\n\n#ifdef CONFIG_PPC_BOOK3E\n\t/* For now -- if we have threads this will be adjusted later */\n\tnew_paca->tcd_ptr = &new_paca->tcd;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "identify_cpu",
          "args": [
            "0",
            "mfspr(SPRN_PVR)"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "identify_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/cputable.c",
          "lines": "2182-2197",
          "snippet": "struct cpu_spec * __init identify_cpu(unsigned long offset, unsigned int pvr)\n{\n\tstruct cpu_spec *s = cpu_specs;\n\tint i;\n\n\ts = PTRRELOC(s);\n\n\tfor (i = 0; i < ARRAY_SIZE(cpu_specs); i++,s++) {\n\t\tif ((pvr & s->pvr_mask) == s->pvr_value)\n\t\t\treturn setup_cpu_spec(offset, s);\n\t}\n\n\tBUG();\n\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/mmu.h>",
            "#include <asm/prom.h>\t\t/* for PTRRELOC on ARCH=ppc */",
            "#include <asm/cputable.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/threads.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/mmu.h>\n#include <asm/prom.h>\t\t/* for PTRRELOC on ARCH=ppc */\n#include <asm/cputable.h>\n#include <asm/oprofile_impl.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/threads.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n\nstruct cpu_spec * __init identify_cpu(unsigned long offset, unsigned int pvr)\n{\n\tstruct cpu_spec *s = cpu_specs;\n\tint i;\n\n\ts = PTRRELOC(s);\n\n\tfor (i = 0; i < ARRAY_SIZE(cpu_specs); i++,s++) {\n\t\tif ((pvr & s->pvr_mask) == s->pvr_value)\n\t\t\treturn setup_cpu_spec(offset, s);\n\t}\n\n\tBUG();\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PVR"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init early_setup(unsigned long dt_ptr)\n{\n\tstatic __initdata struct paca_struct boot_paca;\n\n\t/* -------- printk is _NOT_ safe to use here ! ------- */\n\n\t/* Identify CPU type */\n\tidentify_cpu(0, mfspr(SPRN_PVR));\n\n\t/* Assume we're on cpu 0 for now. Don't write to the paca yet! */\n\tinitialise_paca(&boot_paca, 0);\n\tsetup_paca(&boot_paca);\n\tfixup_boot_paca();\n\n\t/* Initialize lockdep early or else spinlocks will blow */\n\tlockdep_init();\n\n\t/* -------- printk is now safe to use ------- */\n\n\t/* Enable early debugging if any specified (see udbg.h) */\n\tudbg_early_init();\n\n \tDBG(\" -> early_setup(), dt_ptr: 0x%lx\\n\", dt_ptr);\n\n\t/*\n\t * Do early initialization using the flattened device\n\t * tree, such as retrieving the physical memory map or\n\t * calculating/retrieving the hash table size.\n\t */\n\tearly_init_devtree(__va(dt_ptr));\n\n\tepapr_paravirt_early_init();\n\n\t/* Now we know the logical id of our boot cpu, setup the paca. */\n\tsetup_paca(&paca[boot_cpuid]);\n\tfixup_boot_paca();\n\n\t/* Probe the machine type */\n\tprobe_machine();\n\n\tsetup_kdump_trampoline();\n\n\tDBG(\"Found, Initializing memory management...\\n\");\n\n\t/* Initialize the hash table or TLB handling */\n\tearly_init_mmu();\n\n\t/*\n\t * At this point, we can let interrupts switch to virtual mode\n\t * (the MMU has been setup), so adjust the MSR in the PACA to\n\t * have IR and DR set and enable AIL if it exists\n\t */\n\tcpu_ready_for_interrupts();\n\n\t/* Reserve large chunks of memory for use by CMA for KVM */\n\tkvm_cma_reserve();\n\n\t/*\n\t * Reserve any gigantic pages requested on the command line.\n\t * memblock needs to have been initialized by the time this is\n\t * called since this will reserve memory.\n\t */\n\treserve_hugetlb_gpages();\n\n\tDBG(\" <- early_setup()\\n\");\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_BOOTX\n\t/*\n\t * This needs to be done *last* (after the above DBG() even)\n\t *\n\t * Right after we return from this function, we turn on the MMU\n\t * which means the real-mode access trick that btext does will\n\t * no longer work, it needs to switch to using a real MMU\n\t * mapping. This call will ensure that it does\n\t */\n\tbtext_map();\n#endif /* CONFIG_PPC_EARLY_DEBUG_BOOTX */\n}"
  },
  {
    "function_name": "cpu_ready_for_interrupts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "208-223",
    "snippet": "static void cpu_ready_for_interrupts(void)\n{\n\t/* Set IR and DR in PACA MSR */\n\tget_paca()->kernel_msr = MSR_KERNEL;\n\n\t/*\n\t * Enable AIL if supported, and we are in hypervisor mode. If we are\n\t * not in hypervisor mode, we enable relocation-on interrupts later\n\t * in pSeries_setup_arch() using the H_SET_MODE hcall.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tunsigned long lpcr = mfspr(SPRN_LPCR);\n\t\tmtspr(SPRN_LPCR, lpcr | LPCR_AIL_3);\n\t}\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPCR",
            "lpcr | LPCR_AIL_3"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_LPCR"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_207S"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_HVMODE"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void cpu_ready_for_interrupts(void)\n{\n\t/* Set IR and DR in PACA MSR */\n\tget_paca()->kernel_msr = MSR_KERNEL;\n\n\t/*\n\t * Enable AIL if supported, and we are in hypervisor mode. If we are\n\t * not in hypervisor mode, we enable relocation-on interrupts later\n\t * in pSeries_setup_arch() using the H_SET_MODE hcall.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tunsigned long lpcr = mfspr(SPRN_LPCR);\n\t\tmtspr(SPRN_LPCR, lpcr | LPCR_AIL_3);\n\t}\n}"
  },
  {
    "function_name": "fixup_boot_paca",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "200-206",
    "snippet": "static void fixup_boot_paca(void)\n{\n\t/* The boot cpu is started */\n\tget_paca()->cpu_start = 1;\n\t/* Allow percpu accesses to work until we setup percpu data */\n\tget_paca()->data_offset = 0;\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void fixup_boot_paca(void)\n{\n\t/* The boot cpu is started */\n\tget_paca()->cpu_start = 1;\n\t/* Allow percpu accesses to work until we setup percpu data */\n\tget_paca()->data_offset = 0;\n}"
  },
  {
    "function_name": "early_smt_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "188-192",
    "snippet": "static int __init early_smt_enabled(char *p)\n{\n\tsmt_enabled_cmdline = p;\n\treturn 0;\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic int __init early_smt_enabled(char *p)\n{\n\tsmt_enabled_cmdline = p;\n\treturn 0;\n}"
  },
  {
    "function_name": "check_smt_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "146-185",
    "snippet": "static void check_smt_enabled(void)\n{\n\tstruct device_node *dn;\n\tconst char *smt_option;\n\n\t/* Default to enabling all threads */\n\tsmt_enabled_at_boot = threads_per_core;\n\n\t/* Allow the command line to overrule the OF option */\n\tif (smt_enabled_cmdline) {\n\t\tif (!strcmp(smt_enabled_cmdline, \"on\"))\n\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\telse if (!strcmp(smt_enabled_cmdline, \"off\"))\n\t\t\tsmt_enabled_at_boot = 0;\n\t\telse {\n\t\t\tint smt;\n\t\t\tint rc;\n\n\t\t\trc = kstrtoint(smt_enabled_cmdline, 10, &smt);\n\t\t\tif (!rc)\n\t\t\t\tsmt_enabled_at_boot =\n\t\t\t\t\tmin(threads_per_core, smt);\n\t\t}\n\t} else {\n\t\tdn = of_find_node_by_path(\"/options\");\n\t\tif (dn) {\n\t\t\tsmt_option = of_get_property(dn, \"ibm,smt-enabled\",\n\t\t\t\t\t\t     NULL);\n\n\t\t\tif (smt_option) {\n\t\t\t\tif (!strcmp(smt_option, \"on\"))\n\t\t\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\t\t\telse if (!strcmp(smt_option, \"off\"))\n\t\t\t\t\tsmt_enabled_at_boot = 0;\n\t\t\t}\n\n\t\t\tof_node_put(dn);\n\t\t}\n\t}\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "dn"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "smt_option",
            "\"off\""
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "smt_option",
            "\"on\""
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "dn",
            "\"ibm,smt-enabled\"",
            "NULL"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_path",
          "args": [
            "\"/options\""
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "threads_per_core",
            "smt"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstrtoint",
          "args": [
            "smt_enabled_cmdline",
            "10",
            "&smt"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "smt_enabled_cmdline",
            "\"off\""
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "smt_enabled_cmdline",
            "\"on\""
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void check_smt_enabled(void)\n{\n\tstruct device_node *dn;\n\tconst char *smt_option;\n\n\t/* Default to enabling all threads */\n\tsmt_enabled_at_boot = threads_per_core;\n\n\t/* Allow the command line to overrule the OF option */\n\tif (smt_enabled_cmdline) {\n\t\tif (!strcmp(smt_enabled_cmdline, \"on\"))\n\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\telse if (!strcmp(smt_enabled_cmdline, \"off\"))\n\t\t\tsmt_enabled_at_boot = 0;\n\t\telse {\n\t\t\tint smt;\n\t\t\tint rc;\n\n\t\t\trc = kstrtoint(smt_enabled_cmdline, 10, &smt);\n\t\t\tif (!rc)\n\t\t\t\tsmt_enabled_at_boot =\n\t\t\t\t\tmin(threads_per_core, smt);\n\t\t}\n\t} else {\n\t\tdn = of_find_node_by_path(\"/options\");\n\t\tif (dn) {\n\t\t\tsmt_option = of_get_property(dn, \"ibm,smt-enabled\",\n\t\t\t\t\t\t     NULL);\n\n\t\t\tif (smt_option) {\n\t\t\t\tif (!strcmp(smt_option, \"on\"))\n\t\t\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\t\t\telse if (!strcmp(smt_option, \"off\"))\n\t\t\t\t\tsmt_enabled_at_boot = 0;\n\t\t\t}\n\n\t\t\tof_node_put(dn);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "setup_tlb_core_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "136-138",
    "snippet": "static void setup_tlb_core_data(void)\n{\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void setup_tlb_core_data(void)\n{\n}"
  },
  {
    "function_name": "setup_tlb_core_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "102-134",
    "snippet": "static void setup_tlb_core_data(void)\n{\n\tint cpu;\n\n\tBUILD_BUG_ON(offsetof(struct tlb_core_data, lock) != 0);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tint first = cpu_first_thread_sibling(cpu);\n\n\t\t/*\n\t\t * If we boot via kdump on a non-primary thread,\n\t\t * make sure we point at the thread that actually\n\t\t * set up this TLB.\n\t\t */\n\t\tif (cpu_first_thread_sibling(boot_cpuid) == first)\n\t\t\tfirst = boot_cpuid;\n\n\t\tpaca[cpu].tcd_ptr = &paca[first].tcd;\n\n\t\t/*\n\t\t * If we have threads, we need either tlbsrx.\n\t\t * or e6500 tablewalk mode, or else TLB handlers\n\t\t * will be racy and could produce duplicate entries.\n\t\t */\n\t\tif (smt_enabled_at_boot >= 2 &&\n\t\t    !mmu_has_feature(MMU_FTR_USE_TLBRSRV) &&\n\t\t    book3e_htw_mode != PPC_HTW_E6500) {\n\t\t\t/* Should we panic instead? */\n\t\t\tWARN_ONCE(\"%s: unsupported MMU configuration -- expect problems\\n\",\n\t\t\t\t  __func__);\n\t\t}\n\t}\n}",
    "includes": [
      "#include <asm/epapr_hcalls.h>",
      "#include <asm/hugetlb.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/memblock.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/bootmem.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "\"%s: unsupported MMU configuration -- expect problems\\n\"",
            "__func__"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mmu_has_feature",
          "args": [
            "MMU_FTR_USE_TLBRSRV"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_first_thread_sibling",
          "args": [
            "boot_cpuid"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_first_thread_sibling",
          "args": [
            "cpu"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "offsetof(struct tlb_core_data, lock) != 0"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/epapr_hcalls.h>\n#include <asm/hugetlb.h>\n#include <asm/kvm_ppc.h>\n#include <asm/code-patching.h>\n#include <asm/mmu_context.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/pgtable.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/hugetlb.h>\n#include <linux/memblock.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/bootmem.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void setup_tlb_core_data(void)\n{\n\tint cpu;\n\n\tBUILD_BUG_ON(offsetof(struct tlb_core_data, lock) != 0);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tint first = cpu_first_thread_sibling(cpu);\n\n\t\t/*\n\t\t * If we boot via kdump on a non-primary thread,\n\t\t * make sure we point at the thread that actually\n\t\t * set up this TLB.\n\t\t */\n\t\tif (cpu_first_thread_sibling(boot_cpuid) == first)\n\t\t\tfirst = boot_cpuid;\n\n\t\tpaca[cpu].tcd_ptr = &paca[first].tcd;\n\n\t\t/*\n\t\t * If we have threads, we need either tlbsrx.\n\t\t * or e6500 tablewalk mode, or else TLB handlers\n\t\t * will be racy and could produce duplicate entries.\n\t\t */\n\t\tif (smt_enabled_at_boot >= 2 &&\n\t\t    !mmu_has_feature(MMU_FTR_USE_TLBRSRV) &&\n\t\t    book3e_htw_mode != PPC_HTW_E6500) {\n\t\t\t/* Should we panic instead? */\n\t\t\tWARN_ONCE(\"%s: unsupported MMU configuration -- expect problems\\n\",\n\t\t\t\t  __func__);\n\t\t}\n\t}\n}"
  }
]