[
  {
    "function_name": "eeh_dev_phb_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/eeh_dev.c",
    "lines": "101-111",
    "snippet": "static int __init eeh_dev_phb_init(void)\n{\n\tstruct pci_controller *phb, *tmp;\n\n\tlist_for_each_entry_safe(phb, tmp, &hose_list, list_node)\n\t\teeh_dev_phb_init_dynamic(phb);\n\n\tpr_info(\"EEH: devices created\\n\");\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/ppc-pci.h>",
      "#include <asm/pci-bridge.h>",
      "#include <linux/string.h>",
      "#include <linux/pci.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/gfp.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"EEH: devices created\\n\""
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eeh_dev_phb_init_dynamic",
          "args": [
            "phb"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "eeh_dev_phb_init_dynamic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/eeh_dev.c",
          "lines": "81-93",
          "snippet": "void eeh_dev_phb_init_dynamic(struct pci_controller *phb)\n{\n\tstruct pci_dn *root = phb->pci_data;\n\n\t/* EEH PE for PHB */\n\teeh_phb_pe_create(phb);\n\n\t/* EEH device for PHB */\n\teeh_dev_init(root, phb);\n\n\t/* EEH devices for children OF nodes */\n\ttraverse_pci_dn(root, eeh_dev_init, phb);\n}",
          "includes": [
            "#include <asm/ppc-pci.h>",
            "#include <asm/pci-bridge.h>",
            "#include <linux/string.h>",
            "#include <linux/pci.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/gfp.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ppc-pci.h>\n#include <asm/pci-bridge.h>\n#include <linux/string.h>\n#include <linux/pci.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/gfp.h>\n#include <linux/export.h>\n\nvoid eeh_dev_phb_init_dynamic(struct pci_controller *phb)\n{\n\tstruct pci_dn *root = phb->pci_data;\n\n\t/* EEH PE for PHB */\n\teeh_phb_pe_create(phb);\n\n\t/* EEH device for PHB */\n\teeh_dev_init(root, phb);\n\n\t/* EEH devices for children OF nodes */\n\ttraverse_pci_dn(root, eeh_dev_init, phb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "phb",
            "tmp",
            "&hose_list",
            "list_node"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ppc-pci.h>\n#include <asm/pci-bridge.h>\n#include <linux/string.h>\n#include <linux/pci.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/gfp.h>\n#include <linux/export.h>\n\nstatic int __init eeh_dev_phb_init(void)\n{\n\tstruct pci_controller *phb, *tmp;\n\n\tlist_for_each_entry_safe(phb, tmp, &hose_list, list_node)\n\t\teeh_dev_phb_init_dynamic(phb);\n\n\tpr_info(\"EEH: devices created\\n\");\n\n\treturn 0;\n}"
  },
  {
    "function_name": "eeh_dev_phb_init_dynamic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/eeh_dev.c",
    "lines": "81-93",
    "snippet": "void eeh_dev_phb_init_dynamic(struct pci_controller *phb)\n{\n\tstruct pci_dn *root = phb->pci_data;\n\n\t/* EEH PE for PHB */\n\teeh_phb_pe_create(phb);\n\n\t/* EEH device for PHB */\n\teeh_dev_init(root, phb);\n\n\t/* EEH devices for children OF nodes */\n\ttraverse_pci_dn(root, eeh_dev_init, phb);\n}",
    "includes": [
      "#include <asm/ppc-pci.h>",
      "#include <asm/pci-bridge.h>",
      "#include <linux/string.h>",
      "#include <linux/pci.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/gfp.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "traverse_pci_dn",
          "args": [
            "root",
            "eeh_dev_init",
            "phb"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "traverse_pci_dn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/pci_dn.c",
          "lines": "400-416",
          "snippet": "void *traverse_pci_dn(struct pci_dn *root,\n\t\t      void *(*fn)(struct pci_dn *, void *),\n\t\t      void *data)\n{\n\tstruct pci_dn *pdn = root;\n\tvoid *ret;\n\n\t/* Only scan the child nodes */\n\tfor (pdn = pci_dn_next_one(root, pdn); pdn;\n\t     pdn = pci_dn_next_one(root, pdn)) {\n\t\tret = fn(pdn, data);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/firmware.h>",
            "#include <asm/ppc-pci.h>",
            "#include <asm/pci-bridge.h>",
            "#include <asm/prom.h>",
            "#include <asm/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>",
            "#include <linux/string.h>",
            "#include <linux/pci.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/firmware.h>\n#include <asm/ppc-pci.h>\n#include <asm/pci-bridge.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/gfp.h>\n#include <linux/init.h>\n#include <linux/export.h>\n#include <linux/string.h>\n#include <linux/pci.h>\n#include <linux/kernel.h>\n\nvoid *traverse_pci_dn(struct pci_dn *root,\n\t\t      void *(*fn)(struct pci_dn *, void *),\n\t\t      void *data)\n{\n\tstruct pci_dn *pdn = root;\n\tvoid *ret;\n\n\t/* Only scan the child nodes */\n\tfor (pdn = pci_dn_next_one(root, pdn); pdn;\n\t     pdn = pci_dn_next_one(root, pdn)) {\n\t\tret = fn(pdn, data);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "eeh_dev_init",
          "args": [
            "root",
            "phb"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "eeh_dev_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/eeh_dev.c",
          "lines": "52-72",
          "snippet": "void *eeh_dev_init(struct pci_dn *pdn, void *data)\n{\n\tstruct pci_controller *phb = data;\n\tstruct eeh_dev *edev;\n\n\t/* Allocate EEH device */\n\tedev = kzalloc(sizeof(*edev), GFP_KERNEL);\n\tif (!edev) {\n\t\tpr_warn(\"%s: out of memory\\n\",\n\t\t\t__func__);\n\t\treturn NULL;\n\t}\n\n\t/* Associate EEH device with OF node */\n\tpdn->edev = edev;\n\tedev->pdn = pdn;\n\tedev->phb = phb;\n\tINIT_LIST_HEAD(&edev->list);\n\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/ppc-pci.h>",
            "#include <asm/pci-bridge.h>",
            "#include <linux/string.h>",
            "#include <linux/pci.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/gfp.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ppc-pci.h>\n#include <asm/pci-bridge.h>\n#include <linux/string.h>\n#include <linux/pci.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/gfp.h>\n#include <linux/export.h>\n\nvoid *eeh_dev_init(struct pci_dn *pdn, void *data)\n{\n\tstruct pci_controller *phb = data;\n\tstruct eeh_dev *edev;\n\n\t/* Allocate EEH device */\n\tedev = kzalloc(sizeof(*edev), GFP_KERNEL);\n\tif (!edev) {\n\t\tpr_warn(\"%s: out of memory\\n\",\n\t\t\t__func__);\n\t\treturn NULL;\n\t}\n\n\t/* Associate EEH device with OF node */\n\tpdn->edev = edev;\n\tedev->pdn = pdn;\n\tedev->phb = phb;\n\tINIT_LIST_HEAD(&edev->list);\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "eeh_phb_pe_create",
          "args": [
            "phb"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "eeh_phb_pe_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/eeh_pe.c",
          "lines": "93-110",
          "snippet": "int eeh_phb_pe_create(struct pci_controller *phb)\n{\n\tstruct eeh_pe *pe;\n\n\t/* Allocate PHB PE */\n\tpe = eeh_pe_alloc(phb, EEH_PE_PHB);\n\tif (!pe) {\n\t\tpr_err(\"%s: out of memory!\\n\", __func__);\n\t\treturn -ENOMEM;\n\t}\n\n\t/* Put it into the list */\n\tlist_add_tail(&pe->child, &eeh_phb_pe);\n\n\tpr_debug(\"EEH: Add PE for PHB#%d\\n\", phb->global_number);\n\n\treturn 0;\n}",
          "includes": [
            "#include <asm/ppc-pci.h>",
            "#include <asm/pci-bridge.h>",
            "#include <linux/string.h>",
            "#include <linux/pci.h>",
            "#include <linux/kernel.h>",
            "#include <linux/gfp.h>",
            "#include <linux/export.h>",
            "#include <linux/delay.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(eeh_phb_pe);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ppc-pci.h>\n#include <asm/pci-bridge.h>\n#include <linux/string.h>\n#include <linux/pci.h>\n#include <linux/kernel.h>\n#include <linux/gfp.h>\n#include <linux/export.h>\n#include <linux/delay.h>\n\nstatic LIST_HEAD(eeh_phb_pe);\n\nint eeh_phb_pe_create(struct pci_controller *phb)\n{\n\tstruct eeh_pe *pe;\n\n\t/* Allocate PHB PE */\n\tpe = eeh_pe_alloc(phb, EEH_PE_PHB);\n\tif (!pe) {\n\t\tpr_err(\"%s: out of memory!\\n\", __func__);\n\t\treturn -ENOMEM;\n\t}\n\n\t/* Put it into the list */\n\tlist_add_tail(&pe->child, &eeh_phb_pe);\n\n\tpr_debug(\"EEH: Add PE for PHB#%d\\n\", phb->global_number);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/ppc-pci.h>\n#include <asm/pci-bridge.h>\n#include <linux/string.h>\n#include <linux/pci.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/gfp.h>\n#include <linux/export.h>\n\nvoid eeh_dev_phb_init_dynamic(struct pci_controller *phb)\n{\n\tstruct pci_dn *root = phb->pci_data;\n\n\t/* EEH PE for PHB */\n\teeh_phb_pe_create(phb);\n\n\t/* EEH device for PHB */\n\teeh_dev_init(root, phb);\n\n\t/* EEH devices for children OF nodes */\n\ttraverse_pci_dn(root, eeh_dev_init, phb);\n}"
  },
  {
    "function_name": "eeh_dev_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/eeh_dev.c",
    "lines": "52-72",
    "snippet": "void *eeh_dev_init(struct pci_dn *pdn, void *data)\n{\n\tstruct pci_controller *phb = data;\n\tstruct eeh_dev *edev;\n\n\t/* Allocate EEH device */\n\tedev = kzalloc(sizeof(*edev), GFP_KERNEL);\n\tif (!edev) {\n\t\tpr_warn(\"%s: out of memory\\n\",\n\t\t\t__func__);\n\t\treturn NULL;\n\t}\n\n\t/* Associate EEH device with OF node */\n\tpdn->edev = edev;\n\tedev->pdn = pdn;\n\tedev->phb = phb;\n\tINIT_LIST_HEAD(&edev->list);\n\n\treturn NULL;\n}",
    "includes": [
      "#include <asm/ppc-pci.h>",
      "#include <asm/pci-bridge.h>",
      "#include <linux/string.h>",
      "#include <linux/pci.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/gfp.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&edev->list"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: out of memory\\n\"",
            "__func__"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*edev)",
            "GFP_KERNEL"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/ppc-pci.h>\n#include <asm/pci-bridge.h>\n#include <linux/string.h>\n#include <linux/pci.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/gfp.h>\n#include <linux/export.h>\n\nvoid *eeh_dev_init(struct pci_dn *pdn, void *data)\n{\n\tstruct pci_controller *phb = data;\n\tstruct eeh_dev *edev;\n\n\t/* Allocate EEH device */\n\tedev = kzalloc(sizeof(*edev), GFP_KERNEL);\n\tif (!edev) {\n\t\tpr_warn(\"%s: out of memory\\n\",\n\t\t\t__func__);\n\t\treturn NULL;\n\t}\n\n\t/* Associate EEH device with OF node */\n\tpdn->edev = edev;\n\tedev->pdn = pdn;\n\tedev->phb = phb;\n\tINIT_LIST_HEAD(&edev->list);\n\n\treturn NULL;\n}"
  }
]