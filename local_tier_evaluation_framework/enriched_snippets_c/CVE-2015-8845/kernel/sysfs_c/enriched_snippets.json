[
  {
    "function_name": "topology_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1024-1064",
    "snippet": "static int __init topology_init(void)\n{\n\tint cpu;\n\n\tregister_nodes();\n\n\tcpu_notifier_register_begin();\n\n\tfor_each_possible_cpu(cpu) {\n\t\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\n\t\t/*\n\t\t * For now, we just see if the system supports making\n\t\t * the RTAS calls for CPU hotplug.  But, there may be a\n\t\t * more comprehensive way to do this for an individual\n\t\t * CPU.  For instance, the boot cpu might never be valid\n\t\t * for hotplugging.\n\t\t */\n\t\tif (ppc_md.cpu_die)\n\t\t\tc->hotpluggable = 1;\n\n\t\tif (cpu_online(cpu) || c->hotpluggable) {\n\t\t\tregister_cpu(c, cpu);\n\n\t\t\tdevice_create_file(&c->dev, &dev_attr_physical_id);\n\t\t}\n\n\t\tif (cpu_online(cpu))\n\t\t\tregister_cpu_online(cpu);\n\t}\n\n\t__register_cpu_notifier(&sysfs_cpu_nb);\n\n\tcpu_notifier_register_done();\n\n#ifdef CONFIG_PPC64\n\tsysfs_create_dscr_default();\n#endif /* CONFIG_PPC64 */\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(struct cpu, cpu_devices);",
      "static struct notifier_block sysfs_cpu_nb = {\n\t.notifier_call\t= sysfs_cpu_notify,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysfs_create_dscr_default",
          "args": [],
          "line": 1060
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_create_dscr_default",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "587-592",
          "snippet": "static void sysfs_create_dscr_default(void)\n{\n\tint err = 0;\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\terr = device_create_file(cpu_subsys.dev_root, &dev_attr_dscr_default);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"cacheinfo.h\"",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void sysfs_create_dscr_default(void)\n{\n\tint err = 0;\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\terr = device_create_file(cpu_subsys.dev_root, &dev_attr_dscr_default);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_notifier_register_done",
          "args": [],
          "line": 1057
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__register_cpu_notifier",
          "args": [
            "&sysfs_cpu_nb"
          ],
          "line": 1055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_cpu_online",
          "args": [
            "cpu"
          ],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_cpu_online",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "788-866",
          "snippet": "static void unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"cacheinfo.h\"",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [
            "#define HAS_PPC_PMC_G4\t\t1",
            "#define HAS_PPC_PMC_IBM\t\t1",
            "#define HAS_PPC_PMC_PA6T\t1",
            "#define HAS_PPC_PMC_IBM\t\t1"
          ],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cpu, cpu_devices);",
            "static DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_IBM\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\nstatic DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);\n\nstatic void unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "&c->dev",
            "&dev_attr_physical_id"
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_cpu",
          "args": [
            "c",
            "cpu"
          ],
          "line": 1046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_devices",
            "cpu"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_notifier_register_begin",
          "args": [],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_nodes",
          "args": [],
          "line": 1028
        },
        "resolved": true,
        "details": {
          "function_name": "register_nodes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "1007-1010",
          "snippet": "static void register_nodes(void)\n{\n\treturn;\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"cacheinfo.h\"",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void register_nodes(void)\n{\n\treturn;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\nstatic struct notifier_block sysfs_cpu_nb = {\n\t.notifier_call\t= sysfs_cpu_notify,\n};\n\nstatic int __init topology_init(void)\n{\n\tint cpu;\n\n\tregister_nodes();\n\n\tcpu_notifier_register_begin();\n\n\tfor_each_possible_cpu(cpu) {\n\t\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\n\t\t/*\n\t\t * For now, we just see if the system supports making\n\t\t * the RTAS calls for CPU hotplug.  But, there may be a\n\t\t * more comprehensive way to do this for an individual\n\t\t * CPU.  For instance, the boot cpu might never be valid\n\t\t * for hotplugging.\n\t\t */\n\t\tif (ppc_md.cpu_die)\n\t\t\tc->hotpluggable = 1;\n\n\t\tif (cpu_online(cpu) || c->hotpluggable) {\n\t\t\tregister_cpu(c, cpu);\n\n\t\t\tdevice_create_file(&c->dev, &dev_attr_physical_id);\n\t\t}\n\n\t\tif (cpu_online(cpu))\n\t\t\tregister_cpu_online(cpu);\n\t}\n\n\t__register_cpu_notifier(&sysfs_cpu_nb);\n\n\tcpu_notifier_register_done();\n\n#ifdef CONFIG_PPC64\n\tsysfs_create_dscr_default();\n#endif /* CONFIG_PPC64 */\n\n\treturn 0;\n}"
  },
  {
    "function_name": "show_physical_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1015-1021",
    "snippet": "static ssize_t show_physical_id(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tstruct cpu *cpu = container_of(dev, struct cpu, dev);\n\n\treturn sprintf(buf, \"%d\\n\", get_hard_smp_processor_id(cpu->dev.id));\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "get_hard_smp_processor_id(cpu->dev.id)"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_hard_smp_processor_id",
          "args": [
            "cpu->dev.id"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "dev",
            "structcpu",
            "dev"
          ],
          "line": 1018
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t show_physical_id(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tstruct cpu *cpu = container_of(dev, struct cpu, dev);\n\n\treturn sprintf(buf, \"%d\\n\", get_hard_smp_processor_id(cpu->dev.id));\n}"
  },
  {
    "function_name": "register_nodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "1007-1010",
    "snippet": "static void register_nodes(void)\n{\n\treturn;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void register_nodes(void)\n{\n\treturn;\n}"
  },
  {
    "function_name": "sysfs_remove_device_from_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "999-1003",
    "snippet": "void sysfs_remove_device_from_node(struct device *dev, int nid)\n{\n\tstruct node *node = node_devices[nid];\n\tsysfs_remove_link(&node->dev.kobj, kobject_name(&dev->kobj));\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysfs_remove_link",
          "args": [
            "&node->dev.kobj",
            "kobject_name(&dev->kobj)"
          ],
          "line": 1002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_name",
          "args": [
            "&dev->kobj"
          ],
          "line": 1002
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nvoid sysfs_remove_device_from_node(struct device *dev, int nid)\n{\n\tstruct node *node = node_devices[nid];\n\tsysfs_remove_link(&node->dev.kobj, kobject_name(&dev->kobj));\n}"
  },
  {
    "function_name": "sysfs_add_device_to_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "991-996",
    "snippet": "int sysfs_add_device_to_node(struct device *dev, int nid)\n{\n\tstruct node *node = node_devices[nid];\n\treturn sysfs_create_link(&node->dev.kobj, &dev->kobj,\n\t\t\tkobject_name(&dev->kobj));\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysfs_create_link",
          "args": [
            "&node->dev.kobj",
            "&dev->kobj",
            "kobject_name(&dev->kobj)"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_name",
          "args": [
            "&dev->kobj"
          ],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nint sysfs_add_device_to_node(struct device *dev, int nid)\n{\n\tstruct node *node = node_devices[nid];\n\treturn sysfs_create_link(&node->dev.kobj, &dev->kobj,\n\t\t\tkobject_name(&dev->kobj));\n}"
  },
  {
    "function_name": "register_nodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "983-989",
    "snippet": "static void register_nodes(void)\n{\n\tint i;\n\n\tfor (i = 0; i < MAX_NUMNODES; i++)\n\t\tregister_one_node(i);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_one_node",
          "args": [
            "i"
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void register_nodes(void)\n{\n\tint i;\n\n\tfor (i = 0; i < MAX_NUMNODES; i++)\n\t\tregister_one_node(i);\n}"
  },
  {
    "function_name": "cpu_remove_dev_attr_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "963-976",
    "snippet": "void cpu_remove_dev_attr_group(struct attribute_group *attrs)\n{\n\tint cpu;\n\tstruct device *dev;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdev = get_cpu_device(cpu);\n\t\tsysfs_remove_group(&dev->kobj, attrs);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(cpu_mutex);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_remove_group",
          "args": [
            "&dev->kobj",
            "attrs"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_device",
          "args": [
            "cpu"
          ],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic DEFINE_MUTEX(cpu_mutex);\n\nvoid cpu_remove_dev_attr_group(struct attribute_group *attrs)\n{\n\tint cpu;\n\tstruct device *dev;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdev = get_cpu_device(cpu);\n\t\tsysfs_remove_group(&dev->kobj, attrs);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n}"
  },
  {
    "function_name": "cpu_remove_dev_attr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "949-960",
    "snippet": "void cpu_remove_dev_attr(struct device_attribute *attr)\n{\n\tint cpu;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdevice_remove_file(get_cpu_device(cpu), attr);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(cpu_mutex);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "get_cpu_device(cpu)",
            "attr"
          ],
          "line": 956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_device",
          "args": [
            "cpu"
          ],
          "line": 956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 953
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic DEFINE_MUTEX(cpu_mutex);\n\nvoid cpu_remove_dev_attr(struct device_attribute *attr)\n{\n\tint cpu;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdevice_remove_file(get_cpu_device(cpu), attr);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n}"
  },
  {
    "function_name": "cpu_add_dev_attr_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "929-945",
    "snippet": "int cpu_add_dev_attr_group(struct attribute_group *attrs)\n{\n\tint cpu;\n\tstruct device *dev;\n\tint ret;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdev = get_cpu_device(cpu);\n\t\tret = sysfs_create_group(&dev->kobj, attrs);\n\t\tWARN_ON(ret != 0);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(cpu_mutex);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ret != 0"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_create_group",
          "args": [
            "&dev->kobj",
            "attrs"
          ],
          "line": 939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_device",
          "args": [
            "cpu"
          ],
          "line": 938
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic DEFINE_MUTEX(cpu_mutex);\n\nint cpu_add_dev_attr_group(struct attribute_group *attrs)\n{\n\tint cpu;\n\tstruct device *dev;\n\tint ret;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdev = get_cpu_device(cpu);\n\t\tret = sysfs_create_group(&dev->kobj, attrs);\n\t\tWARN_ON(ret != 0);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n\treturn 0;\n}"
  },
  {
    "function_name": "cpu_add_dev_attr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "914-926",
    "snippet": "int cpu_add_dev_attr(struct device_attribute *attr)\n{\n\tint cpu;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdevice_create_file(get_cpu_device(cpu), attr);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(cpu_mutex);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "get_cpu_device(cpu)",
            "attr"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_device",
          "args": [
            "cpu"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&cpu_mutex"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic DEFINE_MUTEX(cpu_mutex);\n\nint cpu_add_dev_attr(struct device_attribute *attr)\n{\n\tint cpu;\n\n\tmutex_lock(&cpu_mutex);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tdevice_create_file(get_cpu_device(cpu), attr);\n\t}\n\n\tmutex_unlock(&cpu_mutex);\n\treturn 0;\n}"
  },
  {
    "function_name": "sysfs_cpu_notify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "888-906",
    "snippet": "static int sysfs_cpu_notify(struct notifier_block *self,\n\t\t\t\t      unsigned long action, void *hcpu)\n{\n\tunsigned int cpu = (unsigned int)(long)hcpu;\n\n\tswitch (action) {\n\tcase CPU_ONLINE:\n\tcase CPU_ONLINE_FROZEN:\n\t\tregister_cpu_online(cpu);\n\t\tbreak;\n#ifdef CONFIG_HOTPLUG_CPU\n\tcase CPU_DEAD:\n\tcase CPU_DEAD_FROZEN:\n\t\tunregister_cpu_online(cpu);\n\t\tbreak;\n#endif\n\t}\n\treturn NOTIFY_OK;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_cpu_online",
          "args": [
            "cpu"
          ],
          "line": 901
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_cpu_online",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "788-866",
          "snippet": "static void unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"cacheinfo.h\"",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [
            "#define HAS_PPC_PMC_G4\t\t1",
            "#define HAS_PPC_PMC_IBM\t\t1",
            "#define HAS_PPC_PMC_PA6T\t1",
            "#define HAS_PPC_PMC_IBM\t\t1"
          ],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cpu, cpu_devices);",
            "static DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_IBM\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\nstatic DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);\n\nstatic void unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic int sysfs_cpu_notify(struct notifier_block *self,\n\t\t\t\t      unsigned long action, void *hcpu)\n{\n\tunsigned int cpu = (unsigned int)(long)hcpu;\n\n\tswitch (action) {\n\tcase CPU_ONLINE:\n\tcase CPU_ONLINE_FROZEN:\n\t\tregister_cpu_online(cpu);\n\t\tbreak;\n#ifdef CONFIG_HOTPLUG_CPU\n\tcase CPU_DEAD:\n\tcase CPU_DEAD_FROZEN:\n\t\tunregister_cpu_online(cpu);\n\t\tbreak;\n#endif\n\t}\n\treturn NOTIFY_OK;\n}"
  },
  {
    "function_name": "arch_cpu_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "877-883",
    "snippet": "ssize_t arch_cpu_release(const char *buf, size_t count)\n{\n\tif (ppc_md.cpu_release)\n\t\treturn ppc_md.cpu_release(buf, count);\n\n\treturn -EINVAL;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.cpu_release",
          "args": [
            "buf",
            "count"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nssize_t arch_cpu_release(const char *buf, size_t count)\n{\n\tif (ppc_md.cpu_release)\n\t\treturn ppc_md.cpu_release(buf, count);\n\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "arch_cpu_probe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "869-875",
    "snippet": "ssize_t arch_cpu_probe(const char *buf, size_t count)\n{\n\tif (ppc_md.cpu_probe)\n\t\treturn ppc_md.cpu_probe(buf, count);\n\n\treturn -EINVAL;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.cpu_probe",
          "args": [
            "buf",
            "count"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nssize_t arch_cpu_probe(const char *buf, size_t count)\n{\n\tif (ppc_md.cpu_probe)\n\t\treturn ppc_md.cpu_probe(buf, count);\n\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "unregister_cpu_online",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "788-866",
    "snippet": "static void unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define HAS_PPC_PMC_G4\t\t1",
      "#define HAS_PPC_PMC_IBM\t\t1",
      "#define HAS_PPC_PMC_PA6T\t1",
      "#define HAS_PPC_PMC_IBM\t\t1"
    ],
    "globals_used": [
      "static DEFINE_PER_CPU(struct cpu, cpu_devices);",
      "static DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cacheinfo_cpu_offline",
          "args": [
            "cpu"
          ],
          "line": 865
        },
        "resolved": true,
        "details": {
          "function_name": "cacheinfo_cpu_offline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "849-869",
          "snippet": "void cacheinfo_cpu_offline(unsigned int cpu_id)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct cache *cache;\n\n\t/* Prevent userspace from seeing inconsistent state - remove\n\t * the sysfs hierarchy first */\n\tcache_dir = per_cpu(cache_dir_pcpu, cpu_id);\n\n\t/* careful, sysfs population may have failed */\n\tif (cache_dir)\n\t\tremove_cache_dir(cache_dir);\n\n\tper_cpu(cache_dir_pcpu, cpu_id) = NULL;\n\n\t/* clear the CPU's bit in its cache chain, possibly freeing\n\t * cache objects */\n\tcache = cache_lookup_by_cpu(cpu_id);\n\tif (cache)\n\t\tcache_cpu_clear(cache, cpu_id);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cache_dir *, cache_dir_pcpu);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic DEFINE_PER_CPU(struct cache_dir *, cache_dir_pcpu);\n\nvoid cacheinfo_cpu_offline(unsigned int cpu_id)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct cache *cache;\n\n\t/* Prevent userspace from seeing inconsistent state - remove\n\t * the sysfs hierarchy first */\n\tcache_dir = per_cpu(cache_dir_pcpu, cpu_id);\n\n\t/* careful, sysfs population may have failed */\n\tif (cache_dir)\n\t\tremove_cache_dir(cache_dir);\n\n\tper_cpu(cache_dir_pcpu, cpu_id) = NULL;\n\n\t/* clear the CPU's bit in its cache chain, possibly freeing\n\t * cache objects */\n\tcache = cache_lookup_by_cpu(cpu_id);\n\tif (cache)\n\t\tcache_cpu_clear(cache, cpu_id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_altivec_idle_wait_time"
          ],
          "line": 862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_altivec_idle"
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_pw20_wait_time"
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_pw20_state"
          ],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "cur_cpu_spec->pvr_value"
          ],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_pir"
          ],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_PPCAS_ARCH_V2"
          ],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_dscr"
          ],
          "line": 850
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_DSCR"
          ],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_spurr"
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SPURR"
          ],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_purr"
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_PURR"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_mmcra"
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_MMCRA"
          ],
          "line": 840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&pmc_attrs[i]"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&attrs[i]"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_remove_file",
          "args": [
            "s",
            "&dev_attr_smt_snooze_delay"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SMT"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!c->hotpluggable"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_devices",
            "cpu"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_IBM\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\nstatic DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);\n\nstatic void unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR))\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n}"
  },
  {
    "function_name": "register_cpu_online",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "706-785",
    "snippet": "static void register_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_create_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_create_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_create_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_create_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tif (!firmware_has_feature(FW_FEATURE_LPAR))\n\t\t\tadd_write_permission_dev_attr(&dev_attr_purr);\n\t\tdevice_create_file(s, &dev_attr_purr);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_create_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_create_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_create_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_create_file(s, &dev_attr_pw20_state);\n\t\tdevice_create_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_create_file(s, &dev_attr_altivec_idle);\n\t\tdevice_create_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_online(cpu);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define HAS_PPC_PMC_G4\t\t1",
      "#define HAS_PPC_PMC_IBM\t\t1",
      "#define HAS_PPC_PMC_PA6T\t1",
      "#define HAS_PPC_PMC_IBM\t\t1"
    ],
    "globals_used": [
      "static DEFINE_PER_CPU(struct cpu, cpu_devices);",
      "static DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cacheinfo_cpu_online",
          "args": [
            "cpu"
          ],
          "line": 784
        },
        "resolved": true,
        "details": {
          "function_name": "cacheinfo_cpu_online",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "769-778",
          "snippet": "void cacheinfo_cpu_online(unsigned int cpu_id)\n{\n\tstruct cache *cache;\n\n\tcache = cache_chain_instantiate(cpu_id);\n\tif (!cache)\n\t\treturn;\n\n\tcacheinfo_sysfs_populate(cpu_id, cache);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nvoid cacheinfo_cpu_online(unsigned int cpu_id)\n{\n\tstruct cache *cache;\n\n\tcache = cache_chain_instantiate(cpu_id);\n\tif (!cache)\n\t\treturn;\n\n\tcacheinfo_sysfs_populate(cpu_id, cache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_altivec_idle_wait_time"
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_altivec_idle"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_pw20_wait_time"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_pw20_state"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "cur_cpu_spec->pvr_value"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_pir"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_PPCAS_ARCH_V2"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_dscr"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_DSCR"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_spurr"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SPURR"
          ],
          "line": 765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_purr"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_write_permission_dev_attr",
          "args": [
            "&dev_attr_purr"
          ],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "add_write_permission_dev_attr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "539-542",
          "snippet": "static void add_write_permission_dev_attr(struct device_attribute *attr)\n{\n\tattr->attr.mode |= 0200;\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"cacheinfo.h\"",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void add_write_permission_dev_attr(struct device_attribute *attr)\n{\n\tattr->attr.mode |= 0200;\n}"
        }
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_PURR"
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_mmcra"
          ],
          "line": 757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_MMCRA"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&pmc_attrs[i]"
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&attrs[i]"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "s",
            "&dev_attr_smt_snooze_delay"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SMT"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_devices",
            "cpu"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_IBM\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\nstatic DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);\n\nstatic void register_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_create_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#ifdef HAS_PPC_PMC_PA6T\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_PA6T */\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_create_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_create_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_create_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tif (!firmware_has_feature(FW_FEATURE_LPAR))\n\t\t\tadd_write_permission_dev_attr(&dev_attr_purr);\n\t\tdevice_create_file(s, &dev_attr_purr);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR))\n\t\tdevice_create_file(s, &dev_attr_spurr);\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_create_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_create_file(s, &dev_attr_pir);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_create_file(s, &dev_attr_pw20_state);\n\t\tdevice_create_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_create_file(s, &dev_attr_altivec_idle);\n\t\tdevice_create_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_online(cpu);\n}"
  },
  {
    "function_name": "sysfs_create_dscr_default",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "587-592",
    "snippet": "static void sysfs_create_dscr_default(void)\n{\n\tint err = 0;\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\terr = device_create_file(cpu_subsys.dev_root, &dev_attr_dscr_default);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "device_create_file",
          "args": [
            "cpu_subsys.dev_root",
            "&dev_attr_dscr_default"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_DSCR"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void sysfs_create_dscr_default(void)\n{\n\tint err = 0;\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\terr = device_create_file(cpu_subsys.dev_root, &dev_attr_dscr_default);\n}"
  },
  {
    "function_name": "store_dscr_default",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "567-582",
    "snippet": "static ssize_t __used store_dscr_default(struct device *dev,\n\t\tstruct device_attribute *attr, const char *buf,\n\t\tsize_t count)\n{\n\tunsigned long val;\n\tint ret = 0;\n\t\n\tret = sscanf(buf, \"%lx\", &val);\n\tif (ret != 1)\n\t\treturn -EINVAL;\n\tdscr_default = val;\n\n\ton_each_cpu(write_dscr, &val, 1);\n\n\treturn count;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "on_each_cpu",
          "args": [
            "write_dscr",
            "&val",
            "1"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "buf",
            "\"%lx\"",
            "&val"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t __used store_dscr_default(struct device *dev,\n\t\tstruct device_attribute *attr, const char *buf,\n\t\tsize_t count)\n{\n\tunsigned long val;\n\tint ret = 0;\n\t\n\tret = sscanf(buf, \"%lx\", &val);\n\tif (ret != 1)\n\t\treturn -EINVAL;\n\tdscr_default = val;\n\n\ton_each_cpu(write_dscr, &val, 1);\n\n\treturn count;\n}"
  },
  {
    "function_name": "show_dscr_default",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "552-556",
    "snippet": "static ssize_t show_dscr_default(struct device *dev,\n\t\tstruct device_attribute *attr, char *buf)\n{\n\treturn sprintf(buf, \"%lx\\n\", dscr_default);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%lx\\n\"",
            "dscr_default"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t show_dscr_default(struct device *dev,\n\t\tstruct device_attribute *attr, char *buf)\n{\n\treturn sprintf(buf, \"%lx\\n\", dscr_default);\n}"
  },
  {
    "function_name": "add_write_permission_dev_attr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "539-542",
    "snippet": "static void add_write_permission_dev_attr(struct device_attribute *attr)\n{\n\tattr->attr.mode |= 0200;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void add_write_permission_dev_attr(struct device_attribute *attr)\n{\n\tattr->attr.mode |= 0200;\n}"
  },
  {
    "function_name": "write_dscr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "527-534",
    "snippet": "static void write_dscr(void *val)\n{\n\tget_paca()->dscr_default = *(unsigned long *)val;\n\tif (!current->thread.dscr_inherit) {\n\t\tcurrent->thread.dscr = *(unsigned long *)val;\n\t\tmtspr(SPRN_DSCR, *(unsigned long *)val);\n\t}\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_DSCR",
            "*(unsigned long *)val"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void write_dscr(void *val)\n{\n\tget_paca()->dscr_default = *(unsigned long *)val;\n\tif (!current->thread.dscr_inherit) {\n\t\tcurrent->thread.dscr = *(unsigned long *)val;\n\t\tmtspr(SPRN_DSCR, *(unsigned long *)val);\n\t}\n}"
  },
  {
    "function_name": "read_dscr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "514-517",
    "snippet": "static void read_dscr(void *val)\n{\n\t*(unsigned long *)val = get_paca()->dscr_default;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void read_dscr(void *val)\n{\n\t*(unsigned long *)val = get_paca()->dscr_default;\n}"
  },
  {
    "function_name": "ppc_enable_pmcs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "392-404",
    "snippet": "void ppc_enable_pmcs(void)\n{\n\tppc_set_pmu_inuse(1);\n\n\t/* Only need to enable them once */\n\tif (__this_cpu_read(pmcs_enabled))\n\t\treturn;\n\n\t__this_cpu_write(pmcs_enabled, 1);\n\n\tif (ppc_md.enable_pmcs)\n\t\tppc_md.enable_pmcs();\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(char, pmcs_enabled);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.enable_pmcs",
          "args": [],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__this_cpu_write",
          "args": [
            "pmcs_enabled",
            "1"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__this_cpu_read",
          "args": [
            "pmcs_enabled"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_set_pmu_inuse",
          "args": [
            "1"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic DEFINE_PER_CPU(char, pmcs_enabled);\n\nvoid ppc_enable_pmcs(void)\n{\n\tppc_set_pmu_inuse(1);\n\n\t/* Only need to enable them once */\n\tif (__this_cpu_read(pmcs_enabled))\n\t\treturn;\n\n\t__this_cpu_write(pmcs_enabled, 1);\n\n\tif (ppc_md.enable_pmcs)\n\t\tppc_md.enable_pmcs();\n}"
  },
  {
    "function_name": "store_altivec_idle_wait_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "332-357",
    "snippet": "static ssize_t store_altivec_idle_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 entry_bit;\n\tu64 value;\n\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou64(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (!value)\n\t\treturn -EINVAL;\n\n\tentry_bit = get_idle_ticks_bit(value);\n\tif (entry_bit > MAX_BIT)\n\t\treturn -EINVAL;\n\n\taltivec_idle_wt = value;\n\n\tsmp_call_function_single(cpu, set_altivec_idle_wait_entry_bit,\n\t\t\t\t&entry_bit, 1);\n\n\treturn count;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define MAX_BIT\t\t\t\t63"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "set_altivec_idle_wait_entry_bit",
            "&entry_bit",
            "1"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_idle_ticks_bit",
          "args": [
            "value"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "get_idle_ticks_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "93-106",
          "snippet": "static unsigned int get_idle_ticks_bit(u64 ns)\n{\n\tu64 cycle;\n\n\tif (ns >= 10000)\n\t\tcycle = div_u64(ns + 500, 1000) * tb_ticks_per_usec;\n\telse\n\t\tcycle = div_u64(ns * tb_ticks_per_usec, 1000);\n\n\tif (!cycle)\n\t\treturn 0;\n\n\treturn ilog2(cycle);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"cacheinfo.h\"",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic unsigned int get_idle_ticks_bit(u64 ns)\n{\n\tu64 cycle;\n\n\tif (ns >= 10000)\n\t\tcycle = div_u64(ns + 500, 1000) * tb_ticks_per_usec;\n\telse\n\t\tcycle = div_u64(ns * tb_ticks_per_usec, 1000);\n\n\tif (!cycle)\n\t\treturn 0;\n\n\treturn ilog2(cycle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrtou64",
          "args": [
            "buf",
            "0",
            "&value"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define MAX_BIT\t\t\t\t63\n\nstatic ssize_t store_altivec_idle_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 entry_bit;\n\tu64 value;\n\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou64(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (!value)\n\t\treturn -EINVAL;\n\n\tentry_bit = get_idle_ticks_bit(value);\n\tif (entry_bit > MAX_BIT)\n\t\treturn -EINVAL;\n\n\taltivec_idle_wt = value;\n\n\tsmp_call_function_single(cpu, set_altivec_idle_wait_entry_bit,\n\t\t\t\t&entry_bit, 1);\n\n\treturn count;\n}"
  },
  {
    "function_name": "set_altivec_idle_wait_entry_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "315-330",
    "snippet": "static void set_altivec_idle_wait_entry_bit(void *val)\n{\n\tu32 *value = val;\n\tu32 altivec_idle;\n\n\taltivec_idle = mfspr(SPRN_PWRMGTCR0);\n\n\t/* Set Automatic AltiVec Idle Count */\n\t/* clear count */\n\taltivec_idle &= ~PWRMGTCR0_AV_IDLE_CNT;\n\n\t/* set count */\n\taltivec_idle |= ((MAX_BIT - *value) << PWRMGTCR0_AV_IDLE_CNT_SHIFT);\n\n\tmtspr(SPRN_PWRMGTCR0, altivec_idle);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define MAX_BIT\t\t\t\t63"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_PWRMGTCR0",
            "altivec_idle"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PWRMGTCR0"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define MAX_BIT\t\t\t\t63\n\nstatic void set_altivec_idle_wait_entry_bit(void *val)\n{\n\tu32 *value = val;\n\tu32 altivec_idle;\n\n\taltivec_idle = mfspr(SPRN_PWRMGTCR0);\n\n\t/* Set Automatic AltiVec Idle Count */\n\t/* clear count */\n\taltivec_idle &= ~PWRMGTCR0_AV_IDLE_CNT;\n\n\t/* set count */\n\taltivec_idle |= ((MAX_BIT - *value) << PWRMGTCR0_AV_IDLE_CNT_SHIFT);\n\n\tmtspr(SPRN_PWRMGTCR0, altivec_idle);\n}"
  },
  {
    "function_name": "show_altivec_idle_wait_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "283-313",
    "snippet": "static ssize_t show_altivec_idle_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tu64 tb_cycle = 1;\n\tu64 time;\n\n\tunsigned int cpu = dev->id;\n\n\tif (!altivec_idle_wt) {\n\t\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\t\tvalue = (value & PWRMGTCR0_AV_IDLE_CNT) >>\n\t\t\t\t\tPWRMGTCR0_AV_IDLE_CNT_SHIFT;\n\n\t\ttb_cycle = (tb_cycle << (MAX_BIT - value + 1));\n\t\t/* convert ms to ns */\n\t\tif (tb_ticks_per_usec > 1000) {\n\t\t\ttime = div_u64(tb_cycle, tb_ticks_per_usec / 1000);\n\t\t} else {\n\t\t\tu32 rem_us;\n\n\t\t\ttime = div_u64_rem(tb_cycle, tb_ticks_per_usec,\n\t\t\t\t\t\t&rem_us);\n\t\t\ttime = time * 1000 + rem_us * 1000 / tb_ticks_per_usec;\n\t\t}\n\t} else {\n\t\ttime = altivec_idle_wt;\n\t}\n\n\treturn sprintf(buf, \"%llu\\n\", time > 0 ? time : 0);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define MAX_BIT\t\t\t\t63"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%llu\\n\"",
            "time > 0 ? time : 0"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64_rem",
          "args": [
            "tb_cycle",
            "tb_ticks_per_usec",
            "&rem_us"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "tb_cycle",
            "tb_ticks_per_usec / 1000"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "do_show_pwrmgtcr0",
            "&value",
            "1"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define MAX_BIT\t\t\t\t63\n\nstatic ssize_t show_altivec_idle_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tu64 tb_cycle = 1;\n\tu64 time;\n\n\tunsigned int cpu = dev->id;\n\n\tif (!altivec_idle_wt) {\n\t\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\t\tvalue = (value & PWRMGTCR0_AV_IDLE_CNT) >>\n\t\t\t\t\tPWRMGTCR0_AV_IDLE_CNT_SHIFT;\n\n\t\ttb_cycle = (tb_cycle << (MAX_BIT - value + 1));\n\t\t/* convert ms to ns */\n\t\tif (tb_ticks_per_usec > 1000) {\n\t\t\ttime = div_u64(tb_cycle, tb_ticks_per_usec / 1000);\n\t\t} else {\n\t\t\tu32 rem_us;\n\n\t\t\ttime = div_u64_rem(tb_cycle, tb_ticks_per_usec,\n\t\t\t\t\t\t&rem_us);\n\t\t\ttime = time * 1000 + rem_us * 1000 / tb_ticks_per_usec;\n\t\t}\n\t} else {\n\t\ttime = altivec_idle_wt;\n\t}\n\n\treturn sprintf(buf, \"%llu\\n\", time > 0 ? time : 0);\n}"
  },
  {
    "function_name": "store_altivec_idle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "265-281",
    "snippet": "static ssize_t store_altivec_idle(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou32(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (value > 1)\n\t\treturn -EINVAL;\n\n\tsmp_call_function_single(cpu, do_store_altivec_idle, &value, 1);\n\n\treturn count;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "do_store_altivec_idle",
            "&value",
            "1"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstrtou32",
          "args": [
            "buf",
            "0",
            "&value"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t store_altivec_idle(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou32(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (value > 1)\n\t\treturn -EINVAL;\n\n\tsmp_call_function_single(cpu, do_store_altivec_idle, &value, 1);\n\n\treturn count;\n}"
  },
  {
    "function_name": "do_store_altivec_idle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "250-263",
    "snippet": "static void do_store_altivec_idle(void *val)\n{\n\tu32 *value = val;\n\tu32 altivec_idle;\n\n\taltivec_idle = mfspr(SPRN_PWRMGTCR0);\n\n\tif (*value)\n\t\taltivec_idle |= PWRMGTCR0_AV_IDLE_PD_EN;\n\telse\n\t\taltivec_idle &= ~PWRMGTCR0_AV_IDLE_PD_EN;\n\n\tmtspr(SPRN_PWRMGTCR0, altivec_idle);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_PWRMGTCR0",
            "altivec_idle"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PWRMGTCR0"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void do_store_altivec_idle(void *val)\n{\n\tu32 *value = val;\n\tu32 altivec_idle;\n\n\taltivec_idle = mfspr(SPRN_PWRMGTCR0);\n\n\tif (*value)\n\t\taltivec_idle |= PWRMGTCR0_AV_IDLE_PD_EN;\n\telse\n\t\taltivec_idle &= ~PWRMGTCR0_AV_IDLE_PD_EN;\n\n\tmtspr(SPRN_PWRMGTCR0, altivec_idle);\n}"
  },
  {
    "function_name": "show_altivec_idle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "237-248",
    "snippet": "static ssize_t show_altivec_idle(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\n\tvalue &= PWRMGTCR0_AV_IDLE_PD_EN;\n\n\treturn sprintf(buf, \"%u\\n\", value ? 1 : 0);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%u\\n\"",
            "value ? 1 : 0"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "do_show_pwrmgtcr0",
            "&value",
            "1"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t show_altivec_idle(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\n\tvalue &= PWRMGTCR0_AV_IDLE_PD_EN;\n\n\treturn sprintf(buf, \"%u\\n\", value ? 1 : 0);\n}"
  },
  {
    "function_name": "store_pw20_wait_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "210-235",
    "snippet": "static ssize_t store_pw20_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 entry_bit;\n\tu64 value;\n\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou64(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (!value)\n\t\treturn -EINVAL;\n\n\tentry_bit = get_idle_ticks_bit(value);\n\tif (entry_bit > MAX_BIT)\n\t\treturn -EINVAL;\n\n\tpw20_wt = value;\n\n\tsmp_call_function_single(cpu, set_pw20_wait_entry_bit,\n\t\t\t\t&entry_bit, 1);\n\n\treturn count;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define MAX_BIT\t\t\t\t63"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "set_pw20_wait_entry_bit",
            "&entry_bit",
            "1"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_idle_ticks_bit",
          "args": [
            "value"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "get_idle_ticks_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "93-106",
          "snippet": "static unsigned int get_idle_ticks_bit(u64 ns)\n{\n\tu64 cycle;\n\n\tif (ns >= 10000)\n\t\tcycle = div_u64(ns + 500, 1000) * tb_ticks_per_usec;\n\telse\n\t\tcycle = div_u64(ns * tb_ticks_per_usec, 1000);\n\n\tif (!cycle)\n\t\treturn 0;\n\n\treturn ilog2(cycle);\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"cacheinfo.h\"",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic unsigned int get_idle_ticks_bit(u64 ns)\n{\n\tu64 cycle;\n\n\tif (ns >= 10000)\n\t\tcycle = div_u64(ns + 500, 1000) * tb_ticks_per_usec;\n\telse\n\t\tcycle = div_u64(ns * tb_ticks_per_usec, 1000);\n\n\tif (!cycle)\n\t\treturn 0;\n\n\treturn ilog2(cycle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrtou64",
          "args": [
            "buf",
            "0",
            "&value"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define MAX_BIT\t\t\t\t63\n\nstatic ssize_t store_pw20_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 entry_bit;\n\tu64 value;\n\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou64(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (!value)\n\t\treturn -EINVAL;\n\n\tentry_bit = get_idle_ticks_bit(value);\n\tif (entry_bit > MAX_BIT)\n\t\treturn -EINVAL;\n\n\tpw20_wt = value;\n\n\tsmp_call_function_single(cpu, set_pw20_wait_entry_bit,\n\t\t\t\t&entry_bit, 1);\n\n\treturn count;\n}"
  },
  {
    "function_name": "set_pw20_wait_entry_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "193-208",
    "snippet": "static void set_pw20_wait_entry_bit(void *val)\n{\n\tu32 *value = val;\n\tu32 pw20_idle;\n\n\tpw20_idle = mfspr(SPRN_PWRMGTCR0);\n\n\t/* Set Automatic PW20 Core Idle Count */\n\t/* clear count */\n\tpw20_idle &= ~PWRMGTCR0_PW20_ENT;\n\n\t/* set count */\n\tpw20_idle |= ((MAX_BIT - *value) << PWRMGTCR0_PW20_ENT_SHIFT);\n\n\tmtspr(SPRN_PWRMGTCR0, pw20_idle);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define MAX_BIT\t\t\t\t63"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_PWRMGTCR0",
            "pw20_idle"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PWRMGTCR0"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define MAX_BIT\t\t\t\t63\n\nstatic void set_pw20_wait_entry_bit(void *val)\n{\n\tu32 *value = val;\n\tu32 pw20_idle;\n\n\tpw20_idle = mfspr(SPRN_PWRMGTCR0);\n\n\t/* Set Automatic PW20 Core Idle Count */\n\t/* clear count */\n\tpw20_idle &= ~PWRMGTCR0_PW20_ENT;\n\n\t/* set count */\n\tpw20_idle |= ((MAX_BIT - *value) << PWRMGTCR0_PW20_ENT_SHIFT);\n\n\tmtspr(SPRN_PWRMGTCR0, pw20_idle);\n}"
  },
  {
    "function_name": "show_pw20_wait_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "161-191",
    "snippet": "static ssize_t show_pw20_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tu64 tb_cycle = 1;\n\tu64 time;\n\n\tunsigned int cpu = dev->id;\n\n\tif (!pw20_wt) {\n\t\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\t\tvalue = (value & PWRMGTCR0_PW20_ENT) >>\n\t\t\t\t\tPWRMGTCR0_PW20_ENT_SHIFT;\n\n\t\ttb_cycle = (tb_cycle << (MAX_BIT - value + 1));\n\t\t/* convert ms to ns */\n\t\tif (tb_ticks_per_usec > 1000) {\n\t\t\ttime = div_u64(tb_cycle, tb_ticks_per_usec / 1000);\n\t\t} else {\n\t\t\tu32 rem_us;\n\n\t\t\ttime = div_u64_rem(tb_cycle, tb_ticks_per_usec,\n\t\t\t\t\t\t&rem_us);\n\t\t\ttime = time * 1000 + rem_us * 1000 / tb_ticks_per_usec;\n\t\t}\n\t} else {\n\t\ttime = pw20_wt;\n\t}\n\n\treturn sprintf(buf, \"%llu\\n\", time > 0 ? time : 0);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [
      "#define MAX_BIT\t\t\t\t63"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%llu\\n\"",
            "time > 0 ? time : 0"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64_rem",
          "args": [
            "tb_cycle",
            "tb_ticks_per_usec",
            "&rem_us"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "tb_cycle",
            "tb_ticks_per_usec / 1000"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "do_show_pwrmgtcr0",
            "&value",
            "1"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define MAX_BIT\t\t\t\t63\n\nstatic ssize_t show_pw20_wait_time(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tu64 tb_cycle = 1;\n\tu64 time;\n\n\tunsigned int cpu = dev->id;\n\n\tif (!pw20_wt) {\n\t\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\t\tvalue = (value & PWRMGTCR0_PW20_ENT) >>\n\t\t\t\t\tPWRMGTCR0_PW20_ENT_SHIFT;\n\n\t\ttb_cycle = (tb_cycle << (MAX_BIT - value + 1));\n\t\t/* convert ms to ns */\n\t\tif (tb_ticks_per_usec > 1000) {\n\t\t\ttime = div_u64(tb_cycle, tb_ticks_per_usec / 1000);\n\t\t} else {\n\t\t\tu32 rem_us;\n\n\t\t\ttime = div_u64_rem(tb_cycle, tb_ticks_per_usec,\n\t\t\t\t\t\t&rem_us);\n\t\t\ttime = time * 1000 + rem_us * 1000 / tb_ticks_per_usec;\n\t\t}\n\t} else {\n\t\ttime = pw20_wt;\n\t}\n\n\treturn sprintf(buf, \"%llu\\n\", time > 0 ? time : 0);\n}"
  },
  {
    "function_name": "store_pw20_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "143-159",
    "snippet": "static ssize_t store_pw20_state(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou32(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (value > 1)\n\t\treturn -EINVAL;\n\n\tsmp_call_function_single(cpu, do_store_pw20_state, &value, 1);\n\n\treturn count;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "do_store_pw20_state",
            "&value",
            "1"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstrtou32",
          "args": [
            "buf",
            "0",
            "&value"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t store_pw20_state(struct device *dev,\n\t\t\t\tstruct device_attribute *attr,\n\t\t\t\tconst char *buf, size_t count)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tif (kstrtou32(buf, 0, &value))\n\t\treturn -EINVAL;\n\n\tif (value > 1)\n\t\treturn -EINVAL;\n\n\tsmp_call_function_single(cpu, do_store_pw20_state, &value, 1);\n\n\treturn count;\n}"
  },
  {
    "function_name": "do_store_pw20_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "128-141",
    "snippet": "static void do_store_pw20_state(void *val)\n{\n\tu32 *value = val;\n\tu32 pw20_state;\n\n\tpw20_state = mfspr(SPRN_PWRMGTCR0);\n\n\tif (*value)\n\t\tpw20_state |= PWRMGTCR0_PW20_WAIT;\n\telse\n\t\tpw20_state &= ~PWRMGTCR0_PW20_WAIT;\n\n\tmtspr(SPRN_PWRMGTCR0, pw20_state);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_PWRMGTCR0",
            "pw20_state"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PWRMGTCR0"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void do_store_pw20_state(void *val)\n{\n\tu32 *value = val;\n\tu32 pw20_state;\n\n\tpw20_state = mfspr(SPRN_PWRMGTCR0);\n\n\tif (*value)\n\t\tpw20_state |= PWRMGTCR0_PW20_WAIT;\n\telse\n\t\tpw20_state &= ~PWRMGTCR0_PW20_WAIT;\n\n\tmtspr(SPRN_PWRMGTCR0, pw20_state);\n}"
  },
  {
    "function_name": "show_pw20_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "115-126",
    "snippet": "static ssize_t show_pw20_state(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\n\tvalue &= PWRMGTCR0_PW20_WAIT;\n\n\treturn sprintf(buf, \"%u\\n\", value ? 1 : 0);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%u\\n\"",
            "value ? 1 : 0"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_call_function_single",
          "args": [
            "cpu",
            "do_show_pwrmgtcr0",
            "&value",
            "1"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t show_pw20_state(struct device *dev,\n\t\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tu32 value;\n\tunsigned int cpu = dev->id;\n\n\tsmp_call_function_single(cpu, do_show_pwrmgtcr0, &value, 1);\n\n\tvalue &= PWRMGTCR0_PW20_WAIT;\n\n\treturn sprintf(buf, \"%u\\n\", value ? 1 : 0);\n}"
  },
  {
    "function_name": "do_show_pwrmgtcr0",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "108-113",
    "snippet": "static void do_show_pwrmgtcr0(void *val)\n{\n\tu32 *value = val;\n\n\t*value = mfspr(SPRN_PWRMGTCR0);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PWRMGTCR0"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic void do_show_pwrmgtcr0(void *val)\n{\n\tu32 *value = val;\n\n\t*value = mfspr(SPRN_PWRMGTCR0);\n}"
  },
  {
    "function_name": "get_idle_ticks_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "93-106",
    "snippet": "static unsigned int get_idle_ticks_bit(u64 ns)\n{\n\tu64 cycle;\n\n\tif (ns >= 10000)\n\t\tcycle = div_u64(ns + 500, 1000) * tb_ticks_per_usec;\n\telse\n\t\tcycle = div_u64(ns * tb_ticks_per_usec, 1000);\n\n\tif (!cycle)\n\t\treturn 0;\n\n\treturn ilog2(cycle);\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ilog2",
          "args": [
            "cycle"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "ns * tb_ticks_per_usec",
            "1000"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "ns + 500",
            "1000"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic unsigned int get_idle_ticks_bit(u64 ns)\n{\n\tu64 cycle;\n\n\tif (ns >= 10000)\n\t\tcycle = div_u64(ns + 500, 1000) * tb_ticks_per_usec;\n\telse\n\t\tcycle = div_u64(ns * tb_ticks_per_usec, 1000);\n\n\tif (!cycle)\n\t\treturn 0;\n\n\treturn ilog2(cycle);\n}"
  },
  {
    "function_name": "setup_smt_snooze_delay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "69-82",
    "snippet": "static int __init setup_smt_snooze_delay(char *str)\n{\n\tunsigned int cpu;\n\tlong snooze;\n\n\tif (!cpu_has_feature(CPU_FTR_SMT))\n\t\treturn 1;\n\n\tsnooze = simple_strtol(str, NULL, 10);\n\tfor_each_possible_cpu(cpu)\n\t\tper_cpu(smt_snooze_delay, cpu) = snooze;\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_strtol",
          "args": [
            "str",
            "NULL",
            "10"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SMT"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic DEVICE_ATTR(physical_id, 0444, show_physical_id, NULL);\n\nstatic int __init setup_smt_snooze_delay(char *str)\n{\n\tunsigned int cpu;\n\tlong snooze;\n\n\tif (!cpu_has_feature(CPU_FTR_SMT))\n\t\treturn 1;\n\n\tsnooze = simple_strtol(str, NULL, 10);\n\tfor_each_possible_cpu(cpu)\n\t\tper_cpu(smt_snooze_delay, cpu) = snooze;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "show_smt_snooze_delay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "57-64",
    "snippet": "static ssize_t show_smt_snooze_delay(struct device *dev,\n\t\t\t\t     struct device_attribute *attr,\n\t\t\t\t     char *buf)\n{\n\tstruct cpu *cpu = container_of(dev, struct cpu, dev);\n\n\treturn sprintf(buf, \"%ld\\n\", per_cpu(smt_snooze_delay, cpu->dev.id));\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%ld\\n\"",
            "per_cpu(smt_snooze_delay, cpu->dev.id)"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "smt_snooze_delay",
            "cpu->dev.id"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "dev",
            "structcpu",
            "dev"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t show_smt_snooze_delay(struct device *dev,\n\t\t\t\t     struct device_attribute *attr,\n\t\t\t\t     char *buf)\n{\n\tstruct cpu *cpu = container_of(dev, struct cpu, dev);\n\n\treturn sprintf(buf, \"%ld\\n\", per_cpu(smt_snooze_delay, cpu->dev.id));\n}"
  },
  {
    "function_name": "store_smt_snooze_delay",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2015-8845/repo/arch/powerpc/kernel/sysfs.c",
    "lines": "40-55",
    "snippet": "static ssize_t store_smt_snooze_delay(struct device *dev,\n\t\t\t\t      struct device_attribute *attr,\n\t\t\t\t      const char *buf,\n\t\t\t\t      size_t count)\n{\n\tstruct cpu *cpu = container_of(dev, struct cpu, dev);\n\tssize_t ret;\n\tlong snooze;\n\n\tret = sscanf(buf, \"%ld\", &snooze);\n\tif (ret != 1)\n\t\treturn -EINVAL;\n\n\tper_cpu(smt_snooze_delay, cpu->dev.id) = snooze;\n\treturn count;\n}",
    "includes": [
      "#include <asm/lppaca.h>",
      "#include <asm/paca.h>",
      "#include \"cacheinfo.h\"",
      "#include <asm/firmware.h>",
      "#include <asm/pmc.h>",
      "#include <asm/smp.h>",
      "#include <asm/machdep.h>",
      "#include <asm/prom.h>",
      "#include <asm/hvcall.h>",
      "#include <asm/cputable.h>",
      "#include <asm/processor.h>",
      "#include <asm/current.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/nodemask.h>",
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/percpu.h>",
      "#include <linux/smp.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "smt_snooze_delay",
            "cpu->dev.id"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "buf",
            "\"%ld\"",
            "&snooze"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "dev",
            "structcpu",
            "dev"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"cacheinfo.h\"\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\nstatic ssize_t store_smt_snooze_delay(struct device *dev,\n\t\t\t\t      struct device_attribute *attr,\n\t\t\t\t      const char *buf,\n\t\t\t\t      size_t count)\n{\n\tstruct cpu *cpu = container_of(dev, struct cpu, dev);\n\tssize_t ret;\n\tlong snooze;\n\n\tret = sscanf(buf, \"%ld\", &snooze);\n\tif (ret != 1)\n\t\treturn -EINVAL;\n\n\tper_cpu(smt_snooze_delay, cpu->dev.id) = snooze;\n\treturn count;\n}"
  }
]