[
  {
    "function_name": "pc_clock_settime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "306-328",
    "snippet": "static int pc_clock_settime(clockid_t id, const struct timespec64 *ts)\n{\n\tstruct posix_clock_desc cd;\n\tint err;\n\n\terr = get_clock_desc(id, &cd);\n\tif (err)\n\t\treturn err;\n\n\tif ((cd.fp->f_mode & FMODE_WRITE) == 0) {\n\t\terr = -EACCES;\n\t\tgoto out;\n\t}\n\n\tif (cd.clk->ops.clock_settime)\n\t\terr = cd.clk->ops.clock_settime(cd.clk, ts);\n\telse\n\t\terr = -EOPNOTSUPP;\nout:\n\tput_clock_desc(&cd);\n\n\treturn err;\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_clock_desc",
          "args": [
            "&cd"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "put_clock_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "238-242",
          "snippet": "static void put_clock_desc(struct posix_clock_desc *cd)\n{\n\tput_posix_clock(cd->clk);\n\tfput(cd->fp);\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void put_clock_desc(struct posix_clock_desc *cd)\n{\n\tput_posix_clock(cd->clk);\n\tfput(cd->fp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cd.clk->ops.clock_settime",
          "args": [
            "cd.clk",
            "ts"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_clock_desc",
          "args": [
            "id",
            "&cd"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "get_clock_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "217-236",
          "snippet": "static int get_clock_desc(const clockid_t id, struct posix_clock_desc *cd)\n{\n\tstruct file *fp = fget(clockid_to_fd(id));\n\tint err = -EINVAL;\n\n\tif (!fp)\n\t\treturn err;\n\n\tif (fp->f_op->open != posix_clock_open || !fp->private_data)\n\t\tgoto out;\n\n\tcd->fp = fp;\n\tcd->clk = get_posix_clock(fp);\n\n\terr = cd->clk ? 0 : -ENODEV;\nout:\n\tif (err)\n\t\tfput(fp);\n\treturn err;\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic int get_clock_desc(const clockid_t id, struct posix_clock_desc *cd)\n{\n\tstruct file *fp = fget(clockid_to_fd(id));\n\tint err = -EINVAL;\n\n\tif (!fp)\n\t\treturn err;\n\n\tif (fp->f_op->open != posix_clock_open || !fp->private_data)\n\t\tgoto out;\n\n\tcd->fp = fp;\n\tcd->clk = get_posix_clock(fp);\n\n\terr = cd->clk ? 0 : -ENODEV;\nout:\n\tif (err)\n\t\tfput(fp);\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic int pc_clock_settime(clockid_t id, const struct timespec64 *ts)\n{\n\tstruct posix_clock_desc cd;\n\tint err;\n\n\terr = get_clock_desc(id, &cd);\n\tif (err)\n\t\treturn err;\n\n\tif ((cd.fp->f_mode & FMODE_WRITE) == 0) {\n\t\terr = -EACCES;\n\t\tgoto out;\n\t}\n\n\tif (cd.clk->ops.clock_settime)\n\t\terr = cd.clk->ops.clock_settime(cd.clk, ts);\n\telse\n\t\terr = -EOPNOTSUPP;\nout:\n\tput_clock_desc(&cd);\n\n\treturn err;\n}"
  },
  {
    "function_name": "pc_clock_getres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "287-304",
    "snippet": "static int pc_clock_getres(clockid_t id, struct timespec64 *ts)\n{\n\tstruct posix_clock_desc cd;\n\tint err;\n\n\terr = get_clock_desc(id, &cd);\n\tif (err)\n\t\treturn err;\n\n\tif (cd.clk->ops.clock_getres)\n\t\terr = cd.clk->ops.clock_getres(cd.clk, ts);\n\telse\n\t\terr = -EOPNOTSUPP;\n\n\tput_clock_desc(&cd);\n\n\treturn err;\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_clock_desc",
          "args": [
            "&cd"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "put_clock_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "238-242",
          "snippet": "static void put_clock_desc(struct posix_clock_desc *cd)\n{\n\tput_posix_clock(cd->clk);\n\tfput(cd->fp);\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void put_clock_desc(struct posix_clock_desc *cd)\n{\n\tput_posix_clock(cd->clk);\n\tfput(cd->fp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cd.clk->ops.clock_getres",
          "args": [
            "cd.clk",
            "ts"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_clock_desc",
          "args": [
            "id",
            "&cd"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "get_clock_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "217-236",
          "snippet": "static int get_clock_desc(const clockid_t id, struct posix_clock_desc *cd)\n{\n\tstruct file *fp = fget(clockid_to_fd(id));\n\tint err = -EINVAL;\n\n\tif (!fp)\n\t\treturn err;\n\n\tif (fp->f_op->open != posix_clock_open || !fp->private_data)\n\t\tgoto out;\n\n\tcd->fp = fp;\n\tcd->clk = get_posix_clock(fp);\n\n\terr = cd->clk ? 0 : -ENODEV;\nout:\n\tif (err)\n\t\tfput(fp);\n\treturn err;\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic int get_clock_desc(const clockid_t id, struct posix_clock_desc *cd)\n{\n\tstruct file *fp = fget(clockid_to_fd(id));\n\tint err = -EINVAL;\n\n\tif (!fp)\n\t\treturn err;\n\n\tif (fp->f_op->open != posix_clock_open || !fp->private_data)\n\t\tgoto out;\n\n\tcd->fp = fp;\n\tcd->clk = get_posix_clock(fp);\n\n\terr = cd->clk ? 0 : -ENODEV;\nout:\n\tif (err)\n\t\tfput(fp);\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic int pc_clock_getres(clockid_t id, struct timespec64 *ts)\n{\n\tstruct posix_clock_desc cd;\n\tint err;\n\n\terr = get_clock_desc(id, &cd);\n\tif (err)\n\t\treturn err;\n\n\tif (cd.clk->ops.clock_getres)\n\t\terr = cd.clk->ops.clock_getres(cd.clk, ts);\n\telse\n\t\terr = -EOPNOTSUPP;\n\n\tput_clock_desc(&cd);\n\n\treturn err;\n}"
  },
  {
    "function_name": "pc_clock_gettime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "268-285",
    "snippet": "static int pc_clock_gettime(clockid_t id, struct timespec64 *ts)\n{\n\tstruct posix_clock_desc cd;\n\tint err;\n\n\terr = get_clock_desc(id, &cd);\n\tif (err)\n\t\treturn err;\n\n\tif (cd.clk->ops.clock_gettime)\n\t\terr = cd.clk->ops.clock_gettime(cd.clk, ts);\n\telse\n\t\terr = -EOPNOTSUPP;\n\n\tput_clock_desc(&cd);\n\n\treturn err;\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_clock_desc",
          "args": [
            "&cd"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "put_clock_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "238-242",
          "snippet": "static void put_clock_desc(struct posix_clock_desc *cd)\n{\n\tput_posix_clock(cd->clk);\n\tfput(cd->fp);\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void put_clock_desc(struct posix_clock_desc *cd)\n{\n\tput_posix_clock(cd->clk);\n\tfput(cd->fp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cd.clk->ops.clock_gettime",
          "args": [
            "cd.clk",
            "ts"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_clock_desc",
          "args": [
            "id",
            "&cd"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "get_clock_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "217-236",
          "snippet": "static int get_clock_desc(const clockid_t id, struct posix_clock_desc *cd)\n{\n\tstruct file *fp = fget(clockid_to_fd(id));\n\tint err = -EINVAL;\n\n\tif (!fp)\n\t\treturn err;\n\n\tif (fp->f_op->open != posix_clock_open || !fp->private_data)\n\t\tgoto out;\n\n\tcd->fp = fp;\n\tcd->clk = get_posix_clock(fp);\n\n\terr = cd->clk ? 0 : -ENODEV;\nout:\n\tif (err)\n\t\tfput(fp);\n\treturn err;\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic int get_clock_desc(const clockid_t id, struct posix_clock_desc *cd)\n{\n\tstruct file *fp = fget(clockid_to_fd(id));\n\tint err = -EINVAL;\n\n\tif (!fp)\n\t\treturn err;\n\n\tif (fp->f_op->open != posix_clock_open || !fp->private_data)\n\t\tgoto out;\n\n\tcd->fp = fp;\n\tcd->clk = get_posix_clock(fp);\n\n\terr = cd->clk ? 0 : -ENODEV;\nout:\n\tif (err)\n\t\tfput(fp);\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic int pc_clock_gettime(clockid_t id, struct timespec64 *ts)\n{\n\tstruct posix_clock_desc cd;\n\tint err;\n\n\terr = get_clock_desc(id, &cd);\n\tif (err)\n\t\treturn err;\n\n\tif (cd.clk->ops.clock_gettime)\n\t\terr = cd.clk->ops.clock_gettime(cd.clk, ts);\n\telse\n\t\terr = -EOPNOTSUPP;\n\n\tput_clock_desc(&cd);\n\n\treturn err;\n}"
  },
  {
    "function_name": "pc_clock_adjtime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "244-266",
    "snippet": "static int pc_clock_adjtime(clockid_t id, struct timex *tx)\n{\n\tstruct posix_clock_desc cd;\n\tint err;\n\n\terr = get_clock_desc(id, &cd);\n\tif (err)\n\t\treturn err;\n\n\tif ((cd.fp->f_mode & FMODE_WRITE) == 0) {\n\t\terr = -EACCES;\n\t\tgoto out;\n\t}\n\n\tif (cd.clk->ops.clock_adjtime)\n\t\terr = cd.clk->ops.clock_adjtime(cd.clk, tx);\n\telse\n\t\terr = -EOPNOTSUPP;\nout:\n\tput_clock_desc(&cd);\n\n\treturn err;\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_clock_desc",
          "args": [
            "&cd"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "put_clock_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "238-242",
          "snippet": "static void put_clock_desc(struct posix_clock_desc *cd)\n{\n\tput_posix_clock(cd->clk);\n\tfput(cd->fp);\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void put_clock_desc(struct posix_clock_desc *cd)\n{\n\tput_posix_clock(cd->clk);\n\tfput(cd->fp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cd.clk->ops.clock_adjtime",
          "args": [
            "cd.clk",
            "tx"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_clock_desc",
          "args": [
            "id",
            "&cd"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "get_clock_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "217-236",
          "snippet": "static int get_clock_desc(const clockid_t id, struct posix_clock_desc *cd)\n{\n\tstruct file *fp = fget(clockid_to_fd(id));\n\tint err = -EINVAL;\n\n\tif (!fp)\n\t\treturn err;\n\n\tif (fp->f_op->open != posix_clock_open || !fp->private_data)\n\t\tgoto out;\n\n\tcd->fp = fp;\n\tcd->clk = get_posix_clock(fp);\n\n\terr = cd->clk ? 0 : -ENODEV;\nout:\n\tif (err)\n\t\tfput(fp);\n\treturn err;\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic int get_clock_desc(const clockid_t id, struct posix_clock_desc *cd)\n{\n\tstruct file *fp = fget(clockid_to_fd(id));\n\tint err = -EINVAL;\n\n\tif (!fp)\n\t\treturn err;\n\n\tif (fp->f_op->open != posix_clock_open || !fp->private_data)\n\t\tgoto out;\n\n\tcd->fp = fp;\n\tcd->clk = get_posix_clock(fp);\n\n\terr = cd->clk ? 0 : -ENODEV;\nout:\n\tif (err)\n\t\tfput(fp);\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic int pc_clock_adjtime(clockid_t id, struct timex *tx)\n{\n\tstruct posix_clock_desc cd;\n\tint err;\n\n\terr = get_clock_desc(id, &cd);\n\tif (err)\n\t\treturn err;\n\n\tif ((cd.fp->f_mode & FMODE_WRITE) == 0) {\n\t\terr = -EACCES;\n\t\tgoto out;\n\t}\n\n\tif (cd.clk->ops.clock_adjtime)\n\t\terr = cd.clk->ops.clock_adjtime(cd.clk, tx);\n\telse\n\t\terr = -EOPNOTSUPP;\nout:\n\tput_clock_desc(&cd);\n\n\treturn err;\n}"
  },
  {
    "function_name": "put_clock_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "238-242",
    "snippet": "static void put_clock_desc(struct posix_clock_desc *cd)\n{\n\tput_posix_clock(cd->clk);\n\tfput(cd->fp);\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fput",
          "args": [
            "cd->fp"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_posix_clock",
          "args": [
            "cd->clk"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "put_posix_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "49-52",
          "snippet": "static void put_posix_clock(struct posix_clock *clk)\n{\n\tup_read(&clk->rwsem);\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void put_posix_clock(struct posix_clock *clk)\n{\n\tup_read(&clk->rwsem);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void put_clock_desc(struct posix_clock_desc *cd)\n{\n\tput_posix_clock(cd->clk);\n\tfput(cd->fp);\n}"
  },
  {
    "function_name": "get_clock_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "217-236",
    "snippet": "static int get_clock_desc(const clockid_t id, struct posix_clock_desc *cd)\n{\n\tstruct file *fp = fget(clockid_to_fd(id));\n\tint err = -EINVAL;\n\n\tif (!fp)\n\t\treturn err;\n\n\tif (fp->f_op->open != posix_clock_open || !fp->private_data)\n\t\tgoto out;\n\n\tcd->fp = fp;\n\tcd->clk = get_posix_clock(fp);\n\n\terr = cd->clk ? 0 : -ENODEV;\nout:\n\tif (err)\n\t\tfput(fp);\n\treturn err;\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fput",
          "args": [
            "fp"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_posix_clock",
          "args": [
            "fp"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "get_posix_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "35-47",
          "snippet": "static struct posix_clock *get_posix_clock(struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\n\tdown_read(&clk->rwsem);\n\n\tif (!clk->zombie)\n\t\treturn clk;\n\n\tup_read(&clk->rwsem);\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic struct posix_clock *get_posix_clock(struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\n\tdown_read(&clk->rwsem);\n\n\tif (!clk->zombie)\n\t\treturn clk;\n\n\tup_read(&clk->rwsem);\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fget",
          "args": [
            "clockid_to_fd(id)"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clockid_to_fd",
          "args": [
            "id"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic int get_clock_desc(const clockid_t id, struct posix_clock_desc *cd)\n{\n\tstruct file *fp = fget(clockid_to_fd(id));\n\tint err = -EINVAL;\n\n\tif (!fp)\n\t\treturn err;\n\n\tif (fp->f_op->open != posix_clock_open || !fp->private_data)\n\t\tgoto out;\n\n\tcd->fp = fp;\n\tcd->clk = get_posix_clock(fp);\n\n\terr = cd->clk ? 0 : -ENODEV;\nout:\n\tif (err)\n\t\tfput(fp);\n\treturn err;\n}"
  },
  {
    "function_name": "posix_clock_unregister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "200-209",
    "snippet": "void posix_clock_unregister(struct posix_clock *clk)\n{\n\tcdev_del(&clk->cdev);\n\n\tdown_write(&clk->rwsem);\n\tclk->zombie = true;\n\tup_write(&clk->rwsem);\n\n\tkref_put(&clk->kref, delete_clock);\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void delete_clock(struct kref *kref);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_put",
          "args": [
            "&clk->kref",
            "delete_clock"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_write",
          "args": [
            "&clk->rwsem"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "percpu_up_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/percpu-rwsem.c",
          "lines": "166-191",
          "snippet": "void percpu_up_write(struct percpu_rw_semaphore *sem)\n{\n\t/*\n\t * Signal the writer is done, no fast path yet.\n\t *\n\t * One reason that we cannot just immediately flip to readers_fast is\n\t * that new readers might fail to see the results of this writer's\n\t * critical section.\n\t *\n\t * Therefore we force it through the slow path which guarantees an\n\t * acquire and thereby guarantees the critical section's consistency.\n\t */\n\tsmp_store_release(&sem->readers_block, 0);\n\n\t/*\n\t * Release the write lock, this will allow readers back in the game.\n\t */\n\tup_write(&sem->rw_sem);\n\n\t/*\n\t * Once this completes (at least one RCU-sched grace period hence) the\n\t * reader fast path will be available again. Safe to use outside the\n\t * exclusive write lock because its counting.\n\t */\n\trcu_sync_exit(&sem->rss);\n}",
          "includes": [
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/rcupdate.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/lockdep.h>\n#include <linux/percpu.h>\n#include <linux/rwsem.h>\n#include <linux/atomic.h>\n\nvoid percpu_up_write(struct percpu_rw_semaphore *sem)\n{\n\t/*\n\t * Signal the writer is done, no fast path yet.\n\t *\n\t * One reason that we cannot just immediately flip to readers_fast is\n\t * that new readers might fail to see the results of this writer's\n\t * critical section.\n\t *\n\t * Therefore we force it through the slow path which guarantees an\n\t * acquire and thereby guarantees the critical section's consistency.\n\t */\n\tsmp_store_release(&sem->readers_block, 0);\n\n\t/*\n\t * Release the write lock, this will allow readers back in the game.\n\t */\n\tup_write(&sem->rw_sem);\n\n\t/*\n\t * Once this completes (at least one RCU-sched grace period hence) the\n\t * reader fast path will be available again. Safe to use outside the\n\t * exclusive write lock because its counting.\n\t */\n\trcu_sync_exit(&sem->rss);\n}"
        }
      },
      {
        "call_info": {
          "callee": "down_write",
          "args": [
            "&clk->rwsem"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "percpu_down_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/percpu-rwsem.c",
          "lines": "140-163",
          "snippet": "void percpu_down_write(struct percpu_rw_semaphore *sem)\n{\n\t/* Notify readers to take the slow path. */\n\trcu_sync_enter(&sem->rss);\n\n\tdown_write(&sem->rw_sem);\n\n\t/*\n\t * Notify new readers to block; up until now, and thus throughout the\n\t * longish rcu_sync_enter() above, new readers could still come in.\n\t */\n\tWRITE_ONCE(sem->readers_block, 1);\n\n\tsmp_mb(); /* D matches A */\n\n\t/*\n\t * If they don't see our writer of readers_block, then we are\n\t * guaranteed to see their sem->read_count increment, and therefore\n\t * will wait for them.\n\t */\n\n\t/* Wait for all now active readers to complete. */\n\trcuwait_wait_event(&sem->writer, readers_active_check(sem));\n}",
          "includes": [
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/rcupdate.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/lockdep.h>\n#include <linux/percpu.h>\n#include <linux/rwsem.h>\n#include <linux/atomic.h>\n\nvoid percpu_down_write(struct percpu_rw_semaphore *sem)\n{\n\t/* Notify readers to take the slow path. */\n\trcu_sync_enter(&sem->rss);\n\n\tdown_write(&sem->rw_sem);\n\n\t/*\n\t * Notify new readers to block; up until now, and thus throughout the\n\t * longish rcu_sync_enter() above, new readers could still come in.\n\t */\n\tWRITE_ONCE(sem->readers_block, 1);\n\n\tsmp_mb(); /* D matches A */\n\n\t/*\n\t * If they don't see our writer of readers_block, then we are\n\t * guaranteed to see their sem->read_count increment, and therefore\n\t * will wait for them.\n\t */\n\n\t/* Wait for all now active readers to complete. */\n\trcuwait_wait_event(&sem->writer, readers_active_check(sem));\n}"
        }
      },
      {
        "call_info": {
          "callee": "cdev_del",
          "args": [
            "&clk->cdev"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void delete_clock(struct kref *kref);\n\nvoid posix_clock_unregister(struct posix_clock *clk)\n{\n\tcdev_del(&clk->cdev);\n\n\tdown_write(&clk->rwsem);\n\tclk->zombie = true;\n\tup_write(&clk->rwsem);\n\n\tkref_put(&clk->kref, delete_clock);\n}"
  },
  {
    "function_name": "delete_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "192-198",
    "snippet": "static void delete_clock(struct kref *kref)\n{\n\tstruct posix_clock *clk = container_of(kref, struct posix_clock, kref);\n\n\tif (clk->release)\n\t\tclk->release(clk);\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void delete_clock(struct kref *kref);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "clk->release",
          "args": [
            "clk"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kref",
            "structposix_clock",
            "kref"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void delete_clock(struct kref *kref);\n\nstatic void delete_clock(struct kref *kref)\n{\n\tstruct posix_clock *clk = container_of(kref, struct posix_clock, kref);\n\n\tif (clk->release)\n\t\tclk->release(clk);\n}"
  },
  {
    "function_name": "posix_clock_register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "177-189",
    "snippet": "int posix_clock_register(struct posix_clock *clk, dev_t devid)\n{\n\tint err;\n\n\tkref_init(&clk->kref);\n\tinit_rwsem(&clk->rwsem);\n\n\tcdev_init(&clk->cdev, &posix_clock_file_operations);\n\tclk->cdev.owner = clk->ops.owner;\n\terr = cdev_add(&clk->cdev, devid, 1);\n\n\treturn err;\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void delete_clock(struct kref *kref);",
      "static const struct file_operations posix_clock_file_operations = {\n\t.owner\t\t= THIS_MODULE,\n\t.llseek\t\t= no_llseek,\n\t.read\t\t= posix_clock_read,\n\t.poll\t\t= posix_clock_poll,\n\t.unlocked_ioctl\t= posix_clock_ioctl,\n\t.open\t\t= posix_clock_open,\n\t.release\t= posix_clock_release,\n#ifdef CONFIG_COMPAT\n\t.compat_ioctl\t= posix_clock_compat_ioctl,\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cdev_add",
          "args": [
            "&clk->cdev",
            "devid",
            "1"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cdev_init",
          "args": [
            "&clk->cdev",
            "&posix_clock_file_operations"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_rwsem",
          "args": [
            "&clk->rwsem"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kref_init",
          "args": [
            "&clk->kref"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void delete_clock(struct kref *kref);\nstatic const struct file_operations posix_clock_file_operations = {\n\t.owner\t\t= THIS_MODULE,\n\t.llseek\t\t= no_llseek,\n\t.read\t\t= posix_clock_read,\n\t.poll\t\t= posix_clock_poll,\n\t.unlocked_ioctl\t= posix_clock_ioctl,\n\t.open\t\t= posix_clock_open,\n\t.release\t= posix_clock_release,\n#ifdef CONFIG_COMPAT\n\t.compat_ioctl\t= posix_clock_compat_ioctl,\n#endif\n};\n\nint posix_clock_register(struct posix_clock *clk, dev_t devid)\n{\n\tint err;\n\n\tkref_init(&clk->kref);\n\tinit_rwsem(&clk->rwsem);\n\n\tcdev_init(&clk->cdev, &posix_clock_file_operations);\n\tclk->cdev.owner = clk->ops.owner;\n\terr = cdev_add(&clk->cdev, devid, 1);\n\n\treturn err;\n}"
  },
  {
    "function_name": "posix_clock_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "149-162",
    "snippet": "static int posix_clock_release(struct inode *inode, struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\tint err = 0;\n\n\tif (clk->ops.release)\n\t\terr = clk->ops.release(clk);\n\n\tkref_put(&clk->kref, delete_clock);\n\n\tfp->private_data = NULL;\n\n\treturn err;\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void delete_clock(struct kref *kref);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_put",
          "args": [
            "&clk->kref",
            "delete_clock"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clk->ops.release",
          "args": [
            "clk"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void delete_clock(struct kref *kref);\n\nstatic int posix_clock_release(struct inode *inode, struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\tint err = 0;\n\n\tif (clk->ops.release)\n\t\terr = clk->ops.release(clk);\n\n\tkref_put(&clk->kref, delete_clock);\n\n\tfp->private_data = NULL;\n\n\treturn err;\n}"
  },
  {
    "function_name": "posix_clock_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "123-147",
    "snippet": "static int posix_clock_open(struct inode *inode, struct file *fp)\n{\n\tint err;\n\tstruct posix_clock *clk =\n\t\tcontainer_of(inode->i_cdev, struct posix_clock, cdev);\n\n\tdown_read(&clk->rwsem);\n\n\tif (clk->zombie) {\n\t\terr = -ENODEV;\n\t\tgoto out;\n\t}\n\tif (clk->ops.open)\n\t\terr = clk->ops.open(clk, fp->f_mode);\n\telse\n\t\terr = 0;\n\n\tif (!err) {\n\t\tkref_get(&clk->kref);\n\t\tfp->private_data = clk;\n\t}\nout:\n\tup_read(&clk->rwsem);\n\treturn err;\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void delete_clock(struct kref *kref);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&clk->rwsem"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "wakeup_readers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/relay.c",
          "lines": "336-342",
          "snippet": "static void wakeup_readers(struct irq_work *work)\n{\n\tstruct rchan_buf *buf;\n\n\tbuf = container_of(work, struct rchan_buf, wakeup_work);\n\twake_up_interruptible(&buf->read_wait);\n}",
          "includes": [
            "#include <linux/splice.h>",
            "#include <linux/cpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/relay.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/stddef.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/splice.h>\n#include <linux/cpu.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n#include <linux/relay.h>\n#include <linux/string.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/stddef.h>\n#include <linux/errno.h>\n\nstatic void wakeup_readers(struct irq_work *work)\n{\n\tstruct rchan_buf *buf;\n\n\tbuf = container_of(work, struct rchan_buf, wakeup_work);\n\twake_up_interruptible(&buf->read_wait);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kref_get",
          "args": [
            "&clk->kref"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "autogroup_kref_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/autogroup.c",
          "lines": "43-47",
          "snippet": "static inline struct autogroup *autogroup_kref_get(struct autogroup *ag)\n{\n\tkref_get(&ag->kref);\n\treturn ag;\n}",
          "includes": [
            "#include \"sched.h\"",
            "#include <linux/nospec.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n#include <linux/nospec.h>\n\nstatic inline struct autogroup *autogroup_kref_get(struct autogroup *ag)\n{\n\tkref_get(&ag->kref);\n\treturn ag;\n}"
        }
      },
      {
        "call_info": {
          "callee": "clk->ops.open",
          "args": [
            "clk",
            "fp->f_mode"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&clk->rwsem"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "down_read_non_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
          "lines": "180-186",
          "snippet": "void down_read_non_owner(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\n\t__down_read(sem);\n\t__rwsem_set_reader_owned(sem, NULL);\n}",
          "includes": [
            "#include \"rwsem.h\"",
            "#include <linux/atomic.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid down_read_non_owner(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\n\t__down_read(sem);\n\t__rwsem_set_reader_owned(sem, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "inode->i_cdev",
            "structposix_clock",
            "cdev"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void delete_clock(struct kref *kref);\n\nstatic int posix_clock_open(struct inode *inode, struct file *fp)\n{\n\tint err;\n\tstruct posix_clock *clk =\n\t\tcontainer_of(inode->i_cdev, struct posix_clock, cdev);\n\n\tdown_read(&clk->rwsem);\n\n\tif (clk->zombie) {\n\t\terr = -ENODEV;\n\t\tgoto out;\n\t}\n\tif (clk->ops.open)\n\t\terr = clk->ops.open(clk, fp->f_mode);\n\telse\n\t\terr = 0;\n\n\tif (!err) {\n\t\tkref_get(&clk->kref);\n\t\tfp->private_data = clk;\n\t}\nout:\n\tup_read(&clk->rwsem);\n\treturn err;\n}"
  },
  {
    "function_name": "posix_clock_compat_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "105-120",
    "snippet": "static long posix_clock_compat_ioctl(struct file *fp,\n\t\t\t\t     unsigned int cmd, unsigned long arg)\n{\n\tstruct posix_clock *clk = get_posix_clock(fp);\n\tint err = -ENOTTY;\n\n\tif (!clk)\n\t\treturn -ENODEV;\n\n\tif (clk->ops.ioctl)\n\t\terr = clk->ops.ioctl(clk, cmd, arg);\n\n\tput_posix_clock(clk);\n\n\treturn err;\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_posix_clock",
          "args": [
            "clk"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "put_posix_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "49-52",
          "snippet": "static void put_posix_clock(struct posix_clock *clk)\n{\n\tup_read(&clk->rwsem);\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void put_posix_clock(struct posix_clock *clk)\n{\n\tup_read(&clk->rwsem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clk->ops.ioctl",
          "args": [
            "clk",
            "cmd",
            "arg"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_posix_clock",
          "args": [
            "fp"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "get_posix_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "35-47",
          "snippet": "static struct posix_clock *get_posix_clock(struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\n\tdown_read(&clk->rwsem);\n\n\tif (!clk->zombie)\n\t\treturn clk;\n\n\tup_read(&clk->rwsem);\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic struct posix_clock *get_posix_clock(struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\n\tdown_read(&clk->rwsem);\n\n\tif (!clk->zombie)\n\t\treturn clk;\n\n\tup_read(&clk->rwsem);\n\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic long posix_clock_compat_ioctl(struct file *fp,\n\t\t\t\t     unsigned int cmd, unsigned long arg)\n{\n\tstruct posix_clock *clk = get_posix_clock(fp);\n\tint err = -ENOTTY;\n\n\tif (!clk)\n\t\treturn -ENODEV;\n\n\tif (clk->ops.ioctl)\n\t\terr = clk->ops.ioctl(clk, cmd, arg);\n\n\tput_posix_clock(clk);\n\n\treturn err;\n}"
  },
  {
    "function_name": "posix_clock_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "87-102",
    "snippet": "static long posix_clock_ioctl(struct file *fp,\n\t\t\t      unsigned int cmd, unsigned long arg)\n{\n\tstruct posix_clock *clk = get_posix_clock(fp);\n\tint err = -ENOTTY;\n\n\tif (!clk)\n\t\treturn -ENODEV;\n\n\tif (clk->ops.ioctl)\n\t\terr = clk->ops.ioctl(clk, cmd, arg);\n\n\tput_posix_clock(clk);\n\n\treturn err;\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_posix_clock",
          "args": [
            "clk"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "put_posix_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "49-52",
          "snippet": "static void put_posix_clock(struct posix_clock *clk)\n{\n\tup_read(&clk->rwsem);\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void put_posix_clock(struct posix_clock *clk)\n{\n\tup_read(&clk->rwsem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clk->ops.ioctl",
          "args": [
            "clk",
            "cmd",
            "arg"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_posix_clock",
          "args": [
            "fp"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "get_posix_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "35-47",
          "snippet": "static struct posix_clock *get_posix_clock(struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\n\tdown_read(&clk->rwsem);\n\n\tif (!clk->zombie)\n\t\treturn clk;\n\n\tup_read(&clk->rwsem);\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic struct posix_clock *get_posix_clock(struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\n\tdown_read(&clk->rwsem);\n\n\tif (!clk->zombie)\n\t\treturn clk;\n\n\tup_read(&clk->rwsem);\n\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic long posix_clock_ioctl(struct file *fp,\n\t\t\t      unsigned int cmd, unsigned long arg)\n{\n\tstruct posix_clock *clk = get_posix_clock(fp);\n\tint err = -ENOTTY;\n\n\tif (!clk)\n\t\treturn -ENODEV;\n\n\tif (clk->ops.ioctl)\n\t\terr = clk->ops.ioctl(clk, cmd, arg);\n\n\tput_posix_clock(clk);\n\n\treturn err;\n}"
  },
  {
    "function_name": "posix_clock_poll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "71-85",
    "snippet": "static __poll_t posix_clock_poll(struct file *fp, poll_table *wait)\n{\n\tstruct posix_clock *clk = get_posix_clock(fp);\n\t__poll_t result = 0;\n\n\tif (!clk)\n\t\treturn EPOLLERR;\n\n\tif (clk->ops.poll)\n\t\tresult = clk->ops.poll(clk, fp, wait);\n\n\tput_posix_clock(clk);\n\n\treturn result;\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_posix_clock",
          "args": [
            "clk"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "put_posix_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "49-52",
          "snippet": "static void put_posix_clock(struct posix_clock *clk)\n{\n\tup_read(&clk->rwsem);\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void put_posix_clock(struct posix_clock *clk)\n{\n\tup_read(&clk->rwsem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clk->ops.poll",
          "args": [
            "clk",
            "fp",
            "wait"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_posix_clock",
          "args": [
            "fp"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "get_posix_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "35-47",
          "snippet": "static struct posix_clock *get_posix_clock(struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\n\tdown_read(&clk->rwsem);\n\n\tif (!clk->zombie)\n\t\treturn clk;\n\n\tup_read(&clk->rwsem);\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic struct posix_clock *get_posix_clock(struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\n\tdown_read(&clk->rwsem);\n\n\tif (!clk->zombie)\n\t\treturn clk;\n\n\tup_read(&clk->rwsem);\n\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic __poll_t posix_clock_poll(struct file *fp, poll_table *wait)\n{\n\tstruct posix_clock *clk = get_posix_clock(fp);\n\t__poll_t result = 0;\n\n\tif (!clk)\n\t\treturn EPOLLERR;\n\n\tif (clk->ops.poll)\n\t\tresult = clk->ops.poll(clk, fp, wait);\n\n\tput_posix_clock(clk);\n\n\treturn result;\n}"
  },
  {
    "function_name": "posix_clock_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "54-69",
    "snippet": "static ssize_t posix_clock_read(struct file *fp, char __user *buf,\n\t\t\t\tsize_t count, loff_t *ppos)\n{\n\tstruct posix_clock *clk = get_posix_clock(fp);\n\tint err = -EINVAL;\n\n\tif (!clk)\n\t\treturn -ENODEV;\n\n\tif (clk->ops.read)\n\t\terr = clk->ops.read(clk, fp->f_flags, buf, count);\n\n\tput_posix_clock(clk);\n\n\treturn err;\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_posix_clock",
          "args": [
            "clk"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "put_posix_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "49-52",
          "snippet": "static void put_posix_clock(struct posix_clock *clk)\n{\n\tup_read(&clk->rwsem);\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void put_posix_clock(struct posix_clock *clk)\n{\n\tup_read(&clk->rwsem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clk->ops.read",
          "args": [
            "clk",
            "fp->f_flags",
            "buf",
            "count"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_posix_clock",
          "args": [
            "fp"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "get_posix_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
          "lines": "35-47",
          "snippet": "static struct posix_clock *get_posix_clock(struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\n\tdown_read(&clk->rwsem);\n\n\tif (!clk->zombie)\n\t\treturn clk;\n\n\tup_read(&clk->rwsem);\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/posix-clock.h>",
            "#include <linux/file.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic struct posix_clock *get_posix_clock(struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\n\tdown_read(&clk->rwsem);\n\n\tif (!clk->zombie)\n\t\treturn clk;\n\n\tup_read(&clk->rwsem);\n\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic ssize_t posix_clock_read(struct file *fp, char __user *buf,\n\t\t\t\tsize_t count, loff_t *ppos)\n{\n\tstruct posix_clock *clk = get_posix_clock(fp);\n\tint err = -EINVAL;\n\n\tif (!clk)\n\t\treturn -ENODEV;\n\n\tif (clk->ops.read)\n\t\terr = clk->ops.read(clk, fp->f_flags, buf, count);\n\n\tput_posix_clock(clk);\n\n\treturn err;\n}"
  },
  {
    "function_name": "put_posix_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "49-52",
    "snippet": "static void put_posix_clock(struct posix_clock *clk)\n{\n\tup_read(&clk->rwsem);\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&clk->rwsem"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "wakeup_readers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/relay.c",
          "lines": "336-342",
          "snippet": "static void wakeup_readers(struct irq_work *work)\n{\n\tstruct rchan_buf *buf;\n\n\tbuf = container_of(work, struct rchan_buf, wakeup_work);\n\twake_up_interruptible(&buf->read_wait);\n}",
          "includes": [
            "#include <linux/splice.h>",
            "#include <linux/cpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/relay.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/stddef.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/splice.h>\n#include <linux/cpu.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n#include <linux/relay.h>\n#include <linux/string.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/stddef.h>\n#include <linux/errno.h>\n\nstatic void wakeup_readers(struct irq_work *work)\n{\n\tstruct rchan_buf *buf;\n\n\tbuf = container_of(work, struct rchan_buf, wakeup_work);\n\twake_up_interruptible(&buf->read_wait);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic void put_posix_clock(struct posix_clock *clk)\n{\n\tup_read(&clk->rwsem);\n}"
  },
  {
    "function_name": "get_posix_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/posix-clock.c",
    "lines": "35-47",
    "snippet": "static struct posix_clock *get_posix_clock(struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\n\tdown_read(&clk->rwsem);\n\n\tif (!clk->zombie)\n\t\treturn clk;\n\n\tup_read(&clk->rwsem);\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"posix-timers.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/slab.h>",
      "#include <linux/posix-clock.h>",
      "#include <linux/file.h>",
      "#include <linux/export.h>",
      "#include <linux/device.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&clk->rwsem"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "wakeup_readers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/relay.c",
          "lines": "336-342",
          "snippet": "static void wakeup_readers(struct irq_work *work)\n{\n\tstruct rchan_buf *buf;\n\n\tbuf = container_of(work, struct rchan_buf, wakeup_work);\n\twake_up_interruptible(&buf->read_wait);\n}",
          "includes": [
            "#include <linux/splice.h>",
            "#include <linux/cpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/relay.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/stddef.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/splice.h>\n#include <linux/cpu.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n#include <linux/relay.h>\n#include <linux/string.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/stddef.h>\n#include <linux/errno.h>\n\nstatic void wakeup_readers(struct irq_work *work)\n{\n\tstruct rchan_buf *buf;\n\n\tbuf = container_of(work, struct rchan_buf, wakeup_work);\n\twake_up_interruptible(&buf->read_wait);\n}"
        }
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&clk->rwsem"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "down_read_non_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
          "lines": "180-186",
          "snippet": "void down_read_non_owner(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\n\t__down_read(sem);\n\t__rwsem_set_reader_owned(sem, NULL);\n}",
          "includes": [
            "#include \"rwsem.h\"",
            "#include <linux/atomic.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid down_read_non_owner(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\n\t__down_read(sem);\n\t__rwsem_set_reader_owned(sem, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/uaccess.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/posix-clock.h>\n#include <linux/file.h>\n#include <linux/export.h>\n#include <linux/device.h>\n\nstatic struct posix_clock *get_posix_clock(struct file *fp)\n{\n\tstruct posix_clock *clk = fp->private_data;\n\n\tdown_read(&clk->rwsem);\n\n\tif (!clk->zombie)\n\t\treturn clk;\n\n\tup_read(&clk->rwsem);\n\n\treturn NULL;\n}"
  }
]