[
  {
    "function_name": "completion_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "313-328",
    "snippet": "bool completion_done(struct completion *x)\n{\n\tunsigned long flags;\n\n\tif (!READ_ONCE(x->done))\n\t\treturn false;\n\n\t/*\n\t * If ->done, we need to wait for complete() to release ->wait.lock\n\t * otherwise we can end up freeing the completion before complete()\n\t * is done referencing it.\n\t */\n\tspin_lock_irqsave(&x->wait.lock, flags);\n\tspin_unlock_irqrestore(&x->wait.lock, flags);\n\treturn true;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&x->wait.lock",
            "flags"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&x->wait.lock",
            "flags"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "359-370",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "x->done"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nbool completion_done(struct completion *x)\n{\n\tunsigned long flags;\n\n\tif (!READ_ONCE(x->done))\n\t\treturn false;\n\n\t/*\n\t * If ->done, we need to wait for complete() to release ->wait.lock\n\t * otherwise we can end up freeing the completion before complete()\n\t * is done referencing it.\n\t */\n\tspin_lock_irqsave(&x->wait.lock, flags);\n\tspin_unlock_irqrestore(&x->wait.lock, flags);\n\treturn true;\n}"
  },
  {
    "function_name": "try_wait_for_completion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "280-301",
    "snippet": "bool try_wait_for_completion(struct completion *x)\n{\n\tunsigned long flags;\n\tbool ret = true;\n\n\t/*\n\t * Since x->done will need to be locked only\n\t * in the non-blocking case, we check x->done\n\t * first without taking the lock so we can\n\t * return early in the blocking case.\n\t */\n\tif (!READ_ONCE(x->done))\n\t\treturn false;\n\n\tspin_lock_irqsave(&x->wait.lock, flags);\n\tif (!x->done)\n\t\tret = false;\n\telse if (x->done != UINT_MAX)\n\t\tx->done--;\n\tspin_unlock_irqrestore(&x->wait.lock, flags);\n\treturn ret;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&x->wait.lock",
            "flags"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&x->wait.lock",
            "flags"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "359-370",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "x->done"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nbool try_wait_for_completion(struct completion *x)\n{\n\tunsigned long flags;\n\tbool ret = true;\n\n\t/*\n\t * Since x->done will need to be locked only\n\t * in the non-blocking case, we check x->done\n\t * first without taking the lock so we can\n\t * return early in the blocking case.\n\t */\n\tif (!READ_ONCE(x->done))\n\t\treturn false;\n\n\tspin_lock_irqsave(&x->wait.lock, flags);\n\tif (!x->done)\n\t\tret = false;\n\telse if (x->done != UINT_MAX)\n\t\tx->done--;\n\tspin_unlock_irqrestore(&x->wait.lock, flags);\n\treturn ret;\n}"
  },
  {
    "function_name": "wait_for_completion_killable_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "260-265",
    "snippet": "long __sched\nwait_for_completion_killable_timeout(struct completion *x,\n\t\t\t\t     unsigned long timeout)\n{\n\treturn wait_for_common(x, timeout, TASK_KILLABLE);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_common",
          "args": [
            "x",
            "timeout",
            "TASK_KILLABLE"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "wait_for_common_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
          "lines": "118-122",
          "snippet": "static long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nlong __sched\nwait_for_completion_killable_timeout(struct completion *x,\n\t\t\t\t     unsigned long timeout)\n{\n\treturn wait_for_common(x, timeout, TASK_KILLABLE);\n}"
  },
  {
    "function_name": "wait_for_completion_killable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "239-245",
    "snippet": "int __sched wait_for_completion_killable(struct completion *x)\n{\n\tlong t = wait_for_common(x, MAX_SCHEDULE_TIMEOUT, TASK_KILLABLE);\n\tif (t == -ERESTARTSYS)\n\t\treturn t;\n\treturn 0;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_common",
          "args": [
            "x",
            "MAX_SCHEDULE_TIMEOUT",
            "TASK_KILLABLE"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "wait_for_common_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
          "lines": "118-122",
          "snippet": "static long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nint __sched wait_for_completion_killable(struct completion *x)\n{\n\tlong t = wait_for_common(x, MAX_SCHEDULE_TIMEOUT, TASK_KILLABLE);\n\tif (t == -ERESTARTSYS)\n\t\treturn t;\n\treturn 0;\n}"
  },
  {
    "function_name": "wait_for_completion_interruptible_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "222-227",
    "snippet": "long __sched\nwait_for_completion_interruptible_timeout(struct completion *x,\n\t\t\t\t\t  unsigned long timeout)\n{\n\treturn wait_for_common(x, timeout, TASK_INTERRUPTIBLE);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_common",
          "args": [
            "x",
            "timeout",
            "TASK_INTERRUPTIBLE"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "wait_for_common_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
          "lines": "118-122",
          "snippet": "static long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nlong __sched\nwait_for_completion_interruptible_timeout(struct completion *x,\n\t\t\t\t\t  unsigned long timeout)\n{\n\treturn wait_for_common(x, timeout, TASK_INTERRUPTIBLE);\n}"
  },
  {
    "function_name": "wait_for_completion_interruptible",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "202-208",
    "snippet": "int __sched wait_for_completion_interruptible(struct completion *x)\n{\n\tlong t = wait_for_common(x, MAX_SCHEDULE_TIMEOUT, TASK_INTERRUPTIBLE);\n\tif (t == -ERESTARTSYS)\n\t\treturn t;\n\treturn 0;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_common",
          "args": [
            "x",
            "MAX_SCHEDULE_TIMEOUT",
            "TASK_INTERRUPTIBLE"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "wait_for_common_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
          "lines": "118-122",
          "snippet": "static long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nint __sched wait_for_completion_interruptible(struct completion *x)\n{\n\tlong t = wait_for_common(x, MAX_SCHEDULE_TIMEOUT, TASK_INTERRUPTIBLE);\n\tif (t == -ERESTARTSYS)\n\t\treturn t;\n\treturn 0;\n}"
  },
  {
    "function_name": "wait_for_completion_io_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "186-190",
    "snippet": "unsigned long __sched\nwait_for_completion_io_timeout(struct completion *x, unsigned long timeout)\n{\n\treturn wait_for_common_io(x, timeout, TASK_UNINTERRUPTIBLE);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_common_io",
          "args": [
            "x",
            "timeout",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "wait_for_common_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
          "lines": "118-122",
          "snippet": "static long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nunsigned long __sched\nwait_for_completion_io_timeout(struct completion *x, unsigned long timeout)\n{\n\treturn wait_for_common_io(x, timeout, TASK_UNINTERRUPTIBLE);\n}"
  },
  {
    "function_name": "wait_for_completion_io",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "167-170",
    "snippet": "void __sched wait_for_completion_io(struct completion *x)\n{\n\twait_for_common_io(x, MAX_SCHEDULE_TIMEOUT, TASK_UNINTERRUPTIBLE);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_common_io",
          "args": [
            "x",
            "MAX_SCHEDULE_TIMEOUT",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "wait_for_common_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
          "lines": "118-122",
          "snippet": "static long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid __sched wait_for_completion_io(struct completion *x)\n{\n\twait_for_common_io(x, MAX_SCHEDULE_TIMEOUT, TASK_UNINTERRUPTIBLE);\n}"
  },
  {
    "function_name": "wait_for_completion_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "152-156",
    "snippet": "unsigned long __sched\nwait_for_completion_timeout(struct completion *x, unsigned long timeout)\n{\n\treturn wait_for_common(x, timeout, TASK_UNINTERRUPTIBLE);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_common",
          "args": [
            "x",
            "timeout",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "wait_for_common_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
          "lines": "118-122",
          "snippet": "static long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nunsigned long __sched\nwait_for_completion_timeout(struct completion *x, unsigned long timeout)\n{\n\treturn wait_for_common(x, timeout, TASK_UNINTERRUPTIBLE);\n}"
  },
  {
    "function_name": "wait_for_completion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "134-137",
    "snippet": "void __sched wait_for_completion(struct completion *x)\n{\n\twait_for_common(x, MAX_SCHEDULE_TIMEOUT, TASK_UNINTERRUPTIBLE);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_common",
          "args": [
            "x",
            "MAX_SCHEDULE_TIMEOUT",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "wait_for_common_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
          "lines": "118-122",
          "snippet": "static long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid __sched wait_for_completion(struct completion *x)\n{\n\twait_for_common(x, MAX_SCHEDULE_TIMEOUT, TASK_UNINTERRUPTIBLE);\n}"
  },
  {
    "function_name": "wait_for_common_io",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "118-122",
    "snippet": "static long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__wait_for_common",
          "args": [
            "x",
            "io_schedule_timeout",
            "timeout",
            "state"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "__wait_for_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
          "lines": "95-110",
          "snippet": "static inline long __sched\n__wait_for_common(struct completion *x,\n\t\t  long (*action)(long), long timeout, int state)\n{\n\tmight_sleep();\n\n\tcomplete_acquire(x);\n\n\tspin_lock_irq(&x->wait.lock);\n\ttimeout = do_wait_for_common(x, action, timeout, state);\n\tspin_unlock_irq(&x->wait.lock);\n\n\tcomplete_release(x);\n\n\treturn timeout;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic inline long __sched\n__wait_for_common(struct completion *x,\n\t\t  long (*action)(long), long timeout, int state)\n{\n\tmight_sleep();\n\n\tcomplete_acquire(x);\n\n\tspin_lock_irq(&x->wait.lock);\n\ttimeout = do_wait_for_common(x, action, timeout, state);\n\tspin_unlock_irq(&x->wait.lock);\n\n\tcomplete_release(x);\n\n\treturn timeout;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic long __sched\nwait_for_common_io(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, io_schedule_timeout, timeout, state);\n}"
  },
  {
    "function_name": "wait_for_common",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "112-116",
    "snippet": "static long __sched\nwait_for_common(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, schedule_timeout, timeout, state);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__wait_for_common",
          "args": [
            "x",
            "schedule_timeout",
            "timeout",
            "state"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "__wait_for_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
          "lines": "95-110",
          "snippet": "static inline long __sched\n__wait_for_common(struct completion *x,\n\t\t  long (*action)(long), long timeout, int state)\n{\n\tmight_sleep();\n\n\tcomplete_acquire(x);\n\n\tspin_lock_irq(&x->wait.lock);\n\ttimeout = do_wait_for_common(x, action, timeout, state);\n\tspin_unlock_irq(&x->wait.lock);\n\n\tcomplete_release(x);\n\n\treturn timeout;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic inline long __sched\n__wait_for_common(struct completion *x,\n\t\t  long (*action)(long), long timeout, int state)\n{\n\tmight_sleep();\n\n\tcomplete_acquire(x);\n\n\tspin_lock_irq(&x->wait.lock);\n\ttimeout = do_wait_for_common(x, action, timeout, state);\n\tspin_unlock_irq(&x->wait.lock);\n\n\tcomplete_release(x);\n\n\treturn timeout;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic long __sched\nwait_for_common(struct completion *x, long timeout, int state)\n{\n\treturn __wait_for_common(x, schedule_timeout, timeout, state);\n}"
  },
  {
    "function_name": "__wait_for_common",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "95-110",
    "snippet": "static inline long __sched\n__wait_for_common(struct completion *x,\n\t\t  long (*action)(long), long timeout, int state)\n{\n\tmight_sleep();\n\n\tcomplete_acquire(x);\n\n\tspin_lock_irq(&x->wait.lock);\n\ttimeout = do_wait_for_common(x, action, timeout, state);\n\tspin_unlock_irq(&x->wait.lock);\n\n\tcomplete_release(x);\n\n\treturn timeout;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "complete_release",
          "args": [
            "x"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&x->wait.lock"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "190-193",
          "snippet": "void __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_wait_for_common",
          "args": [
            "x",
            "action",
            "timeout",
            "state"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "do_wait_for_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
          "lines": "68-93",
          "snippet": "static inline long __sched\ndo_wait_for_common(struct completion *x,\n\t\t   long (*action)(long), long timeout, int state)\n{\n\tif (!x->done) {\n\t\tDECLARE_WAITQUEUE(wait, current);\n\n\t\t__add_wait_queue_entry_tail_exclusive(&x->wait, &wait);\n\t\tdo {\n\t\t\tif (signal_pending_state(state, current)) {\n\t\t\t\ttimeout = -ERESTARTSYS;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t__set_current_state(state);\n\t\t\tspin_unlock_irq(&x->wait.lock);\n\t\t\ttimeout = action(timeout);\n\t\t\tspin_lock_irq(&x->wait.lock);\n\t\t} while (!x->done && timeout);\n\t\t__remove_wait_queue(&x->wait, &wait);\n\t\tif (!x->done)\n\t\t\treturn timeout;\n\t}\n\tif (x->done != UINT_MAX)\n\t\tx->done--;\n\treturn timeout ?: 1;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic inline long __sched\ndo_wait_for_common(struct completion *x,\n\t\t   long (*action)(long), long timeout, int state)\n{\n\tif (!x->done) {\n\t\tDECLARE_WAITQUEUE(wait, current);\n\n\t\t__add_wait_queue_entry_tail_exclusive(&x->wait, &wait);\n\t\tdo {\n\t\t\tif (signal_pending_state(state, current)) {\n\t\t\t\ttimeout = -ERESTARTSYS;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t__set_current_state(state);\n\t\t\tspin_unlock_irq(&x->wait.lock);\n\t\t\ttimeout = action(timeout);\n\t\t\tspin_lock_irq(&x->wait.lock);\n\t\t} while (!x->done && timeout);\n\t\t__remove_wait_queue(&x->wait, &wait);\n\t\tif (!x->done)\n\t\t\treturn timeout;\n\t}\n\tif (x->done != UINT_MAX)\n\t\tx->done--;\n\treturn timeout ?: 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&x->wait.lock"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "158-161",
          "snippet": "void __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "complete_acquire",
          "args": [
            "x"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic inline long __sched\n__wait_for_common(struct completion *x,\n\t\t  long (*action)(long), long timeout, int state)\n{\n\tmight_sleep();\n\n\tcomplete_acquire(x);\n\n\tspin_lock_irq(&x->wait.lock);\n\ttimeout = do_wait_for_common(x, action, timeout, state);\n\tspin_unlock_irq(&x->wait.lock);\n\n\tcomplete_release(x);\n\n\treturn timeout;\n}"
  },
  {
    "function_name": "do_wait_for_common",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "68-93",
    "snippet": "static inline long __sched\ndo_wait_for_common(struct completion *x,\n\t\t   long (*action)(long), long timeout, int state)\n{\n\tif (!x->done) {\n\t\tDECLARE_WAITQUEUE(wait, current);\n\n\t\t__add_wait_queue_entry_tail_exclusive(&x->wait, &wait);\n\t\tdo {\n\t\t\tif (signal_pending_state(state, current)) {\n\t\t\t\ttimeout = -ERESTARTSYS;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t__set_current_state(state);\n\t\t\tspin_unlock_irq(&x->wait.lock);\n\t\t\ttimeout = action(timeout);\n\t\t\tspin_lock_irq(&x->wait.lock);\n\t\t} while (!x->done && timeout);\n\t\t__remove_wait_queue(&x->wait, &wait);\n\t\tif (!x->done)\n\t\t\treturn timeout;\n\t}\n\tif (x->done != UINT_MAX)\n\t\tx->done--;\n\treturn timeout ?: 1;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__remove_wait_queue",
          "args": [
            "&x->wait",
            "&wait"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&x->wait.lock"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "158-161",
          "snippet": "void __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "action",
          "args": [
            "timeout"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "seccomp_get_action_avail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/seccomp.c",
          "lines": "902-923",
          "snippet": "static long seccomp_get_action_avail(const char __user *uaction)\n{\n\tu32 action;\n\n\tif (copy_from_user(&action, uaction, sizeof(action)))\n\t\treturn -EFAULT;\n\n\tswitch (action) {\n\tcase SECCOMP_RET_KILL_PROCESS:\n\tcase SECCOMP_RET_KILL_THREAD:\n\tcase SECCOMP_RET_TRAP:\n\tcase SECCOMP_RET_ERRNO:\n\tcase SECCOMP_RET_TRACE:\n\tcase SECCOMP_RET_LOG:\n\tcase SECCOMP_RET_ALLOW:\n\t\tbreak;\n\tdefault:\n\t\treturn -EOPNOTSUPP;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/security.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/pid.h>",
            "#include <linux/filter.h>",
            "#include <asm/syscall.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/prctl.h>",
            "#include <linux/nospec.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/coredump.h>",
            "#include <linux/compat.h>",
            "#include <linux/audit.h>",
            "#include <linux/refcount.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/tracehook.h>\n#include <linux/security.h>\n#include <linux/ptrace.h>\n#include <linux/pid.h>\n#include <linux/filter.h>\n#include <asm/syscall.h>\n#include <linux/sysctl.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/seccomp.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/prctl.h>\n#include <linux/nospec.h>\n#include <linux/kmemleak.h>\n#include <linux/coredump.h>\n#include <linux/compat.h>\n#include <linux/audit.h>\n#include <linux/refcount.h>\n\nstatic long seccomp_get_action_avail(const char __user *uaction)\n{\n\tu32 action;\n\n\tif (copy_from_user(&action, uaction, sizeof(action)))\n\t\treturn -EFAULT;\n\n\tswitch (action) {\n\tcase SECCOMP_RET_KILL_PROCESS:\n\tcase SECCOMP_RET_KILL_THREAD:\n\tcase SECCOMP_RET_TRAP:\n\tcase SECCOMP_RET_ERRNO:\n\tcase SECCOMP_RET_TRACE:\n\tcase SECCOMP_RET_LOG:\n\tcase SECCOMP_RET_ALLOW:\n\t\tbreak;\n\tdefault:\n\t\treturn -EOPNOTSUPP;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&x->wait.lock"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "190-193",
          "snippet": "void __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__set_current_state",
          "args": [
            "state"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "signal_pending_state",
          "args": [
            "state",
            "current"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__add_wait_queue_entry_tail_exclusive",
          "args": [
            "&x->wait",
            "&wait"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DECLARE_WAITQUEUE",
          "args": [
            "wait",
            "current"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic inline long __sched\ndo_wait_for_common(struct completion *x,\n\t\t   long (*action)(long), long timeout, int state)\n{\n\tif (!x->done) {\n\t\tDECLARE_WAITQUEUE(wait, current);\n\n\t\t__add_wait_queue_entry_tail_exclusive(&x->wait, &wait);\n\t\tdo {\n\t\t\tif (signal_pending_state(state, current)) {\n\t\t\t\ttimeout = -ERESTARTSYS;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t__set_current_state(state);\n\t\t\tspin_unlock_irq(&x->wait.lock);\n\t\t\ttimeout = action(timeout);\n\t\t\tspin_lock_irq(&x->wait.lock);\n\t\t} while (!x->done && timeout);\n\t\t__remove_wait_queue(&x->wait, &wait);\n\t\tif (!x->done)\n\t\t\treturn timeout;\n\t}\n\tif (x->done != UINT_MAX)\n\t\tx->done--;\n\treturn timeout ?: 1;\n}"
  },
  {
    "function_name": "complete_all",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "57-65",
    "snippet": "void complete_all(struct completion *x)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&x->wait.lock, flags);\n\tx->done = UINT_MAX;\n\t__wake_up_locked(&x->wait, TASK_NORMAL, 0);\n\tspin_unlock_irqrestore(&x->wait.lock, flags);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&x->wait.lock",
            "flags"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__wake_up_locked",
          "args": [
            "&x->wait",
            "TASK_NORMAL",
            "0"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "__wake_up_locked_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/wait.c",
          "lines": "158-161",
          "snippet": "void __wake_up_locked_key(struct wait_queue_head *wq_head, unsigned int mode, void *key)\n{\n\t__wake_up_common(wq_head, mode, 1, 0, key, NULL);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nvoid __wake_up_locked_key(struct wait_queue_head *wq_head, unsigned int mode, void *key)\n{\n\t__wake_up_common(wq_head, mode, 1, 0, key, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&x->wait.lock",
            "flags"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "359-370",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid complete_all(struct completion *x)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&x->wait.lock, flags);\n\tx->done = UINT_MAX;\n\t__wake_up_locked(&x->wait, TASK_NORMAL, 0);\n\tspin_unlock_irqrestore(&x->wait.lock, flags);\n}"
  },
  {
    "function_name": "complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
    "lines": "28-38",
    "snippet": "void complete(struct completion *x)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&x->wait.lock, flags);\n\n\tif (x->done != UINT_MAX)\n\t\tx->done++;\n\t__wake_up_locked(&x->wait, TASK_NORMAL, 1);\n\tspin_unlock_irqrestore(&x->wait.lock, flags);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&x->wait.lock",
            "flags"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__wake_up_locked",
          "args": [
            "&x->wait",
            "TASK_NORMAL",
            "1"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "__wake_up_locked_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/wait.c",
          "lines": "158-161",
          "snippet": "void __wake_up_locked_key(struct wait_queue_head *wq_head, unsigned int mode, void *key)\n{\n\t__wake_up_common(wq_head, mode, 1, 0, key, NULL);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nvoid __wake_up_locked_key(struct wait_queue_head *wq_head, unsigned int mode, void *key)\n{\n\t__wake_up_common(wq_head, mode, 1, 0, key, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&x->wait.lock",
            "flags"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "359-370",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid complete(struct completion *x)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&x->wait.lock, flags);\n\n\tif (x->done != UINT_MAX)\n\t\tx->done++;\n\t__wake_up_locked(&x->wait, TASK_NORMAL, 1);\n\tspin_unlock_irqrestore(&x->wait.lock, flags);\n}"
  }
]