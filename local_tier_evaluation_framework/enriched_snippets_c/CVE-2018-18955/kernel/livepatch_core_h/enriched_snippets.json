[
  {
    "function_name": "klp_post_unpatch_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/livepatch/core.h",
    "lines": "38-45",
    "snippet": "static inline void klp_post_unpatch_callback(struct klp_object *obj)\n{\n\tif (obj->callbacks.post_unpatch_enabled &&\n\t    obj->callbacks.post_unpatch)\n\t\t(*obj->callbacks.post_unpatch)(obj);\n\n\tobj->callbacks.post_unpatch_enabled = false;\n}",
    "includes": [
      "#include <linux/livepatch.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "obj"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/livepatch.h>\n\nstatic inline void klp_post_unpatch_callback(struct klp_object *obj)\n{\n\tif (obj->callbacks.post_unpatch_enabled &&\n\t    obj->callbacks.post_unpatch)\n\t\t(*obj->callbacks.post_unpatch)(obj);\n\n\tobj->callbacks.post_unpatch_enabled = false;\n}"
  },
  {
    "function_name": "klp_pre_unpatch_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/livepatch/core.h",
    "lines": "32-36",
    "snippet": "static inline void klp_pre_unpatch_callback(struct klp_object *obj)\n{\n\tif (obj->callbacks.pre_unpatch)\n\t\t(*obj->callbacks.pre_unpatch)(obj);\n}",
    "includes": [
      "#include <linux/livepatch.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "obj"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/livepatch.h>\n\nstatic inline void klp_pre_unpatch_callback(struct klp_object *obj)\n{\n\tif (obj->callbacks.pre_unpatch)\n\t\t(*obj->callbacks.pre_unpatch)(obj);\n}"
  },
  {
    "function_name": "klp_post_patch_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/livepatch/core.h",
    "lines": "26-30",
    "snippet": "static inline void klp_post_patch_callback(struct klp_object *obj)\n{\n\tif (obj->callbacks.post_patch)\n\t\t(*obj->callbacks.post_patch)(obj);\n}",
    "includes": [
      "#include <linux/livepatch.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "obj"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/livepatch.h>\n\nstatic inline void klp_post_patch_callback(struct klp_object *obj)\n{\n\tif (obj->callbacks.post_patch)\n\t\t(*obj->callbacks.post_patch)(obj);\n}"
  },
  {
    "function_name": "klp_pre_patch_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/livepatch/core.h",
    "lines": "14-24",
    "snippet": "static inline int klp_pre_patch_callback(struct klp_object *obj)\n{\n\tint ret = 0;\n\n\tif (obj->callbacks.pre_patch)\n\t\tret = (*obj->callbacks.pre_patch)(obj);\n\n\tobj->callbacks.post_unpatch_enabled = !ret;\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/livepatch.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "obj"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/livepatch.h>\n\nstatic inline int klp_pre_patch_callback(struct klp_object *obj)\n{\n\tint ret = 0;\n\n\tif (obj->callbacks.pre_patch)\n\t\tret = (*obj->callbacks.pre_patch)(obj);\n\n\tobj->callbacks.post_unpatch_enabled = !ret;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "klp_is_object_loaded",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/livepatch/core.h",
    "lines": "9-12",
    "snippet": "static inline bool klp_is_object_loaded(struct klp_object *obj)\n{\n\treturn !obj->name || obj->mod;\n}",
    "includes": [
      "#include <linux/livepatch.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/livepatch.h>\n\nstatic inline bool klp_is_object_loaded(struct klp_object *obj)\n{\n\treturn !obj->name || obj->mod;\n}"
  }
]