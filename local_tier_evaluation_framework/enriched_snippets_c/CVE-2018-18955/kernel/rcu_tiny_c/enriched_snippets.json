[
  {
    "function_name": "rcu_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tiny.c",
    "lines": "166-171",
    "snippet": "void __init rcu_init(void)\n{\n\topen_softirq(RCU_SOFTIRQ, rcu_process_callbacks);\n\trcu_early_boot_tests();\n\tsrcu_init();\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "srcu_init",
          "args": [],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "srcu_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/srcutree.c",
          "lines": "1319-1331",
          "snippet": "void __init srcu_init(void)\n{\n\tstruct srcu_struct *sp;\n\n\tsrcu_init_done = true;\n\twhile (!list_empty(&srcu_boot_list)) {\n\t\tsp = list_first_entry(&srcu_boot_list, struct srcu_struct,\n\t\t\t\t      work.work.entry);\n\t\tcheck_init_srcu_struct(sp);\n\t\tlist_del_init(&sp->work.work.entry);\n\t\tqueue_work(rcu_gp_wq, &sp->work.work);\n\t}\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include \"rcu.h\"",
            "#include <linux/srcu.h>",
            "#include <linux/module.h>",
            "#include <linux/delay.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/preempt.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(srcu_boot_list);",
            "static void srcu_invoke_callbacks(struct work_struct *work);",
            "static void process_srcu(struct work_struct *work);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include \"rcu.h\"\n#include <linux/srcu.h>\n#include <linux/module.h>\n#include <linux/delay.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/percpu.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(srcu_boot_list);\nstatic void srcu_invoke_callbacks(struct work_struct *work);\nstatic void process_srcu(struct work_struct *work);\n\nvoid __init srcu_init(void)\n{\n\tstruct srcu_struct *sp;\n\n\tsrcu_init_done = true;\n\twhile (!list_empty(&srcu_boot_list)) {\n\t\tsp = list_first_entry(&srcu_boot_list, struct srcu_struct,\n\t\t\t\t      work.work.entry);\n\t\tcheck_init_srcu_struct(sp);\n\t\tlist_del_init(&sp->work.work.entry);\n\t\tqueue_work(rcu_gp_wq, &sp->work.work);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_early_boot_tests",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_early_boot_tests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/update.c",
          "lines": "926-926",
          "snippet": "void rcu_early_boot_tests(void) {}",
          "includes": [
            "#include \"rcu.h\"",
            "#include <linux/sched/isolation.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/tick.h>",
            "#include <linux/kthread.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/export.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include <linux/sched/isolation.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/tick.h>\n#include <linux/kthread.h>\n#include <linux/moduleparam.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/export.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_early_boot_tests(void) {}"
        }
      },
      {
        "call_info": {
          "callee": "open_softirq",
          "args": [
            "RCU_SOFTIRQ",
            "rcu_process_callbacks"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "open_softirq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/softirq.c",
          "lines": "455-458",
          "snippet": "void open_softirq(int nr, void (*action)(struct softirq_action *))\n{\n\tsoftirq_vec[nr].action = action;\n}",
          "includes": [
            "#include <trace/events/irq.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct softirq_action softirq_vec[NR_SOFTIRQS]"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/irq.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/ftrace.h>\n#include <linux/rcupdate.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/notifier.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/kernel_stat.h>\n#include <linux/export.h>\n\nstatic struct softirq_action softirq_vec[NR_SOFTIRQS];\n\nvoid open_softirq(int nr, void (*action)(struct softirq_action *))\n{\n\tsoftirq_vec[nr].action = action;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nvoid __init rcu_init(void)\n{\n\topen_softirq(RCU_SOFTIRQ, rcu_process_callbacks);\n\trcu_early_boot_tests();\n\tsrcu_init();\n}"
  },
  {
    "function_name": "call_rcu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tiny.c",
    "lines": "146-163",
    "snippet": "void call_rcu(struct rcu_head *head, rcu_callback_t func)\n{\n\tunsigned long flags;\n\n\tdebug_rcu_head_queue(head);\n\thead->func = func;\n\thead->next = NULL;\n\n\tlocal_irq_save(flags);\n\t*rcu_ctrlblk.curtail = head;\n\trcu_ctrlblk.curtail = &head->next;\n\tlocal_irq_restore(flags);\n\n\tif (unlikely(is_idle_task(current))) {\n\t\t/* force scheduling for rcu_qs() */\n\t\tresched_cpu(0);\n\t}\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "resched_cpu",
          "args": [
            "0"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "resched_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "476-485",
          "snippet": "void resched_cpu(int cpu)\n{\n\tstruct rq *rq = cpu_rq(cpu);\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&rq->lock, flags);\n\tif (cpu_online(cpu) || cpu == smp_processor_id())\n\t\tresched_curr(rq);\n\traw_spin_unlock_irqrestore(&rq->lock, flags);\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic __always_inline struct;\n\nvoid resched_cpu(int cpu)\n{\n\tstruct rq *rq = cpu_rq(cpu);\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&rq->lock, flags);\n\tif (cpu_online(cpu) || cpu == smp_processor_id())\n\t\tresched_curr(rq);\n\traw_spin_unlock_irqrestore(&rq->lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "is_idle_task(current)"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_idle_task",
          "args": [
            "current"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_save",
          "args": [
            "flags"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_rcu_head_queue",
          "args": [
            "head"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "debug_rcu_head_queue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu.h",
          "lines": "209-212",
          "snippet": "static inline int debug_rcu_head_queue(struct rcu_head *head)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/rcu_node_tree.h>",
            "#include <trace/events/rcu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_node_tree.h>\n#include <trace/events/rcu.h>\n\nstatic inline int debug_rcu_head_queue(struct rcu_head *head)\n{\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n};\n\nvoid call_rcu(struct rcu_head *head, rcu_callback_t func)\n{\n\tunsigned long flags;\n\n\tdebug_rcu_head_queue(head);\n\thead->func = func;\n\thead->next = NULL;\n\n\tlocal_irq_save(flags);\n\t*rcu_ctrlblk.curtail = head;\n\trcu_ctrlblk.curtail = &head->next;\n\tlocal_irq_restore(flags);\n\n\tif (unlikely(is_idle_task(current))) {\n\t\t/* force scheduling for rcu_qs() */\n\t\tresched_cpu(0);\n\t}\n}"
  },
  {
    "function_name": "synchronize_rcu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tiny.c",
    "lines": "132-138",
    "snippet": "void synchronize_rcu(void)\n{\n\tRCU_LOCKDEP_WARN(lock_is_held(&rcu_bh_lock_map) ||\n\t\t\t lock_is_held(&rcu_lock_map) ||\n\t\t\t lock_is_held(&rcu_sched_lock_map),\n\t\t\t \"Illegal synchronize_rcu() in RCU read-side critical section\");\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RCU_LOCKDEP_WARN",
          "args": [
            "lock_is_held(&rcu_bh_lock_map) ||\n\t\t\t lock_is_held(&rcu_lock_map) ||\n\t\t\t lock_is_held(&rcu_sched_lock_map)",
            "\"Illegal synchronize_rcu() in RCU read-side critical section\""
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lock_is_held",
          "args": [
            "&rcu_sched_lock_map"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lock_is_held",
          "args": [
            "&rcu_lock_map"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lock_is_held",
          "args": [
            "&rcu_bh_lock_map"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nvoid synchronize_rcu(void)\n{\n\tRCU_LOCKDEP_WARN(lock_is_held(&rcu_bh_lock_map) ||\n\t\t\t lock_is_held(&rcu_lock_map) ||\n\t\t\t lock_is_held(&rcu_sched_lock_map),\n\t\t\t \"Illegal synchronize_rcu() in RCU read-side critical section\");\n}"
  },
  {
    "function_name": "rcu_process_callbacks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tiny.c",
    "lines": "90-120",
    "snippet": "static __latent_entropy void rcu_process_callbacks(struct softirq_action *unused)\n{\n\tstruct rcu_head *next, *list;\n\tunsigned long flags;\n\n\t/* Move the ready-to-invoke callbacks to a local list. */\n\tlocal_irq_save(flags);\n\tif (rcu_ctrlblk.donetail == &rcu_ctrlblk.rcucblist) {\n\t\t/* No callbacks ready, so just leave. */\n\t\tlocal_irq_restore(flags);\n\t\treturn;\n\t}\n\tlist = rcu_ctrlblk.rcucblist;\n\trcu_ctrlblk.rcucblist = *rcu_ctrlblk.donetail;\n\t*rcu_ctrlblk.donetail = NULL;\n\tif (rcu_ctrlblk.curtail == rcu_ctrlblk.donetail)\n\t\trcu_ctrlblk.curtail = &rcu_ctrlblk.rcucblist;\n\trcu_ctrlblk.donetail = &rcu_ctrlblk.rcucblist;\n\tlocal_irq_restore(flags);\n\n\t/* Invoke the callbacks on the local list. */\n\twhile (list) {\n\t\tnext = list->next;\n\t\tprefetch(next);\n\t\tdebug_rcu_head_unqueue(list);\n\t\tlocal_bh_disable();\n\t\t__rcu_reclaim(\"\", list);\n\t\tlocal_bh_enable();\n\t\tlist = next;\n\t}\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_bh_enable",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "_local_bh_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/softirq.c",
          "lines": "159-163",
          "snippet": "void _local_bh_enable(void)\n{\n\tWARN_ON_ONCE(in_irq());\n\t__local_bh_enable(SOFTIRQ_DISABLE_OFFSET);\n}",
          "includes": [
            "#include <trace/events/irq.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/irq.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/ftrace.h>\n#include <linux/rcupdate.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/notifier.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/kernel_stat.h>\n#include <linux/export.h>\n\nvoid _local_bh_enable(void)\n{\n\tWARN_ON_ONCE(in_irq());\n\t__local_bh_enable(SOFTIRQ_DISABLE_OFFSET);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__rcu_reclaim",
          "args": [
            "\"\"",
            "list"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "__rcu_reclaim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu.h",
          "lines": "225-244",
          "snippet": "static inline bool __rcu_reclaim(const char *rn, struct rcu_head *head)\n{\n\trcu_callback_t f;\n\tunsigned long offset = (unsigned long)head->func;\n\n\trcu_lock_acquire(&rcu_callback_map);\n\tif (__is_kfree_rcu_offset(offset)) {\n\t\tRCU_TRACE(trace_rcu_invoke_kfree_callback(rn, head, offset);)\n\t\tkfree((void *)head - offset);\n\t\trcu_lock_release(&rcu_callback_map);\n\t\treturn true;\n\t} else {\n\t\tRCU_TRACE(trace_rcu_invoke_callback(rn, head);)\n\t\tf = head->func;\n\t\tWRITE_ONCE(head->func, (rcu_callback_t)0L);\n\t\tf(head);\n\t\trcu_lock_release(&rcu_callback_map);\n\t\treturn false;\n\t}\n}",
          "includes": [
            "#include <linux/rcu_node_tree.h>",
            "#include <trace/events/rcu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_node_tree.h>\n#include <trace/events/rcu.h>\n\nstatic inline bool __rcu_reclaim(const char *rn, struct rcu_head *head)\n{\n\trcu_callback_t f;\n\tunsigned long offset = (unsigned long)head->func;\n\n\trcu_lock_acquire(&rcu_callback_map);\n\tif (__is_kfree_rcu_offset(offset)) {\n\t\tRCU_TRACE(trace_rcu_invoke_kfree_callback(rn, head, offset);)\n\t\tkfree((void *)head - offset);\n\t\trcu_lock_release(&rcu_callback_map);\n\t\treturn true;\n\t} else {\n\t\tRCU_TRACE(trace_rcu_invoke_callback(rn, head);)\n\t\tf = head->func;\n\t\tWRITE_ONCE(head->func, (rcu_callback_t)0L);\n\t\tf(head);\n\t\trcu_lock_release(&rcu_callback_map);\n\t\treturn false;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "local_bh_disable",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_rcu_head_unqueue",
          "args": [
            "list"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "debug_rcu_head_unqueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu.h",
          "lines": "214-216",
          "snippet": "static inline void debug_rcu_head_unqueue(struct rcu_head *head)\n{\n}",
          "includes": [
            "#include <linux/rcu_node_tree.h>",
            "#include <trace/events/rcu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_node_tree.h>\n#include <trace/events/rcu.h>\n\nstatic inline void debug_rcu_head_unqueue(struct rcu_head *head)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "prefetch",
          "args": [
            "next"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_save",
          "args": [
            "flags"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n};\n\nstatic __latent_entropy void rcu_process_callbacks(struct softirq_action *unused)\n{\n\tstruct rcu_head *next, *list;\n\tunsigned long flags;\n\n\t/* Move the ready-to-invoke callbacks to a local list. */\n\tlocal_irq_save(flags);\n\tif (rcu_ctrlblk.donetail == &rcu_ctrlblk.rcucblist) {\n\t\t/* No callbacks ready, so just leave. */\n\t\tlocal_irq_restore(flags);\n\t\treturn;\n\t}\n\tlist = rcu_ctrlblk.rcucblist;\n\trcu_ctrlblk.rcucblist = *rcu_ctrlblk.donetail;\n\t*rcu_ctrlblk.donetail = NULL;\n\tif (rcu_ctrlblk.curtail == rcu_ctrlblk.donetail)\n\t\trcu_ctrlblk.curtail = &rcu_ctrlblk.rcucblist;\n\trcu_ctrlblk.donetail = &rcu_ctrlblk.rcucblist;\n\tlocal_irq_restore(flags);\n\n\t/* Invoke the callbacks on the local list. */\n\twhile (list) {\n\t\tnext = list->next;\n\t\tprefetch(next);\n\t\tdebug_rcu_head_unqueue(list);\n\t\tlocal_bh_disable();\n\t\t__rcu_reclaim(\"\", list);\n\t\tlocal_bh_enable();\n\t\tlist = next;\n\t}\n}"
  },
  {
    "function_name": "rcu_check_callbacks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tiny.c",
    "lines": "79-87",
    "snippet": "void rcu_check_callbacks(int user)\n{\n\tif (user) {\n\t\trcu_qs();\n\t} else if (rcu_ctrlblk.donetail != rcu_ctrlblk.curtail) {\n\t\tset_tsk_need_resched(current);\n\t\tset_preempt_need_resched();\n\t}\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_preempt_need_resched",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_tsk_need_resched",
          "args": [
            "current"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_qs",
          "args": [],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_qs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tiny.c",
          "lines": "61-71",
          "snippet": "void rcu_qs(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tif (rcu_ctrlblk.donetail != rcu_ctrlblk.curtail) {\n\t\trcu_ctrlblk.donetail = rcu_ctrlblk.curtail;\n\t\traise_softirq(RCU_SOFTIRQ);\n\t}\n\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include <linux/prefetch.h>",
            "#include <linux/cpu.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/types.h>",
            "#include <linux/sched.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/notifier.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n};\n\nvoid rcu_qs(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tif (rcu_ctrlblk.donetail != rcu_ctrlblk.curtail) {\n\t\trcu_ctrlblk.donetail = rcu_ctrlblk.curtail;\n\t\traise_softirq(RCU_SOFTIRQ);\n\t}\n\tlocal_irq_restore(flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n};\n\nvoid rcu_check_callbacks(int user)\n{\n\tif (user) {\n\t\trcu_qs();\n\t} else if (rcu_ctrlblk.donetail != rcu_ctrlblk.curtail) {\n\t\tset_tsk_need_resched(current);\n\t\tset_preempt_need_resched();\n\t}\n}"
  },
  {
    "function_name": "rcu_qs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tiny.c",
    "lines": "61-71",
    "snippet": "void rcu_qs(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tif (rcu_ctrlblk.donetail != rcu_ctrlblk.curtail) {\n\t\trcu_ctrlblk.donetail = rcu_ctrlblk.curtail;\n\t\traise_softirq(RCU_SOFTIRQ);\n\t}\n\tlocal_irq_restore(flags);\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raise_softirq",
          "args": [
            "RCU_SOFTIRQ"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "__raise_softirq_irqoff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/softirq.c",
          "lines": "449-453",
          "snippet": "void __raise_softirq_irqoff(unsigned int nr)\n{\n\ttrace_softirq_raise(nr);\n\tor_softirq_pending(1UL << nr);\n}",
          "includes": [
            "#include <trace/events/irq.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/irq.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/ftrace.h>\n#include <linux/rcupdate.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/notifier.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/kernel_stat.h>\n#include <linux/export.h>\n\nvoid __raise_softirq_irqoff(unsigned int nr)\n{\n\ttrace_softirq_raise(nr);\n\tor_softirq_pending(1UL << nr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "local_irq_save",
          "args": [
            "flags"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n};\n\nvoid rcu_qs(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tif (rcu_ctrlblk.donetail != rcu_ctrlblk.curtail) {\n\t\trcu_ctrlblk.donetail = rcu_ctrlblk.curtail;\n\t\traise_softirq(RCU_SOFTIRQ);\n\t}\n\tlocal_irq_restore(flags);\n}"
  },
  {
    "function_name": "rcu_barrier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tiny.c",
    "lines": "54-57",
    "snippet": "void rcu_barrier(void)\n{\n\twait_rcu_gp(call_rcu);\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_rcu_gp",
          "args": [
            "call_rcu"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nvoid rcu_barrier(void)\n{\n\twait_rcu_gp(call_rcu);\n}"
  }
]